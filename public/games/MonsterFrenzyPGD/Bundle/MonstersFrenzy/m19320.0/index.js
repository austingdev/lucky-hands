window.__require=function e(t,i,a){function o(r,s){if(!i[r]){if(!t[r]){var l=r.split("/");if(l=l[l.length-1],!t[l]){var c="function"==typeof __require&&__require;if(!s&&c)return c(l,!0);if(n)return n(l,!0);throw new Error("Cannot find module '"+r+"'")}r=l}var d=i[r]={exports:{}};t[r][0].call(d.exports,function(e){return o(t[r][1][e]||e)},d,d.exports,e,t,i,a)}return i[r].exports}for(var n="function"==typeof __require&&__require,r=0;r<a.length;r++)o(a[r]);return o}({FM_MaterialManager:[function(e,t,i){"use strict";cc._RF.push(t,"70baautwPRE9qrXH1ZbEWNU","FM_MaterialManager");var a,o=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,r=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r};Object.defineProperty(i,"__esModule",{value:!0}),i.FM_MaterialManager=void 0;const{ccclass:n,property:r}=cc._decorator;let s=a=class extends cc.Component{static SetMaterial(e){this.mat=e}static GetMaterial(){return this.mat}static SetParameter(e,t){switch(e){case a.PARAMETER.FLOW_SPEED:this.parameterRecord[a.PARAMETER.FLOW_SPEED]=t,this.mat.setProperty("_flowSpeed",this.parameterRecord[a.PARAMETER.FLOW_SPEED]);break;case a.PARAMETER.PING_PONG:this.parameterRecord[a.PARAMETER.PING_PONG]=t,this.mat.setProperty("_pingPong",this.parameterRecord[a.PARAMETER.PING_PONG]);break;case a.PARAMETER.TIME_SCALE:this.parameterRecord[a.PARAMETER.TIME_SCALE]=t,this.mat.setProperty("_timeScale",this.parameterRecord[a.PARAMETER.TIME_SCALE]);break;case a.PARAMETER.SRC_BLEND:this.parameterRecord[a.PARAMETER.SRC_BLEND]=t;break;case a.PARAMETER.DST_BLEND:this.parameterRecord[a.PARAMETER.DST_BLEND]=t}}static GetParameter(e){return this.parameterRecord[e]}static SetTexture(e,t){this.mainTexture=e,this.flowMap=t,this.mat.setProperty("texture",this.mainTexture),this.mat.setProperty("_flowmap",this.flowMap)}static GetTexture(){return this.flowMap}static InitMaterial(e){null===this.effect&&(this.effect=e);let t=null;this.mat?t=this.mat:(t=cc.Material.create(e,0)).define("USE_TEXTURE",!0),this.mat=t}};s.PARAMETER={FLOW_SPEED:0,PING_PONG:1,TIME_SCALE:2,SRC_BLEND:3,DST_BLEND:4},s.effect=null,s.mat=null,s.mainTexture=null,s.flowMap=null,s.parameterRecord=[.1,.01,.1,cc.macro.BlendFactor.SRC_ALPHA,cc.macro.BlendFactor.ONE_MINUS_SRC_ALPHA],s=a=o([n("FM_MaterialManager")],s),i.FM_MaterialManager=s,cc._RF.pop()},{}],FishCamera3DHandler:[function(e,t,i){"use strict";cc._RF.push(t,"53c4e4+GBJDmJJ0ZBwy9tH5","FishCamera3DHandler");var a,o=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,r=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},n=this&&this.__awaiter||function(e,t,i,a){return new(i||(i=Promise))(function(o,n){function r(e){try{l(a.next(e))}catch(t){n(t)}}function s(e){try{l(a.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}l((a=a.apply(e,t||[])).next())})};Object.defineProperty(i,"__esModule",{value:!0});const r=e("../../../../../../FishHunter/Script/Game/GameClient"),s=e("../../../../../../FishHunter/Script/Game/System/SkillSystem"),l=e("../../../../../../FishHunter/Script/Game/MainGame/Game/GameManager"),c=e("../../../../../../LobbyCommon/Helper/EventSystem"),{ccclass:d,property:h}=cc._decorator;let p=a=class extends cc.Component{constructor(){super(...arguments),this.camera3D=null}static get Instance(){return a.instance}onLoad(){null==a.instance&&(a.instance=this,a.Instance.camera3D=this.getComponent(cc.Camera),c.EventSystem.Event(c.FishHunter.RotateBackGround).Insert(this.setReverse,this))}onDestroy(){a.instance=null,c.EventSystem.Event(c.FishHunter.RotateBackGround).Remove(this.setReverse,this)}setReverse(e){if(e>1){let e=a.instance.camera3D.node.getPosition();e.x=-e.x,e.y=-e.y,a.instance.camera3D.node.setPosition(e),a.instance.camera3D.node.rotation=180}}onKeyDown(e){return n(this,void 0,void 0,function*(){if(e.keyCode==cc.macro.KEY.z&&(l.default.Instance.onInitScriptEvent(1101,1101),l.default.Instance.onScriptEvent(1101)),e.keyCode==cc.macro.KEY.x){let e={10:"11",11:[{1:7876300,2:134,3:3,4:95,5:107,6:201,7:0,8:1,9:1940,16:null}],14:2006,15:[{},{}],timestamp:1698220241};r.default.FishSystem.onCreateFish(null,e,null,null,null,null)}if(e.keyCode==cc.macro.KEY.c){let e={win_type:"fake_bomb_ultimate",reward_list:[{odds:40,multi:1,fake_fish:[{odds:9,type:7,qty:1},{odds:10,type:8,qty:2},{odds:3,type:1,qty:1},{odds:2,type:0,qty:4}]},{odds:30,multi:2,fake_fish:[{odds:2,type:0,qty:4},{odds:3,type:1,qty:1},{odds:4,type:2,qty:3},{odds:7,type:5,qty:1}]},{odds:32,multi:3,fake_fish:[{odds:2,type:0,qty:3},{odds:3,type:1,qty:2},{odds:4,type:2,qty:2},{odds:5,type:3,qty:1},{odds:7,type:5,qty:1}]}],timestamp:1698643274,win:2e3,odds:400,seat:0,id:7876300,bet:5};r.default.SkillSystem.onGetSkill(ArkSDK.HttpConnect.HttpResult.OK,e,null,null,null,s.SKILL_CMD_NAME.THUNDER_DRAGON_EX_GET)}if(e.keyCode==cc.macro.KEY.u){let e={win_type:"fake_bomb_ultimate",reward_list:[{odds:40,multi:1,fake_fish:[{odds:9,type:7,qty:1},{odds:10,type:8,qty:2},{odds:3,type:1,qty:1},{odds:2,type:0,qty:4}]},{odds:30,multi:2,fake_fish:[{odds:2,type:0,qty:4},{odds:3,type:1,qty:1},{odds:4,type:2,qty:3},{odds:7,type:5,qty:1}]},{odds:32,multi:3,fake_fish:[{odds:2,type:0,qty:3},{odds:3,type:1,qty:2},{odds:4,type:2,qty:2},{odds:5,type:3,qty:1},{odds:7,type:5,qty:1}]}],timestamp:1698643274,win:2e3,odds:400,seat:3,id:7876300,bet:5};r.default.SkillSystem.onGetSkill(ArkSDK.HttpConnect.HttpResult.OK,e,null,null,null,s.SKILL_CMD_NAME.THUNDER_DRAGON_EX_GET)}if(e.keyCode==cc.macro.KEY.v){let e={win_type:"fake_bomb_small",reward_list:[{odds:160,fake_fish:[{odds:2,type:0,qty:5},{odds:3,type:1,qty:1},{odds:4,type:2,qty:1},{odds:5,type:3,qty:9},{odds:7,type:5,qty:4},{odds:8,type:6,qty:2},{odds:12,type:9,qty:3},{odds:18,type:11,qty:1}]}],timestamp:1698643274,win:800,odds:160,seat:0,id:7876300,bet:5};r.default.SkillSystem.onGetSkill(ArkSDK.HttpConnect.HttpResult.OK,e,null,null,null,s.SKILL_CMD_NAME.THUNDER_DRAGON_EX_GET)}if(e.keyCode==cc.macro.KEY.b){let e={win_type:"fake_bomb_small",reward_list:[{odds:160,fake_fish:[{odds:2,type:0,qty:5},{odds:3,type:1,qty:1},{odds:4,type:2,qty:1},{odds:5,type:3,qty:9},{odds:7,type:5,qty:4},{odds:8,type:6,qty:2},{odds:12,type:9,qty:3},{odds:18,type:11,qty:1}]}],timestamp:1698643274,win:800,odds:160,seat:2,id:7876300,bet:5};r.default.SkillSystem.onGetSkill(ArkSDK.HttpConnect.HttpResult.OK,e,null,null,null,s.SKILL_CMD_NAME.THUNDER_DRAGON_EX_GET)}})}};p.instance=null,p=a=o([d],p),i.default=p,cc._RF.pop()},{"../../../../../../FishHunter/Script/Game/GameClient":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Game/GameManager":void 0,"../../../../../../FishHunter/Script/Game/System/SkillSystem":void 0,"../../../../../../LobbyCommon/Helper/EventSystem":void 0}],FlashLight:[function(e,t,i){"use strict";cc._RF.push(t,"16fa3GgbutPQIW6/6ipaFa+","FlashLight");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,r=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r};Object.defineProperty(i,"__esModule",{value:!0}),i.FlashLightUBO=void 0;const{ccclass:o,property:n}=cc._decorator;let r=class{constructor(){this.lightColor=new cc.Color(255,255,255,150),this.lightCenterPoint=cc.v2(0,.5),this.lightAngle=90,this.lightWidth=.1,this.enableGradient=!0,this.cropAlpha=!0,this.enableFog=!1}};a([n({displayName:"\u5149\u7684\u984f\u8272"})],r.prototype,"lightColor",void 0),a([n({type:cc.Float,displayName:"\u5149\u7684\u89d2\u5ea6"})],r.prototype,"lightAngle",void 0),a([n({type:cc.Float,displayName:"\u5149\u7684\u5bec\u5ea6"})],r.prototype,"lightWidth",void 0),r=a([o("FlashLightUBO")],r),i.FlashLightUBO=r;let s=class extends cc.Component{constructor(){super(...arguments),this.flashLightUBO=new r,this.flashTime=2.5,this.flashInterval=0,this._timer=0,this._sprite=null,this._material=null,this._transparent=new cc.Color(0,0,0,0)}onLoad(){this._sprite=this.getComponent(cc.Sprite),this._material=this._sprite.getMaterial(0)}update(e){this._timer+=e,this._timer>this.flashTime+this.flashInterval?this._timer=-this.flashLightUBO.lightWidth:(this._timer>this.flashTime?this.flashLightUBO.lightCenterPoint.x=1+this.flashLightUBO.lightWidth:this.flashLightUBO.lightCenterPoint.x=this._timer/this.flashTime*(1+2*this.flashLightUBO.lightWidth)-this.flashLightUBO.lightWidth,this._updateMaterial())}_updateMaterial(){let e=this._sprite.spriteFrame,t=0,i=0,a=1,o=1;t=e.uv[0],o=e.uv[5],i=e.uv[6],a=e.uv[3];let n=new cc.Vec4(t,o,i,a),r=e.isRotated()?1:0;this._material.setProperty("u_UVoffset",n),this._material.setProperty("u_rotated",r),this._material.setProperty("lightColor",this._timer>this.flashTime?this._transparent:this.flashLightUBO.lightColor),this._material.setProperty("lightCenterPoint",this.flashLightUBO.lightCenterPoint),this._material.setProperty("lightAngle",this.flashLightUBO.lightAngle),this._material.setProperty("lightWidth",this.flashLightUBO.lightWidth),this._material.setProperty("enableGradient",this.flashLightUBO.enableGradient),this._material.setProperty("cropAlpha",this.flashLightUBO.cropAlpha),this._material.setProperty("enableFog",this.flashLightUBO.enableFog),this._sprite.setMaterial(0,this._material)}};a([n({type:r,displayName:"Setting"})],s.prototype,"flashLightUBO",void 0),a([n({type:cc.Float,displayName:"\u5237\u5149\u6642\u9593"})],s.prototype,"flashTime",void 0),a([n({type:cc.Float,displayName:"\u5237\u5149\u9593\u9694\u6642\u9593"})],s.prototype,"flashInterval",void 0),s=a([o],s),i.default=s,cc._RF.pop()},{}],FlowMap:[function(e,t,i){"use strict";cc._RF.push(t,"cde209ub7hN6YiiZ/fj7SEE","FlowMap");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,r=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r};Object.defineProperty(i,"__esModule",{value:!0}),i.FlowMap=void 0;const o=e("./FM_MaterialManager"),{ccclass:n,property:r,executeInEditMode:s}=cc._decorator;let l=class extends cc.Component{constructor(){super(...arguments),this.unlockUI=!1,this.mainTexture=null,this._flowMapEffect=null,this._flowMap=null,this._flowSpeed=.1,this._pingPong=.01,this._timeScale=.1,this._srcBlend=cc.macro.BlendFactor.SRC_ALPHA,this._dstBlend=cc.macro.BlendFactor.ONE_MINUS_SRC_ALPHA}get FlowMapEffect(){return this._flowMapEffect}set FlowMapEffect(e){this._flowMapEffect=e,e?this.Setting():this.unlockUI=!1}get FlowMap(){return this._flowMap}set FlowMap(e){this._flowMap=e,this._flowMap.setWrapMode(cc.Texture2D.WrapMode.CLAMP_TO_EDGE,cc.Texture2D.WrapMode.CLAMP_TO_EDGE),o.FM_MaterialManager.SetTexture(this.mainTexture,this._flowMap)}get FlowSpeed(){return o.FM_MaterialManager.GetParameter(o.FM_MaterialManager.PARAMETER.FLOW_SPEED)}set FlowSpeed(e){this._flowSpeed=e,o.FM_MaterialManager.SetParameter(o.FM_MaterialManager.PARAMETER.FLOW_SPEED,this._flowSpeed)}get PingPong(){return o.FM_MaterialManager.GetParameter(o.FM_MaterialManager.PARAMETER.PING_PONG)}set PingPong(e){this._pingPong=e,o.FM_MaterialManager.SetParameter(o.FM_MaterialManager.PARAMETER.PING_PONG,this._pingPong)}get TimeScale(){return o.FM_MaterialManager.GetParameter(o.FM_MaterialManager.PARAMETER.TIME_SCALE)}set TimeScale(e){this._timeScale=e,o.FM_MaterialManager.SetParameter(o.FM_MaterialManager.PARAMETER.TIME_SCALE,this._timeScale)}get SrcBlend(){return o.FM_MaterialManager.GetParameter(o.FM_MaterialManager.PARAMETER.SRC_BLEND)}set SrcBlend(e){this._srcBlend=e,o.FM_MaterialManager.SetParameter(o.FM_MaterialManager.PARAMETER.SRC_BLEND,this._srcBlend)}get DstBlend(){return o.FM_MaterialManager.GetParameter(o.FM_MaterialManager.PARAMETER.DST_BLEND)}set DstBlend(e){this._dstBlend=e,o.FM_MaterialManager.SetParameter(o.FM_MaterialManager.PARAMETER.DST_BLEND,this._dstBlend)}InitFlowMap(){o.FM_MaterialManager.SetParameter(o.FM_MaterialManager.PARAMETER.FLOW_SPEED,this._flowSpeed),o.FM_MaterialManager.SetParameter(o.FM_MaterialManager.PARAMETER.PING_PONG,this._pingPong),o.FM_MaterialManager.SetParameter(o.FM_MaterialManager.PARAMETER.TIME_SCALE,this._timeScale),o.FM_MaterialManager.SetParameter(o.FM_MaterialManager.PARAMETER.SRC_BLEND,this._srcBlend),o.FM_MaterialManager.SetParameter(o.FM_MaterialManager.PARAMETER.DST_BLEND,this._dstBlend),o.FM_MaterialManager.SetTexture(this.mainTexture,this._flowMap),this.RefreshProperty()}RefreshProperty(){let e=o.FM_MaterialManager.GetMaterial();e.setProperty("_flowSpeed",this._flowSpeed),e.setProperty("_pingPong",this._pingPong),e.setProperty("_timeScale",this._timeScale)}ConnectMaterial(){this.node.getComponent(cc.Sprite).setMaterial(0,o.FM_MaterialManager.GetMaterial()),this.node.getComponent(cc.Sprite).srcBlendFactor=o.FM_MaterialManager.GetParameter(o.FM_MaterialManager.PARAMETER.SRC_BLEND),this.node.getComponent(cc.Sprite).dstBlendFactor=o.FM_MaterialManager.GetParameter(o.FM_MaterialManager.PARAMETER.DST_BLEND)}Setting(){this.unlockUI=!0,null===o.FM_MaterialManager.GetMaterial()&&(o.FM_MaterialManager.InitMaterial(this._flowMapEffect),this.InitFlowMap()),this.ConnectMaterial()}RefreshParameter(){this.ConnectMaterial(),this._flowSpeed=o.FM_MaterialManager.GetParameter(o.FM_MaterialManager.PARAMETER.FLOW_SPEED),this._pingPong=o.FM_MaterialManager.GetParameter(o.FM_MaterialManager.PARAMETER.PING_PONG),this._timeScale=o.FM_MaterialManager.GetParameter(o.FM_MaterialManager.PARAMETER.TIME_SCALE),this._srcBlend=o.FM_MaterialManager.GetParameter(o.FM_MaterialManager.PARAMETER.SRC_BLEND),this._dstBlend=o.FM_MaterialManager.GetParameter(o.FM_MaterialManager.PARAMETER.DST_BLEND),this._flowMap=o.FM_MaterialManager.GetTexture()}start(){this.mainTexture=this.node.getComponent(cc.Sprite).spriteFrame.getTexture(),this.mainTexture.setWrapMode(cc.Texture2D.WrapMode.CLAMP_TO_EDGE,cc.Texture2D.WrapMode.CLAMP_TO_EDGE),this._flowMapEffect&&this.Setting()}update(e){}};a([r(cc.EffectAsset)],l.prototype,"_flowMapEffect",void 0),a([r({type:cc.EffectAsset,tooltip:"\u5c07 UIShiny Effect \u639b\u5728\u6b64\u6b04\u4f4d"})],l.prototype,"FlowMapEffect",null),a([r],l.prototype,"_flowMap",void 0),a([r({type:cc.Texture2D,tooltip:"Flow\u5716: [0, 1]",visible(){return this.unlockUI}})],l.prototype,"FlowMap",null),a([r],l.prototype,"_flowSpeed",void 0),a([r({type:cc.Float,range:[0,1,.001],slide:!0,tooltip:"\u6d41\u52d5\u901f\u5ea6: [0, 1]",visible(){return this.unlockUI}})],l.prototype,"FlowSpeed",null),a([r],l.prototype,"_pingPong",void 0),a([r({type:cc.Float,range:[0,.1,1e-4],slide:!0,tooltip:"x\u8ef8\u5de6\u53f3\u6643\u52d5: [0, 1]",visible(){return this.unlockUI}})],l.prototype,"PingPong",null),a([r],l.prototype,"_timeScale",void 0),a([r({type:cc.Float,range:[0,10,.001],slide:!0,tooltip:"\u6642\u9593\u6d41\u901f: [0, 1]",visible(){return this.unlockUI}})],l.prototype,"TimeScale",null),a([r],l.prototype,"_srcBlend",void 0),a([r({type:cc.macro.BlendFactor,tooltip:"SrcBlend",visible(){return this.unlockUI}})],l.prototype,"SrcBlend",null),a([r],l.prototype,"_dstBlend",void 0),a([r({type:cc.macro.BlendFactor,tooltip:"DstBlend",visible(){return this.unlockUI}})],l.prototype,"DstBlend",null),l=a([n("FlowMap"),s],l),i.FlowMap=l,cc._RF.pop()},{"./FM_MaterialManager":"FM_MaterialManager"}],InGamePopupMgr:[function(e,t,i){"use strict";cc._RF.push(t,"59919lR6/JAWZnzG1BsPwes","InGamePopupMgr");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,r=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});const o=e("../../../../FishHunter/Script/Game/GameClient"),n=e("../../../../FishHunter/Script/Game/MainGame/Item/ItemManager"),r=e("../../../../FishHunter/Script/Game/MainGame/Player/PlayerManager"),s=e("../../../../FishHunter/Script/Game/MainGame/Weapon/WeaponManager"),l=e("../../../../LobbyCommon/Connect/Script/ConnectPanelMgr"),c=e("../../../../LobbyCommon/Net/LobbyClient"),d=e("../../../../LobbyCommon/PopupMessage/Script/PopupMsgMgr"),h=e("./InGameTeachPopup"),{ccclass:p,property:m}=cc._decorator;let u=class extends cc.Component{constructor(){super(...arguments),this.EVENT_CLOSE=null,this.m_nodeRoot=null,this.m_nodeDarkBg=null,this.m_btnClose=null,this.m_btnPageNexp=null,this.m_btnPagePre=null,this.m_aryPage=[],this.m_aryPageImg=[],this.m_InGameTeachPopupMF=null,this.m_btnGetItem=null,this.m_numCurPageIndex=0,this.m_numStartPageIndex=0,this.m_strQuestID="",this.m_numQuestLv=0,this.m_nameMapImg=null,this.m_bDownloadImgFail=!1}GetDarkBg(){return this.m_nodeDarkBg}onLoad(){console.log("IngamePopup onLoad"),this.m_nodeRoot.active=!1,this.m_InGameTeachPopupMF.Init()}LoadTexture(){let e=this,t=setTimeout(()=>{e.onDLFail()},5e3);cc.loader.loadResDir("MonstersFrenzy/Texture/",cc.SpriteFrame,function(i,a){if(i)return console.log(i),clearTimeout(t),void e.onDLFail();console.log(a),clearTimeout(t),null==e.m_nameMapImg&&(e.m_nameMapImg={});let o=a.length;for(let t=0;t<o;t++)console.log("\u4e0b\u8f09\u5b8c\u6210~ "+a[t].name),e.m_nameMapImg[a[t].name]=a[t];for(let t=0;t<o;t++)null!=e.m_aryPageImg[t]&&(e.m_aryPageImg[t].spriteFrame=e.m_nameMapImg["Popup_"+t.toString()])})}ShowInGamePopup(e,t){if(console.log("[ShowInGamePopup newbieGiftState : "+e),e<=0)this.OnClose();else{if(1==e)this.LoadTexture(),this.ParseNewbieGiftData(t),o.default.ItemSystem.CollectNewbieGift=this.OnReceiveNewbieGift.bind(this),this.m_numStartPageIndex=0,this.m_btnGetItem.interactable=!0,this.m_btnPageNexp.node.active=!1,this.m_btnPagePre.node.active=!1,this.m_btnClose.node.active=!1,s.default.Instance.IsPopupShow=!0,this.m_InGameTeachPopupMF.SetIconInitShow(!0);else if(2==e)return void this.OnClose();this.m_numCurPageIndex=this.m_numStartPageIndex,this.SetActivePage(this.m_numCurPageIndex),this.m_nodeRoot.active=!0}}ParseNewbieGiftData(e){let t=JSON.parse(c.LobbyClient.Instance.m_CommonEventInfo_900004);if(t.hasOwnProperty("Enable")&&t.Enable&&t.hasOwnProperty("QuestList")&&t.QuestList.length>0&&t.hasOwnProperty("UserQuestData")){let e=t.QuestList;if(t.UserQuestData,e.length>0)for(let t=0;t<e.length;t++){let i=e[t],a=i.TitleType,o=i.GameThemeID;201==a&&148001==o&&(this.m_strQuestID=i.QuestID,this.m_numQuestLv=i.QuestLevel,this.m_InGameTeachPopupMF.SetEventTime(i.CustomInfo.Msg),console.log("m_strQuestID = "+this.m_strQuestID+", m_numQuestLv = "+this.m_numQuestLv))}}}SetActivePage(e){for(let t=0;t<this.m_aryPage.length;t++)this.m_aryPage[t].active=t==e}OnClickGetItem(){this.m_btnGetItem.interactable=!1,o.default.PlayerSystem&&(l.ConnectPanelMgr.Instance.ShowConnectPanel(0),o.default.ItemSystem.SendCollectNewbieGift(this.m_strQuestID,this.m_numQuestLv))}OnReceiveNewbieGift(e,t){if(l.ConnectPanelMgr.Instance.DisableConnectPanel(0),e==ArkSDK.SocketResult.OK){let i=t.result;if(console.log("[MissionEventMgr.GetMissionBonus]  Success : ",e),0==i){let e=r.PlayerManager.MainSeat>1?r.PlayerManager.MainSeat-2:r.PlayerManager.MainSeat,i=s.default.WeaponPosition(e),a=t.data.AwardItem;for(let t=0;t<a.length;t++){let e=a[t],o=e.ItemID,s=e.Amount;s>0&&this.m_InGameTeachPopupMF.GetItem(o,s,i,()=>{n.default.Instance.ModifyItemQty(r.PlayerManager.MainSeat,o,s),t==a.length-1&&(this.m_InGameTeachPopupMF.OnItemGotFinished(),this.HideItemsAndShowOtherButtonShow(),this.m_InGameTeachPopupMF.ShowTips())})}}else-1==i?(this.HideItemsAndShowOtherButtonShow(),d.PopupMsgMgr.Instance.ShowPopMsg(d.PopupPriority.Info,"S175",null,null,null)):1==i?(this.m_InGameTeachPopupMF.OnItemGotFinished(),this.m_InGameTeachPopupMF.ShowTips(),this.HideItemsAndShowOtherButtonShow(),d.PopupMsgMgr.Instance.ShowPopMsg(d.PopupPriority.Info,"S174",null,null,null)):d.PopupMsgMgr.Instance.ShowPopMsg(d.PopupPriority.Warning,"S189",null,null,null)}else{let t="";t=e==ArkSDK.HttpResult.Abort?"S183":e==ArkSDK.HttpResult.Condition?"S184":e==ArkSDK.HttpResult.Error?"S187":e==ArkSDK.HttpResult.NotReset?"S185":e==ArkSDK.HttpResult.Status?"S186":e==ArkSDK.HttpResult.Timeout?"S188":"S189",d.PopupMsgMgr.Instance.ShowPopMsg(d.PopupPriority.Critical,t,null,null,null)}}HideItemsAndShowOtherButtonShow(){this.m_InGameTeachPopupMF.Clear(),this.m_btnClose.node.active=!0,this.m_btnGetItem.node.active=!1,this.m_bDownloadImgFail||(this.m_btnPageNexp.node.active=!0,this.m_btnPagePre.node.active=!0)}OnClickNextPage(){this.m_bDownloadImgFail||(this.m_numCurPageIndex++,this.m_numCurPageIndex>this.m_aryPage.length-1&&(this.m_numCurPageIndex=this.m_numStartPageIndex),this.SetActivePage(this.m_numCurPageIndex))}OnClickPrePage(){this.m_bDownloadImgFail||(this.m_numCurPageIndex--,this.m_numCurPageIndex<this.m_numStartPageIndex&&(this.m_numCurPageIndex=this.m_aryPage.length-1),this.SetActivePage(this.m_numCurPageIndex))}OnClickClose(){this.OnClose(!0)}onDLFail(){console.error("onDLFail"),this.m_bDownloadImgFail=!0,this.m_numCurPageIndex=0,this.SetActivePage(this.m_numCurPageIndex),this.m_btnPageNexp.node.active=!1,this.m_btnPagePre.node.active=!1}OnClose(e=!1){this.m_numCurPageIndex=0,this.SetActivePage(this.m_numCurPageIndex),this.m_nodeRoot.active=!1,s.default.Instance.IsPopupShow=!1,this.Clear(),null!=this.EVENT_CLOSE&&this.EVENT_CLOSE(e)}OnBlockTouchEvent(){}Clear(){null!=this.m_nameMapImg&&(Object.keys(this.m_nameMapImg).forEach(e=>{let t=this.m_nameMapImg[e];console.log(t),cc.assetManager.releaseAsset(t),t=null}),this.m_nameMapImg=null);for(let e=0;e<this.m_aryPageImg.length;e++)this.m_aryPageImg[e].spriteFrame=null}};a([m(cc.Node)],u.prototype,"m_nodeRoot",void 0),a([m(cc.Node)],u.prototype,"m_nodeDarkBg",void 0),a([m(cc.Button)],u.prototype,"m_btnClose",void 0),a([m(cc.Button)],u.prototype,"m_btnPageNexp",void 0),a([m(cc.Button)],u.prototype,"m_btnPagePre",void 0),a([m([cc.Node])],u.prototype,"m_aryPage",void 0),a([m([cc.Sprite])],u.prototype,"m_aryPageImg",void 0),a([m(h.default)],u.prototype,"m_InGameTeachPopupMF",void 0),a([m(cc.Button)],u.prototype,"m_btnGetItem",void 0),u=a([p],u),i.default=u,cc._RF.pop()},{"../../../../FishHunter/Script/Game/GameClient":void 0,"../../../../FishHunter/Script/Game/MainGame/Item/ItemManager":void 0,"../../../../FishHunter/Script/Game/MainGame/Player/PlayerManager":void 0,"../../../../FishHunter/Script/Game/MainGame/Weapon/WeaponManager":void 0,"../../../../LobbyCommon/Connect/Script/ConnectPanelMgr":void 0,"../../../../LobbyCommon/Net/LobbyClient":void 0,"../../../../LobbyCommon/PopupMessage/Script/PopupMsgMgr":void 0,"./InGameTeachPopup":"InGameTeachPopup"}],InGameTeachPopup:[function(e,t,i){"use strict";cc._RF.push(t,"66a23GiEYlEFLGDhEsF2gVJ","InGameTeachPopup");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,r=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});const o=e("../../../../FishHunter/Script/Game/MainGame/Item/DropItem"),n=e("../../../../FishHunter/Script/Game/System/ItemSystem"),{ccclass:r,property:s}=cc._decorator;let l=class extends cc.Component{constructor(){super(...arguments),this.m_ItemFreeze=null,this.m_ItemSummon=null,this.m_nodeFreezeLight=null,this.m_nodeSummonLight=null,this.m_nodeItemGot=null,this.m_nodeTips=null,this.m_labEventTime=null}Init(){this.m_posFreezeOri=this.m_ItemFreeze.node.getPosition(),this.m_posSummonOri=this.m_ItemSummon.node.getPosition(),this.m_nodeItemGot.active=!1,this.m_nodeTips.active=!1,this.m_nodeFreezeLight.active=!1,this.m_nodeSummonLight.active=!1}SetIconInitShow(e){this.m_ItemFreeze.ShowIcon(e),this.m_ItemSummon.ShowIcon(e)}OnItemGotFinished(){this.m_nodeItemGot.active=!0,this.m_nodeFreezeLight.active=!1,this.m_nodeSummonLight.active=!1}ShowTips(){this.m_nodeTips.active=!0}SetEventTime(e){this.m_labEventTime.string=e}GetItem(e,t,i,a){e==n.ITEM_ID.FREEZE?(this.m_ItemFreeze.ShowIcon(!0),this.m_nodeFreezeLight.active=!0,this.m_ItemFreeze.Init(e,t,this.m_posFreezeOri,i,a,!0)):e==n.ITEM_ID.SUMMON&&(this.m_ItemSummon.ShowIcon(!0),this.m_nodeSummonLight.active=!0,this.m_ItemSummon.Init(e,t,this.m_posSummonOri,i,a,!0))}Clear(){this.m_ItemFreeze.ShowIcon(!1),this.m_ItemSummon.ShowIcon(!1)}};a([s(o.default)],l.prototype,"m_ItemFreeze",void 0),a([s(o.default)],l.prototype,"m_ItemSummon",void 0),a([s(cc.Node)],l.prototype,"m_nodeFreezeLight",void 0),a([s(cc.Node)],l.prototype,"m_nodeSummonLight",void 0),a([s(cc.Node)],l.prototype,"m_nodeItemGot",void 0),a([s(cc.Node)],l.prototype,"m_nodeTips",void 0),a([s(cc.Label)],l.prototype,"m_labEventTime",void 0),l=a([r],l),i.default=l,cc._RF.pop()},{"../../../../FishHunter/Script/Game/MainGame/Item/DropItem":void 0,"../../../../FishHunter/Script/Game/System/ItemSystem":void 0}],LockWeaponMF:[function(e,t,i){"use strict";cc._RF.push(t,"5a3267ySZlBJbMcHC0dLA0/","LockWeaponMF");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,r=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});const o=e("../../../../../../../FishHunter/Script/Game/GameClient"),n=e("../../../../../../../FishHunter/Script/Game/MainGame/Weapon/LockWeapon"),r=e("../../../../../../../FishHunter/Script/Game/MainGame/Weapon/WeaponManager"),{ccclass:s,property:l}=cc._decorator;let c=class extends n.default{constructor(){super(...arguments),this.lockIconBg=null,this.lockIconBgState=[],this.m_nodeLockIconGroup=null,this.m_nodeLockIconAnchorC=null,this.m_nodeLockIconAnchorR=null,this.m_nodeLockIconAnchorL=null}Init(e,t){this.addSkill=!1,super.Init(e,t);let i=r.default.Instance.GetSkillLockLv(e);this.skill=o.default.SkillSystem.AddSkill(i,e),this.skill.SetLockLvType(i),this.skill.setWeapon(this,t)}SetFishIcon(e){if(!this.fishIconImg)return void(this.lockIconBg.spriteFrame=this.lockIconBgState[0]);let t=this.getFishIcon(e);t?(this.fishIconImg.spriteFrame=t,this.fishIconImg.node.active=!0,this.lockIconBg.spriteFrame=this.lockIconBgState[1]):(this.fishIconImg.node.active=!1,this.lockIconBg.spriteFrame=this.lockIconBgState[0])}SetGunRotateUsePos(e){super.SetGunRotateUsePos(e),this.playerSeat<=1?this.gunNode.angle<-60?(this.m_nodeLockIconGroup.parent=this.m_nodeLockIconAnchorR,this.m_nodeLockIconGroup.setPosition(cc.v2(0,-40))):this.gunNode.angle>60?(this.m_nodeLockIconGroup.parent=this.m_nodeLockIconAnchorL,this.m_nodeLockIconGroup.setPosition(cc.v2(0,-40))):this.m_nodeLockIconGroup.parent!=this.m_nodeLockIconAnchorC&&(this.m_nodeLockIconGroup.parent=this.m_nodeLockIconAnchorC,this.m_nodeLockIconGroup.angle=0,this.m_nodeLockIconGroup.setPosition(cc.v2(0,0))):this.gunNode.angle<300&&this.gunNode.angle>=270?(this.m_nodeLockIconGroup.parent=this.m_nodeLockIconAnchorR,this.m_nodeLockIconGroup.setPosition(cc.v2(0,-40))):this.gunNode.angle<=90&&this.gunNode.angle>60?(this.m_nodeLockIconGroup.parent=this.m_nodeLockIconAnchorL,this.m_nodeLockIconGroup.setPosition(cc.v2(0,-40))):this.m_nodeLockIconGroup.parent!=this.m_nodeLockIconAnchorC&&(this.m_nodeLockIconGroup.parent=this.m_nodeLockIconAnchorC,this.m_nodeLockIconGroup.angle=0,this.m_nodeLockIconGroup.setPosition(cc.v2(0,0)))}stopLock(){this.skill&&(this.skill.setLocking(null),this.lockIconBg.spriteFrame=this.lockIconBgState[0])}};a([l(cc.Sprite)],c.prototype,"lockIconBg",void 0),a([l([cc.SpriteFrame])],c.prototype,"lockIconBgState",void 0),a([l(cc.Node)],c.prototype,"m_nodeLockIconGroup",void 0),a([l(cc.Node)],c.prototype,"m_nodeLockIconAnchorC",void 0),a([l(cc.Node)],c.prototype,"m_nodeLockIconAnchorR",void 0),a([l(cc.Node)],c.prototype,"m_nodeLockIconAnchorL",void 0),c=a([s],c),i.default=c,cc._RF.pop()},{"../../../../../../../FishHunter/Script/Game/GameClient":void 0,"../../../../../../../FishHunter/Script/Game/MainGame/Weapon/LockWeapon":void 0,"../../../../../../../FishHunter/Script/Game/MainGame/Weapon/WeaponManager":void 0}],NodeParticleNew:[function(e,t,i){"use strict";cc._RF.push(t,"a6499Uxw3tC5ZxiM6Du+4mq","NodeParticleNew");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,r=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r};Object.defineProperty(i,"__esModule",{value:!0}),i.NodeParticleNew=void 0;const o=e("../../../../../../LobbyCommon/Component/SSSpawnPool"),{ccclass:n,property:r}=cc._decorator;let s=class extends cc.Component{constructor(){super(...arguments),this.targetNode=null,this.randomRotation=!1,this.enableToPlay=!0,this.duration=-1,this.lifetime=1,this.lifetimeRandomRange=0,this.emissionRate=10,this.emitArea=cc.Vec2.ZERO,this.speed=10,this.speedRamdomRange=0,this.angle=90,this.angleRandomRange=0,this.gravityXY=cc.v2(0,1),this.beginScale=1,this.endScale=1,this.receiveNodeParticleListIndex=[],this.spawnpool=null,this.nodeParticleList=[]}get TargetNode(){return this.targetNode}get RandomRotation(){return this.randomRotation}get EnableToPlay(){return this.enableToPlay}get Duration(){return this.duration}get Lifetime(){return this.lifetime}get LifetimeRandomRange(){return this.lifetimeRandomRange}get EmissionRate(){return this.emissionRate}get EmitArea(){return this.emitArea}get Speed(){return this.speed}get Angle(){return this.angle}get AngleRandomRange(){return this.angleRandomRange}get GravityXY(){return this.gravityXY}get BeginScale(){return this.beginScale}get EndScale(){return this.endScale}onLoad(){this.spawnpool=this.addComponent(o.SpawnPool)}onEnable(){null!=this.targetNode?this.enableToPlay&&this.RePlayParticleSystem():console.warn("[NodeParticleSystem]TargetPrefab Not Found.")}onDisable(){this.spawnpool.DespawnAll(),this.nodeParticleList=[]}RePlayParticleSystem(){let e=1/this.emissionRate;if(this.unscheduleAllCallbacks(),this.duration>0){let t=this.duration/e;this.schedule(this.EmitNode,e,t)}else this.schedule(this.EmitNode,e)}StopParticleSystem(){this.unscheduleAllCallbacks()}EmitNode(){this.spawnpool||(this.spawnpool=this.addComponent(o.SpawnPool));let e=this.spawnpool.Spawn(this.targetNode.data);e.parent=this.node;let t=2*(Math.random()-.5)*this.emitArea.x,i=2*(Math.random()-.5)*this.emitArea.y;e.setPosition(cc.v2(t,i)),e.scale=this.beginScale,this.randomRotation&&(e.angle=360*Math.random());let a=(this.angle+2*(Math.random()-.5)*this.angleRandomRange)*Math.PI/180,n=cc.v2(Math.cos(a),Math.sin(a)),r=this.lifetime+2*(Math.random()-.5)*this.lifetimeRandomRange,s=this.speed+2*(Math.random()-.5)*this.speedRamdomRange,l={node:e,lifetime:r,gravityXY:this.gravityXY,beginScale:this.beginScale,endScale:this.endScale,currentLifeTime:0,currentGrivate:cc.v2(n.x*s,n.y*s)};this.nodeParticleList.push(l)}update(e){if(this.nodeParticleList.forEach((t,i)=>{t.currentLifeTime+=e,t.currentLifeTime>=t.lifetime&&(t.currentLifeTime=t.lifetime,this.receiveNodeParticleListIndex.push(i));let a=cc.v2(t.gravityXY.x*e,t.gravityXY.y*e);if(t.currentGrivate=cc.v2(t.currentGrivate.x+a.x,t.currentGrivate.y+a.y),t.node.setPosition(cc.v2(t.node.position.x+t.currentGrivate.x*e,t.node.position.y+t.currentGrivate.y*e)),t.beginScale!=t.endScale){let e=t.currentLifeTime/t.lifetime,i=(t.endScale-t.beginScale)*e+t.beginScale;t.node.scale=i}}),this.receiveNodeParticleListIndex.length>0){for(let e=this.receiveNodeParticleListIndex.length-1;e>=0;e--){const t=this.receiveNodeParticleListIndex[e];this.spawnpool.Despawn(this.nodeParticleList[t].node),this.nodeParticleList.splice(t,1)}this.receiveNodeParticleListIndex=[]}}};a([r({type:cc.Prefab,displayName:"\u8868\u6f14\u7269\u4ef6"})],s.prototype,"targetNode",void 0),a([r({displayName:"\u96a8\u6a5f\u96a8\u8f49\u89d2\u5ea6"})],s.prototype,"randomRotation",void 0),a([r({displayName:"\u958b\u555f\u7269\u4ef6\u6642\u64ad\u653e"})],s.prototype,"enableToPlay",void 0),a([r({type:cc.Float,displayName:"\u8868\u6f14\u6301\u7e8c\u6642\u9593"})],s.prototype,"duration",void 0),a([r({type:cc.Float,displayName:"\u7c92\u5b50\u751f\u5b58\u6642\u9593"})],s.prototype,"lifetime",void 0),a([r({type:cc.Float,displayName:"\u7c92\u5b50\u751f\u5b58\u6642\u9593\u6d6e\u52d5\u503c",tooltip:"\u7c92\u5b50\u751f\u5b58\u6642\u9593 \xb1 \u7c92\u5b50\u751f\u5b58\u6642\u9593\u6d6e\u52d5\u503c"})],s.prototype,"lifetimeRandomRange",void 0),a([r({type:cc.Integer,displayName:"\u6bcf\u79d2\u767c\u5c04\u6578\u91cf"})],s.prototype,"emissionRate",void 0),a([r({displayName:"\u767c\u5c04\u7bc4\u570d"})],s.prototype,"emitArea",void 0),a([r({type:cc.Float,displayName:"\u79fb\u52d5\u901f\u5ea6"})],s.prototype,"speed",void 0),a([r({type:cc.Float,displayName:"\u79fb\u52d5\u901f\u5ea6\u6d6e\u52d5\u503c"})],s.prototype,"speedRamdomRange",void 0),a([r({displayName:"\u767c\u5c04\u89d2\u5ea6"})],s.prototype,"angle",void 0),a([r({displayName:"\u767c\u5c04\u89d2\u5ea6\u6d6e\u52d5\u503c",tooltip:"\u767c\u5c04\u89d2\u5ea6 \xb1 \u767c\u5c04\u89d2\u5ea6\u6d6e\u52d5\u503c"})],s.prototype,"angleRandomRange",void 0),a([r({displayName:"\u91cd\u529b\u65b9\u5411"})],s.prototype,"gravityXY",void 0),a([r({displayName:"\u8d77\u59cbScale"})],s.prototype,"beginScale",void 0),a([r({displayName:"\u7d50\u675fScale"})],s.prototype,"endScale",void 0),s=a([n],s),i.NodeParticleNew=s,cc._RF.pop()},{"../../../../../../LobbyCommon/Component/SSSpawnPool":void 0}],ParticleSystem3DReset:[function(e,t,i){"use strict";cc._RF.push(t,"21d1bwoYzlNhpQNPeUlgl5d","ParticleSystem3DReset");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,r=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r};Object.defineProperty(i,"__esModule",{value:!0}),i.ParticleSystem3DReset=void 0;const{ccclass:o,property:n,executeInEditMode:r}=cc._decorator;let s=class extends cc.Component{constructor(){super(...arguments),this.particle=null}onLoad(){null==this.particle&&(this.particle=this.getComponent(cc.ParticleSystem3D))}onDestroy(){this.particle=null}onDisable(){this.particle.clear(),this.particle.stop()}onEnable(){this.particle.clear(),this.particle.play()}};s=a([o,r],s),i.ParticleSystem3DReset=s,cc._RF.pop()},{}],PerspectiveCameraUtility:[function(e,t,i){"use strict";cc._RF.push(t,"31740NIaQxAX6e0PCdlpEUj","PerspectiveCameraUtility");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,r=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r};Object.defineProperty(i,"__esModule",{value:!0}),i.PerspectiveCameraUtility=void 0;const{ccclass:o,property:n}=cc._decorator;let r=class extends cc.Component{constructor(){super(...arguments),this.shakePower=0,this.shakeAction=null}onLoad(){this._camera=this.getComponent(cc.Camera),null!=this._camera.node.parent.getComponent(cc.SkeletonAnimation)?this._cameraNode=this._camera.node.parent:this._cameraNode=this._camera.node,this._defaultTanFov=Math.tan(this._camera.fov/180*Math.PI),this.updateFov()}onEnable(){cc.view.on("canvas-resize",this.updateFov,this)}updateFov(){let e=cc.view.getDesignResolutionSize(),t=e.width/e.height,i=cc.view.getCanvasSize(),a=i.width/i.height,o=t*(a=a<t?1/a:1/t)*this._defaultTanFov;this._camera.fov=Math.atan(o)/Math.PI*180,cc.log("updateFov,"+cc.view.getCanvasSize()+","+cc.view.getDesignResolutionSize()),cc.log("updateFov,"+this._camera.fov)}onDisable(){cc.view.off("canvas-resize",this.updateFov,this)}ShakeCamera(e=1,t=1,i=0){this._cameraNode.runAction(cc.sequence(cc.delayTime(i),cc.callFunc(()=>{this.ShakeCamera_Impl(t)}),cc.delayTime(e+i),cc.callFunc(()=>{this.ShakeCamera_Impl(-t)})))}ShakeCamera_Impl(e=1){if(this.shakeAction&&(this._cameraNode.stopAction(this.shakeAction),this.shakeAction=null),this.shakePower+=e,this.shakePower>0){let e=this._cameraNode.x>0?-2*this.shakePower:2*this.shakePower,t=this._cameraNode.y>0?-2*this.shakePower:2*this.shakePower;this.shakeAction=cc.repeat(cc.sequence(cc.moveBy(.0625,new cc.Vec2(e,t)),cc.moveBy(.0625,new cc.Vec2(-e,-t)),cc.moveBy(.0625,new cc.Vec2(e,t)),cc.moveBy(.0625,new cc.Vec2(-e,-t))),cc.macro.REPEAT_FOREVER),this._cameraNode.runAction(this.shakeAction)}else this.shakePower=0,this.shakeAction=cc.moveTo(.0625,cc.Vec2.ZERO),this._cameraNode.runAction(this.shakeAction)}};r=a([o],r),i.PerspectiveCameraUtility=r,cc._RF.pop()},{}],PlayAnimation:[function(e,t){"use strict";cc._RF.push(t,"c96bfWUrJtNX5/FLWidbwXp","PlayAnimation"),cc.Class({extends:cc.Component,properties:{currentTime:{default:0,visible:!1},TimeThreshold:{default:0,visible:!1},currentIndex:{default:0,visible:!1},currentRepeatCount:{default:0,visible:!1},RepeatArray:{default:[],type:[cc.Integer]},Delay:{default:0},flagSpine:{default:null,type:cc.Node},SpineRepeatArray:{default:[],type:[cc.Integer]},SpineDelay:{default:0}},start:function(){currentTime=0,TimeThreshold=this.Delay,currentIndex=0,currentRepeatCount=0},update:function(e){this.AnimationLoop(e),this.scheduleOnce(function(){this.SpineAnimationPlay()},this.SpineDelay)},SpineAnimationPlay:function(){if(null!=this.flagSpine){var e=this.flagSpine.getComponent("sp.Skeleton"),t=e.skeletonData.getRuntimeData(!0).animations;if(!(t.length<=0)){cc.log(t[1].name);for(var i=0;i<t.length;i++)for(var a=0;a<this.SpineRepeatArray[i];a++)e.addAnimation(0,t[i].name,!1,0)}}},AnimationLoop:function(e){var t=this.getComponent(cc.Animation),i=t._clips;if(0!=i.length&&(currentTime+=e,currentTime>TimeThreshold)){var a=t.play(i[currentIndex].name);currentRepeatCount=this.RepeatArray[currentIndex],a.repeatCount=currentRepeatCount,TimeThreshold+=a.duration*currentRepeatCount,currentIndex+=1,currentIndex>=i.length&&(currentIndex=0,TimeThreshold+=this.Delay)}}}),cc._RF.pop()},{}],SkillThunderBallExplosion:[function(e,t,i){"use strict";cc._RF.push(t,"5afe3pzEOtIMLKAfmmjSfs0","SkillThunderBallExplosion");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,r=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},o=this&&this.__awaiter||function(e,t,i,a){return new(i||(i=Promise))(function(o,n){function r(e){try{l(a.next(e))}catch(t){n(t)}}function s(e){try{l(a.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}l((a=a.apply(e,t||[])).next())})};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../../../../../FishCommon/Script/SSCanvasHandler"),r=e("../../../../../../FishHunter/Script/Game/MainGame/Fish/FishManager"),s=e("../../../../../../FishHunter/Script/Game/MainGame/Weapon/WeaponManager"),l=e("../../../../../../FishHunter/Script/Game/MainGame/Skill/BaseSkill"),c=e("../../../../../../FishHunter/Script/Game/MainGame/Common/AudioManager"),d=e("../../../../../../FishHunter/Script/Game/MainGame/Common/ResourceManager"),h=e("./SkillThunderDragonEx"),p=e("../../../../../../FishHunter/Script/Game/MainGame/Common/EnumFilter"),{ccclass:m,property:u}=cc._decorator;let y=class extends l.default{constructor(){super(...arguments),this.dragonBallAnim=null,this.dragonBallNode=null,this.dynamicBallScale=.36,this.dynamicBallWaitingTime=1,this.fishID=null,this.fake_fish_list=[],this.coinSound=-1,this.isTest=!1,this.awardNode=null}onLoad(){this.skillType=l.skillEnum.ThunderDragonEx_Small,this.limitTime=120,this.Reset()}onDestroy(){}update(e){super.update(e)}InitProperties(e=null){super.InitProperties(),this.playerBet=e.bet,this.fishID=e.id,this.totalOdds=e.odds,this.totalWin=e.win,this.fake_fish_list=e.reward_list[0].fake_fish,this.Reset()}UseSkill(){var e,t;return o(this,void 0,void 0,function*(){let i=null===(e=r.default.Instance)||void 0===e?void 0:e.GetFishByID(this.fishID);if(i||(i=null===(t=r.default.Instance)||void 0===t?void 0:t.GetFishByType(p.FishType.ThunderDragonEx)),!i)return void this.UnUseSkill();let a=i.getColliderByIndex(1);this.CoinEffect(a),c.default.Instance.Play("TDEX_Skill_Coin"),yield this.delay(200),this.dragonBallNode.scale=.5,this.dragonBallNode.active=!0,this.dragonBallNode.position=a.node.position,this.dragonBallAnim.play("Dragon_Ball_NoRing_Appear"),c.default.Instance.Play("TDEX_Skill_Ball"),yield this.delay(550),this.dragonBallNode.runAction(cc.moveTo(.25,cc.v2(0,0))),yield this.delay(250),this.dragonBallAnim.play("Dragon_Ball_NoRing_Inflate"),yield this.delay(300),this.SpreadSmallDragonBall(),yield this.delay(400+1e3*this.dynamicBallWaitingTime),c.default.Instance.Play("TDEX_Skill_Explosion"),n.default.CameraShakeEffect(.75,2),yield this.delay(3400),this.awardNode=d.default.SpawnEffect("TDEX_SMALL_AWARD",this.isMainPlayer);let o=this.awardNode.getComponent(cc.Animation);this.awardNode.getComponentInChildren(cc.Label).string=this.totalWin.toLocaleString();let l=s.default.WeaponUIPosition(this.playerSeat);l=n.default.isReverse?(l=l.scale(new cc.Vec2(-1,-1))).add(new cc.Vec2(0,this.playerSeat>1?-170:220)):l.add(new cc.Vec2(0,this.playerSeat>1?-220:170)),this.awardNode.angle=n.default.isReverse?180:0,this.awardNode.setPosition(l),o.play("Awards_In"),yield this.delay(1e3*o.getAnimationState("Awards_In").duration),o.play("Awards_Loop"),yield this.delay(3e3),o.play("Awards_Out"),yield this.delay(1e3*o.getAnimationState("Awards_Out").duration),yield this.delay(500),d.default.DespawnEffect("TDEX_SMALL_AWARD",this.awardNode),this.awardNode=null,this.UnUseSkill()})}UnUseSkill(){this.awardNode&&(d.default.DespawnEffect("TDEX_SMALL_AWARD",this.awardNode),this.awardNode=null),this.Reset(),this.isTest||super.UnUseSkill()}Reset(){this.dragonBallAnim.stop(),this.dragonBallNode.active=!1}CoinEffect(e,t=1.5){const i=d.default.SpawnEffect("CoinBlast"),a=e;let o=null;i&&(i.scale=a.radius/90*t,o=e.node.convertToWorldSpaceAR(cc.Vec2.ZERO),i.setPosition(i.parent.convertToNodeSpaceAR(o)))}SpreadSmallDragonBall(){let e=this.fake_fish_list,t=new Array;for(let i=0;i<e.length;i++)for(let a=0;a<e[i].qty;a++)t.push(e[i].odds);for(let i=0;i<t.length;i++){let e=cc.v2(.5*n.default.WinSize.width-50,.5*n.default.WinSize.height-50),a=2*(Math.random()-.5),o=2*(Math.random()-.5),r=cc.v2(a*e.x,o*e.y),s=this.dynamicBallWaitingTime;this.RandomlySpawnSmallDragonBall(r,t[i]*this.playerBet,s)}-1!=this.coinSound&&c.default.Instance.Stop(this.coinSound),this.coinSound=c.default.Instance.Play("34_coinjump_b")}RandomlySpawnSmallDragonBall(e,t,i){return o(this,void 0,void 0,function*(){let a=.8*i*Math.random();yield this.delay(1e3*a);let o=this.SpawnSmallDragonBall(cc.v2(0,0)),n=o.getComponent(cc.Animation);n.play("Dragon_Ball_NoRing_Reset"),o.runAction(cc.sequence(cc.moveTo(.35,e).easing(cc.easeBackOut()),cc.delayTime(i-a),cc.callFunc(()=>{n.play("Dragon_Ball_NoRing_Explode")}),cc.delayTime(.2),cc.callFunc(()=>{let i=e,a=s.default.WeaponPosition(this.playerSeat);h.default.SpawnWinScore(i,t,1,1,this.playerSeat,a,null)}),cc.delayTime(.6),cc.callFunc(()=>{d.default.DespawnEffect("TDEX_DG_Ball_Small",o)})))})}SpawnSmallDragonBall(e){let t=d.default.SpawnEffect("TDEX_DG_Ball_Small",!0);return t&&(t.stopAllActions(),t.scale=this.dynamicBallScale,t.angle=n.default.isReverse?180:0,t.setPosition(e)),t}onKeyDown(e){if(e.keyCode==cc.macro.KEY.f){if("Canvas"!=this.node.parent.name)return;this.limitTime=0,this.isTest=!0;let e={win_type:"fake_bomb_small",reward_list:[{odds:160,fake_fish:[{odds:2,type:0,qty:5},{odds:3,type:1,qty:1},{odds:4,type:2,qty:1},{odds:5,type:3,qty:9},{odds:7,type:5,qty:4},{odds:8,type:6,qty:2},{odds:12,type:9,qty:3},{odds:18,type:11,qty:1}]}],timestamp:1698643274,win:800,odds:160,seat:0,id:7876300,bet:5};this.Init(0,e)}}};a([u(cc.Animation)],y.prototype,"dragonBallAnim",void 0),a([u(cc.Node)],y.prototype,"dragonBallNode",void 0),a([u(cc.Float)],y.prototype,"dynamicBallScale",void 0),a([u(cc.Float)],y.prototype,"dynamicBallWaitingTime",void 0),y=a([m],y),i.default=y,cc._RF.pop()},{"../../../../../../FishCommon/Script/SSCanvasHandler":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Common/AudioManager":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Common/EnumFilter":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Common/ResourceManager":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Fish/FishManager":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Skill/BaseSkill":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Weapon/WeaponManager":void 0,"./SkillThunderDragonEx":"SkillThunderDragonEx"}],SkillThunderDragonEx:[function(e,t,i){"use strict";cc._RF.push(t,"4fb87Lhx6tDqo40Ll3rgarj","SkillThunderDragonEx");var a,o=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,r=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},n=this&&this.__awaiter||function(e,t,i,a){return new(i||(i=Promise))(function(o,n){function r(e){try{l(a.next(e))}catch(t){n(t)}}function s(e){try{l(a.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}l((a=a.apply(e,t||[])).next())})};Object.defineProperty(i,"__esModule",{value:!0});const r=e("../../../../../../FishCommon/Script/SSCanvasHandler"),s=e("../../../../../../FishHunter/Script/Game/MainGame/Player/PlayerManager"),l=e("../../../../../../FishHunter/Script/Game/MainGame/Fish/FishManager"),c=e("../../../../../../FishHunter/Script/Game/MainGame/Weapon/WeaponManager"),d=e("../../../../../../FishHunter/Script/Game/MainGame/Skill/BaseSkill"),h=e("../../../../../../FishHunter/Script/Game/MainGame/Common/AudioManager"),p=e("../../../../../../FishHunter/Script/Game/GameClient"),m=e("../../../../../../FishHunter/Script/Game/MainGame/Common/ResourceManager"),u=e("../../../../../../FishHunter/Script/Game/MainGame/Background/BaseBackGround"),y=e("../../../../../../FishHunter/Script/Game/MainGame/Common/Utility"),g=e("../../../../../../FishHunter/Script/Game/MainGame/Award/AwardManager"),f=e("../Effect/TDEX_MultiplyNumber"),_=e("../../../../../../FishHunter/Script/Game/MainGame/Common/ArkGameUtility"),v=e("../Common/PerspectiveCameraUtility");var S;(function(e){e[e.INIT=0]="INIT",e[e.IN=1]="IN",e[e.IMPACT=2]="IMPACT",e[e.FLAME=3]="FLAME"})(S||(S={}));const{ccclass:M,property:P}=cc._decorator;let C=a=class extends d.default{constructor(){super(...arguments),this.modelAnis=[],this.awakenCamera=null,this.frontDragonNode=null,this.backDragonNode=null,this.inAnimBackParent=null,this.inAnimFrontParent=null,this.rotatingCloudNode=null,this.dragonBallNode=null,this.dragonBallAnim=null,this.dragonBallRotateAnim=null,this.scoreBoardNode=null,this.scoreBoardAnim=null,this.scoreBoardLabel_m=null,this.scoreBoardLabel_s=null,this.winningBoardNode=null,this.winningBoardAnim=null,this.winningBoardLabel=null,this.vfxIn=null,this.vfxRoar_Orange=null,this.vfxRoar_Pink=null,this.vfxBall_Idle=null,this.vfxBall_Charge=null,this.vfxBall_Upgrade=null,this.vfxEnd=null,this.uiRootAry=[],this.cosmicBackground=null,this.isContinue=!0,this.previousSkillMultiply=1,this.currentSkillMultiplier=1,this.currentShowingCount=0,this.totalShowingCount=0,this.fishID=null,this.reward_list=[],this.currentRewardData=null,this.countingAct=null,this.coinSound=-1,this.animEvent=null,this.eventTimer=0,this.pauseAni=!1,this.USE_FAKE_DATA=!0,this.isTest=!1,this.idx=0}onLoad(){this.skillType=d.skillEnum.ThunderDragonEx,this.limitTime=120,this.Reset(!1)}onDestroy(){}update(e){super.update(e),this.eventTimer>0&&(this.eventTimer-=e,this.eventTimer<0&&(this.eventTimer=0,this.animEvent&&this.animEvent()))}InitProperties(e=null){super.InitProperties(),this.playerBet=e.bet,this.fishID=e.id,this.reward_list=e.reward_list,cc.warn("Reward List"),cc.warn(this.reward_list),this.isContinue=!0,this.previousSkillMultiply=1,this.currentSkillMultiplier=1,this.currentShowingCount=0,this.scoreBoardLabel_m.string="x1",this.scoreBoardLabel_s.string="0",this.totalShowingCount=this.reward_list.length,this.Reset(!0)}UseSkill(){var e,t,i,a,o,s;return n(this,void 0,void 0,function*(){let n=null===(e=l.default.Instance)||void 0===e?void 0:e.GetFishByID(this.fishID.toString());n&&n.FishDie(this.playerSeat),this.uiRootAry.forEach(e=>e.rotation=r.default.isReverse?180:0),this.SetDragonPosition(S.INIT),yield this.delay(2500),null===(t=h.default.Instance)||void 0===t||t.Fade(null===(i=h.default.Instance)||void 0===i?void 0:i.GetBGMID(),1,0),this.bgmID=null===(a=h.default.Instance)||void 0===a?void 0:a.Play("TDEX_Awaken_StartBGM",1,!0),null===(o=h.default.Instance)||void 0===o||o.Fade(this.bgmID,0,1),h.default.Instance.Play("TDEX_Awaken_Start"),this.SetDragonPosition(S.IN),this.PlayClip("start",!1),yield this.delay(100),this.vfxIn.active=!0,yield this.delay(100),this.vfxIn.parent=this.inAnimBackParent,yield this.delay(900),this.cosmicBackground=null===(s=m.default.LoadBackground(10))||void 0===s?void 0:s.getComponent(u.default),yield this.delay(600),this.dragonBallNode.active=!0,this.dragonBallAnim.play("Dragon_Ball_In"),this.vfxBall_Idle.active=!0,yield this.delay(300),r.default.CameraShakeEffect(1.5,3),this.awakenCamera.getComponent(v.PerspectiveCameraUtility).ShakeCamera(1.5,.3),yield this.delay(600),this.rotatingCloudNode.active=!0,yield this.delay(200),this.scoreBoardNode.active=!0,this.scoreBoardAnim.play("ScoreBoard_In"),yield this.delay(800),this.ShowNextSkill()})}UnUseSkill(){this.Reset(!1);for(let e=0;e<2;e++)this.modelAnis[e].stop();this.cosmicBackground&&(m.default.UnLoadBackground("logo",this.cosmicBackground.node),this.cosmicBackground=null,this.rotatingCloudNode.active=!1),this.isMainPlayer&&p.default.SkillSystem.SendCustomCmd("sk_DragonEX_finish"),super.UnUseSkill()}ShowNextSkill(){return n(this,void 0,void 0,function*(){yield this.delay(500),this.isContinue=this.currentShowingCount!=this.totalShowingCount-1,this.currentRewardData=this.reward_list[this.currentShowingCount],this.currentSkillMultiplier=this.currentRewardData.multi,this.currentOdds=this.currentRewardData.odds,this.currentSkillMultiplier==this.previousSkillMultiply?this.DragonFlaming():this.DragonballzImpact()})}DragonFlaming(){var e,t,i,a;return n(this,void 0,void 0,function*(){this.SetDragonPosition(S.FLAME),this.PlayClip("in",!1,()=>{this.PlayClip("loop",!0),h.default.Instance.Play("TDEX_Awaken_BreatheFire")}),h.default.Instance.Play("TDEX_Awaken_Enter"),yield this.delay(1660),this.vfxRoar_Orange.active=!0,this.vfxRoar_Pink.active=!0;for(let e=0;e<2;e++)this.vfxRoar_Orange.getComponentsInChildren(cc.ParticleSystem)[e].resetSystem(),this.vfxRoar_Pink.getComponentsInChildren(cc.ParticleSystem)[e].resetSystem();yield this.delay(140),this.SetDragonBallRotatingSpeed(3),r.default.CameraShakeEffect(2.5,4),this.awakenCamera.getComponent(v.PerspectiveCameraUtility).ShakeCamera(2.5,.4),this.scoreBoardAnim.play("ScoreBoard_Shake"),yield this.delay(300),this.vfxBall_Charge.active=!0,yield this.delay(1600),this.isContinue?(this.dragonBallAnim.play("Dragon_Ball_Flame"),this.scoreBoardAnim.play("ScoreBoard_Flame"),h.default.Instance.Play("TDEX_Awaken_Explosion")):(this.dragonBallAnim.play("Dragon_Ball_Out"),this.scoreBoardAnim.play("ScoreBoard_Ball_Break"),h.default.Instance.Play("TDEX_Awaken_BallExplosion")),yield this.delay(600),this.totalWin+=this.currentOdds*this.currentSkillMultiplier*this.playerBet,this.RandomlySpreadReward(this.RollLabelToTargetWinning.bind(this,this.totalWin,1.5)),this.SetDragonBallRotatingSpeed(1.5),this.isContinue||(m.default.UnLoadBackground("logo",this.cosmicBackground.node),this.cosmicBackground=null,this.rotatingCloudNode.active=!1),this.vfxRoar_Orange.active=!1,this.vfxRoar_Pink.active=!1,yield this.delay(200),this.PlayClip("out",!1),h.default.Instance.Play("TDEX_Awaken_Exit"),yield this.delay(1400),this.vfxBall_Charge.active=!1,this.isContinue?(yield this.delay(1e3),this.SetDragonBallRotatingSpeed(.75),yield this.delay(1e3),this.currentShowingCount++,this.ShowNextSkill()):(null===(e=h.default.Instance)||void 0===e||e.Stop(this.bgmID),this.bgmID=null,null===(t=h.default.Instance)||void 0===t||t.Play("TDEX_Awaken_EndBGM"),yield this.delay(4e3),this.isMainPlayer?this.ShowWinningBoard():(null===(i=h.default.Instance)||void 0===i||i.Fade(null===(a=h.default.Instance)||void 0===a?void 0:a.GetBGMID(),0,1),this.MoveScoreBoardToPlayer()))})}DragonballzImpact(){return n(this,void 0,void 0,function*(){this.previousSkillMultiply++,this.SetDragonPosition(S.IMPACT),this.PlayClip("hit",!1),h.default.Instance.Play("TDEX_Awaken_HitBall"),yield this.delay(400),r.default.CameraShakeEffect(1,2),this.dragonBallAnim.play("Dragon_Ball_Impact"),yield this.delay(200),this.scoreBoardLabel_m.string="x"+this.previousSkillMultiply,this.scoreBoardAnim.play("ScoreBoard_Impact"),h.default.Instance.Play("TDEX_Awaken_MultipleAdd"),this.SetDragonBallRotatingSpeed(2),this.vfxBall_Upgrade.active=!0,yield this.delay(1e3),this.SetDragonBallRotatingSpeed(.75),yield this.delay(500),this.vfxBall_Upgrade.active=!1,this.ShowNextSkill()})}MoveScoreBoardToPlayer(){return n(this,void 0,void 0,function*(){let e,t=c.default.WeaponUIPosition(this.playerSeat);(e=r.default.isReverse?cc.moveTo(1,t.add(new cc.Vec2(0,this.playerSeat>1?270:-35))):cc.moveTo(1,t.add(new cc.Vec2(0,this.playerSeat>1?-35:270)))).easing(cc.easeQuadraticActionOut()),this.scoreBoardAnim.node.runAction(cc.sequence(e,cc.delayTime(2.5),cc.callFunc(()=>n(this,void 0,void 0,function*(){this.scoreBoardAnim.play("ScoreBoard_Out");let e=this.scoreBoardAnim.getAnimationState("ScoreBoard_Out");yield this.delay(e?1e3*e.duration:200),this.UnUseSkill()}))))})}ShowWinningBoard(){var e,t;return n(this,void 0,void 0,function*(){this.scoreBoardAnim.play("ScoreBoard_Out");let i=this.scoreBoardAnim.getAnimationState("ScoreBoard_Out");yield this.delay(i?1e3*i.duration:200),this.PlayAwardSound(),this.winningBoardNode.active=!0,this.winningBoardLabel.string=this.totalWin.toLocaleString(),this.winningBoardAnim.play("WinBoard_In"),i=this.winningBoardAnim.getAnimationState("WinBoard_In"),yield this.delay(i?1e3*i.duration:200),this.winningBoardAnim.play("WinBoard_Loop"),yield this.delay(5e3),this.winningBoardAnim.play("WinBoard_Out"),i=this.winningBoardAnim.getAnimationState("WinBoard_Out"),yield this.delay(i?1e3*i.duration:200),this.isGaveAward=!0,null===(e=h.default.Instance)||void 0===e||e.Fade(null===(t=h.default.Instance)||void 0===t?void 0:t.GetBGMID(),0,1),this.UnUseSkill()})}SetDragonPosition(e){switch(e){case S.INIT:this.frontDragonNode.position=new cc.Vec3(0,0,-2e3),this.backDragonNode.position=new cc.Vec3(0,0,-2e3);break;case S.IN:this.frontDragonNode.active=!0,this.backDragonNode.active=!0,cc.tween(this.frontDragonNode).to(.5,{position:cc.v3(0,0,-700)}).start(),cc.tween(this.backDragonNode).to(.5,{position:cc.v3(0,0,-700)}).start();break;case S.IMPACT:this.frontDragonNode.position=new cc.Vec3(0,0,-1e3),this.backDragonNode.position=new cc.Vec3(0,0,-1e3);break;case S.FLAME:this.frontDragonNode.position=new cc.Vec3(5,-15,-750),this.backDragonNode.position=new cc.Vec3(-10,3,-870);break;default:cc.error("WHY?")}}SetDragonBallRotatingSpeed(e){let t=this.dragonBallRotateAnim.getAnimationState(this.dragonBallRotateAnim.defaultClip.name);t&&(t.speed=e)}Reset(e){this.awakenCamera.node.active=e;for(let t=0;t<this.modelAnis.length;t++)this.modelAnis[t].stop();this.frontDragonNode.active=!1,this.backDragonNode.active=!1,this.rotatingCloudNode.active=!1,this.dragonBallNode.active=!1,this.scoreBoardNode.active=!1,this.winningBoardNode.active=!1,this.vfxIn.active=!1,this.vfxRoar_Orange.active=!1,this.vfxRoar_Pink.active=!1,this.vfxBall_Idle.active=!1,this.vfxBall_Charge.active=!1,this.vfxBall_Upgrade.active=!1,this.vfxEnd.active=!1,this.vfxIn.parent=this.inAnimFrontParent,this.SetDragonBallRotatingSpeed(.75),this.scoreBoardAnim.node.setPosition(new cc.Vec2(0,0))}PauseClip(){for(let e=0;e<this.modelAnis.length;e++)this.modelAnis[e].pause();this.pauseAni=!0}ResumeClip(){for(let e=0;e<this.modelAnis.length;e++)this.modelAnis[e].resume();this.pauseAni=!1}PlayClip(e,t,i){for(let a=0;a<this.modelAnis.length;a++){this.animEvent=null,this.modelAnis[a].play(e);let o=this.modelAnis[a].getAnimationState(e);o&&(o.repeatCount=t?cc.macro.REPEAT_FOREVER:1,o.speed=1,i&&(this.eventTimer=o.duration,this.animEvent=i))}}SetClipSpeed(e){for(let t=0;t<this.modelAnis.length;t++){let i=this.modelAnis[t].getAnimationState(this.modelAnis[t].currentClip.name);if(i){let t=i.speed;t!=e&&(i.speed=e,this.eventTimer>0&&(this.eventTimer=this.eventTimer*(t/e)))}}}RollLabelToTargetWinning(e,t=.5){if(this.countingAct&&(this.scoreBoardLabel_s.node.stopAction(this.countingAct),this.countingAct=null),t>0){let i=t/.05,a=(e-this.currentWin)/i;this.countingAct=cc.repeat(cc.sequence(cc.callFunc(()=>{this.currentWin+=a,this.scoreBoardLabel_s.string=y.default.NumberformatBet(this.currentWin,this.playerBet)}),cc.delayTime(.05)),i),this.scoreBoardLabel_s.node.runAction(this.countingAct)}else this.currentWin=e,this.scoreBoardLabel_s.string=y.default.NumberformatBet(this.currentWin,this.playerBet)}RandomlySpreadReward(e){let t=this.currentRewardData.fake_fish,i=new Array;for(let a=0;a<t.length;a++)for(let e=0;e<t[a].qty;e++)i.push(t[a].odds);for(let o=0;o<i.length;o++){let t=cc.v2(.5*r.default.WinSize.width-50,.5*r.default.WinSize.height-50),n=2*(Math.random()-.5),s=2*(Math.random()-.5),l=cc.v2(n*t.x,s*t.y),c=this.scoreBoardLabel_s.node.convertToWorldSpaceAR(cc.Vec2.ZERO).subSelf(cc.v2(.5*r.default.WinSize.width,.5*r.default.WinSize.height));r.default.isReverse&&(c.y=-c.y),a.SpawnWinScore(l,i[o]*this.playerBet,this.currentSkillMultiplier,this.playerBet,this.playerSeat,c,0==o?e:null)}-1!=this.coinSound&&h.default.Instance.Stop(this.coinSound),this.coinSound=h.default.Instance.Play("34_coinjump_b")}static SpawnWinScore(e,t,i,a,o,r,l){var c,d;return n(this,void 0,void 0,function*(){let n=this.SpawnAward(e);null===(c=n.getComponent(f.default))||void 0===c||c.SetFont(s.PlayerManager.isMainSeat(o)),null===(d=n.getComponent(f.default))||void 0===d||d.SetScoreAndMultiply(y.default.NumberformatBet(t,a),i.toLocaleString()),n.scale=.5;let h=cc.v2(Math.random()-.5,Math.random()-.5);n.runAction(cc.spawn(cc.sequence(cc.scaleTo(.1,2.1).easing(cc.easeBackOut()),cc.scaleTo(.3,1)),cc.moveBy(.1,h.mul(50)),cc.callFunc(()=>{let e=cc.v2(Math.random()-.5,Math.random()-.5).add(h);n.runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(1.5,e.mul(25)).easing(cc.easeIn(1)),cc.callFunc(()=>{g.default.Instance.DropCoin(n.getPosition(),o,!1,!1,t,r),m.default.DespawnEffect("TDEX_MPN",n)})))}))),yield _.WaitForSeconds(3.5),l&&l()})}static SpawnAward(e){let t=m.default.SpawnEffect("TDEX_MPN",!0);return t&&(t.stopAllActions(),t.setScale(1),t.angle=r.default.isReverse?180:0,t.setPosition(e)),t}onKeyDown(e){if(e.keyCode==cc.macro.KEY.d){if("Canvas"!=this.node.parent.name)return;this.isTest=!0;let e={win_type:"fake_bomb_ultimate",reward_list:[{odds:40,multi:1,fake_fish:[{odds:9,type:7,qty:1},{odds:10,type:8,qty:2},{odds:3,type:1,qty:1},{odds:2,type:0,qty:4}]},{odds:30,multi:2,fake_fish:[{odds:2,type:0,qty:4},{odds:3,type:1,qty:1},{odds:4,type:2,qty:3},{odds:7,type:5,qty:1}]},{odds:32,multi:3,fake_fish:[{odds:2,type:0,qty:3},{odds:3,type:1,qty:2},{odds:4,type:2,qty:2},{odds:5,type:3,qty:1},{odds:7,type:5,qty:1}]}],timestamp:1698643274,win:2e3,odds:400,seat:0,id:7876300,bet:5};this.Init(0,e)}if(e.keyCode==cc.macro.KEY.q){switch(this.idx){case 0:this.SetDragonPosition(S.INIT),this.SetDragonPosition(S.IN);break;case 1:case 2:case 3:case 4:this.SetDragonPosition(S.IMPACT);break;case 5:case 6:case 7:this.SetDragonPosition(S.FLAME);break;case 8:this.SetDragonPosition(S.INIT);break;default:cc.error("How?")}let e=this.modelAnis[0].getClips()[this.idx].name;cc.warn(e),this.PlayClip(e,!1),this.idx++,this.idx>=this.modelAnis[0].getClips().length&&(this.idx=0)}e.keyCode==cc.macro.KEY.w&&(this.vfxIn.active=!this.vfxIn.active),e.keyCode==cc.macro.KEY.e&&(this.vfxRoar_Orange.active=!this.vfxRoar_Orange.active),e.keyCode==cc.macro.KEY.r&&(this.vfxRoar_Pink.active=!this.vfxRoar_Pink.active),e.keyCode==cc.macro.KEY.t&&(this.vfxBall_Idle.active=!this.vfxBall_Idle.active),e.keyCode==cc.macro.KEY.y&&(this.vfxBall_Charge.active=!this.vfxBall_Charge.active),e.keyCode==cc.macro.KEY.u&&(this.vfxBall_Upgrade.active=!this.vfxBall_Upgrade.active),e.keyCode==cc.macro.KEY.i&&(this.vfxEnd.active=!this.vfxEnd.active),e.keyCode==cc.macro.KEY.g&&(1==this.pauseAni?this.ResumeClip():this.PauseClip())}};o([P([cc.SkeletonAnimation])],C.prototype,"modelAnis",void 0),o([P(cc.Camera)],C.prototype,"awakenCamera",void 0),o([P(cc.Node)],C.prototype,"frontDragonNode",void 0),o([P(cc.Node)],C.prototype,"backDragonNode",void 0),o([P(cc.Node)],C.prototype,"inAnimBackParent",void 0),o([P(cc.Node)],C.prototype,"inAnimFrontParent",void 0),o([P(cc.Node)],C.prototype,"rotatingCloudNode",void 0),o([P(cc.Node)],C.prototype,"dragonBallNode",void 0),o([P(cc.Animation)],C.prototype,"dragonBallAnim",void 0),o([P(cc.Animation)],C.prototype,"dragonBallRotateAnim",void 0),o([P(cc.Node)],C.prototype,"scoreBoardNode",void 0),o([P(cc.Animation)],C.prototype,"scoreBoardAnim",void 0),o([P(cc.Label)],C.prototype,"scoreBoardLabel_m",void 0),o([P(cc.Label)],C.prototype,"scoreBoardLabel_s",void 0),o([P(cc.Node)],C.prototype,"winningBoardNode",void 0),o([P(cc.Animation)],C.prototype,"winningBoardAnim",void 0),o([P(cc.Label)],C.prototype,"winningBoardLabel",void 0),o([P(cc.Node)],C.prototype,"vfxIn",void 0),o([P(cc.Node)],C.prototype,"vfxRoar_Orange",void 0),o([P(cc.Node)],C.prototype,"vfxRoar_Pink",void 0),o([P(cc.Node)],C.prototype,"vfxBall_Idle",void 0),o([P(cc.Node)],C.prototype,"vfxBall_Charge",void 0),o([P(cc.Node)],C.prototype,"vfxBall_Upgrade",void 0),o([P(cc.Node)],C.prototype,"vfxEnd",void 0),o([P([cc.Node])],C.prototype,"uiRootAry",void 0),C=a=o([M],C),i.default=C,cc._RF.pop()},{"../../../../../../FishCommon/Script/SSCanvasHandler":void 0,"../../../../../../FishHunter/Script/Game/GameClient":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Award/AwardManager":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Background/BaseBackGround":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Common/ArkGameUtility":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Common/AudioManager":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Common/ResourceManager":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Common/Utility":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Fish/FishManager":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Player/PlayerManager":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Skill/BaseSkill":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Weapon/WeaponManager":void 0,"../Common/PerspectiveCameraUtility":"PerspectiveCameraUtility","../Effect/TDEX_MultiplyNumber":"TDEX_MultiplyNumber"}],Sync_Effect_Opacity:[function(e,t,i){"use strict";cc._RF.push(t,"d3196sAoZ9F3oGBp+VdqNER","Sync_Effect_Opacity");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,r=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});const{ccclass:o,property:n,executeInEditMode:r}=cc._decorator;let s=class extends cc.Component{constructor(){super(...arguments),this.meshRenderer=null,this.targetMaterial=null,this.newMat=null}onEnable(){null==this.newMat&&(this.newMat=cc.MaterialVariant.create(this.targetMaterial,this.meshRenderer),this.meshRenderer.setMaterial(0,this.newMat))}update(e){null!=this.newMat&&this.newMat.setProperty("_Opacity",this.node.opacity/255,0)}};a([n(cc.MeshRenderer)],s.prototype,"meshRenderer",void 0),a([n(cc.Material)],s.prototype,"targetMaterial",void 0),s=a([o,r],s),i.default=s,cc._RF.pop()},{}],TDEX_MultiplyNumber:[function(e,t,i){"use strict";cc._RF.push(t,"11ee7utcsBFF5k2S0JGnJ3F","TDEX_MultiplyNumber");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,r=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});const{ccclass:o,property:n}=cc._decorator;let r=class extends cc.Component{constructor(){super(...arguments),this.score=null,this.multi=null,this.mainPlayerFont=null,this.otherPlayerFont=null}onLoad(){this.score.node.active=!0,this.multi.node.active=!1}SetFont(e){this.score.font=e?this.mainPlayerFont:this.otherPlayerFont}SetScoreAndMultiply(e,t){this.multi.node.active=+t>1,this.score.string=e,this.multi.string="x"+t}};a([n(cc.Label)],r.prototype,"score",void 0),a([n(cc.Label)],r.prototype,"multi",void 0),a([n(cc.Font)],r.prototype,"mainPlayerFont",void 0),a([n(cc.Font)],r.prototype,"otherPlayerFont",void 0),r=a([o],r),i.default=r,cc._RF.pop()},{}],THUNDER_DRAGON_EX:[function(e,t,i){"use strict";cc._RF.push(t,"0d284ifKEdDpJGT5r5svG5V","THUNDER_DRAGON_EX");var a,o=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,r=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},n=this&&this.__awaiter||function(e,t,i,a){return new(i||(i=Promise))(function(o,n){function r(e){try{l(a.next(e))}catch(t){n(t)}}function s(e){try{l(a.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}l((a=a.apply(e,t||[])).next())})};Object.defineProperty(i,"__esModule",{value:!0});const r=e("../Common/FishCamera3DHandler"),s=e("../../../../../../FishHunter/Script/Game/MainGame/Common/AudioManager"),l=e("../../../../../../FishCommon/Script/SSCanvasHandler"),c=e("../../../../../../FishHunter/Script/Game/MainGame/Fish/BaseFish"),d=e("../../../../../../FishHunter/Script/Game/MainGame/Common/ResourceManager"),h=e("../../../../../../FishHunter/Script/Game/MainGame/Common/PoolObj"),p=e("../../../../../../FishHunter/Script/Game/MainGame/Player/PlayerManager"),{ccclass:m,property:u,executeInEditMode:y}=cc._decorator;let g=a=class extends c.default{constructor(){super(...arguments),this.modelOffsets=[],this.ModelAni=null,this.SMR=[],this.modelMat=null,this.modelStartColor=null,this.bodySMR=[],this.bodyMat=null,this.bodyStartColor=null,this.keyPointSearchString="",this.iceGroup=[],this.dropCoinColliderList=[],this.particleGroup=[],this.skeletons=[],this.colliderGroupNode=null,this.boneNodeMap=null,this.newMat=[],this.bodyNewMat=[],this.modelColor=null,this.bodyColor=null,this.animEvent=null,this.eventTimer=0,this.timerPause=!1,this.modelColorTween=null,this.bodyColorTween=null,this.randomSeed=0,this.isTest=!1}onLoad(){this.ModelAni.stop(),cc.warn("THUNDER_DRAGON_EX onLoad");for(let e=0;e<this.SMR.length;e++)this.skeletons[e]=this.SMR[e].skeleton;this.colliderGroupNode=this.node.getChildByName("Colliders"),this.subColliderList=this.node.getComponentsInChildren(cc.CircleCollider),this.ModelAni&&(this.shapeNode=this.ModelAni.node),this.canCollision=!1,this.particleGroup=this.node.getComponentsInChildren(cc.ParticleSystem3D)}onEnable(){this.Enable3DCamera()}Enable3DCamera(){0==a.camera3DCount&&r.default.Instance.camera3D&&(r.default.Instance.camera3D.enabled=!0),a.camera3DCount++,console.error("ENABLE 3D Camera,"+a.camera3DCount)}Disable3DCamera(){a.camera3DCount--,0==a.camera3DCount&&r.default.Instance.camera3D&&(r.default.Instance.camera3D.enabled=!1),console.error("DISABLE 3D Camera,"+a.camera3DCount)}update(e){if(super.update(e),this.modelColorTween)for(let t=0;t<this.newMat.length;t++)this.newMat[t].setProperty("_Color",this.modelColor,0);if(this.bodyColorTween)for(let t=0;t<this.bodyNewMat.length;t++)this.bodyNewMat[t].setProperty("_Color",this.bodyColor,0);this.timerPause||(this.eventTimer>0&&(this.eventTimer-=e,this.eventTimer<0&&(this.eventTimer=0,this.animEvent&&this.animEvent())),this.UpdateCollider(),null!=cc.director.getScene().getChildByName("COLLISION_MANAGER_DEBUG_DRAW")&&(cc.director.getScene().getChildByName("COLLISION_MANAGER_DEBUG_DRAW").group="UI"))}Init(e,t){if(e&&super.Init(e,t),0==this.newMat.length)for(let n=0;n<this.SMR.length;n++)this.newMat.push(cc.MaterialVariant.create(this.modelMat,this.SMR[n])),this.SMR[n].setMaterial(0,this.newMat[n]);if(0==this.bodyNewMat.length)for(let n=0;n<this.bodySMR.length;n++)this.bodyNewMat.push(cc.MaterialVariant.create(this.bodyMat,this.bodySMR[n])),this.bodySMR[n].setMaterial(0,this.bodyNewMat[n]);for(let n=0;n<this.newMat.length;n++)this.newMat[n].setProperty("_Color",this.modelStartColor,0);for(let n=0;n<this.bodyNewMat.length;n++)this.bodyNewMat[n].setProperty("_Color",this.bodyStartColor,0);this.modelColor=this.modelStartColor.clone(),this.bodyColor=this.bodyStartColor.clone(),this.canCollision=!1,cc.tween(this.node).delay(.1).call(()=>{this.canCollision=!0}).start(),this.boneNodeMap=new Map,this.colliderGroupNode&&this.SetBoneData(),this.iceGroup.forEach(e=>e.active=!1);let i=this.isTest?0:Math.floor(3*this.RandomBySeed());3==i&&(i=2),this.ModelAni.node.setPosition(this.modelOffsets[i].getPosition());let a=new cc.Quat;this.modelOffsets[i].getRotation(a),this.ModelAni.node.setRotation(a);let o=this.ModelAni.getClips()[i].name;this.PlayClip(o,!1,()=>{this.AnimeEndEvent()}),this.PlaySoundByAnimIndex(i),this.SetClipSpeed(.6),this.particleGroup.forEach(e=>{e.play()})}InitParameter(){super.InitParameter(),this.node.setPosition(cc.Vec2.ZERO),this.node.angle=0,this.randomSeed=parseInt(this.ID),this.isFeature=!0}PauseBehavior(e,t){super.PauseBehavior(e,t),this.ModelAni.pause(),this.timerPause=!0,this.iceGroup.forEach(e=>{e.active=!0}),this.particleGroup.forEach(e=>{e.stop()})}ResumeBehavior(){super.ResumeBehavior(),this.ModelAni.resume(),this.timerPause=!1,this.iceGroup.forEach(e=>{e.active=!1}),this.particleGroup.forEach(e=>{e.play()})}FishDie(e){return n(this,void 0,void 0,function*(){s.default.Instance.Play("catch_cavial"),this.aliveStatus=c.FishState.DEAD,this.canCollision=!1,this.isInit=!1,this.PauseClip(),this.eventTimer=0,this.animEvent=null,this.node.opacity=255,this.Event_FishLeave&&this.Event_FishLeave(this,6),this.ResetColorTween(),this.node.runAction(cc.sequence(cc.repeat(cc.sequence(cc.moveTo(.05,this.node.getPosition().add(new cc.Vec2(5,5))),cc.moveTo(.05,this.node.getPosition().add(new cc.Vec2(-5,-5)))),10),cc.delayTime(.1),cc.callFunc(()=>{s.default.Instance.Play("TDEX_Catch_Coin"),this.CoinKillKing(e),this.FadeOutColorTween(1),this.particleGroup.forEach(e=>{e.stop()})}),cc.delayTime(1),cc.callFunc(()=>{this.RemoveSelf()}))),s.default.Instance.Play("TDEX_Catch_Roar")})}CoinKillKing(e){p.PlayerManager.isMainSeat(e)&&l.default.CameraShakeEffect(.25,6,.1),this.dropCoinColliderList.forEach(e=>{const t=d.default.SpawnEffect("KillKing").getComponent(h.default);if(t){let i=null;t&&(i=e.node.convertToWorldSpaceAR(cc.Vec2.ZERO),t.node.setPosition(t.node.parent.convertToNodeSpaceAR(i)))}this.scheduleOnce(()=>{t.Recycle()},2.5)})}FishFadeOut(e,t){this.aliveStatus==c.FishState.ALIVE&&(this.SetClipSpeed(1),this.ResetColorTween(),this.canCollision=!1,this.fadeEffectAcion=this.node.runAction(cc.sequence(cc.callFunc(()=>{this.FadeOutColorTween(e)}),cc.delayTime(e),cc.callFunc(()=>{this.FishOut(t)}))))}AnimeEndEvent(){this.canCollision=!1,this.isTest||this.scheduleOnce(this.FishOut.bind(this,c.FishOutType.FISH_PATH_FINISH),1.5)}RemoveSelf(){this.Disable3DCamera(),this.ModelAni.stop(),this.timerPause=!1,null!=this.boneNodeMap&&this.boneNodeMap.clear(),this.boneNodeMap=null,super.RemoveSelf()}PlaySoundByAnimIndex(e){return n(this,void 0,void 0,function*(){switch(e){case 0:yield this.delay(1e3),s.default.Instance.Play("TDEX_Into_Lightning"),l.default.CameraShakeEffect(1,1.5);break;case 1:case 2:s.default.Instance.Play("TDEX_Into_Lightning"),l.default.CameraShakeEffect(1,1.5)}})}getFishPos(){if(this.mainCoillder)return this.mainCoillder.convertToWorldSpaceAR(cc.Vec2.ZERO);if(0==this.subColliderList.length)return this.shapeNode.convertToWorldSpaceAR(cc.Vec2.ZERO);let e=this.subColliderList[0].node.convertToWorldSpaceAR(cc.Vec2.ZERO),t=null;for(let i=1;i<this.subColliderList.length;i++)t=this.subColliderList[i].node.convertToWorldSpaceAR(cc.Vec2.ZERO),cc.Vec2.ZERO.sub(t).mag()<cc.Vec2.ZERO.sub(e).mag()&&(e=t);return e}getColliderByIndex(e){return e<this.subColliderList.length?this.subColliderList[e]:null}ProjectColliderToScreen(e,t){let i=t.convertToWorldSpaceAR(cc.Vec3.ZERO),a=r.default.Instance.camera3D.node.convertToWorldSpaceAR(cc.Vec3.ZERO),o=-i.sub(a).z;if(o<=0)return void e.node.setPosition(new cc.Vec2(7876300,7876300));let n=new cc.Vec2;r.default.Instance.camera3D.getWorldToScreenPoint(i,n);let s=e.node.parent.convertToNodeSpaceAR(n);e.node.setPosition(new cc.Vec3(s.x,s.y,100));let l=75;e.node==this.mainCoillder&&(l=100);let c=Math.abs(l/o*1e3);e.getComponent(cc.CircleCollider).radius=c}UpdateCollider(){if(null!=this.ModelAni&&null!=this.subColliderList&&null!=this.boneNodeMap&&this.subColliderList.length>0&&this.boneNodeMap.size>0)for(let e=0;e<this.subColliderList.length;e++){let t=this.boneNodeMap.get(this.subColliderList[e].node.name);this.subColliderList[e].node.active=this.canCollision,this.ProjectColliderToScreen(this.subColliderList[e].getComponent(cc.CircleCollider),t)}}FindChildByNameRecursive(e,t){if(e.name==t)return e;for(let i=0;i<e.children.length;i++){const a=e.children[i];let o=this.FindChildByNameRecursive(a,t);if(o)return o}return null}SetBoneData(){this.boneNodeMap.clear();let e=null;this.subColliderList.forEach(t=>{let i=t.node.name;(e=this.FindChildByNameRecursive(this.node,i))&&this.boneNodeMap.set(t.node.name,e)}),cc.log("THUNDER_DRAGON_EX,this.boneNodeMap = "),cc.log(this.boneNodeMap)}OnHitFish(){this.ResetColorTween(),this.modelColorTween=cc.tween(this.modelColor).repeat(2,cc.tween(this.modelColor).to(.1,{r:200,g:128,b:128}).to(.1,{r:255,g:255,b:255})).call(()=>{this.modelColorTween=null,this.modelColor=this.modelStartColor.clone();for(let e=0;e<this.newMat.length;e++)this.newMat[e].setProperty("_Color",this.modelColor,0)}).start(),this.bodyColorTween=cc.tween(this.bodyColor).repeat(2,cc.tween(this.bodyColor).to(.1,{r:200,g:128,b:128}).to(.1,{r:255,g:255,b:255})).call(()=>{this.bodyColorTween=null,this.bodyColor=this.bodyStartColor.clone();for(let e=0;e<this.bodyNewMat.length;e++)this.bodyNewMat[e].setProperty("_Color",this.bodyColor,0)}).start()}ResetColorTween(){if(this.modelColorTween){this.modelColorTween.stop(),this.modelColorTween=null,this.modelColor=this.modelStartColor.clone();for(let e=0;e<this.newMat.length;e++)this.newMat[e].setProperty("_Color",this.modelColor,0)}if(this.bodyColorTween){this.bodyColorTween.stop(),this.bodyColorTween=null,this.bodyColor=this.bodyStartColor.clone();for(let e=0;e<this.bodyNewMat.length;e++)this.bodyNewMat[e].setProperty("_Color",this.bodyColor,0)}}FadeOutColorTween(e){this.modelColorTween=cc.tween(this.modelColor).to(e,{r:this.modelColor.r,g:this.modelColor.g,b:this.modelColor.b,a:0}).call(()=>{this.modelColorTween=null}).start(),this.bodyColorTween=cc.tween(this.bodyColor).to(e,{r:this.bodyColor.r,g:this.bodyColor.g,b:this.bodyColor.b,a:0}).call(()=>{this.bodyColorTween=null}).start()}PauseClip(){this.ModelAni.pause(),this.timerPause=!0}ResumeClip(){this.ModelAni.resume(),this.timerPause=!1}PlayClip(e,t,i){this.animEvent=null,this.ModelAni.play(e);let a=this.ModelAni.getAnimationState(e);a&&(a.repeatCount=t?cc.macro.REPEAT_FOREVER:1,a.speed=1,i&&(this.eventTimer=a.duration,this.animEvent=i))}SetClipSpeed(e){let t=this.ModelAni.getAnimationState(this.ModelAni.currentClip.name);if(t){let i=t.speed;i!=e&&(t.speed=e,this.eventTimer>0&&(this.eventTimer=this.eventTimer*(i/e)))}}RandomBySeed(){return this.randomSeed=Math.floor(this.randomSeed%233280),this.randomSeed=(9301*this.randomSeed+49297)%233280,this.randomSeed/233280}onKeyDown(e){if(e.keyCode==cc.macro.KEY.s){if("Canvas"!=this.node.parent.name)return;this.isTest=!0,this.Init(null,null)}if(e.keyCode==cc.macro.KEY.b&&this.FadeOutColorTween(1),e.keyCode==cc.macro.KEY.n){const e=cc.director.getCollisionManager();e.enabled=!0,e.enabledDebugDraw=!e.enabledDebugDraw,console.log("%c[DebugManager] HitBox: %s","color:red",e.enabledDebugDraw)}e.keyCode==cc.macro.KEY.g&&(1==this.timerPause?this.ResumeClip():this.PauseClip()),e.keyCode==cc.macro.KEY.h&&this.OnHitFish(),e.keyCode==cc.macro.KEY.l&&console.error(" \u958b\u59cb\u984f\u8272 = "+this.modelStartColor+"  \u8907\u88fd\u984f\u8272 = "+this.modelColor),e.keyCode==cc.macro.KEY.k&&(this.modelColor=cc.Color.WHITE,console.error("kkk \u958b\u59cb\u984f\u8272 = "+this.modelStartColor+"  \u8907\u88fd\u984f\u8272 = "+this.modelColor))}};g.camera3DCount=0,o([u([cc.Node])],g.prototype,"modelOffsets",void 0),o([u(cc.SkeletonAnimation)],g.prototype,"ModelAni",void 0),o([u([cc.SkinnedMeshRenderer])],g.prototype,"SMR",void 0),o([u(cc.Material)],g.prototype,"modelMat",void 0),o([u(cc.Color)],g.prototype,"modelStartColor",void 0),o([u([cc.SkinnedMeshRenderer])],g.prototype,"bodySMR",void 0),o([u(cc.Material)],g.prototype,"bodyMat",void 0),o([u(cc.Color)],g.prototype,"bodyStartColor",void 0),o([u(cc.String)],g.prototype,"keyPointSearchString",void 0),o([u([cc.Node])],g.prototype,"iceGroup",void 0),o([u([cc.Collider])],g.prototype,"dropCoinColliderList",void 0),g=a=o([m,y],g),i.default=g,cc._RF.pop()},{"../../../../../../FishCommon/Script/SSCanvasHandler":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Common/AudioManager":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Common/PoolObj":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Common/ResourceManager":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Fish/BaseFish":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Player/PlayerManager":void 0,"../Common/FishCamera3DHandler":"FishCamera3DHandler"}],ThunderDragonExTitle:[function(e,t,i){"use strict";cc._RF.push(t,"dc918fNEYVPIaVt5ST6svKn","ThunderDragonExTitle");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,r=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},o=this&&this.__awaiter||function(e,t,i,a){return new(i||(i=Promise))(function(o,n){function r(e){try{l(a.next(e))}catch(t){n(t)}}function s(e){try{l(a.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}l((a=a.apply(e,t||[])).next())})};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../../../../../FishHunter/Script/Game/MainGame/Common/ResourceManager"),r=e("../../../../../../FishCommon/Script/SSCanvasHandler"),s=e("../../../../../../FishHunter/Script/Game/MainGame/Title/BaseTitle"),l=e("../../../../../../FishHunter/Script/Game/MainGame/Common/AudioManager"),c=e("../Common/PerspectiveCameraUtility"),{ccclass:d,property:h}=cc._decorator;let p=class extends s.default{constructor(){super(...arguments),this.modelAni=null,this.cameraAni=null,this.modelCamera=null,this.vfxCamera=null,this.dragonNode=null,this.vfxStart=null,this.vfxEyeflash=null,this.vfxRoar=null,this.animEvent=null,this.eventTimer=0,this.eventName=0,this.pauseAni=!1,this.isTest=!1}onLoad(){this.Reset(!1)}onDestroy(){}update(e){this.eventTimer>0&&(this.eventTimer-=e,this.eventTimer<0&&(this.eventTimer=0,this.animEvent&&this.animEvent()))}EndEvent(){this.Reset(!1),cc.warn("Despawn ThunderDragonExTitle!"),this.isTest||n.default.DespawnTitle(this.eventName,this.node)}Play(e){return o(this,void 0,void 0,function*(){this.eventName=e,this.node.angle=r.default.isReverse?180:0,this.Reset(!0),this.vfxStart.active=!0,r.default.CameraShakeEffect(1.5,2),yield this.delay(1e3),l.default.Instance.Play("TDEX_Open"),yield this.delay(1500),this.dragonNode.active=!0;let t=this.modelAni.getClips()[0].name;this.PlayClip(t,!1,()=>{this.EndEvent()}),this.vfxEyeflash.active=!0,yield this.delay(500),yield this.delay(2e3),this.vfxRoar.active=!0,yield this.delay(100),r.default.CameraShakeEffect(1.5,8),this.modelCamera.getComponent(c.PerspectiveCameraUtility).ShakeCamera(1.5,.8)})}Reset(e){this.modelCamera.node.active=e,this.vfxCamera.node.active=e,this.modelAni.stop(),this.cameraAni.stop(),this.dragonNode.active=!1,this.vfxStart.active=!1,this.vfxEyeflash.active=!1,this.vfxRoar.active=!1}PauseClip(){this.modelAni.pause(),this.pauseAni=!0}ResumeClip(){this.modelAni.resume(),this.pauseAni=!1}PlayClip(e,t,i){this.animEvent=null,this.modelAni.play(e),this.cameraAni.play(e);let a=this.modelAni.getAnimationState(e);a&&(a.repeatCount=t?cc.macro.REPEAT_FOREVER:1,a.speed=1,i&&(this.eventTimer=a.duration,this.animEvent=i))}onKeyDown(e){if(e.keyCode==cc.macro.KEY.a){if("Canvas"!=this.node.parent.name)return;this.isTest=!0,this.Play(1011)}}};a([h(cc.SkeletonAnimation)],p.prototype,"modelAni",void 0),a([h(cc.SkeletonAnimation)],p.prototype,"cameraAni",void 0),a([h(cc.Camera)],p.prototype,"modelCamera",void 0),a([h(cc.Camera)],p.prototype,"vfxCamera",void 0),a([h(cc.Node)],p.prototype,"dragonNode",void 0),a([h(cc.Node)],p.prototype,"vfxStart",void 0),a([h(cc.Node)],p.prototype,"vfxEyeflash",void 0),a([h(cc.Node)],p.prototype,"vfxRoar",void 0),p=a([d],p),i.default=p,cc._RF.pop()},{"../../../../../../FishCommon/Script/SSCanvasHandler":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Common/AudioManager":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Common/ResourceManager":void 0,"../../../../../../FishHunter/Script/Game/MainGame/Title/BaseTitle":void 0,"../Common/PerspectiveCameraUtility":"PerspectiveCameraUtility"}]},{},["LockWeaponMF","InGamePopupMgr","InGameTeachPopup","FM_MaterialManager","FlowMap","FlashLight","NodeParticleNew","PlayAnimation","Sync_Effect_Opacity","FishCamera3DHandler","ParticleSystem3DReset","PerspectiveCameraUtility","TDEX_MultiplyNumber","THUNDER_DRAGON_EX","ThunderDragonExTitle","SkillThunderBallExplosion","SkillThunderDragonEx"]);