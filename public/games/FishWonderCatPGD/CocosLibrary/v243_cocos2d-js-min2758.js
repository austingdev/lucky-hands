var $jscomp = $jscomp || {};
$jscomp.scope = {};
$jscomp.ASSUME_ES5 = !1;
$jscomp.ASSUME_NO_NATIVE_MAP = !1;
$jscomp.ASSUME_NO_NATIVE_SET = !1;
$jscomp.defineProperty = $jscomp.ASSUME_ES5 || "function" == typeof Object.defineProperties ? Object.defineProperty : function(h, q, m) {
    h != Array.prototype && h != Object.prototype && (h[q] = m.value)
};
$jscomp.getGlobal = function(h) {
    return "undefined" != typeof window && window === h ? h : "undefined" != typeof global && null != global ? global : h
};
$jscomp.global = $jscomp.getGlobal(this);
$jscomp.SYMBOL_PREFIX = "jscomp_symbol_";
$jscomp.initSymbol = function() {
    $jscomp.initSymbol = function() {};
    $jscomp.global.Symbol || ($jscomp.global.Symbol = $jscomp.Symbol)
};
$jscomp.symbolCounter_ = 0;
$jscomp.Symbol = function(h) {
    return $jscomp.SYMBOL_PREFIX + (h || "") + $jscomp.symbolCounter_++
};
$jscomp.initSymbolIterator = function() {
    $jscomp.initSymbol();
    var h = $jscomp.global.Symbol.iterator;
    h || (h = $jscomp.global.Symbol.iterator = $jscomp.global.Symbol("iterator"));
    "function" != typeof Array.prototype[h] && $jscomp.defineProperty(Array.prototype, h, {
        configurable: !0,
        writable: !0,
        value: function() {
            return $jscomp.arrayIterator(this)
        }
    });
    $jscomp.initSymbolIterator = function() {}
};
$jscomp.arrayIterator = function(h) {
    var q = 0;
    return $jscomp.iteratorPrototype(function() {
        return q < h.length ? {
            done: !1,
            value: h[q++]
        } : {
            done: !0
        }
    })
};
$jscomp.iteratorPrototype = function(h) {
    $jscomp.initSymbolIterator();
    h = {
        next: h
    };
    h[$jscomp.global.Symbol.iterator] = function() {
        return this
    };
    return h
};
$jscomp.owns = function(h, q) {
    return Object.prototype.hasOwnProperty.call(h, q)
};
$jscomp.polyfill = function(h, q, m, f) {
    if (q) {
        m = $jscomp.global;
        h = h.split(".");
        for (f = 0; f < h.length - 1; f++) {
            var e = h[f];
            e in m || (m[e] = {});
            m = m[e]
        }
        h = h[h.length - 1];
        f = m[h];
        q = q(f);
        q != f && null != q && $jscomp.defineProperty(m, h, {
            configurable: !0,
            writable: !0,
            value: q
        })
    }
};
$jscomp.polyfill("Object.assign", function(h) {
    return h ? h : function(h, m) {
        for (var f = 1; f < arguments.length; f++) {
            var e = arguments[f];
            if (e)
                for (var b in e) $jscomp.owns(e, b) && (h[b] = e[b])
        }
        return h
    }
}, "es6", "es3");
$jscomp.checkStringArgs = function(h, q, m) {
    if (null == h) throw new TypeError("The 'this' value for String.prototype." + m + " must not be null or undefined");
    if (q instanceof RegExp) throw new TypeError("First argument to String.prototype." + m + " must not be a regular expression");
    return h + ""
};
$jscomp.polyfill("String.prototype.repeat", function(h) {
    return h ? h : function(h) {
        var m = $jscomp.checkStringArgs(this, null, "repeat");
        if (0 > h || 1342177279 < h) throw new RangeError("Invalid count value");
        h |= 0;
        for (var f = ""; h;)
            if (h & 1 && (f += m), h >>>= 1) m += m;
        return f
    }
}, "es6", "es3");
$jscomp.iteratorFromArray = function(h, q) {
    $jscomp.initSymbolIterator();
    h instanceof String && (h += "");
    var m = 0,
        f = {
            next: function() {
                if (m < h.length) {
                    var e = m++;
                    return {
                        value: q(e, h[e]),
                        done: !1
                    }
                }
                f.next = function() {
                    return {
                        done: !0,
                        value: void 0
                    }
                };
                return f.next()
            }
        };
    f[Symbol.iterator] = function() {
        return f
    };
    return f
};
$jscomp.polyfill("Array.prototype.keys", function(h) {
    return h ? h : function() {
        return $jscomp.iteratorFromArray(this, function(h) {
            return h
        })
    }
}, "es6", "es3");
$jscomp.polyfill("Array.prototype.values", function(h) {
    return h ? h : function() {
        return $jscomp.iteratorFromArray(this, function(h, m) {
            return m
        })
    }
}, "es6", "es3");
$jscomp.findInternal = function(h, q, m) {
    h instanceof String && (h = String(h));
    for (var f = h.length, e = 0; e < f; e++) {
        var b = h[e];
        if (q.call(m, b, e, h)) return {
            i: e,
            v: b
        }
    }
    return {
        i: -1,
        v: void 0
    }
};
$jscomp.polyfill("Array.prototype.find", function(h) {
    return h ? h : function(h, m) {
        return $jscomp.findInternal(this, h, m).v
    }
}, "es6", "es3");
$jscomp.polyfill("Object.is", function(h) {
    return h ? h : function(h, m) {
        return h === m ? 0 !== h || 1 / h === 1 / m : h !== h && m !== m
    }
}, "es6", "es3");
$jscomp.polyfill("Array.prototype.includes", function(h) {
    return h ? h : function(h, m) {
        var f = this;
        f instanceof String && (f = String(f));
        var e = f.length;
        for (m = m || 0; m < e; m++)
            if (f[m] == h || Object.is(f[m], h)) return !0;
        return !1
    }
}, "es7", "es3");
$jscomp.polyfill("String.prototype.includes", function(h) {
    return h ? h : function(h, m) {
        return -1 !== $jscomp.checkStringArgs(this, h, "includes").indexOf(h, m || 0)
    }
}, "es6", "es3");
$jscomp.polyfill("Array.from", function(h) {
    return h ? h : function(h, m, f) {
        $jscomp.initSymbolIterator();
        m = null != m ? m : function(c) {
            return c
        };
        var e = [],
            b = h[Symbol.iterator];
        if ("function" == typeof b)
            for (h = b.call(h); !(b = h.next()).done;) e.push(m.call(f, b.value));
        else {
            b = h.length;
            for (var k = 0; k < b; k++) e.push(m.call(f, h[k]))
        }
        return e
    }
}, "es6", "es3");
$jscomp.polyfill("String.prototype.startsWith", function(h) {
    return h ? h : function(h, m) {
        var f = $jscomp.checkStringArgs(this, h, "startsWith");
        h += "";
        var e = f.length,
            b = h.length;
        m = Math.max(0, Math.min(m | 0, f.length));
        for (var k = 0; k < b && m < e;)
            if (f[m++] != h[k++]) return !1;
        return k >= b
    }
}, "es6", "es3");
$jscomp.polyfill("String.prototype.endsWith", function(h) {
    return h ? h : function(h, m) {
        var f = $jscomp.checkStringArgs(this, h, "endsWith");
        h += "";
        void 0 === m && (m = f.length);
        m = Math.max(0, Math.min(m | 0, f.length));
        for (var e = h.length; 0 < e && 0 < m;)
            if (f[--m] != h[--e]) return !1;
        return 0 >= e
    }
}, "es6", "es3");
$jscomp.makeIterator = function(h) {
    $jscomp.initSymbolIterator();
    var q = h[Symbol.iterator];
    return q ? q.call(h) : $jscomp.arrayIterator(h)
};
$jscomp.FORCE_POLYFILL_PROMISE = !1;
$jscomp.polyfill("Promise", function(h) {
    function q() {
        this.batch_ = null
    }

    function m(b) {
        return b instanceof e ? b : new e(function(c, a) {
            c(b)
        })
    }
    if (h && !$jscomp.FORCE_POLYFILL_PROMISE) return h;
    q.prototype.asyncExecute = function(b) {
        null == this.batch_ && (this.batch_ = [], this.asyncExecuteBatch_());
        this.batch_.push(b);
        return this
    };
    q.prototype.asyncExecuteBatch_ = function() {
        var b = this;
        this.asyncExecuteFunction(function() {
            b.executeBatch_()
        })
    };
    var f = $jscomp.global.setTimeout;
    q.prototype.asyncExecuteFunction = function(b) {
        f(b,
            0)
    };
    q.prototype.executeBatch_ = function() {
        for (; this.batch_ && this.batch_.length;) {
            var b = this.batch_;
            this.batch_ = [];
            for (var c = 0; c < b.length; ++c) {
                var a = b[c];
                delete b[c];
                try {
                    a()
                } catch (d) {
                    this.asyncThrow_(d)
                }
            }
        }
        this.batch_ = null
    };
    q.prototype.asyncThrow_ = function(b) {
        this.asyncExecuteFunction(function() {
            throw b;
        })
    };
    var e = function(b) {
        this.state_ = 0;
        this.result_ = void 0;
        this.onSettledCallbacks_ = [];
        var c = this.createResolveAndReject_();
        try {
            b(c.resolve, c.reject)
        } catch (a) {
            c.reject(a)
        }
    };
    e.prototype.createResolveAndReject_ =
        function() {
            function b(d) {
                return function(l) {
                    a || (a = !0, d.call(c, l))
                }
            }
            var c = this,
                a = !1;
            return {
                resolve: b(this.resolveTo_),
                reject: b(this.reject_)
            }
        };
    e.prototype.resolveTo_ = function(b) {
        if (b === this) this.reject_(new TypeError("A Promise cannot resolve to itself"));
        else if (b instanceof e) this.settleSameAsPromise_(b);
        else {
            a: switch (typeof b) {
                case "object":
                    var c = null != b;
                    break a;
                case "function":
                    c = !0;
                    break a;
                default:
                    c = !1
            }
            c ? this.resolveToNonPromiseObj_(b) : this.fulfill_(b)
        }
    };
    e.prototype.resolveToNonPromiseObj_ = function(b) {
        var c =
            void 0;
        try {
            c = b.then
        } catch (a) {
            this.reject_(a);
            return
        }
        "function" == typeof c ? this.settleSameAsThenable_(c, b) : this.fulfill_(b)
    };
    e.prototype.reject_ = function(b) {
        this.settle_(2, b)
    };
    e.prototype.fulfill_ = function(b) {
        this.settle_(1, b)
    };
    e.prototype.settle_ = function(b, c) {
        if (0 != this.state_) throw Error("Cannot settle(" + b + ", " + c | "): Promise already settled in state" + this.state_);
        this.state_ = b;
        this.result_ = c;
        this.executeOnSettledCallbacks_()
    };
    e.prototype.executeOnSettledCallbacks_ = function() {
        if (null != this.onSettledCallbacks_) {
            for (var b =
                    this.onSettledCallbacks_, c = 0; c < b.length; ++c) b[c].call(), b[c] = null;
            this.onSettledCallbacks_ = null
        }
    };
    var b = new q;
    e.prototype.settleSameAsPromise_ = function(b) {
        var c = this.createResolveAndReject_();
        b.callWhenSettled_(c.resolve, c.reject)
    };
    e.prototype.settleSameAsThenable_ = function(b, c) {
        var a = this.createResolveAndReject_();
        try {
            b.call(c, a.resolve, a.reject)
        } catch (d) {
            a.reject(d)
        }
    };
    e.prototype.then = function(b, c) {
        function a(a, c) {
            return "function" == typeof a ? function(c) {
                try {
                    d(a(c))
                } catch (p) {
                    l(p)
                }
            } : c
        }
        var d, l, g = new e(function(a,
            c) {
            d = a;
            l = c
        });
        this.callWhenSettled_(a(b, d), a(c, l));
        return g
    };
    e.prototype.catch = function(b) {
        return this.then(void 0, b)
    };
    e.prototype.callWhenSettled_ = function(k, c) {
        function a() {
            switch (d.state_) {
                case 1:
                    k(d.result_);
                    break;
                case 2:
                    c(d.result_);
                    break;
                default:
                    throw Error("Unexpected state: " + d.state_);
            }
        }
        var d = this;
        null == this.onSettledCallbacks_ ? b.asyncExecute(a) : this.onSettledCallbacks_.push(function() {
            b.asyncExecute(a)
        })
    };
    e.resolve = m;
    e.reject = function(b) {
        return new e(function(c, a) {
            a(b)
        })
    };
    e.race = function(b) {
        return new e(function(c,
            a) {
            for (var d = $jscomp.makeIterator(b), l = d.next(); !l.done; l = d.next()) m(l.value).callWhenSettled_(c, a)
        })
    };
    e.all = function(b) {
        var c = $jscomp.makeIterator(b),
            a = c.next();
        return a.done ? m([]) : new e(function(d, b) {
            function g(a) {
                return function(c) {
                    l[a] = c;
                    k--;
                    0 == k && d(l)
                }
            }
            var l = [],
                k = 0;
            do l.push(void 0), k++, m(a.value).callWhenSettled_(g(l.length - 1), b), a = c.next(); while (!a.done)
        })
    };
    return e
}, "es6", "es3");
$jscomp.polyfill("Object.setPrototypeOf", function(h) {
    return h ? h : "object" != typeof "".__proto__ ? null : function(h, m) {
        h.__proto__ = m;
        if (h.__proto__ !== m) throw new TypeError(h + " is not extensible");
        return h
    }
}, "es6", "es5");
$jscomp.polyfill("Array.prototype.fill", function(h) {
    return h ? h : function(h, m, f) {
        var e = this.length || 0;
        0 > m && (m = Math.max(0, e + m));
        if (null == f || f > e) f = e;
        f = Number(f);
        0 > f && (f = Math.max(0, e + f));
        for (m = Number(m || 0); m < f; m++) this[m] = h;
        return this
    }
}, "es6", "es3");
$jscomp.polyfill("Number.isFinite", function(h) {
    return h ? h : function(h) {
        return "number" !== typeof h ? !1 : !isNaN(h) && Infinity !== h && -Infinity !== h
    }
}, "es6", "es3");
$jscomp.polyfill("Number.isInteger", function(h) {
    return h ? h : function(h) {
        return Number.isFinite(h) ? h === Math.floor(h) : !1
    }
}, "es6", "es3");
$jscomp.polyfill("Number.EPSILON", function(h) {
    return Math.pow(2, -52)
}, "es6", "es3");
$jscomp.polyfill("Math.sign", function(h) {
    return h ? h : function(h) {
        h = Number(h);
        return 0 === h || isNaN(h) ? h : 0 < h ? 1 : -1
    }
}, "es6", "es3");
$jscomp.polyfill("Object.getOwnPropertySymbols", function(h) {
    return h ? h : function() {
        return []
    }
}, "es6", "es5");
$jscomp.polyfill("Reflect.ownKeys", function(h) {
    return h ? h : function(h) {
        var m = [],
            f = Object.getOwnPropertyNames(h);
        h = Object.getOwnPropertySymbols(h);
        for (var e = 0; e < f.length; e++)("jscomp_symbol_" == f[e].substring(0, 14) ? h : m).push(f[e]);
        return m.concat(h)
    }
}, "es6", "es5");
$jscomp.polyfill("Object.getOwnPropertyDescriptors", function(h) {
    return h ? h : function(h) {
        for (var m = {}, f = Reflect.ownKeys(h), e = 0; e < f.length; e++) m[f[e]] = Object.getOwnPropertyDescriptor(h, f[e]);
        return m
    }
}, "es8", "es5");
$jscomp.polyfill("Math.log2", function(h) {
    return h ? h : function(h) {
        return Math.log(h) / Math.LN2
    }
}, "es6", "es3");
var gd_EditBox_isEditing = !1,
    gd_EditBox_BeganCallBack = [],
    gd_EditBox_EndedCallBack = [];

function isIpad() {
    var h = window.navigator.userAgent;
    if (-1 < h.indexOf("iPad")) return !0;
    if (-1 < h.indexOf("Macintosh")) try {
        return document.createEvent("TouchEvent"), !0
    } catch (q) {}
    return !1
}
(function(h, q, m) {
    function f(b, k) {
        k = q[b];
        if (!k) {
            var c = h[b];
            if (!c) return;
            var a = {};
            k = q[b] = {
                exports: a
            };
            c[0](function(a) {
                return f(c[1][a] || a)
            }, k, a)
        }
        return k.exports
    }
    for (var e = 0; e < m.length; e++) f(m[e]);
    return f
})({
    1: [function(h, q, m) {
        q.exports = {
            1001: "cocos2d: removeAction: Target not found",
            1002: "cc.ActionManager.removeActionByTag(): an invalid tag",
            1003: "cc.ActionManager.removeActionByTag(): target must be non-null",
            1004: "cc.ActionManager.getActionByTag(): an invalid tag",
            1005: "cocos2d : getActionByTag(tag = %s): Action not found",
            1006: "[Action step]. override me",
            1007: "[Action update]. override me",
            1008: "cocos2d: FiniteTimeAction#reverse: Implement me",
            1009: "cc.EaseElastic.reverse(): it should be overridden in subclass.",
            1010: "cc.IntervalAction: reverse not implemented.",
            1011: "cc.ActionInterval.setAmplitudeRate(): it should be overridden in subclass.",
            1012: "cc.ActionInterval.getAmplitudeRate(): it should be overridden in subclass.",
            1013: "The speed parameter error",
            1014: "The repeat parameter error",
            1015: "parameters should not be ending with null in Javascript",
            1016: "cc.RotateTo.reverse(): it should be overridden in subclass.",
            1019: "Failed to construct, Sequence construction needs two or more actions.",
            1020: "Failed to construct, Spawn construction needs two or more actions.",
            1021: "cc.Speed.initWithAction(): action must be non nil",
            1022: "cc.Follow.initWithAction(): followedNode must be non nil",
            1023: "cc.ActionEase.initWithAction(): action must be non nil",
            1024: "Invalid configuration. It must at least have one control point",
            1025: "cc.Sequence.initWithTwoActions(): arguments must all be non nil",
            1026: "cc.RepeatForever.initWithAction(): action must be non null",
            1027: "cc.Spawn.initWithTwoActions(): arguments must all be non null",
            1028: "cc.ReverseTime.initWithAction(): action must be non null",
            1029: "cc.ReverseTime.initWithAction(): the action was already passed in.",
            1030: "cc.Animate.initWithAnimation(): animation must be non-NULL",
            1031: "Illegal parameter get passed in cc.tween: %s.",
            1100: "Expected 'data' dict, but not found. Config file: %s",
            1101: "Please load the resource first : %s",
            1200: "cocos2d: Director: Error in gettimeofday",
            1201: "cocos2d: Director: unrecognized projection",
            1203: "cocos2d: Director: Error in gettimeofday",
            1204: "running scene should not null",
            1205: "the scene should not null",
            1206: "loadScene: The scene index to load (%s) is out of range.",
            1207: "loadScene: Unknown name type to load: '%s'",
            1208: "loadScene: Failed to load scene '%s' because '%s' is already being loaded.",
            1209: "loadScene: Can not load the scene '%s' because it was not in the build settings before playing.",
            1210: "Failed to preload '%s', %s",
            1211: "loadScene: The scene index to load (%s) is out of range.",
            1212: "loadScene: Unknown name type to load: '%s'",
            1213: "loadScene: Failed to load scene '%s' because '%s' is already loading",
            1214: "loadScene: Can not load the scene '%s' because it was not in the build settings before playing.",
            1215: "Failed to preload '%s', %s",
            1216: "Director.runSceneImmediate: scene is not valid",
            1300: "element type is wrong!",
            1400: "'%s' is deprecated, please use '%s' instead.",
            1404: "cc.spriteFrameCache is removed, please use cc.loader to load and cache sprite frames of atlas format.",
            1405: "The '%s' has been removed, please use '%s' instead.",
            1406: "'%s.%s' is removed",
            1408: "'%s' is not support in the '%s', please use '%s' instead.",
            1502: "cc.scheduler.scheduleCallbackForTarget(): target should be non-null.",
            1503: "cc.Scheduler.pauseTarget():target should be non-null",
            1504: "cc.Scheduler.resumeTarget():target should be non-null",
            1505: "cc.Scheduler.isTargetPaused():target should be non-null",
            1506: "warning: you CANNOT change update priority in scheduled function",
            1507: 'CCScheduler#scheduleSelector. Selector already scheduled. Updating interval from: %s to %s"',
            1508: "Argument callback must not be empty",
            1509: "Argument target must be non-nullptr",
            1510: "cc.Scheduler: Illegal target which doesn't have uuid or instanceId.",
            1511: "cc.Scheduler: pause state of the scheduled task doesn't match the element pause state in Scheduler, the given paused state will be ignored.",
            1513: "cc.Scheduler: scheduler stopped using `__instanceId` as id since v2.0, you should do scheduler.enableForTarget(target) before all scheduler API usage on target",
            1605: "child already added. It can't be added again",
            1606: "child must be non-null",
            1610: "cocos2d: removeChildByTag(tag = %s): child not found!",
            1612: "cc.Node.stopActionBy(): argument tag an invalid tag",
            1613: "cc.Node.getActionByTag(): argument tag is an invalid tag",
            1617: "child must be non-null",
            1618: "cc.Node.runAction(): action must be non-null",
            1619: "callback function must be non-null",
            1620: "interval must be positive",
            1623: "Set '%s' to normal node (not persist root node).",
            1624: "Replacing with the same sgNode",
            1625: "The replacement sgNode should not contain any child.",
            1626: "Should not set alpha via 'color', set 'opacity' please.",
            1627: "Not support for asynchronous creating node in SG",
            1632: "Node name can not include '/'.",
            1633: "Internal error, should not remove unknown node from parent.",
            1634: "addChild: The child to add must be instance of cc.Node, not %s.",
            1635: "reorderChild: this child is not in children list.",
            1636: "Node's zIndex value can't be greater than cc.macro.MAX_ZINDEX, setting to the maximum value",
            1637: "Node's zIndex value can't be smaller than cc.macro.MIN_ZINDEX, setting to the minimum value",
            1638: "Private node's zIndex can't be set, it will keep cc.macro.MIN_ZINDEX as its value",
            1639: "cc.Action is deprecated, please use cc.Tween instead",
            1800: "cc._EventListenerKeyboard.checkAvailable(): Invalid EventListenerKeyboard!",
            1801: "cc._EventListenerTouchOneByOne.checkAvailable(): Invalid EventListenerTouchOneByOne!",
            1802: "cc._EventListenerTouchAllAtOnce.checkAvailable(): Invalid EventListenerTouchAllAtOnce!",
            1803: "cc._EventListenerAcceleration.checkAvailable(): _onAccelerationEvent must be non-nil",
            1900: "Invalid parameter.",
            2E3: "Don't call this method if the event is for touch.",
            2200: "Design resolution not valid",
            2201: "should set resolutionPolicy",
            2300: "The touches is more than MAX_TOUCHES, nUnusedIndex = %s",
            2400: "WebGL error %s",
            2602: "cc.Sprite.setDisplayFrameWithAnimationName(): Frame not found",
            2603: "cc.Sprite.setDisplayFrameWithAnimationName(): Invalid frame index",
            2606: "cc.Sprite.initWithSpriteFrame(): spriteFrame should be non-null",
            2607: "cc.Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null",
            2608: "%s is null, please check.",
            2609: "cc.Sprite.initWithFile(): filename should be non-null",
            2610: "cc.Sprite.setDisplayFrameWithAnimationName(): animationName must be non-null",
            2614: "cc.Sprite.addChild(): child should be non-null",
            2616: "cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",
            2617: "cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",
            2618: "cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",
            2619: "cc.SpriteBatchNode.addChild(): cc.Sprite is not using the same texture",
            2623: "cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",
            2625: "too many tiles, only 16384 tiles will be show",
            2626: "Unrecognized fill type in bar fill",
            2627: "Can not generate quad",
            2628: "%s does not exist",
            2712: "Invalid spriteFrameName",
            3005: "cocos2d: '%s' id=%s %s x %s",
            3006: "cocos2d: '%s' id= HTMLCanvasElement %s x %s",
            3007: "cocos2d: TextureCache dumpDebugInfo: %s textures, HTMLCanvasElement for %s KB (%s MB)",
            3103: "cc.Texture.addImage(): path should be non-null",
            3112: "cc.Texture.addImage(): path should be non-null",
            3113: "NSInternalInconsistencyException",
            3116: "WebGLRenderingContext.CLAMP_TO_EDGE should be used in NPOT textures",
            3117: "Mimpap texture only works in POT textures",
            3119: "Lazy init texture with image element failed due to image loading failure: %s",
            3120: "Loading texture with unsupported type: '%s'. Add '%s' into 'cc.macro.SUPPORT_TEXTURE_FORMATS' please.",
            3121: "Can't find a texture format supported by the current platform! Please add a fallback format in the editor.",
            3300: "Rect width exceeds maximum margin: %s",
            3400: "Rect height exceeds maximum margin: %s",
            3401: "Set texture with a url of image is not supported anymore. Please use cc.assetManager.loadRemote to load a texture first.",
            3500: "0 priority is forbidden for fixed priority since it's used for scene graph based priority.",
            3501: "Invalid listener type!",
            3502: "Can't set fixed priority with scene graph based listener.",
            3503: "Invalid parameters.",
            3504: "listener must be a cc.EventListener object when adding a fixed priority listener",
            3505: "The listener has been registered, please don't register it again.",
            3506: "Unsupported listener target.",
            3507: "Invalid scene graph priority!",
            3508: "If program goes here, there should be event in dispatch.",
            3509: "_inDispatch should be 1 here.",
            3510: "%s's scene graph node not contains in the parent's children",
            3511: "event is undefined",
            3600: "cc.Class will automatically call super constructor of %s, you should not call it manually.",
            3601: "The editor property 'playOnFocus' should be used with 'executeInEditMode' in class '%s'",
            3602: "Unknown editor property '%s' in class '%s'.",
            3603: "Use 'cc.Float' or 'cc.Integer' instead of 'cc.Number' please.",
            3604: "Can only indicate one type attribute for %s.",
            3605: "The default value of %s is not instance of %s.",
            3606: "No needs to indicate the '%s' attribute for %s, which its default value is type of %s.",
            3607: "The default value of %s must be an empty string.",
            3608: "The type of %s must be cc.String, not String.",
            3609: "The type of %s must be cc.Boolean, not Boolean.",
            3610: "The type of %s must be cc.Float or cc.Integer, not Number.",
            3611: "Can not indicate the '%s' attribute for %s, which its default value is type of %s.",
            3612: "%s Just set the default value to 'new %s()' and it will be handled properly.",
            3613: "'No need to use 'serializable: false' or 'editorOnly: true' for the getter of '%s.%s', every getter is actually non-serialized.",
            3614: "Should not define constructor for cc.Component %s.",
            3615: "Each script can have at most one Component.",
            3616: "Should not specify class name %s for Component which defines in project.",
            3617: "Can not instantiate CCClass '%s' with arguments.",
            3618: "ctor of '%s' can not be another CCClass",
            3619: "ctor of '%s' must be function type",
            3620: "this._super declared in '%s.%s' but no super method defined",
            3621: "Unknown type of %s.%s, maybe you want is '%s'.",
            3622: "Unknown type of %s.%s, property should be defined in 'properties' or 'ctor'",
            3623: "Can not use 'editor' attribute, '%s' not inherits from Components.",
            3624: "'%s' overrided '%s' but '%s' is defined as 'false' so the super method will not be called. You can set '%s' to null to disable this warning.",
            3625: "[isChildClassOf] superclass should be function type, not",
            3626: "Can't remove '%s' because '%s' depends on it.",
            3627: "Should not add renderer component (%s) to a Canvas node.",
            3628: "Should not add %s to a node which size is already used by its other component.",
            3633: "Properties function of '%s' should return an object!",
            3634: "Disallow to use '.' in property name",
            3635: "Default array must be empty, set default value of %s.%s to [], and initialize in 'onLoad' or 'ctor' please. (just like 'this.%s = [...];')",
            3636: "Do not set default value to non-empty object, unless the object defines its own 'clone' function. Set default value of %s.%s to null or {}, and initialize in 'onLoad' or 'ctor' please. (just like 'this.%s = {foo: bar};')",
            3637: "Can not declare %s.%s, it is already defined in the prototype of %s",
            3638: "'%s': the getter of '%s' is already defined!",
            3639: "Can not apply the specified attribute to the getter of '%s.%s', attribute index: %s",
            3640: "'%s': the setter of '%s' is already defined!",
            3641: "Can not construct %s because it contains object property.",
            3642: "Cannot define %s.%s because static member name can not be '%s'.",
            3643: "Can not define a member called 'constructor' in the class '%s', please use 'ctor' instead.",
            3644: "Please define 'type' parameter of %s.%s as the actual constructor.",
            3645: "Please define 'type' parameter of %s.%s as the constructor of %s.",
            3646: "Unknown 'type' parameter of %s.%s\uff1a%s",
            3647: "The length of range array must be equal or greater than 2",
            3648: "Can not declare %s.%s method, it is already defined in the properties of %s.",
            3649: "CCClass %s have conflict between its ctor and __ctor__.",
            3651: 'Can not call `_super` or `prototype.ctor` in ES6 Classes "%s", use `super` instead please.',
            3652: "Failed to `new %s()` under the hood, %s\nIt is used for getting default values declared in TypeScript in the first place.\nPlease ensure the constructor can be called during the script's initialization.",
            3653: 'Please do not specifiy "default" attribute in decorator of "%s" property in "%s" class.  \nDefault value must be initialized at their declaration:\n \n// Before:\n@property({\n  type: cc.SpriteFrame\n  default: null  // <--\n})\nmyProp;\n// After:\n@property({\n  type: cc.SpriteFrame\n})\nmyProp = null;   // <--',
            3654: 'Please specifiy a default value for "%s.%s" at its declaration:\n \n// Before:\n@property(...)\nmyProp;\n// After:\n@property(...)\nmyProp = 0;',
            3655: 'Can not specifiy "get" or "set"  attribute in decorator for "%s" property in "%s" class.  \nPlease use:\n \n@property(...)\nget %s () {\n    ...\n}\n@property\nset %s (value) {\n    ...\n}',
            3700: "internal error: _prefab is undefined",
            3701: "Failed to load prefab asset for node '%s'",
            3800: "The target can not be made persist because it's not a cc.Node or it doesn't have _id property.",
            3801: "The node can not be made persist because it's not under root node.",
            3802: "The node can not be made persist because it's not in current scene.",
            3803: "The target can not be made persist because it's not a cc.Node or it doesn't have _id property.",
            3804: "getComponent: Type must be non-nil",
            3805: "Can't add component '%s' because %s already contains the same component.",
            3806: "Can't add component '%s' to %s because it conflicts with the existing '%s' derived component.",
            3807: "addComponent: Failed to get class '%s'",
            3808: "addComponent: Should not add component ('%s') when the scripts are still loading.",
            3809: "addComponent: The component to add must be a constructor",
            3810: "addComponent: The component to add must be child class of cc.Component",
            3811: "_addComponentAt: The component to add must be a constructor",
            3812: "_addComponentAt: Index out of range",
            3813: "removeComponent: Component must be non-nil",
            3814: "Argument must be non-nil",
            3815: "Component not owned by this entity",
            3816: "Node '%s' is already activating",
            3817: "Sorry, the component of '%s' which with an index of %s is corrupted! It has been removed.",
            3818: "Failed to read or parse project.json",
            3819: "Warning: target element is not a DIV or CANVAS",
            3820: "The renderer doesn't support the renderMode %s",
            3821: "Cannot change hierarchy while activating or deactivating the parent.",
            3900: "Invalid clip to add",
            3901: "Invalid clip to remove",
            3902: "clip is defaultClip, set force to true to force remove clip and animation state",
            3903: "animation state is playing, set force to true to force stop and remove clip and animation state",
            3904: "motion path of target [%s] in prop [%s] frame [%s] is not valid",
            3905: "sprite frames must be an Array.",
            3906: "Can't find easing type [%s]",
            3907: "animator not added or already removed",
            3912: "already-playing",
            4003: "Label font size can't be shirnked less than 0!",
            4004: "force notify all fonts loaded!",
            4011: "Property spriteFrame of Font '%s' is invalid. Using system font instead.",
            4012: "The texture of Font '%s' must be already loaded on JSB. Using system font instead.",
            4013: "Sorry, lineHeight of system font not supported on JSB.",
            4200: "MaskType: IMAGE_STENCIL only support WebGL mode.",
            4201: "The alphaThreshold invalid in Canvas Mode.",
            4202: "The inverted invalid in Canvas Mode.",
            4300: "can not found the %s page.",
            4400: "Invalid RichText img tag! The sprite frame name can't be found in the ImageAtlas!",
            4600: "Script attached to '%s' is missing or invalid.",
            4700: "The dom control is not created!",
            4800: "unknown asset type",
            4901: "loadRes: should not specify the extname in %s %s",
            4902: "No need to release non-cached asset.",
            4914: "Resources url '%s' does not exist.",
            4915: "Pack indices and data do not match in size",
            4916: "Failed to download package for %s",
            4921: "Invalid pipe or invalid index provided!",
            4922: "The pipe to be inserted is already in the pipeline!",
            4923: "Uuid Loader: Parse asset [ %s ] failed : %s",
            4924: "JSON Loader: Input item doesn't contain string content",
            4925: "Uuid Loader: Deserialize asset [ %s ] failed : %s",
            4926: "Audio Downloader: no web audio context.",
            4927: "Audio Downloader: audio not supported on this browser!",
            4928: "Load %s failed!",
            4929: "Load Webp ( %s ) failed",
            4930: "Load image ( %s ) failed",
            4932: 'Since v1.10, for any atlas ("%s") in the "resources" directory, it is not possible to find the contained SpriteFrames via `loadRes`, `getRes` or `releaseRes`. Load the SpriteAtlas first and then use `spriteAtlas.getSpriteFrame(name)` instead please.',
            4933: "Download Font [ %s ] failed, using Arial or system default font instead",
            5E3: "object already destroyed",
            5001: "object not yet destroyed",
            5100: "Not a plist file!",
            5200: "Warning: localStorage isn't enabled. Please confirm browser cookie or privacy option",
            5201: "browser don't support web audio",
            5202: "This feature supports WebGL render mode only.",
            5300: "Type of target to deserialize not matched with data: target is %s, data is %s",
            5301: "Can not find script '%s'",
            5302: "Can not find class '%s'",
            5303: "Failed to deserialize %s, missing _deserialize function.",
            5304: "Unable to deserialize version %s data.",
            5402: "cc.js.addon called on non-object:",
            5403: "cc.js.mixin: arguments must be type object:",
            5404: "The base class to extend from must be non-nil",
            5405: "The class to extend must be non-nil",
            5406: "Class should be extended before assigning any prototype members.",
            5500: "'notify' can not be used in 'get/set' !",
            5501: "'notify' must be used with 'default' !",
            5507: "The 'default' attribute of '%s.%s' must be an array",
            5508: "Invalid type of %s.%s",
            5510: "The 'type' attribute of '%s.%s' can not be 'Number', use cc.Float or cc.Integer instead please.",
            5511: "The 'type' attribute of '%s.%s' is undefined when loading script",
            5512: "Can not serialize '%s.%s' because the specified type is anonymous, please provide a class name or set the 'serializable' attribute of '%s.%s' to 'false'.",
            5513: "The 'default' value of '%s.%s' should not be used with a 'get' function.",
            5514: "The 'default' value of '%s.%s' should not be used with a 'set' function.",
            5515: "The 'default' value of '%s.%s' can not be an constructor. Set default to null please.",
            5516: "Property '%s.%s' must define at least one of 'default', 'get' or 'set'.",
            5517: "'%s.%s' hides inherited property '%s.%s'. To make the current property override that implementation, add the `override: true` attribute please.",
            5601: "Can not get current scene.",
            5602: "Scene is destroyed",
            5603: "reference node is destroyed",
            5700: "no %s or %s on %s",
            5800: "%s.lerp not yet implemented.",
            5801: "%s.clone not yet implemented.",
            5802: "%s.equals not yet implemented.",
            5900: "MotionStreak only support WebGL mode.",
            5901: "cc.MotionStreak.getOpacity has not been supported.",
            5902: "cc.MotionStreak.setOpacity has not been supported.",
            6E3: "Custom should not be false if file is not specified.",
            6001: "The new %s must not be NaN",
            6017: "Incomplete or corrupt PNG file",
            6018: "Invalid filter algorithm: %s",
            6019: "Invalid byte order value.",
            6020: "You forgot your towel!",
            6021: "Unknown Field Tag: %s",
            6022: "Too many bits requested",
            6023: "No bits requested",
            6024: "Cannot recover from missing StripByteCounts",
            6025: "Cannot handle sub-byte bits per sample",
            6026: "Cannot handle sub-byte bits per pixel",
            6027: "Palette image missing color map",
            6028: "Unknown Photometric Interpretation: %s",
            6029: "Unkown error",
            6030: "cc.ParticleSystem: error decoding or ungzipping textureImageData in plist '%s'",
            6031: "cc.ParticleSystem: unknown image format with Data in plist %s",
            6032: "cc.ParticleSystem.initWithDictionary() : error loading the texture in plist '%s'",
            6400: "asset.url is not usable in core process",
            6402: "AssetLibrary has already been initialized!",
            6500: "Widget target must be one of the parent nodes of it",
            6600: "collider not added or already removed",
            6601: "Can't find testFunc for (%s, $s).",
            6700: "Can't init canvas '%s' because it conflicts with the existing '%s', the scene should only have one active canvas at the same time.",
            6800: "Callback of event must be non-nil",
            6801: "The message must be provided",
            6900: "The thing you want to instantiate must be an object",
            6901: "The thing you want to instantiate is nil",
            6902: "The thing you want to instantiate is destroyed",
            6903: "The instantiate method for given asset do not implemented",
            6904: "Can not instantiate array",
            6905: "Can not instantiate DOM element",
            7100: "%s already defined in Enum.",
            7101: "Sorry, 'cc.Enum' not available on this platform, please report this error here: https://github.com/cocos-creator/engine/issues/new",
            7200: "Method 'initWithTMXFile' is no effect now, please set property 'tmxAsset' instead.",
            7201: "Method 'initWithXML' is no effect now, please set property 'tmxAsset' instead.",
            7202: "Add component TiledLayer into node failed.",
            7203: "Property 'mapLoaded' is unused now. Please write the logic to the callback 'start'.",
            7210: "TMX Hexa zOrder not supported",
            7211: "TMX invalid value",
            7215: "cocos2d: Warning: TMX Layer %s has no tiles",
            7216: "cocos2d: TMXFormat: Unsupported TMX version: %s",
            7217: "cocos2d: TMXFomat: Unsupported orientation: %s",
            7218: "cc.TMXMapInfo.parseXMLFile(): unsupported compression method",
            7219: "cc.TMXMapInfo.parseXMLFile(): Only base64 and/or gzip/zlib maps are supported",
            7221: "cc.TMXMapInfo.parseXMLFile(): Texture '%s' not found.",
            7222: "Parse %s failed.",
            7236: "cc.TMXLayer.getTileAt(): TMXLayer: the tiles map has been released",
            7237: "cc.TMXLayer.getTileGIDAt(): TMXLayer: the tiles map has been released",
            7238: "cc.TMXLayer.setTileGID(): TMXLayer: the tiles map has been released",
            7239: "cc.TMXLayer.setTileGID(): invalid gid: %s",
            7240: "cc.TMXLayer.getTileFlagsAt(): TMXLayer: the tiles map has been released",
            7241: "cc.TiledMap.initWithXML(): Map not found. Please check the filename.",
            7401: "Failed to set _defaultArmatureIndex for '%s' because the index is out of range.",
            7402: "Failed to set _animationIndex for '%s' because the index is out of range.",
            7501: "Failed to set _defaultSkinIndex for '%s' because the index is out of range.",
            7502: "Failed to set _animationIndex for '%s' because its skeletonData is invalid.",
            7503: "Failed to set _animationIndex for '%s' because the index is out of range.",
            7504: "Can not render dynamic created SkeletonData",
            7506: "Failed to load spine atlas '$s'",
            7507: "Please re-import '%s' because its textures is not initialized! (This workflow will be improved in the future.)",
            7508: "The atlas asset of '%s' is not exists!",
            7509: "Spine: Animation not found: %s",
            7510: "Spine: Animation not found: %s",
            7600: "The context of RenderTexture is invalid.",
            7601: "cc.RenderTexture._initWithWidthAndHeightForWebGL() : only RGB and RGBA formats are valid for a render texture;",
            7602: "Could not attach texture to the framebuffer",
            7603: "clearDepth isn't supported on Cocos2d-Html5",
            7604: "saveToFile isn't supported on Cocos2d-Html5",
            7605: "newCCImage isn't supported on Cocos2d-Html5",
            7700: "On the web is always keep the aspect ratio",
            7701: "Can't know status",
            7702: "Video player's duration is not ready to get now!",
            7800: "Web does not support loading",
            7801: "Web does not support query history",
            7802: "Web does not support query history",
            7803: "The current browser does not support the GoBack",
            7804: "The current browser does not support the GoForward",
            7805: "Web does not support zoom",
            7900: "cc.math.Matrix3.assign(): current matrix equals matIn",
            7901: "cc.math.mat4Assign(): pOut equals pIn",
            7902: "cc.mat.Matrix4.assignFrom(): mat4 equals current matrix",
            7903: "cc.math.Matrix4 equal: pMat1 and pMat2 are same object.",
            7904: "cc.math.Matrix4.extractPlane: Invalid plane index",
            7905: "cc.math.mat4Assign(): pOut equals pIn",
            7906: "cc.mat.Matrix4.assignFrom(): mat4 equals current matrix",
            7907: "cc.math.Matrix4 equals: pMat1 and pMat2 are same object.",
            7908: "Invalid matrix mode specified",
            7909: "current quaternion is an invalid value",
            8E3: "Can't handle this field type or size",
            8001: "No bytes requested",
            8002: "Too many bytes requested",
            8003: "Missing StripByteCounts!",
            8103: "cc.GLProgram.link(): Cannot link invalid program",
            8104: "cocos2d: ERROR: Failed to link program: %s",
            8105: "cocos2d: cc.shaderCache._loadDefaultShader, error shader type",
            8106: "Please load the resource firset : %s",
            8107: "cc.GLProgram.getUniformLocationForName(): uniform name should be non-null",
            8108: "cc.GLProgram.getUniformLocationForName(): Invalid operation. Cannot get uniform location when program is not initialized",
            8109: "modelView matrix is undefined.",
            8200: "Please set node's active instead of rigidbody's enabled.",
            8300: "Should only one camera exists, please check your project.",
            8301: "Camera does not support Canvas Mode.",
            8400: "Wrong type arguments, 'filePath' must be a String.",
            8401: "Since 1.10, `%s` accept %s instance directly, not a URL string. Please directly reference the %s object in your script, or load %s by loader first. Don't use %s's URL anymore.",
            9E3: "Stencil manager does not support level bigger than %d in this device.",
            9001: "Stencil manager is already empty, cannot pop any mask.",
            9100: "LabelAtlas '%s' cannot be loaded, raw texture does not exist.",
            9101: "LabelAtlas '%s' cannot be loaded, fnt data does not exist.",
            9102: "Program not support highp precision, will change to mediump.",
            9103: "%s : Failed to set property [%s], property not found.",
            9104: "%s : Failed to define [%s], define not found.",
            9105: "%s : Failed to set property [%s], property length not correct.",
            9106: "%s : Set property [%s] warning : should transform object to ArrayBuffer.",
            9107: "%s : illegal property: [%s], myabe defined an unused property;",
            9200: "cc.view.enableAntiAlias is deprecated, please use cc.Texture2D.setFilters instead",
            "0100": "%s not yet implemented."
        }
    }, {}],
    2: [function(h, q, m) {
        h("../core/platform/CCClass");
        var f = h("../core/utils/misc");
        cc.Action = cc.Class({
            name: "cc.Action",
            ctor: function() {
                this.target = this.originalTarget = null;
                this.tag = cc.Action.TAG_INVALID
            },
            clone: function() {
                var e = new cc.Action;
                e.originalTarget = null;
                e.target = null;
                e.tag = this.tag;
                return e
            },
            isDone: function() {
                return !0
            },
            startWithTarget: function(e) {
                this.target = this.originalTarget = e
            },
            stop: function() {
                this.target = null
            },
            step: function(e) {
                cc.logID(1006)
            },
            update: function(e) {
                cc.logID(1007)
            },
            getTarget: function() {
                return this.target
            },
            setTarget: function(e) {
                this.target = e
            },
            getOriginalTarget: function() {
                return this.originalTarget
            },
            setOriginalTarget: function(e) {
                this.originalTarget = e
            },
            getTag: function() {
                return this.tag
            },
            setTag: function(e) {
                this.tag = e
            },
            retain: function() {},
            release: function() {}
        });
        cc.Action.TAG_INVALID = -1;
        cc.FiniteTimeAction =
            cc.Class({
                name: "cc.FiniteTimeAction",
                extends: cc.Action,
                ctor: function() {
                    this._duration = 0
                },
                getDuration: function() {
                    return this._duration * (this._timesForRepeat || 1)
                },
                setDuration: function(e) {
                    this._duration = e
                },
                reverse: function() {
                    cc.logID(1008);
                    return null
                },
                clone: function() {
                    return new cc.FiniteTimeAction
                }
            });
        cc.Speed = cc.Class({
            name: "cc.Speed",
            extends: cc.Action,
            ctor: function(e, b) {
                this._speed = 0;
                this._innerAction = null;
                e && this.initWithAction(e, b)
            },
            getSpeed: function() {
                return this._speed
            },
            setSpeed: function(e) {
                this._speed =
                    e
            },
            initWithAction: function(e, b) {
                if (!e) return cc.errorID(1021), !1;
                this._innerAction = e;
                this._speed = b;
                return !0
            },
            clone: function() {
                var e = new cc.Speed;
                e.initWithAction(this._innerAction.clone(), this._speed);
                return e
            },
            startWithTarget: function(e) {
                cc.Action.prototype.startWithTarget.call(this, e);
                this._innerAction.startWithTarget(e)
            },
            stop: function() {
                this._innerAction.stop();
                cc.Action.prototype.stop.call(this)
            },
            step: function(e) {
                this._innerAction.step(e * this._speed)
            },
            isDone: function() {
                return this._innerAction.isDone()
            },
            reverse: function() {
                return new cc.Speed(this._innerAction.reverse(), this._speed)
            },
            setInnerAction: function(e) {
                this._innerAction !== e && (this._innerAction = e)
            },
            getInnerAction: function() {
                return this._innerAction
            }
        });
        cc.speed = function(e, b) {
            return new cc.Speed(e, b)
        };
        cc.Follow = cc.Class({
            name: "cc.Follow",
            extends: cc.Action,
            ctor: function(e, b) {
                this._followedNode = null;
                this._boundaryFullyCovered = this._boundarySet = !1;
                this._fullScreenSize = this._halfScreenSize = null;
                this.bottomBoundary = this.topBoundary = this.rightBoundary =
                    this.leftBoundary = 0;
                this._worldRect = cc.rect(0, 0, 0, 0);
                e && (b ? this.initWithTarget(e, b) : this.initWithTarget(e))
            },
            clone: function() {
                var e = new cc.Follow,
                    b = this._worldRect;
                b = new cc.Rect(b.x, b.y, b.width, b.height);
                e.initWithTarget(this._followedNode, b);
                return e
            },
            isBoundarySet: function() {
                return this._boundarySet
            },
            setBoudarySet: function(e) {
                this._boundarySet = e
            },
            initWithTarget: function(e, b) {
                if (!e) return cc.errorID(1022), !1;
                b = b || cc.rect(0, 0, 0, 0);
                this._followedNode = e;
                this._worldRect = b;
                this._boundarySet = !(0 === b.width &&
                    0 === b.height);
                this._boundaryFullyCovered = !1;
                e = cc.winSize;
                this._fullScreenSize = cc.v2(e.width, e.height);
                this._halfScreenSize = this._fullScreenSize.mul(.5);
                this._boundarySet && (this.leftBoundary = -(b.x + b.width - this._fullScreenSize.x), this.rightBoundary = -b.x, this.topBoundary = -b.y, this.bottomBoundary = -(b.y + b.height - this._fullScreenSize.y), this.rightBoundary < this.leftBoundary && (this.rightBoundary = this.leftBoundary = (this.leftBoundary + this.rightBoundary) / 2), this.topBoundary < this.bottomBoundary && (this.topBoundary =
                    this.bottomBoundary = (this.topBoundary + this.bottomBoundary) / 2), this.topBoundary === this.bottomBoundary && this.leftBoundary === this.rightBoundary && (this._boundaryFullyCovered = !0));
                return !0
            },
            step: function(e) {
                e = this.target.convertToWorldSpaceAR(cc.Vec2.ZERO);
                var b = this._followedNode.convertToWorldSpaceAR(cc.Vec2.ZERO);
                e = e.sub(b);
                e = this.target.parent.convertToNodeSpaceAR(e.add(this._halfScreenSize));
                this._boundarySet ? this._boundaryFullyCovered || this.target.setPosition(f.clampf(e.x, this.leftBoundary, this.rightBoundary),
                    f.clampf(e.y, this.bottomBoundary, this.topBoundary)) : this.target.setPosition(e.x, e.y)
            },
            isDone: function() {
                return !this._followedNode.activeInHierarchy
            },
            stop: function() {
                this.target = null;
                cc.Action.prototype.stop.call(this)
            }
        });
        cc.follow = function(e, b) {
            return new cc.Follow(e, b)
        }
    }, {
        "../core/platform/CCClass": 204,
        "../core/utils/misc": 286
    }],
    3: [function(h, q, m) {
        function f(b, c) {
            return b[Math.min(b.length - 1, Math.max(c, 0))]
        }

        function e(b) {
            for (var c = [], a = b.length - 1; 0 <= a; a--) c.push(cc.v2(b[a].x, b[a].y));
            return c
        }

        function b(b) {
            for (var c = [], a = 0; a < b.length; a++) c.push(cc.v2(b[a].x, b[a].y));
            return c
        }
        cc.CardinalSplineTo = cc.Class({
            name: "cc.CardinalSplineTo",
            extends: cc.ActionInterval,
            ctor: function(b, c, a) {
                this._points = [];
                this._tension = this._deltaT = 0;
                this._accumulatedDiff = this._previousPosition = null;
                void 0 !== a && cc.CardinalSplineTo.prototype.initWithDuration.call(this, b, c, a)
            },
            initWithDuration: function(b, c, a) {
                return c && 0 !== c.length ? cc.ActionInterval.prototype.initWithDuration.call(this, b) ? (this.setPoints(c), this._tension = a, !0) : !1 : (cc.errorID(1024), !1)
            },
            clone: function() {
                var k = new cc.CardinalSplineTo;
                k.initWithDuration(this._duration, b(this._points), this._tension);
                return k
            },
            startWithTarget: function(b) {
                cc.ActionInterval.prototype.startWithTarget.call(this, b);
                this._deltaT = 1 / (this._points.length - 1);
                this._previousPosition = cc.v2(this.target.x, this.target.y);
                this._accumulatedDiff = cc.v2(0, 0)
            },
            update: function(b) {
                b = this._computeEaseTime(b);
                var c = this._points;
                if (1 === b) {
                    var a = c.length - 1;
                    var d = 1
                } else {
                    var l = this._deltaT;
                    a = 0 | b / l;
                    d = (b - l * a) / l
                }
                b = f(c, a - 1);
                l = f(c,
                    a - 0);
                var g = f(c, a + 1);
                a = f(c, a + 2);
                var n = d * d,
                    k = n * d,
                    t = (1 - this._tension) / 2;
                c = t * (2 * n - k - d);
                var p = t * (-k + n) + (2 * k - 3 * n + 1);
                d = t * (k - 2 * n + d) + (-2 * k + 3 * n);
                n = t * (k - n);
                b = cc.v2(b.x * c + l.x * p + g.x * d + a.x * n, b.y * c + l.y * p + g.y * d + a.y * n);
                cc.macro.ENABLE_STACKABLE_ACTIONS && (l = this.target.x - this._previousPosition.x, g = this.target.y - this._previousPosition.y, 0 !== l || 0 !== g) && (d = this._accumulatedDiff, l = d.x + l, g = d.y + g, d.x = l, d.y = g, b.x += l, b.y += g);
                this.updatePosition(b)
            },
            reverse: function() {
                var b = e(this._points);
                return cc.cardinalSplineTo(this._duration,
                    b, this._tension)
            },
            updatePosition: function(b) {
                this.target.setPosition(b);
                this._previousPosition = b
            },
            getPoints: function() {
                return this._points
            },
            setPoints: function(b) {
                this._points = b
            }
        });
        cc.cardinalSplineTo = function(b, c, a) {
            return new cc.CardinalSplineTo(b, c, a)
        };
        cc.CardinalSplineBy = cc.Class({
            name: "cc.CardinalSplineBy",
            extends: cc.CardinalSplineTo,
            ctor: function(b, c, a) {
                this._startPosition = cc.v2(0, 0);
                void 0 !== a && this.initWithDuration(b, c, a)
            },
            startWithTarget: function(b) {
                cc.CardinalSplineTo.prototype.startWithTarget.call(this,
                    b);
                this._startPosition.x = b.x;
                this._startPosition.y = b.y
            },
            reverse: function() {
                for (var b = this._points.slice(), c, a = b[0], d = 1; d < b.length; ++d) c = b[d], b[d] = c.sub(a), a = c;
                b = e(b);
                a = b[b.length - 1];
                b.pop();
                a.x = -a.x;
                a.y = -a.y;
                b.unshift(a);
                for (d = 1; d < b.length; ++d) c = b[d], c.x = -c.x, c.y = -c.y, c.x += a.x, c.y += a.y, a = b[d] = c;
                return cc.cardinalSplineBy(this._duration, b, this._tension)
            },
            updatePosition: function(b) {
                var c = this._startPosition,
                    a = b.x + c.x;
                b = b.y + c.y;
                this._previousPosition.x = a;
                this._previousPosition.y = b;
                this.target.setPosition(a,
                    b)
            },
            clone: function() {
                var k = new cc.CardinalSplineBy;
                k.initWithDuration(this._duration, b(this._points), this._tension);
                return k
            }
        });
        cc.cardinalSplineBy = function(b, c, a) {
            return new cc.CardinalSplineBy(b, c, a)
        };
        cc.CatmullRomTo = cc.Class({
            name: "cc.CatmullRomTo",
            extends: cc.CardinalSplineTo,
            ctor: function(b, c) {
                c && this.initWithDuration(b, c)
            },
            initWithDuration: function(b, c) {
                return cc.CardinalSplineTo.prototype.initWithDuration.call(this, b, c, .5)
            },
            clone: function() {
                var k = new cc.CatmullRomTo;
                k.initWithDuration(this._duration,
                    b(this._points));
                return k
            }
        });
        cc.catmullRomTo = function(b, c) {
            return new cc.CatmullRomTo(b, c)
        };
        cc.CatmullRomBy = cc.Class({
            name: "cc.CatmullRomBy",
            extends: cc.CardinalSplineBy,
            ctor: function(b, c) {
                c && this.initWithDuration(b, c)
            },
            initWithDuration: function(b, c) {
                return cc.CardinalSplineTo.prototype.initWithDuration.call(this, b, c, .5)
            },
            clone: function() {
                var k = new cc.CatmullRomBy;
                k.initWithDuration(this._duration, b(this._points));
                return k
            }
        });
        cc.catmullRomBy = function(b, c) {
            return new cc.CatmullRomBy(b, c)
        }
    }, {}],
    4: [function(h,
        q, m) {
        function f(a) {
            if (a < 1 / 2.75) return 7.5625 * a * a;
            if (a < 2 / 2.75) return a -= 1.5 / 2.75, 7.5625 * a * a + .75;
            if (a < 2.5 / 2.75) return a -= 2.25 / 2.75, 7.5625 * a * a + .9375;
            a -= 2.625 / 2.75;
            return 7.5625 * a * a + .984375
        }
        cc.easeIn = function(a) {
            return {
                _rate: a,
                easing: function(a) {
                    return Math.pow(a, this._rate)
                },
                reverse: function() {
                    return cc.easeIn(1 / this._rate)
                }
            }
        };
        cc.easeOut = function(a) {
            return {
                _rate: a,
                easing: function(a) {
                    return Math.pow(a, 1 / this._rate)
                },
                reverse: function() {
                    return cc.easeOut(1 / this._rate)
                }
            }
        };
        cc.easeInOut = function(a) {
            return {
                _rate: a,
                easing: function(a) {
                    a *= 2;
                    return 1 > a ? .5 * Math.pow(a, this._rate) : 1 - .5 * Math.pow(2 - a, this._rate)
                },
                reverse: function() {
                    return cc.easeInOut(this._rate)
                }
            }
        };
        var e = {
            easing: function(a) {
                return 0 === a ? 0 : Math.pow(2, 10 * (a - 1))
            },
            reverse: function() {
                return b
            }
        };
        cc.easeExponentialIn = function() {
            return e
        };
        var b = {
            easing: function(a) {
                return 1 === a ? 1 : 1 - Math.pow(2, -10 * a)
            },
            reverse: function() {
                return e
            }
        };
        cc.easeExponentialOut = function() {
            return b
        };
        var k = {
            easing: function(a) {
                return 1 !== a && 0 !== a ? (a *= 2, 1 > a ? .5 * Math.pow(2, 10 * (a - 1)) : .5 * (2 -
                    Math.pow(2, -10 * (a - 1)))) : a
            },
            reverse: function() {
                return k
            }
        };
        cc.easeExponentialInOut = function() {
            return k
        };
        var c = {
            easing: function(a) {
                return 0 === a || 1 === a ? a : -1 * Math.cos(a * Math.PI / 2) + 1
            },
            reverse: function() {
                return a
            }
        };
        cc.easeSineIn = function() {
            return c
        };
        var a = {
            easing: function(a) {
                return 0 === a || 1 === a ? a : Math.sin(a * Math.PI / 2)
            },
            reverse: function() {
                return c
            }
        };
        cc.easeSineOut = function() {
            return a
        };
        var d = {
            easing: function(a) {
                return 0 === a || 1 === a ? a : -.5 * (Math.cos(Math.PI * a) - 1)
            },
            reverse: function() {
                return d
            }
        };
        cc.easeSineInOut =
            function() {
                return d
            };
        var l = {
            easing: function(a) {
                if (0 === a || 1 === a) return a;
                --a;
                return -Math.pow(2, 10 * a) * Math.sin((a - .075) * Math.PI * 2 / .3)
            },
            reverse: function() {
                return g
            }
        };
        cc.easeElasticIn = function(a) {
            return a && .3 !== a ? {
                _period: a,
                easing: function(a) {
                    if (0 === a || 1 === a) return a;
                    --a;
                    return -Math.pow(2, 10 * a) * Math.sin((a - this._period / 4) * Math.PI * 2 / this._period)
                },
                reverse: function() {
                    return cc.easeElasticOut(this._period)
                }
            } : l
        };
        var g = {
            easing: function(a) {
                return 0 === a || 1 === a ? a : Math.pow(2, -10 * a) * Math.sin((a - .075) * Math.PI * 2 /
                    .3) + 1
            },
            reverse: function() {
                return l
            }
        };
        cc.easeElasticOut = function(a) {
            return a && .3 !== a ? {
                _period: a,
                easing: function(a) {
                    return 0 === a || 1 === a ? a : Math.pow(2, -10 * a) * Math.sin((a - this._period / 4) * Math.PI * 2 / this._period) + 1
                },
                reverse: function() {
                    return cc.easeElasticIn(this._period)
                }
            } : g
        };
        cc.easeElasticInOut = function(a) {
            return {
                _period: a || .3,
                easing: function(a) {
                    var d = this._period;
                    if (0 !== a && 1 !== a) {
                        d || (d = this._period = .3 * 1.5);
                        var c = d / 4;
                        a = 2 * a - 1;
                        a = 0 > a ? -.5 * Math.pow(2, 10 * a) * Math.sin((a - c) * Math.PI * 2 / d) : Math.pow(2, -10 * a) * Math.sin((a -
                            c) * Math.PI * 2 / d) * .5 + 1
                    }
                    return a
                },
                reverse: function() {
                    return cc.easeElasticInOut(this._period)
                }
            }
        };
        var n = {
            easing: function(a) {
                return 1 - f(1 - a)
            },
            reverse: function() {
                return w
            }
        };
        cc.easeBounceIn = function() {
            return n
        };
        var w = {
            easing: function(a) {
                return f(a)
            },
            reverse: function() {
                return n
            }
        };
        cc.easeBounceOut = function() {
            return w
        };
        var t = {
            easing: function(a) {
                return .5 > a ? .5 * (1 - f(1 - 2 * a)) : .5 * f(2 * a - 1) + .5
            },
            reverse: function() {
                return t
            }
        };
        cc.easeBounceInOut = function() {
            return t
        };
        var p = {
            easing: function(a) {
                return 0 === a || 1 === a ? a : a * a *
                    (2.70158 * a - 1.70158)
            },
            reverse: function() {
                return u
            }
        };
        cc.easeBackIn = function() {
            return p
        };
        var u = {
            easing: function(a) {
                if (0 === a) return 0;
                --a;
                return a * a * (2.70158 * a + 1.70158) + 1
            },
            reverse: function() {
                return p
            }
        };
        cc.easeBackOut = function() {
            return u
        };
        var v = {
            easing: function(a) {
                a *= 2;
                if (1 > a) return a * a * (3.5949095 * a - 2.5949095) / 2;
                a -= 2;
                return a * a * (3.5949095 * a + 2.5949095) / 2 + 1
            },
            reverse: function() {
                return v
            }
        };
        cc.easeBackInOut = function() {
            return v
        };
        cc.easeBezierAction = function(a, d, c, b) {
            return {
                easing: function(g) {
                    return Math.pow(1 -
                        g, 3) * a + 3 * g * Math.pow(1 - g, 2) * d + 3 * Math.pow(g, 2) * (1 - g) * c + Math.pow(g, 3) * b
                },
                reverse: function() {
                    return cc.easeBezierAction(b, c, d, a)
                }
            }
        };
        var A = {
            easing: function(a) {
                return Math.pow(a, 2)
            },
            reverse: function() {
                return A
            }
        };
        cc.easeQuadraticActionIn = function() {
            return A
        };
        var B = {
            easing: function(a) {
                return -a * (a - 2)
            },
            reverse: function() {
                return B
            }
        };
        cc.easeQuadraticActionOut = function() {
            return B
        };
        var E = {
            easing: function(a) {
                a *= 2;
                1 > a ? a = a * a * .5 : (--a, a = -.5 * (a * (a - 2) - 1));
                return a
            },
            reverse: function() {
                return E
            }
        };
        cc.easeQuadraticActionInOut =
            function() {
                return E
            };
        var y = {
            easing: function(a) {
                return a * a * a * a
            },
            reverse: function() {
                return y
            }
        };
        cc.easeQuarticActionIn = function() {
            return y
        };
        var z = {
            easing: function(a) {
                --a;
                return -(a * a * a * a - 1)
            },
            reverse: function() {
                return z
            }
        };
        cc.easeQuarticActionOut = function() {
            return z
        };
        var x = {
            easing: function(a) {
                a *= 2;
                if (1 > a) return .5 * a * a * a * a;
                a -= 2;
                return -.5 * (a * a * a * a - 2)
            },
            reverse: function() {
                return x
            }
        };
        cc.easeQuarticActionInOut = function() {
            return x
        };
        var C = {
            easing: function(a) {
                return a * a * a * a * a
            },
            reverse: function() {
                return C
            }
        };
        cc.easeQuinticActionIn =
            function() {
                return C
            };
        var G = {
            easing: function(a) {
                --a;
                return a * a * a * a * a + 1
            },
            reverse: function() {
                return G
            }
        };
        cc.easeQuinticActionOut = function() {
            return G
        };
        var F = {
            easing: function(a) {
                a *= 2;
                if (1 > a) return .5 * a * a * a * a * a;
                a -= 2;
                return .5 * (a * a * a * a * a + 2)
            },
            reverse: function() {
                return F
            }
        };
        cc.easeQuinticActionInOut = function() {
            return F
        };
        var H = {
            easing: function(a) {
                return -1 * (Math.sqrt(1 - a * a) - 1)
            },
            reverse: function() {
                return H
            }
        };
        cc.easeCircleActionIn = function() {
            return H
        };
        var I = {
            easing: function(a) {
                --a;
                return Math.sqrt(1 - a * a)
            },
            reverse: function() {
                return I
            }
        };
        cc.easeCircleActionOut = function() {
            return I
        };
        var K = {
            easing: function(a) {
                a *= 2;
                if (1 > a) return -.5 * (Math.sqrt(1 - a * a) - 1);
                a -= 2;
                return .5 * (Math.sqrt(1 - a * a) + 1)
            },
            reverse: function() {
                return K
            }
        };
        cc.easeCircleActionInOut = function() {
            return K
        };
        var P = {
            easing: function(a) {
                return a * a * a
            },
            reverse: function() {
                return P
            }
        };
        cc.easeCubicActionIn = function() {
            return P
        };
        var S = {
            easing: function(a) {
                --a;
                return a * a * a + 1
            },
            reverse: function() {
                return S
            }
        };
        cc.easeCubicActionOut = function() {
            return S
        };
        var M = {
            easing: function(a) {
                a *= 2;
                if (1 > a) return .5 *
                    a * a * a;
                a -= 2;
                return .5 * (a * a * a + 2)
            },
            reverse: function() {
                return M
            }
        };
        cc.easeCubicActionInOut = function() {
            return M
        }
    }, {}],
    5: [function(h, q, m) {
        cc.ActionInstant = cc.Class({
            name: "cc.ActionInstant",
            extends: cc.FiniteTimeAction,
            isDone: function() {
                return !0
            },
            step: function(f) {
                this.update(1)
            },
            update: function(f) {},
            reverse: function() {
                return this.clone()
            },
            clone: function() {
                return new cc.ActionInstant
            }
        });
        cc.Show = cc.Class({
            name: "cc.Show",
            extends: cc.ActionInstant,
            update: function(f) {
                f = this.target.getComponentsInChildren(cc.RenderComponent);
                for (var e = 0; e < f.length; ++e) f[e].enabled = !0
            },
            reverse: function() {
                return new cc.Hide
            },
            clone: function() {
                return new cc.Show
            }
        });
        cc.show = function() {
            return new cc.Show
        };
        cc.Hide = cc.Class({
            name: "cc.Hide",
            extends: cc.ActionInstant,
            update: function(f) {
                f = this.target.getComponentsInChildren(cc.RenderComponent);
                for (var e = 0; e < f.length; ++e) f[e].enabled = !1
            },
            reverse: function() {
                return new cc.Show
            },
            clone: function() {
                return new cc.Hide
            }
        });
        cc.hide = function() {
            return new cc.Hide
        };
        cc.ToggleVisibility = cc.Class({
            name: "cc.ToggleVisibility",
            extends: cc.ActionInstant,
            update: function(f) {
                f = this.target.getComponentsInChildren(cc.RenderComponent);
                for (var e = 0; e < f.length; ++e) {
                    var b = f[e];
                    b.enabled = !b.enabled
                }
            },
            reverse: function() {
                return new cc.ToggleVisibility
            },
            clone: function() {
                return new cc.ToggleVisibility
            }
        });
        cc.toggleVisibility = function() {
            return new cc.ToggleVisibility
        };
        cc.RemoveSelf = cc.Class({
            name: "cc.RemoveSelf",
            extends: cc.ActionInstant,
            ctor: function(f) {
                this._isNeedCleanUp = !0;
                void 0 !== f && this.init(f)
            },
            update: function(f) {
                this.target.removeFromParent(this._isNeedCleanUp)
            },
            init: function(f) {
                this._isNeedCleanUp = f;
                return !0
            },
            reverse: function() {
                return new cc.RemoveSelf(this._isNeedCleanUp)
            },
            clone: function() {
                return new cc.RemoveSelf(this._isNeedCleanUp)
            }
        });
        cc.removeSelf = function(f) {
            return new cc.RemoveSelf(f)
        };
        cc.DestroySelf = cc.Class({
            name: "cc.DestroySelf",
            extends: cc.ActionInstant,
            update: function() {
                this.target.destroy()
            },
            reverse: function() {
                return new cc.DestroySelf
            },
            clone: function() {
                return new cc.DestroySelf
            }
        });
        cc.destroySelf = function() {
            return new cc.DestroySelf
        };
        cc.FlipX =
            cc.Class({
                name: "cc.FlipX",
                extends: cc.ActionInstant,
                ctor: function(f) {
                    this._flippedX = !1;
                    void 0 !== f && this.initWithFlipX(f)
                },
                initWithFlipX: function(f) {
                    this._flippedX = f;
                    return !0
                },
                update: function(f) {
                    this.target.scaleX = Math.abs(this.target.scaleX) * (this._flippedX ? -1 : 1)
                },
                reverse: function() {
                    return new cc.FlipX(!this._flippedX)
                },
                clone: function() {
                    var f = new cc.FlipX;
                    f.initWithFlipX(this._flippedX);
                    return f
                }
            });
        cc.flipX = function(f) {
            return new cc.FlipX(f)
        };
        cc.FlipY = cc.Class({
            name: "cc.FlipY",
            extends: cc.ActionInstant,
            ctor: function(f) {
                this._flippedY = !1;
                void 0 !== f && this.initWithFlipY(f)
            },
            initWithFlipY: function(f) {
                this._flippedY = f;
                return !0
            },
            update: function(f) {
                this.target.scaleY = Math.abs(this.target.scaleY) * (this._flippedY ? -1 : 1)
            },
            reverse: function() {
                return new cc.FlipY(!this._flippedY)
            },
            clone: function() {
                var f = new cc.FlipY;
                f.initWithFlipY(this._flippedY);
                return f
            }
        });
        cc.flipY = function(f) {
            return new cc.FlipY(f)
        };
        cc.Place = cc.Class({
            name: "cc.Place",
            extends: cc.ActionInstant,
            ctor: function(f, e) {
                this._y = this._x = 0;
                void 0 !==
                    f && (void 0 !== f.x && (e = f.y, f = f.x), this.initWithPosition(f, e))
            },
            initWithPosition: function(f, e) {
                this._x = f;
                this._y = e;
                return !0
            },
            update: function(f) {
                this.target.setPosition(this._x, this._y)
            },
            clone: function() {
                var f = new cc.Place;
                f.initWithPosition(this._x, this._y);
                return f
            }
        });
        cc.place = function(f, e) {
            return new cc.Place(f, e)
        };
        cc.CallFunc = cc.Class({
            name: "cc.CallFunc",
            extends: cc.ActionInstant,
            ctor: function(f, e, b) {
                this._data = this._function = this._selectorTarget = null;
                this.initWithFunction(f, e, b)
            },
            initWithFunction: function(f,
                e, b) {
                f && (this._function = f);
                e && (this._selectorTarget = e);
                void 0 !== b && (this._data = b);
                return !0
            },
            execute: function() {
                this._function && this._function.call(this._selectorTarget, this.target, this._data)
            },
            update: function(f) {
                this.execute()
            },
            getTargetCallback: function() {
                return this._selectorTarget
            },
            setTargetCallback: function(f) {
                f !== this._selectorTarget && (this._selectorTarget && (this._selectorTarget = null), this._selectorTarget = f)
            },
            clone: function() {
                var f = new cc.CallFunc;
                f.initWithFunction(this._function, this._selectorTarget,
                    this._data);
                return f
            }
        });
        cc.callFunc = function(f, e, b) {
            return new cc.CallFunc(f, e, b)
        }
    }, {}],
    6: [function(h, q, m) {
        function f(e, b, k, c, a) {
            return Math.pow(1 - a, 3) * e + 3 * a * Math.pow(1 - a, 2) * b + 3 * Math.pow(a, 2) * (1 - a) * k + Math.pow(a, 3) * c
        }
        cc.ActionInterval = cc.Class({
            name: "cc.ActionInterval",
            extends: cc.FiniteTimeAction,
            ctor: function(e) {
                this.MAX_VALUE = 2;
                this._elapsed = 0;
                this._firstTick = !1;
                this._easeList = null;
                this._timesForRepeat = this._speed = 1;
                this._speedMethod = this._repeatMethod = this._repeatForever = !1;
                void 0 !== e && cc.ActionInterval.prototype.initWithDuration.call(this,
                    e)
            },
            getElapsed: function() {
                return this._elapsed
            },
            initWithDuration: function(e) {
                this._duration = 0 === e ? cc.macro.FLT_EPSILON : e;
                this._elapsed = 0;
                return this._firstTick = !0
            },
            isDone: function() {
                return this._elapsed >= this._duration
            },
            _cloneDecoration: function(e) {
                e._repeatForever = this._repeatForever;
                e._speed = this._speed;
                e._timesForRepeat = this._timesForRepeat;
                e._easeList = this._easeList;
                e._speedMethod = this._speedMethod;
                e._repeatMethod = this._repeatMethod
            },
            _reverseEaseList: function(e) {
                if (this._easeList) {
                    e._easeList = [];
                    for (var b = 0; b < this._easeList.length; b++) e._easeList.push(this._easeList[b].reverse())
                }
            },
            clone: function() {
                var e = new cc.ActionInterval(this._duration);
                this._cloneDecoration(e);
                return e
            },
            easing: function(e) {
                this._easeList ? this._easeList.length = 0 : this._easeList = [];
                for (var b = 0; b < arguments.length; b++) this._easeList.push(arguments[b]);
                return this
            },
            _computeEaseTime: function(e) {
                var b = this._easeList;
                if (!b || 0 === b.length) return e;
                for (var k = 0, c = b.length; k < c; k++) e = b[k].easing(e);
                return e
            },
            step: function(e) {
                this._firstTick ?
                    (this._firstTick = !1, this._elapsed = 0) : this._elapsed += e;
                e = this._elapsed / (1.192092896E-7 < this._duration ? this._duration : 1.192092896E-7);
                e = 1 > e ? e : 1;
                this.update(0 < e ? e : 0);
                this._repeatMethod && 1 < this._timesForRepeat && this.isDone() && (this._repeatForever || this._timesForRepeat--, this.startWithTarget(this.target), this.step(this._elapsed - this._duration))
            },
            startWithTarget: function(e) {
                cc.Action.prototype.startWithTarget.call(this, e);
                this._elapsed = 0;
                this._firstTick = !0
            },
            reverse: function() {
                cc.logID(1010);
                return null
            },
            setAmplitudeRate: function(e) {
                cc.logID(1011)
            },
            getAmplitudeRate: function() {
                cc.logID(1012);
                return 0
            },
            speed: function(e) {
                if (0 >= e) return cc.logID(1013), this;
                this._speedMethod = !0;
                this._speed *= e;
                return this
            },
            getSpeed: function() {
                return this._speed
            },
            setSpeed: function(e) {
                this._speed = e;
                return this
            },
            repeat: function(e) {
                e = Math.round(e);
                if (isNaN(e) || 1 > e) return cc.logID(1014), this;
                this._repeatMethod = !0;
                this._timesForRepeat *= e;
                return this
            },
            repeatForever: function() {
                this._repeatMethod = !0;
                this._timesForRepeat = this.MAX_VALUE;
                this._repeatForever = !0;
                return this
            }
        });
        cc.actionInterval = function(e) {
            return new cc.ActionInterval(e)
        };
        cc.Sequence = cc.Class({
            name: "cc.Sequence",
            extends: cc.ActionInterval,
            ctor: function(e) {
                this._actions = [];
                this._split = null;
                this._last = 0;
                this._reversed = !1;
                var b = e instanceof Array ? e : arguments;
                if (1 === b.length) cc.errorID(1019);
                else {
                    var k = b.length - 1;
                    0 <= k && null == b[k] && cc.logID(1015);
                    if (0 <= k) {
                        for (var c = b[0], a = 1; a < k; a++) b[a] && (c = cc.Sequence._actionOneTwo(c, b[a]));
                        this.initWithTwoActions(c, b[k])
                    }
                }
            },
            initWithTwoActions: function(e,
                b) {
                if (!e || !b) return cc.errorID(1025), !1;
                var k = e._duration,
                    c = b._duration;
                k *= e._repeatMethod ? e._timesForRepeat : 1;
                c *= b._repeatMethod ? b._timesForRepeat : 1;
                this.initWithDuration(k + c);
                this._actions[0] = e;
                this._actions[1] = b;
                return !0
            },
            clone: function() {
                var e = new cc.Sequence;
                this._cloneDecoration(e);
                e.initWithTwoActions(this._actions[0].clone(), this._actions[1].clone());
                return e
            },
            startWithTarget: function(e) {
                cc.ActionInterval.prototype.startWithTarget.call(this, e);
                this._split = this._actions[0]._duration / this._duration;
                this._split *= this._actions[0]._repeatMethod ? this._actions[0]._timesForRepeat : 1;
                this._last = -1
            },
            stop: function() {
                -1 !== this._last && this._actions[this._last].stop();
                cc.Action.prototype.stop.call(this)
            },
            update: function(e) {
                var b = 0,
                    k = this._split,
                    c = this._actions,
                    a = this._last;
                e = this._computeEaseTime(e);
                e < k ? (e = 0 !== k ? e / k : 1, 0 === b && 1 === a && this._reversed && (c[1].update(0), c[1].stop())) : (b = 1, e = 1 === k ? 1 : (e - k) / (1 - k), -1 === a && (c[0].startWithTarget(this.target), c[0].update(1), c[0].stop()), 0 === a && (c[0].update(1), c[0].stop()));
                c = c[b];
                a === b && c.isDone() || (a !== b && c.startWithTarget(this.target), e *= c._timesForRepeat, c.update(1 < e ? e % 1 : e), this._last = b)
            },
            reverse: function() {
                var e = cc.Sequence._actionOneTwo(this._actions[1].reverse(), this._actions[0].reverse());
                this._cloneDecoration(e);
                this._reverseEaseList(e);
                e._reversed = !0;
                return e
            }
        });
        cc.sequence = function(e) {
            var b = e instanceof Array ? e : arguments;
            if (1 === b.length) return cc.errorID(1019), null;
            var k = b.length - 1;
            0 <= k && null == b[k] && cc.logID(1015);
            var c = null;
            if (0 <= k) {
                c = b[0];
                for (var a = 1; a <=
                    k; a++) b[a] && (c = cc.Sequence._actionOneTwo(c, b[a]))
            }
            return c
        };
        cc.Sequence._actionOneTwo = function(e, b) {
            var k = new cc.Sequence;
            k.initWithTwoActions(e, b);
            return k
        };
        cc.Repeat = cc.Class({
            name: "cc.Repeat",
            extends: cc.ActionInterval,
            ctor: function(e, b) {
                this._nextDt = this._total = this._times = 0;
                this._actionInstant = !1;
                this._innerAction = null;
                void 0 !== b && this.initWithAction(e, b)
            },
            initWithAction: function(e, b) {
                return this.initWithDuration(e._duration * b) ? (this._times = b, this._innerAction = e, e instanceof cc.ActionInstant &&
                    (this._actionInstant = !0, --this._times), this._total = 0, !0) : !1
            },
            clone: function() {
                var e = new cc.Repeat;
                this._cloneDecoration(e);
                e.initWithAction(this._innerAction.clone(), this._times);
                return e
            },
            startWithTarget: function(e) {
                this._total = 0;
                this._nextDt = this._innerAction._duration / this._duration;
                cc.ActionInterval.prototype.startWithTarget.call(this, e);
                this._innerAction.startWithTarget(e)
            },
            stop: function() {
                this._innerAction.stop();
                cc.Action.prototype.stop.call(this)
            },
            update: function(e) {
                e = this._computeEaseTime(e);
                var b = this._innerAction,
                    k = this._duration,
                    c = this._times,
                    a = this._nextDt;
                if (e >= a) {
                    for (; e > a && this._total < c;) b.update(1), this._total++, b.stop(), b.startWithTarget(this.target), a += b._duration / k, this._nextDt = 1 < a ? 1 : a;
                    1 <= e && this._total < c && (b.update(1), this._total++);
                    this._actionInstant || (this._total === c ? b.stop() : b.update(e - (a - b._duration / k)))
                } else b.update(e * c % 1)
            },
            isDone: function() {
                return this._total === this._times
            },
            reverse: function() {
                var e = new cc.Repeat(this._innerAction.reverse(), this._times);
                this._cloneDecoration(e);
                this._reverseEaseList(e);
                return e
            },
            setInnerAction: function(e) {
                this._innerAction !== e && (this._innerAction = e)
            },
            getInnerAction: function() {
                return this._innerAction
            }
        });
        cc.repeat = function(e, b) {
            return new cc.Repeat(e, b)
        };
        cc.RepeatForever = cc.Class({
            name: "cc.RepeatForever",
            extends: cc.ActionInterval,
            ctor: function(e) {
                this._innerAction = null;
                e && this.initWithAction(e)
            },
            initWithAction: function(e) {
                if (!e) return cc.errorID(1026), !1;
                this._innerAction = e;
                return !0
            },
            clone: function() {
                var e = new cc.RepeatForever;
                this._cloneDecoration(e);
                e.initWithAction(this._innerAction.clone());
                return e
            },
            startWithTarget: function(e) {
                cc.ActionInterval.prototype.startWithTarget.call(this, e);
                this._innerAction.startWithTarget(e)
            },
            step: function(e) {
                var b = this._innerAction;
                b.step(e);
                b.isDone() && (b.startWithTarget(this.target), b.step(b.getElapsed() - b._duration))
            },
            isDone: function() {
                return !1
            },
            reverse: function() {
                var e = new cc.RepeatForever(this._innerAction.reverse());
                this._cloneDecoration(e);
                this._reverseEaseList(e);
                return e
            },
            setInnerAction: function(e) {
                this._innerAction !==
                    e && (this._innerAction = e)
            },
            getInnerAction: function() {
                return this._innerAction
            }
        });
        cc.repeatForever = function(e) {
            return new cc.RepeatForever(e)
        };
        cc.Spawn = cc.Class({
            name: "cc.Spawn",
            extends: cc.ActionInterval,
            ctor: function(e) {
                this._two = this._one = null;
                var b = e instanceof Array ? e : arguments;
                if (1 === b.length) cc.errorID(1020);
                else {
                    var k = b.length - 1;
                    0 <= k && null == b[k] && cc.logID(1015);
                    if (0 <= k) {
                        for (var c = b[0], a = 1; a < k; a++) b[a] && (c = cc.Spawn._actionOneTwo(c, b[a]));
                        this.initWithTwoActions(c, b[k])
                    }
                }
            },
            initWithTwoActions: function(e,
                b) {
                if (!e || !b) return cc.errorID(1027), !1;
                var k = !1,
                    c = e._duration,
                    a = b._duration;
                this.initWithDuration(Math.max(c, a)) && (this._one = e, this._two = b, c > a ? this._two = cc.Sequence._actionOneTwo(b, cc.delayTime(c - a)) : c < a && (this._one = cc.Sequence._actionOneTwo(e, cc.delayTime(a - c))), k = !0);
                return k
            },
            clone: function() {
                var e = new cc.Spawn;
                this._cloneDecoration(e);
                e.initWithTwoActions(this._one.clone(), this._two.clone());
                return e
            },
            startWithTarget: function(e) {
                cc.ActionInterval.prototype.startWithTarget.call(this, e);
                this._one.startWithTarget(e);
                this._two.startWithTarget(e)
            },
            stop: function() {
                this._one.stop();
                this._two.stop();
                cc.Action.prototype.stop.call(this)
            },
            update: function(e) {
                e = this._computeEaseTime(e);
                this._one && this._one.update(e);
                this._two && this._two.update(e)
            },
            reverse: function() {
                var e = cc.Spawn._actionOneTwo(this._one.reverse(), this._two.reverse());
                this._cloneDecoration(e);
                this._reverseEaseList(e);
                return e
            }
        });
        cc.spawn = function(e) {
            var b = e instanceof Array ? e : arguments;
            if (1 === b.length) return cc.errorID(1020), null;
            0 < b.length && null == b[b.length -
                1] && cc.logID(1015);
            for (var k = b[0], c = 1; c < b.length; c++) null != b[c] && (k = cc.Spawn._actionOneTwo(k, b[c]));
            return k
        };
        cc.Spawn._actionOneTwo = function(e, b) {
            var k = new cc.Spawn;
            k.initWithTwoActions(e, b);
            return k
        };
        cc.RotateTo = cc.Class({
            name: "cc.RotateTo",
            extends: cc.ActionInterval,
            statics: {
                _reverse: !1
            },
            ctor: function(e, b) {
                this._angle = this._dstAngle = this._startAngle = 0;
                void 0 !== b && this.initWithDuration(e, b)
            },
            initWithDuration: function(e, b) {
                return cc.ActionInterval.prototype.initWithDuration.call(this, e) ? (this._dstAngle =
                    b, !0) : !1
            },
            clone: function() {
                var e = new cc.RotateTo;
                this._cloneDecoration(e);
                e.initWithDuration(this._duration, this._dstAngle);
                return e
            },
            startWithTarget: function(e) {
                cc.ActionInterval.prototype.startWithTarget.call(this, e);
                e = e.angle % 360;
                var b = cc.RotateTo._reverse ? this._dstAngle - e : this._dstAngle + e;
                180 < b && (b -= 360); - 180 > b && (b += 360);
                this._startAngle = e;
                this._angle = cc.RotateTo._reverse ? b : -b
            },
            reverse: function() {
                cc.logID(1016)
            },
            update: function(e) {
                e = this._computeEaseTime(e);
                this.target && (this.target.angle = this._startAngle +
                    this._angle * e)
            }
        });
        cc.rotateTo = function(e, b) {
            return new cc.RotateTo(e, b)
        };
        cc.RotateBy = cc.Class({
            name: "cc.RotateBy",
            extends: cc.ActionInterval,
            statics: {
                _reverse: !1
            },
            ctor: function(e, b) {
                b *= cc.RotateBy._reverse ? 1 : -1;
                this._startAngle = this._deltaAngle = 0;
                void 0 !== b && this.initWithDuration(e, b)
            },
            initWithDuration: function(e, b) {
                return cc.ActionInterval.prototype.initWithDuration.call(this, e) ? (this._deltaAngle = b, !0) : !1
            },
            clone: function() {
                var e = new cc.RotateBy;
                this._cloneDecoration(e);
                e.initWithDuration(this._duration,
                    this._deltaAngle);
                return e
            },
            startWithTarget: function(e) {
                cc.ActionInterval.prototype.startWithTarget.call(this, e);
                this._startAngle = e.angle
            },
            update: function(e) {
                e = this._computeEaseTime(e);
                this.target && (this.target.angle = this._startAngle + this._deltaAngle * e)
            },
            reverse: function() {
                var e = new cc.RotateBy;
                e.initWithDuration(this._duration, -this._deltaAngle);
                this._cloneDecoration(e);
                this._reverseEaseList(e);
                return e
            }
        });
        cc.rotateBy = function(e, b) {
            return new cc.RotateBy(e, b)
        };
        cc.MoveBy = cc.Class({
            name: "cc.MoveBy",
            extends: cc.ActionInterval,
            ctor: function(e, b, k) {
                this._positionDelta = cc.v2(0, 0);
                this._startPosition = cc.v2(0, 0);
                this._previousPosition = cc.v2(0, 0);
                void 0 !== b && cc.MoveBy.prototype.initWithDuration.call(this, e, b, k)
            },
            initWithDuration: function(e, b, k) {
                return cc.ActionInterval.prototype.initWithDuration.call(this, e) ? (void 0 !== b.x && (k = b.y, b = b.x), this._positionDelta.x = b, this._positionDelta.y = k, !0) : !1
            },
            clone: function() {
                var e = new cc.MoveBy;
                this._cloneDecoration(e);
                e.initWithDuration(this._duration, this._positionDelta);
                return e
            },
            startWithTarget: function(e) {
                cc.ActionInterval.prototype.startWithTarget.call(this, e);
                var b = e.x;
                e = e.y;
                this._previousPosition.x = b;
                this._previousPosition.y = e;
                this._startPosition.x = b;
                this._startPosition.y = e
            },
            update: function(e) {
                e = this._computeEaseTime(e);
                if (this.target) {
                    var b = this._positionDelta.x * e;
                    e *= this._positionDelta.y;
                    var k = this._startPosition;
                    if (cc.macro.ENABLE_STACKABLE_ACTIONS) {
                        var c = this.target.y,
                            a = this._previousPosition;
                        k.x = k.x + this.target.x - a.x;
                        k.y = k.y + c - a.y;
                        b += k.x;
                        e += k.y;
                        a.x = b;
                        a.y =
                            e;
                        this.target.setPosition(b, e)
                    } else this.target.setPosition(k.x + b, k.y + e)
                }
            },
            reverse: function() {
                var e = new cc.MoveBy(this._duration, cc.v2(-this._positionDelta.x, -this._positionDelta.y));
                this._cloneDecoration(e);
                this._reverseEaseList(e);
                return e
            }
        });
        cc.moveBy = function(e, b, k) {
            return new cc.MoveBy(e, b, k)
        };
        cc.MoveTo = cc.Class({
            name: "cc.MoveTo",
            extends: cc.MoveBy,
            ctor: function(e, b, k) {
                this._endPosition = cc.v2(0, 0);
                void 0 !== b && this.initWithDuration(e, b, k)
            },
            initWithDuration: function(e, b, k) {
                return cc.MoveBy.prototype.initWithDuration.call(this,
                    e, b, k) ? (void 0 !== b.x && (k = b.y, b = b.x), this._endPosition.x = b, this._endPosition.y = k, !0) : !1
            },
            clone: function() {
                var e = new cc.MoveTo;
                this._cloneDecoration(e);
                e.initWithDuration(this._duration, this._endPosition);
                return e
            },
            startWithTarget: function(e) {
                cc.MoveBy.prototype.startWithTarget.call(this, e);
                this._positionDelta.x = this._endPosition.x - e.x;
                this._positionDelta.y = this._endPosition.y - e.y
            }
        });
        cc.moveTo = function(e, b, k) {
            return new cc.MoveTo(e, b, k)
        };
        cc.SkewTo = cc.Class({
            name: "cc.SkewTo",
            extends: cc.ActionInterval,
            ctor: function(e, b, k) {
                this._deltaY = this._deltaX = this._endSkewY = this._endSkewX = this._startSkewY = this._startSkewX = this._skewY = this._skewX = 0;
                void 0 !== k && cc.SkewTo.prototype.initWithDuration.call(this, e, b, k)
            },
            initWithDuration: function(e, b, k) {
                var c = !1;
                cc.ActionInterval.prototype.initWithDuration.call(this, e) && (this._endSkewX = b, this._endSkewY = k, c = !0);
                return c
            },
            clone: function() {
                var e = new cc.SkewTo;
                this._cloneDecoration(e);
                e.initWithDuration(this._duration, this._endSkewX, this._endSkewY);
                return e
            },
            startWithTarget: function(e) {
                cc.ActionInterval.prototype.startWithTarget.call(this,
                    e);
                this._startSkewX = e.skewX % 180;
                this._deltaX = this._endSkewX - this._startSkewX;
                180 < this._deltaX && (this._deltaX -= 360); - 180 > this._deltaX && (this._deltaX += 360);
                this._startSkewY = e.skewY % 360;
                this._deltaY = this._endSkewY - this._startSkewY;
                180 < this._deltaY && (this._deltaY -= 360); - 180 > this._deltaY && (this._deltaY += 360)
            },
            update: function(e) {
                e = this._computeEaseTime(e);
                this.target.skewX = this._startSkewX + this._deltaX * e;
                this.target.skewY = this._startSkewY + this._deltaY * e
            }
        });
        cc.skewTo = function(e, b, k) {
            return new cc.SkewTo(e,
                b, k)
        };
        cc.SkewBy = cc.Class({
            name: "cc.SkewBy",
            extends: cc.SkewTo,
            ctor: function(e, b, k) {
                void 0 !== k && this.initWithDuration(e, b, k)
            },
            initWithDuration: function(e, b, k) {
                var c = !1;
                cc.SkewTo.prototype.initWithDuration.call(this, e, b, k) && (this._skewX = b, this._skewY = k, c = !0);
                return c
            },
            clone: function() {
                var e = new cc.SkewBy;
                this._cloneDecoration(e);
                e.initWithDuration(this._duration, this._skewX, this._skewY);
                return e
            },
            startWithTarget: function(e) {
                cc.SkewTo.prototype.startWithTarget.call(this, e);
                this._deltaX = this._skewX;
                this._deltaY =
                    this._skewY;
                this._endSkewX = this._startSkewX + this._deltaX;
                this._endSkewY = this._startSkewY + this._deltaY
            },
            reverse: function() {
                var e = new cc.SkewBy(this._duration, -this._skewX, -this._skewY);
                this._cloneDecoration(e);
                this._reverseEaseList(e);
                return e
            }
        });
        cc.skewBy = function(e, b, k) {
            return new cc.SkewBy(e, b, k)
        };
        cc.JumpBy = cc.Class({
            name: "cc.JumpBy",
            extends: cc.ActionInterval,
            ctor: function(e, b, k, c, a) {
                this._startPosition = cc.v2(0, 0);
                this._previousPosition = cc.v2(0, 0);
                this._delta = cc.v2(0, 0);
                this._jumps = this._height =
                    0;
                void 0 !== c && cc.JumpBy.prototype.initWithDuration.call(this, e, b, k, c, a)
            },
            initWithDuration: function(e, b, k, c, a) {
                return cc.ActionInterval.prototype.initWithDuration.call(this, e) ? (void 0 === a && (a = c, c = k, k = b.y, b = b.x), this._delta.x = b, this._delta.y = k, this._height = c, this._jumps = a, !0) : !1
            },
            clone: function() {
                var e = new cc.JumpBy;
                this._cloneDecoration(e);
                e.initWithDuration(this._duration, this._delta, this._height, this._jumps);
                return e
            },
            startWithTarget: function(e) {
                cc.ActionInterval.prototype.startWithTarget.call(this,
                    e);
                var b = e.x;
                e = e.y;
                this._previousPosition.x = b;
                this._previousPosition.y = e;
                this._startPosition.x = b;
                this._startPosition.y = e
            },
            update: function(e) {
                e = this._computeEaseTime(e);
                if (this.target) {
                    var b = e * this._jumps % 1;
                    b = 4 * this._height * b * (1 - b);
                    b += this._delta.y * e;
                    e *= this._delta.x;
                    var k = this._startPosition;
                    if (cc.macro.ENABLE_STACKABLE_ACTIONS) {
                        var c = this.target.y,
                            a = this._previousPosition;
                        k.x = k.x + this.target.x - a.x;
                        k.y = k.y + c - a.y;
                        e += k.x;
                        b += k.y;
                        a.x = e;
                        a.y = b;
                        this.target.setPosition(e, b)
                    } else this.target.setPosition(k.x +
                        e, k.y + b)
                }
            },
            reverse: function() {
                var e = new cc.JumpBy(this._duration, cc.v2(-this._delta.x, -this._delta.y), this._height, this._jumps);
                this._cloneDecoration(e);
                this._reverseEaseList(e);
                return e
            }
        });
        cc.jumpBy = function(e, b, k, c, a) {
            return new cc.JumpBy(e, b, k, c, a)
        };
        cc.JumpTo = cc.Class({
            name: "cc.JumpTo",
            extends: cc.JumpBy,
            ctor: function(e, b, k, c, a) {
                this._endPosition = cc.v2(0, 0);
                void 0 !== c && this.initWithDuration(e, b, k, c, a)
            },
            initWithDuration: function(e, b, k, c, a) {
                return cc.JumpBy.prototype.initWithDuration.call(this, e,
                    b, k, c, a) ? (void 0 === a && (k = b.y, b = b.x), this._endPosition.x = b, this._endPosition.y = k, !0) : !1
            },
            startWithTarget: function(e) {
                cc.JumpBy.prototype.startWithTarget.call(this, e);
                this._delta.x = this._endPosition.x - this._startPosition.x;
                this._delta.y = this._endPosition.y - this._startPosition.y
            },
            clone: function() {
                var e = new cc.JumpTo;
                this._cloneDecoration(e);
                e.initWithDuration(this._duration, this._endPosition, this._height, this._jumps);
                return e
            }
        });
        cc.jumpTo = function(e, b, k, c, a) {
            return new cc.JumpTo(e, b, k, c, a)
        };
        cc.BezierBy =
            cc.Class({
                name: "cc.BezierBy",
                extends: cc.ActionInterval,
                ctor: function(e, b) {
                    this._config = [];
                    this._startPosition = cc.v2(0, 0);
                    this._previousPosition = cc.v2(0, 0);
                    b && cc.BezierBy.prototype.initWithDuration.call(this, e, b)
                },
                initWithDuration: function(e, b) {
                    return cc.ActionInterval.prototype.initWithDuration.call(this, e) ? (this._config = b, !0) : !1
                },
                clone: function() {
                    var e = new cc.BezierBy;
                    this._cloneDecoration(e);
                    for (var b = [], k = 0; k < this._config.length; k++) {
                        var c = this._config[k];
                        b.push(cc.v2(c.x, c.y))
                    }
                    e.initWithDuration(this._duration,
                        b);
                    return e
                },
                startWithTarget: function(e) {
                    cc.ActionInterval.prototype.startWithTarget.call(this, e);
                    var b = e.x;
                    e = e.y;
                    this._previousPosition.x = b;
                    this._previousPosition.y = e;
                    this._startPosition.x = b;
                    this._startPosition.y = e
                },
                update: function(e) {
                    e = this._computeEaseTime(e);
                    if (this.target) {
                        var b = this._config,
                            k = b[0].y,
                            c = b[1].y,
                            a = b[2].y;
                        b = f(0, b[0].x, b[1].x, b[2].x, e);
                        e = f(0, k, c, a, e);
                        k = this._startPosition;
                        cc.macro.ENABLE_STACKABLE_ACTIONS ? (c = this.target.y, a = this._previousPosition, k.x = k.x + this.target.x - a.x, k.y = k.y +
                            c - a.y, b += k.x, e += k.y, a.x = b, a.y = e, this.target.setPosition(b, e)) : this.target.setPosition(k.x + b, k.y + e)
                    }
                },
                reverse: function() {
                    var e = this._config,
                        b = e[0].x,
                        k = e[0].y,
                        c = e[2].x,
                        a = e[2].y;
                    e = [cc.v2(e[1].x - c, e[1].y - a), cc.v2(b - c, k - a), cc.v2(-c, -a)];
                    e = new cc.BezierBy(this._duration, e);
                    this._cloneDecoration(e);
                    this._reverseEaseList(e);
                    return e
                }
            });
        cc.bezierBy = function(e, b) {
            return new cc.BezierBy(e, b)
        };
        cc.BezierTo = cc.Class({
            name: "cc.BezierTo",
            extends: cc.BezierBy,
            ctor: function(e, b) {
                this._toConfig = [];
                b && this.initWithDuration(e,
                    b)
            },
            initWithDuration: function(e, b) {
                return cc.ActionInterval.prototype.initWithDuration.call(this, e) ? (this._toConfig = b, !0) : !1
            },
            clone: function() {
                var e = new cc.BezierTo;
                this._cloneDecoration(e);
                e.initWithDuration(this._duration, this._toConfig);
                return e
            },
            startWithTarget: function(e) {
                cc.BezierBy.prototype.startWithTarget.call(this, e);
                e = this._startPosition;
                var b = this._toConfig,
                    k = this._config;
                k[0] = b[0].sub(e);
                k[1] = b[1].sub(e);
                k[2] = b[2].sub(e)
            }
        });
        cc.bezierTo = function(e, b) {
            return new cc.BezierTo(e, b)
        };
        cc.ScaleTo =
            cc.Class({
                name: "cc.ScaleTo",
                extends: cc.ActionInterval,
                ctor: function(e, b, k) {
                    this._startScaleY = this._startScaleX = this._scaleY = this._scaleX = 1;
                    this._deltaY = this._deltaX = this._endScaleY = this._endScaleX = 0;
                    void 0 !== b && cc.ScaleTo.prototype.initWithDuration.call(this, e, b, k)
                },
                initWithDuration: function(e, b, k) {
                    return cc.ActionInterval.prototype.initWithDuration.call(this, e) ? (this._endScaleX = b, this._endScaleY = null != k ? k : b, !0) : !1
                },
                clone: function() {
                    var e = new cc.ScaleTo;
                    this._cloneDecoration(e);
                    e.initWithDuration(this._duration,
                        this._endScaleX, this._endScaleY);
                    return e
                },
                startWithTarget: function(e) {
                    cc.ActionInterval.prototype.startWithTarget.call(this, e);
                    this._startScaleX = e.scaleX;
                    this._startScaleY = e.scaleY;
                    this._deltaX = this._endScaleX - this._startScaleX;
                    this._deltaY = this._endScaleY - this._startScaleY
                },
                update: function(e) {
                    e = this._computeEaseTime(e);
                    this.target && (this.target.scaleX = this._startScaleX + this._deltaX * e, this.target.scaleY = this._startScaleY + this._deltaY * e)
                }
            });
        cc.scaleTo = function(e, b, k) {
            return new cc.ScaleTo(e, b, k)
        };
        cc.ScaleBy = cc.Class({
            name: "cc.ScaleBy",
            extends: cc.ScaleTo,
            startWithTarget: function(e) {
                cc.ScaleTo.prototype.startWithTarget.call(this, e);
                this._deltaX = this._startScaleX * this._endScaleX - this._startScaleX;
                this._deltaY = this._startScaleY * this._endScaleY - this._startScaleY
            },
            reverse: function() {
                var e = new cc.ScaleBy(this._duration, 1 / this._endScaleX, 1 / this._endScaleY);
                this._cloneDecoration(e);
                this._reverseEaseList(e);
                return e
            },
            clone: function() {
                var e = new cc.ScaleBy;
                this._cloneDecoration(e);
                e.initWithDuration(this._duration,
                    this._endScaleX, this._endScaleY);
                return e
            }
        });
        cc.scaleBy = function(e, b, k) {
            return new cc.ScaleBy(e, b, k)
        };
        cc.Blink = cc.Class({
            name: "cc.Blink",
            extends: cc.ActionInterval,
            ctor: function(e, b) {
                this._times = 0;
                this._originalState = !1;
                void 0 !== b && this.initWithDuration(e, b)
            },
            initWithDuration: function(e, b) {
                return cc.ActionInterval.prototype.initWithDuration.call(this, e) ? (this._times = b, !0) : !1
            },
            clone: function() {
                var e = new cc.Blink;
                this._cloneDecoration(e);
                e.initWithDuration(this._duration, this._times);
                return e
            },
            update: function(e) {
                e =
                    this._computeEaseTime(e);
                if (this.target && !this.isDone()) {
                    var b = 1 / this._times;
                    this.target.opacity = e % b > b / 2 ? 255 : 0
                }
            },
            startWithTarget: function(e) {
                cc.ActionInterval.prototype.startWithTarget.call(this, e);
                this._originalState = e.opacity
            },
            stop: function() {
                this.target.opacity = this._originalState;
                cc.ActionInterval.prototype.stop.call(this)
            },
            reverse: function() {
                var e = new cc.Blink(this._duration, this._times);
                this._cloneDecoration(e);
                this._reverseEaseList(e);
                return e
            }
        });
        cc.blink = function(e, b) {
            return new cc.Blink(e,
                b)
        };
        cc.FadeTo = cc.Class({
            name: "cc.FadeTo",
            extends: cc.ActionInterval,
            ctor: function(e, b) {
                this._fromOpacity = this._toOpacity = 0;
                void 0 !== b && cc.FadeTo.prototype.initWithDuration.call(this, e, b)
            },
            initWithDuration: function(e, b) {
                return cc.ActionInterval.prototype.initWithDuration.call(this, e) ? (this._toOpacity = b, !0) : !1
            },
            clone: function() {
                var e = new cc.FadeTo;
                this._cloneDecoration(e);
                e.initWithDuration(this._duration, this._toOpacity);
                return e
            },
            update: function(e) {
                e = this._computeEaseTime(e);
                var b = void 0 !== this._fromOpacity ?
                    this._fromOpacity : 255;
                this.target.opacity = b + (this._toOpacity - b) * e
            },
            startWithTarget: function(e) {
                cc.ActionInterval.prototype.startWithTarget.call(this, e);
                this._fromOpacity = e.opacity
            }
        });
        cc.fadeTo = function(e, b) {
            return new cc.FadeTo(e, b)
        };
        cc.FadeIn = cc.Class({
            name: "cc.FadeIn",
            extends: cc.FadeTo,
            ctor: function(e) {
                null == e && (e = 0);
                this._reverseAction = null;
                this.initWithDuration(e, 255)
            },
            reverse: function() {
                var e = new cc.FadeOut;
                e.initWithDuration(this._duration, 0);
                this._cloneDecoration(e);
                this._reverseEaseList(e);
                return e
            },
            clone: function() {
                var e = new cc.FadeIn;
                this._cloneDecoration(e);
                e.initWithDuration(this._duration, this._toOpacity);
                return e
            },
            startWithTarget: function(e) {
                this._reverseAction && (this._toOpacity = this._reverseAction._fromOpacity);
                cc.FadeTo.prototype.startWithTarget.call(this, e)
            }
        });
        cc.fadeIn = function(e) {
            return new cc.FadeIn(e)
        };
        cc.FadeOut = cc.Class({
            name: "cc.FadeOut",
            extends: cc.FadeTo,
            ctor: function(e) {
                null == e && (e = 0);
                this._reverseAction = null;
                this.initWithDuration(e, 0)
            },
            reverse: function() {
                var e = new cc.FadeIn;
                e._reverseAction = this;
                e.initWithDuration(this._duration, 255);
                this._cloneDecoration(e);
                this._reverseEaseList(e);
                return e
            },
            clone: function() {
                var e = new cc.FadeOut;
                this._cloneDecoration(e);
                e.initWithDuration(this._duration, this._toOpacity);
                return e
            }
        });
        cc.fadeOut = function(e) {
            return new cc.FadeOut(e)
        };
        cc.TintTo = cc.Class({
            name: "cc.TintTo",
            extends: cc.ActionInterval,
            ctor: function(e, b, k, c) {
                this._to = cc.color(0, 0, 0);
                this._from = cc.color(0, 0, 0);
                b instanceof cc.Color && (c = b.b, k = b.g, b = b.r);
                void 0 !== c && this.initWithDuration(e,
                    b, k, c)
            },
            initWithDuration: function(e, b, k, c) {
                return cc.ActionInterval.prototype.initWithDuration.call(this, e) ? (this._to = cc.color(b, k, c), !0) : !1
            },
            clone: function() {
                var e = new cc.TintTo;
                this._cloneDecoration(e);
                var b = this._to;
                e.initWithDuration(this._duration, b.r, b.g, b.b);
                return e
            },
            startWithTarget: function(e) {
                cc.ActionInterval.prototype.startWithTarget.call(this, e);
                this._from = this.target.color
            },
            update: function(e) {
                e = this._computeEaseTime(e);
                var b = this._from,
                    k = this._to;
                b && (this.target.color = cc.color(b.r + (k.r -
                    b.r) * e, b.g + (k.g - b.g) * e, b.b + (k.b - b.b) * e))
            }
        });
        cc.tintTo = function(e, b, k, c) {
            return new cc.TintTo(e, b, k, c)
        };
        cc.TintBy = cc.Class({
            name: "cc.TintBy",
            extends: cc.ActionInterval,
            ctor: function(e, b, k, c) {
                this._fromB = this._fromG = this._fromR = this._deltaB = this._deltaG = this._deltaR = 0;
                void 0 !== c && this.initWithDuration(e, b, k, c)
            },
            initWithDuration: function(e, b, k, c) {
                return cc.ActionInterval.prototype.initWithDuration.call(this, e) ? (this._deltaR = b, this._deltaG = k, this._deltaB = c, !0) : !1
            },
            clone: function() {
                var e = new cc.TintBy;
                this._cloneDecoration(e);
                e.initWithDuration(this._duration, this._deltaR, this._deltaG, this._deltaB);
                return e
            },
            startWithTarget: function(e) {
                cc.ActionInterval.prototype.startWithTarget.call(this, e);
                e = e.color;
                this._fromR = e.r;
                this._fromG = e.g;
                this._fromB = e.b
            },
            update: function(e) {
                e = this._computeEaseTime(e);
                this.target.color = cc.color(this._fromR + this._deltaR * e, this._fromG + this._deltaG * e, this._fromB + this._deltaB * e)
            },
            reverse: function() {
                var e = new cc.TintBy(this._duration, -this._deltaR, -this._deltaG, -this._deltaB);
                this._cloneDecoration(e);
                this._reverseEaseList(e);
                return e
            }
        });
        cc.tintBy = function(e, b, k, c) {
            return new cc.TintBy(e, b, k, c)
        };
        cc.DelayTime = cc.Class({
            name: "cc.DelayTime",
            extends: cc.ActionInterval,
            update: function(e) {},
            reverse: function() {
                var e = new cc.DelayTime(this._duration);
                this._cloneDecoration(e);
                this._reverseEaseList(e);
                return e
            },
            clone: function() {
                var e = new cc.DelayTime;
                this._cloneDecoration(e);
                e.initWithDuration(this._duration);
                return e
            }
        });
        cc.delayTime = function(e) {
            return new cc.DelayTime(e)
        };
        cc.ReverseTime =
            cc.Class({
                name: "cc.ReverseTime",
                extends: cc.ActionInterval,
                ctor: function(e) {
                    this._other = null;
                    e && this.initWithAction(e)
                },
                initWithAction: function(e) {
                    return e ? e === this._other ? (cc.errorID(1029), !1) : cc.ActionInterval.prototype.initWithDuration.call(this, e._duration) ? (this._other = e, !0) : !1 : (cc.errorID(1028), !1)
                },
                clone: function() {
                    var e = new cc.ReverseTime;
                    this._cloneDecoration(e);
                    e.initWithAction(this._other.clone());
                    return e
                },
                startWithTarget: function(e) {
                    cc.ActionInterval.prototype.startWithTarget.call(this,
                        e);
                    this._other.startWithTarget(e)
                },
                update: function(e) {
                    e = this._computeEaseTime(e);
                    this._other && this._other.update(1 - e)
                },
                reverse: function() {
                    return this._other.clone()
                },
                stop: function() {
                    this._other.stop();
                    cc.Action.prototype.stop.call(this)
                }
            });
        cc.reverseTime = function(e) {
            return new cc.ReverseTime(e)
        };
        cc.TargetedAction = cc.Class({
            name: "cc.TargetedAction",
            extends: cc.ActionInterval,
            ctor: function(e, b) {
                this._forcedTarget = this._action = null;
                b && this.initWithTarget(e, b)
            },
            initWithTarget: function(e, b) {
                return this.initWithDuration(b._duration) ?
                    (this._forcedTarget = e, this._action = b, !0) : !1
            },
            clone: function() {
                var e = new cc.TargetedAction;
                this._cloneDecoration(e);
                e.initWithTarget(this._forcedTarget, this._action.clone());
                return e
            },
            startWithTarget: function(e) {
                cc.ActionInterval.prototype.startWithTarget.call(this, e);
                this._action.startWithTarget(this._forcedTarget)
            },
            stop: function() {
                this._action.stop()
            },
            update: function(e) {
                e = this._computeEaseTime(e);
                this._action.update(e)
            },
            getForcedTarget: function() {
                return this._forcedTarget
            },
            setForcedTarget: function(e) {
                this._forcedTarget !==
                    e && (this._forcedTarget = e)
            }
        });
        cc.targetedAction = function(e, b) {
            return new cc.TargetedAction(e, b)
        }
    }, {}],
    7: [function(h, q, m) {
        h("../core/platform/CCClass");
        var f = h("../core/platform/js"),
            e = function() {
                this.actions = [];
                this.target = null;
                this.actionIndex = 0;
                this.currentAction = null;
                this.lock = this.paused = !1
            };
        cc.ActionManager = function() {
            this._hashTargets = f.createMap(!0);
            this._arrayTargets = [];
            this._currentTarget = null;
            cc.director._scheduler && cc.director._scheduler.enableForTarget(this)
        };
        cc.ActionManager.prototype = {
            constructor: cc.ActionManager,
            _elementPool: [],
            _searchElementByTarget: function(b, k) {
                for (var c = 0; c < b.length; c++)
                    if (k === b[c].target) return b[c];
                return null
            },
            _getElement: function(b, k) {
                var c = this._elementPool.pop();
                c || (c = new e);
                c.target = b;
                c.paused = !!k;
                return c
            },
            _putElement: function(b) {
                b.actions.length = 0;
                b.actionIndex = 0;
                b.currentAction = null;
                b.paused = !1;
                b.target = null;
                b.lock = !1;
                this._elementPool.push(b)
            },
            addAction: function(b, k, c) {
                if (b && k) {
                    var a = this._hashTargets[k._id];
                    a ? a.actions || (a.actions = []) : (a = this._getElement(k,
                        c), this._hashTargets[k._id] = a, this._arrayTargets.push(a));
                    a.actions.push(b);
                    b.startWithTarget(k)
                } else cc.errorID(1E3)
            },
            removeAllActions: function() {
                for (var b = this._arrayTargets, k = 0; k < b.length; k++) {
                    var c = b[k];
                    c && this._putElement(c)
                }
                this._arrayTargets.length = 0;
                this._hashTargets = f.createMap(!0)
            },
            removeAllActionsFromTarget: function(b, k) {
                null != b && (b = this._hashTargets[b._id]) && (b.actions.length = 0, this._deleteHashElement(b))
            },
            removeAction: function(b) {
                if (b) {
                    var k = b.getOriginalTarget();
                    if (k = this._hashTargets[k._id])
                        for (var c =
                                0; c < k.actions.length; c++)
                            if (k.actions[c] === b) {
                                k.actions.splice(c, 1);
                                k.actionIndex >= c && k.actionIndex--;
                                break
                            }
                }
            },
            _removeActionByTag: function(b, k, c) {
                for (var a = 0, d = k.actions.length; a < d; ++a) {
                    var l = k.actions[a];
                    if (l && l.getTag() === b && (!c || l.getOriginalTarget() === c)) {
                        this._removeActionAtIndex(a, k);
                        break
                    }
                }
            },
            removeActionByTag: function(b, k) {
                b === cc.Action.TAG_INVALID && cc.logID(1002);
                var c = this._hashTargets;
                if (k)(c = c[k._id]) && this._removeActionByTag(b, c, k);
                else
                    for (var a in c) this._removeActionByTag(b, c[a])
            },
            getActionByTag: function(b, k) {
                b === cc.Action.TAG_INVALID && cc.logID(1004);
                if (k = this._hashTargets[k._id]) {
                    if (null != k.actions)
                        for (var c = 0; c < k.actions.length; ++c) {
                            var a = k.actions[c];
                            if (a && a.getTag() === b) return a
                        }
                    cc.logID(1005, b)
                }
                return null
            },
            getNumberOfRunningActionsInTarget: function(b) {
                return (b = this._hashTargets[b._id]) ? b.actions ? b.actions.length : 0 : 0
            },
            pauseTarget: function(b) {
                (b = this._hashTargets[b._id]) && (b.paused = !0)
            },
            resumeTarget: function(b) {
                (b = this._hashTargets[b._id]) && (b.paused = !1)
            },
            pauseAllRunningActions: function() {
                for (var b = [], k = this._arrayTargets, c = 0; c < k.length; c++) {
                    var a = k[c];
                    a && !a.paused && (a.paused = !0, b.push(a.target))
                }
                return b
            },
            resumeTargets: function(b) {
                if (b)
                    for (var k = 0; k < b.length; k++) b[k] && this.resumeTarget(b[k])
            },
            pauseTargets: function(b) {
                if (b)
                    for (var k = 0; k < b.length; k++) b[k] && this.pauseTarget(b[k])
            },
            purgeSharedManager: function() {
                cc.director.getScheduler().unscheduleUpdate(this)
            },
            _removeActionAtIndex: function(b, k) {
                k.actions.splice(b, 1);
                k.actionIndex >= b && k.actionIndex--;
                0 === k.actions.length && this._deleteHashElement(k)
            },
            _deleteHashElement: function(b) {
                var k = !1;
                if (b && !b.lock && this._hashTargets[b.target._id]) {
                    delete this._hashTargets[b.target._id];
                    k = this._arrayTargets;
                    for (var c = 0, a = k.length; c < a; c++)
                        if (k[c] === b) {
                            k.splice(c, 1);
                            break
                        }
                    this._putElement(b);
                    k = !0
                }
                return k
            },
            update: function(b) {
                for (var k = this._arrayTargets, c, a = 0; a < k.length; a++) {
                    c = this._currentTarget = k[a];
                    if (!c.paused && c.actions) {
                        c.lock = !0;
                        for (c.actionIndex = 0; c.actionIndex < c.actions.length; c.actionIndex++)
                            if (c.currentAction = c.actions[c.actionIndex], c.currentAction) {
                                c.currentAction.step(b *
                                    (c.currentAction._speedMethod ? c.currentAction._speed : 1));
                                if (c.currentAction && c.currentAction.isDone()) {
                                    c.currentAction.stop();
                                    var d = c.currentAction;
                                    c.currentAction = null;
                                    this.removeAction(d)
                                }
                                c.currentAction = null
                            }
                        c.lock = !1
                    }
                    0 === c.actions.length && this._deleteHashElement(c) && a--
                }
            }
        };
        !1
    }, {
        "../core/platform/CCClass": 204,
        "../core/platform/js": 225
    }],
    8: [function(h, q, m) {
            h("./CCActionManager");
            h("./CCAction");
            h("./CCActionInterval");
            h("./CCActionInstant");
            h("./CCActionEase");
            h("./CCActionCatmullRom");
            h("./tween")
        },
        {
            "./CCAction": 2,
            "./CCActionCatmullRom": 3,
            "./CCActionEase": 4,
            "./CCActionInstant": 5,
            "./CCActionInterval": 6,
            "./CCActionManager": 7,
            "./tween": 9
        }
    ],
    9: [function(h, q, m) {
        function f(a) {
            this._actions = [];
            this._finalAction = null;
            this._target = a;
            this._tag = cc.Action.TAG_INVALID
        }

        function e(a) {
            return function() {
                d.length = 0;
                for (var c = arguments.length, b = 0; b < c; b++) {
                    var g = d[b] = arguments[b];
                    g instanceof f && (d[b] = g._union())
                }
                return a.apply(this, d)
            }
        }
        var b = h("../animation/bezier"),
            k = 0,
            c = cc.Class({
                name: "cc.TweenAction",
                extends: cc.ActionInterval,
                ctor: function(a, d, c) {
                    this._opts = c = c || Object.create(null);
                    this._props = Object.create(null);
                    c.progress = c.progress || this.progress;
                    if (c.easing && "string" === typeof c.easing) {
                        var b = c.easing;
                        c.easing = cc.easing[b];
                        !c.easing && cc.warnID(1031, b)
                    }
                    c = this._opts.relative;
                    for (var g in d) {
                        b = d[g];
                        var l = void 0,
                            n = void 0;
                        void 0 !== b.value && (b.easing || b.progress) && ("string" === typeof b.easing ? (l = cc.easing[b.easing], !l && cc.warnID(1031, b.easing)) : l = b.easing, n = b.progress, b = b.value);
                        if ("number" === typeof b || b.lerp && (!c || b.add ||
                                b.mul) && b.clone) {
                            var p = Object.create(null);
                            p.value = b;
                            p.easing = l;
                            p.progress = n;
                            this._props[g] = p
                        } else cc.warn("Can not animate " + g + " property, because it do not have [lerp, (add|mul), clone] function.")
                    }
                    this._originProps = d;
                    this.initWithDuration(a)
                },
                clone: function() {
                    var a = new c(this._duration, this._originProps, this._opts);
                    this._cloneDecoration(a);
                    return a
                },
                startWithTarget: function(a) {
                    cc.ActionInterval.prototype.startWithTarget.call(this, a);
                    var d = !!this._opts.relative,
                        c = this._props,
                        b;
                    for (b in c) {
                        var g =
                            a[b],
                            l = c[b];
                        "number" === typeof g ? (l.start = g, l.current = g, l.end = d ? g + l.value : l.value) : (l.start = g.clone(), l.current = g.clone(), l.end = d ? (g.add || g.mul).call(g, l.value) : l.value)
                    }
                },
                update: function(a) {
                    var d = this._opts,
                        c = a;
                    d.easing && (c = d.easing(a));
                    if (d = this.target) {
                        var b = this._props,
                            g = this._opts.progress,
                            l;
                        for (l in b) {
                            var n = b[l],
                                w = n.easing ? n.easing(a) : c;
                            n = n.current = (n.progress || g)(n.start, n.end, n.current, w);
                            d[l] = n
                        }
                    }
                },
                progress: function(a, d, c, b) {
                    "number" === typeof a ? c = a + (d - a) * b : a.lerp(d, b, c);
                    return c
                }
            }),
            a = cc.Class({
                name: "cc.SetAction",
                extends: cc.ActionInstant,
                ctor: function(a) {
                    this._props = {};
                    void 0 !== a && this.init(a)
                },
                init: function(a) {
                    for (var d in a) this._props[d] = a[d];
                    return !0
                },
                update: function() {
                    var a = this._props,
                        d = this.target,
                        c;
                    for (c in a) d[c] = a[c]
                },
                clone: function() {
                    var d = new a;
                    d.init(this._props);
                    return d
                }
            });
        f.stopAll = function() {
            cc.director.getActionManager().removeAllActions()
        };
        f.stopAllByTag = function(a) {
            cc.director.getActionManager().removeActionByTag(a)
        };
        f.stopAllByTarget = function(a) {
            cc.director.getActionManager().removeAllActionsFromTarget(a)
        };
        f.prototype.then = function(a) {
            a instanceof cc.Action ? this._actions.push(a.clone()) : this._actions.push(a._union());
            return this
        };
        f.prototype.target = function(a) {
            this._target = a;
            return this
        };
        f.prototype.start = function() {
            var a = this._target;
            if (!a) return cc.warn("Please set target to tween first"), this;
            if (!(a instanceof cc.Object) || a.isValid) return this._finalAction && cc.director.getActionManager().removeAction(this._finalAction), this._finalAction = this._union(), void 0 === a._id && (a._id = ++k), this._finalAction.setTag(this._tag),
                cc.director.getActionManager().addAction(this._finalAction, a, !1), this
        };
        f.prototype.stop = function() {
            this._finalAction && cc.director.getActionManager().removeAction(this._finalAction);
            return this
        };
        f.prototype.tag = function(a) {
            this._tag = a;
            return this
        };
        f.prototype.clone = function(a) {
            var d = this._union();
            return cc.tween(a).then(d.clone())
        };
        f.prototype.union = function() {
            var a = this._union();
            this._actions.length = 0;
            this._actions.push(a);
            return this
        };
        f.prototype._union = function() {
            var a = this._actions;
            return a = 1 ===
                a.length ? a[0] : cc.sequence(a)
        };
        Object.assign(f.prototype, {
            bezierTo: function(a, d, c, g, l) {
                var n = d.x,
                    p = d.y,
                    t = c.x,
                    k = c.y;
                l = l || Object.create(null);
                l.progress = function(a, d, c, g) {
                    c.x = (0, b.bezier)(a.x, n, t, d.x, g);
                    c.y = (0, b.bezier)(a.y, p, k, d.y, g);
                    return c
                };
                return this.to(a, {
                    position: g
                }, l)
            },
            bezierBy: function(a, d, c, g, l) {
                var n = d.x,
                    p = d.y,
                    t = c.x,
                    k = c.y;
                l = l || Object.create(null);
                l.progress = function(a, d, c, g) {
                    var l = a.x;
                    a = a.y;
                    c.x = (0, b.bezier)(l, n + l, t + l, d.x, g);
                    c.y = (0, b.bezier)(a, p + a, k + a, d.y, g);
                    return c
                };
                return this.by(a, {
                        position: g
                    },
                    l)
            },
            flipX: function() {
                var a = this;
                return this.call(function() {
                    a._target.scaleX *= -1
                }, this)
            },
            flipY: function() {
                var a = this;
                return this.call(function() {
                    a._target.scaleY *= -1
                }, this)
            },
            blink: function(a, d, c) {
                var b = 1 / d;
                c = c || Object.create(null);
                c.progress = function(a, d, c, g) {
                    return 1 <= g ? a : g % b > b / 2 ? 255 : 0
                };
                return this.to(a, {
                    opacity: 1
                }, c)
            }
        });
        var d = [],
            l = {
                to: function(a, d, b) {
                    b = b || Object.create(null);
                    b.relative = !1;
                    return new c(a, d, b)
                },
                by: function(a, d, b) {
                    b = b || Object.create(null);
                    b.relative = !0;
                    return new c(a, d, b)
                },
                set: function(d) {
                    return new a(d)
                },
                delay: cc.delayTime,
                call: cc.callFunc,
                hide: cc.hide,
                show: cc.show,
                removeSelf: cc.removeSelf,
                sequence: e(cc.sequence),
                parallel: e(cc.spawn)
            },
            g = {
                repeat: cc.repeat,
                repeatForever: function(a) {
                    return cc.repeat(a, 1E9)
                },
                reverseTime: cc.reverseTime
            },
            n = Object.keys(l);
        h = function(a) {
            var d = n[a];
            f.prototype[d] = function() {
                var a = l[d].apply(this, arguments);
                this._actions.push(a);
                return this
            }
        };
        for (q = 0; q < n.length; q++) h(q);
        n = Object.keys(g);
        h = function(a) {
            var d = n[a];
            f.prototype[d] = function() {
                var a = this._actions,
                    c = arguments[arguments.length -
                        1],
                    b = arguments.length - 1;
                c instanceof cc.Tween ? c = c._union() : c instanceof cc.Action || (c = a[a.length - 1], --a.length, b += 1);
                c = [c];
                for (var l = 0; l < b; l++) c.push(arguments[l]);
                c = g[d].apply(this, c);
                a.push(c);
                return this
            }
        };
        for (q = 0; q < n.length; q++) h(q);
        cc.tween = function(a) {
            return new f(a)
        };
        cc.Tween = f
    }, {
        "../animation/bezier": 15
    }],
    10: [function(h, q, m) {
        function f(a, d) {
            k.call(this);
            this.target = a;
            this.animation = d;
            this._anims = new b.array.MutableForwardIterator([])
        }

        function e(b, n) {
            var g = n.clip;
            n.duration = g.duration;
            n.speed =
                g.speed;
            n.wrapMode = g.wrapMode;
            n.frameRate = g.sample;
            (n.wrapMode & d.Loop) === d.Loop ? n.repeatCount = Infinity : n.repeatCount = 1;
            var t = n.curves = g.createCurves(n, b);
            g = g.events;
            if (!0, g)
                for (var p, k = 0, e = g.length; k < e; k++) {
                    p || (p = new c, p.target = b, t.push(p));
                    var f = g[k],
                        h = f.frame / n.duration;
                    var E = l(p.ratios, h);
                    0 <= E ? E = p.events[E] : (E = new a, p.ratios.push(h), p.events.push(E));
                    E.add(f.func, f.params)
                }
        }
        var b = cc.js,
            k = h("./playable");
        m = h("./animation-curves");
        var c = m.EventAnimCurve,
            a = m.EventInfo,
            d = h("./types").WrapModeMask,
            l = h("../core/utils/binary-search").binarySearchEpsilon;
        b.extend(f, k);
        h = f.prototype;
        h.playState = function(a, d) {
            a.clip && (a.curveLoaded || e(this.target, a), a.animator = this, a.play(), "number" === typeof d && a.setTime(d), this.play())
        };
        h.stopStatesExcept = function(a) {
            var d = this._anims,
                c = d.array;
            for (d.i = 0; d.i < c.length; ++d.i) {
                var b = c[d.i];
                b !== a && this.stopState(b)
            }
        };
        h.addAnimation = function(a) {
            -1 === this._anims.array.indexOf(a) && this._anims.push(a);
            a._setEventTarget(this.animation)
        };
        h.removeAnimation = function(a) {
            var d =
                this._anims.array.indexOf(a);
            0 <= d ? (this._anims.fastRemoveAt(d), 0 === this._anims.array.length && this.stop()) : cc.errorID(3907);
            a.animator = null
        };
        h.sample = function() {
            var a = this._anims,
                d = a.array;
            for (a.i = 0; a.i < d.length; ++a.i) d[a.i].sample()
        };
        h.stopState = function(a) {
            a && a.stop()
        };
        h.pauseState = function(a) {
            a && a.pause()
        };
        h.resumeState = function(a) {
            a && a.resume();
            this.isPaused && this.resume()
        };
        h.setStateTime = function(a, d) {
            if (void 0 !== d) a && (a.setTime(d), a.sample());
            else {
                d = a;
                a = this._anims.array;
                for (var c = 0; c < a.length; ++c) {
                    var b =
                        a[c];
                    b.setTime(d);
                    b.sample()
                }
            }
        };
        h.onStop = function() {
            var a = this._anims,
                d = a.array;
            for (a.i = 0; a.i < d.length; ++a.i) d[a.i].stop()
        };
        h.onPause = function() {
            for (var a = this._anims.array, d = 0; d < a.length; ++d) {
                var c = a[d];
                c.pause();
                c.animator = null
            }
        };
        h.onResume = function() {
            for (var a = this._anims.array, d = 0; d < a.length; ++d) {
                var c = a[d];
                c.animator = this;
                c.resume()
            }
        };
        h._reloadClip = function(a) {
            e(this.target, a)
        };
        !1;
        !1;
        q.exports = f
    }, {
        "../core/utils/binary-search": 279,
        "./animation-curves": 12,
        "./playable": 19,
        "./types": 20
    }],
    11: [function(h,
        q, m) {
        m = h("./types").WrapMode;
        var f = h("./animation-curves"),
            e = f.DynamicAnimCurve,
            b = f.quickFindIndex,
            k = h("./motion-path-helper").sampleMotionPaths,
            c = h("../core/utils/binary-search").binarySearchEpsilon,
            a = cc.Class({
                name: "cc.AnimationClip",
                extends: cc.Asset,
                properties: {
                    _duration: {
                        default: 0,
                        type: cc.Float
                    },
                    duration: {
                        get: function() {
                            return this._duration
                        }
                    },
                    sample: {
                        default: 60
                    },
                    speed: {
                        default: 1
                    },
                    wrapMode: {
                        default: m.Normal
                    },
                    curveData: {
                        default: {},
                        visible: !1
                    },
                    events: {
                        default: [],
                        visible: !1
                    }
                },
                statics: {
                    createWithSpriteFrames: function(d,
                        c) {
                        if (!Array.isArray(d)) return cc.errorID(3905), null;
                        var b = new a;
                        b.sample = c || b.sample;
                        b._duration = d.length / b.sample;
                        c = [];
                        for (var l = 1 / b.sample, k = 0, t = d.length; k < t; k++) c[k] = {
                            frame: k * l,
                            value: d[k]
                        };
                        b.curveData = {
                            comps: {
                                "cc.Sprite": {
                                    spriteFrame: c
                                }
                            }
                        };
                        return b
                    }
                },
                onLoad: function() {
                    this._duration = Number.parseFloat(this.duration);
                    this.speed = Number.parseFloat(this.speed);
                    this.wrapMode = Number.parseInt(this.wrapMode);
                    this.frameRate = Number.parseFloat(this.sample)
                },
                createPropCurve: function(a, l, g) {
                    var d = [],
                        w = a instanceof
                    cc.Node && "position" === l, t = new e;
                    t.target = a;
                    t.prop = l;
                    l = 0;
                    for (var p = g.length; l < p; l++) {
                        var u = g[l];
                        t.ratios.push(u.frame / this.duration);
                        w && d.push(u.motionPath);
                        t.values.push(u.value);
                        if (u = u.curve) {
                            if ("string" === typeof u) {
                                t.types.push(u);
                                continue
                            }
                            if (Array.isArray(u)) {
                                u[0] === u[1] && u[2] === u[3] ? t.types.push(e.Linear) : t.types.push(e.Bezier(u));
                                continue
                            }
                        }
                        t.types.push(e.Linear)
                    }
                    w && k(d, t, this.duration, this.sample, a);
                    a = t.ratios;
                    d = !0;
                    w = 1;
                    for (l = a.length; w < l; w++)
                        if (g = a[w] - a[w - 1], 1 === w) var v = g;
                        else if (1E-6 < Math.abs(g -
                            v)) {
                        d = !1;
                        break
                    }
                    t._findFrameIndex = d ? b : c;
                    v = t.values[0];
                    void 0 === v || null === v || t._lerp || ("number" === typeof v ? t._lerp = e.prototype._lerpNumber : v instanceof cc.Quat ? t._lerp = e.prototype._lerpQuat : v instanceof cc.Vec2 ? t._lerp = e.prototype._lerpVector2 : v instanceof cc.Vec3 ? t._lerp = e.prototype._lerpVector3 : v.lerp && (t._lerp = e.prototype._lerpObject));
                    return t
                },
                createTargetCurves: function(a, c, b) {
                    var d = c.props;
                    c = c.comps;
                    if (d)
                        for (var l in d) {
                            var g = this.createPropCurve(a, l, d[l]);
                            b.push(g)
                        }
                    if (c)
                        for (var p in c)
                            if (d =
                                a.getComponent(p)) {
                                l = c[p];
                                for (var k in l) g = this.createPropCurve(d, k, l[k]), b.push(g)
                            }
                },
                createCurves: function(a, c) {
                    var d = this.curveData;
                    a = d.paths;
                    var b = [];
                    this.createTargetCurves(c, d, b);
                    for (var l in a)(d = cc.find(l, c)) && this.createTargetCurves(d, a[l], b);
                    return b
                }
            });
        cc.AnimationClip = q.exports = a
    }, {
        "../core/utils/binary-search": 279,
        "./animation-curves": 12,
        "./motion-path-helper": 18,
        "./types": 20
    }],
    12: [function(h, q, m) {
        function f(a, d) {
            if ("string" === typeof d) {
                var c = cc.easing[d];
                c ? a = c(a) : cc.errorID(3906, d)
            } else Array.isArray(d) &&
                (a = e(d, a));
            return a
        }
        var e = h("./bezier").bezierByTime,
            b = h("../core/utils/binary-search").binarySearchEpsilon,
            k = h("./types").WrapModeMask,
            c = h("./types").WrappedInfo;
        h = cc.Class({
            name: "cc.AnimCurve",
            sample: function(a, d, c) {},
            onTimeChangedManually: void 0
        });
        m = cc.Class({
            name: "cc.DynamicAnimCurve",
            extends: h,
            ctor: function() {
                this._cachedIndex = 0
            },
            properties: {
                target: null,
                prop: "",
                values: [],
                ratios: [],
                types: []
            },
            _findFrameIndex: b,
            _lerp: void 0,
            _lerpNumber: function(a, d, c) {
                return a + (d - a) * c
            },
            _lerpObject: function(a, d,
                c) {
                return a.lerp(d, c)
            },
            _lerpQuat: function() {
                var a = cc.quat();
                return function(d, c, b) {
                    return d.lerp(c, b, a)
                }
            }(),
            _lerpVector2: function() {
                var a = cc.v2();
                return function(d, c, b) {
                    return d.lerp(c, b, a)
                }
            }(),
            _lerpVector3: function() {
                var a = cc.v3();
                return function(d, c, b) {
                    return d.lerp(c, b, a)
                }
            }(),
            sample: function(a, d, c) {
                a = this.values;
                c = this.ratios;
                var b = c.length;
                if (0 !== b) {
                    var l = !0,
                        g = this._cachedIndex;
                    if (0 > g && (g = ~g, 0 < g && g < c.length)) {
                        var n = c[g];
                        d > c[g - 1] && d < n && (l = !1)
                    }
                    l && (this._cachedIndex = this._findFrameIndex(c, d));
                    l =
                        this._cachedIndex;
                    0 > l ? (l = ~l, 0 >= l ? d = a[0] : l >= b ? d = a[b - 1] : (b = a[l - 1], this._lerp ? (n = c[l - 1], g = this.types[l - 1], d = (d - n) / (c[l] - n), g && (d = f(d, g)), d = this._lerp(b, a[l], d)) : d = b)) : d = a[l];
                    this.target[this.prop] = d
                }
            }
        });
        m.Linear = null;
        m.Bezier = function(a) {
            return a
        };
        var a = function() {
            this.events = []
        };
        a.prototype.add = function(a, d) {
            this.events.push({
                func: a || "",
                params: d || []
            })
        };
        var d = cc.Class({
            name: "cc.EventAnimCurve",
            extends: h,
            properties: {
                target: null,
                ratios: [],
                events: [],
                _wrappedInfo: {
                    default: function() {
                        return new c
                    }
                },
                _lastWrappedInfo: null,
                _ignoreIndex: NaN
            },
            _wrapIterations: function(a) {
                0 === a - (0 | a) && --a;
                return 0 | a
            },
            sample: function(a, d, n) {
                a = this.ratios.length;
                d = n.getWrappedInfo(n.time, this._wrappedInfo);
                var l = d.direction,
                    g = b(this.ratios, d.ratio);
                0 > g && (g = ~g - 1, 0 > l && (g += 1));
                this._ignoreIndex !== g && (this._ignoreIndex = NaN);
                d.frameIndex = g;
                if (this._lastWrappedInfo) {
                    n = n.wrapMode;
                    var p = this._wrapIterations(d.iterations);
                    l = this._lastWrappedInfo;
                    var u = this._wrapIterations(l.iterations),
                        e = l.frameIndex;
                    l = l.direction;
                    var f = -1 !== u && p !== u;
                    if (e === g && f &&
                        1 === a) this._fireEvent(0);
                    else if (e !== g || f) {
                        do {
                            if (e !== g) {
                                -1 === l && 0 === e && 0 < g ? ((n & k.PingPong) === k.PingPong ? l *= -1 : e = a, u++) : 1 === l && e === a - 1 && g < a - 1 && ((n & k.PingPong) === k.PingPong ? l *= -1 : e = -1, u++);
                                if (e === g) break;
                                if (u > p) break
                            }
                            e += l;
                            cc.director.getAnimationManager().pushDelayEvent(this, "_fireEvent", [e])
                        } while (e !== g && -1 < e && e < a)
                    }
                    this._lastWrappedInfo.set(d)
                } else this._fireEvent(g), this._lastWrappedInfo = new c(d)
            },
            _fireEvent: function(a) {
                if (!(0 > a || a >= this.events.length || this._ignoreIndex === a) && (a = this.events[a].events,
                        this.target.isValid))
                    for (var d = this.target._components, c = 0; c < a.length; c++)
                        for (var b = a[c], l = b.func, p = 0; p < d.length; p++) {
                            var k = d[p],
                                e = k[l];
                            e && e.apply(k, b.params)
                        }
            },
            onTimeChangedManually: function(a, d) {
                this._lastWrappedInfo = null;
                this._ignoreIndex = NaN;
                d = d.getWrappedInfo(a, this._wrappedInfo);
                a = d.direction;
                d = b(this.ratios, d.ratio);
                0 > d && (d = ~d - 1, 0 > a && (d += 1), this._ignoreIndex = d)
            }
        });
        !1;
        q.exports = {
            AnimCurve: h,
            DynamicAnimCurve: m,
            EventAnimCurve: d,
            EventInfo: a,
            computeRatioByType: f,
            quickFindIndex: function(a, d) {
                var c =
                    a.length - 1;
                if (0 === c) return 0;
                var b = a[0];
                if (d < b) return 0;
                var l = a[c];
                if (d > l) return ~a.length;
                a = (d - b) / (l - b) / (1 / c);
                d = 0 | a;
                return 1E-6 > a - d ? d : 1E-6 > d + 1 - a ? d + 1 : ~(d + 1)
            }
        }
    }, {
        "../core/utils/binary-search": 279,
        "./bezier": 15,
        "./types": 20
    }],
    13: [function(h, q, m) {
        var f = cc.js;
        h = cc.Class({
            ctor: function() {
                this._anims = new f.array.MutableForwardIterator([]);
                this._delayEvents = [];
                cc.director._scheduler && cc.director._scheduler.enableForTarget(this)
            },
            update: function(e) {
                var b = this._anims,
                    k = b.array;
                for (b.i = 0; b.i < k.length; ++b.i) {
                    var c =
                        k[b.i];
                    c._isPlaying && !c._isPaused && c.update(e)
                }
                e = this._delayEvents;
                for (b = 0; b < e.length; b++) k = e[b], k.target[k.func].apply(k.target, k.args);
                e.length = 0
            },
            destruct: function() {},
            addAnimation: function(e) {
                -1 === this._anims.array.indexOf(e) && this._anims.push(e)
            },
            removeAnimation: function(e) {
                e = this._anims.array.indexOf(e);
                0 <= e ? this._anims.fastRemoveAt(e) : cc.errorID(3907)
            },
            pushDelayEvent: function(e, b, k) {
                this._delayEvents.push({
                    target: e,
                    func: b,
                    args: k
                })
            }
        });
        cc.AnimationManager = q.exports = h
    }, {}],
    14: [function(h, q, m) {
        function f(d,
            b) {
            k.call(this);
            this._currentFramePlayed = !1;
            this._delayTime = this._delay = 0;
            this._wrappedInfo = new c;
            this._lastWrappedInfo = null;
            this._process = e;
            this._clip = d;
            this._name = b || d && d.name;
            this.animator = null;
            this.curves = [];
            this.delay = 0;
            this.speed = this.duration = this.repeatCount = 1;
            this.wrapMode = a.Normal;
            this.time = 0;
            this._target = null;
            this._lastframeEventOn = !1;
            this.emit = function() {
                for (var a = Array(arguments.length), d = 0, c = a.length; d < c; d++) a[d] = arguments[d];
                cc.director.getAnimationManager().pushDelayEvent(this, "_emit",
                    a)
            }
        }

        function e() {
            var a = this.sample();
            if (this._lastframeEventOn) {
                var d = this._lastWrappedInfo ? this._lastWrappedInfo : this._lastWrappedInfo = new c(a);
                1 < this.repeatCount && (0 | a.iterations) > (0 | d.iterations) && this.emit("lastframe", this);
                d.set(a)
            }
            a.stopped && (this.stop(), this.emit("finished", this))
        }

        function b() {
            var a = this.time,
                d = this.duration;
            a > d ? (a %= d, 0 === a && (a = d)) : 0 > a && (a %= d, 0 !== a && (a += d));
            d = a / d;
            for (var c = this.curves, b = 0, k = c.length; b < k; b++) c[b].sample(a, d, this);
            this._lastframeEventOn && (void 0 === this._lastIterations &&
                (this._lastIterations = d), (0 < this.time && this._lastIterations > d || 0 > this.time && this._lastIterations < d) && this.emit("lastframe", this), this._lastIterations = d)
        }
        m = cc.js;
        var k = h("./playable");
        h = h("./types");
        var c = h.WrappedInfo,
            a = h.WrapMode,
            d = h.WrapModeMask;
        m.extend(f, k);
        h = f.prototype;
        h._emit = function(a, d) {
            this._target && this._target.isValid && this._target.emit(a, a, d)
        };
        h.on = function(a, d, c) {
            return this._target && this._target.isValid ? ("lastframe" === a && (this._lastframeEventOn = !0), this._target.on(a, d, c)) : null
        };
        h.once =
            function(a, d, c) {
                if (this._target && this._target.isValid) {
                    "lastframe" === a && (this._lastframeEventOn = !0);
                    var b = this;
                    return this._target.once(a, function(a) {
                        d.call(c, a);
                        b._lastframeEventOn = !1
                    })
                }
                return null
            };
        h.off = function(a, d, c) {
            this._target && this._target.isValid && ("lastframe" === a && (this._target.hasEventListener(a) || (this._lastframeEventOn = !1)), this._target.off(a, d, c))
        };
        h._setEventTarget = function(a) {
            this._target = a
        };
        h.onPlay = function() {
            this.setTime(0);
            this._delayTime = this._delay;
            cc.director.getAnimationManager().addAnimation(this);
            this.animator && this.animator.addAnimation(this);
            this.emit("play", this)
        };
        h.onStop = function() {
            this.isPaused || cc.director.getAnimationManager().removeAnimation(this);
            this.animator && this.animator.removeAnimation(this);
            this.emit("stop", this)
        };
        h.onResume = function() {
            cc.director.getAnimationManager().addAnimation(this);
            this.emit("resume", this)
        };
        h.onPause = function() {
            cc.director.getAnimationManager().removeAnimation(this);
            this.emit("pause", this)
        };
        h.setTime = function(a) {
            this._currentFramePlayed = !1;
            this.time =
                a || 0;
            for (var d = this.curves, c = 0, b = d.length; c < b; c++) {
                var l = d[c];
                l.onTimeChangedManually && l.onTimeChangedManually(a, this)
            }
        };
        h.update = function(a) {
            if (0 < this._delayTime && (this._delayTime -= a, 0 < this._delayTime)) return;
            this._currentFramePlayed ? this.time += a * this.speed : this._currentFramePlayed = !0;
            this._process()
        };
        h._needRevers = function(a) {
            var c = this.wrapMode,
                b = !1;
            (c & d.PingPong) === d.PingPong && (0 === a - (0 | a) && 0 < a && --a, 1 & a && (b = !b));
            (c & d.Reverse) === d.Reverse && (b = !b);
            return b
        };
        h.getWrappedInfo = function(a, b) {
            b = b || new c;
            var l = !1,
                g = this.duration,
                k = this.repeatCount,
                p = 0 < a ? a / g : -a / g;
            p >= k && (p = k, l = !0, k -= 0 | k, 0 === k && (k = 1), a = k * g * (0 < a ? 1 : -1));
            a > g ? (a %= g, a = 0 === a ? g : a) : 0 > a && (a %= g, 0 !== a && (a += g));
            k = !1;
            var u = this._wrapMode & d.ShouldWrap;
            u && (k = this._needRevers(p));
            var e = k ? -1 : 1;
            0 > this.speed && (e *= -1);
            u && k && (a = g - a);
            b.ratio = a / g;
            b.time = a;
            b.direction = e;
            b.stopped = l;
            b.iterations = p;
            return b
        };
        h.sample = function() {
            for (var a = this.getWrappedInfo(this.time, this._wrappedInfo), d = this.curves, c = 0, b = d.length; c < b; c++) d[c].sample(a.time, a.ratio, this);
            return a
        };
        m.get(h, "clip", function() {
            return this._clip
        });
        m.get(h, "name", function() {
            return this._name
        });
        m.obsolete(h, "AnimationState.length", "duration");
        m.getset(h, "curveLoaded", function() {
            return 0 < this.curves.length
        }, function() {
            this.curves.length = 0
        });
        m.getset(h, "wrapMode", function() {
            return this._wrapMode
        }, function(a) {
            this._wrapMode = a;
            !1;
            this.time = 0;
            a & d.Loop ? this.repeatCount = Infinity : this.repeatCount = 1
        });
        m.getset(h, "repeatCount", function() {
            return this._repeatCount
        }, function(a) {
            this._repeatCount = a;
            var c = this._wrapMode &
                d.ShouldWrap,
                l = (this.wrapMode & d.Reverse) === d.Reverse;
            this._process = Infinity !== a || c || l ? e : b
        });
        m.getset(h, "delay", function() {
            return this._delay
        }, function(a) {
            this._delayTime = this._delay = a
        });
        cc.AnimationState = q.exports = f
    }, {
        "./playable": 19,
        "./types": 20
    }],
    15: [function(h, q, m) {
        function f(a) {
            return 0 > a ? -Math.pow(-a, 1 / 3) : Math.pow(a, 1 / 3)
        }
        var e = Math.cos,
            b = Math.acos,
            k = Math.max,
            c = 2 * Math.PI,
            a = Math.sqrt;
        !1;
        q.exports = {
            bezier: function(a, c, b, n, k) {
                var d = 1 - k;
                return d * (d * (a + (3 * c - a) * k) + 3 * b * k * k) + n * k * k * k
            },
            bezierByTime: function(d,
                l) {
                var g = l - 0;
                var n = l - d[0];
                var w = 3 * g,
                    t = 3 * n,
                    p = 3 * (l - d[2]),
                    u = 1 / (-g + t - p + (l - 1));
                l = 1 / 3;
                p = (w - 6 * n + p) * u;
                n = p * l;
                var v = (-w + t) * u;
                w = (3 * v - p * p) * l;
                t = w * l;
                g = (2 * p * p * p - 9 * p * v + 27 * g * u) / 27;
                u = g / 2;
                t = u * u + t * t * t;
                0 > t ? (u = -w * l, u = a(u * u * u), g = -g / (2 * u), w = b(-1 > g ? -1 : 1 < g ? 1 : g), t = 2 * f(u), g = t * e(w * l) - n, u = t * e((w + c) * l) - n, n = t * e((w + 2 * c) * l) - n, n = 0 <= g && 1 >= g ? 0 <= u && 1 >= u ? 0 <= n && 1 >= n ? k(g, u, n) : k(g, u) : 0 <= n && 1 >= n ? k(g, n) : g : 0 <= u && 1 >= u ? 0 <= n && 1 >= n ? k(u, n) : u : n) : 0 === t ? (l = 0 > u ? f(-u) : -f(u), g = 2 * l - n, u = -l - n, n = 0 <= g && 1 >= g ? 0 <= u && 1 >= u ? k(g, u) : g : u) : (g = a(t), l = f(-u + g), g = f(u + g),
                    n = l - g - n);
                l = d[1];
                return ((1 - n) * (l + (d[3] - l) * n) * 3 + n * n) * n
            }
        }
    }, {}],
    16: [function(h, q, m) {
        function f(b, k) {
            return function(c) {
                return .5 > c ? k(2 * c) / 2 : b(2 * c - 1) / 2 + .5
            }
        }
        var e = {
            constant: function() {
                return 0
            },
            linear: function(b) {
                return b
            },
            quadIn: function(b) {
                return b * b
            },
            quadOut: function(b) {
                return b * (2 - b)
            },
            quadInOut: function(b) {
                return 1 > (b *= 2) ? .5 * b * b : -.5 * (--b * (b - 2) - 1)
            },
            cubicIn: function(b) {
                return b * b * b
            },
            cubicOut: function(b) {
                return --b * b * b + 1
            },
            cubicInOut: function(b) {
                return 1 > (b *= 2) ? .5 * b * b * b : .5 * ((b -= 2) * b * b + 2)
            },
            quartIn: function(b) {
                return b *
                    b * b * b
            },
            quartOut: function(b) {
                return 1 - --b * b * b * b
            },
            quartInOut: function(b) {
                return 1 > (b *= 2) ? .5 * b * b * b * b : -.5 * ((b -= 2) * b * b * b - 2)
            },
            quintIn: function(b) {
                return b * b * b * b * b
            },
            quintOut: function(b) {
                return --b * b * b * b * b + 1
            },
            quintInOut: function(b) {
                return 1 > (b *= 2) ? .5 * b * b * b * b * b : .5 * ((b -= 2) * b * b * b * b + 2)
            },
            sineIn: function(b) {
                return 1 - Math.cos(b * Math.PI / 2)
            },
            sineOut: function(b) {
                return Math.sin(b * Math.PI / 2)
            },
            sineInOut: function(b) {
                return .5 * (1 - Math.cos(Math.PI * b))
            },
            expoIn: function(b) {
                return 0 === b ? 0 : Math.pow(1024, b - 1)
            },
            expoOut: function(b) {
                return 1 ===
                    b ? 1 : 1 - Math.pow(2, -10 * b)
            },
            expoInOut: function(b) {
                return 0 === b ? 0 : 1 === b ? 1 : 1 > (b *= 2) ? .5 * Math.pow(1024, b - 1) : .5 * (2 - Math.pow(2, -10 * (b - 1)))
            },
            circIn: function(b) {
                return 1 - Math.sqrt(1 - b * b)
            },
            circOut: function(b) {
                return Math.sqrt(1 - --b * b)
            },
            circInOut: function(b) {
                return 1 > (b *= 2) ? -.5 * (Math.sqrt(1 - b * b) - 1) : .5 * (Math.sqrt(1 - (b -= 2) * b) + 1)
            },
            elasticIn: function(b) {
                var k = .1;
                if (0 === b) return 0;
                if (1 === b) return 1;
                if (!k || 1 > k) {
                    k = 1;
                    var c = .1
                } else c = .4 * Math.asin(1 / k) / (2 * Math.PI);
                return -k * Math.pow(2, 10 * --b) * Math.sin(2 * (b - c) * Math.PI / .4)
            },
            elasticOut: function(b) {
                var k = .1;
                if (0 === b) return 0;
                if (1 === b) return 1;
                if (!k || 1 > k) {
                    k = 1;
                    var c = .1
                } else c = .4 * Math.asin(1 / k) / (2 * Math.PI);
                return k * Math.pow(2, -10 * b) * Math.sin(2 * (b - c) * Math.PI / .4) + 1
            },
            elasticInOut: function(b) {
                var k = .1;
                if (0 === b) return 0;
                if (1 === b) return 1;
                if (!k || 1 > k) {
                    k = 1;
                    var c = .1
                } else c = .4 * Math.asin(1 / k) / (2 * Math.PI);
                return 1 > (b *= 2) ? k * Math.pow(2, 10 * --b) * Math.sin(2 * (b - c) * Math.PI / .4) * -.5 : k * Math.pow(2, -10 * --b) * Math.sin(2 * (b - c) * Math.PI / .4) * .5 + 1
            },
            backIn: function(b) {
                return b * b * (2.70158 * b - 1.70158)
            },
            backOut: function(b) {
                return --b *
                    b * (2.70158 * b + 1.70158) + 1
            },
            backInOut: function(b) {
                return 1 > (b *= 2) ? b * b * (3.5949095 * b - 2.5949095) * .5 : .5 * ((b -= 2) * b * (3.5949095 * b + 2.5949095) + 2)
            },
            bounceIn: function(b) {
                return 1 - e.bounceOut(1 - b)
            },
            bounceOut: function(b) {
                return b < 1 / 2.75 ? 7.5625 * b * b : b < 2 / 2.75 ? 7.5625 * (b -= 1.5 / 2.75) * b + .75 : b < 2.5 / 2.75 ? 7.5625 * (b -= 2.25 / 2.75) * b + .9375 : 7.5625 * (b -= 2.625 / 2.75) * b + .984375
            },
            bounceInOut: function(b) {
                return .5 > b ? .5 * e.bounceIn(2 * b) : .5 * e.bounceOut(2 * b - 1) + .5
            },
            smooth: function(b) {
                return 0 >= b ? 0 : 1 <= b ? 1 : b * b * (3 - 2 * b)
            },
            fade: function(b) {
                return 0 >=
                    b ? 0 : 1 <= b ? 1 : b * b * b * (b * (6 * b - 15) + 10)
            }
        };
        e.quadOutIn = f(e.quadIn, e.quadOut);
        e.cubicOutIn = f(e.cubicIn, e.cubicOut);
        e.quartOutIn = f(e.quartIn, e.quartOut);
        e.quintOutIn = f(e.quintIn, e.quintOut);
        e.sineOutIn = f(e.sineIn, e.sineOut);
        e.expoOutIn = f(e.expoIn, e.expoOut);
        e.circOutIn = f(e.circIn, e.circOut);
        e.backOutIn = f(e.backIn, e.backOut);
        e.bounceIn = function(b) {
            return 1 - e.bounceOut(1 - b)
        };
        e.bounceInOut = function(b) {
            return .5 > b ? .5 * e.bounceIn(2 * b) : .5 * e.bounceOut(2 * b - 1) + .5
        };
        e.bounceOutIn = f(e.bounceIn, e.bounceOut);
        cc.easing = q.exports =
            e
    }, {}],
    17: [function(h, q, m) {
        h("./bezier");
        h("./easing");
        h("./types");
        h("./motion-path-helper");
        h("./animation-curves");
        h("./animation-clip");
        h("./animation-manager");
        h("./animation-state");
        h("./animation-animator")
    }, {
        "./animation-animator": 10,
        "./animation-clip": 11,
        "./animation-curves": 12,
        "./animation-manager": 13,
        "./animation-state": 14,
        "./bezier": 15,
        "./easing": 16,
        "./motion-path-helper": 18,
        "./types": 20
    }],
    18: [function(h, q, m) {
        function f(a) {
            this.points = a || [];
            this.beziers = [];
            this.ratios = [];
            this.progresses = [];
            this.length = 0;
            this.computeBeziers()
        }

        function e() {
            this.start = l();
            this.end = l();
            this.startCtrlPoint = l();
            this.endCtrlPoint = l()
        }

        function b(a) {
            if (!Array.isArray(a)) return !1;
            for (var d = 0, c = a.length; d < c; d++) {
                var b = a[d];
                if (!Array.isArray(b) || 6 !== b.length) return !1
            }
            return !0
        }
        var k = h("./animation-curves").DynamicAnimCurve,
            c = h("./animation-curves").computeRatioByType,
            a = h("./bezier").bezier,
            d = h("../core/utils/binary-search").binarySearchEpsilon,
            l = cc.v2;
        f.prototype.computeBeziers = function() {
            this.beziers.length =
                0;
            this.ratios.length = 0;
            this.length = this.progresses.length = 0;
            for (var a, d = 1; d < this.points.length; d++) {
                var c = this.points[d - 1],
                    b = this.points[d];
                a = new e;
                a.start = c.pos;
                a.startCtrlPoint = c.out;
                a.end = b.pos;
                a.endCtrlPoint = b["in"];
                this.beziers.push(a);
                this.length += a.getLength()
            }
            for (d = c = 0; d < this.beziers.length; d++) a = this.beziers[d], this.ratios[d] = a.getLength() / this.length, this.progresses[d] = c += this.ratios[d];
            return this.beziers
        };
        e.prototype.getPointAt = function(a) {
            a = this.getUtoTmapping(a);
            return this.getPoint(a)
        };
        e.prototype.getPoint = function(d) {
            var c = a(this.start.x, this.startCtrlPoint.x, this.endCtrlPoint.x, this.end.x, d);
            d = a(this.start.y, this.startCtrlPoint.y, this.endCtrlPoint.y, this.end.y, d);
            return new l(c, d)
        };
        e.prototype.getLength = function() {
            var a = this.getLengths();
            return a[a.length - 1]
        };
        e.prototype.getLengths = function(a) {
            a || (a = this.__arcLengthDivisions ? this.__arcLengthDivisions : 200);
            if (this.cacheArcLengths && this.cacheArcLengths.length === a + 1) return this.cacheArcLengths;
            var d = [],
                c = this.getPoint(0),
                b = l(),
                g,
                k = 0;
            d.push(0);
            for (g = 1; g <= a; g++) {
                var e = this.getPoint(g / a);
                b.x = c.x - e.x;
                b.y = c.y - e.y;
                k += b.mag();
                d.push(k);
                c = e
            }
            return this.cacheArcLengths = d
        };
        e.prototype.getUtoTmapping = function(a, d) {
            var c = this.getLengths(),
                b = c.length;
            d = d || a * c[b - 1];
            for (var l = 0, g = b - 1, n; l <= g;)
                if (a = Math.floor(l + (g - l) / 2), n = c[a] - d, 0 > n) l = a + 1;
                else if (0 < n) g = a - 1;
            else {
                g = a;
                break
            }
            a = g;
            if (c[a] === d) return a / (b - 1);
            l = c[a];
            return (a + (d - l) / (c[a + 1] - l)) / (b - 1)
        };
        !1;
        q.exports = {
            sampleMotionPaths: function(a, n, w, t, p) {
                function g(a) {
                    return a instanceof cc.Vec2 ? { in: a,
                        pos: a,
                        out: a
                    } : Array.isArray(a) && 6 === a.length ? { in: l(a[2], a[3]),
                        pos: l(a[0], a[1]),
                        out: l(a[4], a[5])
                    } : { in: cc.Vec2.ZERO,
                        pos: cc.Vec2.ZERO,
                        out: cc.Vec2.ZERO
                    }
                }

                function e(a, d, c) {
                    z.push(a);
                    x.push(d);
                    C.push(c)
                }
                var h = n.values = n.values.map(function(a) {
                    Array.isArray(a) && (a = 2 === a.length ? cc.v2(a[0], a[1]) : cc.v3(a[0], a[1], a[2]));
                    return a
                });
                if (0 !== a.length && 0 !== h.length) {
                    for (var B = !1, E = 0; E < a.length; E++) {
                        var y = a[E];
                        y && !b(y) && (cc.errorID(3904, p ? p.name : "", "position", E), y = null);
                        if (y && 0 < y.length) {
                            B = !0;
                            break
                        }
                    }
                    if (B && 1 !== h.length) {
                        p =
                            n.types;
                        B = n.ratios;
                        var z = n.values = [],
                            x = n.types = [],
                            C = n.ratios = [];
                        n = 0;
                        var m = k.Linear;
                        E = 0;
                        for (y = a.length; E < y - 1; E++) {
                            var F = a[E],
                                H = B[E],
                                q = B[E + 1] - H,
                                K = h[E],
                                P = h[E + 1];
                            m = p[E];
                            var S = [],
                                M = n / q,
                                O = 1 / (q * w * t);
                            if (F && 0 < F.length) {
                                var L = [];
                                L.push(g(K));
                                K = 0;
                                for (var U = F.length; K < U; K++) {
                                    var V = g(F[K]);
                                    L.push(V)
                                }
                                L.push(g(P));
                                P = new f(L);
                                P.computeBeziers();
                                for (F = P.progresses; 1E-6 < 1 - M;) L = M, L = c(L, m), 0 > L ? (K = P.beziers[0], U = (0 - L) * K.getLength(), L = K.start.sub(K.endCtrlPoint).normalize(), L = K.start.add(L.mul(U))) : 1 < L ? (K = P.beziers[P.beziers.length -
                                    1], U = (L - 1) * K.getLength(), L = K.end.sub(K.startCtrlPoint).normalize(), L = K.end.add(L.mul(U))) : (K = d(F, L), 0 > K && (K = ~K), L -= 0 < K ? F[K - 1] : 0, L /= P.ratios[K], L = P.beziers[K].getPointAt(L)), S.push(L), M += O
                            } else
                                for (; 1E-6 < 1 - M;) L = M, L = c(L, m), S.push(K.lerp(P, L)), M += O;
                            m = "constant" === m ? m : k.Linear;
                            K = 0;
                            for (U = S.length; K < U; K++) e(S[K], m, H + n + O * K * q);
                            n = 1E-6 < Math.abs(M - 1) ? (M - 1) * q : 0
                        }
                        B[B.length - 1] !== C[C.length - 1] && e(h[h.length - 1], m, B[B.length - 1])
                    }
                }
            },
            Curve: f,
            Bezier: e
        }
    }, {
        "../core/utils/binary-search": 279,
        "./animation-curves": 12,
        "./bezier": 15
    }],
    19: [function(h, q, m) {
        function f() {
            this._stepOnce = this._isPaused = this._isPlaying = !1
        }
        m = cc.js;
        var e = h("../core/CCDebug");
        h = f.prototype;
        m.get(h, "isPlaying", function() {
            return this._isPlaying
        }, !0);
        m.get(h, "isPaused", function() {
            return this._isPaused
        }, !0);
        m = function() {};
        h.onPlay = m;
        h.onPause = m;
        h.onResume = m;
        h.onStop = m;
        h.onError = m;
        h.play = function() {
            if (this._isPlaying)
                if (this._isPaused) this._isPaused = !1, this.onResume();
                else this.onError(e.getError(3912));
            else this._isPlaying = !0, this.onPlay()
        };
        h.stop = function() {
            this._isPlaying &&
                (this._isPlaying = !1, this.onStop(), this._isPaused = !1)
        };
        h.pause = function() {
            this._isPlaying && !this._isPaused && (this._isPaused = !0, this.onPause())
        };
        h.resume = function() {
            this._isPlaying && this._isPaused && (this._isPaused = !1, this.onResume())
        };
        h.step = function() {
            this.pause();
            this._stepOnce = !0;
            this._isPlaying || this.play()
        };
        q.exports = f
    }, {
        "../core/CCDebug": 37
    }],
    20: [function(h, q, m) {
        function f(e) {
            e ? this.set(e) : (this.time = this.ratio = 0, this.direction = 1, this.stopped = !0, this.iterations = 0, this.frameIndex = void 0)
        }
        h = {
            Loop: 2,
            ShouldWrap: 4,
            PingPong: 22,
            Reverse: 36
        };
        m = cc.Enum({
            Default: 0,
            Normal: 1,
            Reverse: h.Reverse,
            Loop: h.Loop,
            LoopReverse: h.Loop | h.Reverse,
            PingPong: h.PingPong,
            PingPongReverse: h.PingPong | h.Reverse
        });
        cc.WrapMode = m;
        f.prototype.set = function(e) {
            this.ratio = e.ratio;
            this.time = e.time;
            this.direction = e.direction;
            this.stopped = e.stopped;
            this.iterations = e.iterations;
            this.frameIndex = e.frameIndex
        };
        q.exports = {
            WrapModeMask: h,
            WrapMode: m,
            WrappedInfo: f
        }
    }, {}],
    21: [function(h, q, m) {
        var f = h("../core/event/event-target"),
            e = h("../core/platform/CCSys"),
            b = h("../core/assets/CCAudioClip").LoadMode,
            k = !1,
            c = [],
            a = function n(a) {
                f.call(this);
                this._shouldRecycleOnEnded = !1;
                this._src = a;
                this._element = null;
                this.id = 0;
                this._state = n.State.INITIALZING;
                this._onended = function() {
                    this._state = n.State.STOPPED;
                    this.emit("ended")
                }.bind(this)
            };
        cc.js.extend(a, f);
        a.State = {
            ERROR: -1,
            INITIALZING: 0,
            PLAYING: 1,
            PAUSED: 2,
            STOPPED: 3
        };
        (function(d) {
            d._bindEnded = function(a) {
                a = a || this._onended;
                var d = this._element;
                this._src && d instanceof HTMLAudioElement ? d.addEventListener("ended", a) : d.onended =
                    a
            };
            d._unbindEnded = function() {
                var a = this._element;
                a instanceof HTMLAudioElement ? a.removeEventListener("ended", this._onended) : a && (a.onended = null)
            };
            d._onLoaded = function() {
                this._createElement();
                this._state = a.State.INITIALZING;
                this.setVolume(1);
                this.setLoop(!1)
            };
            d._createElement = function() {
                var a = this._src._nativeAsset;
                a instanceof HTMLAudioElement ? (this._element || (this._element = document.createElement("audio")), this._element.src = a.src) : this._element = new l(a, this)
            };
            d.play = function() {
                var d = this;
                this._src &&
                    this._src._ensureLoaded(function() {
                        d._state = a.State.PLAYING;
                        d._bindEnded();
                        var c = d._element.play();
                        window.Promise && c instanceof Promise && c["catch"](function(a) {});
                        d._touchToPlay()
                    })
            };
            d._touchToPlay = function() {
                this._src && this._src.loadMode === b.DOM_AUDIO && this._element.paused && c.push({
                    instance: this,
                    offset: 0,
                    audio: this._element
                });
                k || (k = !0, cc.game.canvas.addEventListener("ontouchend" in window ? "touchend" : "mousedown", function() {
                    for (var a; a = c.pop();) a.audio.play(a.offset)
                }))
            };
            d.destroy = function() {
                this._element =
                    null
            };
            d.pause = function() {
                if (this.getState() === a.State.PLAYING) {
                    var d = this;
                    this._src && this._src._ensureLoaded(function() {
                        d._unbindEnded();
                        d._element.pause();
                        d._state = a.State.PAUSED
                    })
                }
            };
            d.resume = function() {
                if (this.getState() === a.State.PAUSED) {
                    var d = this;
                    this._src && this._src._ensureLoaded(function() {
                        d._bindEnded();
                        d._element.play();
                        d._state = a.State.PLAYING
                    })
                }
            };
            d.stop = function() {
                var d = this;
                this._src && this._src._ensureLoaded(function() {
                    d._element.pause();
                    for (var b = d._element.currentTime = 0; b < c.length; b++)
                        if (c[b].instance ===
                            d) {
                            c.splice(b, 1);
                            break
                        }
                    d._unbindEnded();
                    d.emit("stop");
                    d._state = a.State.STOPPED
                })
            };
            d.setLoop = function(a) {
                var d = this;
                this._src && this._src._ensureLoaded(function() {
                    d._element.loop = a
                })
            };
            d.getLoop = function() {
                return !!this._element && this._element.loop
            };
            d.setVolume = function(a) {
                var d = this;
                this._src && this._src._ensureLoaded(function() {
                    d._element.volume = a
                })
            };
            d.getVolume = function() {
                return this._element ? this._element.volume : 1
            };
            d.setCurrentTime = function(a) {
                var d = this;
                this._src && this._src._ensureLoaded(function() {
                    d._unbindEnded();
                    d._bindEnded(function() {
                        d._bindEnded()
                    });
                    d._element.currentTime = a
                })
            };
            d.getCurrentTime = function() {
                return this._element ? this._element.currentTime : 0
            };
            d.getDuration = function() {
                return this._src ? this._src.duration : 0
            };
            d.getState = function(a) {
                void 0 === a && (a = !0);
                a && this._forceUpdatingState();
                return this._state
            };
            d._forceUpdatingState = function() {
                var d = this._element;
                d && (a.State.PLAYING === this._state && d.paused ? this._state = a.State.STOPPED : a.State.STOPPED !== this._state || d.paused || (this._state = a.State.PLAYING))
            };
            Object.defineProperty(d, "src", {
                get: function() {
                    return this._src
                },
                set: function(d) {
                    this._unbindEnded();
                    if (d) {
                        if (d !== this._src)
                            if (this._src = d, d.loaded) this._onLoaded();
                            else {
                                var c = this;
                                d.once("load", function() {
                                    d === c._src && c._onLoaded()
                                })
                            }
                    } else this._src = null, this._element instanceof l ? this._element = null : this._element && (this._element.src = ""), this._state = a.State.INITIALZING;
                    return d
                },
                enumerable: !0,
                configurable: !0
            });
            Object.defineProperty(d, "paused", {
                get: function() {
                    return !this._element || this._element.paused
                },
                enumerable: !0,
                configurable: !0
            })
        })(a.prototype);
        var d = cc.sys.browserType === cc.sys.BROWSER_TYPE_EDGE || cc.sys.browserType === cc.sys.BROWSER_TYPE_BAIDU || cc.sys.browserType === cc.sys.BROWSER_TYPE_UC ? .01 : 0;
        var l = function(a, d) {
            this._audio = d;
            this._context = e.__audioSupport.context;
            this._buffer = a;
            this._gainObj = this._context.createGain();
            this.volume = 1;
            this._gainObj.connect(this._context.destination);
            this._loop = !1;
            this._startTime = -1;
            this._currentSource = null;
            this.playedLength = 0;
            this._currentTimer = null;
            this._endCallback =
                function() {
                    this.onended && this.onended(this)
                }.bind(this)
        };
        (function(a) {
            a.play = function(a) {
                this._currentSource && !this.paused && (this._currentSource.onended = null, this._currentSource.stop(0), this.playedLength = 0);
                var d = this._context.createBufferSource();
                d.buffer = this._buffer;
                d.connect(this._gainObj);
                d.loop = this._loop;
                this._startTime = this._context.currentTime;
                (a = a || this.playedLength) && (this._startTime -= a);
                var b = this._buffer.duration,
                    l = a;
                this._loop ? d.start ? d.start(0, l) : d.notoGrainOn ? d.noteGrainOn(0, l) : d.noteOn(0,
                    l) : (b -= a, d.start ? d.start(0, l, b) : d.noteGrainOn ? d.noteGrainOn(0, l, b) : d.noteOn(0, l, b));
                this._currentSource = d;
                d.onended = this._endCallback;
                if ((!d.context.state || "suspended" === d.context.state) && 0 === this._context.currentTime) {
                    var n = this;
                    clearTimeout(this._currentTimer);
                    this._currentTimer = setTimeout(function() {
                        0 === n._context.currentTime && c.push({
                            instance: n._audio,
                            offset: a,
                            audio: n
                        })
                    }, 10)
                }
                l = cc.sys;
                l.os === l.OS_IOS && l.isBrowser && l.isMobile && ("suspended" === d.context.state && 0 !== this._context.currentTime || "interrupted" ===
                    d.context.state) && d.context.resume()
            };
            a.pause = function() {
                clearTimeout(this._currentTimer);
                if (!this.paused) {
                    this.playedLength = this._context.currentTime - this._startTime;
                    this.playedLength %= this._buffer.duration;
                    var a = this._currentSource;
                    this._currentSource = null;
                    this._startTime = -1;
                    a && a.stop(0)
                }
            };
            Object.defineProperty(a, "paused", {
                get: function() {
                    return this._currentSource && this._currentSource.loop ? !1 : -1 === this._startTime ? !0 : this._context.currentTime - this._startTime > this._buffer.duration
                },
                enumerable: !0,
                configurable: !0
            });
            Object.defineProperty(a, "loop", {
                get: function() {
                    return this._loop
                },
                set: function(a) {
                    this._currentSource && (this._currentSource.loop = a);
                    return this._loop = a
                },
                enumerable: !0,
                configurable: !0
            });
            Object.defineProperty(a, "volume", {
                get: function() {
                    return this._volume
                },
                set: function(a) {
                    this._volume = a;
                    if (this._gainObj.gain.setTargetAtTime) try {
                        this._gainObj.gain.setTargetAtTime(a, this._context.currentTime, d)
                    } catch (t) {
                        this._gainObj.gain.setTargetAtTime(a, this._context.currentTime, 0)
                    } else this._gainObj.gain.value =
                        a;
                    e.os === e.OS_IOS && !this.paused && this._currentSource && (this._currentSource.onended = null, this.pause(), this.play())
                },
                enumerable: !0,
                configurable: !0
            });
            Object.defineProperty(a, "currentTime", {
                get: function() {
                    if (this.paused) return this.playedLength;
                    this.playedLength = this._context.currentTime - this._startTime;
                    return this.playedLength %= this._buffer.duration
                },
                set: function(a) {
                    this.paused ? this.playedLength = a : (this.pause(), this.playedLength = a, this.play());
                    return a
                },
                enumerable: !0,
                configurable: !0
            });
            Object.defineProperty(a,
                "duration", {
                    get: function() {
                        return this._buffer.duration
                    },
                    enumerable: !0,
                    configurable: !0
                })
        })(l.prototype);
        q.exports = cc._Audio = a
    }, {
        "../core/assets/CCAudioClip": 74,
        "../core/event/event-target": 151,
        "../core/platform/CCSys": 213
    }],
    22: [function(h, q, m) {
        var f = h("./CCAudio"),
            e = h("../core/assets/CCAudioClip"),
            b = cc.js,
            k = 0,
            c = b.createMap(!0),
            a = {},
            d = [],
            l = function(b) {
                var l = k++,
                    g = a[b];
                g || (g = a[b] = []);
                n._maxAudioInstance <= g.length && (b = g.shift(), c[b].stop());
                b = d.pop() || new f;
                var u = function() {
                    if (c[this.id]) {
                        delete c[this.id];
                        var a = g.indexOf(this.id);
                        cc.js.array.fastRemoveAt(g, a)
                    }
                    this._shouldRecycleOnEnded && (this._finishCallback = null, this.off("ended"), this.off("stop"), this.src = null, d.includes(this) || (32 > d.length ? d.push(this) : this.destroy()), this._shouldRecycleOnEnded = !1)
                };
                b.on("ended", function() {
                    this._finishCallback && this._finishCallback();
                    this.getLoop() || u.call(this)
                }, b);
                b.on("stop", u, b);
                b.id = l;
                c[l] = b;
                g.push(l);
                return b
            },
            g = function(a) {
                void 0 === a ? a = 1 : "string" === typeof a && (a = Number.parseFloat(a));
                return a
            },
            n = {
                AudioState: f.State,
                _maxAudioInstance: 24,
                _id2audio: c,
                play: function(a, d, c) {
                    if (!(a instanceof e)) return cc.error("Wrong type of AudioClip.");
                    var b = l(a.nativeUrl);
                    b.src = a;
                    a._ensureLoaded();
                    b._shouldRecycleOnEnded = !0;
                    b.setLoop(d || !1);
                    c = g(c);
                    b.setVolume(c);
                    b.play();
                    return b.id
                },
                setLoop: function(a, d) {
                    (a = c[a]) && a.setLoop && a.setLoop(d)
                },
                isLoop: function(a) {
                    return (a = c[a]) && a.getLoop ? a.getLoop() : !1
                },
                setVolume: function(a, d) {
                    (a = c[a]) && a.setVolume(d)
                },
                getVolume: function(a) {
                    return (a = c[a]) ? a.getVolume() : 1
                },
                setCurrentTime: function(a,
                    d) {
                    return (a = c[a]) ? (a.setCurrentTime(d), !0) : !1
                },
                getCurrentTime: function(a) {
                    return (a = c[a]) ? a.getCurrentTime() : 0
                },
                getDuration: function(a) {
                    return (a = c[a]) ? a.getDuration() : 0
                },
                getState: function(a) {
                    return (a = c[a]) ? a.getState() : this.AudioState.ERROR
                },
                setFinishCallback: function(a, d) {
                    if (a = c[a]) a._finishCallback = d
                },
                pause: function(a) {
                    return (a = c[a]) ? (a.pause(), !0) : !1
                },
                _pauseIDCache: [],
                pauseAll: function() {
                    for (var a in c) {
                        var d = c[a];
                        d.getState() === f.State.PLAYING && (this._pauseIDCache.push(a), d.pause())
                    }
                },
                resume: function(a) {
                    (a =
                        c[a]) && a.resume()
                },
                resumeAll: function() {
                    for (var a = 0; a < this._pauseIDCache.length; ++a) {
                        var d = c[this._pauseIDCache[a]];
                        d && d.resume()
                    }
                    this._pauseIDCache.length = 0
                },
                stop: function(a) {
                    return (a = c[a]) ? (a.stop(), !0) : !1
                },
                stopAll: function() {
                    for (var a in c) {
                        var d = c[a];
                        d && d.stop()
                    }
                },
                setMaxAudioInstance: function(a) {
                    !0;
                    cc.warn("Since v2.4.0, maxAudioInstance has become a read only property.\naudioEngine.setMaxAudioInstance() method will be removed in the future")
                },
                getMaxAudioInstance: function() {
                    return this._maxAudioInstance
                },
                uncache: function(d) {
                    if ("string" === typeof d) cc.warnID(8401, "cc.audioEngine", "cc.AudioClip", "AudioClip", "cc.AudioClip", "audio");
                    else {
                        if (!d) return;
                        d = d.nativeUrl
                    }
                    if (d = a[d])
                        for (; 0 < d.length;) {
                            var b = d.pop(),
                                l = c[b];
                            l && (l.stop(), delete c[b])
                        }
                },
                uncacheAll: function() {
                    this.stopAll();
                    var l, g;
                    for (g in c)(l = c[g]) && l.destroy();
                    for (; l = d.pop();) l.destroy();
                    c = b.createMap(!0);
                    a = {}
                },
                _breakCache: null,
                _break: function() {
                    this._breakCache = [];
                    for (var a in c) {
                        var d = c[a];
                        d.getState() === f.State.PLAYING && (this._breakCache.push(a),
                            d.pause())
                    }
                },
                _restore: function() {
                    if (this._breakCache) {
                        for (; 0 < this._breakCache.length;) {
                            var a = this._breakCache.pop();
                            (a = c[a]) && a.resume && a.resume()
                        }
                        this._breakCache = null
                    }
                },
                _music: {
                    id: -1,
                    loop: !1,
                    volume: 1
                },
                _effect: {
                    volume: 1,
                    pauseCache: []
                },
                playMusic: function(a, d) {
                    var c = this._music;
                    this.stop(c.id);
                    c.id = this.play(a, d, c.volume);
                    c.loop = d;
                    return c.id
                },
                stopMusic: function() {
                    this.stop(this._music.id)
                },
                pauseMusic: function() {
                    this.pause(this._music.id);
                    return this._music.id
                },
                resumeMusic: function() {
                    this.resume(this._music.id);
                    return this._music.id
                },
                getMusicVolume: function() {
                    return this._music.volume
                },
                setMusicVolume: function(a) {
                    a = g(a);
                    var d = this._music;
                    d.volume = a;
                    this.setVolume(d.id, d.volume);
                    return d.volume
                },
                isMusicPlaying: function() {
                    return this.getState(this._music.id) === this.AudioState.PLAYING
                },
                playEffect: function(a, d) {
                    return this.play(a, d || !1, this._effect.volume)
                },
                setEffectsVolume: function(a) {
                    a = g(a);
                    var d = this._music.id;
                    this._effect.volume = a;
                    for (var b in c) {
                        var l = c[b];
                        l && l.id !== d && n.setVolume(b, a)
                    }
                },
                getEffectsVolume: function() {
                    return this._effect.volume
                },
                pauseEffect: function(a) {
                    return this.pause(a)
                },
                pauseAllEffects: function() {
                    var a = this._music.id,
                        d = this._effect;
                    d.pauseCache.length = 0;
                    for (var b in c) {
                        var l = c[b];
                        l && l.id !== a && l.getState() === this.AudioState.PLAYING && (d.pauseCache.push(b), l.pause())
                    }
                },
                resumeEffect: function(a) {
                    this.resume(a)
                },
                resumeAllEffects: function() {
                    for (var a = this._effect.pauseCache, d = 0; d < a.length; ++d) {
                        var b = c[a[d]];
                        b && b.resume()
                    }
                },
                stopEffect: function(a) {
                    return this.stop(a)
                },
                stopAllEffects: function() {
                    var a = this._music.id,
                        d;
                    for (d in c) {
                        var b =
                            c[d];
                        b && b.id !== a && b.getState() === n.AudioState.PLAYING && b.stop()
                    }
                }
            };
        q.exports = cc.audioEngine = n
    }, {
        "../core/assets/CCAudioClip": 74,
        "./CCAudio": 21
    }],
    23: [function(h, q, m) {
        var f = {
            name: "Jacob__Codec"
        };
        f.Base64 = h("./base64");
        f.GZip = h("./gzip");
        f.unzip = function() {
            return f.GZip.gunzip.apply(f.GZip, arguments)
        };
        f.unzipBase64 = function() {
            var e = f.Base64.decode.apply(f.Base64, arguments);
            try {
                return f.GZip.gunzip.call(f.GZip, e)
            } catch (b) {
                return e.slice(7)
            }
        };
        f.unzipBase64AsArray = function(e, b) {
            b = b || 1;
            e = this.unzipBase64(e);
            var k = [],
                c, a;
            var d = 0;
            for (a = e.length / b; d < a; d++)
                for (k[d] = 0, c = b - 1; 0 <= c; --c) k[d] += e.charCodeAt(d * b + c) << 8 * c;
            return k
        };
        f.unzipAsArray = function(e, b) {
            b = b || 1;
            e = this.unzip(e);
            var k = [],
                c, a;
            var d = 0;
            for (a = e.length / b; d < a; d++)
                for (k[d] = 0, c = b - 1; 0 <= c; --c) k[d] += e.charCodeAt(d * b + c) << 8 * c;
            return k
        };
        cc.codec = q.exports = f
    }, {
        "./base64": 24,
        "./gzip": 25
    }],
    24: [function(h, q, m) {
        var f = h("../core/utils/misc").BASE64_VALUES;
        q.exports = {
            name: "Jacob__Codec__Base64",
            decode: function(e) {
                var b = [],
                    k = 0;
                for (e = e.replace(/[^A-Za-z0-9\+\/\=]/g,
                        ""); k < e.length;) {
                    var c = f[e.charCodeAt(k++)];
                    var a = f[e.charCodeAt(k++)];
                    var d = f[e.charCodeAt(k++)];
                    var l = f[e.charCodeAt(k++)];
                    c = c << 2 | a >> 4;
                    a = (15 & a) << 4 | d >> 2;
                    var g = (3 & d) << 6 | l;
                    b.push(String.fromCharCode(c));
                    64 !== d && b.push(String.fromCharCode(a));
                    64 !== l && b.push(String.fromCharCode(g))
                }
                return b = b.join("")
            },
            decodeAsArray: function(e, b) {
                e = this.decode(e);
                var k = [],
                    c, a;
                var d = 0;
                for (a = e.length / b; d < a; d++)
                    for (k[d] = 0, c = b - 1; 0 <= c; --c) k[d] += e.charCodeAt(d * b + c) << 8 * c;
                return k
            }
        }
    }, {
        "../core/utils/misc": 286
    }],
    25: [function(h,
        q, m) {
        var f = function(e) {
            this.data = e;
            this.debug = !1;
            this.gpflags = void 0;
            this.files = 0;
            this.unzipped = [];
            this.buf32k = Array(32768);
            this.bIdx = 0;
            this.modeZIP = !1;
            this.bytepos = 0;
            this.bb = 1;
            this.bits = 0;
            this.nameBuf = [];
            this.fileout = void 0;
            this.literalTree = Array(f.LITERALS);
            this.distanceTree = Array(32);
            this.treepos = 0;
            this.Places = null;
            this.len = 0;
            this.fpos = Array(17);
            this.fpos[0] = 0;
            this.fmax = this.flens = void 0
        };
        f.gunzip = function(e) {
            e.constructor === Array || e.constructor === String;
            return (new f(e)).gunzip()[0][0]
        };
        f.HufNode =
            function() {
                this.b1 = this.b0 = 0;
                this.jump = null;
                this.jumppos = -1
            };
        f.LITERALS = 288;
        f.NAMEMAX = 256;
        f.bitReverse = [0, 128, 64, 192, 32, 160, 96, 224, 16, 144, 80, 208, 48, 176, 112, 240, 8, 136, 72, 200, 40, 168, 104, 232, 24, 152, 88, 216, 56, 184, 120, 248, 4, 132, 68, 196, 36, 164, 100, 228, 20, 148, 84, 212, 52, 180, 116, 244, 12, 140, 76, 204, 44, 172, 108, 236, 28, 156, 92, 220, 60, 188, 124, 252, 2, 130, 66, 194, 34, 162, 98, 226, 18, 146, 82, 210, 50, 178, 114, 242, 10, 138, 74, 202, 42, 170, 106, 234, 26, 154, 90, 218, 58, 186, 122, 250, 6, 134, 70, 198, 38, 166, 102, 230, 22, 150, 86, 214, 54, 182, 118, 246,
            14, 142, 78, 206, 46, 174, 110, 238, 30, 158, 94, 222, 62, 190, 126, 254, 1, 129, 65, 193, 33, 161, 97, 225, 17, 145, 81, 209, 49, 177, 113, 241, 9, 137, 73, 201, 41, 169, 105, 233, 25, 153, 89, 217, 57, 185, 121, 249, 5, 133, 69, 197, 37, 165, 101, 229, 21, 149, 85, 213, 53, 181, 117, 245, 13, 141, 77, 205, 45, 173, 109, 237, 29, 157, 93, 221, 61, 189, 125, 253, 3, 131, 67, 195, 35, 163, 99, 227, 19, 147, 83, 211, 51, 179, 115, 243, 11, 139, 75, 203, 43, 171, 107, 235, 27, 155, 91, 219, 59, 187, 123, 251, 7, 135, 71, 199, 39, 167, 103, 231, 23, 151, 87, 215, 55, 183, 119, 247, 15, 143, 79, 207, 47, 175, 111, 239, 31, 159, 95, 223, 63,
            191, 127, 255
        ];
        f.cplens = [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0];
        f.cplext = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, 99, 99];
        f.cpdist = [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577];
        f.cpdext = [0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13];
        f.border = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];
        f.prototype.gunzip = function() {
            this.outputArr = [];
            this.nextFile();
            return this.unzipped
        };
        f.prototype.readByte = function() {
            this.bits += 8;
            return this.bytepos < this.data.length ? this.data.charCodeAt(this.bytepos++) : -1
        };
        f.prototype.byteAlign = function() {
            this.bb = 1
        };
        f.prototype.readBit = function() {
            this.bits++;
            var e = 1 & this.bb;
            this.bb >>= 1;
            0 === this.bb && (this.bb = this.readByte(), e = 1 & this.bb, this.bb = this.bb >> 1 | 128);
            return e
        };
        f.prototype.readBits = function(e) {
            for (var b = 0, k = e; k--;) b = b << 1 | this.readBit();
            e && (b = f.bitReverse[b] >> 8 - e);
            return b
        };
        f.prototype.flushBuffer = function() {
            this.bIdx =
                0
        };
        f.prototype.addBuffer = function(e) {
            this.buf32k[this.bIdx++] = e;
            this.outputArr.push(String.fromCharCode(e));
            32768 === this.bIdx && (this.bIdx = 0)
        };
        f.prototype.IsPat = function() {
            for (;;) {
                if (this.fpos[this.len] >= this.fmax) return -1;
                if (this.flens[this.fpos[this.len]] === this.len) return this.fpos[this.len]++;
                this.fpos[this.len]++
            }
        };
        f.prototype.Rec = function() {
            var e = this.Places[this.treepos];
            if (17 === this.len) return -1;
            this.treepos++;
            this.len++;
            var b = this.IsPat();
            if (0 <= b) e.b0 = b;
            else if (e.b0 = 32768, this.Rec()) return -1;
            b = this.IsPat();
            if (0 <= b) e.b1 = b, e.jump = null;
            else if (e.b1 = 32768, e.jump = this.Places[this.treepos], e.jumppos = this.treepos, this.Rec()) return -1;
            this.len--;
            return 0
        };
        f.prototype.CreateTree = function(e, b, k, c) {
            this.Places = e;
            this.treepos = 0;
            this.flens = k;
            this.fmax = b;
            for (e = 0; 17 > e; e++) this.fpos[e] = 0;
            this.len = 0;
            return this.Rec() ? -1 : 0
        };
        f.prototype.DecodeValue = function(e) {
            for (var b, k, c = 0, a = e[c];;)
                if (b = this.readBit()) {
                    if (!(32768 & a.b1)) return a.b1;
                    a = a.jump;
                    b = e.length;
                    for (k = 0; k < b; k++)
                        if (e[k] === a) {
                            c = k;
                            break
                        }
                } else {
                    if (!(32768 &
                            a.b0)) return a.b0;
                    c++;
                    a = e[c]
                }
        };
        f.prototype.DeflateLoop = function() {
            do {
                var e = this.readBit();
                var b = this.readBits(2);
                if (0 === b) {
                    this.byteAlign();
                    b = this.readByte();
                    b |= this.readByte() << 8;
                    var k = this.readByte();
                    k |= this.readByte() << 8;
                    for (65535 & (b ^ ~k) && document.write("BlockLen checksum mismatch\n"); b--;) k = this.readByte(), this.addBuffer(k)
                } else if (1 === b)
                    for (;;)
                        if (b = f.bitReverse[this.readBits(7)] >> 1, 23 < b ? (b = b << 1 | this.readBit(), 199 < b ? (b -= 128, b = b << 1 | this.readBit()) : (b -= 48, 143 < b && (b += 136))) : b += 256, 256 > b) this.addBuffer(b);
                        else {
                            if (256 === b) break;
                            b -= 257;
                            var c = this.readBits(f.cplext[b]) + f.cplens[b];
                            b = f.bitReverse[this.readBits(5)] >> 3;
                            if (8 < f.cpdext[b]) {
                                var a = this.readBits(8);
                                a |= this.readBits(f.cpdext[b] - 8) << 8
                            } else a = this.readBits(f.cpdext[b]);
                            a += f.cpdist[b];
                            for (b = 0; b < c; b++) k = this.buf32k[this.bIdx - a & 32767], this.addBuffer(k)
                        }
                else if (2 === b) {
                    var d = Array(320);
                    k = 257 + this.readBits(5);
                    a = 1 + this.readBits(5);
                    var l = 4 + this.readBits(4);
                    for (b = 0; 19 > b; b++) d[b] = 0;
                    for (b = 0; b < l; b++) d[f.border[b]] = this.readBits(3);
                    c = this.distanceTree.length;
                    for (l = 0; l < c; l++) this.distanceTree[l] = new f.HufNode;
                    if (this.CreateTree(this.distanceTree, 19, d, 0)) return this.flushBuffer(), 1;
                    c = k + a;
                    l = 0;
                    for (var g = -1; l < c;)
                        if (g++, b = this.DecodeValue(this.distanceTree), 16 > b) d[l++] = b;
                        else if (16 === b) {
                        var n;
                        b = 3 + this.readBits(2);
                        if (l + b > c) return this.flushBuffer(), 1;
                        for (n = l ? d[l - 1] : 0; b--;) d[l++] = n
                    } else {
                        b = 17 === b ? 3 + this.readBits(3) : 11 + this.readBits(7);
                        if (l + b > c) return this.flushBuffer(), 1;
                        for (; b--;) d[l++] = 0
                    }
                    c = this.literalTree.length;
                    for (l = 0; l < c; l++) this.literalTree[l] = new f.HufNode;
                    if (this.CreateTree(this.literalTree, k, d, 0)) return this.flushBuffer(), 1;
                    c = this.literalTree.length;
                    for (l = 0; l < c; l++) this.distanceTree[l] = new f.HufNode;
                    b = [];
                    for (l = k; l < d.length; l++) b[l - k] = d[l];
                    if (this.CreateTree(this.distanceTree, a, b, 0)) return this.flushBuffer(), 1;
                    for (;;)
                        if (b = this.DecodeValue(this.literalTree), 256 <= b) {
                            b -= 256;
                            if (0 === b) break;
                            b--;
                            c = this.readBits(f.cplext[b]) + f.cplens[b];
                            b = this.DecodeValue(this.distanceTree);
                            8 < f.cpdext[b] ? (a = this.readBits(8), a |= this.readBits(f.cpdext[b] - 8) << 8) : a = this.readBits(f.cpdext[b]);
                            for (a += f.cpdist[b]; c--;) k = this.buf32k[this.bIdx - a & 32767], this.addBuffer(k)
                        } else this.addBuffer(b)
                }
            } while (!e);
            this.flushBuffer();
            this.byteAlign();
            return 0
        };
        f.prototype.unzipFile = function(e) {
            var b;
            this.gunzip();
            for (b = 0; b < this.unzipped.length; b++)
                if (this.unzipped[b][1] === e) return this.unzipped[b][0]
        };
        f.prototype.nextFile = function() {
            this.outputArr = [];
            this.modeZIP = !1;
            var e = [];
            e[0] = this.readByte();
            e[1] = this.readByte();
            120 === e[0] && 218 === e[1] && (this.DeflateLoop(), this.unzipped[this.files] = [this.outputArr.join(""),
                "geonext.gxt"
            ], this.files++);
            31 === e[0] && 139 === e[1] && (this.skipdir(), this.unzipped[this.files] = [this.outputArr.join(""), "file"], this.files++);
            if (80 === e[0] && 75 === e[1] && (this.modeZIP = !0, e[2] = this.readByte(), e[3] = this.readByte(), 3 === e[2] && 4 === e[3])) {
                e[0] = this.readByte();
                e[1] = this.readByte();
                this.gpflags = this.readByte();
                this.gpflags |= this.readByte() << 8;
                var b = this.readByte();
                b |= this.readByte() << 8;
                this.readByte();
                this.readByte();
                this.readByte();
                this.readByte();
                this.readByte();
                this.readByte();
                this.readByte();
                this.readByte();
                this.readByte();
                this.readByte();
                this.readByte();
                this.readByte();
                var k = this.readByte();
                k |= this.readByte() << 8;
                var c = this.readByte();
                c |= this.readByte() << 8;
                a = 0;
                for (this.nameBuf = []; k--;) e = this.readByte(), "/" === e | ":" === e ? a = 0 : a < f.NAMEMAX - 1 && (this.nameBuf[a++] = String.fromCharCode(e));
                this.fileout || (this.fileout = this.nameBuf);
                for (var a = 0; a < c;) this.readByte(), a++;
                8 === b && (this.DeflateLoop(), this.unzipped[this.files] = [this.outputArr.join(""), this.nameBuf.join("")], this.files++);
                this.skipdir()
            }
        };
        f.prototype.skipdir = function() {
            var e = [],
                b;
            8 & this.gpflags && (e[0] = this.readByte(), e[1] = this.readByte(), e[2] = this.readByte(), e[3] = this.readByte(), this.readByte(), this.readByte(), this.readByte(), this.readByte(), this.readByte(), this.readByte(), this.readByte(), this.readByte());
            this.modeZIP && this.nextFile();
            e[0] = this.readByte();
            if (8 !== e[0]) return 0;
            this.gpflags = this.readByte();
            this.readByte();
            this.readByte();
            this.readByte();
            this.readByte();
            this.readByte();
            this.readByte();
            if (4 & this.gpflags)
                for (e[0] = this.readByte(),
                    e[2] = this.readByte(), this.len = e[0] + 256 * e[1], e = 0; e < this.len; e++) this.readByte();
            if (8 & this.gpflags)
                for (e = 0, this.nameBuf = []; b = this.readByte();) "7" !== b && ":" !== b || (e = 0), e < f.NAMEMAX - 1 && (this.nameBuf[e++] = b);
            if (16 & this.gpflags)
                for (; this.readByte(););
            2 & this.gpflags && (this.readByte(), this.readByte());
            this.DeflateLoop();
            this.readByte();
            this.readByte();
            this.readByte();
            this.readByte();
            this.modeZIP && this.nextFile()
        };
        q.exports = f
    }, {}],
    26: [function(h, q, m) {
        (function() {
            function f(a) {
                throw a;
            }

            function e(a, d) {
                a = a.split(".");
                var c = y;
                a[0] in c || !c.execScript || c.execScript("var " + a[0]);
                for (var b; a.length && (b = a.shift());) a.length || void 0 === d ? c = c[b] ? c[b] : c[b] = {} : c[b] = d
            }

            function b(a) {
                if ("string" === typeof a) {
                    a = a.split("");
                    var d;
                    var c = 0;
                    for (d = a.length; c < d; c++) a[c] = (255 & a[c].charCodeAt(0)) >>> 0
                }
                c = 1;
                d = 0;
                for (var b = a.length, l, g = 0; 0 < b;) {
                    l = 1024 < b ? 1024 : b;
                    b -= l;
                    do c += a[g++], d += c; while (--l);
                    c %= 65521;
                    d %= 65521
                }
                return (d << 16 | c) >>> 0
            }

            function k(a, d) {
                this.index = "number" === typeof d ? d : 0;
                this.i = 0;
                this.buffer = a instanceof(z ? Uint8Array : Array) ? a : new(z ?
                    Uint8Array : Array)(32768);
                2 * this.buffer.length <= this.index && f(Error("invalid index"));
                this.buffer.length <= this.index && this.f()
            }

            function c(a) {
                this.buffer = new(z ? Uint16Array : Array)(2 * a);
                this.length = 0
            }

            function a(a) {
                var d = a.length,
                    c = 0,
                    b = Number.POSITIVE_INFINITY,
                    l, g, n;
                for (g = 0; g < d; ++g) a[g] > c && (c = a[g]), a[g] < b && (b = a[g]);
                var p = 1 << c;
                var k = new(z ? Uint32Array : Array)(p);
                var t = 1;
                var u = 0;
                for (l = 2; t <= c;) {
                    for (g = 0; g < d; ++g)
                        if (a[g] === t) {
                            var e = 0;
                            var w = u;
                            for (n = 0; n < t; ++n) e = e << 1 | 1 & w, w >>= 1;
                            for (n = e; n < p; n += l) k[n] = t << 16 | g;
                            ++u
                        }++t;
                    u <<= 1;
                    l <<= 1
                }
                return [k, c, b]
            }

            function d(a, d) {
                this.h = K;
                this.w = 0;
                this.input = a;
                this.b = 0;
                d && (d.lazy && (this.w = d.lazy), "number" === typeof d.compressionType && (this.h = d.compressionType), d.outputBuffer && (this.a = z && d.outputBuffer instanceof Array ? new Uint8Array(d.outputBuffer) : d.outputBuffer), "number" === typeof d.outputIndex && (this.b = d.outputIndex));
                this.a || (this.a = new(z ? Uint8Array : Array)(32768))
            }

            function l(a, d) {
                this.length = a;
                this.G = d
            }

            function g() {
                var a = S;
                switch (!0) {
                    case 3 === a:
                        return [257, a - 3, 0];
                    case 4 === a:
                        return [258,
                            a - 4, 0
                        ];
                    case 5 === a:
                        return [259, a - 5, 0];
                    case 6 === a:
                        return [260, a - 6, 0];
                    case 7 === a:
                        return [261, a - 7, 0];
                    case 8 === a:
                        return [262, a - 8, 0];
                    case 9 === a:
                        return [263, a - 9, 0];
                    case 10 === a:
                        return [264, a - 10, 0];
                    case 12 >= a:
                        return [265, a - 11, 1];
                    case 14 >= a:
                        return [266, a - 13, 1];
                    case 16 >= a:
                        return [267, a - 15, 1];
                    case 18 >= a:
                        return [268, a - 17, 1];
                    case 22 >= a:
                        return [269, a - 19, 2];
                    case 26 >= a:
                        return [270, a - 23, 2];
                    case 30 >= a:
                        return [271, a - 27, 2];
                    case 34 >= a:
                        return [272, a - 31, 2];
                    case 42 >= a:
                        return [273, a - 35, 3];
                    case 50 >= a:
                        return [274, a - 43, 3];
                    case 58 >= a:
                        return [275,
                            a - 51, 3
                        ];
                    case 66 >= a:
                        return [276, a - 59, 3];
                    case 82 >= a:
                        return [277, a - 67, 4];
                    case 98 >= a:
                        return [278, a - 83, 4];
                    case 114 >= a:
                        return [279, a - 99, 4];
                    case 130 >= a:
                        return [280, a - 115, 4];
                    case 162 >= a:
                        return [281, a - 131, 5];
                    case 194 >= a:
                        return [282, a - 163, 5];
                    case 226 >= a:
                        return [283, a - 195, 5];
                    case 257 >= a:
                        return [284, a - 227, 5];
                    case 258 === a:
                        return [285, a - 258, 0];
                    default:
                        f("invalid length: " + a)
                }
            }

            function n(a, d) {
                function c(a, d) {
                    var c = a.G,
                        b = [],
                        l = 0;
                    var g = M[a.length];
                    b[l++] = 65535 & g;
                    b[l++] = g >> 16 & 255;
                    b[l++] = g >> 24;
                    switch (!0) {
                        case 1 === c:
                            var n = [0, c -
                                1, 0
                            ];
                            break;
                        case 2 === c:
                            n = [1, c - 2, 0];
                            break;
                        case 3 === c:
                            n = [2, c - 3, 0];
                            break;
                        case 4 === c:
                            n = [3, c - 4, 0];
                            break;
                        case 6 >= c:
                            n = [4, c - 5, 1];
                            break;
                        case 8 >= c:
                            n = [5, c - 7, 1];
                            break;
                        case 12 >= c:
                            n = [6, c - 9, 2];
                            break;
                        case 16 >= c:
                            n = [7, c - 13, 2];
                            break;
                        case 24 >= c:
                            n = [8, c - 17, 3];
                            break;
                        case 32 >= c:
                            n = [9, c - 25, 3];
                            break;
                        case 48 >= c:
                            n = [10, c - 33, 4];
                            break;
                        case 64 >= c:
                            n = [11, c - 49, 4];
                            break;
                        case 96 >= c:
                            n = [12, c - 65, 5];
                            break;
                        case 128 >= c:
                            n = [13, c - 97, 5];
                            break;
                        case 192 >= c:
                            n = [14, c - 129, 6];
                            break;
                        case 256 >= c:
                            n = [15, c - 193, 6];
                            break;
                        case 384 >= c:
                            n = [16, c - 257, 7];
                            break;
                        case 512 >=
                        c:
                            n = [17, c - 385, 7];
                            break;
                        case 768 >= c:
                            n = [18, c - 513, 8];
                            break;
                        case 1024 >= c:
                            n = [19, c - 769, 8];
                            break;
                        case 1536 >= c:
                            n = [20, c - 1025, 9];
                            break;
                        case 2048 >= c:
                            n = [21, c - 1537, 9];
                            break;
                        case 3072 >= c:
                            n = [22, c - 2049, 10];
                            break;
                        case 4096 >= c:
                            n = [23, c - 3073, 10];
                            break;
                        case 6144 >= c:
                            n = [24, c - 4097, 11];
                            break;
                        case 8192 >= c:
                            n = [25, c - 6145, 11];
                            break;
                        case 12288 >= c:
                            n = [26, c - 8193, 12];
                            break;
                        case 16384 >= c:
                            n = [27, c - 12289, 12];
                            break;
                        case 24576 >= c:
                            n = [28, c - 16385, 13];
                            break;
                        case 32768 >= c:
                            n = [29, c - 24577, 13];
                            break;
                        default:
                            f("invalid distance")
                    }
                    g = n;
                    b[l++] = g[0];
                    b[l++] = g[1];
                    b[l++] = g[2];
                    c = 0;
                    for (l = b.length; c < l; ++c) u[e++] = b[c];
                    v[b[0]]++;
                    h[b[3]]++;
                    w = a.length + d - 1;
                    t = null
                }
                var b, g, n, p, k = {},
                    t, u = z ? new Uint16Array(2 * d.length) : [],
                    e = 0,
                    w = 0,
                    v = new(z ? Uint32Array : Array)(286),
                    h = new(z ? Uint32Array : Array)(30),
                    A = a.w;
                if (!z) {
                    for (g = 0; 285 >= g;) v[g++] = 0;
                    for (g = 0; 29 >= g;) h[g++] = 0
                }
                v[256] = 1;
                var B = 0;
                for (b = d.length; B < b; ++B) {
                    g = p = 0;
                    for (n = 3; g < n && B + g !== b; ++g) p = p << 8 | d[B + g];
                    void 0 === k[p] && (k[p] = []);
                    g = k[p];
                    if (!(0 < w--)) {
                        for (; 0 < g.length && 32768 < B - g[0];) g.shift();
                        if (B + 3 >= b) {
                            t && c(t, -1);
                            g = 0;
                            for (n = b - B; g <
                                n; ++g) {
                                var y = d[B + g];
                                u[e++] = y;
                                ++v[y]
                            }
                            break
                        }
                        if (0 < g.length) {
                            p = n = void 0;
                            var E = 0,
                                x = void 0,
                                C = void 0,
                                m = x = void 0,
                                ca = d.length;
                            C = 0;
                            m = g.length;
                            a: for (; C < m; C++) {
                                n = g[m - C - 1];
                                x = 3;
                                if (3 < E) {
                                    for (x = E; 3 < x; x--)
                                        if (d[n + x - 1] !== d[B + x - 1]) continue a;
                                    x = E
                                }
                                for (; 258 > x && B + x < ca && d[n + x] === d[B + x];) ++x;
                                x > E && (p = n, E = x);
                                if (258 === x) break
                            }
                            n = new l(E, B - p);
                            t ? t.length < n.length ? (y = d[B - 1], u[e++] = y, ++v[y], c(n, 0)) : c(t, -1) : n.length < A ? t = n : c(n, 0)
                        } else t ? c(t, -1) : (y = d[B], u[e++] = y, ++v[y])
                    }
                    g.push(B)
                }
                u[e++] = 256;
                v[256]++;
                a.L = v;
                a.K = h;
                return z ? u.subarray(0,
                    e) : u
            }

            function w(a, d) {
                function b(a) {
                    var d = e[a][w[a]];
                    d === t ? (b(a + 1), b(a + 1)) : --u[d];
                    ++w[a]
                }
                var l = a.length,
                    g = new c(572),
                    n = new(z ? Uint8Array : Array)(l),
                    p, k;
                if (!z)
                    for (p = 0; p < l; p++) n[p] = 0;
                for (p = 0; p < l; ++p) 0 < a[p] && g.push(p, a[p]);
                a = Array(g.length / 2);
                l = new(z ? Uint32Array : Array)(g.length / 2);
                if (1 === a.length) return n[g.pop().index] = 1, n;
                p = 0;
                for (k = g.length / 2; p < k; ++p) a[p] = g.pop(), l[p] = a[p].value;
                var t = l.length;
                p = new(z ? Uint16Array : Array)(d);
                g = new(z ? Uint8Array : Array)(d);
                var u = new(z ? Uint8Array : Array)(t);
                k = Array(d);
                var e = Array(d),
                    w = Array(d),
                    v = (1 << d) - t,
                    f = 1 << d - 1,
                    h;
                p[d - 1] = t;
                for (h = 0; h < d; ++h) v < f ? g[h] = 0 : (g[h] = 1, v -= f), v <<= 1, p[d - 2 - h] = (p[d - 1 - h] / 2 | 0) + t;
                p[0] = g[0];
                k[0] = Array(p[0]);
                e[0] = Array(p[0]);
                for (h = 1; h < d; ++h) p[h] > 2 * p[h - 1] + g[h] && (p[h] = 2 * p[h - 1] + g[h]), k[h] = Array(p[h]), e[h] = Array(p[h]);
                for (v = 0; v < t; ++v) u[v] = d;
                for (f = 0; f < p[d - 1]; ++f) k[d - 1][f] = l[f], e[d - 1][f] = f;
                for (v = 0; v < d; ++v) w[v] = 0;
                1 === g[d - 1] && (--u[0], ++w[d - 1]);
                for (h = d - 2; 0 <= h; --h) {
                    d = v = 0;
                    var B = w[h + 1];
                    for (f = 0; f < p[h]; f++) d = k[h + 1][B] + k[h + 1][B + 1], d > l[v] ? (k[h][f] = d, e[h][f] = t, B +=
                        2) : (k[h][f] = l[v], e[h][f] = v, ++v);
                    w[h] = 0;
                    1 === g[h] && b(h)
                }
                d = u;
                p = 0;
                for (k = a.length; p < k; ++p) n[a[p].index] = d[p];
                return n
            }

            function t(a) {
                var d = new(z ? Uint16Array : Array)(a.length),
                    c = [],
                    b = [],
                    l = 0,
                    g, n;
                var p = 0;
                for (g = a.length; p < g; p++) c[a[p]] = 1 + (0 | c[a[p]]);
                p = 1;
                for (g = 16; p <= g; p++) b[p] = l, l += 0 | c[p], l > 1 << p && f("overcommitted"), l <<= 1;
                65536 > l && f("undercommitted");
                p = 0;
                for (g = a.length; p < g; p++)
                    for (l = b[a[p]], b[a[p]] += 1, c = d[p] = 0, n = a[p]; c < n; c++) d[p] = d[p] << 1 | 1 & l, l >>>= 1;
                return d
            }

            function p(a, c) {
                this.input = a;
                this.a = new(z ? Uint8Array :
                    Array)(32768);
                this.h = O.j;
                a = {};
                var b;
                !c && (c = {}) || "number" !== typeof c.compressionType || (this.h = c.compressionType);
                for (b in c) a[b] = c[b];
                a.outputBuffer = this.a;
                this.z = new d(this.input, a)
            }

            function u(a, d) {
                this.k = [];
                this.l = 32768;
                this.e = this.g = this.c = this.q = 0;
                this.input = z ? new Uint8Array(a) : a;
                this.s = !1;
                this.m = U;
                this.B = !1;
                !d && (d = {}) || (d.index && (this.c = d.index), d.bufferSize && (this.l = d.bufferSize), d.bufferType && (this.m = d.bufferType), d.resize && (this.B = d.resize));
                switch (this.m) {
                    case L:
                        this.b = 32768;
                        this.a = new(z ?
                            Uint8Array : Array)(32768 + this.l + 258);
                        break;
                    case U:
                        this.b = 0;
                        this.a = new(z ? Uint8Array : Array)(this.l);
                        this.f = this.J;
                        this.t = this.H;
                        this.o = this.I;
                        break;
                    default:
                        f(Error("invalid inflate mode"))
                }
            }

            function v(a, d) {
                for (var c = a.g, b = a.e, l = a.input, g = a.c, n; b < d;) n = l[g++], void 0 === n && f(Error("input buffer is broken")), c |= n << b, b += 8;
                a.g = c >>> d;
                a.e = b - d;
                a.c = g;
                return c & (1 << d) - 1
            }

            function h(a, d) {
                var c = a.g,
                    b = a.e,
                    l = a.input,
                    g = a.c,
                    n = d[0];
                d = d[1];
                for (var p; b < d;) p = l[g++], void 0 === p && f(Error("input buffer is broken")), c |= p << b, b +=
                    8;
                l = n[c & (1 << d) - 1];
                n = l >>> 16;
                a.g = c >> n;
                a.e = b - n;
                a.c = g;
                return 65535 & l
            }

            function B(d) {
                function c(a, d, c) {
                    var b, l, g;
                    for (g = 0; g < a;) switch (b = h(this, d), b) {
                        case 16:
                            for (l = 3 + v(this, 2); l--;) c[g++] = n;
                            break;
                        case 17:
                            for (l = 3 + v(this, 3); l--;) c[g++] = 0;
                            var n = 0;
                            break;
                        case 18:
                            for (l = 11 + v(this, 7); l--;) c[g++] = 0;
                            n = 0;
                            break;
                        default:
                            n = c[g++] = b
                    }
                    return c
                }
                var b = v(d, 5) + 257,
                    l = v(d, 5) + 1,
                    g = v(d, 4) + 4,
                    n = new(z ? Uint8Array : Array)(V.length),
                    p;
                for (p = 0; p < g; ++p) n[V[p]] = v(d, 3);
                g = a(n);
                n = new(z ? Uint8Array : Array)(b);
                p = new(z ? Uint8Array : Array)(l);
                d.o(a(c.call(d,
                    b, g, n)), a(c.call(d, l, g, p)))
            }

            function E(a, d) {
                this.input = a;
                this.c = 0;
                !d && (d = {}) || (d.index && (this.c = d.index), d.verify && (this.M = d.verify));
                var c = a[this.c++];
                var b = a[this.c++];
                switch (15 & c) {
                    case W:
                        this.method = W;
                        break;
                    default:
                        f(Error("unsupported compression method"))
                }
                0 !== ((c << 8) + b) % 31 && f(Error("invalid fcheck flag:" + ((c << 8) + b) % 31));
                32 & b && f(Error("fdict flag is not supported"));
                this.A = new u(a, {
                    index: this.c,
                    bufferSize: d.bufferSize,
                    bufferType: d.bufferType,
                    resize: d.resize
                })
            }
            var y = this,
                z = "undefined" !== typeof Uint8Array &&
                "undefined" !== typeof Uint16Array && "undefined" !== typeof Uint32Array;
            k.prototype.f = function() {
                var a = this.buffer,
                    d, c = a.length,
                    b = new(z ? Uint8Array : Array)(c << 1);
                if (z) b.set(a);
                else
                    for (d = 0; d < c; ++d) b[d] = a[d];
                return this.buffer = b
            };
            k.prototype.d = function(a, d, c) {
                var b = this.buffer,
                    l = this.index,
                    g = this.i,
                    n = b[l];
                c && 1 < d && (a = 8 < d ? (q[255 & a] << 24 | q[a >>> 8 & 255] << 16 | q[a >>> 16 & 255] << 8 | q[a >>> 24 & 255]) >> 32 - d : q[a] >> 8 - d);
                if (8 > d + g) n = n << d | a, g += d;
                else
                    for (c = 0; c < d; ++c) n = n << 1 | a >> d - c - 1 & 1, 8 === ++g && (g = 0, b[l++] = q[n], n = 0, l === b.length &&
                        (b = this.f()));
                b[l] = n;
                this.buffer = b;
                this.i = g;
                this.index = l
            };
            k.prototype.finish = function() {
                var a = this.buffer,
                    d = this.index,
                    c;
                0 < this.i && (a[d] <<= 8 - this.i, a[d] = q[a[d]], d++);
                z ? c = a.subarray(0, d) : (a.length = d, c = a);
                return c
            };
            var x = new(z ? Uint8Array : Array)(256),
                C;
            for (C = 0; 256 > C; ++C) {
                var m = C,
                    F = m,
                    H = 7;
                for (m >>>= 1; m; m >>>= 1) F <<= 1, F |= 1 & m, --H;
                x[C] = (F << H & 255) >>> 0
            }
            var q = x;
            x = [0, 1996959894, 3993919788, 2567524794, 124634137, 1886057615, 3915621685, 2657392035, 249268274, 2044508324, 3772115230, 2547177864, 162941995, 2125561021, 3887607047,
                2428444049, 498536548, 1789927666, 4089016648, 2227061214, 450548861, 1843258603, 4107580753, 2211677639, 325883990, 1684777152, 4251122042, 2321926636, 335633487, 1661365465, 4195302755, 2366115317, 997073096, 1281953886, 3579855332, 2724688242, 1006888145, 1258607687, 3524101629, 2768942443, 901097722, 1119000684, 3686517206, 2898065728, 853044451, 1172266101, 3705015759, 2882616665, 651767980, 1373503546, 3369554304, 3218104598, 565507253, 1454621731, 3485111705, 3099436303, 671266974, 1594198024, 3322730930, 2970347812, 795835527, 1483230225,
                3244367275, 3060149565, 1994146192, 31158534, 2563907772, 4023717930, 1907459465, 112637215, 2680153253, 3904427059, 2013776290, 251722036, 2517215374, 3775830040, 2137656763, 141376813, 2439277719, 3865271297, 1802195444, 476864866, 2238001368, 4066508878, 1812370925, 453092731, 2181625025, 4111451223, 1706088902, 314042704, 2344532202, 4240017532, 1658658271, 366619977, 2362670323, 4224994405, 1303535960, 984961486, 2747007092, 3569037538, 1256170817, 1037604311, 2765210733, 3554079995, 1131014506, 879679996, 2909243462, 3663771856, 1141124467,
                855842277, 2852801631, 3708648649, 1342533948, 654459306, 3188396048, 3373015174, 1466479909, 544179635, 3110523913, 3462522015, 1591671054, 702138776, 2966460450, 3352799412, 1504918807, 783551873, 3082640443, 3233442989, 3988292384, 2596254646, 62317068, 1957810842, 3939845945, 2647816111, 81470997, 1943803523, 3814918930, 2489596804, 225274430, 2053790376, 3826175755, 2466906013, 167816743, 2097651377, 4027552580, 2265490386, 503444072, 1762050814, 4150417245, 2154129355, 426522225, 1852507879, 4275313526, 2312317920, 282753626, 1742555852,
                4189708143, 2394877945, 397917763, 1622183637, 3604390888, 2714866558, 953729732, 1340076626, 3518719985, 2797360999, 1068828381, 1219638859, 3624741850, 2936675148, 906185462, 1090812512, 3747672003, 2825379669, 829329135, 1181335161, 3412177804, 3160834842, 628085408, 1382605366, 3423369109, 3138078467, 570562233, 1426400815, 3317316542, 2998733608, 733239954, 1555261956, 3268935591, 3050360625, 752459403, 1541320221, 2607071920, 3965973030, 1969922972, 40735498, 2617837225, 3943577151, 1913087877, 83908371, 2512341634, 3803740692, 2075208622,
                213261112, 2463272603, 3855990285, 2094854071, 198958881, 2262029012, 4057260610, 1759359992, 534414190, 2176718541, 4139329115, 1873836001, 414664567, 2282248934, 4279200368, 1711684554, 285281116, 2405801727, 4167216745, 1634467795, 376229701, 2685067896, 3608007406, 1308918612, 956543938, 2808555105, 3495958263, 1231636301, 1047427035, 2932959818, 3654703836, 1088359270, 936918E3, 2847714899, 3736837829, 1202900863, 817233897, 3183342108, 3401237130, 1404277552, 615818150, 3134207493, 3453421203, 1423857449, 601450431, 3009837614, 3294710456,
                1567103746, 711928724, 3020668471, 3272380065, 1510334235, 755167117
            ];
            z && new Uint32Array(x);
            c.prototype.getParent = function(a) {
                return 2 * ((a - 2) / 4 | 0)
            };
            c.prototype.push = function(a, d) {
                var c, b = this.buffer;
                var l = this.length;
                b[this.length++] = d;
                for (b[this.length++] = a; 0 < l && (c = this.getParent(l), b[l] > b[c]);) a = b[l], b[l] = b[c], b[c] = a, a = b[l + 1], b[l + 1] = b[c + 1], b[c + 1] = a, l = c;
                return this.length
            };
            c.prototype.pop = function() {
                var a = this.buffer,
                    d;
                var c = a[0];
                var b = a[1];
                this.length -= 2;
                a[0] = a[this.length];
                a[1] = a[this.length + 1];
                for (d =
                    0;;) {
                    var l = 2 * d + 2;
                    if (l >= this.length) break;
                    l + 2 < this.length && a[l + 2] > a[l] && (l += 2);
                    if (!(a[l] > a[d])) break;
                    var g = a[d];
                    a[d] = a[l];
                    a[l] = g;
                    g = a[d + 1];
                    a[d + 1] = a[l + 1];
                    a[l + 1] = g;
                    d = l
                }
                return {
                    index: b,
                    value: c,
                    length: this.length
                }
            };
            var K = 2;
            x = {
                NONE: 0,
                r: 1,
                j: K,
                N: 3
            };
            var P = [];
            for (C = 0; 288 > C; C++) switch (!0) {
                case 143 >= C:
                    P.push([C + 48, 8]);
                    break;
                case 255 >= C:
                    P.push([C - 144 + 400, 9]);
                    break;
                case 279 >= C:
                    P.push([C - 256 + 0, 7]);
                    break;
                case 287 >= C:
                    P.push([C - 280 + 192, 8]);
                    break;
                default:
                    f("invalid literal: " + C)
            }
            d.prototype.n = function() {
                var a, d = this.input;
                switch (this.h) {
                    case 0:
                        var c = 0;
                        for (a = d.length; c < a;) {
                            var b = z ? d.subarray(c, c + 65535) : d.slice(c, c + 65535);
                            c += b.length;
                            var l = c === a,
                                g = this.a,
                                p = this.b;
                            if (z) {
                                for (g = new Uint8Array(this.a.buffer); g.length <= p + b.length + 5;) g = new Uint8Array(g.length << 1);
                                g.set(this.a)
                            }
                            l = l ? 1 : 0;
                            g[p++] = 0 | l;
                            l = b.length;
                            var u = 65536 + ~l & 65535;
                            g[p++] = 255 & l;
                            g[p++] = l >>> 8 & 255;
                            g[p++] = 255 & u;
                            g[p++] = u >>> 8 & 255;
                            if (z) g.set(b, p), p += b.length, g = g.subarray(0, p);
                            else {
                                l = 0;
                                for (u = b.length; l < u; ++l) g[p++] = b[l];
                                g.length = p
                            }
                            this.b = p;
                            this.a = g
                        }
                        break;
                    case 1:
                        c = new k(new Uint8Array(this.a.buffer),
                            this.b);
                        c.d(1, 1, !0);
                        c.d(1, 2, !0);
                        d = n(this, d);
                        b = 0;
                        for (g = d.length; b < g; b++)
                            if (a = d[b], k.prototype.d.apply(c, P[a]), 256 < a) c.d(d[++b], d[++b], !0), c.d(d[++b], 5), c.d(d[++b], d[++b], !0);
                            else if (256 === a) break;
                        this.a = c.finish();
                        this.b = this.a.length;
                        break;
                    case K:
                        a = new k(new Uint8Array(this.a), this.b);
                        var e, v, h, B = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];
                        u = Array(19);
                        var A;
                        p = K;
                        a.d(1, 1, !0);
                        a.d(p, 2, !0);
                        d = n(this, d);
                        var y = w(this.L, 15);
                        var E = t(y);
                        p = w(this.K, 7);
                        l = t(p);
                        for (e = 286; 257 < e && 0 === y[e - 1]; e--);
                        for (v = 30; 1 < v &&
                            0 === p[v - 1]; v--);
                        var x = e,
                            C = v;
                        var m = new(z ? Uint32Array : Array)(x + C);
                        var G = new(z ? Uint32Array : Array)(316),
                            F;
                        var L = new(z ? Uint8Array : Array)(19);
                        for (A = h = 0; A < x; A++) m[h++] = y[A];
                        for (A = 0; A < C; A++) m[h++] = p[A];
                        if (!z)
                            for (A = 0, C = L.length; A < C; ++A) L[A] = 0;
                        A = F = 0;
                        for (C = m.length; A < C; A += h) {
                            for (h = 1; A + h < C && m[A + h] === m[A]; ++h);
                            x = h;
                            if (0 === m[A])
                                if (3 > x)
                                    for (; 0 < x--;) G[F++] = 0, L[0]++;
                                else
                                    for (; 0 < x;) {
                                        var U = 138 > x ? x : 138;
                                        U > x - 3 && U < x && (U = x - 3);
                                        10 >= U ? (G[F++] = 17, G[F++] = U - 3, L[17]++) : (G[F++] = 18, G[F++] = U - 11, L[18]++);
                                        x -= U
                                    } else if (G[F++] = m[A],
                                        L[m[A]]++, x--, 3 > x)
                                        for (; 0 < x--;) G[F++] = m[A], L[m[A]]++;
                                    else
                                        for (; 0 < x;) U = 6 > x ? x : 6, U > x - 3 && U < x && (U = x - 3), G[F++] = 16, G[F++] = U - 3, L[16]++, x -= U
                        }
                        m = z ? G.subarray(0, F) : G.slice(0, F);
                        L = w(L, 7);
                        for (A = 0; 19 > A; A++) u[A] = L[B[A]];
                        for (h = 19; 4 < h && 0 === u[h - 1]; h--);
                        B = t(L);
                        a.d(e - 257, 5, !0);
                        a.d(v - 1, 5, !0);
                        a.d(h - 4, 4, !0);
                        for (A = 0; A < h; A++) a.d(u[A], 3, !0);
                        A = 0;
                        for (u = m.length; A < u; A++)
                            if (b = m[A], a.d(B[b], L[b], !0), 16 <= b) {
                                A++;
                                switch (b) {
                                    case 16:
                                        g = 2;
                                        break;
                                    case 17:
                                        g = 3;
                                        break;
                                    case 18:
                                        g = 7;
                                        break;
                                    default:
                                        f("invalid code: " + b)
                                }
                                a.d(m[A], g, !0)
                            }
                        g = [E, y];
                        l = [l,
                            p
                        ];
                        b = g[0];
                        g = g[1];
                        p = l[0];
                        E = l[1];
                        l = 0;
                        for (u = d.length; l < u; ++l)
                            if (c = d[l], a.d(b[c], g[c], !0), 256 < c) a.d(d[++l], d[++l], !0), y = d[++l], a.d(p[y], E[y], !0), a.d(d[++l], d[++l], !0);
                            else if (256 === c) break;
                        this.a = a.finish();
                        this.b = this.a.length;
                        break;
                    default:
                        f("invalid compression type")
                }
                return this.a
            };
            C = [];
            var S;
            for (S = 3; 258 >= S; S++) m = g(), C[S] = m[2] << 24 | m[1] << 16 | m[0];
            var M = z ? new Uint32Array(C) : C,
                O = x;
            p.prototype.n = function() {
                var a = 0;
                var d = this.a;
                var c = W;
                switch (c) {
                    case W:
                        var l = Math.LOG2E * Math.log(32768) - 8;
                        break;
                    default:
                        f(Error("invalid compression method"))
                }
                l =
                    l << 4 | c;
                d[a++] = l;
                switch (c) {
                    case W:
                        switch (this.h) {
                            case O.NONE:
                                var g = 0;
                                break;
                            case O.r:
                                g = 1;
                                break;
                            case O.j:
                                g = 2;
                                break;
                            default:
                                f(Error("unsupported compression type"))
                        }
                        break;
                    default:
                        f(Error("invalid compression method"))
                }
                c = g << 6 | 0;
                d[a++] = c | 31 - (256 * l + c) % 31;
                c = b(this.input);
                this.z.b = a;
                d = this.z.n();
                a = d.length;
                z && (d = new Uint8Array(d.buffer), d.length <= a + 4 && (this.a = new Uint8Array(d.length + 4), this.a.set(d), d = this.a), d = d.subarray(0, a + 4));
                d[a++] = c >> 24 & 255;
                d[a++] = c >> 16 & 255;
                d[a++] = c >> 8 & 255;
                d[a++] = 255 & c;
                return d
            };
            e("Zlib.Deflate",
                p);
            e("Zlib.Deflate.compress", function(a, d) {
                return (new p(a, d)).n()
            });
            e("Zlib.Deflate.CompressionType", O);
            e("Zlib.Deflate.CompressionType.NONE", O.NONE);
            e("Zlib.Deflate.CompressionType.FIXED", O.r);
            e("Zlib.Deflate.CompressionType.DYNAMIC", O.j);
            var L = 0,
                U = 1;
            x = {
                D: L,
                C: U
            };
            u.prototype.p = function() {
                for (; !this.s;) {
                    var a = v(this, 3);
                    1 & a && (this.s = !0);
                    a >>>= 1;
                    switch (a) {
                        case 0:
                            a = this.input;
                            var d = this.c,
                                c = this.a,
                                b = this.b,
                                l = c.length;
                            this.e = this.g = 0;
                            var g = a[d++];
                            void 0 === g && f(Error("invalid uncompressed block header: LEN (first byte)"));
                            var n = g;
                            g = a[d++];
                            void 0 === g && f(Error("invalid uncompressed block header: LEN (second byte)"));
                            n |= g << 8;
                            g = a[d++];
                            void 0 === g && f(Error("invalid uncompressed block header: NLEN (first byte)"));
                            var p = g;
                            g = a[d++];
                            void 0 === g && f(Error("invalid uncompressed block header: NLEN (second byte)"));
                            p |= g << 8;
                            n === ~p && f(Error("invalid uncompressed block header: length verify"));
                            d + n > a.length && f(Error("input buffer is broken"));
                            switch (this.m) {
                                case L:
                                    for (; b + n > c.length;) {
                                        g = l - b;
                                        n -= g;
                                        if (z) c.set(a.subarray(d, d + g), b), b += g, d +=
                                            g;
                                        else
                                            for (; g--;) c[b++] = a[d++];
                                        this.b = b;
                                        c = this.f();
                                        b = this.b
                                    }
                                    break;
                                case U:
                                    for (; b + n > c.length;) c = this.f({
                                        v: 2
                                    });
                                    break;
                                default:
                                    f(Error("invalid inflate mode"))
                            }
                            if (z) c.set(a.subarray(d, d + n), b), b += n, d += n;
                            else
                                for (; n--;) c[b++] = a[d++];
                            this.c = d;
                            this.b = b;
                            this.a = c;
                            break;
                        case 1:
                            this.o(fa, ba);
                            break;
                        case 2:
                            B(this);
                            break;
                        default:
                            f(Error("unknown BTYPE: " + a))
                    }
                }
                return this.t()
            };
            C = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];
            var V = z ? new Uint16Array(C) : C;
            C = [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67,
                83, 99, 115, 131, 163, 195, 227, 258, 258, 258
            ];
            var Z = z ? new Uint16Array(C) : C;
            C = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, 0, 0];
            var da = z ? new Uint8Array(C) : C;
            C = [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577];
            var Q = z ? new Uint16Array(C) : C;
            C = [0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13];
            var R = z ? new Uint8Array(C) : C;
            C = new(z ? Uint8Array : Array)(288);
            m = 0;
            for (F = C.length; m < F; ++m) C[m] = 143 >= m ? 8 : 255 >= m ? 9 : 279 >= m ? 7 : 8;
            var fa = a(C);
            C = new(z ? Uint8Array : Array)(30);
            m = 0;
            for (F = C.length; m < F; ++m) C[m] = 5;
            var ba = a(C);
            u.prototype.o = function(a, d) {
                var c = this.a,
                    b = this.b;
                this.u = a;
                for (var l = c.length - 258, g, n, p; 256 !== (g = h(this, a));)
                    if (256 > g) b >= l && (this.b = b, c = this.f(), b = this.b), c[b++] = g;
                    else
                        for (g -= 257, p = Z[g], 0 < da[g] && (p += v(this, da[g])), g = h(this, d), n = Q[g], 0 < R[g] && (n += v(this, R[g])), b >= l && (this.b = b, c = this.f(), b = this.b); p--;) c[b] = c[b++ - n];
                for (; 8 <= this.e;) this.e -= 8, this.c--;
                this.b = b
            };
            u.prototype.I = function(a, d) {
                var c = this.a,
                    b = this.b;
                this.u =
                    a;
                for (var l = c.length, g, n, p; 256 !== (g = h(this, a));)
                    if (256 > g) b >= l && (c = this.f(), l = c.length), c[b++] = g;
                    else
                        for (g -= 257, p = Z[g], 0 < da[g] && (p += v(this, da[g])), g = h(this, d), n = Q[g], 0 < R[g] && (n += v(this, R[g])), b + p > l && (c = this.f(), l = c.length); p--;) c[b] = c[b++ - n];
                for (; 8 <= this.e;) this.e -= 8, this.c--;
                this.b = b
            };
            u.prototype.f = function() {
                var a = new(z ? Uint8Array : Array)(this.b - 32768),
                    d = this.b - 32768,
                    c, b = this.a;
                if (z) a.set(b.subarray(32768, a.length));
                else {
                    var l = 0;
                    for (c = a.length; l < c; ++l) a[l] = b[l + 32768]
                }
                this.k.push(a);
                this.q += a.length;
                if (z) b.set(b.subarray(d, d + 32768));
                else
                    for (l = 0; 32768 > l; ++l) b[l] = b[d + l];
                this.b = 32768;
                return b
            };
            u.prototype.J = function(a) {
                var d, c = this.input.length / this.c + 1 | 0,
                    b, l, g, n = this.input,
                    p = this.a;
                a && ("number" === typeof a.v && (c = a.v), "number" === typeof a.F && (c += a.F));
                2 > c ? (b = (n.length - this.c) / this.u[2], g = b / 2 * 258 | 0, l = g < p.length ? p.length + g : p.length << 1) : l = p.length * c;
                z ? (d = new Uint8Array(l), d.set(p)) : d = p;
                return this.a = d
            };
            u.prototype.t = function() {
                var a = 0,
                    d = this.a,
                    c = this.k,
                    b = new(z ? Uint8Array : Array)(this.q + (this.b - 32768)),
                    l, g;
                if (0 === c.length) return z ? this.a.subarray(32768, this.b) : this.a.slice(32768, this.b);
                var n = 0;
                for (l = c.length; n < l; ++n) {
                    var p = c[n];
                    var k = 0;
                    for (g = p.length; k < g; ++k) b[a++] = p[k]
                }
                n = 32768;
                for (l = this.b; n < l; ++n) b[a++] = d[n];
                this.k = [];
                return this.buffer = b
            };
            u.prototype.H = function() {
                var a, d = this.b;
                z ? this.B ? (a = new Uint8Array(d), a.set(this.a.subarray(0, d))) : a = this.a.subarray(0, d) : (this.a.length > d && (this.a.length = d), a = this.a);
                return this.buffer = a
            };
            E.prototype.p = function() {
                var a = this.input,
                    d;
                var c = this.A.p();
                this.c =
                    this.A.c;
                this.M && (d = (a[this.c++] << 24 | a[this.c++] << 16 | a[this.c++] << 8 | a[this.c++]) >>> 0, d !== b(c) && f(Error("invalid adler-32 checksum")));
                return c
            };
            e("Zlib.Inflate", E);
            e("Zlib.Inflate.BufferType", x);
            x.ADAPTIVE = x.C;
            x.BLOCK = x.D;
            e("Zlib.Inflate.prototype.decompress", E.prototype.p);
            x = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];
            z && new Uint16Array(x);
            x = [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 258, 258];
            z && new Uint16Array(x);
            x = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2,
                2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, 0, 0
            ];
            z && new Uint8Array(x);
            x = [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577];
            z && new Uint16Array(x);
            x = [0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13];
            z && new Uint8Array(x);
            x = new(z ? Uint8Array : Array)(288);
            C = 0;
            for (m = x.length; C < m; ++C) x[C] = 143 >= C ? 8 : 255 >= C ? 9 : 279 >= C ? 7 : 8;
            a(x);
            x = new(z ? Uint8Array : Array)(30);
            C = 0;
            for (m = x.length; C < m; ++C) x[C] = 5;
            a(x);
            var W = 8
        }).call(window);
        h = window.Zlib;
        h.Deflate = h.Deflate;
        h.Deflate.compress = h.Deflate.compress;
        h.Inflate = h.Inflate;
        h.Inflate.BufferType = h.Inflate.BufferType;
        h.Inflate.prototype.decompress = h.Inflate.prototype.decompress;
        q.exports = h
    }, {}],
    27: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, d, c, b) {
            c && Object.defineProperty(a, d, {
                enumerable: c.enumerable,
                configurable: c.configurable,
                writable: c.writable,
                value: c.initializer ? c.initializer.call(b) : void 0
            })
        }

        function b(a) {
            if (void 0 === a) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
            return a
        }

        function k(a, d) {
            for (var c = 0; c < d.length; c++) {
                var b = d[c];
                b.enumerable = b.enumerable || !1;
                b.configurable = !0;
                "value" in b && (b.writable = !0);
                Object.defineProperty(a, b.key, b)
            }
        }

        function c(a, d, c) {
            d && k(a.prototype, d);
            c && k(a, c);
            return a
        }

        function a(a, d) {
            a.prototype = Object.create(d.prototype);
            a.prototype.constructor = a;
            a.__proto__ = d
        }

        function d(a, d, c, b, l) {
            var g = {};
            Object.keys(b).forEach(function(a) {
                g[a] = b[a]
            });
            g.enumerable = !!g.enumerable;
            g.configurable = !!g.configurable;
            ("value" in g || g.initializer) && (g.writable = !0);
            g = c.slice().reverse().reduce(function(c, b) {
                return b(a, d, c) || c
            }, g);
            l && void 0 !== g.initializer && (g.value = g.initializer ? g.initializer.call(l) : void 0, g.initializer = void 0);
            void 0 === g.initializer && (Object.defineProperty(a, d, g), g = null);
            return g
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var l = f(h("../../renderer/enums")),
            g = f(h("../value-types/color")),
            n = h("../value-types"),
            w = f(h("../renderer/index")),
            t = f(h("../platform/CCEnum")),
            p = f(h("../components/CCComponent")),
            u = h("../platform/CCClassDecorator"),
            v, A, B,
            E, y, z, x, C, G, F, H, I, K, P, S, M, O, L, U, V, Z, da, Q = null;
        !1;
        Q = h("../../renderer/scene/light");
        var R = (0, t["default"])({
                DIRECTIONAL: 0,
                POINT: 1,
                SPOT: 2,
                AMBIENT: 3
            }),
            fa = (0, t["default"])({
                NONE: 0,
                HARD: 2,
                SOFT_PCF3X3: 3,
                SOFT_PCF5X5: 4
            });
        h = (v = (0, u.ccclass)("cc.Light"), A = (0, u.menu)("i18n:MAIN_MENU.component.renderers/Light"), B = (0, u.inspector)("packages://inspector/inspectors/comps/light.js"), E = (0, u.property)({
            type: R
        }), y = (0, u.property)({
            type: fa
        }), v(z = A(z = (0, u.executeInEditMode)(z = B(z = (x = (da = Z = function(d) {
            function g() {
                var a =
                    d.call(this) || this;
                e(a, "_type", C, b(a));
                e(a, "_color", G, b(a));
                e(a, "_intensity", F, b(a));
                e(a, "_range", H, b(a));
                e(a, "_spotAngle", I, b(a));
                e(a, "_spotExp", K, b(a));
                e(a, "_shadowType", P, b(a));
                e(a, "_shadowResolution", S, b(a));
                e(a, "_shadowDarkness", M, b(a));
                e(a, "_shadowMinDepth", O, b(a));
                e(a, "_shadowMaxDepth", L, b(a));
                e(a, "_shadowFrustumSize", U, b(a));
                e(a, "_shadowBias", V, b(a));
                a._light = new Q;
                return a
            }
            a(g, d);
            c(g, [{
                    key: "type",
                    get: function() {
                        return this._type
                    },
                    set: function(a) {
                        this._type = a;
                        var d = l["default"].LIGHT_DIRECTIONAL;
                        a === R.POINT ? d = l["default"].LIGHT_POINT : a === R.SPOT ? d = l["default"].LIGHT_SPOT : a === R.AMBIENT && (d = l["default"].LIGHT_AMBIENT);
                        this._light.setType(d)
                    }
                }, {
                    key: "color",
                    get: function() {
                        return this._color
                    },
                    set: function(a) {
                        this._color.equals(a) || this._color.set(a);
                        this._light.setColor(a.r / 255, a.g / 255, a.b / 255)
                    }
                }, {
                    key: "intensity",
                    get: function() {
                        return this._intensity
                    },
                    set: function(a) {
                        this._intensity = a;
                        this._light.setIntensity(a)
                    }
                }, {
                    key: "range",
                    get: function() {
                        return this._range
                    },
                    set: function(a) {
                        this._range = a;
                        this._light.setRange(a)
                    }
                },
                {
                    key: "spotAngle",
                    get: function() {
                        return this._spotAngle
                    },
                    set: function(a) {
                        this._spotAngle = a;
                        this._light.setSpotAngle((0, n.toRadian)(a))
                    }
                }, {
                    key: "spotExp",
                    get: function() {
                        return this._spotExp
                    },
                    set: function(a) {
                        this._spotExp = a;
                        this._light.setSpotExp(a)
                    }
                }, {
                    key: "shadowType",
                    get: function() {
                        return this._shadowType
                    },
                    set: function(a) {
                        this._shadowType = a;
                        this._light.setShadowType(a)
                    }
                }, {
                    key: "shadowResolution",
                    get: function() {
                        return this._shadowResolution
                    },
                    set: function(a) {
                        this._shadowResolution = a;
                        this._light.setShadowResolution(a)
                    }
                },
                {
                    key: "shadowDarkness",
                    get: function() {
                        return this._shadowDarkness
                    },
                    set: function(a) {
                        this._shadowDarkness = a;
                        this._light.setShadowDarkness(a)
                    }
                }, {
                    key: "shadowMinDepth",
                    get: function() {
                        return this._shadowMinDepth
                    },
                    set: function(a) {
                        this._shadowMinDepth = a;
                        this._light.setShadowMinDepth(a)
                    }
                }, {
                    key: "shadowMaxDepth",
                    get: function() {
                        return this._shadowMaxDepth
                    },
                    set: function(a) {
                        this._shadowMaxDepth = a;
                        this._light.setShadowMaxDepth(a)
                    }
                }, {
                    key: "shadowFrustumSize",
                    get: function() {
                        return this._shadowFrustumSize
                    },
                    set: function(a) {
                        this._shadowFrustumSize =
                            a;
                        this._light.setShadowFrustumSize(a)
                    }
                }
            ]);
            var p = g.prototype;
            p.onLoad = function() {
                this._light.setNode(this.node);
                this.type = this._type;
                this.color = this._color;
                this.intensity = this._intensity;
                this.range = this._range;
                this.spotAngle = this._spotAngle;
                this.spotExp = this._spotExp;
                this.shadowType = this._shadowType;
                this.shadowResolution = this._shadowResolution;
                this.shadowDarkness = this._shadowDarkness;
                this.shadowMaxDepth = this._shadowMaxDepth;
                this.shadowFrustumSize = this._shadowFrustumSize;
                this.shadowBias = this._shadowBias
            };
            p.onEnable = function() {
                w["default"].scene.addLight(this._light)
            };
            p.onDisable = function() {
                w["default"].scene.removeLight(this._light)
            };
            return g
        }(p["default"]), Z.Type = R, Z.ShadowType = fa, da), C = d(x.prototype, "_type", [u.property], {
            configurable: !0,
            enumerable: !0,
            writable: !0,
            initializer: function() {
                return R.DIRECTIONAL
            }
        }), G = d(x.prototype, "_color", [u.property], {
            configurable: !0,
            enumerable: !0,
            writable: !0,
            initializer: function() {
                return g["default"].WHITE
            }
        }), F = d(x.prototype, "_intensity", [u.property], {
            configurable: !0,
            enumerable: !0,
            writable: !0,
            initializer: function() {
                return 1
            }
        }), H = d(x.prototype, "_range", [u.property], {
            configurable: !0,
            enumerable: !0,
            writable: !0,
            initializer: function() {
                return 1E3
            }
        }), I = d(x.prototype, "_spotAngle", [u.property], {
            configurable: !0,
            enumerable: !0,
            writable: !0,
            initializer: function() {
                return 60
            }
        }), K = d(x.prototype, "_spotExp", [u.property], {
            configurable: !0,
            enumerable: !0,
            writable: !0,
            initializer: function() {
                return 1
            }
        }), P = d(x.prototype, "_shadowType", [u.property], {
            configurable: !0,
            enumerable: !0,
            writable: !0,
            initializer: function() {
                return fa.NONE
            }
        }), S = d(x.prototype, "_shadowResolution", [u.property], {
            configurable: !0,
            enumerable: !0,
            writable: !0,
            initializer: function() {
                return 1024
            }
        }), M = d(x.prototype, "_shadowDarkness", [u.property], {
            configurable: !0,
            enumerable: !0,
            writable: !0,
            initializer: function() {
                return .5
            }
        }), O = d(x.prototype, "_shadowMinDepth", [u.property], {
            configurable: !0,
            enumerable: !0,
            writable: !0,
            initializer: function() {
                return 1
            }
        }), L = d(x.prototype, "_shadowMaxDepth", [u.property], {
            configurable: !0,
            enumerable: !0,
            writable: !0,
            initializer: function() {
                return 4096
            }
        }), U = d(x.prototype, "_shadowFrustumSize", [u.property], {
            configurable: !0,
            enumerable: !0,
            writable: !0,
            initializer: function() {
                return 1024
            }
        }), V = d(x.prototype, "_shadowBias", [u.property], {
            configurable: !0,
            enumerable: !0,
            writable: !0,
            initializer: function() {
                return 5E-4
            }
        }), d(x.prototype, "type", [E], Object.getOwnPropertyDescriptor(x.prototype, "type"), x.prototype), d(x.prototype, "color", [u.property], Object.getOwnPropertyDescriptor(x.prototype, "color"), x.prototype), d(x.prototype, "intensity", [u.property], Object.getOwnPropertyDescriptor(x.prototype, "intensity"), x.prototype), d(x.prototype, "range", [u.property], Object.getOwnPropertyDescriptor(x.prototype, "range"), x.prototype), d(x.prototype, "spotAngle", [u.property], Object.getOwnPropertyDescriptor(x.prototype, "spotAngle"), x.prototype), d(x.prototype, "spotExp", [u.property], Object.getOwnPropertyDescriptor(x.prototype, "spotExp"), x.prototype), d(x.prototype, "shadowType", [y], Object.getOwnPropertyDescriptor(x.prototype, "shadowType"), x.prototype), d(x.prototype,
            "shadowResolution", [u.property], Object.getOwnPropertyDescriptor(x.prototype, "shadowResolution"), x.prototype), d(x.prototype, "shadowDarkness", [u.property], Object.getOwnPropertyDescriptor(x.prototype, "shadowDarkness"), x.prototype), d(x.prototype, "shadowMinDepth", [u.property], Object.getOwnPropertyDescriptor(x.prototype, "shadowMinDepth"), x.prototype), d(x.prototype, "shadowMaxDepth", [u.property], Object.getOwnPropertyDescriptor(x.prototype, "shadowMaxDepth"), x.prototype), d(x.prototype, "shadowFrustumSize", [u.property],
            Object.getOwnPropertyDescriptor(x.prototype, "shadowFrustumSize"), x.prototype), x)) || z) || z) || z) || z);
        m["default"] = h;
        cc.Light = h;
        q.exports = m["default"]
    }, {
        "../../renderer/enums": 329,
        "../../renderer/scene/light": 355,
        "../components/CCComponent": 116,
        "../platform/CCClassDecorator": 205,
        "../platform/CCEnum": 206,
        "../renderer/index": 236,
        "../value-types": 301,
        "../value-types/color": 300
    }],
    28: [function(h, q, m) {
        h = cc.Class({
            name: "cc.Model",
            extends: cc.Asset,
            ctor: function() {
                this._rootNode = null;
                this.loaded = !1
            },
            properties: {
                _nodes: {
                    default: []
                },
                _precomputeJointMatrix: !1,
                nodes: {
                    get: function() {
                        return this._nodes
                    }
                },
                rootNode: {
                    get: function() {
                        return this._rootNode
                    }
                },
                precomputeJointMatrix: {
                    get: function() {
                        return this._precomputeJointMatrix
                    }
                }
            },
            onLoad: function() {
                var f = this._nodes;
                this._rootNode = f[0];
                for (var e = 0; e < f.length; e++) {
                    var b = f[e];
                    b.position = cc.v3.apply(this, b.position);
                    b.scale = cc.v3.apply(this, b.scale);
                    b.quat = cc.quat.apply(this, b.quat);
                    b.uniqueBindPose && (b.uniqueBindPose = cc.mat4.apply(this, b.uniqueBindPose));
                    var k = b.bindpose;
                    if (k)
                        for (var c in k) k[c] =
                            cc.mat4.apply(this, k[c]);
                    if (b = b.children)
                        for (k = 0; k < b.length; k++) b[k] = f[b[k]]
                }
            }
        });
        cc.Model = q.exports = h
    }, {}],
    29: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }
        var e = f(h("../value-types/quat")),
            b = f(h("../value-types/vec3")),
            k = cc.quat(),
            c = cc.v3();
        cc.Rotate3DTo = cc.Class({
            name: "cc.Rotate3DTo",
            extends: cc.ActionInterval,
            ctor: function(a, d, c, b) {
                this._startQuat = cc.quat();
                this._dstQuat = cc.quat();
                void 0 !== d && this.initWithDuration(a, d, c, b)
            },
            initWithDuration: function(a, d, c, b) {
                return cc.ActionInterval.prototype.initWithDuration.call(this,
                    a) ? (a = this._dstQuat, d instanceof cc.Quat ? a.set(d) : (d instanceof cc.Vec3 ? (c = d.y, b = d.z, d = d.x) : (c = c || 0, b = b || 0), e["default"].fromEuler(a, d, c, b)), !0) : !1
            },
            clone: function() {
                var a = new cc.Rotate3DTo;
                this._cloneDecoration(a);
                a.initWithDuration(this._duration, this._dstQuat);
                return a
            },
            startWithTarget: function(a) {
                cc.ActionInterval.prototype.startWithTarget.call(this, a);
                this._startQuat.set(a.quat)
            },
            reverse: function() {
                cc.logID(1016)
            },
            update: function(a) {
                a = this._computeEaseTime(a);
                this.target && (e["default"].slerp(k,
                    this._startQuat, this._dstQuat, a), this.target.setRotation(k))
            }
        });
        cc.rotate3DTo = function(a, d, c, b) {
            return new cc.Rotate3DTo(a, d, c, b)
        };
        cc.Rotate3DBy = cc.Class({
            name: "cc.Rotate3DBy",
            extends: cc.ActionInterval,
            ctor: function(a, d, c, b) {
                this._startQuat = cc.quat();
                this._dstQuat = cc.quat();
                this._deltaAngle = cc.v3();
                void 0 !== d && this.initWithDuration(a, d, c, b)
            },
            initWithDuration: function(a, d, c, g) {
                return cc.ActionInterval.prototype.initWithDuration.call(this, a) ? (d instanceof cc.Vec3 ? (c = d.y, g = d.z, d = d.x) : (c = c || 0, g = g || 0),
                    b["default"].set(this._deltaAngle, d, c, g), !0) : !1
            },
            clone: function() {
                var a = new cc.Rotate3DBy;
                this._cloneDecoration(a);
                a.initWithDuration(this._duration, this._angle);
                return a
            },
            startWithTarget: function(a) {
                cc.ActionInterval.prototype.startWithTarget.call(this, a);
                var d = a.eulerAngles,
                    c = this._deltaAngle;
                e["default"].fromEuler(this._dstQuat, d.x + c.x, d.y + c.y, d.z + c.z);
                this._startQuat.set(a.quat)
            },
            update: function() {
                return function(a) {
                    a = this._computeEaseTime(a);
                    this.target && (e["default"].slerp(k, this._startQuat,
                        this._dstQuat, a), this.target.setRotation(k))
                }
            }(),
            reverse: function() {
                var a = this._angle;
                c.x = -a.x;
                c.y = -a.y;
                c.z = -a.z;
                a = new cc.Rotate3DBy(this._duration, c);
                this._cloneDecoration(a);
                this._reverseEaseList(a);
                return a
            }
        });
        cc.rotate3DBy = function(a, d, c, b) {
            return new cc.Rotate3DBy(a, d, c, b)
        }
    }, {
        "../value-types/quat": 304,
        "../value-types/vec3": 311
    }],
    30: [function(h, q, m) {
        !0;
        !0;
        h("./primitive");
        h("./physics/exports/physics-builtin");
        h("./physics/exports/physics-cannon");
        h("./physics/exports/physics-framework");
        h("./CCModel");
        h("./skeleton/CCSkeleton");
        h("./skeleton/CCSkeletonAnimationClip");
        h("./actions");
        h("./physics/framework/assets/physics-material");
        !0;
        h("./skeleton/CCSkeletonAnimation");
        h("./skeleton/CCSkinnedMeshRenderer");
        h("./skeleton/skinned-mesh-renderer");
        h("./CCLightComponent");
        h("./particle/particle-system-3d");
        h("./particle/renderer/particle-system-3d-renderer")
    }, {
        "./CCLightComponent": 27,
        "./CCModel": 28,
        "./actions": 29,
        "./particle/particle-system-3d": void 0,
        "./particle/renderer/particle-system-3d-renderer": void 0,
        "./physics/exports/physics-builtin": void 0,
        "./physics/exports/physics-cannon": void 0,
        "./physics/exports/physics-framework": void 0,
        "./physics/framework/assets/physics-material": void 0,
        "./primitive": void 0,
        "./skeleton/CCSkeleton": 32,
        "./skeleton/CCSkeletonAnimation": 33,
        "./skeleton/CCSkeletonAnimationClip": 34,
        "./skeleton/CCSkinnedMeshRenderer": 35,
        "./skeleton/skinned-mesh-renderer": 36
    }],
    31: [function(h, q, m) {
        h = h("../../../animation/animation-curves");
        h = cc.Class({
            name: "cc.JointMatrixCurve",
            extends: h.DynamicAnimCurve,
            _findFrameIndex: h.quickFindIndex,
            sample: function(f, e) {
                f = this._findFrameIndex(this.ratios, e); - 1 > f && (f = ~f - 1);
                e = this.pairs;
                for (var b = 0; b < e.length; b++) {
                    var k = e[b];
                    k.target._jointMatrix = k.values[f]
                }
            }
        });
        q.exports = h
    }, {
        "../../../animation/animation-curves": 12
    }],
    32: [function(h, q, m) {
        h = cc.Class({
            name: "cc.Skeleton",
            extends: cc.Asset,
            ctor: function() {
                this.loaded = !1;
                this._bindposes = [];
                this._uniqueBindPoses = [];
                this._jointPaths = []
            },
            properties: {
                _model: cc.Model,
                _jointIndices: [],
                _skinIndex: -1,
                jointPaths: {
                    get: function() {
                        return this._jointPaths
                    }
                },
                bindposes: {
                    get: function() {
                        return this._bindposes
                    }
                },
                uniqueBindPoses: {
                    get: function() {
                        return this._uniqueBindPoses
                    }
                },
                model: {
                    get: function() {
                        return this._model
                    }
                }
            },
            onLoad: function() {
                for (var f = this._model.nodes, e = this._jointIndices, b = this._jointPaths, k = this._bindposes, c = this._uniqueBindPoses, a = 0; a < e.length; a++) {
                    var d = f[e[a]];
                    b[a] = d.path;
                    d.uniqueBindPose ? k[a] = c[a] = d.uniqueBindPose : k[a] = d.bindpose[this._skinIndex]
                }
            }
        });
        cc.Skeleton = q.exports = h
    }, {}],
    33: [function(h, q, m) {
        var f = h("../../components/CCAnimation");
        m = h("../CCModel");
        h = h("./CCSkeletonAnimationClip");
        h = cc.Class({
            name: "cc.SkeletonAnimation",
            extends: f,
            editor: !1,
            properties: {
                _model: {
                    default: null,
                    type: m
                },
                _defaultClip: {
                    override: !0,
                    default: null,
                    type: h
                },
                _clips: {
                    override: !0,
                    default: [],
                    type: [h],
                    visible: !0
                },
                defaultClip: {
                    override: !0,
                    get: function() {
                        return this._defaultClip
                    },
                    set: function(e) {
                        this._defaultClip = e
                    },
                    type: h
                },
                model: {
                    get: function() {
                        return this._model
                    },
                    set: function(e) {
                        this._model = e;
                        this._updateClipModel()
                    },
                    type: m
                }
            },
            __preload: function() {
                this._updateClipModel()
            },
            _updateClipModel: function() {
                this._defaultClip && (this._defaultClip._model = this._model);
                for (var e = this._clips, b = 0; b < e.length; b++) e[b]._model = this._model
            },
            addClip: function(e, b) {
                e._model = this._model;
                return f.prototype.addClip.call(this, e, b)
            },
            searchClips: !1
        });
        cc.SkeletonAnimation = q.exports = h
    }, {
        "../../components/CCAnimation": 111,
        "../CCModel": 28,
        "./CCSkeletonAnimationClip": 34,
        "fire-path": void 0
    }],
    34: [function(h, q, m) {
        function f(c) {
            var a = new Float32Array(16);
            a.set(c.m);
            return a
        }
        var e = function(c) {
                return c &&
                    c.__esModule ? c : {
                        default: c
                    }
            }(h("../../value-types/mat4")),
            b = h("../../../animation/animation-clip"),
            k = h("./CCJointMatrixCurve");
        h = cc.Class({
            name: "cc.SkeletonAnimationClip",
            extends: b,
            properties: {
                _nativeAsset: {
                    override: !0,
                    get: function() {
                        return this._buffer
                    },
                    set: function(c) {
                        var a = ArrayBuffer.isView(c) ? c.buffer : c;
                        this._buffer = new Float32Array(a || c, 0, a.byteLength / 4)
                    }
                },
                description: {
                    default: null,
                    type: Object
                },
                curveData: {
                    visible: !1,
                    override: !0,
                    get: function() {
                        return this._curveData || {}
                    },
                    set: function() {}
                }
            },
            statics: {
                preventDeferredLoadDependents: !0
            },
            _init: function() {
                if (this._curveData) return this._curveData;
                this._curveData = {};
                this._generateCommonCurve();
                this._model.precomputeJointMatrix && this._generateJointMatrixCurve();
                return this._curveData
            },
            _generateCommonCurve: function() {
                function c() {
                    return a[b++]
                }
                var a = this._buffer,
                    d = this.description,
                    b = 0;
                this._curveData.paths || (this._curveData.paths = {});
                var g = this._curveData.paths,
                    n;
                for (n in d) {
                    var k = d[n],
                        t = {};
                    g[n] = {
                        props: t
                    };
                    for (var p in k) {
                        var u = [],
                            e = k[p].frameCount;
                        b = k[p].offset;
                        for (var f = 0; f < e; f++) {
                            var h =
                                c(),
                                E = void 0;
                            "position" === p || "scale" === p ? E = cc.v3(c(), c(), c()) : "quat" === p && (E = cc.quat(c(), c(), c(), c()));
                            u.push({
                                frame: h,
                                value: E
                            })
                        }
                        t[p] = u
                    }
                }
            },
            _generateJointMatrixCurve: function() {
                function c(b, l, n) {
                    var p = d[b.path];
                    if (b !== a && p) {
                        p = p.props;
                        for (var k in p)
                            for (var t = p[k], u = 0; u < t.length; u++) {
                                var w = t[u];
                                if (1E-4 > Math.abs(w.frame - l)) {
                                    b[k].set(w.value);
                                    break
                                }
                                if (w.frame > l) {
                                    t = t[u - 1];
                                    t.value.lerp(w.value, (l - t.frame) / (w.frame - t.frame), b[k]);
                                    break
                                }
                            }
                        w = cc.mat4();
                        e["default"].fromRTS(w, b.quat, b.position, b.scale);
                        n && e["default"].mul(w,
                            n, w);
                        p._jointMatrix || (p._jointMatrix = []);
                        if (b.uniqueBindPose) {
                            var v = cc.mat4();
                            e["default"].mul(v, w, b.uniqueBindPose)
                        }
                        g[b.path] || (g[b.path] = []);
                        v ? g[b.path].push(f(v)) : g[b.path].push(w)
                    }
                    b = b.children;
                    for (var h in b) c(b[h], l, w)
                }
                for (var a = this._model.rootNode, d = this._curveData.paths, b = {
                        ratios: [],
                        jointMatrixMap: {}
                    }, g = b.jointMatrixMap, n = 0, k = this.duration, t = 1 / this.sample; n < k;) b.ratios.push(n / k), c(a, n), n += t;
                this._curveData = b
            },
            _createJointMatrixCurve: function(c, a) {
                c = new k;
                c.ratios = this.curveData.ratios;
                c.pairs = [];
                var d = this.curveData.jointMatrixMap,
                    b;
                for (b in d) {
                    var g = cc.find(b, a);
                    g && c.pairs.push({
                        target: g,
                        values: d[b]
                    })
                }
                return [c]
            },
            createCurves: function(c, a) {
                if (!this._model) return cc.warn("Skeleton Animation Clip [" + this.name + "] Can not find model"), [];
                this._init();
                return this._model.precomputeJointMatrix ? this._createJointMatrixCurve(c, a) : b.prototype.createCurves.call(this, c, a)
            }
        });
        cc.SkeletonAnimationClip = q.exports = h
    }, {
        "../../../animation/animation-clip": 11,
        "../../value-types/mat4": 303,
        "./CCJointMatrixCurve": 31
    }],
    35: [function(h, q, m) {
        var f = function(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }(h("../../value-types/mat4"));
        m = h("./CCSkeleton");
        var e = h("../../mesh/CCMeshRenderer"),
            b = h("../../renderer/render-flow");
        h("../../../renderer/enums");
        var k = cc.mat4(),
            c = cc.mat4();
        h = cc.Class({
            name: "cc.SkinnedMeshRenderer",
            extends: e,
            editor: !1,
            ctor: function() {
                this._jointsTexture = this._jointsData = this._jointsFloat32Data = null;
                this._joints = [];
                this._dummyNode = new cc.Node;
                this._jointsTextureOptions = null;
                this._usingRGBA8Texture = !1
            },
            properties: {
                _skeleton: m,
                _rootBone: cc.Node,
                skeleton: {
                    get: function() {
                        return this._skeleton
                    },
                    set: function(a) {
                        this._skeleton = a;
                        this._init()
                    },
                    type: m
                },
                rootBone: {
                    get: function() {
                        return this._rootBone
                    },
                    set: function(a) {
                        this._rootBone = a;
                        this._init()
                    },
                    type: cc.Node
                },
                enableAutoBatch: {
                    get: function() {
                        return !1
                    },
                    visible: !1,
                    override: !0
                }
            },
            __preload: function() {
                this._super();
                this._init()
            },
            _init: function() {
                this._model = this._skeleton && this._skeleton.model;
                this._calFunc = null;
                this._initJoints();
                this._initJointsTexture();
                this._initCalcFunc();
                this._updateRenderNode()
            },
            _calcWorldMatrixToRoot: function(a) {
                var d = a._worldMatrixToRoot;
                d || (a._worldMatrixToRoot = d = cc.mat4(), a.getLocalMatrix(d), a = a.parent, a !== this.rootBone && (a._worldMatrixToRoot || this._calcWorldMatrixToRoot(a), f["default"].mul(d, a._worldMatrixToRoot, d)))
            },
            _validateRender: function() {
                this._jointsData ? this._super() : this.disableRender()
            },
            _initJoints: function() {
                var a = this._joints;
                a.length = 0;
                if (this.skeleton && this.rootBone) {
                    for (var d = this._useJointMatrix(), c = this.skeleton.jointPaths,
                            g = this.rootBone, n = 0; n < c.length; n++) {
                        var e = cc.find(c[n], g);
                        e || cc.warn("Can not find joint in root bone [%s] with path [%s]", g.name, c[n]);
                        d && (e._renderFlag &= ~b.FLAG_CHILDREN, this._calcWorldMatrixToRoot(e));
                        a.push(e)
                    }
                    if (d)
                        for (d = this.skeleton.uniqueBindPoses, g = 0; g < c.length; g++) n = a[g], d[g] ? (f["default"].mul(k, n._worldMatrixToRoot, d[g]), n._jointMatrix = f["default"].toArray([], k)) : n._jointMatrix = n._worldMatrixToRoot
                }
            },
            _initJointsTexture: function() {
                if (this._skeleton) {
                    var a = this._joints.length,
                        d = !1;
                    a <= cc.sys.getMaxJointMatrixSize() &&
                        (d = !0, this._jointsData = this._jointsFloat32Data = new Float32Array(16 * a));
                    if (!d) {
                        var c = !!cc.sys.glExtension("OES_texture_float");
                        d = 256 < a ? 64 : 64 < a ? 32 : 16 < a ? 16 : 8;
                        this._jointsData = this._jointsFloat32Data = new Float32Array(d * d * 4);
                        var b = cc.Texture2D.PixelFormat.RGBA32F,
                            n = d;
                        c || (this._jointsData = new Uint8Array(this._jointsFloat32Data.buffer), b = cc.Texture2D.PixelFormat.RGBA8888, n *= 4, this._usingRGBA8Texture = !0, cc.warn("SkinnedMeshRenderer [" + this.node.name + "] has too many joints [" + a + "] and device do not support float32 texture, fallback to use RGBA8888 texture, which is much slower."));
                        a = this._jointsTexture || new cc.Texture2D;
                        c = cc.Texture2D.Filter.NEAREST;
                        a.setFilters(c, c);
                        a.initWithData(this._jointsData, b, n, d);
                        this._jointsTexture = a;
                        this._jointsTextureOptions = {
                            format: b,
                            width: a.width,
                            height: a.height,
                            images: []
                        }
                    }
                    this._updateMaterial()
                }
            },
            _updateMaterial: function() {
                e.prototype._updateMaterial.call(this);
                for (var a = this.getMaterials(), d = 0; d < a.length; d++) {
                    var c = a[d];
                    this._jointsTexture ? (c.setProperty("jointsTexture", this._jointsTexture), c.setProperty("jointsTextureSize", new Float32Array([this._jointsTexture.width,
                        this._jointsTexture.height
                    ])), c.define("CC_JOINTS_TEXTURE_FLOAT32", !!cc.sys.glExtension("OES_texture_float")), c.define("CC_USE_JOINTS_TEXTRUE", !0)) : (this._jointsFloat32Data && c.setProperty("jointMatrices", this._jointsFloat32Data, void 0, !0), c.define("CC_USE_JOINTS_TEXTRUE", !1));
                    c.define("CC_USE_SKINNING", !0)
                }
            },
            _setJointsDataWithArray: function(a, d) {
                this._jointsFloat32Data.set(d, 16 * a)
            },
            _setJointsDataWithMatrix: function(a, d) {
                this._jointsFloat32Data.set(d.m, 16 * a)
            },
            _commitJointsData: function() {
                this._jointsTexture &&
                    (this._jointsTextureOptions.images[0] = this._jointsData, this._jointsTexture.update(this._jointsTextureOptions))
            },
            _useJointMatrix: function() {
                return this._model && this._model.precomputeJointMatrix
            },
            _updateRenderNode: function() {
                this._useJointMatrix() || this._usingRGBA8Texture ? this._assembler.setRenderNode(this.rootBone) : this._assembler.setRenderNode(this._dummyNode)
            },
            _initCalcFunc: function() {
                this._useJointMatrix() ? this._calFunc = this._calJointMatrix : this._usingRGBA8Texture ? this._calFunc = this._calRGBA8WorldMatrix :
                    this._calFunc = this._calWorldMatrix
            },
            _calJointMatrix: function() {
                for (var a = this._joints, d = this.skeleton.bindposes, c = this.skeleton.uniqueBindPoses, b = 0; b < a.length; ++b) {
                    var n = a[b]._jointMatrix;
                    c[b] ? this._setJointsDataWithArray(b, n) : (f["default"].multiply(k, n, d[b]), this._setJointsDataWithMatrix(b, k))
                }
            },
            _calRGBA8WorldMatrix: function() {
                var a = this._joints,
                    d = this.skeleton.bindposes;
                this.rootBone._updateWorldMatrix();
                for (var b = f["default"].invert(c, this.rootBone._worldMatrix), g = 0; g < a.length; ++g) {
                    var n = a[g];
                    n._updateWorldMatrix();
                    f["default"].multiply(k, b, n._worldMatrix);
                    f["default"].multiply(k, k, d[g]);
                    this._setJointsDataWithMatrix(g, k)
                }
            },
            _calWorldMatrix: function() {
                for (var a = this._joints, d = this.skeleton.bindposes, c = 0; c < a.length; ++c) {
                    var b = a[c];
                    b._updateWorldMatrix();
                    f["default"].multiply(k, b._worldMatrix, d[c]);
                    this._setJointsDataWithMatrix(c, k)
                }
            },
            calcJointMatrix: function() {
                this.skeleton && this.rootBone && (this._calFunc.call(this), this._commitJointsData())
            }
        });
        cc.SkinnedMeshRenderer = q.exports = h
    }, {
        "../../../renderer/enums": 329,
        "../../mesh/CCMeshRenderer": 173,
        "../../renderer/render-flow": 237,
        "../../value-types/mat4": 303,
        "./CCSkeleton": 32
    }],
    36: [function(h, q, m) {
        function f(b, c) {
            b.prototype = Object.create(c.prototype);
            b.prototype.constructor = b;
            b.__proto__ = c
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = h("./CCSkinnedMeshRenderer"),
            b = h("../../mesh/mesh-renderer");
        h("../../renderer/render-flow");
        h = function(b) {
            function c() {
                return b.apply(this, arguments) || this
            }
            f(c, b);
            c.prototype.fillBuffers = function(a, d) {
                a.calcJointMatrix();
                b.prototype.fillBuffers.call(this,
                    a, d)
            };
            return c
        }(b);
        m["default"] = h;
        cc.Assembler.register(e, h);
        q.exports = m["default"]
    }, {
        "../../mesh/mesh-renderer": 176,
        "../../renderer/render-flow": 237,
        "./CCSkinnedMeshRenderer": 35
    }],
    37: [function(h, q, m) {
        function f(a) {
            return function() {
                var a = b[arguments[0]] || "unknown id";
                if (1 === arguments.length) return a;
                if (2 === arguments.length) return cc.js.formatStr(a, arguments[1]);
                var d = cc.js.shiftArguments.apply(null, arguments);
                return cc.js.formatStr.apply(null, [a].concat(d))
            }
        }
        var e = h("./platform/utils"),
            b = h("../../DebugInfos") || {},
            k;
        cc.log = cc.warn = cc.error = cc.assert = console.log.bind ? console.log.bind(console) : console.log;
        cc._throw = function(a) {
            e.callInNextTick(function() {
                throw a;
            })
        };
        var c = f("Log");
        cc.logID = function() {
            cc.log(c.apply(null, arguments))
        };
        var a = f("Warning");
        cc.warnID = function() {
            cc.warn(a.apply(null, arguments))
        };
        var d = f("Error");
        cc.errorID = function() {
            cc.error(d.apply(null, arguments))
        };
        var l = f("Assert");
        cc.assertID = function(a) {
            a || cc.assert(!1, l.apply(null, cc.js.shiftArguments.apply(null, arguments)))
        };
        var g = cc.Enum({
            NONE: 0,
            INFO: 1,
            WARN: 2,
            ERROR: 3,
            INFO_FOR_WEB_PAGE: 4,
            WARN_FOR_WEB_PAGE: 5,
            ERROR_FOR_WEB_PAGE: 6
        });
        q.exports = cc.debug = {
            DebugMode: g,
            _resetDebugSetting: function(a) {
                cc.log = cc.warn = cc.error = cc.assert = function() {};
                if (a !== g.NONE) {
                    if (a > g.ERROR) {
                        var d = function(a) {
                            if (cc.game.canvas) {
                                if (!k) {
                                    var d = document.createElement("Div");
                                    d.setAttribute("id", "logInfoDiv");
                                    d.setAttribute("width", "200");
                                    d.setAttribute("height", cc.game.canvas.height);
                                    var c = d.style;
                                    c.zIndex = "99999";
                                    c.position = "absolute";
                                    c.top = c.left = "0";
                                    k = document.createElement("textarea");
                                    k.setAttribute("rows", "20");
                                    k.setAttribute("cols", "30");
                                    k.setAttribute("disabled", "true");
                                    c = k.style;
                                    c.backgroundColor = "transparent";
                                    c.borderBottom = "1px solid #cccccc";
                                    c.borderTopWidth = c.borderLeftWidth = c.borderRightWidth = "0px";
                                    c.borderTopStyle = c.borderLeftStyle = c.borderRightStyle = "none";
                                    c.padding = "0px";
                                    c.margin = 0;
                                    d.appendChild(k);
                                    cc.game.canvas.parentNode.appendChild(d)
                                }
                                k.value = k.value + a + "\r\n";
                                k.scrollTop = k.scrollHeight
                            }
                        };
                        cc.error = function() {
                            d("ERROR :  " + cc.js.formatStr.apply(null, arguments))
                        };
                        cc.assert = function(a, c) {
                            !a && c && (c = cc.js.formatStr.apply(null, cc.js.shiftArguments.apply(null, arguments)), d("ASSERT: " + c))
                        };
                        a !== g.ERROR_FOR_WEB_PAGE && (cc.warn = function() {
                            d("WARN :  " + cc.js.formatStr.apply(null, arguments))
                        });
                        a === g.INFO_FOR_WEB_PAGE && (cc.log = function() {
                            d(cc.js.formatStr.apply(null, arguments))
                        })
                    } else console && console.log.apply && (console.error || (console.error = console.log), console.warn || (console.warn = console.log), !1, console.error.bind ? cc.error = console.error.bind(console) : cc.error = (!1, function() {
                        return console.error.apply(console,
                            arguments)
                    }), cc.assert = function(a, d) {
                        if (!a) throw d && (d = cc.js.formatStr.apply(null, cc.js.shiftArguments.apply(null, arguments))), !1, !1, Error(d);
                    });
                    a !== g.ERROR && (!1, console.warn.bind ? cc.warn = console.warn.bind(console) : cc.warn = (!1, function() {
                        return console.warn.apply(console, arguments)
                    }));
                    !1;
                    a === g.INFO && (!1, !1, console.log.bind ? cc.log = console.log.bind(console) : cc.log = function() {
                        return console.log.apply(console, arguments)
                    })
                }
            },
            getError: f("ERROR"),
            isDisplayStats: function() {
                return !!cc.profiler && cc.profiler.isShowingStats()
            },
            setDisplayStats: function(a) {
                cc.profiler && cc.game.renderType !== cc.game.RENDER_TYPE_CANVAS && (a ? cc.profiler.showStats() : cc.profiler.hideStats(), cc.game.config.showFPS = !!a)
            }
        }
    }, {
        "../../DebugInfos": 1,
        "./platform/utils": 228
    }],
    38: [function(h, q, m) {
        var f = h("./event/event-target"),
            e = h("./component-scheduler"),
            b = h("./node-activator"),
            k = h("./platform/CCObject"),
            c = h("./CCGame"),
            a = h("./renderer"),
            d = h("./event-manager"),
            l = h("./CCScheduler");
        cc.Director = function() {
            f.call(this);
            this._purgeDirectorInNextLoop = this._paused = !1;
            this._scene = this._winSizeInPoints = null;
            this._loadingScene = "";
            this._maxParticleDeltaTime = this._startTime = this._deltaTime = this._lastUpdate = this._totalFrames = 0;
            this._actionManager = this._nodeActivator = this._compScheduler = this._scheduler = null;
            var a = this;
            c.on(c.EVENT_SHOW, function() {
                a._lastUpdate = performance.now()
            });
            c.once(c.EVENT_ENGINE_INITED, this.init, this)
        };
        cc.Director.prototype = {
            constructor: cc.Director,
            init: function() {
                this._totalFrames = 0;
                this._startTime = this._lastUpdate = performance.now();
                this._purgeDirectorInNextLoop =
                    this._paused = !1;
                this._winSizeInPoints = cc.size(0, 0);
                this._scheduler = new l;
                cc.ActionManager ? (this._actionManager = new cc.ActionManager, this._scheduler.scheduleUpdate(this._actionManager, l.PRIORITY_SYSTEM, !1)) : this._actionManager = null;
                this.sharedInit();
                return !0
            },
            sharedInit: function() {
                this._compScheduler = new e;
                this._nodeActivator = new b;
                d && d.setEnabled(!0);
                cc.AnimationManager ? (this._animationManager = new cc.AnimationManager, this._scheduler.scheduleUpdate(this._animationManager, l.PRIORITY_SYSTEM, !1)) : this._animationManager =
                    null;
                cc.CollisionManager ? (this._collisionManager = new cc.CollisionManager, this._scheduler.scheduleUpdate(this._collisionManager, l.PRIORITY_SYSTEM, !1)) : this._collisionManager = null;
                cc.PhysicsManager ? (this._physicsManager = new cc.PhysicsManager, this._scheduler.scheduleUpdate(this._physicsManager, l.PRIORITY_SYSTEM, !1)) : this._physicsManager = null;
                cc.Physics3DManager && !1;
                this._physics3DManager = null;
                cc._widgetManager && cc._widgetManager.init(this)
            },
            calculateDeltaTime: function(a) {
                a || (a = performance.now());
                this._deltaTime =
                    a > this._lastUpdate ? (a - this._lastUpdate) / 1E3 : 0;
                (!0, 1 < this._deltaTime) && (this._deltaTime = 1 / 60);
                this._lastUpdate = a
            },
            convertToGL: function(a) {
                var d = c.container,
                    b = cc.view,
                    g = d.getBoundingClientRect(),
                    l = b._devicePixelRatio * (a.x - (g.left + window.pageXOffset - d.clientLeft));
                a = b._devicePixelRatio * (g.top + window.pageYOffset - d.clientTop + g.height - a.y);
                return b._isRotated ? cc.v2(b._viewportRect.width - a, l) : cc.v2(l, a)
            },
            convertToUI: function(a) {
                var d = c.container,
                    b = cc.view,
                    g = d.getBoundingClientRect(),
                    l = g.left + window.pageXOffset -
                    d.clientLeft;
                d = g.top + window.pageYOffset - d.clientTop;
                var k = cc.v2(0, 0);
                b._isRotated ? (k.x = l + a.y / b._devicePixelRatio, k.y = d + g.height - (b._viewportRect.width - a.x) / b._devicePixelRatio) : (k.x = l + a.x * b._devicePixelRatio, k.y = d + g.height - a.y * b._devicePixelRatio);
                return k
            },
            end: function() {
                this._purgeDirectorInNextLoop = !0
            },
            getWinSize: function() {
                return cc.size(cc.winSize)
            },
            getWinSizeInPixels: function() {
                return cc.size(cc.winSize)
            },
            pause: function() {
                this._paused || (this._paused = !0)
            },
            purgeCachedData: function() {
                cc.assetManager.releaseAll()
            },
            purgeDirector: function() {
                this._scheduler.unscheduleAll();
                this._compScheduler.unscheduleAll();
                this._nodeActivator.reset();
                d && d.setEnabled(!1);
                !0;
                cc.isValid(this._scene) && this._scene.destroy();
                this._scene = null;
                cc.renderer.clear();
                cc.assetManager.builtins.clear();
                cc.game.pause();
                cc.assetManager.releaseAll()
            },
            reset: function() {
                this.purgeDirector();
                d && d.setEnabled(!0);
                this._actionManager && this._scheduler.scheduleUpdate(this._actionManager, cc.Scheduler.PRIORITY_SYSTEM, !1);
                this._animationManager && this._scheduler.scheduleUpdate(this._animationManager,
                    cc.Scheduler.PRIORITY_SYSTEM, !1);
                this._collisionManager && this._scheduler.scheduleUpdate(this._collisionManager, cc.Scheduler.PRIORITY_SYSTEM, !1);
                this._physicsManager && this._scheduler.scheduleUpdate(this._physicsManager, cc.Scheduler.PRIORITY_SYSTEM, !1);
                cc.game.resume()
            },
            runSceneImmediate: function(a, d, b) {
                cc.assertID(a instanceof cc.Scene || a instanceof cc.SceneAsset, 1216);
                a instanceof cc.SceneAsset && (a = a.scene);
                !0;
                console.time("InitScene");
                a._load();
                !0;
                console.timeEnd("InitScene");
                !0;
                console.time("AttachPersist");
                for (var l = Object.keys(c._persistRootNodes).map(function(a) {
                        return c._persistRootNodes[a]
                    }), g = 0; g < l.length; g++) {
                    var n = l[g],
                        e = a.getChildByUuid(n.uuid);
                    if (e) {
                        var w = e.getSiblingIndex();
                        e._destroyImmediate();
                        a.insertChild(n, w)
                    } else n.parent = a
                }!0;
                console.timeEnd("AttachPersist");
                g = this._scene;
                !0;
                !0;
                console.time("AutoRelease");
                cc.assetManager._releaseManager._autoRelease(g, a, l);
                !0;
                console.timeEnd("AutoRelease");
                !0;
                console.time("Destroy");
                cc.isValid(g) && g.destroy();
                this._scene = null;
                k._deferredDestroy();
                !0;
                console.timeEnd("Destroy");
                d && d();
                this.emit(cc.Director.EVENT_BEFORE_SCENE_LAUNCH, a);
                this._scene = a;
                !0;
                console.time("Activate");
                a._activate();
                !0;
                console.timeEnd("Activate");
                cc.game.resume();
                b && b(null, a);
                this.emit(cc.Director.EVENT_AFTER_SCENE_LAUNCH, a)
            },
            runScene: function(a, d, c) {
                cc.assertID(a, 1205);
                cc.assertID(a instanceof cc.Scene || a instanceof cc.SceneAsset, 1216);
                a instanceof cc.SceneAsset && (a = a.scene);
                a._load();
                this.once(cc.Director.EVENT_AFTER_DRAW, function() {
                    this.runSceneImmediate(a, d, c)
                }, this)
            },
            loadScene: function(a, d, c) {
                if (this._loadingScene) return cc.warnID(1208, a, this._loadingScene), !1;
                var b = cc.assetManager.bundles.find(function(d) {
                    return d.getSceneInfo(a)
                });
                if (b) {
                    this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING, a);
                    this._loadingScene = a;
                    var l = this;
                    console.time("LoadScene " + a);
                    b.loadScene(a, function(b, g) {
                        console.timeEnd("LoadScene " + a);
                        l._loadingScene = "";
                        b ? (b = "Failed to load scene: " + b, cc.error(b), d && d(b)) : l.runSceneImmediate(g, c, d)
                    });
                    return !0
                }
                cc.errorID(1209, a);
                return !1
            },
            preloadScene: function(a,
                d, c) {
                var b = cc.assetManager.bundles.find(function(d) {
                    return d.getSceneInfo(a)
                });
                if (!b) return cc.errorID(1209, a), null;
                b.preloadScene(a, null, d, c)
            },
            resume: function() {
                this._paused && ((this._lastUpdate = performance.now()) || cc.logID(1200), this._paused = !1, this._deltaTime = 0)
            },
            setDepthTest: function(a) {
                cc.Camera.main && (cc.Camera.main.depth = !!a)
            },
            setClearColor: function(a) {
                cc.Camera.main && (cc.Camera.main.backgroundColor = a)
            },
            getRunningScene: function() {
                return this._scene
            },
            getScene: function() {
                return this._scene
            },
            getAnimationInterval: function() {
                return 1E3 /
                    c.getFrameRate()
            },
            setAnimationInterval: function(a) {
                c.setFrameRate(Math.round(1E3 / a))
            },
            getDeltaTime: function() {
                return this._deltaTime
            },
            getTotalTime: function() {
                return performance.now() - this._startTime
            },
            getTotalFrames: function() {
                return this._totalFrames
            },
            isPaused: function() {
                return this._paused
            },
            getScheduler: function() {
                return this._scheduler
            },
            setScheduler: function(a) {
                this._scheduler !== a && (this._scheduler = a)
            },
            getActionManager: function() {
                return this._actionManager
            },
            setActionManager: function(a) {
                this._actionManager !==
                    a && (this._actionManager && this._scheduler.unscheduleUpdate(this._actionManager), this._actionManager = a, this._scheduler.scheduleUpdate(this._actionManager, cc.Scheduler.PRIORITY_SYSTEM, !1))
            },
            getAnimationManager: function() {
                return this._animationManager
            },
            getCollisionManager: function() {
                return this._collisionManager
            },
            getPhysicsManager: function() {
                return this._physicsManager
            },
            getPhysics3DManager: function() {
                return this._physics3DManager
            },
            startAnimation: function() {
                cc.game.resume()
            },
            stopAnimation: function() {
                cc.game.pause()
            },
            _resetDeltaTime: function() {
                this._lastUpdate = performance.now();
                this._deltaTime = 0
            },
            mainLoop: function(c) {
                this._purgeDirectorInNextLoop ? (this._purgeDirectorInNextLoop = !1, this.purgeDirector()) : (this.calculateDeltaTime(c), this._paused || (this.emit(cc.Director.EVENT_BEFORE_UPDATE), this._compScheduler.startPhase(), this._compScheduler.updatePhase(this._deltaTime), this._scheduler.update(this._deltaTime), this._compScheduler.lateUpdatePhase(this._deltaTime), this.emit(cc.Director.EVENT_AFTER_UPDATE), k._deferredDestroy()),
                    this.emit(cc.Director.EVENT_BEFORE_DRAW), a.render(this._scene, this._deltaTime), this.emit(cc.Director.EVENT_AFTER_DRAW), d.frameUpdateListeners(), this._totalFrames++)
            },
            __fastOn: function(a, d, c) {
                this.on(a, d, c)
            },
            __fastOff: function(a, d, c) {
                this.off(a, d, c)
            }
        };
        cc.js.addon(cc.Director.prototype, f.prototype);
        cc.Director.EVENT_PROJECTION_CHANGED = "director_projection_changed";
        cc.Director.EVENT_BEFORE_SCENE_LOADING = "director_before_scene_loading";
        cc.Director.EVENT_BEFORE_SCENE_LAUNCH = "director_before_scene_launch";
        cc.Director.EVENT_AFTER_SCENE_LAUNCH = "director_after_scene_launch";
        cc.Director.EVENT_BEFORE_UPDATE = "director_before_update";
        cc.Director.EVENT_AFTER_UPDATE = "director_after_update";
        cc.Director.EVENT_BEFORE_VISIT = "director_before_draw";
        cc.Director.EVENT_AFTER_VISIT = "director_before_draw";
        cc.Director.EVENT_BEFORE_DRAW = "director_before_draw";
        cc.Director.EVENT_AFTER_DRAW = "director_after_draw";
        cc.Director.PROJECTION_2D = 0;
        cc.Director.PROJECTION_3D = 1;
        cc.Director.PROJECTION_CUSTOM = 3;
        cc.Director.PROJECTION_DEFAULT =
            cc.Director.PROJECTION_2D;
        cc.Director.EVENT_BEFORE_PHYSICS = "director_before_physics";
        cc.Director.EVENT_AFTER_PHYSICS = "director_after_physics";
        cc.director = new cc.Director;
        q.exports = cc.director
    }, {
        "./CCGame": 39,
        "./CCScheduler": 43,
        "./component-scheduler": 110,
        "./event-manager": 149,
        "./event/event-target": 151,
        "./node-activator": 177,
        "./platform/CCObject": 210,
        "./renderer": 236
    }],
    39: [function(h, q, m) {
        m = h("./event/event-target");
        h("../audio/CCAudioEngine");
        var f = h("./CCDebug"),
            e = h("./renderer/index.js"),
            b = h("../core/renderer/utils/dynamic-atlas/manager"),
            k = {
                EVENT_HIDE: "game_on_hide",
                EVENT_SHOW: "game_on_show",
                EVENT_RESTART: "game_on_restart",
                EVENT_GAME_INITED: "game_inited",
                EVENT_ENGINE_INITED: "engine_inited",
                EVENT_RENDERER_INITED: "engine_inited",
                RENDER_TYPE_CANVAS: 0,
                RENDER_TYPE_WEBGL: 1,
                RENDER_TYPE_OPENGL: 2,
                _persistRootNodes: {},
                _paused: !0,
                _configLoaded: !1,
                _isCloning: !1,
                _prepared: !1,
                _rendererInitialized: !1,
                _renderContext: null,
                _intervalId: null,
                _lastTime: null,
                _frameTime: null,
                frame: null,
                container: null,
                canvas: null,
                renderType: -1,
                config: null,
                onStart: null,
                setFrameRate: function(c) {
                    this.config.frameRate =
                        c;
                    this._intervalId && window.cancelAnimFrame(this._intervalId);
                    this._intervalId = 0;
                    this._paused = !0;
                    this._setAnimFrame();
                    this._runMainLoop()
                },
                getFrameRate: function() {
                    return this.config.frameRate
                },
                step: function() {
                    cc.director.mainLoop()
                },
                pause: function() {
                    this._paused || (this._paused = !0, cc.audioEngine && cc.audioEngine._break(), this._intervalId && window.cancelAnimFrame(this._intervalId), this._intervalId = 0)
                },
                resume: function() {
                    this._paused && (this._paused = !1, cc.audioEngine && cc.audioEngine._restore(), cc.director._resetDeltaTime(),
                        this._runMainLoop())
                },
                isPaused: function() {
                    return this._paused
                },
                restart: function() {
                    cc.director.once(cc.Director.EVENT_AFTER_DRAW, function() {
                        for (var c in k._persistRootNodes) k.removePersistRootNode(k._persistRootNodes[c]);
                        cc.director.getScene().destroy();
                        cc.Object._deferredDestroy();
                        cc.audioEngine && cc.audioEngine.uncacheAll();
                        cc.director.reset();
                        k.pause();
                        cc.assetManager.builtins.init(function() {
                            k.onStart();
                            k.emit(k.EVENT_RESTART)
                        })
                    })
                },
                end: function() {
                    close()
                },
                _initEngine: function() {
                    this._rendererInitialized ||
                        (this._initRenderer(), !0, this._initEvents(), this.emit(this.EVENT_ENGINE_INITED))
                },
                _loadPreviewScript: function(c) {
                    !1;
                    c()
                },
                _prepareFinished: function(c) {
                    var a = this;
                    this._initEngine();
                    this._setAnimFrame();
                    cc.assetManager.builtins.init(function() {
                        console.log("Cocos Creator v" + cc.ENGINE_VERSION);
                        a._prepared = !0;
                        a._runMainLoop();
                        a.emit(a.EVENT_GAME_INITED);
                        c && c()
                    })
                },
                eventTargetOn: m.prototype.on,
                eventTargetOnce: m.prototype.once,
                on: function(c, a, d, b) {
                    this._prepared && c === this.EVENT_ENGINE_INITED || !this._paused &&
                        c === this.EVENT_GAME_INITED ? a.call(d) : this.eventTargetOn(c, a, d, b)
                },
                once: function(c, a, d) {
                    this._prepared && c === this.EVENT_ENGINE_INITED || !this._paused && c === this.EVENT_GAME_INITED ? a.call(d) : this.eventTargetOnce(c, a, d)
                },
                prepare: function(c) {
                    var a = this;
                    this._prepared ? c && c() : this._loadPreviewScript(function() {
                        a._prepareFinished(c)
                    })
                },
                run: function(c, a) {
                    this._initConfig(c);
                    this.onStart = a;
                    this.prepare(k.onStart && k.onStart.bind(k))
                },
                addPersistRootNode: function(c) {
                    if (cc.Node.isNode(c) && c.uuid) {
                        var a = c.uuid;
                        if (!this._persistRootNodes[a]) {
                            var d =
                                cc.director._scene;
                            if (cc.isValid(d))
                                if (c.parent) {
                                    if (!(c.parent instanceof cc.Scene)) {
                                        cc.warnID(3801);
                                        return
                                    }
                                    if (c.parent !== d) {
                                        cc.warnID(3802);
                                        return
                                    }
                                } else c.parent = d;
                            this._persistRootNodes[a] = c;
                            c._persistNode = !0;
                            cc.assetManager._releaseManager._addPersistNodeRef(c)
                        }
                    } else cc.warnID(3800)
                },
                removePersistRootNode: function(c) {
                    var a = c.uuid || "";
                    c === this._persistRootNodes[a] && (delete this._persistRootNodes[a], c._persistNode = !1, cc.assetManager._releaseManager._removePersistNodeRef(c))
                },
                isPersistRootNode: function(c) {
                    return c._persistNode
                },
                _setAnimFrame: function() {
                    this._lastTime = performance.now();
                    var c = k.config.frameRate;
                    this._frameTime = 1E3 / c;
                    cc.director._maxParticleDeltaTime = this._frameTime / 1E3 * 2;
                    !1;
                    !1;
                    60 !== c && 30 !== c ? (window.requestAnimFrame = this._stTime, window.cancelAnimFrame = this._ctTime) : (window.requestAnimFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || this._stTime, window.cancelAnimFrame = window.cancelAnimationFrame ||
                        window.cancelRequestAnimationFrame || window.msCancelRequestAnimationFrame || window.mozCancelRequestAnimationFrame || window.oCancelRequestAnimationFrame || window.webkitCancelRequestAnimationFrame || window.msCancelAnimationFrame || window.mozCancelAnimationFrame || window.webkitCancelAnimationFrame || window.oCancelAnimationFrame || this._ctTime)
                },
                _stTime: function(c) {
                    var a = performance.now(),
                        d = Math.max(0, k._frameTime - (a - k._lastTime)),
                        b = window.setTimeout(function() {
                            c()
                        }, d);
                    k._lastTime = a + d;
                    return b
                },
                _ctTime: function(c) {
                    window.clearTimeout(c)
                },
                _runMainLoop: function() {
                    !1;
                    if (this._prepared) {
                        var c = this,
                            a = c.config,
                            d = cc.director,
                            b = !0,
                            g = a.frameRate;
                        f.setDisplayStats(a.showFPS);
                        var n = function(a) {
                            c._paused || (c._intervalId = window.requestAnimFrame(n), (!0, 30 === g) && (b = !b) || d.mainLoop(a))
                        };
                        c._intervalId = window.requestAnimFrame(n);
                        c._paused = !1
                    }
                },
                _initConfig: function(c) {
                    "number" !== typeof c.debugMode && (c.debugMode = 0);
                    c.exposeClassName = !!c.exposeClassName;
                    "number" !== typeof c.frameRate && (c.frameRate = 60);
                    var a = c.renderMode;
                    ("number" !== typeof a || 2 < a || 0 > a) &&
                    (c.renderMode = 0);
                    "boolean" !== typeof c.registerSystemEvent && (c.registerSystemEvent = !0);
                    c.showFPS = 1 !== a && !!c.showFPS;
                    this.collisionMatrix = c.collisionMatrix || [];
                    this.groupList = c.groupList || [];
                    f._resetDebugSetting(c.debugMode);
                    this.config = c;
                    this._configLoaded = !0
                },
                _determineRenderType: function() {
                    var c = parseInt(this.config.renderMode) || 0;
                    this.renderType = this.RENDER_TYPE_CANVAS;
                    var a = !1;
                    0 === c ? cc.sys.capabilities.opengl ? (this.renderType = this.RENDER_TYPE_WEBGL, a = !0) : cc.sys.capabilities.canvas && (this.renderType =
                        this.RENDER_TYPE_CANVAS, a = !0) : 1 === c && cc.sys.capabilities.canvas ? (this.renderType = this.RENDER_TYPE_CANVAS, a = !0) : 2 === c && cc.sys.capabilities.opengl && (this.renderType = this.RENDER_TYPE_WEBGL, a = !0);
                    if (!a) throw Error(f.getError(3820, c));
                },
                _initRenderer: function() {
                    if (!this._rendererInitialized) {
                        try {
                            var c = document.createElement("canvas");
                            var a = !(!window.WebGLRenderingContext || !c.getContext("webgl") && !c.getContext("experimental-webgl"))
                        } catch (n) {
                            a = !1
                        }
                        if (a) {
                            a = this.config.id;
                            var d, l;
                            !1;
                            !1;
                            var g = a instanceof HTMLElement ?
                                a : document.querySelector(a) || document.querySelector("#" + a);
                            "CANVAS" === g.tagName ? (a = g.width, c = g.height, this.canvas = d = g, this.container = l = document.createElement("DIV"), d.parentNode && d.parentNode.insertBefore(l, d)) : ("DIV" !== g.tagName && cc.warnID(3819), a = g.clientWidth, c = g.clientHeight, this.canvas = d = document.createElement("CANVAS"), this.container = l = document.createElement("DIV"), g.appendChild(l));
                            l.setAttribute("id", "Cocos2dGameContainer");
                            l.appendChild(d);
                            this.frame = l.parentNode === document.body ? document.documentElement :
                                l.parentNode;
                            (function(a, d) {
                                -1 < (" " + a.className + " ").indexOf(" " + d + " ") || (a.className && (a.className += " "), a.className += d)
                            })(d, "gameCanvas");
                            d.setAttribute("width", a || 480);
                            d.setAttribute("height", c || 320);
                            d.setAttribute("tabindex", 99);
                            this._determineRenderType();
                            this.renderType === this.RENDER_TYPE_WEBGL && (e.initWebGL(d, {
                                stencil: !0,
                                antialias: cc.macro.ENABLE_WEBGL_ANTIALIAS,
                                alpha: cc.macro.ENABLE_TRANSPARENT_CANVAS
                            }), this._renderContext = e.device._gl, !cc.macro.CLEANUP_IMAGE_CACHE && b && (b.enabled = !0));
                            this._renderContext ||
                                (this.renderType = this.RENDER_TYPE_CANVAS, e.initCanvas(d), this._renderContext = e.device._ctx);
                            this.canvas.oncontextmenu = function() {
                                if (!cc._isContextMenuEnable) return !1
                            };
                            this._rendererInitialized = !0
                        } else alert("Please update the Internet Browser or use Safari, FireFox,  Chrome.")
                    }
                },
                _initEvents: function() {
                    function c() {
                        g || (g = !0, k.emit(k.EVENT_HIDE))
                    }

                    function a(a, d, c, b, l) {
                        g && (g = !1, k.emit(k.EVENT_SHOW, a, d, c, b, l))
                    }
                    var d = window,
                        b;
                    this.config.registerSystemEvent && cc.internal.inputManager.registerSystemEvent(this.canvas);
                    "undefined" !== typeof document.hidden ? b = "hidden" : "undefined" !== typeof document.mozHidden ? b = "mozHidden" : "undefined" !== typeof document.msHidden ? b = "msHidden" : "undefined" !== typeof document.webkitHidden && (b = "webkitHidden");
                    var g = !1;
                    if (b)
                        for (var n = ["visibilitychange", "mozvisibilitychange", "msvisibilitychange", "webkitvisibilitychange", "qbrowserVisibilityChange"], e = 0; e < n.length; e++) document.addEventListener(n[e], function(d) {
                            var l = document[b];
                            (l = l || d.hidden) ? c(): a()
                        });
                    else d.addEventListener("blur", c), d.addEventListener("focus",
                        a); - 1 < navigator.userAgent.indexOf("MicroMessenger") && (d.onfocus = a);
                    "onpageshow" in window && "onpagehide" in window && (d.addEventListener("pagehide", c), d.addEventListener("pageshow", a), document.addEventListener("pagehide", c), document.addEventListener("pageshow", a));
                    this.on(k.EVENT_HIDE, function() {});
                    this.on(k.EVENT_SHOW, function() {})
                }
            };
        m.call(k);
        cc.js.addon(k, m.prototype);
        cc.game = q.exports = k
    }, {
        "../audio/CCAudioEngine": 22,
        "../core/renderer/utils/dynamic-atlas/manager": void 0,
        "./CCDebug": 37,
        "./event/event-target": 151,
        "./renderer/index.js": 236
    }],
    40: [function(h, q, m) {
        function f(a, d) {
            if (d) {
                for (var c = 0, b = null; a && cc.Node.isNode(a); a = a._parent, ++c)
                    if (a.getComponent(d)) {
                        var l = {
                            index: c,
                            node: a
                        };
                        b ? b.push(l) : b = [l]
                    }
                return b
            }
            return null
        }

        function e(a, d) {
            if (!(a._objFlags & y)) {
                if (a._bubblingListeners)
                    for (var c = 0, b = d.length; c < b; ++c)
                        if (a._bubblingListeners.hasEventListener(d[c])) return !0;
                if (a._capturingListeners)
                    for (c = 0, b = d.length; c < b; ++c)
                        if (a._capturingListeners.hasEventListener(d[c])) return !0;
                return !1
            }
            return !0
        }

        function b(a) {
            var d =
                a.groupIndex;
            0 === d && a.parent && (d = b(a.parent));
            return d
        }

        function k(a) {
            var d = b(a);
            a._cullingMask = 1 << d;
            !1;
            for (d = 0; d < a._children.length; d++) k(a._children[d])
        }

        function c() {
            if (this._localMatDirty & ea.TRSS) {
                var a = this._matrix,
                    d = a.m;
                n.Trs.toMat4(a, this._trs);
                if (this._skewX || this._skewY) {
                    a = d[0];
                    var c = d[1],
                        b = d[4],
                        l = d[5],
                        g = Math.tan(this._skewX * z),
                        p = Math.tan(this._skewY * z);
                    Infinity === g && (g = 99999999);
                    Infinity === p && (p = 99999999);
                    d[0] = a + b * p;
                    d[1] = c + l * p;
                    d[4] = b + a * g;
                    d[5] = l + c * g
                }
                this._localMatDirty &= ~ea.TRSS;
                this._worldMatDirty = !0
            }
        }

        function a() {
            var a = this._localMatDirty;
            if (a & ea.TRSS) {
                var d = this._matrix.m,
                    c = this._trs;
                if (a & (ea.RS | ea.SKEW)) {
                    var b = -this._eulerAngles.z;
                    a = this._skewX || this._skewY;
                    var l = c[7],
                        g = c[8];
                    if (b || a) {
                        var n = 1,
                            p = 0,
                            k = 0,
                            t = 1;
                        b && (b *= z, k = Math.sin(b), n = t = Math.cos(b), p = -k);
                        d[0] = n * l;
                        d[1] = p * l;
                        d[4] = k * g;
                        d[5] = t * g;
                        a && (a = d[0], l = d[1], g = d[4], k = d[5], b = Math.tan(this._skewX * z), n = Math.tan(this._skewY * z), Infinity === b && (b = 99999999), Infinity === n && (n = 99999999), d[0] = a + g * n, d[1] = l + k * n, d[4] = g + a * b, d[5] = k + l * b)
                    } else d[0] = l, d[1] = 0, d[4] =
                        0, d[5] = g
                }
                d[12] = c[0];
                d[13] = c[1];
                this._localMatDirty &= ~ea.TRSS;
                this._worldMatDirty = !0
            }
        }

        function d() {
            this._localMatDirty & ea.TRSS && this._updateLocalMatrix();
            this._parent ? n.Mat4.mul(this._worldMatrix, this._parent._worldMatrix, this._matrix) : n.Mat4.copy(this._worldMatrix, this._matrix);
            this._worldMatDirty = !1
        }

        function l() {
            this._localMatDirty & ea.TRSS && this._updateLocalMatrix();
            var a = this._parent;
            a ? this._mulMat(this._worldMatrix, a._worldMatrix, this._matrix) : n.Mat4.copy(this._worldMatrix, this._matrix);
            this._worldMatDirty = !1
        }

        function g(a, d, c) {
            var b = d.m;
            c = c.m;
            a = a.m;
            d = b[0];
            var l = b[1],
                g = b[4],
                n = b[5],
                p = b[12];
            b = b[13];
            var k = c[0],
                t = c[1],
                u = c[4],
                e = c[5],
                w = c[12];
            c = c[13];
            0 !== l || 0 !== g ? (a[0] = k * d + t * g, a[1] = k * l + t * n, a[4] = u * d + e * g, a[5] = u * l + e * n, a[12] = d * w + g * c + p, a[13] = l * w + n * c + b) : (a[0] = k * d, a[1] = t * n, a[4] = u * d, a[5] = e * n, a[12] = d * w + p, a[13] = n * c + b)
        }
        var n = h("./value-types");
        m = h("./utils/base-node");
        var w = h("./utils/prefab-helper"),
            t = h("./utils/trans-pool").NodeMemPool,
            p = h("./utils/affine-transform"),
            u = h("./event-manager"),
            v = h("./platform/CCMacro"),
            A = h("./platform/js");
        h("./event/event");
        var B = h("./event/event-target"),
            E = h("./renderer/render-flow"),
            y = cc.Object.Flags.Destroying,
            z = Math.PI / 180,
            x = !!cc.ActionManager;
        h = function() {};
        var C = new n.Vec3,
            G = new n.Quat,
            F = new n.Vec3,
            H = new n.Vec3,
            I = new n.Quat,
            K = new n.Quat,
            P = new n.Vec3,
            S = new n.Vec3,
            M = new n.Vec3,
            O = new n.Vec3,
            L = new n.Vec3,
            U = new n.Quat,
            V = new n.Quat,
            Z = new n.Vec3,
            da = new n.Quat,
            Q = new n.Vec3,
            R = new n.Quat,
            fa = new n.Vec3,
            ba = new n.Vec3,
            W = new n.Quat,
            aa = new n.Quat;
        new n.Quat;
        var ca = cc.mat4(),
            ha = new n.Vec3,
            ia = Array(16);
        ia.length = 0;
        var Ba = cc.Enum({
                DEBUG: 31
            }),
            ea = cc.Enum({
                POSITION: 1,
                SCALE: 2,
                ROTATION: 4,
                SKEW: 8,
                TRS: 7,
                RS: 6,
                TRSS: 15,
                PHYSICS_POSITION: 16,
                PHYSICS_SCALE: 32,
                PHYSICS_ROTATION: 64,
                PHYSICS_TRS: 112,
                PHYSICS_RS: 96,
                ALL_POSITION: 17,
                ALL_SCALE: 34,
                ALL_ROTATION: 68,
                ALL_TRS: 119,
                ALL: 65535
            }),
            X = cc.Enum({
                TOUCH_START: "touchstart",
                TOUCH_MOVE: "touchmove",
                TOUCH_END: "touchend",
                TOUCH_CANCEL: "touchcancel",
                MOUSE_DOWN: "mousedown",
                MOUSE_MOVE: "mousemove",
                MOUSE_ENTER: "mouseenter",
                MOUSE_LEAVE: "mouseleave",
                MOUSE_UP: "mouseup",
                MOUSE_WHEEL: "mousewheel",
                POSITION_CHANGED: "position-changed",
                ROTATION_CHANGED: "rotation-changed",
                SCALE_CHANGED: "scale-changed",
                SIZE_CHANGED: "size-changed",
                ANCHOR_CHANGED: "anchor-changed",
                COLOR_CHANGED: "color-changed",
                CHILD_ADDED: "child-added",
                CHILD_REMOVED: "child-removed",
                CHILD_REORDER: "child-reorder",
                GROUP_CHANGED: "group-changed",
                SIBLING_ORDER_CHANGED: "sibling-order-changed"
            }),
            na = [X.TOUCH_START, X.TOUCH_MOVE, X.TOUCH_END, X.TOUCH_CANCEL],
            ma = [X.MOUSE_DOWN, X.MOUSE_ENTER, X.MOUSE_MOVE, X.MOUSE_LEAVE, X.MOUSE_UP, X.MOUSE_WHEEL],
            r = !0,
            Aa = function(a, d) {
                0 !== a && (!1, r && cc.warn("`cc.Node.skewX/Y` is deprecated since v2.2.1, please use 3D node instead.", ""), !0, r = !1)
            },
            ja = null,
            la = function(a, d) {
                var c = a.getLocation(),
                    b = this.owner;
                return b._hitTest(c, this) ? (d.type = X.TOUCH_START, d.touch = a, d.bubbles = !0, b.dispatchEvent(d), !0) : !1
            },
            ta = function(a, d) {
                var c = this.owner;
                d.type = X.TOUCH_MOVE;
                d.touch = a;
                d.bubbles = !0;
                c.dispatchEvent(d)
            },
            N = function(a, d) {
                var c = a.getLocation(),
                    b = this.owner;
                b._hitTest(c, this) ? d.type = X.TOUCH_END : d.type = X.TOUCH_CANCEL;
                d.touch =
                    a;
                d.bubbles = !0;
                b.dispatchEvent(d)
            },
            T = function(a, d) {
                a.getLocation();
                var c = this.owner;
                d.type = X.TOUCH_CANCEL;
                d.touch = a;
                d.bubbles = !0;
                c.dispatchEvent(d)
            },
            pa = function(a) {
                var d = a.getLocation(),
                    c = this.owner;
                c._hitTest(d, this) && (a.type = X.MOUSE_DOWN, a.bubbles = !0, c.dispatchEvent(a))
            },
            oa = function(a) {
                var d = a.getLocation(),
                    c = this.owner;
                if (c._hitTest(d, this)) this._previousIn || (ja && ja._mouseListener && (a.type = X.MOUSE_LEAVE, ja.dispatchEvent(a), ja._mouseListener._previousIn = !1), ja = this.owner, a.type = X.MOUSE_ENTER, c.dispatchEvent(a),
                    this._previousIn = !0), a.type = X.MOUSE_MOVE, a.bubbles = !0, c.dispatchEvent(a);
                else {
                    if (!this._previousIn) return;
                    a.type = X.MOUSE_LEAVE;
                    c.dispatchEvent(a);
                    this._previousIn = !1;
                    ja = null
                }
                a.stopPropagation()
            },
            Ia = function(a) {
                var d = a.getLocation(),
                    c = this.owner;
                c._hitTest(d, this) && (a.type = X.MOUSE_UP, a.bubbles = !0, c.dispatchEvent(a), a.stopPropagation())
            },
            xa = function(a) {
                var d = a.getLocation(),
                    c = this.owner;
                c._hitTest(d, this) && (a.type = X.MOUSE_WHEEL, a.bubbles = !0, c.dispatchEvent(a), a.stopPropagation())
            },
            Qa = n.Mat4.mul;
        m = {
            name: "cc.Node",
            extends: m,
            properties: {
                _opacity: 255,
                _color: cc.Color.WHITE,
                _contentSize: cc.Size,
                _anchorPoint: cc.v2(.5, .5),
                _position: void 0,
                _scale: void 0,
                _trs: null,
                _eulerAngles: cc.Vec3,
                _skewX: 0,
                _skewY: 0,
                _zIndex: {
                    default: void 0,
                    type: cc.Integer
                },
                _localZOrder: {
                    default: 0,
                    serializable: !1
                },
                _is3DNode: !1,
                _groupIndex: {
                    default: 0,
                    formerlySerializedAs: "groupIndex"
                },
                groupIndex: {
                    get: function() {
                        return this._groupIndex
                    },
                    set: function(a) {
                        this._groupIndex = a;
                        k(this);
                        this.emit(X.GROUP_CHANGED, this)
                    }
                },
                group: {
                    get: function() {
                        return cc.game.groupList[this.groupIndex] ||
                            ""
                    },
                    set: function(a) {
                        this.groupIndex = cc.game.groupList.indexOf(a)
                    }
                },
                x: {
                    get: function() {
                        return this._trs[0]
                    },
                    set: function(a) {
                        var d = this._trs;
                        a !== d[0] && (!0, !1, d[0] = a, this.setLocalDirty(ea.ALL_POSITION), this._eventMask & 1 && (!1, this.emit(X.POSITION_CHANGED)))
                    }
                },
                y: {
                    get: function() {
                        return this._trs[1]
                    },
                    set: function(a) {
                        var d = this._trs;
                        a !== d[1] && (!0, !1, d[1] = a, this.setLocalDirty(ea.ALL_POSITION), this._eventMask & 1 && (!1, this.emit(X.POSITION_CHANGED)))
                    }
                },
                z: {
                    get: function() {
                        return this._trs[2]
                    },
                    set: function(a) {
                        var d =
                            this._trs;
                        a !== d[2] && (!0, !1, d[2] = a, this.setLocalDirty(ea.ALL_POSITION), !0, this._renderFlag |= E.FLAG_WORLD_TRANSFORM, this._eventMask & 1 && (!1, this.emit(X.POSITION_CHANGED)))
                    }
                },
                rotation: {
                    get: function() {
                        !0;
                        cc.warn("`cc.Node.rotation` is deprecated since v2.1.0, please use `-angle` instead. (`this.node.rotation` -> `-this.node.angle`)");
                        return -this.angle
                    },
                    set: function(a) {
                        !0;
                        cc.warn("`cc.Node.rotation` is deprecated since v2.1.0, please set `-angle` instead. (`this.node.rotation = x` -> `this.node.angle = -x`)");
                        this.angle = -a
                    }
                },
                angle: {
                    get: function() {
                        return this._eulerAngles.z
                    },
                    set: function(a) {
                        n.Vec3.set(this._eulerAngles, 0, 0, a);
                        n.Trs.fromAngleZ(this._trs, a);
                        this.setLocalDirty(ea.ALL_ROTATION);
                        this._eventMask & 4 && this.emit(X.ROTATION_CHANGED)
                    }
                },
                rotationX: {
                    get: function() {
                        !0;
                        cc.warn("`cc.Node.rotationX` is deprecated since v2.1.0, please use `eulerAngles.x` instead. (`this.node.rotationX` -> `this.node.eulerAngles.x`)");
                        return this._eulerAngles.x
                    },
                    set: function(a) {
                        !0;
                        cc.warn("`cc.Node.rotationX` is deprecated since v2.1.0, please set `eulerAngles` instead. (`this.node.rotationX = x` -> `this.node.is3DNode = true; this.node.eulerAngles = cc.v3(x, 0, 0)`");
                        this._eulerAngles.x !== a && (this._eulerAngles.x = a, this._eulerAngles.x === this._eulerAngles.y ? n.Trs.fromAngleZ(this._trs, -a) : n.Trs.fromEulerNumber(this._trs, a, this._eulerAngles.y, 0), this.setLocalDirty(ea.ALL_ROTATION), this._eventMask & 4 && this.emit(X.ROTATION_CHANGED))
                    }
                },
                rotationY: {
                    get: function() {
                        !0;
                        cc.warn("`cc.Node.rotationY` is deprecated since v2.1.0, please use `eulerAngles.y` instead. (`this.node.rotationY` -> `this.node.eulerAngles.y`)");
                        return this._eulerAngles.y
                    },
                    set: function(a) {
                        !0;
                        cc.warn("`cc.Node.rotationY` is deprecated since v2.1.0, please set `eulerAngles` instead. (`this.node.rotationY = y` -> `this.node.is3DNode = true; this.node.eulerAngles = cc.v3(0, y, 0)`");
                        this._eulerAngles.y !== a && (this._eulerAngles.y = a, this._eulerAngles.x === this._eulerAngles.y ? n.Trs.fromAngleZ(this._trs, -a) : n.Trs.fromEulerNumber(this._trs, this._eulerAngles.x, a, 0), this.setLocalDirty(ea.ALL_ROTATION), this._eventMask & 4 && this.emit(X.ROTATION_CHANGED))
                    }
                },
                eulerAngles: {
                    get: function() {
                        !1;
                        return n.Trs.toEuler(this._eulerAngles, this._trs)
                    },
                    set: function(a) {
                        !1;
                        n.Trs.fromEuler(this._trs, a);
                        this.setLocalDirty(ea.ALL_ROTATION);
                        !0;
                        this._renderFlag |= E.FLAG_TRANSFORM;
                        this._eventMask & 4 && this.emit(X.ROTATION_CHANGED)
                    }
                },
                quat: {
                    get: function() {
                        var a = this._trs;
                        return new n.Quat(a[3], a[4], a[5], a[6])
                    },
                    set: function(a) {
                        this.setRotation(a)
                    }
                },
                scale: {
                    get: function() {
                        return this._trs[7]
                    },
                    set: function(a) {
                        this.setScale(a)
                    }
                },
                scaleX: {
                    get: function() {
                        return this._trs[7]
                    },
                    set: function(a) {
                        this._trs[7] !== a && (this._trs[7] = a, this.setLocalDirty(ea.ALL_SCALE), this._eventMask & 2 && this.emit(X.SCALE_CHANGED))
                    }
                },
                scaleY: {
                    get: function() {
                        return this._trs[8]
                    },
                    set: function(a) {
                        this._trs[8] !== a && (this._trs[8] = a, this.setLocalDirty(ea.ALL_SCALE), this._eventMask &
                            2 && this.emit(X.SCALE_CHANGED))
                    }
                },
                scaleZ: {
                    get: function() {
                        return this._trs[9]
                    },
                    set: function(a) {
                        this._trs[9] !== a && (this._trs[9] = a, this.setLocalDirty(ea.ALL_SCALE), !0, this._renderFlag |= E.FLAG_TRANSFORM, this._eventMask & 2 && this.emit(X.SCALE_CHANGED))
                    }
                },
                skewX: {
                    get: function() {
                        return this._skewX
                    },
                    set: function(a) {
                        Aa(a, this);
                        this._skewX = a;
                        this.setLocalDirty(ea.SKEW);
                        !1
                    }
                },
                skewY: {
                    get: function() {
                        return this._skewY
                    },
                    set: function(a) {
                        Aa(a, this);
                        this._skewY = a;
                        this.setLocalDirty(ea.SKEW);
                        !1
                    }
                },
                opacity: {
                    get: function() {
                        return this._opacity
                    },
                    set: function(a) {
                        a = cc.misc.clampf(a, 0, 255);
                        this._opacity !== a && (this._opacity = a, !1, this._renderFlag |= E.FLAG_OPACITY_COLOR)
                    },
                    range: [0, 255]
                },
                color: {
                    get: function() {
                        return this._color.clone()
                    },
                    set: function(a) {
                        this._color.equals(a) || (this._color.set(a), !1, this._renderFlag |= E.FLAG_COLOR, this._eventMask & 32 && this.emit(X.COLOR_CHANGED, a))
                    }
                },
                anchorX: {
                    get: function() {
                        return this._anchorPoint.x
                    },
                    set: function(a) {
                        var d = this._anchorPoint;
                        d.x !== a && (d.x = a, this._eventMask & 16 && this.emit(X.ANCHOR_CHANGED))
                    }
                },
                anchorY: {
                    get: function() {
                        return this._anchorPoint.y
                    },
                    set: function(a) {
                        var d = this._anchorPoint;
                        d.y !== a && (d.y = a, this._eventMask & 16 && this.emit(X.ANCHOR_CHANGED))
                    }
                },
                width: {
                    get: function() {
                        return this._contentSize.width
                    },
                    set: function(a) {
                        a !== this._contentSize.width && (!1, this._contentSize.width = a, this._eventMask & 8 && (!1, this.emit(X.SIZE_CHANGED)))
                    }
                },
                height: {
                    get: function() {
                        return this._contentSize.height
                    },
                    set: function(a) {
                        a !== this._contentSize.height && (!1, this._contentSize.height = a, this._eventMask & 8 && (!1, this.emit(X.SIZE_CHANGED)))
                    }
                },
                zIndex: {
                    get: function() {
                        return this._localZOrder >>
                            16
                    },
                    set: function(a) {
                        a > v.MAX_ZINDEX ? (cc.warnID(1636), a = v.MAX_ZINDEX) : a < v.MIN_ZINDEX && (cc.warnID(1637), a = v.MIN_ZINDEX);
                        this.zIndex !== a && (this._localZOrder = 65535 & this._localZOrder | a << 16, this.emit(X.SIBLING_ORDER_CHANGED), this._onSiblingIndexChanged())
                    }
                },
                is3DNode: {
                    get: function() {
                        return this._is3DNode
                    },
                    set: function(a) {
                        this._is3DNode = a;
                        this._update3DFunction()
                    }
                },
                up: {
                    get: function() {
                        return n.Vec3.transformQuat(Q, n.Vec3.UP, this.getWorldRotation(R)).clone()
                    }
                },
                right: {
                    get: function() {
                        return n.Vec3.transformQuat(Q,
                            n.Vec3.RIGHT, this.getWorldRotation(R)).clone()
                    }
                },
                forward: {
                    get: function() {
                        return n.Vec3.transformQuat(Q, n.Vec3.FORWARD, this.getWorldRotation(R)).clone()
                    }
                }
            },
            ctor: function() {
                this._reorderChildDirty = !1;
                this._mouseListener = this._touchListener = this._bubblingListeners = this._capturingListeners = this._renderComponent = this._widget = null;
                this._initDataFromPool();
                this._eventMask = 0;
                this._childArrivalOrder = this._cullingMask = 1;
                !1;
                this._renderFlag = E.FLAG_TRANSFORM | E.FLAG_OPACITY_COLOR
            },
            statics: {
                EventType: X,
                _LocalDirtyFlag: ea,
                isNode: function(a) {
                    return a instanceof Da && (a.constructor === Da || !(a instanceof cc.Scene))
                },
                BuiltinGroupIndex: Ba
            },
            _onSiblingIndexChanged: function() {
                this._parent && this._parent._delaySort()
            },
            _onPreDestroy: function() {
                var a = this._onPreDestroyBase();
                x && cc.director.getActionManager().removeAllActionsFromTarget(this);
                ja === this && (ja = null);
                this._bubblingListeners && this._bubblingListeners.clear();
                this._capturingListeners && this._capturingListeners.clear();
                if (this._touchListener || this._mouseListener) u.removeListeners(this),
                    this._touchListener && (this._touchListener.owner = null, this._touchListener = this._touchListener.mask = null), this._mouseListener && (this._mouseListener.owner = null, this._mouseListener = this._mouseListener.mask = null);
                !1;
                this._backDataIntoPool();
                this._reorderChildDirty && cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE, this.sortAllChildren, this);
                a || !1
            },
            _onPostActivated: function(a) {
                var d = x ? cc.director.getActionManager() : null;
                a ? (this._renderFlag |= E.FLAG_WORLD_TRANSFORM, d && d.resumeTarget(this), u.resumeTarget(this),
                    this._checkListenerMask()) : (d && d.pauseTarget(this), u.pauseTarget(this))
            },
            _onHierarchyChanged: function(a) {
                this._updateOrderOfArrival();
                k(this);
                this._parent && this._parent._delaySort();
                this._renderFlag |= E.FLAG_WORLD_TRANSFORM;
                this._onHierarchyChangedBase(a);
                cc._widgetManager && (cc._widgetManager._nodesOrderDirty = !0);
                a && this._activeInHierarchy && this._checkListenerMask();
                !1
            },
            _update3DFunction: function() {
                this._is3DNode ? (this._updateLocalMatrix = c, this._calculWorldMatrix = d, this._mulMat = Qa) : (this._updateLocalMatrix =
                    a, this._calculWorldMatrix = l, this._mulMat = g);
                this._renderComponent && this._renderComponent._on3DNodeChanged && this._renderComponent._on3DNodeChanged();
                this._renderFlag |= E.FLAG_TRANSFORM;
                this._localMatDirty = ea.ALL;
                !1
            },
            _initDataFromPool: function() {
                this._spaceInfo || (!1, !1, this._spaceInfo = t.pop());
                var a = this._spaceInfo;
                this._matrix = cc.mat4(a.localMat);
                n.Mat4.identity(this._matrix);
                this._worldMatrix = cc.mat4(a.worldMat);
                n.Mat4.identity(this._worldMatrix);
                this._localMatDirty = ea.ALL;
                this._worldMatDirty = !0;
                a =
                    this._trs = a.trs;
                a[0] = 0;
                a[1] = 0;
                a[2] = 0;
                a[3] = 0;
                a[4] = 0;
                a[5] = 0;
                a[6] = 1;
                a[7] = 1;
                a[8] = 1;
                a[9] = 1
            },
            _backDataIntoPool: function() {
                !1;
                t.push(this._spaceInfo);
                this._spaceInfo = this._trs = this._worldMatrix = this._matrix = null
            },
            _toEuler: function() {
                this.is3DNode ? n.Trs.toEuler(this._eulerAngles, this._trs) : n.Vec3.set(this._eulerAngles, 0, 0, Math.asin(this._trs[5]) / z * 2)
            },
            _fromEuler: function() {
                this.is3DNode ? n.Trs.fromEuler(this._trs, this._eulerAngles) : n.Trs.fromAngleZ(this._trs, this._eulerAngles.z)
            },
            _initProperties: function() {
                this._is3DNode &&
                    this._update3DFunction();
                var a = this._trs;
                if (a) {
                    var d = a;
                    a = this._trs = this._spaceInfo.trs;
                    11 === d.length ? a.set(d.subarray(1)) : a.set(d)
                } else this._trs = this._spaceInfo.trs;
                !1;
                this._fromEuler();
                !1
            },
            _onBatchCreated: function(a) {
                this._initProperties();
                this._cullingMask = 1 << b(this);
                !1;
                this._activeInHierarchy || (x && cc.director.getActionManager().pauseTarget(this), u.pauseTarget(this));
                for (var d = this._children, c = 0, l = d.length; c < l; c++) {
                    var g = d[c];
                    if (!a) {
                        var n = g._prefab;
                        n && n.sync && n.root === g && w.syncWithPrefab(g);
                        g._updateOrderOfArrival()
                    }
                    g._onBatchCreated(a)
                }
                0 <
                    d.length && (this._renderFlag |= E.FLAG_CHILDREN);
                !1
            },
            _checkListenerMask: function() {
                if (this._touchListener) {
                    var a = this._touchListener.mask = f(this, cc.Mask);
                    this._mouseListener && (this._mouseListener.mask = a)
                } else this._mouseListener && (this._mouseListener.mask = f(this, cc.Mask))
            },
            _checknSetupSysEvent: function(a) {
                var d = !1,
                    c = !1; - 1 !== na.indexOf(a) ? (this._touchListener || (this._touchListener = cc.EventListener.create({
                    event: cc.EventListener.TOUCH_ONE_BY_ONE,
                    swallowTouches: !0,
                    owner: this,
                    mask: f(this, cc.Mask),
                    onTouchBegan: la,
                    onTouchMoved: ta,
                    onTouchEnded: N,
                    onTouchCancelled: T
                }), u.addListener(this._touchListener, this), d = !0), c = !0) : -1 !== ma.indexOf(a) && (this._mouseListener || (this._mouseListener = cc.EventListener.create({
                    event: cc.EventListener.MOUSE,
                    _previousIn: !1,
                    owner: this,
                    mask: f(this, cc.Mask),
                    onMouseDown: pa,
                    onMouseMove: oa,
                    onMouseUp: Ia,
                    onMouseScroll: xa
                }), u.addListener(this._mouseListener, this), d = !0), c = !0);
                d && !this._activeInHierarchy && cc.director.getScheduler().schedule(function() {
                        this._activeInHierarchy || u.pauseTarget(this)
                    },
                    this, 0, 0, 0, !1);
                return c
            },
            on: function(a, d, c, b) {
                if (this._checknSetupSysEvent(a)) return this._onDispatch(a, d, c, b);
                switch (a) {
                    case X.POSITION_CHANGED:
                        this._eventMask |= 1;
                        break;
                    case X.SCALE_CHANGED:
                        this._eventMask |= 2;
                        break;
                    case X.ROTATION_CHANGED:
                        this._eventMask |= 4;
                        break;
                    case X.SIZE_CHANGED:
                        this._eventMask |= 8;
                        break;
                    case X.ANCHOR_CHANGED:
                        this._eventMask |= 16;
                        break;
                    case X.COLOR_CHANGED:
                        this._eventMask |= 32
                }
                this._bubblingListeners || (this._bubblingListeners = new B);
                return this._bubblingListeners.on(a, d, c)
            },
            once: function(a,
                d, c, b) {
                var l = this,
                    g = null;
                g = this._checknSetupSysEvent(a) && b ? this._capturingListeners = this._capturingListeners || new B : this._bubblingListeners = this._bubblingListeners || new B;
                g.once(a, d, c);
                g.once(a, function() {
                    l.off(a, d, c)
                }, void 0)
            },
            _onDispatch: function(a, d, c, b) {
                "boolean" === typeof c ? (b = c, c = void 0) : b = !!b;
                if (d) return b = b ? this._capturingListeners = this._capturingListeners || new B : this._bubblingListeners = this._bubblingListeners || new B, b.hasEventListener(a, d, c) || (b.on(a, d, c), c && c.__eventTargets && c.__eventTargets.push(this)),
                    d;
                cc.errorID(6800)
            },
            off: function(a, d, c, b) {
                var l = -1 !== na.indexOf(a),
                    g = !l && -1 !== ma.indexOf(a);
                if (l || g) this._offDispatch(a, d, c, b), l ? this._touchListener && !e(this, na) && (u.removeListener(this._touchListener), this._touchListener = null) : g && this._mouseListener && !e(this, ma) && (u.removeListener(this._mouseListener), this._mouseListener = null);
                else if (this._bubblingListeners && (this._bubblingListeners.off(a, d, c), !this._bubblingListeners.hasEventListener(a))) switch (a) {
                    case X.POSITION_CHANGED:
                        this._eventMask &= -2;
                        break;
                    case X.SCALE_CHANGED:
                        this._eventMask &= -3;
                        break;
                    case X.ROTATION_CHANGED:
                        this._eventMask &= -5;
                        break;
                    case X.SIZE_CHANGED:
                        this._eventMask &= -9;
                        break;
                    case X.ANCHOR_CHANGED:
                        this._eventMask &= -17;
                        break;
                    case X.COLOR_CHANGED:
                        this._eventMask &= -33
                }
            },
            _offDispatch: function(a, d, c, b) {
                "boolean" === typeof c ? (b = c, c = void 0) : b = !!b;
                if (d) {
                    if (b = b ? this._capturingListeners : this._bubblingListeners) b.off(a, d, c), c && c.__eventTargets && A.array.fastRemove(c.__eventTargets, this)
                } else this._capturingListeners && this._capturingListeners.removeAll(a),
                    this._bubblingListeners && this._bubblingListeners.removeAll(a)
            },
            targetOff: function(a) {
                var d = this._bubblingListeners;
                d && (d.targetOff(a), this._eventMask & 1 && !d.hasEventListener(X.POSITION_CHANGED) && (this._eventMask &= -2), this._eventMask & 2 && !d.hasEventListener(X.SCALE_CHANGED) && (this._eventMask &= -3), this._eventMask & 4 && !d.hasEventListener(X.ROTATION_CHANGED) && (this._eventMask &= -5), this._eventMask & 8 && !d.hasEventListener(X.SIZE_CHANGED) && (this._eventMask &= -9), this._eventMask & 16 && !d.hasEventListener(X.ANCHOR_CHANGED) &&
                    (this._eventMask &= -17), this._eventMask & 32 && !d.hasEventListener(X.COLOR_CHANGED) && (this._eventMask &= -33));
                this._capturingListeners && this._capturingListeners.targetOff(a);
                a && a.__eventTargets && A.array.fastRemove(a.__eventTargets, this);
                this._touchListener && !e(this, na) && (u.removeListener(this._touchListener), this._touchListener = null);
                this._mouseListener && !e(this, ma) && (u.removeListener(this._mouseListener), this._mouseListener = null)
            },
            hasEventListener: function(a) {
                var d = !1;
                this._bubblingListeners && (d = this._bubblingListeners.hasEventListener(a));
                !d && this._capturingListeners && (d = this._capturingListeners.hasEventListener(a));
                return d
            },
            emit: function(a, d, c, b, l, g) {
                this._bubblingListeners && this._bubblingListeners.emit(a, d, c, b, l, g)
            },
            dispatchEvent: function(a) {
                a: {
                    var d;a.target = this;ia.length = 0;this._getCapturingTargets(a.type, ia);a.eventPhase = 1;
                    for (d = ia.length - 1; 0 <= d; --d) {
                        var c = ia[d];
                        if (c._capturingListeners && (a.currentTarget = c, c._capturingListeners.emit(a.type, a, ia), a._propagationStopped)) {
                            ia.length = 0;
                            break a
                        }
                    }
                    ia.length = 0;a.eventPhase = 2;a.currentTarget =
                    this;this._capturingListeners && this._capturingListeners.emit(a.type, a);!a._propagationImmediateStopped && this._bubblingListeners && this._bubblingListeners.emit(a.type, a);
                    if (!a._propagationStopped && a.bubbles)
                        for (this._getBubblingTargets(a.type, ia), a.eventPhase = 3, d = 0; d < ia.length; ++d)
                            if (c = ia[d], c._bubblingListeners && (a.currentTarget = c, c._bubblingListeners.emit(a.type, a), a._propagationStopped)) {
                                ia.length = 0;
                                break a
                            }
                    ia.length = 0
                }
                ia.length = 0
            },
            pauseSystemEvents: function(a) {
                u.pauseTarget(this, a)
            },
            resumeSystemEvents: function(a) {
                u.resumeTarget(this,
                    a)
            },
            _hitTest: function(a, d) {
                var c = this._contentSize.width,
                    b = this._contentSize.height,
                    l = cc.Camera.findCamera(this);
                l ? l.getScreenToWorldPoint(a, fa) : fa.set(a);
                this._updateWorldMatrix();
                if (!n.Mat4.invert(ca, this._worldMatrix)) return !1;
                n.Vec2.transformMat4(ba, fa, ca);
                ba.x += this._anchorPoint.x * c;
                ba.y += this._anchorPoint.y * b;
                a = !1;
                if (0 <= ba.x && 0 <= ba.y && ba.x <= c && ba.y <= b && (a = !0, d && d.mask)) {
                    d = d.mask;
                    c = this;
                    b = d ? d.length : 0;
                    for (var g = l = 0; c && g < b; ++l, c = c.parent) {
                        var p = d[g];
                        if (l === p.index) {
                            if (c !== p.node) {
                                d.length = g;
                                break
                            }
                            if ((p =
                                    c.getComponent(cc.Mask)) && p._enabled && !p._hitTest(fa)) {
                                a = !1;
                                break
                            }
                            g++
                        } else if (l > p.index) {
                            d.length = g;
                            break
                        }
                    }
                }
                return a
            },
            _getCapturingTargets: function(a, d) {
                for (var c = this.parent; c;) c._capturingListeners && c._capturingListeners.hasEventListener(a) && d.push(c), c = c.parent
            },
            _getBubblingTargets: function(a, d) {
                for (var c = this.parent; c;) c._bubblingListeners && c._bubblingListeners.hasEventListener(a) && d.push(c), c = c.parent
            },
            runAction: x ? function(a) {
                if (this.active) {
                    cc.assertID(a, 1618);
                    var d = cc.director.getActionManager();
                    d._suppressDeprecation || (d._suppressDeprecation = !0, cc.warnID(1639));
                    d.addAction(a, this, !1);
                    return a
                }
            } : h,
            pauseAllActions: x ? function() {
                cc.director.getActionManager().pauseTarget(this)
            } : h,
            resumeAllActions: x ? function() {
                cc.director.getActionManager().resumeTarget(this)
            } : h,
            stopAllActions: x ? function() {
                cc.director.getActionManager().removeAllActionsFromTarget(this)
            } : h,
            stopAction: x ? function(a) {
                cc.director.getActionManager().removeAction(a)
            } : h,
            stopActionByTag: x ? function(a) {
                a === cc.Action.TAG_INVALID ? cc.logID(1612) :
                    cc.director.getActionManager().removeActionByTag(a, this)
            } : h,
            getActionByTag: x ? function(a) {
                return a === cc.Action.TAG_INVALID ? (cc.logID(1613), null) : cc.director.getActionManager().getActionByTag(a, this)
            } : function() {
                return null
            },
            getNumberOfRunningActions: x ? function() {
                return cc.director.getActionManager().getNumberOfRunningActionsInTarget(this)
            } : function() {
                return 0
            },
            getPosition: function(a) {
                a = a || new n.Vec3;
                return n.Trs.toPosition(a, this._trs)
            },
            setPosition: function(a, d, c) {
                if (void 0 === d) {
                    var b = a.x;
                    d = a.y;
                    c =
                        a.z
                } else b = a;
                a = this._trs;
                void 0 === c && (c = a[2]);
                if (a[0] !== b || a[1] !== d || a[2] !== c) !1, a[0] = b, a[1] = d, a[2] = c, this.setLocalDirty(ea.ALL_POSITION), !0, this._renderFlag |= E.FLAG_WORLD_TRANSFORM, this._eventMask & 1 && (!1, this.emit(X.POSITION_CHANGED))
            },
            getScale: function(a) {
                if (void 0 !== a) return n.Trs.toScale(a, this._trs);
                cc.errorID(1400, "cc.Node.getScale", "cc.Node.scale or cc.Node.getScale(cc.Vec3)");
                return this._trs[7]
            },
            setScale: function(a, d, c) {
                if (a && "number" !== typeof a) {
                    var b = a.x;
                    d = a.y;
                    c = a.z
                } else void 0 !== a && void 0 ===
                    d ? c = d = b = a : b = a;
                a = this._trs;
                void 0 === c && (c = a[9]);
                if (a[7] !== b || a[8] !== d || a[9] !== c) a[7] = b, a[8] = d, a[9] = c, this.setLocalDirty(ea.ALL_SCALE), !0, this._renderFlag |= E.FLAG_TRANSFORM, this._eventMask & 2 && this.emit(X.SCALE_CHANGED)
            },
            getRotation: function(a) {
                if (a instanceof n.Quat) return n.Trs.toRotation(a, this._trs);
                !0;
                cc.warn("`cc.Node.getRotation()` is deprecated since v2.1.0, please use `-cc.Node.angle` instead. (`this.node.getRotation()` -> `-this.node.angle`)");
                return -this.angle
            },
            setRotation: function(a, d, c,
                b) {
                if ("number" === typeof a && void 0 === d) !0, cc.warn("`cc.Node.setRotation(degree)` is deprecated since v2.1.0, please set `-cc.Node.angle` instead. (`this.node.setRotation(x)` -> `this.node.angle = -x`)"), this.angle = -a;
                else {
                    var l = a;
                    void 0 === d && (l = a.x, d = a.y, c = a.z, b = a.w);
                    a = this._trs;
                    if (a[3] !== l || a[4] !== d || a[5] !== c || a[6] !== b) a[3] = l, a[4] = d, a[5] = c, a[6] = b, this.setLocalDirty(ea.ALL_ROTATION), this._eventMask & 4 && this.emit(X.ROTATION_CHANGED), !1
                }
            },
            getContentSize: function() {
                return cc.size(this._contentSize.width,
                    this._contentSize.height)
            },
            setContentSize: function(a, d) {
                var c = this._contentSize;
                if (void 0 === d) {
                    if (a.width === c.width && a.height === c.height) return;
                    !1;
                    c.width = a.width;
                    c.height = a.height
                } else {
                    if (a === c.width && d === c.height) return;
                    !1;
                    c.width = a;
                    c.height = d
                }
                this._eventMask & 8 && (!1, this.emit(X.SIZE_CHANGED))
            },
            getAnchorPoint: function() {
                return cc.v2(this._anchorPoint)
            },
            setAnchorPoint: function(a, d) {
                var c = this._anchorPoint;
                if (void 0 === d) {
                    if (a.x === c.x && a.y === c.y) return;
                    c.x = a.x;
                    c.y = a.y
                } else {
                    if (a === c.x && d === c.y) return;
                    c.x = a;
                    c.y = d
                }
                this.setLocalDirty(ea.ALL_POSITION);
                this._eventMask & 16 && this.emit(X.ANCHOR_CHANGED)
            },
            _invTransformPoint: function(a, d) {
                this._parent ? this._parent._invTransformPoint(a, d) : n.Vec3.copy(a, d);
                d = this._trs;
                n.Trs.toPosition(F, d);
                n.Vec3.sub(a, a, F);
                n.Trs.toRotation(I, d);
                n.Quat.conjugate(K, I);
                n.Vec3.transformQuat(a, a, K);
                n.Trs.toScale(F, d);
                n.Vec3.inverseSafe(H, F);
                n.Vec3.mul(a, a, H);
                return a
            },
            getWorldPosition: function(a) {
                n.Trs.toPosition(a, this._trs);
                for (var d = this._parent, c; d;) c = d._trs, n.Trs.toScale(C,
                    c), n.Vec3.mul(a, a, C), n.Trs.toRotation(G, c), n.Vec3.transformQuat(a, a, G), n.Trs.toPosition(C, c), n.Vec3.add(a, a, C), d = d._parent;
                return a
            },
            setWorldPosition: function(a) {
                var d = this._trs;
                !1;
                this._parent ? this._parent._invTransformPoint(P, a) : n.Vec3.copy(P, a);
                n.Trs.fromPosition(d, P);
                this.setLocalDirty(ea.ALL_POSITION);
                this._eventMask & 1 && (!1, this.emit(X.POSITION_CHANGED))
            },
            getWorldRotation: function(a) {
                n.Trs.toRotation(W, this._trs);
                n.Quat.copy(a, W);
                for (var d = this._parent; d;) n.Trs.toRotation(W, d._trs), n.Quat.mul(a,
                    W, a), d = d._parent;
                return a
            },
            setWorldRotation: function(a) {
                this._parent ? (this._parent.getWorldRotation(aa), n.Quat.conjugate(aa, aa), n.Quat.mul(aa, aa, a)) : n.Quat.copy(aa, a);
                n.Trs.fromRotation(this._trs, aa);
                !1;
                this.setLocalDirty(ea.ALL_ROTATION)
            },
            getWorldScale: function(a) {
                n.Trs.toScale(S, this._trs);
                n.Vec3.copy(a, S);
                for (var d = this._parent; d;) n.Trs.toScale(S, d._trs), n.Vec3.mul(a, a, S), d = d._parent;
                return a
            },
            setWorldScale: function(a) {
                this._parent ? (this._parent.getWorldScale(M), n.Vec3.div(M, a, M)) : n.Vec3.copy(M,
                    a);
                n.Trs.fromScale(this._trs, M);
                this.setLocalDirty(ea.ALL_SCALE)
            },
            getWorldRT: function(a) {
                var d = this._trs;
                n.Trs.toPosition(O, d);
                n.Trs.toRotation(U, d);
                for (var c = this._parent; c;) d = c._trs, n.Trs.toScale(L, d), n.Vec3.mul(O, O, L), n.Trs.toRotation(V, d), n.Vec3.transformQuat(O, O, V), n.Trs.toPosition(L, d), n.Vec3.add(O, O, L), n.Quat.mul(U, V, U), c = c._parent;
                n.Mat4.fromRT(a, U, O);
                return a
            },
            lookAt: function(a, d) {
                this.getWorldPosition(Z);
                n.Vec3.sub(Z, Z, a);
                n.Vec3.normalize(Z, Z);
                n.Quat.fromViewUp(da, Z, d);
                this.setWorldRotation(da)
            },
            _updateLocalMatrix: a,
            _calculWorldMatrix: function() {
                this._localMatDirty & ea.TRSS && this._updateLocalMatrix();
                var a = this._parent;
                a ? this._mulMat(this._worldMatrix, a._worldMatrix, this._matrix) : n.Mat4.copy(this._worldMatrix, this._matrix);
                this._worldMatDirty = !1
            },
            _mulMat: g,
            _updateWorldMatrix: function() {
                this._parent && this._parent._updateWorldMatrix();
                if (this._worldMatDirty) {
                    this._calculWorldMatrix();
                    for (var a = this._children, d = 0, c = a.length; d < c; d++) a[d]._worldMatDirty = !0
                }
            },
            setLocalDirty: function(a) {
                this._localMatDirty |=
                    a;
                this._worldMatDirty = !0;
                a === ea.ALL_POSITION || a === ea.POSITION ? this._renderFlag |= E.FLAG_WORLD_TRANSFORM : this._renderFlag |= E.FLAG_TRANSFORM
            },
            setWorldDirty: function() {
                this._worldMatDirty = !0
            },
            getLocalMatrix: function(a) {
                this._updateLocalMatrix();
                return n.Mat4.copy(a, this._matrix)
            },
            getWorldMatrix: function(a) {
                this._updateWorldMatrix();
                return n.Mat4.copy(a, this._worldMatrix)
            },
            convertToNodeSpaceAR: function(a, d) {
                this._updateWorldMatrix();
                n.Mat4.invert(ca, this._worldMatrix);
                if (a instanceof cc.Vec2) return d =
                    d || new cc.Vec2, n.Vec2.transformMat4(d, a, ca);
                d = d || new cc.Vec3;
                return n.Vec3.transformMat4(d, a, ca)
            },
            convertToWorldSpaceAR: function(a, d) {
                this._updateWorldMatrix();
                if (a instanceof cc.Vec2) return d = d || new cc.Vec2, n.Vec2.transformMat4(d, a, this._worldMatrix);
                d = d || new cc.Vec3;
                return n.Vec3.transformMat4(d, a, this._worldMatrix)
            },
            convertToNodeSpace: function(a) {
                this._updateWorldMatrix();
                n.Mat4.invert(ca, this._worldMatrix);
                var d = new cc.Vec2;
                n.Vec2.transformMat4(d, a, ca);
                d.x += this._anchorPoint.x * this._contentSize.width;
                d.y += this._anchorPoint.y * this._contentSize.height;
                return d
            },
            convertToWorldSpace: function(a) {
                this._updateWorldMatrix();
                a = new cc.Vec2(a.x - this._anchorPoint.x * this._contentSize.width, a.y - this._anchorPoint.y * this._contentSize.height);
                return n.Vec2.transformMat4(a, a, this._worldMatrix)
            },
            getNodeToParentTransform: function(a) {
                a || (a = p.identity());
                this._updateLocalMatrix();
                var d = this._contentSize;
                ha.x = -this._anchorPoint.x * d.width;
                ha.y = -this._anchorPoint.y * d.height;
                n.Mat4.copy(ca, this._matrix);
                n.Mat4.transform(ca,
                    ca, ha);
                return p.fromMat4(a, ca)
            },
            getNodeToParentTransformAR: function(a) {
                a || (a = p.identity());
                this._updateLocalMatrix();
                return p.fromMat4(a, this._matrix)
            },
            getNodeToWorldTransform: function(a) {
                a || (a = p.identity());
                this._updateWorldMatrix();
                var d = this._contentSize;
                ha.x = -this._anchorPoint.x * d.width;
                ha.y = -this._anchorPoint.y * d.height;
                n.Mat4.copy(ca, this._worldMatrix);
                n.Mat4.transform(ca, ca, ha);
                return p.fromMat4(a, ca)
            },
            getNodeToWorldTransformAR: function(a) {
                a || (a = p.identity());
                this._updateWorldMatrix();
                return p.fromMat4(a,
                    this._worldMatrix)
            },
            getParentToNodeTransform: function(a) {
                a || (a = p.identity());
                this._updateLocalMatrix();
                n.Mat4.invert(ca, this._matrix);
                return p.fromMat4(a, ca)
            },
            getWorldToNodeTransform: function(a) {
                a || (a = p.identity());
                this._updateWorldMatrix();
                n.Mat4.invert(ca, this._worldMatrix);
                return p.fromMat4(a, ca)
            },
            convertTouchToNodeSpace: function(a) {
                return this.convertToNodeSpace(a.getLocation())
            },
            convertTouchToNodeSpaceAR: function(a) {
                return this.convertToNodeSpaceAR(a.getLocation())
            },
            getBoundingBox: function() {
                this._updateLocalMatrix();
                var a = this._contentSize.width,
                    d = this._contentSize.height;
                a = cc.rect(-this._anchorPoint.x * a, -this._anchorPoint.y * d, a, d);
                return a.transformMat4(a, this._matrix)
            },
            getBoundingBoxToWorld: function() {
                return this._parent ? (this._parent._updateWorldMatrix(), this._getBoundingBoxTo()) : this.getBoundingBox()
            },
            _getBoundingBoxTo: function() {
                var a = this._contentSize.width,
                    d = this._contentSize.height;
                a = cc.rect(-this._anchorPoint.x * a, -this._anchorPoint.y * d, a, d);
                this._calculWorldMatrix();
                a.transformMat4(a, this._worldMatrix);
                if (!this._children) return a;
                d = this._children;
                for (var c = 0; c < d.length; c++) {
                    var b = d[c];
                    b && b.active && (b = b._getBoundingBoxTo()) && a.union(a, b)
                }
                return a
            },
            _updateOrderOfArrival: function() {
                var a = this._parent ? ++this._parent._childArrivalOrder : 0;
                this._localZOrder = 4294901760 & this._localZOrder | a;
                this.emit(X.SIBLING_ORDER_CHANGED)
            },
            addChild: function(a, d, c) {
                !1;
                cc.assertID(a, 1606);
                cc.assertID(null === a._parent, 1605);
                a.parent = this;
                void 0 !== d && (a.zIndex = d);
                void 0 !== c && (a.name = c)
            },
            cleanup: function() {
                x && cc.director.getActionManager().removeAllActionsFromTarget(this);
                u.removeListeners(this);
                var a, d = this._children.length,
                    c;
                for (a = 0; a < d; ++a)(c = this._children[a]) && c.cleanup()
            },
            sortAllChildren: function() {
                if (this._reorderChildDirty) {
                    this._reorderChildDirty = !1;
                    var a = this._children;
                    this._childArrivalOrder = 1;
                    for (var d = 0, c = a.length; d < c; d++) {
                        var b = a[d];
                        b._updateOrderOfArrival()
                    }
                    u._setDirtyForNode(this);
                    if (1 < a.length) {
                        var l;
                        d = 1;
                        for (c = a.length; d < c; d++) {
                            b = a[d];
                            for (var g = d; 0 < g && (l = a[g - 1])._localZOrder > b._localZOrder; g--) a[g] = l;
                            a[g] = b
                        }
                        this.emit(X.CHILD_REORDER, this)
                    }
                    cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE,
                        this.sortAllChildren, this)
                }
            },
            _delaySort: function() {
                this._reorderChildDirty || (this._reorderChildDirty = !0, cc.director.__fastOn(cc.Director.EVENT_AFTER_UPDATE, this.sortAllChildren, this))
            },
            _restoreProperties: !1,
            onRestore: !1
        };
        !1;
        var Da = cc.Class(m);
        m = Da.prototype;
        A.getset(m, "position", m.getPosition, m.setPosition, !1, !0);
        !1;
        cc.Node = q.exports = Da
    }, {
        "./event-manager": 149,
        "./event/event": 152,
        "./event/event-target": 151,
        "./platform/CCMacro": 209,
        "./platform/js": 225,
        "./renderer/render-flow": 237,
        "./utils/affine-transform": 277,
        "./utils/base-node": 278,
        "./utils/prefab-helper": 289,
        "./utils/trans-pool": 295,
        "./value-types": 301
    }],
    41: [function(h, q, m) {
        var f = h("./CCNode"),
            e = h("./renderer/render-flow"),
            b = f._LocalDirtyFlag;
        h = cc.Class({
            name: "cc.PrivateNode",
            extends: f,
            properties: {
                x: {
                    get: function() {
                        return this._originPos.x
                    },
                    set: function(b) {
                        var c = this._originPos;
                        b !== c.x && (c.x = b, this._posDirty(!0))
                    },
                    override: !0
                },
                y: {
                    get: function() {
                        return this._originPos.y
                    },
                    set: function(b) {
                        var c = this._originPos;
                        b !== c.y && (c.y = b, this._posDirty(!0))
                    },
                    override: !0
                },
                zIndex: {
                    get: function() {
                        return cc.macro.MIN_ZINDEX
                    },
                    set: function() {},
                    override: !0
                },
                showInEditor: {
                    default: !1,
                    editorOnly: !0,
                    override: !0
                }
            },
            ctor: function(b) {
                this._localZOrder = cc.macro.MIN_ZINDEX << 16;
                this._originPos = cc.v2();
                !1
            },
            _posDirty: function(k) {
                this.setLocalDirty(b.POSITION);
                !0;
                this._renderFlag |= e.FLAG_TRANSFORM;
                !0 === k && this._eventMask & 1 && this.emit(f.EventType.POSITION_CHANGED)
            },
            _updateLocalMatrix: function() {
                if (this._localMatDirty) {
                    var b = this.parent;
                    b && (this._trs[0] = this._originPos.x - (b._anchorPoint.x -
                        .5) * b._contentSize.width, this._trs[1] = this._originPos.y - (b._anchorPoint.y - .5) * b._contentSize.height);
                    this._super()
                }
            },
            getPosition: function() {
                return new cc.Vec2(this._originPos)
            },
            setPosition: function(b, c) {
                void 0 === c && (b = b.x, c = b.y);
                var a = this._originPos;
                if (a.x !== b || a.y !== c) a.x = b, a.y = c, this._posDirty(!0)
            },
            setParent: function(b) {
                var c = this._parent;
                this._super(b);
                c !== b && (c && c.off(f.EventType.ANCHOR_CHANGED, this._posDirty, this), b && b.on(f.EventType.ANCHOR_CHANGED, this._posDirty, this))
            },
            _updateOrderOfArrival: function() {}
        });
        m = h.prototype;
        cc.js.getset(m, "parent", m.getParent, m.setParent);
        cc.js.getset(m, "position", m.getPosition, m.setPosition);
        !1;
        cc.PrivateNode = q.exports = h
    }, {
        "./CCNode": 40,
        "./renderer/render-flow": 237
    }],
    42: [function(h, q, m) {
        cc.Scene = cc.Class({
            name: "cc.Scene",
            extends: h("./CCNode"),
            properties: {
                _is3DNode: {
                    default: !0,
                    override: !0
                },
                autoReleaseAssets: !1
            },
            ctor: function() {
                this._anchorPoint.x = 0;
                this._anchorPoint.y = 0;
                this._activeInHierarchy = !1;
                this._inited = !cc.game._isCloning;
                !1;
                this.dependAssets = null
            },
            destroy: function() {
                if (cc.Object.prototype.destroy.call(this))
                    for (var f =
                            this._children, e = 0; e < f.length; ++e) f[e].active = !1;
                this._activeInHierarchy = this._active = !1
            },
            _onHierarchyChanged: function() {},
            _instantiate: null,
            _load: function() {
                this._inited || (!1, this._onBatchCreated(!1), this._inited = !0)
            },
            _activate: function(f) {
                f = !1 !== f;
                !1;
                !1;
                cc.director._nodeActivator.activateNode(this, f)
            }
        });
        q.exports = cc.Scene
    }, {
        "./CCNode": 40
    }],
    43: [function(h, q, m) {
        function f() {
            this._lock = !1;
            this._scheduler = null;
            this._elapsed = -1;
            this._useDelay = this._runForever = !1;
            this._interval = this._delay = this._repeat =
                this._timesExecuted = 0;
            this._callback = this._target = null
        }
        var e = h("./platform/js"),
            b = new(h("./platform/id-generater"))("Scheduler"),
            k = function(a, d, c, b) {
                this.target = a;
                this.priority = d;
                this.paused = c;
                this.markedForDeletion = b
            },
            c = [];
        k.get = function(a, d, b, l) {
            var g = c.pop();
            g ? (g.target = a, g.priority = d, g.paused = b, g.markedForDeletion = l) : g = new k(a, d, b, l);
            return g
        };
        k.put = function(a) {
            20 > c.length && (a.target = null, c.push(a))
        };
        var a = function(a, d, c, b) {
                this.list = a;
                this.entry = d;
                this.target = c;
                this.callback = b
            },
            d = [];
        a.get = function(c,
            b, l, g) {
            var n = d.pop();
            n ? (n.list = c, n.entry = b, n.target = l, n.callback = g) : n = new a(c, b, l, g);
            return n
        };
        a.put = function(a) {
            20 > d.length && (a.list = a.entry = a.target = a.callback = null, d.push(a))
        };
        var l = function(a, d, c, b, l, g) {
                this.timers = a;
                this.target = d;
                this.timerIndex = c;
                this.currentTimer = b;
                this.currentTimerSalvaged = l;
                this.paused = g
            },
            g = [];
        l.get = function(a, d, c, b, n, k) {
            var p = g.pop();
            p ? (p.timers = a, p.target = d, p.timerIndex = c, p.currentTimer = b, p.currentTimerSalvaged = n, p.paused = k) : p = new l(a, d, c, b, n, k);
            return p
        };
        l.put = function(a) {
            20 >
                g.length && (a.timers = a.target = a.currentTimer = null, g.push(a))
        };
        h = f.prototype;
        h.initWithCallback = function(a, d, c, b, l, g) {
            this._lock = !1;
            this._scheduler = a;
            this._target = c;
            this._callback = d;
            this._elapsed = -1;
            this._interval = b;
            this._delay = g;
            this._useDelay = 0 < this._delay;
            this._repeat = l;
            this._runForever = this._repeat === cc.macro.REPEAT_FOREVER;
            return !0
        };
        h.getInterval = function() {
            return this._interval
        };
        h.setInterval = function(a) {
            this._interval = a
        };
        h.update = function(a) {
            -1 === this._elapsed ? this._timesExecuted = this._elapsed =
                0 : (this._elapsed += a, this._runForever && !this._useDelay ? this._elapsed >= this._interval && (this.trigger(), this._elapsed = 0) : (this._useDelay ? this._elapsed >= this._delay && (this.trigger(), this._elapsed -= this._delay, this._timesExecuted += 1, this._useDelay = !1) : this._elapsed >= this._interval && (this.trigger(), this._elapsed = 0, this._timesExecuted += 1), this._callback && !this._runForever && this._timesExecuted > this._repeat && this.cancel()))
        };
        h.getCallback = function() {
            return this._callback
        };
        h.trigger = function() {
            this._target &&
                this._callback && (this._lock = !0, this._callback.call(this._target, this._elapsed), this._lock = !1)
        };
        h.cancel = function() {
            this._scheduler.unschedule(this._callback, this._target)
        };
        var n = [];
        f.get = function() {
            return n.pop() || new f
        };
        f.put = function(a) {
            20 > n.length && !a._lock && (a._scheduler = a._target = a._callback = null, n.push(a))
        };
        cc.Scheduler = function() {
            this._timeScale = 1;
            this._updatesNegList = [];
            this._updates0List = [];
            this._updatesPosList = [];
            this._hashForUpdates = e.createMap(!0);
            this._hashForTimers = e.createMap(!0);
            this._currentTarget =
                null;
            this._updateHashLocked = this._currentTargetSalvaged = !1;
            this._arrayForTimers = []
        };
        cc.Scheduler.prototype = {
            constructor: cc.Scheduler,
            _removeHashElement: function(a) {
                delete this._hashForTimers[a.target._id];
                for (var d = this._arrayForTimers, c = 0, b = d.length; c < b; c++)
                    if (d[c] === a) {
                        d.splice(c, 1);
                        break
                    }
                l.put(a)
            },
            _removeUpdateFromHash: function(d) {
                d = d.target._id;
                var c = this._hashForUpdates[d];
                if (c) {
                    for (var b = c.list, l = c.entry, g = 0, n = b.length; g < n; g++)
                        if (b[g] === l) {
                            b.splice(g, 1);
                            break
                        }
                    delete this._hashForUpdates[d];
                    k.put(l);
                    a.put(c)
                }
            },
            _priorityIn: function(a, d, c) {
                for (var b = 0; b < a.length; b++)
                    if (c < a[b].priority) {
                        a.splice(b, 0, d);
                        return
                    }
                a.push(d)
            },
            _appendIn: function(a, d) {
                a.push(d)
            },
            enableForTarget: function(a) {
                a._id || (a.__instanceId ? cc.warnID(1513) : a._id = b.getNewId())
            },
            setTimeScale: function(a) {
                this._timeScale = a
            },
            getTimeScale: function() {
                return this._timeScale
            },
            update: function(a) {
                this._updateHashLocked = !0;
                1 !== this._timeScale && (a *= this._timeScale);
                var d;
                var c = 0;
                var b = this._updatesNegList;
                for (d = b.length; c < d; c++) {
                    var l =
                        b[c];
                    l.paused || l.markedForDeletion || l.target.update(a)
                }
                c = 0;
                b = this._updates0List;
                for (d = b.length; c < d; c++) l = b[c], l.paused || l.markedForDeletion || l.target.update(a);
                c = 0;
                b = this._updatesPosList;
                for (d = b.length; c < d; c++) l = b[c], l.paused || l.markedForDeletion || l.target.update(a);
                d = this._arrayForTimers;
                for (c = 0; c < d.length; c++) {
                    this._currentTarget = b = d[c];
                    this._currentTargetSalvaged = !1;
                    if (!b.paused)
                        for (b.timerIndex = 0; b.timerIndex < b.timers.length; ++b.timerIndex) b.currentTimer = b.timers[b.timerIndex], b.currentTimerSalvaged = !1, b.currentTimer.update(a), b.currentTimer = null;
                    this._currentTargetSalvaged && 0 === this._currentTarget.timers.length && (this._removeHashElement(this._currentTarget), --c)
                }
                c = 0;
                for (b = this._updatesNegList; c < b.length;) l = b[c], l.markedForDeletion ? this._removeUpdateFromHash(l) : c++;
                c = 0;
                for (b = this._updates0List; c < b.length;) l = b[c], l.markedForDeletion ? this._removeUpdateFromHash(l) : c++;
                c = 0;
                for (b = this._updatesPosList; c < b.length;) l = b[c], l.markedForDeletion ? this._removeUpdateFromHash(l) : c++;
                this._updateHashLocked = !1;
                this._currentTarget = null
            },
            schedule: function(a, d, c, b, g, n) {
                if ("function" !== typeof a) {
                    var p = a;
                    a = d;
                    d = p
                }
                if (4 === arguments.length || 5 === arguments.length) n = !!b, b = cc.macro.REPEAT_FOREVER, g = 0;
                cc.assertID(d, 1502);
                var k = d._id;
                k || (d.__instanceId ? (cc.warnID(1513), k = d._id = d.__instanceId) : cc.errorID(1510));
                (p = this._hashForTimers[k]) ? p.paused !== n && cc.warnID(1511): (p = l.get(null, d, 0, null, null, n), this._arrayForTimers.push(p), this._hashForTimers[k] = p);
                var t;
                if (null == p.timers) p.timers = [];
                else
                    for (t = 0; t < p.timers.length; ++t)
                        if ((k =
                                p.timers[t]) && a === k._callback) {
                            cc.logID(1507, k.getInterval(), c);
                            k._interval = c;
                            return
                        }
                k = f.get();
                k.initWithCallback(this, a, d, c, b, g);
                p.timers.push(k);
                this._currentTarget === p && this._currentTargetSalvaged && (this._currentTargetSalvaged = !1)
            },
            scheduleUpdate: function(d, c, b) {
                var l = d._id;
                l || (d.__instanceId ? (cc.warnID(1513), l = d._id = d.__instanceId) : cc.errorID(1510));
                var g = this._hashForUpdates[l];
                if (g && g.entry) {
                    if (g.entry.priority === c) {
                        g.entry.markedForDeletion = !1;
                        g.entry.paused = b;
                        return
                    }
                    if (this._updateHashLocked) {
                        cc.logID(1506);
                        g.entry.markedForDeletion = !1;
                        g.entry.paused = b;
                        return
                    }
                    this.unscheduleUpdate(d)
                }
                b = k.get(d, c, b, !1);
                0 === c ? (g = this._updates0List, this._appendIn(g, b)) : (g = 0 > c ? this._updatesNegList : this._updatesPosList, this._priorityIn(g, b, c));
                this._hashForUpdates[l] = a.get(g, b, d, null)
            },
            unschedule: function(a, d) {
                if (d && a) {
                    var c = d._id;
                    c || (d.__instanceId ? (cc.warnID(1513), c = d._id = d.__instanceId) : cc.errorID(1510));
                    if (d = this._hashForTimers[c]) {
                        c = d.timers;
                        for (var b = 0, l = c.length; b < l; b++) {
                            var g = c[b];
                            if (a === g._callback) {
                                g !== d.currentTimer ||
                                    d.currentTimerSalvaged || (d.currentTimerSalvaged = !0);
                                c.splice(b, 1);
                                f.put(g);
                                d.timerIndex >= b && d.timerIndex--;
                                0 === c.length && (this._currentTarget === d ? this._currentTargetSalvaged = !0 : this._removeHashElement(d));
                                break
                            }
                        }
                    }
                }
            },
            unscheduleUpdate: function(a) {
                if (a) {
                    var d = a._id;
                    d || (a.__instanceId ? (cc.warnID(1513), d = a._id = a.__instanceId) : cc.errorID(1510));
                    (a = this._hashForUpdates[d]) && (this._updateHashLocked ? a.entry.markedForDeletion = !0 : this._removeUpdateFromHash(a.entry))
                }
            },
            unscheduleAllForTarget: function(a) {
                if (a) {
                    var d =
                        a._id;
                    d || (a.__instanceId ? (cc.warnID(1513), d = a._id = a.__instanceId) : cc.errorID(1510));
                    if (d = this._hashForTimers[d]) {
                        var c = d.timers; - 1 < c.indexOf(d.currentTimer) && !d.currentTimerSalvaged && (d.currentTimerSalvaged = !0);
                        for (var b = 0, l = c.length; b < l; b++) f.put(c[b]);
                        c.length = 0;
                        this._currentTarget === d ? this._currentTargetSalvaged = !0 : this._removeHashElement(d)
                    }
                    this.unscheduleUpdate(a)
                }
            },
            unscheduleAll: function() {
                this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)
            },
            unscheduleAllWithMinPriority: function(a) {
                var d,
                    c = this._arrayForTimers;
                for (d = c.length - 1; 0 <= d; d--) {
                    var b = c[d];
                    this.unscheduleAllForTarget(b.target)
                }
                if (0 > a)
                    for (d = 0; d < this._updatesNegList.length;) c = this._updatesNegList.length, (b = this._updatesNegList[d]) && b.priority >= a && this.unscheduleUpdate(b.target), c == this._updatesNegList.length && d++;
                if (0 >= a)
                    for (d = 0; d < this._updates0List.length;) c = this._updates0List.length, (b = this._updates0List[d]) && this.unscheduleUpdate(b.target), c == this._updates0List.length && d++;
                for (d = 0; d < this._updatesPosList.length;) c = this._updatesPosList.length,
                    (b = this._updatesPosList[d]) && b.priority >= a && this.unscheduleUpdate(b.target), c == this._updatesPosList.length && d++
            },
            isScheduled: function(a, d) {
                cc.assertID(a, 1508);
                cc.assertID(d, 1509);
                var c = d._id;
                c || (d.__instanceId ? (cc.warnID(1513), c = d._id = d.__instanceId) : cc.errorID(1510));
                d = this._hashForTimers[c];
                if (!d || null == d.timers) return !1;
                d = d.timers;
                for (c = 0; c < d.length; ++c)
                    if (a === d[c]._callback) return !0;
                return !1
            },
            pauseAllTargets: function() {
                return this.pauseAllTargetsWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)
            },
            pauseAllTargetsWithMinPriority: function(a) {
                var d = [],
                    c, b = this._arrayForTimers,
                    l;
                var g = 0;
                for (l = b.length; g < l; g++)
                    if (c = b[g]) c.paused = !0, d.push(c.target);
                if (0 > a)
                    for (g = 0; g < this._updatesNegList.length; g++)(c = this._updatesNegList[g]) && c.priority >= a && (c.paused = !0, d.push(c.target));
                if (0 >= a)
                    for (g = 0; g < this._updates0List.length; g++)
                        if (c = this._updates0List[g]) c.paused = !0, d.push(c.target);
                for (g = 0; g < this._updatesPosList.length; g++)(c = this._updatesPosList[g]) && c.priority >= a && (c.paused = !0, d.push(c.target));
                return d
            },
            resumeTargets: function(a) {
                if (a)
                    for (var d = 0; d < a.length; d++) this.resumeTarget(a[d])
            },
            pauseTarget: function(a) {
                cc.assertID(a, 1503);
                var d = a._id;
                d || (a.__instanceId ? (cc.warnID(1513), d = a._id = a.__instanceId) : cc.errorID(1510));
                (a = this._hashForTimers[d]) && (a.paused = !0);
                (d = this._hashForUpdates[d]) && (d.entry.paused = !0)
            },
            resumeTarget: function(a) {
                cc.assertID(a, 1504);
                var d = a._id;
                d || (a.__instanceId ? (cc.warnID(1513), d = a._id = a.__instanceId) : cc.errorID(1510));
                (a = this._hashForTimers[d]) && (a.paused = !1);
                (d = this._hashForUpdates[d]) &&
                (d.entry.paused = !1)
            },
            isTargetPaused: function(a) {
                cc.assertID(a, 1505);
                var d = a._id;
                d || (a.__instanceId ? (cc.warnID(1513), d = a._id = a.__instanceId) : cc.errorID(1510));
                return (a = this._hashForTimers[d]) ? a.paused : (d = this._hashForUpdates[d]) ? d.entry.paused : !1
            }
        };
        cc.Scheduler.PRIORITY_SYSTEM = -2147483648;
        cc.Scheduler.PRIORITY_NON_SYSTEM = cc.Scheduler.PRIORITY_SYSTEM + 1;
        q.exports = cc.Scheduler
    }, {
        "./platform/id-generater": 221,
        "./platform/js": 225
    }],
    44: [function(h, q, m) {
        function f() {
            this._preprocessPipe = e;
            this._fetchPipe =
                b;
            this._loadPipe = d;
            this.pipeline = H.append(e).append(d);
            this.fetchPipeline = K.append(e).append(b);
            this.transformPipeline = I.append(E).append(y);
            this.bundles = S;
            this.assets = C;
            this._files = G;
            this._parsed = F;
            this.generalNativeBase = this.generalImportBase = "";
            this.dependUtil = a;
            this._releaseManager = c;
            this.cacheAsset = !0;
            this.force = !1;
            this.utils = k;
            this.downloader = w;
            this.parser = t;
            this.builtins = v;
            this.packManager = p;
            this.factory = A;
            this.cacheManager = null;
            this.presets = {
                default: {
                    priority: 0
                },
                preload: {
                    maxConcurrency: 2,
                    maxRequestsPerFrame: 2,
                    priority: -1
                },
                scene: {
                    maxConcurrency: 8,
                    maxRequestsPerFrame: 8,
                    priority: 1
                },
                bundle: {
                    maxConcurrency: 8,
                    maxRequestsPerFrame: 8,
                    priority: 2
                },
                remote: {
                    maxRetryCount: 4
                },
                script: {
                    maxConcurrency: 1024,
                    maxRequestsPerFrame: 1024,
                    priority: 2
                }
            }
        }
        var e = h("./preprocess"),
            b = h("./fetch");
        m = h("./cache");
        var k = h("./helper"),
            c = h("./releaseManager"),
            a = h("./depend-util"),
            d = h("./load"),
            l = h("./pipeline"),
            g = h("./task"),
            n = h("./request-item"),
            w = h("./downloader"),
            t = h("./parser"),
            p = h("./pack-manager"),
            u = h("./bundle"),
            v = h("./builtins"),
            A = h("./factory"),
            B = h("./urlTransformer"),
            E = B.parse,
            y = B.combine;
        B = h("./utilities");
        var z = B.parseParameters,
            x = B.asyncify;
        h = h("./shared");
        var C = h.assets,
            G = h.files,
            F = h.parsed,
            H = h.pipeline,
            I = h.transformPipeline,
            K = h.fetchPipeline,
            P = h.RequestType,
            S = h.bundles,
            M = h.BuiltinBundleName;
        f.Pipeline = l;
        f.Task = g;
        f.Cache = m;
        f.RequestItem = n;
        f.Bundle = u;
        f.BuiltinBundleName = M;
        f.prototype = {
            constructor: f,
            get main() {
                return S.get(M.MAIN)
            },
            get resources() {
                return S.get(M.RESOURCES)
            },
            get internal() {
                return S.get(M.INTERNAL)
            },
            init: function(a) {
                a = a || Object.create(null);
                this._files.clear();
                this._parsed.clear();
                this._releaseManager.init();
                this.assets.clear();
                this.bundles.clear();
                this.packManager.init();
                this.downloader.init(a.bundleVers, a.server);
                this.parser.init();
                this.dependUtil.init();
                this.generalImportBase = a.importBase;
                this.generalNativeBase = a.nativeBase
            },
            getBundle: function(a) {
                return S.get(a)
            },
            removeBundle: function(a) {
                a._destroy();
                S.remove(a.name)
            },
            loadAny: function(a, d, c, b) {
                b = z(d, c, b);
                d = b.options;
                c = b.onProgress;
                b = b.onComplete;
                d.preset = d.preset || "default";
                a = Array.isArray(a) ? a.concat() : a;
                a = new g({
                    input: a,
                    onProgress: c,
                    onComplete: x(b),
                    options: d
                });
                H.async(a)
            },
            preloadAny: function(a, d, c, b) {
                b = z(d, c, b);
                d = b.options;
                c = b.onProgress;
                b = b.onComplete;
                d.preset = d.preset || "preload";
                a = Array.isArray(a) ? a.concat() : a;
                a = new g({
                    input: a,
                    onProgress: c,
                    onComplete: x(b),
                    options: d
                });
                K.async(a)
            },
            postLoadNative: function(d, c, b) {
                if (!(d instanceof cc.Asset)) throw Error("input is not asset");
                var l = z(c, void 0, b);
                c = l.options;
                b = l.onComplete;
                if (!d._native || d._nativeAsset) return x(b)(null);
                if (l = a.getNativeDep(d._uuid)) {
                    if (!S.has(l.bundle)) {
                        var g = S.find(function(a) {
                            return a.getAssetInfo(d._uuid)
                        });
                        g && (l.bundle = g.name)
                    }
                    this.loadAny(l, c, function(a, c) {
                        a ? cc.error(a.message, a.stack) : !d._nativeAsset && (d._nativeAsset = c);
                        b && b(a)
                    })
                }
            },
            loadRemote: function(a, d, c) {
                var b = z(d, void 0, c);
                d = b.options;
                c = b.onComplete;
                if (this.assets.has(a)) return x(c)(null, this.assets.get(a));
                d.__isNative__ = !0;
                d.preset = d.preset || "remote";
                this.loadAny({
                    url: a
                }, d, null, function(b, l) {
                    b ? (cc.error(b.message, b.stack), c && c(b, null)) :
                        A.create(a, l, d.ext || cc.path.extname(a), d, function(a, d) {
                            c && c(a, d)
                        })
                })
            },
            loadScript: function(a, d, c) {
                c = z(d, void 0, c);
                d = c.options;
                c = c.onComplete;
                d.__requestType__ = P.URL;
                d.preset = d.preset || "script";
                this.loadAny(a, d, c)
            },
            loadBundle: function(a, d, c) {
                c = z(d, void 0, c);
                d = c.options;
                c = c.onComplete;
                var b = cc.path.basename(a);
                if (this.bundles.has(b)) return x(c)(null, this.getBundle(b));
                d.preset = d.preset || "bundle";
                d.ext = "bundle";
                this.loadRemote(a, d, c)
            },
            releaseAsset: function(a) {
                c.tryRelease(a, !0)
            },
            releaseUnusedAssets: function() {
                C.forEach(function(a) {
                    c.tryRelease(a)
                })
            },
            releaseAll: function() {
                C.forEach(function(a) {
                    c.tryRelease(a, !0)
                })
            },
            _transform: function(a, d) {
                a = g.create({
                    input: a,
                    options: d
                });
                d = [];
                try {
                    for (var c = I.sync(a), b = 0, l = c.length; b < l; b++) {
                        var n = c[b],
                            k = n.url;
                        n.recycle();
                        d.push(k)
                    }
                } catch (R) {
                    b = 0;
                    for (l = a.output.length; b < l; b++) a.output[b].recycle();
                    cc.error(R.message, R.stack)
                }
                a.recycle();
                return 1 < d.length ? d : d[0]
            }
        };
        cc.AssetManager = f;
        cc.assetManager = new f;
        Object.defineProperty(cc, "resources", {
            get: function() {
                return S.get(M.RESOURCES)
            }
        });
        q.exports = cc.assetManager
    }, {
        "./builtins": 45,
        "./bundle": 46,
        "./cache": 47,
        "./depend-util": 49,
        "./downloader": 56,
        "./factory": 57,
        "./fetch": 58,
        "./helper": 60,
        "./load": 62,
        "./pack-manager": 63,
        "./parser": 64,
        "./pipeline": 65,
        "./preprocess": 66,
        "./releaseManager": 67,
        "./request-item": 68,
        "./shared": 69,
        "./task": 70,
        "./urlTransformer": 71,
        "./utilities": 72
    }],
    45: [function(h, q, m) {
        m = h("./cache");
        var f = h("./releaseManager"),
            e = h("./shared").BuiltinBundleName;
        h = {
            _assets: new m({
                material: new m,
                effect: new m
            }),
            _loadBuiltins: function(b, k) {
                var c = b + "s",
                    a = this._assets.get(b);
                return cc.assetManager.internal.loadDir(c, null, null, function(d, c) {
                    if (d) cc.error(d.message, d.stack);
                    else
                        for (d = 0; d < c.length; d++) {
                            var b = c[d];
                            a.add(b.name, b.addRef())
                        }
                    k()
                })
            },
            init: function(b) {
                var k = this;
                this.clear();
                if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS || !cc.assetManager.bundles.has(e.INTERNAL)) return b && b();
                this._loadBuiltins("effect", function() {
                    k._loadBuiltins("material", b)
                })
            },
            getBuiltin: function(b, k) {
                return 0 === arguments.length ? this._assets : 1 === arguments.length ? this._assets.get(b) : this._assets.get(b).get(k)
            },
            clear: function() {
                this._assets.forEach(function(b) {
                    b.forEach(function(b) {
                        f.tryRelease(b, !0)
                    });
                    b.clear()
                })
            }
        };
        q.exports = h
    }, {
        "./cache": 47,
        "./releaseManager": 67,
        "./shared": 69
    }],
    46: [function(h, q, m) {
        function f() {
            this._config = new e
        }
        var e = h("./config"),
            b = h("./releaseManager");
        m = h("./utilities");
        var k = m.parseParameters,
            c = m.parseLoadResArgs;
        h = h("./shared");
        var a = h.RequestType,
            d = h.assets,
            l = h.bundles;
        f.prototype = {
            constructor: f,
            get name() {
                return this._config.name
            },
            get deps() {
                return this._config.deps
            },
            get base() {
                return this._config.base
            },
            getInfoWithPath: function(a, d) {
                return this._config.getInfoWithPath(a, d)
            },
            getDirWithPath: function(a, d, c) {
                return this._config.getDirWithPath(a, d, c)
            },
            getAssetInfo: function(a) {
                return this._config.getAssetInfo(a)
            },
            getSceneInfo: function(a) {
                return this._config.getSceneInfo(a)
            },
            init: function(a) {
                this._config.init(a);
                l.add(a.name, this)
            },
            load: function(d, b, l, k) {
                k = c(b, l, k);
                b = k.type;
                l = k.onProgress;
                k = k.onComplete;
                cc.assetManager.loadAny(d, {
                        __requestType__: a.PATH,
                        type: b,
                        bundle: this.name,
                        __outputAsArray__: Array.isArray(d)
                    },
                    l, k)
            },
            preload: function(d, b, l, k) {
                k = c(b, l, k);
                b = k.type;
                l = k.onProgress;
                k = k.onComplete;
                cc.assetManager.preloadAny(d, {
                    __requestType__: a.PATH,
                    type: b,
                    bundle: this.name
                }, l, k)
            },
            loadDir: function(d, b, l, k) {
                k = c(b, l, k);
                b = k.type;
                l = k.onProgress;
                k = k.onComplete;
                cc.assetManager.loadAny(d, {
                    __requestType__: a.DIR,
                    type: b,
                    bundle: this.name,
                    __outputAsArray__: !0
                }, l, k)
            },
            preloadDir: function(d, b, l, k) {
                k = c(b, l, k);
                b = k.type;
                l = k.onProgress;
                k = k.onComplete;
                cc.assetManager.preloadAny(d, {
                        __requestType__: a.DIR,
                        type: b,
                        bundle: this.name
                    }, l,
                    k)
            },
            loadScene: function(a, d, c, b) {
                var l = k(d, c, b);
                d = l.options;
                c = l.onProgress;
                b = l.onComplete;
                d.preset = d.preset || "scene";
                d.bundle = this.name;
                cc.assetManager.loadAny({
                    scene: a
                }, d, c, function(a, d) {
                    a ? (cc.error(a.message, a.stack), b && b(a)) : d instanceof cc.SceneAsset ? (a = d.scene, a._id = d._uuid, a._name = d._name, b && b(null, d)) : b && b(Error("The asset " + d._uuid + " is not a scene"))
                })
            },
            preloadScene: function(a, d, c, b) {
                var l = k(d, c, b);
                d = l.options;
                c = l.onProgress;
                b = l.onComplete;
                d.bundle = this.name;
                cc.assetManager.preloadAny({
                        scene: a
                    },
                    d, c,
                    function(d) {
                        d && cc.errorID(1210, a, d.message);
                        b && b(d)
                    })
            },
            get: function(a, c) {
                a = this.getInfoWithPath(a, c);
                return d.get(a && a.uuid)
            },
            release: function(a, d) {
                b.tryRelease(this.get(a, d), !0)
            },
            releaseUnusedAssets: function() {
                var a = this;
                d.forEach(function(d) {
                    var c = a.getAssetInfo(d._uuid);
                    c && !c.redirect && b.tryRelease(d)
                })
            },
            releaseAll: function() {
                var a = this;
                d.forEach(function(d) {
                    var c = a.getAssetInfo(d._uuid);
                    c && !c.redirect && b.tryRelease(d, !0)
                })
            },
            _destroy: function() {
                this._config.destroy()
            }
        };
        q.exports = f
    }, {
        "./config": 48,
        "./releaseManager": 67,
        "./shared": 69,
        "./utilities": 72
    }],
    47: [function(h, q, m) {
        function f(b) {
            b ? (this._map = b, this._count = Object.keys(b).length) : (this._map = e.createMap(!0), this._count = 0)
        }
        var e = h("../platform/js");
        f.prototype = {
            constructor: f,
            add: function(b, k) {
                b in this._map || this._count++;
                return this._map[b] = k
            },
            get: function(b) {
                return this._map[b]
            },
            has: function(b) {
                return b in this._map
            },
            remove: function(b) {
                var k = this._map[b];
                b in this._map && (delete this._map[b], this._count--);
                return k
            },
            clear: function() {
                0 !==
                    this._count && (this._map = e.createMap(!0), this._count = 0)
            },
            forEach: function(b) {
                for (var k in this._map) b(this._map[k], k)
            },
            find: function(b) {
                for (var k in this._map)
                    if (b(this._map[k], k)) return this._map[k];
                return null
            },
            get count() {
                return this._count
            },
            destroy: function() {
                this._map = null
            }
        };
        q.exports = f
    }, {
        "../platform/js": 225
    }],
    48: [function(h, q, m) {
        function f() {
            this.nativeBase = this.importBase = this.base = this.name = "";
            this.deps = null;
            this.assetInfos = new b;
            this.scenes = new b;
            this.paths = new b
        }
        var e = h("../platform/js"),
            b = h("./cache"),
            k = h("./helper").normalize,
            c = h("./utilities").processOptions;
        f.prototype = {
            constructor: f,
            init: function(a) {
                c(a);
                this.importBase = a.importBase || "";
                this.nativeBase = a.nativeBase || "";
                this.base = a.base || "";
                this.name = a.name || "";
                this.deps = a.deps || [];
                this._initUuid(a.uuids);
                this._initPath(a.paths);
                this._initScene(a.scenes);
                this._initPackage(a.packs);
                this._initVersion(a.versions);
                this._initRedirect(a.redirect)
            },
            _initUuid: function(a) {
                if (a) {
                    this.assetInfos.clear();
                    for (var d = 0, c = a.length; d < c; d++) {
                        var b =
                            a[d];
                        this.assetInfos.add(b, {
                            uuid: b
                        })
                    }
                }
            },
            _initPath: function(a) {
                if (a) {
                    var d = this.paths;
                    d.clear();
                    for (var c in a) {
                        var b = a[c],
                            n = b[0],
                            k = b[1];
                        b = 3 === b.length;
                        var t = this.assetInfos.get(c);
                        t.path = n;
                        t.ctor = e._getClassById(k);
                        d.has(n) ? b ? d.get(n).push(t) : d.get(n).splice(0, 0, t) : d.add(n, [t])
                    }
                }
            },
            _initScene: function(a) {
                if (a) {
                    var d = this.scenes;
                    d.clear();
                    var c = this.assetInfos,
                        b;
                    for (b in a) {
                        var n = c.get(a[b]);
                        n.url = b;
                        d.add(b, n)
                    }
                }
            },
            _initPackage: function(a) {
                if (a) {
                    var d = this.assetInfos,
                        c;
                    for (c in a) {
                        var b = a[c],
                            n = {
                                uuid: c,
                                packs: b,
                                ext: ".json"
                            };
                        d.add(c, n);
                        for (var k = 0, e = b.length; k < e; k++) {
                            var p = d.get(b[k]),
                                u = p.packs;
                            u ? 1 === e ? u.splice(0, 0, n) : u.push(n) : p.packs = [n]
                        }
                    }
                }
            },
            _initVersion: function(a) {
                if (a) {
                    var d = this.assetInfos,
                        c = a["import"];
                    if (c)
                        for (var b = 0, n = c.length; b < n; b += 2) {
                            var k = c[b];
                            k = d.get(k);
                            k.ver = c[b + 1]
                        }
                    if (c = a["native"])
                        for (b = 0, n = c.length; b < n; b += 2) k = c[b], k = d.get(k), k.nativeVer = c[b + 1]
                }
            },
            _initRedirect: function(a) {
                if (a)
                    for (var d = this.assetInfos, c = 0, b = a.length; c < b; c += 2) d.get(a[c]).redirect = a[c + 1]
            },
            getInfoWithPath: function(a,
                d) {
                if (!a) return null;
                a = k(a);
                if (a = this.paths.get(a)) {
                    if (!d) return a[0];
                    for (var c = 0, b = a.length; c < b; c++) {
                        var n = a[c];
                        if (e.isChildClassOf(n.ctor, d)) return n
                    }
                }
                return null
            },
            getDirWithPath: function(a, d, c) {
                a = k(a);
                "/" === a[a.length - 1] && (a = a.slice(0, -1));
                var b = c || [];
                this.paths.forEach(function(c, l) {
                    var g;
                    if (g = l.startsWith(a)) g = l.length > a.length ? 47 === l.charCodeAt(a.length) : !0;
                    if (g || !a)
                        for (l = 0, g = c.length; l < g; l++) {
                            var n = c[l];
                            d && !e.isChildClassOf(n.ctor, d) || b.push(n)
                        }
                });
                return b
            },
            getAssetInfo: function(a) {
                return this.assetInfos.get(a)
            },
            getSceneInfo: function(a) {
                a.endsWith(".fire") || (a += ".fire");
                "/" === a[0] || a.startsWith("db://") || (a = "/" + a);
                return this.scenes.find(function(d, c) {
                    return c.endsWith(a)
                })
            },
            destroy: function() {
                this.paths.destroy();
                this.scenes.destroy();
                this.assetInfos.destroy()
            }
        };
        !1;
        q.exports = f
    }, {
        "../platform/js": 225,
        "./cache": 47,
        "./helper": 60,
        "./utilities": 72
    }],
    49: [function(h, q, m) {
        function f() {
            if ("function" !== typeof WeakMap) return null;
            var a = new WeakMap;
            f = function() {
                return a
            };
            return a
        }
        var e = function(a) {
            if (a && a.__esModule) return a;
            if (null === a || "object" !== typeof a && "function" !== typeof a) return {
                default: a
            };
            var d = f();
            if (d && d.has(a)) return d.get(a);
            var c = {},
                b = Object.defineProperty && Object.getOwnPropertyDescriptor,
                n;
            for (n in a)
                if (Object.prototype.hasOwnProperty.call(a, n)) {
                    var k = b ? Object.getOwnPropertyDescriptor(a, n) : null;
                    k && (k.get || k.set) ? Object.defineProperty(c, n, k) : c[n] = a[n]
                }
            c["default"] = a;
            d && d.set(a, c);
            return c
        }(h("../platform/deserialize-compiled"));
        m = h("./cache");
        var b = h("./deserialize");
        h = h("./shared");
        var k = h.files,
            c = h.parsed;
        h = {
            _depends: new m,
            init: function() {
                this._depends.clear()
            },
            getNativeDep: function(a) {
                return (a = this._depends.get(a)) ? a.nativeDep && Object.assign({}, a.nativeDep) : null
            },
            getDeps: function(a) {
                return this._depends.has(a) ? this._depends.get(a).deps : []
            },
            getDepsRecursively: function(a) {
                var d = Object.create(null),
                    c = [];
                this._descend(a, d, c);
                return c
            },
            _descend: function(a, d, c) {
                a = this.getDeps(a);
                for (var b = 0; b < a.length; b++) {
                    var l = a[b];
                    d[l] || (d[l] = !0, c.push(l), this._descend(l, d, c))
                }
            },
            remove: function(a) {
                this._depends.remove(a)
            },
            parse: function(a, d) {
                var l = null;
                if (Array.isArray(d) || d.__type__) {
                    if (l = this._depends.get(a)) return l;
                    if (Array.isArray(d) && (!1, !(0, e.hasNativeDep)(d))) l = {
                        deps: this._parseDepsFromJson(d)
                    };
                    else try {
                        var g = b(d);
                        l = this._parseDepsFromAsset(g);
                        l.nativeDep && (l.nativeDep.uuid = a);
                        c.add(a + "@import", g)
                    } catch (n) {
                        k.remove(a + "@import"), l = {
                            deps: []
                        }
                    }
                } else {
                    if ((!0, l = this._depends.get(a)) && l.parsedFromExistAsset) return l;
                    l = this._parseDepsFromAsset(d)
                }
                this._depends.add(a, l);
                return l
            },
            _parseDepsFromAsset: function(a) {
                for (var d = {
                        deps: [],
                        parsedFromExistAsset: !0,
                        preventPreloadNativeObject: a.constructor.preventPreloadNativeObject,
                        preventDeferredLoadDependents: a.constructor.preventDeferredLoadDependents
                    }, c = a.__depends__, b = 0, n = c.length; b < n; b++) d.deps.push(c[b].uuid);
                a.__nativeDepend__ && (d.nativeDep = a._nativeDep);
                return d
            },
            _parseDepsFromJson: (!1, function(a) {
                var d = (0, e.getDependUuidList)(a);
                d.forEach(function(a, c) {
                    return d[c] = cc.assetManager.utils.decodeUuid(a)
                });
                return d
            })
        };
        q.exports = h
    }, {
        "../platform/deserialize-compiled": 219,
        "./cache": 47,
        "./deserialize": 51,
        "./shared": 69
    }],
    50: [function(h, q, m) {
        function f() {
            return !0
        }
        q = h("../platform/js");
        h("../CCDirector");
        m = h("./utilities");
        var e = h("./depend-util"),
            b = h("./releaseManager"),
            k = h("./downloader"),
            c = h("./factory"),
            a = ".png .jpg .bmp .jpeg .gif .ico .tiff .webp .image .pvr .pkm".split(" "),
            d = [".mp3", ".ogg", ".wav", ".m4a"],
            l = {
                transformURL: function(a) {
                    return a = a.replace(/.*[\/\\][0-9a-fA-F]{2}[\/\\]([0-9a-fA-F-]{8,})/, function(d, c) {
                        var b = cc.assetManager.bundles.find(function(a) {
                                return a.getAssetInfo(c)
                            }),
                            l = "";
                        b && (l = b.getAssetInfo(c), l = a.startsWith(b.base + b._config.nativeBase) ? l.nativeVer : l.ver);
                        return l ? d + "." + l : d
                    })
                }
            },
            g = {
                onProgress: null,
                _autoReleaseSetting: Object.create(null),
                get _cache() {
                    return cc.assetManager.assets._map
                },
                load: function(b, l, g) {
                    void 0 === g && void 0 !== l && (g = l, l = null);
                    b = Array.isArray(b) ? b : [b];
                    for (var n = 0; n < b.length; n++) {
                        var k = b[n];
                        "string" === typeof k ? b[n] = {
                            url: k,
                            __isNative__: !0
                        } : (k.type && (k.ext = "." + k.type, k.type = void 0), k.url && (k.__isNative__ = !0))
                    }
                    var p = [],
                        e = [];
                    cc.assetManager.loadAny(b,
                        null,
                        function(c, b, g) {
                            g.content && (a.includes(g.ext) ? p.push(g.content) : d.includes(g.ext) && e.push(g.content));
                            l && l(c, b, g)
                        },
                        function(a, d) {
                            var l = null;
                            if (!a) {
                                d = Array.isArray(d) ? d : [d];
                                for (var n = 0; n < d.length; n++)
                                    if (l = d[n], !(l instanceof cc.Asset)) {
                                        var k = l,
                                            t = b[n].url;
                                        p.includes(k) ? c.create(t, l, ".png", null, function(a, c) {
                                            k = d[n] = c
                                        }) : e.includes(k) && c.create(t, l, ".mp3", null, function(a, c) {
                                            k = d[n] = c
                                        });
                                        cc.assetManager.assets.add(t, k)
                                    }
                                if (1 < d.length) {
                                    var u = Object.create(null);
                                    d.forEach(function(a) {
                                        u[a._uuid] = a
                                    });
                                    l = {
                                        isCompleted: f,
                                        _map: u
                                    }
                                } else l = d[0]
                            }
                            g && g(a, l)
                        })
                },
                getXMLHttpRequest: function() {
                    return new XMLHttpRequest
                },
                _parseLoadResArgs: m.parseLoadResArgs,
                getItem: function(a) {
                    return cc.assetManager.assets.has(a) ? {
                        content: cc.assetManager.assets.get(a)
                    } : null
                },
                loadRes: function(a, d, c, b) {
                    b = this._parseLoadResArgs(d, c, b);
                    d = b.type;
                    c = b.onProgress;
                    b = b.onComplete;
                    var l = cc.path.extname(a);
                    l && (a = a.slice(0, -l.length));
                    cc.resources.load(a, d, c, b)
                },
                loadResArray: function(a, d, c, b) {
                    b = this._parseLoadResArgs(d, c, b);
                    d = b.type;
                    c = b.onProgress;
                    b = b.onComplete;
                    a.forEach(function(d, c) {
                        var b = cc.path.extname(d);
                        b && (a[c] = d.slice(0, -b.length))
                    });
                    cc.resources.load(a, d, c, b)
                },
                loadResDir: function(a, d, c, b) {
                    c = this._parseLoadResArgs(d, c, b);
                    d = c.type;
                    var l = c.onComplete;
                    cc.resources.loadDir(a, d, c.onProgress, function(c, b) {
                        var g = [];
                        c || (g = cc.resources.getDirWithPath(a, d).map(function(a) {
                            return a.path
                        }));
                        l && l(c, b, g)
                    })
                },
                getRes: function(a, d) {
                    return cc.assetManager.assets.has(a) ? cc.assetManager.assets.get(a) : cc.resources.get(a, d)
                },
                getResCount: function() {
                    return cc.assetManager.assets.count
                },
                getDependsRecursively: function(a) {
                    return a ? e.getDepsRecursively("string" === typeof a ? a : a._uuid).concat([a._uuid]) : []
                },
                get assetLoader() {
                    !0;
                    cc.error("cc.loader.assetLoader was removed, assetLoader and md5Pipe were merged into cc.assetManager.transformPipeline")
                },
                get md5Pipe() {
                    return l
                },
                get downloader() {
                    return cc.assetManager.downloader
                },
                get loader() {
                    return cc.assetManager.parser
                },
                addDownloadHandlers: function(a) {
                    !0;
                    cc.warn("`cc.loader.addDownloadHandlers` is deprecated, please use `cc.assetManager.downloader.register` instead");
                    var d = Object.create(null),
                        c;
                    for (c in a) {
                        var b = a[c];
                        d["." + c] = function(a, d, c) {
                            b({
                                url: a
                            }, c)
                        }
                    }
                    cc.assetManager.downloader.register(d)
                },
                addLoadHandlers: function(a) {
                    !0;
                    cc.warn("`cc.loader.addLoadHandlers` is deprecated, please use `cc.assetManager.parser.register` instead");
                    var d = Object.create(null),
                        c;
                    for (c in a) {
                        var b = a[c];
                        d["." + c] = function(a, d, c) {
                            b({
                                content: a
                            }, c)
                        }
                    }
                    cc.assetManager.parser.register(d)
                },
                flowInDeps: function() {
                    !0;
                    cc.error("cc.loader.flowInDeps was removed")
                },
                release: function(a) {
                    if (Array.isArray(a))
                        for (var d =
                                0; d < a.length; d++) {
                            var c = a[d];
                            "string" === typeof c && (c = cc.assetManager.assets.get(c));
                            cc.assetManager.builtins._assets.find(function(a) {
                                return a.find(function(a) {
                                    return a === c
                                })
                            }) || cc.assetManager.releaseAsset(c)
                        } else a && ("string" === typeof a && (a = cc.assetManager.assets.get(a)), cc.assetManager.builtins._assets.find(function(d) {
                            return d.find(function(d) {
                                return d === a
                            })
                        }) || cc.assetManager.releaseAsset(a))
                },
                releaseAsset: function(a) {
                    cc.assetManager.releaseAsset(a)
                },
                releaseRes: function(a, d) {
                    cc.resources.release(a,
                        d)
                },
                releaseResDir: function() {
                    !0;
                    cc.error("cc.loader.releaseResDir was removed, please use cc.assetManager.releaseAsset instead")
                },
                releaseAll: function() {
                    cc.assetManager.releaseAll();
                    cc.assetManager.assets.clear()
                },
                removeItem: function(a) {
                    cc.assetManager.assets.remove(a)
                },
                setAutoRelease: function(a, d) {
                    "object" === typeof a && (a = a._uuid);
                    this._autoReleaseSetting[a] = !!d
                },
                setAutoReleaseRecursively: function(a, d) {
                    "object" === typeof a && (a = a._uuid);
                    d = !!d;
                    this._autoReleaseSetting[a] = d;
                    a = e.getDepsRecursively(a);
                    for (var c =
                            0; c < a.length; c++) this._autoReleaseSetting[a[c]] = d
                },
                isAutoRelease: function(a) {
                    "object" === typeof a && (a = a._uuid);
                    return !!this._autoReleaseSetting[a]
                }
            };
        k.loadSubpackage = function(a, d) {
            cc.assetManager.loadBundle(a, null, d)
        };
        var n = {
            init: function(a) {
                a.importBase = a.libraryPath;
                a.nativeBase = a.rawAssetsBase;
                cc.assetManager.init(a);
                a.rawAssets && (new cc.AssetManager.Bundle).init({
                    name: cc.AssetManager.BuiltinBundleName.RESOURCES,
                    importBase: a.importBase,
                    nativeBase: a.nativeBase,
                    paths: a.rawAssets.assets,
                    uuids: Object.keys(a.rawAssets.assets)
                })
            },
            loadAsset: function(a, d) {
                cc.assetManager.loadAny(a, d)
            },
            getLibUrlNoExt: function() {
                !0;
                cc.error("cc.AssetLibrary.getLibUrlNoExt was removed, if you want to transform url, please use cc.assetManager.helper.getUrlWithUuid instead")
            },
            queryAssetInfo: function() {
                !0;
                cc.error("cc.AssetLibrary.queryAssetInfo was removed, only available in the editor by using cc.assetManager.editorExtend.queryAssetInfo")
            }
        };
        cc.url = {
            normalize: function(a) {
                cc.warnID(1400, "cc.url.normalize", "cc.assetManager.utils.normalize");
                return cc.assetManager.utils.normalize(a)
            },
            raw: function(a) {
                cc.warnID(1400, "cc.url.raw", "cc.resources.load");
                return a.startsWith("resources/") ? cc.assetManager._transform({
                    path: cc.path.changeExtname(a.substr(10)),
                    bundle: cc.AssetManager.BuiltinBundleName.RESOURCES,
                    __isNative__: !0,
                    ext: cc.path.extname(a)
                }) : ""
            }
        };
        var w = !0,
            t = !0;
        Object.defineProperties(cc, {
            loader: {
                get: function() {
                    !0;
                    w && (w = !1, cc.log("cc.loader is deprecated, use cc.assetManager instead please. See https://docs.cocos.com/creator/manual/zh/release-notes/asset-manager-upgrade-guide.html"));
                    return g
                }
            },
            AssetLibrary: {
                get: function() {
                    !0;
                    t && (t = !1, cc.log("cc.AssetLibrary is deprecated, use cc.assetManager instead please. See https://docs.cocos.com/creator/manual/zh/release-notes/asset-manager-upgrade-guide.html"));
                    return n
                }
            },
            LoadingItems: {
                get: function() {
                    cc.warnID(1400, "cc.LoadingItems", "cc.AssetManager.Task");
                    return cc.AssetManager.Task
                }
            },
            Pipeline: {
                get: function() {
                    cc.warnID(1400, "cc.Pipeline", "cc.AssetManager.Pipeline");
                    return cc.AssetManager.Pipeline
                }
            }
        });
        q.obsolete(cc, "cc.RawAsset", "cc.Asset");
        q.obsolete(cc.Asset.prototype, "cc.Asset.url", "nativeUrl");
        Object.defineProperties(cc.macro, {
            DOWNLOAD_MAX_CONCURRENT: {
                get: function() {
                    return cc.assetManager.downloader.maxConcurrency
                },
                set: function(a) {
                    cc.assetManager.downloader.maxConcurrency = a
                }
            }
        });
        Object.assign(cc.director, {
            _getSceneUuid: function(a) {
                cc.assetManager.main.getSceneInfo(a)
            }
        });
        Object.defineProperties(cc.game, {
            _sceneInfos: {
                get: function() {
                    var a = [];
                    cc.assetManager.main._config.scenes.forEach(function(d) {
                        a.push(d)
                    });
                    return a
                }
            }
        });
        var p = m.parseParameters;
        m.parseParameters = function(a, d, c) {
            a = p(a, d, c);
            a.onProgress = a.onProgress || g.onProgress;
            return a
        };
        var u = b._autoRelease;
        b._autoRelease = function() {
            u.apply(this, arguments);
            for (var a = g._autoReleaseSetting, d = Object.keys(a), c = 0; c < d.length; c++) {
                var l = d[c];
                !0 === a[l] && (l = cc.assetManager.assets.get(l)) && b.tryRelease(l)
            }
        }
    }, {
        "../CCDirector": 38,
        "../platform/js": 225,
        "./depend-util": 49,
        "./downloader": 56,
        "./factory": 57,
        "./releaseManager": 67,
        "./utilities": 72
    }],
    51: [function(h, q, m) {
        var f = h("./helper");
        h("../platform/deserialize");
        q.exports = function(e, b) {
            !1;
            var k = cc._MissingScript.safeFindClass;
            !0;
            var c = cc.deserialize.Details.pool;
            var a = c.get();
            try {
                var d = cc.deserialize(e, a, {
                    classFinder: k,
                    customEnv: b
                })
            } catch (n) {
                throw c.put(a), n;
            }!1;
            e = a.uuidList;
            b = a.uuidObjList;
            k = a.uuidPropList;
            for (var l = [], g = 0; g < e.length; g++) l[g] = {
                uuid: f.decodeUuid(e[g]),
                owner: b[g],
                prop: k[g]
            };
            d.__depends__ = l;
            d._native && (d.__nativeDepend__ = !0);
            c.put(a);
            return d
        }
    }, {
        "../platform/deserialize": 220,
        "../platform/deserialize-compiled": 219,
        "../platform/deserialize-editor": void 0,
        "./helper": 60
    }],
    52: [function(h, q, m) {
        var f = cc.sys.__audioSupport,
            e = h("./utilities").parseParameters;
        q.exports = function(b, k, c) {
            var a = e(k, void 0, c);
            k = a.options;
            c = a.onComplete;
            var d = document.createElement("audio");
            d.src = b;
            var l = function() {
                    clearTimeout(g);
                    d.removeEventListener("canplaythrough", n, !1);
                    d.removeEventListener("error", w, !1);
                    f.USE_LOADER_EVENT && d.removeEventListener(f.USE_LOADER_EVENT, n, !1)
                },
                g = setTimeout(function() {
                    0 === d.readyState ? w() : n()
                }, 8E3),
                n = function() {
                    l();
                    c && c(null, d)
                },
                w = function() {
                    l();
                    var a = "load audio failure - " + b;
                    cc.log(a);
                    c && c(Error(a))
                };
            d.addEventListener("canplaythrough", n, !1);
            d.addEventListener("error", w, !1);
            f.USE_LOADER_EVENT && d.addEventListener(f.USE_LOADER_EVENT, n, !1);
            return d
        }
    }, {
        "./utilities": 72
    }],
    53: [function(h, q, m) {
        var f = h("./utilities").parseParameters;
        q.exports = function(e, b, k) {
            function c() {
                l.removeEventListener("load", c);
                l.removeEventListener("error", a);
                k && k(null, l)
            }

            function a() {
                l.removeEventListener("load", c);
                l.removeEventListener("error", a);
                k && k(Error(cc.debug.getError(4930,
                    e)))
            }
            var d = f(b, void 0, k);
            b = d.options;
            k = d.onComplete;
            var l = new Image;
            "file:" !== window.location.protocol && (l.crossOrigin = "anonymous");
            l.addEventListener("load", c);
            l.addEventListener("error", a);
            l.src = e;
            return l
        }
    }, {
        "./utilities": 72
    }],
    54: [function(h, q, m) {
        var f = h("./utilities").parseParameters;
        q.exports = function(e, b, k, c) {
            var a = f(b, k, c);
            b = a.options;
            k = a.onProgress;
            c = a.onComplete;
            var d = new XMLHttpRequest,
                l = "download failed: " + e + ", status: ";
            d.open("GET", e, !0);
            void 0 !== b.responseType && (d.responseType = b.responseType);
            void 0 !== b.withCredentials && (d.withCredentials = b.withCredentials);
            void 0 !== b.mimeType && d.overrideMimeType && d.overrideMimeType(b.mimeType);
            void 0 !== b.timeout && (d.timeout = b.timeout);
            if (b.header)
                for (var g in b.header) d.setRequestHeader(g, b.header[g]);
            d.onload = function() {
                200 === d.status || 0 === d.status ? c && c(null, d.response) : c && c(Error(l + d.status + "(no response)"))
            };
            k && (d.onprogress = function(a) {
                a.lengthComputable && k(a.loaded, a.total)
            });
            d.onerror = function() {
                c && c(Error(l + d.status + "(error)"))
            };
            d.ontimeout = function() {
                c &&
                    c(Error(l + d.status + "(time out)"))
            };
            d.onabort = function() {
                c && c(Error(l + d.status + "(abort)"))
            };
            d.send(null);
            return d
        }
    }, {
        "./utilities": 72
    }],
    55: [function(h, q, m) {
        var f = h("./utilities").parseParameters,
            e = {};
        q.exports = function(b, k, c) {
            function a() {
                g.parentNode.removeChild(g);
                g.removeEventListener("load", a, !1);
                g.removeEventListener("error", d, !1);
                e[b] = !0;
                c && c(null)
            }

            function d() {
                g.parentNode.removeChild(g);
                g.removeEventListener("load", a, !1);
                g.removeEventListener("error", d, !1);
                c && c(Error(cc.debug.getError(4928,
                    b)))
            }
            var l = f(k, void 0, c);
            k = l.options;
            c = l.onComplete;
            if (e[b]) return c && c(null);
            l = document;
            var g = document.createElement("script");
            "file:" !== window.location.protocol && (g.crossOrigin = "anonymous");
            g.async = k.async;
            g.src = b;
            g.addEventListener("load", a, !1);
            g.addEventListener("error", d, !1);
            l.body.appendChild(g)
        }
    }, {
        "./utilities": 72
    }],
    56: [function(h, q, m) {
        var f = h("../platform/js"),
            e = h("../CCDebug");
        m = h("./font-loader").loadFont;
        var b = h("../platform/utils").callInNextTick,
            k = h("./download-dom-image"),
            c = h("./download-dom-audio"),
            a = h("./download-file"),
            d = h("./download-script.js"),
            l = h("./cache"),
            g = h("./shared").files,
            n = h("../platform/CCSys"),
            w = n.__audioSupport,
            t = n.capabilities;
        h = h("./utilities");
        var p = h.urlAppendTimestamp,
            u = h.retry,
            v = /^\w+:\/\/.*/;
        n = function(a, d, c) {
            c(Error(e.getError(4927)))
        };
        h = function(a, d, b) {
            d.audioLoadMode !== cc.AudioClip.LoadMode.DOM_AUDIO ? E(a, d, b) : c(a, d, b)
        };
        h = 0 === (w.format || []).length ? n : w.WEB_AUDIO ? h : c;
        w = function(a, d, c) {
            (t.imageBitmap && cc.macro.ALLOW_IMAGE_BITMAP ? A : k).apply(this, arguments)
        };
        var A = function(d,
                c, b) {
                c.responseType = "blob";
                a(d, c, c.onFileProgress, b)
            },
            B = function(d, c, b) {
                c.responseType = "json";
                a(d, c, c.onFileProgress, function(a, d) {
                    if (!a && "string" === typeof d) try {
                        d = JSON.parse(d)
                    } catch (da) {
                        a = da
                    }
                    b && b(a, d)
                })
            },
            E = function(d, c, b) {
                c.responseType = "arraybuffer";
                a(d, c, c.onFileProgress, b)
            };
        n = function(d, c, b) {
            c.responseType = "text";
            a(d, c, c.onFileProgress, b)
        };
        var y = function(a, d, c) {
                c(null, a)
            },
            z = new l,
            x = [],
            C = !1,
            G = 0,
            F = 0,
            H = -1,
            I = !1,
            K = function() {
                var a = Date.now();
                a - H > 1E3 * cc.director._deltaTime && (F = 0, H = a)
            },
            P = function L(a,
                d) {
                I = !1;
                for (K(); 0 < x.length && G < a && F < d;) {
                    C && (x.sort(function(a, d) {
                        return a.priority - d.priority
                    }), C = !1);
                    var c = x.pop();
                    if (!c) break;
                    G++;
                    F++;
                    c.invoke()
                }
                0 < x.length && G < a && (b(L, a, d), I = !0)
            },
            S = {
                _remoteServerAddress: "",
                get remoteServerAddress() {
                    return this._remoteServerAddress
                },
                maxConcurrency: 6,
                maxRequestsPerFrame: 6,
                maxRetryCount: 3,
                appendTimeStamp: !1,
                limited: !0,
                retryInterval: 2E3,
                bundleVers: null,
                downloadDomImage: k,
                downloadDomAudio: c,
                downloadFile: a,
                downloadScript: d,
                init: function(a, d) {
                    z.clear();
                    x.length = 0;
                    this._remoteServerAddress =
                        d || "";
                    this.bundleVers = a || Object.create(null)
                },
                register: function(a, d) {
                    "object" === typeof a ? f.mixin(M, a) : M[a] = d
                },
                download: function(a, d, c, l, n) {
                    var k = M[c] || M["default"],
                        e = this;
                    if (c = g.get(a)) n(null, c);
                    else if (c = z.get(a)) {
                        c.push(n);
                        for (var t = 0, w = x.length; t < w; t++)
                            if (c = x[t], c.id === a) {
                                t = l.priority || 0;
                                c.priority < t && (c.priority = t, C = !0);
                                break
                            }
                    } else {
                        var f = l.maxConcurrency || this.maxConcurrency,
                            v = l.maxRequestsPerFrame || this.maxRequestsPerFrame;
                        u(function(c, g) {
                            function t() {
                                k(p(d), l, function() {
                                    G--;
                                    !I && 0 < x.length &&
                                        (b(P, f, v), I = !0);
                                    g.apply(this, arguments)
                                })
                            }
                            0 === c && z.add(a, [n]);
                            if (!e.limited) return k(p(d), l, g);
                            K();
                            G < f && F < v ? (t(), G++, F++) : (x.push({
                                id: a,
                                priority: l.priority || 0,
                                invoke: t
                            }), C = !0, !I && G < f && (b(P, f, v), I = !0))
                        }, l.maxRetryCount || this.maxRetryCount, this.retryInterval, function(d, c) {
                            d || g.add(a, c);
                            for (var b = z.remove(a), l = 0, n = b.length; l < n; l++) b[l](d, c)
                        })
                    }
                }
            },
            M = {
                ".png": w,
                ".jpg": w,
                ".bmp": w,
                ".jpeg": w,
                ".gif": w,
                ".ico": w,
                ".tiff": w,
                ".webp": w,
                ".image": w,
                ".pvr": E,
                ".pkm": E,
                ".mp3": h,
                ".ogg": h,
                ".wav": h,
                ".m4a": h,
                ".txt": n,
                ".xml": n,
                ".vsh": n,
                ".fsh": n,
                ".atlas": n,
                ".tmx": n,
                ".tsx": n,
                ".json": B,
                ".ExportJson": B,
                ".plist": n,
                ".fnt": n,
                ".font": m,
                ".eot": m,
                ".ttf": m,
                ".woff": m,
                ".svg": m,
                ".ttc": m,
                ".mp4": y,
                ".avi": y,
                ".mov": y,
                ".mpg": y,
                ".mpeg": y,
                ".rm": y,
                ".rmvb": y,
                ".binary": E,
                ".bin": E,
                ".dbbin": E,
                ".skel": E,
                ".js": d,
                bundle: function(a, c, b) {
                    var l = cc.path.basename(a),
                        g = a;
                    v.test(g) || (g = "assets/" + l);
                    a = c.version || S.bundleVers[l];
                    var n = 0,
                        k = null,
                        p = null;
                    B(g + "/config." + (a ? a + "." : "") + "json", c, function(a, d) {
                        a && (p = a);
                        (k = d) && (k.base = g + "/");
                        n++;
                        2 === n && b(p, k)
                    });
                    d(g + "/index." +
                        (a ? a + "." : "") + "js", c,
                        function(a) {
                            a && (p = a);
                            n++;
                            2 === n && b(p, k)
                        })
                },
                default: n
            };
        q.exports = S
    }, {
        "../CCDebug": 37,
        "../platform/CCSys": 213,
        "../platform/js": 225,
        "../platform/utils": 228,
        "./cache": 47,
        "./download-dom-audio": 52,
        "./download-dom-image": 53,
        "./download-file": 54,
        "./download-script.js": 55,
        "./font-loader": 59,
        "./shared": 69,
        "./utilities": 72
    }],
    57: [function(h, q, m) {
        function f(a, d, c, b) {
            var l = c = null;
            try {
                c = new cc.Texture2D, c._nativeUrl = a, c._nativeAsset = d
            } catch (B) {
                l = B
            }
            b && b(l, c)
        }

        function e(a, d, c, b) {
            c = new cc.AudioClip;
            c._nativeUrl = a;
            c._nativeAsset = d;
            c.duration = d.duration;
            b && b(null, c)
        }

        function b(a, d, c, b) {
            a = new cc.JsonAsset;
            a.json = d;
            b && b(null, a)
        }

        function k(a, d, c, b) {
            a = new cc.TextAsset;
            a.text = d;
            b && b(null, a)
        }

        function c(a, d, c, b) {
            c = new cc.TTFFont;
            c._nativeUrl = a;
            c._nativeAsset = d;
            b && b(null, c)
        }

        function a(a, d, c, b) {
            c = new cc.BufferAsset;
            c._nativeUrl = a;
            c._nativeAsset = d;
            b && b(null, c)
        }
        var d = h("./bundle");
        m = h("./cache");
        h = h("./shared");
        var l = h.assets,
            g = h.bundles,
            n = new m,
            w = {
                ".png": f,
                ".jpg": f,
                ".bmp": f,
                ".jpeg": f,
                ".gif": f,
                ".ico": f,
                ".tiff": f,
                ".webp": f,
                ".image": f,
                ".pvr": f,
                ".pkm": f,
                ".mp3": e,
                ".ogg": e,
                ".wav": e,
                ".m4a": e,
                ".txt": k,
                ".xml": k,
                ".vsh": k,
                ".fsh": k,
                ".atlas": k,
                ".tmx": k,
                ".tsx": k,
                ".fnt": k,
                ".json": b,
                ".ExportJson": b,
                ".font": c,
                ".eot": c,
                ".ttf": c,
                ".woff": c,
                ".svg": c,
                ".ttc": c,
                ".binary": a,
                ".bin": a,
                ".dbbin": a,
                ".skel": a,
                bundle: function(a, c, b, l) {
                    b = g.get(c.name);
                    b || (b = new d, c.base = c.base || a + "/", b.init(c));
                    l && l(null, b)
                },
                default: function(a, d, c, b) {
                    c = new cc.Asset;
                    c._nativeUrl = a;
                    c._nativeAsset = d;
                    b && b(null, c)
                }
            };
        q.exports = {
            register: function(a,
                d) {
                "object" === typeof a ? cc.js.mixin(w, a) : w[a] = d
            },
            create: function(a, d, c, b, g) {
                c = w[c] || w["default"];
                var k;
                (k = l.get(a)) ? g(null, k): (k = n.get(a)) ? k.push(g) : (n.add(a, [g]), c(a, d, b, function(d, c) {
                    !d && c instanceof cc.Asset && (c._uuid = a, l.add(a, c));
                    for (var b = n.remove(a), g = 0, k = b.length; g < k; g++) b[g](d, c)
                }))
            }
        }
    }, {
        "./bundle": 46,
        "./cache": 47,
        "./shared": 69
    }],
    58: [function(h, q, m) {
        function f(a) {
            a = a.output;
            for (var d = 0, c = a.length; d < c; d++) a[d].content && a[d].content.decRef(!1)
        }

        function e(a, d, b, l, g, k, e, f) {
            f = d.options.__exclude__;
            var n = d.progress;
            a.content = b;
            a.file = l;
            d.output.push(a);
            g && (f[a.uuid] = !0, c(a.uuid, l || b, f, k, !0, !1, a.config), n.total = e + k.length);
            n.canInvoke && d.dispatch("progress", ++n.finish, n.total, a)
        }
        var b = h("./pack-manager"),
            k = h("./task");
        m = h("./utilities");
        var c = m.getDepends,
            a = m.clear,
            d = m.forEach;
        h = h("./shared");
        var l = h.assets,
            g = h.fetchPipeline;
        q.exports = function(c, w) {
            var n = !1;
            c.progress || (c.progress = {
                finish: 0,
                total: c.input.length,
                canInvoke: !0
            }, n = !0);
            var p = c.options,
                u = [],
                v = c.progress,
                h = v.total;
            p.__exclude__ = p.__exclude__ ||
                Object.create(null);
            c.output = [];
            d(c.input, function(a, d) {
                if (!a.isNative && l.has(a.uuid)) {
                    var g = l.get(a.uuid);
                    g.addRef();
                    e(a, c, g, null, g.__asyncLoadAssets__, u, h, w);
                    return d()
                }
                b.load(a, c.options, function(b, l) {
                    b ? c.isFinish || (!cc.assetManager.force || n ? (cc.error(b.message, b.stack), v.canInvoke = !1, w(b)) : e(a, c, null, null, !1, u, h, w)) : c.isFinish || e(a, c, null, l, !a.isNative, u, h, w);
                    d()
                })
            }, function() {
                if (c.isFinish) return a(c, !0), c.dispatch("error");
                if (0 < u.length) {
                    var d = k.create({
                        name: c.name + " dependencies",
                        input: u,
                        progress: v,
                        options: p,
                        onProgress: c.onProgress,
                        onError: k.prototype.recycle,
                        onComplete: function(a) {
                            a || (c.output.push.apply(c.output, this.output), d.recycle());
                            n && f(c);
                            w(a)
                        }
                    });
                    g.async(d)
                } else n && f(c), w()
            })
        }
    }, {
        "./pack-manager": 63,
        "./shared": 69,
        "./task": 70,
        "./utilities": 72
    }],
    59: [function(h, q, m) {
        function f() {
            for (var c = !0, l = Date.now(), g = d.length - 1; 0 <= g; g--) {
                var p = d[g],
                    e = p.fontFamilyName;
                if (3E3 < l - p.startTime) cc.warnID(4933, e), p.onComplete(null, e), d.splice(g, 1);
                else {
                    var f = p.refWidth,
                        h = "40px " + e;
                    k.font = h;
                    h = b.safeMeasureText(k,
                        "BES bswy:->@123\u4e01\u3041\u1101", h);
                    f !== h ? (d.splice(g, 1), p.onComplete(null, e)) : c = !1
                }
            }
            c && (clearInterval(a), a = -1)
        }

        function e(a, d, c) {
            var b = new Promise(function(c, b) {
                    (function y() {
                        3E3 <= Date.now() - a ? b() : document.fonts.load("40px " + d).then(function(a) {
                            1 <= a.length ? c() : setTimeout(y, 100)
                        }, function() {
                            b()
                        })
                    })()
                }),
                l = null,
                g = new Promise(function(a, d) {
                    l = setTimeout(d, 3E3)
                });
            Promise.race([g, b]).then(function() {
                l && (clearTimeout(l), l = null);
                c(null, d)
            }, function() {
                cc.warnID(4933, d);
                c(null, d)
            })
        }
        var b = h("../utils/text-utils"),
            k = null,
            c = Object.create(null),
            a = -1,
            d = [],
            l = function() {
                var a = void 0;
                return function() {
                    if (void 0 === a)
                        if (window.FontFace) {
                            var d = /Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),
                                c = /OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent) && /Apple/.exec(window.navigator.vendor);
                            a = d ? 42 < parseInt(d[1], 10) : !c
                        } else a = !1;
                    return a
                }
            }(),
            g = {
                loadFont: function(n, w, t) {
                    w = g._getFontFamily(n);
                    if (c[w]) return t(null, w);
                    if (!k) {
                        var p = document.createElement("canvas");
                        p.width = 100;
                        p.height = 100;
                        k = p.getContext("2d")
                    }
                    p =
                        "40px " + w;
                    k.font = p;
                    var u = b.safeMeasureText(k, "BES bswy:->@123\u4e01\u3041\u1101", p);
                    p = document.createElement("style");
                    p.type = "text/css";
                    var v = "";
                    isNaN(w - 0) ? v += "@font-face { font-family:" + w + "; src:" : v += "@font-face { font-family:'" + w + "'; src:";
                    p.textContent = v + ("url('" + n + "');") + "}";
                    document.body.appendChild(p);
                    n = document.createElement("div");
                    v = n.style;
                    v.fontFamily = w;
                    n.innerHTML = ".";
                    v.position = "absolute";
                    v.left = "-100px";
                    v.top = "-100px";
                    document.body.appendChild(n);
                    l() ? e(Date.now(), w, t) : (t = {
                        fontFamilyName: w,
                        refWidth: u,
                        onComplete: t,
                        startTime: Date.now()
                    }, d.push(t), -1 === a && (a = setInterval(f, 100)));
                    c[w] = p
                },
                _getFontFamily: function(a) {
                    var d = a.lastIndexOf(".ttf");
                    if (-1 === d) return a;
                    var c = a.lastIndexOf("/");
                    a = -1 === c ? a.substring(0, d) + "_LABEL" : a.substring(c + 1, d) + "_LABEL"; - 1 !== a.indexOf(" ") && (a = '"' + a + '"');
                    return a
                }
            };
        q.exports = g
    }, {
        "../utils/text-utils": 293
    }],
    60: [function(h, q, m) {
        var f = h("./shared").bundles;
        h = {
            decodeUuid: h("../utils/decode-uuid"),
            getUuidFromURL: function() {
                var e = /.*[\/\\][0-9a-fA-F]{2}[\/\\]([0-9a-fA-F-]{8,})/;
                return function(b) {
                    return (b = b.match(e)) ? b[1] : ""
                }
            }(),
            getUrlWithUuid: function(e, b) {
                b = b || Object.create(null);
                b.__isNative__ = b.isNative;
                b.ext = b.nativeExt;
                var k = f.find(function(c) {
                    return c.getAssetInfo(e)
                });
                k && (b.bundle = k.name);
                return cc.assetManager._transform(e, b)
            },
            isScene: function(e) {
                return e && (e.constructor === cc.SceneAsset || e instanceof cc.Scene)
            },
            normalize: function(e) {
                e && (46 === e.charCodeAt(0) && 47 === e.charCodeAt(1) ? e = e.slice(2) : 47 === e.charCodeAt(0) && (e = e.slice(1)));
                return e
            }
        };
        q.exports = h
    }, {
        "../utils/decode-uuid": 281,
        "./shared": 69
    }],
    61: [function(h, q, m) {
        h("./deprecated");
        h("./CCAssetManager")
    }, {
        "./CCAssetManager": 44,
        "./deprecated": 50
    }],
    62: [function(h, q, m) {
        function f(d, b, g, n) {
            var k = d.input,
                e = d.progress,
                t = k.uuid,
                w = k.id,
                f = k.options,
                h = k.config,
                B = f.__asyncLoadAssets__,
                y = f.cacheAsset;
            f = [];
            b.addRef && b.addRef();
            c(t, b, Object.create(null), f, !1, B, h);
            e.canInvoke && d.dispatch("progress", ++e.finish, e.total += f.length, k);
            var E = d.options.__exclude__[t] = {
                    content: b,
                    finish: !1,
                    callbacks: [{
                        done: g,
                        item: k
                    }]
                },
                z = A.create({
                    input: f,
                    options: d.options,
                    onProgress: d.onProgress,
                    onError: A.prototype.recycle,
                    progress: e,
                    onComplete: function(d) {
                        b.decRef && b.decRef(!1);
                        b.__asyncLoadAssets__ = B;
                        E.finish = !0;
                        E.err = d;
                        if (!d) {
                            var c = Array.isArray(z.output) ? z.output : [z.output];
                            for (var g = Object.create(null), k = 0, e = c.length; k < e; k++) {
                                var f = c[k];
                                f && (g[f instanceof cc.Asset ? f._uuid + "@import" : t + "@native"] = f)
                            }
                            if (n) {
                                c = l(t, b, g);
                                if (!c) try {
                                    b.onLoad && b.onLoad()
                                } catch (R) {
                                    cc.error(R.message, R.stack)
                                }
                                p.remove(w);
                                u.remove(w);
                                a(t, b, void 0 !== y ? y : cc.assetManager.cacheAsset)
                            } else if (b.__nativeDepend__ &&
                                !b._nativeAsset && (c = l(t, b, g), !c)) try {
                                b.onLoad && b.onLoad()
                            } catch (R) {
                                cc.error(R.message, R.stack)
                            }
                            z.recycle()
                        }
                        c = E.callbacks;
                        g = 0;
                        for (k = c.length; g < k; g++) e = c[g], b.addRef && b.addRef(), e.item.content = b, e.done(d);
                        c.length = 0
                    }
                });
            v.async(z)
        }
        var e = h("./pack-manager");
        m = h("./pipeline");
        var b = h("./parser"),
            k = h("./utilities"),
            c = k.getDepends,
            a = k.cache,
            d = k.gatherAsset,
            l = k.setProperties,
            g = k.forEach,
            n = k.clear,
            w = k.checkCircleReference;
        k = h("./shared");
        var t = k.assets,
            p = k.files,
            u = k.parsed,
            v = k.pipeline,
            A = h("./task"),
            B = new m("loadOneAsset", [function(a, d) {
                var c = a.output = a.input,
                    b = c.isNative,
                    l = c.uuid,
                    g = c.options.reload;
                if (c.file || !g && !b && t.has(l)) return d();
                e.load(c, a.options, function(a, b) {
                    c.file = b;
                    d(a)
                })
            }, function(a, d) {
                var c = a.output = a.input,
                    l = a.progress,
                    g = a.options.__exclude__,
                    n = c.id,
                    k = c.file,
                    e = c.options;
                if (c.isNative) b.parse(n, k, c.ext, e, function(b, g) {
                    if (b) return d(b);
                    c.content = g;
                    l.canInvoke && a.dispatch("progress", ++l.finish, l.total, c);
                    p.remove(n);
                    u.remove(n);
                    d()
                });
                else {
                    var v = c.uuid;
                    if (v in g) {
                        var h = g[v];
                        e = h.finish;
                        k = h.content;
                        var B =
                            h.err;
                        h = h.callbacks;
                        l.canInvoke && a.dispatch("progress", ++l.finish, l.total, c);
                        e || w(v, v, g) ? (k && k.addRef && k.addRef(), c.content = k, d(B)) : h.push({
                            done: d,
                            item: c
                        })
                    } else !e.reload && t.has(v) ? (g = t.get(v), e.__asyncLoadAssets__ || !g.__asyncLoadAssets__ ? (c.content = g.addRef(), l.canInvoke && a.dispatch("progress", ++l.finish, l.total, c), d()) : f(a, g, d, !1)) : b.parse(n, k, "import", e, function(c, b) {
                        if (c) return d(c);
                        b._uuid = v;
                        f(a, b, d, !0)
                    })
                }
            }]);
        q.exports = function(a, c) {
            var b = !1;
            a.progress || (a.progress = {
                finish: 0,
                total: a.input.length,
                canInvoke: !0
            }, b = !0);
            var l = a.options,
                k = a.progress;
            l.__exclude__ = l.__exclude__ || Object.create(null);
            a.output = [];
            g(a.input, function(d, g) {
                var n = A.create({
                    input: d,
                    onProgress: a.onProgress,
                    options: l,
                    progress: k,
                    onComplete: function(d, l) {
                        d && !a.isFinish && (!cc.assetManager.force || b ? (cc.error(d.message, d.stack), k.canInvoke = !1, c(d)) : k.canInvoke && a.dispatch("progress", ++k.finish, k.total, l));
                        a.output.push(l);
                        n.recycle();
                        g()
                    }
                });
                B.async(n)
            }, function() {
                l.__exclude__ = null;
                if (a.isFinish) return n(a, !0), a.dispatch("error");
                d(a);
                n(a, !0);
                c()
            })
        }
    }, {
        "./pack-manager": 63,
        "./parser": 64,
        "./pipeline": 65,
        "./shared": 69,
        "./task": 70,
        "./utilities": 72
    }],
    63: [function(h, q, m) {
        function f(d) {
            return a.has(d.uuid)
        }
        var e = h("../platform/deserialize-compiled"),
            b = h("./downloader");
        m = h("./cache");
        var k = h("../platform/js"),
            c = h("./shared").files,
            a = new m,
            d = {
                unpackJson: function(a, d, c, b) {
                    c = k.createMap(!0);
                    var l = null;
                    if (Array.isArray(d)) {
                        d = (0, e.unpackJSONs)(d, cc._MissingScript.safeFindClass);
                        d.length !== a.length && cc.errorID(4915);
                        for (var g = 0; g < a.length; g++) c[a[g] +
                            "@import"] = d[g]
                    } else if (g = k._getClassId(cc.Texture2D), d.type === g) {
                        if (d.data) {
                            d = d.data.split("|");
                            d.length !== a.length && cc.errorID(4915);
                            for (var n = 0; n < a.length; n++) c[a[n] + "@import"] = (0, e.packCustomObjData)(g, d[n])
                        }
                    } else l = Error("unmatched type pack!"), c = null;
                    b && b(l, c)
                },
                init: function() {
                    a.clear()
                },
                register: function(a, d) {
                    "object" === typeof a ? k.mixin(l, a) : l[a] = d
                },
                unpack: function(a, d, c, b, k) {
                    if (d)(0, l[c])(a, d, b, k);
                    else k && k(Error("package data is wrong!"))
                },
                load: function(l, n, k) {
                    if (l.isNative || !l.info || !l.info.packs) return b.download(l.id,
                        l.url, l.ext, l.options, k);
                    if (c.has(l.id)) return k(null, c.get(l.id));
                    n = l.info.packs;
                    var g = n.find(f);
                    if (g) return a.get(g.uuid).push({
                        onComplete: k,
                        id: l.id
                    });
                    g = n[0];
                    a.add(g.uuid, [{
                        onComplete: k,
                        id: l.id
                    }]);
                    k = cc.assetManager._transform(g.uuid, {
                        ext: g.ext,
                        bundle: l.config.name
                    });
                    b.download(g.uuid, k, g.ext, l.options, function(b, n) {
                        c.remove(g.uuid);
                        b && cc.error(b.message, b.stack);
                        d.unpack(g.packs, n, g.ext, l.options, function(d, b) {
                            if (!d)
                                for (var l in b) c.add(l, b[l]);
                            l = a.remove(g.uuid);
                            for (var n = 0, k = l.length; n < k; n++) {
                                var p =
                                    l[n];
                                if (d) p.onComplete(d);
                                else {
                                    var e = b[p.id];
                                    e ? p.onComplete(null, e) : p.onComplete(Error("can not retrieve data from package"))
                                }
                            }
                        })
                    })
                }
            },
            l = {
                ".json": d.unpackJson
            };
        q.exports = d
    }, {
        "../platform/deserialize-compiled": 219,
        "../platform/js": 225,
        "./cache": 47,
        "./downloader": 56,
        "./shared": 69
    }],
    64: [function(h, q, m) {
        var f = h("../platform/CCSAXParser").plistParser,
            e = h("../platform/js"),
            b = h("./deserialize");
        m = h("./cache");
        var k = h("./helper").isScene,
            c = h("./shared"),
            a = c.parsed,
            d = c.files;
        h = h("../platform/CCSys");
        var l =
            h.__audioSupport,
            g = h.capabilities,
            n = new m;
        h = {
            parseImage: function(a, d, c) {
                if (g.imageBitmap && a instanceof Blob) {
                    var b = {};
                    b.imageOrientation = d.__flipY__ ? "flipY" : "none";
                    b.premultiplyAlpha = d.__premultiplyAlpha__ ? "premultiply" : "none";
                    createImageBitmap(a, b).then(function(a) {
                        a.flipY = !!d.__flipY__;
                        a.premultiplyAlpha = !!d.__premultiplyAlpha__;
                        c && c(null, a)
                    }, function(a) {
                        c && c(a, null)
                    })
                } else c && c(null, a)
            },
            parseAudio: function(a, d, c) {
                a instanceof ArrayBuffer ? l.context.decodeAudioData(a, function(a) {
                    c && c(null, a)
                }, function(a) {
                    c &&
                        c(a, null)
                }) : c && c(null, a)
            },
            parsePVRTex: function() {
                return function(a, d, c) {
                    var b = d = null;
                    try {
                        var l = a instanceof ArrayBuffer ? a : a.buffer,
                            g = new Int32Array(l, 0, 13);
                        if (55727696 != g[0]) throw Error("Invalid magic number in PVR header");
                        var n = g[7],
                            k = g[6];
                        b = {
                            _data: new Uint8Array(l, g[12] + 52),
                            _compressed: !0,
                            width: n,
                            height: k
                        }
                    } catch (z) {
                        d = z
                    }
                    c && c(d, b)
                }
            }(),
            parsePKMTex: function() {
                return function(a, d, c) {
                    var b = d = null;
                    try {
                        var l = a instanceof ArrayBuffer ? a : a.buffer,
                            g = new Uint8Array(l),
                            n = g[6] << 8 | g[7];
                        if (0 !== n && 1 !== n && 3 !== n) return Error("Invalid magic number in ETC header");
                        var k = g[12] << 8 | g[13],
                            p = g[14] << 8 | g[15];
                        b = {
                            _data: new Uint8Array(l, 16),
                            _compressed: !0,
                            width: k,
                            height: p
                        }
                    } catch (x) {
                        d = x
                    }
                    c && c(d, b)
                }
            }(),
            parsePlist: function(a, d, c) {
                d = null;
                (a = f.parse(a)) || (d = Error("parse failed"));
                c && c(d, a)
            },
            parseImport: function(a, d, c) {
                if (!a) return c && c(Error("Json is empty"));
                var l = null;
                try {
                    var g = b(a, d)
                } catch (B) {
                    l = B
                }
                c && c(l, g)
            },
            init: function() {
                n.clear()
            },
            register: function(a, d) {
                "object" === typeof a ? e.mixin(w, a) : w[a] = d
            },
            parse: function(c, b, l, g, e) {
                var p;
                (p = a.get(c)) ? e(null, p): (p = n.get(c)) ? p.push(e) :
                    (l = w[l]) ? (n.add(c, [e]), l(b, g, function(b, l) {
                        b ? d.remove(c) : k(l) || a.add(c, l);
                        for (var g = n.remove(c), p = 0, e = g.length; p < e; p++) g[p](b, l)
                    })) : e(null, b)
            }
        };
        var w = {
            ".png": h.parseImage,
            ".jpg": h.parseImage,
            ".bmp": h.parseImage,
            ".jpeg": h.parseImage,
            ".gif": h.parseImage,
            ".ico": h.parseImage,
            ".tiff": h.parseImage,
            ".webp": h.parseImage,
            ".image": h.parseImage,
            ".pvr": h.parsePVRTex,
            ".pkm": h.parsePKMTex,
            ".mp3": h.parseAudio,
            ".ogg": h.parseAudio,
            ".wav": h.parseAudio,
            ".m4a": h.parseAudio,
            ".plist": h.parsePlist,
            import: h.parseImport
        };
        q.exports = h
    }, {
        "../platform/CCSAXParser": 211,
        "../platform/CCSys": 213,
        "../platform/js": 225,
        "./cache": 47,
        "./deserialize": 51,
        "./helper": 60,
        "./shared": 69
    }],
    65: [function(h, q, m) {
        function f(k, c) {
            if (Array.isArray(c)) {
                this.id = b++;
                this.name = k;
                this.pipes = [];
                k = 0;
                for (var a = c.length; k < a; k++) "function" === typeof c[k] && this.pipes.push(c[k])
            } else cc.warn("funcs must be an array")
        }
        var e = h("./task"),
            b = 0;
        f.prototype = {
            constructor: f,
            insert: function(b, c) {
                if ("function" !== typeof b || c > this.pipes.length) cc.warnID(4921);
                else return this.pipes.splice(c,
                    0, b), this
            },
            append: function(b) {
                if ("function" === typeof b) return this.pipes.push(b), this
            },
            remove: function(b) {
                if ("number" === typeof b) return this.pipes.splice(b, 1), this
            },
            sync: function(b) {
                var c = this.pipes;
                if (b instanceof e && 0 !== c.length) {
                    null != b.output && (b.input = b.output, b.output = null);
                    b._isFinish = !1;
                    for (var a = 0, d = c.length; a < d;) {
                        var l = (0, c[a])(b);
                        if (l) return b._isFinish = !0, l;
                        a++;
                        a !== d && (b.input = b.output, b.output = null)
                    }
                    b._isFinish = !0;
                    return b.output
                }
            },
            async: function(b) {
                var c = this.pipes;
                b instanceof e && 0 !==
                    c.length && (null != b.output && (b.input = b.output, b.output = null), b._isFinish = !1, this._flow(0, b))
            },
            _flow: function(b, c) {
                var a = this;
                (0, this.pipes[b])(c, function(d) {
                    d ? (c._isFinish = !0, c.onComplete && c.onComplete(d)) : (b++, b < a.pipes.length ? (c.input = c.output, c.output = null, a._flow(b, c)) : (c._isFinish = !0, c.onComplete && c.onComplete(d, c.output)))
                })
            }
        };
        q.exports = f
    }, {
        "./task": 70
    }],
    66: [function(h, q, m) {
        var f = h("./task");
        h = h("./shared");
        var e = h.transformPipeline,
            b = h.RequestType;
        q.exports = function(k, c) {
            var a = k.options,
                d = Object.create(null),
                l = Object.create(null),
                g;
            for (g in a) switch (g) {
                case b.PATH:
                case b.UUID:
                case b.DIR:
                case b.SCENE:
                case b.URL:
                    break;
                case "__requestType__":
                case "__isNative__":
                case "ext":
                case "type":
                case "__nativeName__":
                case "audioLoadMode":
                case "bundle":
                    d[g] = a[g];
                    break;
                case "__exclude__":
                case "__outputAsArray__":
                    l[g] = a[g];
                    break;
                default:
                    d[g] = a[g], l[g] = a[g]
            }
            k.options = l;
            a = f.create({
                input: k.input,
                options: d
            });
            d = null;
            try {
                k.output = k.source = e.sync(a)
            } catch (n) {
                for (d = n, k = 0, l = a.output.length; k < l; k++) a.output[k].recycle()
            }
            a.recycle();
            c(d)
        }
    }, {
        "./shared": 69,
        "./task": 70
    }],
    67: [function(h, q, m) {
        function f(a, d) {
            for (var c = 0; c < a._components.length; c++)
                for (var b = a._components[c], l = d, g = Object.getOwnPropertyNames(b), n = 0; n < g.length; n++) {
                    var k = g[n];
                    if ("node" !== k && "__eventTargets" !== k && (k = b[k], "object" === typeof k && k))
                        if (Array.isArray(k))
                            for (var e = 0; e < k.length; e++) {
                                var t = k[e];
                                t instanceof cc.Asset && t._uuid && l.push(t._uuid)
                            } else if (k.constructor && k.constructor !== Object) k instanceof cc.Asset && k._uuid && l.push(k._uuid);
                            else
                                for (e = Object.getOwnPropertyNames(k),
                                    t = 0; t < e.length; t++) {
                                    var w = k[e[t]];
                                    w instanceof cc.Asset && w._uuid && l.push(w._uuid)
                                }
                }
            for (c = 0; c < a._children.length; c++) f(a._children[c], d)
        }

        function e(a, d, b, l) {
            b.push(a._uuid);
            a = k.getDeps(a._uuid);
            for (var g = 0, n = a.length; g < n; g++) {
                var p = c.get(a[g]);
                if (p) {
                    var t = p._uuid;
                    t in d ? d[t] += l : d[t] = p.refCount + l;
                    b.includes(t) || e(p, d, b, l)
                }
            }
        }

        function b() {
            g = !1;
            l.forEach(function(a) {
                n._free(a)
            });
            l.clear()
        }
        var k = h("./depend-util");
        m = h("./cache");
        h("../assets/CCAsset");
        var c = h("./shared").assets,
            a = [],
            d = new m,
            l = new m,
            g = !1,
            n = {
                init: function() {
                    d.clear();
                    l.clear()
                },
                _addPersistNodeRef: function(a) {
                    var b = [];
                    f(a, b);
                    for (var l = 0, g = b.length; l < g; l++) {
                        var n = c.get(b[l]);
                        n && n.addRef()
                    }
                    d.add(a.uuid, b)
                },
                _removePersistNodeRef: function(a) {
                    if (d.has(a.uuid)) {
                        for (var b = d.get(a.uuid), l = 0, g = b.length; l < g; l++) {
                            var n = c.get(b[l]);
                            n && n.decRef()
                        }
                        d.remove(a.uuid)
                    }
                },
                _autoRelease: function(a, b, l) {
                    for (var g = 0, n = l.length; g < n; g++) {
                        var p = l[g],
                            e = k._depends.get(b._id);
                        p = d.get(p.uuid);
                        for (var t = 0, f = p.length; t < f; t++) {
                            var w = c.get(p[t]);
                            w && w.addRef()
                        }
                        e && (!e.persistDeps &&
                            (e.persistDeps = []), e.persistDeps.push.apply(e.persistDeps, p))
                    }
                    if (a) {
                        b = k.getDeps(a._id);
                        l = 0;
                        for (g = b.length; l < g; l++)(n = c.get(b[l])) && n.decRef((!1, a.autoReleaseAssets));
                        if ((b = k._depends.get(a._id)) && b.persistDeps)
                            for (b = b.persistDeps, l = 0, g = b.length; l < g; l++)(n = c.get(b[l])) && n.decRef((!1, a.autoReleaseAssets));
                        k.remove(a._id)
                    }
                },
                _free: function(d, b) {
                    l.remove(d._uuid);
                    if (cc.isValid(d, !0)) {
                        if (b = !b && 0 < d.refCount) {
                            b = Object.create(null);
                            b[d._uuid] = d.refCount;
                            e(d, b, a, -1);
                            a.length = 0;
                            if (0 === b[d._uuid]) {
                                for (g in b) 0 !==
                                    b[g] && e(c.get(g), b, a, 1);
                                a.length = 0
                            }
                            var g = b[d._uuid];
                            b = 0 < g
                        }
                        if (!b) {
                            c.remove(d._uuid);
                            g = k.getDeps(d._uuid);
                            b = 0;
                            for (var t = g.length; b < t; b++) {
                                var f = c.get(g[b]);
                                f && (f.decRef(!1), n._free(f, !1))
                            }
                            d.destroy();
                            k.remove(d._uuid)
                        }
                    }
                },
                tryRelease: function(a, d) {
                    a instanceof cc.Asset && (d ? n._free(a, d) : (l.add(a._uuid, a), g || (g = !0, cc.director.once(cc.Director.EVENT_AFTER_DRAW, b))))
                }
            };
        q.exports = n
    }, {
        "../assets/CCAsset": 73,
        "./cache": 47,
        "./depend-util": 49,
        "./shared": 69
    }],
    68: [function(h, q, m) {
        function f() {
            this.url = this.uuid =
                this._id = "";
            this.ext = ".json";
            this.config = this.info = this.file = this.content = null;
            this.isNative = !1;
            this.options = Object.create(null)
        }
        var e = [];
        f.prototype = {
            constructor: f,
            get id() {
                this._id || (this._id = this.uuid + "@" + (this.isNative ? "native" : "import"));
                return this._id
            },
            recycle: function() {
                500 !== e.length && (this.url = this.uuid = this._id = "", this.ext = ".json", this.config = this.info = this.file = this.content = null, this.isNative = !1, this.options = Object.create(null), e.push(this))
            }
        };
        f.create = function() {
            return 0 !== e.length ? e.pop() :
                new f
        };
        q.exports = f
    }, {}],
    69: [function(h, q, m) {
        var f = h("./cache"),
            e = h("./pipeline");
        h = new f;
        m = new f;
        var b = new f;
        f = new f;
        var k = new e("normal load", []),
            c = new e("fetch", []);
        e = new e("transform url", []);
        q.exports = {
            assets: h,
            files: m,
            parsed: b,
            pipeline: k,
            fetchPipeline: c,
            transformPipeline: e,
            RequestType: {
                UUID: "uuid",
                PATH: "path",
                DIR: "dir",
                URL: "url",
                SCENE: "scene"
            },
            bundles: f,
            BuiltinBundleName: {
                RESOURCES: "resources",
                INTERNAL: "internal",
                MAIN: "main",
                START_SCENE: "start-scene"
            }
        }
    }, {
        "./cache": 47,
        "./pipeline": 65
    }],
    70: [function(h,
        q, m) {
        function f(b) {
            this.id = e++;
            this._isFinish = !0;
            this.options = this.progress = this.input = this.output = this.source = this.onError = this.onProgress = this.onComplete = null;
            this.set(b)
        }
        var e = 0,
            b = [];
        f.prototype = {
            constructor: f,
            set: function(b) {
                b = b || Object.create(null);
                this.onComplete = b.onComplete;
                this.onProgress = b.onProgress;
                this.onError = b.onError;
                this.source = this.input = b.input;
                this.output = null;
                this.progress = b.progress;
                this.options = b.options || Object.create(null)
            },
            dispatch: function(b, c, a, d, l) {
                switch (b) {
                    case "complete":
                        this.onComplete &&
                            this.onComplete(c, a, d, l);
                        break;
                    case "progress":
                        this.onProgress && this.onProgress(c, a, d, l);
                        break;
                    case "error":
                        this.onError && this.onError(c, a, d, l);
                        break;
                    default:
                        b = "on" + b[0].toUpperCase() + b.substr(1), "function" === typeof this[b] && this[b](c, a, d, l)
                }
            },
            recycle: function() {
                500 !== b.length && (this.options = this.progress = this.source = this.output = this.input = this.onError = this.onProgress = this.onComplete = null, b.push(this))
            },
            get isFinish() {
                return this._isFinish
            }
        };
        f.create = function(k) {
            if (0 !== b.length) {
                var c = b.pop();
                c.set(k)
            } else c =
                new f(k);
            return c
        };
        q.exports = f
    }, {}],
    71: [function(h, q, m) {
        var f = h("./helper").decodeUuid,
            e = h("./request-item");
        h = h("./shared");
        var b = h.RequestType,
            k = h.bundles;
        q.exports = {
            parse: function(c) {
                var a, d = c.input,
                    l = c.options;
                d = Array.isArray(d) ? d : [d];
                c.output = [];
                for (var g = 0; g < d.length; g++) {
                    var n = d[g],
                        w = e.create();
                    "string" === typeof n && (n = Object.create(null), n[l.__requestType__ || b.UUID] = d[g]);
                    if ("object" === typeof n) {
                        cc.js.addon(n, l);
                        n.preset && cc.js.addon(n, cc.assetManager.presets[n.preset]);
                        for (var t in n) {
                            switch (t) {
                                case b.UUID:
                                    var p =
                                        w.uuid = f(n.uuid);
                                    if (k.has(n.bundle)) {
                                        var u = k.get(n.bundle)._config;
                                        if ((a = u.getAssetInfo(p)) && a.redirect) {
                                            if (!k.has(a.redirect)) throw Error("Please load bundle " + a.redirect + " first");
                                            u = k.get(a.redirect)._config;
                                            a = u.getAssetInfo(p)
                                        }
                                        w.config = u;
                                        w.info = a
                                    }
                                    w.ext = n.ext || ".json";
                                    break;
                                case "__requestType__":
                                case "ext":
                                case "bundle":
                                case "preset":
                                case "type":
                                    break;
                                case b.DIR:
                                    if (k.has(n.bundle)) {
                                        u = [];
                                        k.get(n.bundle)._config.getDirWithPath(n.dir, n.type, u);
                                        p = 0;
                                        for (var v = u.length; p < v; p++) a = u[p], d.push({
                                            uuid: a.uuid,
                                            __isNative__: !1,
                                            ext: ".json",
                                            bundle: n.bundle
                                        })
                                    }
                                    w.recycle();
                                    w = null;
                                    break;
                                case b.PATH:
                                    if (k.has(n.bundle)) {
                                        u = k.get(n.bundle)._config;
                                        if ((a = u.getInfoWithPath(n.path, n.type)) && a.redirect) {
                                            if (!k.has(a.redirect)) throw Error("you need to load bundle " + a.redirect + " first");
                                            u = k.get(a.redirect)._config;
                                            a = u.getAssetInfo(a.uuid)
                                        }
                                        if (!a) throw w.recycle(), Error("Bundle " + n.bundle + " doesn't contain " + n.path);
                                        w.config = u;
                                        w.uuid = a.uuid;
                                        w.info = a
                                    }
                                    w.ext = n.ext || ".json";
                                    break;
                                case b.SCENE:
                                    if (k.has(n.bundle)) {
                                        u = k.get(n.bundle)._config;
                                        if ((a = u.getSceneInfo(n.scene)) && a.redirect) {
                                            if (!k.has(a.redirect)) throw Error("you need to load bundle " + a.redirect + " first");
                                            u = k.get(a.redirect)._config;
                                            a = u.getAssetInfo(a.uuid)
                                        }
                                        if (!a) throw w.recycle(), Error("Bundle " + u.name + " doesn't contain scene " + n.scene);
                                        w.config = u;
                                        w.uuid = a.uuid;
                                        w.info = a
                                    }
                                    break;
                                case "__isNative__":
                                    w.isNative = n.__isNative__;
                                    break;
                                case b.URL:
                                    w.url = n.url;
                                    w.uuid = n.uuid || n.url;
                                    w.ext = n.ext || cc.path.extname(n.url);
                                    w.isNative = void 0 === n.__isNative__ || n.__isNative__;
                                    break;
                                default:
                                    w.options[t] =
                                        n[t]
                            }
                            if (!w) break
                        }
                    }
                    if (w && (c.output.push(w), !w.uuid && !w.url)) throw Error("unknown input:" + n.toString());
                }
                return null
            },
            combine: function(c) {
                c = c.output = c.input;
                for (var a = 0; a < c.length; a++) {
                    var d = c[a];
                    if (!d.url) {
                        var b = d.config;
                        b = d.isNative ? b && b.nativeBase ? b.base + b.nativeBase : cc.assetManager.generalNativeBase : b && b.importBase ? b.base + b.importBase : cc.assetManager.generalImportBase;
                        var g = d.uuid,
                            n = "";
                        d.info && (n = d.isNative ? d.info.nativeVer ? "." + d.info.nativeVer : "" : d.info.ver ? "." + d.info.ver : "");
                        b = ".ttf" === d.ext ?
                            b + "/" + g.slice(0, 2) + "/" + g + n + "/" + d.options.__nativeName__ : b + "/" + g.slice(0, 2) + "/" + g + n + d.ext;
                        d.url = b
                    }
                }
                return null
            }
        }
    }, {
        "./helper": 60,
        "./request-item": 68,
        "./shared": 69
    }],
    72: [function(h, q, m) {
        var f = h("./depend-util");
        m = h("./helper");
        var e = m.isScene,
            b = m.decodeUuid,
            k = h("./shared").assets,
            c = h("../platform/utils").callInNextTick;
        h("../assets/CCAsset");
        var a = {
            processOptions: function(a) {
                !1;
                var d = a.uuids,
                    c = a.paths,
                    n = a.types,
                    k = a.deps,
                    e = a.paths = Object.create(null);
                if (!1 === a.debug) {
                    for (var p = 0, u = d.length; p < u; p++) d[p] =
                        b(d[p]);
                    for (var f in c) p = c[f], p[1] = n[p[1]]
                } else {
                    n = Object.create(null);
                    f = 0;
                    for (p = d.length; f < p; f++) u = d[f], d[f] = n[u] = b(u);
                    d = n
                }
                for (var h in c) e[d[h]] = c[h];
                c = a.scenes;
                for (var B in c) c[B] = d[c[B]];
                B = a.packs;
                for (var E in B)
                    for (c = B[E], e = 0; e < c.length; ++e) c[e] = d[c[e]];
                if (E = a.versions)
                    for (var y in E)
                        for (B = E[y], c = 0; c < B.length; c += 2) e = B[c], B[c] = d[e] || e;
                if (a = a.redirect)
                    for (y = 0; y < a.length; y += 2) a[y] = d[a[y]], a[y + 1] = k[a[y + 1]]
            },
            clear: function(a, c) {
                for (var d = 0, b = a.input.length; d < b; d++) {
                    var l = a.input[d];
                    c && !l.isNative &&
                        l.content && l.content.decRef && l.content.decRef(!1);
                    l.recycle()
                }
                a.input = null
            },
            urlAppendTimestamp: function(a) {
                return cc.assetManager.downloader.appendTimeStamp && "string" === typeof a ? /\?/.test(a) ? a + "&_t=" + (new Date - 0) : a + "?_t=" + (new Date - 0) : a
            },
            retry: function(d, c, b, n, k) {
                k = k || 0;
                d(k, function(l, g) {
                    k++;
                    !l || k > c ? n && n(l, g) : setTimeout(function() {
                        a.retry(d, c, b, n, k)
                    }, b)
                })
            },
            getDepends: function(a, c, b, n, k, e, p) {
                try {
                    var d = f.parse(a, c);
                    a = !0;
                    c instanceof cc.Asset && (!c.__nativeDepend__ || c._nativeAsset) && (a = !1);
                    if (k) {
                        e = 0;
                        for (var l = d.deps.length; e < l; e++) {
                            var g = d.deps[e];
                            g in b || (b[g] = !0, n.push({
                                uuid: g,
                                bundle: p && p.name
                            }))
                        }
                        a && d.nativeDep && (p && (d.nativeDep.bundle = p.name), n.push(Object.assign({}, d.nativeDep)))
                    } else {
                        e = (!0, !!c.asyncLoadAssets || e && !d.preventDeferredLoadDependents);
                        l = 0;
                        for (var t = d.deps.length; l < t; l++) {
                            var w = d.deps[l];
                            w in b || (b[w] = !0, n.push({
                                uuid: w,
                                __asyncLoadAssets__: e,
                                bundle: p && p.name
                            }))
                        }
                        a && !e && !d.preventPreloadNativeObject && d.nativeDep && (p && (d.nativeDep.bundle = p.name), n.push(Object.assign({}, d.nativeDep)))
                    }
                } catch (y) {
                    cc.error(y.message,
                        y.stack)
                }
            },
            cache: function(a, c, b) {
                if (c) {
                    var d = e(c);
                    !d && b && k.add(a, c);
                    d && !1
                }
            },
            setProperties: function(a, c, b) {
                var d = !1,
                    l = c.__depends__;
                if (l) {
                    for (var g = 0, k = l.length; g < k; g++) {
                        var e = l[g],
                            f = b[e.uuid + "@import"];
                        f ? e.owner[e.prop] = f.addRef() : (!1, cc.error("The asset " + e.uuid + " is missing!"), d = !0)
                    }
                    c.__depends__ = void 0
                }
                c.__nativeDepend__ && (c._nativeAsset || (b[a + "@native"] ? c._nativeAsset = b[a + "@native"] : (d = !0, !1)), c.__nativeDepend__ = void 0);
                return d
            },
            gatherAsset: function(a) {
                var d = a.source;
                if (a.options.__outputAsArray__ ||
                    1 !== d.length) {
                    a = a.output = [];
                    for (var c = 0, b = d.length; c < b; c++) a.push(d[c].content)
                } else a.output = d[0].content
            },
            forEach: function(a, c, b) {
                var d = 0,
                    l = [];
                0 === a.length && b && b(l);
                for (var g = 0, k = a.length; g < k; g++) c(a[g], function(a) {
                    a && l.push(a);
                    d++;
                    d === k && b && b(l)
                })
            },
            parseParameters: function(a, c, b) {
                if (void 0 === b) {
                    var d = "function" === typeof a;
                    c ? (b = c, d || (c = null)) : void 0 === c && d && (b = a, c = a = null);
                    void 0 !== c && d && (c = a, a = null)
                }
                a = a || Object.create(null);
                return {
                    options: a,
                    onProgress: c,
                    onComplete: b
                }
            },
            parseLoadResArgs: function(a,
                c, b) {
                if (void 0 === b) {
                    var d = cc.js.isChildClassOf(a, cc.Asset);
                    c ? (b = c, d && (c = null)) : void 0 !== c || d || (b = a, a = c = null);
                    void 0 === c || d || (c = a, a = null)
                }
                return {
                    type: a,
                    onProgress: c,
                    onComplete: b
                }
            },
            checkCircleReference: function(d, c, b, n) {
                n || (n = Object.create(null));
                if (!b[c] || n[c]) return !1;
                n[c] = !0;
                var l = !1;
                if (c = f.getDeps(c))
                    for (var g = 0, k = c.length; g < k; g++) {
                        var e = c[g];
                        if (e === d || a.checkCircleReference(d, e, b, n)) {
                            l = !0;
                            break
                        }
                    }
                return l
            },
            asyncify: function(a) {
                return function(d, b) {
                    a && c(a, d, b)
                }
            }
        };
        q.exports = a
    }, {
        "../assets/CCAsset": 73,
        "../platform/utils": 228,
        "./depend-util": 49,
        "./helper": 60,
        "./shared": 69
    }],
    73: [function(h, q, m) {
        h = h("../platform/CCObject");
        cc.Asset = cc.Class({
            name: "cc.Asset",
            extends: h,
            ctor: function() {
                Object.defineProperty(this, "_uuid", {
                    value: "",
                    writable: !0
                });
                this.loaded = !0;
                this._nativeUrl = "";
                this._ref = 0
            },
            properties: {
                nativeUrl: {
                    get: function() {
                        if (!this._nativeUrl && this._native) {
                            var f = this._native;
                            if (47 === f.charCodeAt(0)) return f.slice(1);
                            46 === f.charCodeAt(0) ? this._nativeUrl = cc.assetManager.utils.getUrlWithUuid(this._uuid, {
                                nativeExt: f,
                                isNative: !0
                            }) : this._nativeUrl = cc.assetManager.utils.getUrlWithUuid(this._uuid, {
                                __nativeName__: f,
                                nativeExt: cc.path.extname(f),
                                isNative: !0
                            })
                        }
                        return this._nativeUrl
                    },
                    visible: !1
                },
                refCount: {
                    get: function() {
                        return this._ref
                    }
                },
                _native: "",
                _nativeAsset: {
                    get: function() {
                        return this._$nativeAsset
                    },
                    set: function(f) {
                        this._$nativeAsset = f
                    }
                },
                _nativeDep: {
                    get: function() {
                        if (this._native) return {
                            __isNative__: !0,
                            uuid: this._uuid,
                            ext: this._native
                        }
                    }
                }
            },
            statics: {
                deserialize: !1,
                preventDeferredLoadDependents: !1,
                preventPreloadNativeObject: !1
            },
            toString: function() {
                return this.nativeUrl
            },
            serialize: !1,
            createNode: null,
            _setRawAsset: function(f, e) {
                this._native = !1 !== e ? f || void 0 : "/" + f
            },
            addRef: function() {
                this._ref++;
                return this
            },
            decRef: function(f) {
                this._ref--;
                !1 !== f && cc.assetManager._releaseManager.tryRelease(this);
                return this
            }
        });
        q.exports = cc.Asset
    }, {
        "../platform/CCObject": 210
    }],
    74: [function(h, q, m) {
        m = h("./CCAsset");
        h = h("../event/event-target");
        var f = cc.Enum({
            WEB_AUDIO: 0,
            DOM_AUDIO: 1
        });
        m = cc.Class({
            name: "cc.AudioClip",
            extends: m,
            mixins: [h],
            ctor: function() {
                this.loaded =
                    this._loading = !1;
                this._audio = null
            },
            properties: {
                duration: 0,
                loadMode: {
                    default: f.WEB_AUDIO,
                    type: f
                },
                _nativeAsset: {
                    get: function() {
                        return this._audio
                    },
                    set: function(e) {
                        e instanceof cc.AudioClip ? this._audio = e._nativeAsset : this._audio = e;
                        this._audio && (this.loaded = !0, this.emit("load"))
                    },
                    override: !0
                },
                _nativeDep: {
                    get: function() {
                        return {
                            uuid: this._uuid,
                            audioLoadMode: this.loadMode,
                            ext: cc.path.extname(this._native),
                            __isNative__: !0
                        }
                    },
                    override: !0
                }
            },
            statics: {
                LoadMode: f,
                _loadByUrl: function(e, b) {
                    var k = cc.assetManager.assets.get(e);
                    k ? b(null, k) : cc.assetManager.loadRemote(e, function(c, a) {
                        if (c) return b(c);
                        b(null, a)
                    })
                }
            },
            _ensureLoaded: function(e) {
                if (this.loaded) return e && e();
                e && this.once("load", e);
                if (!this._loading) {
                    this._loading = !0;
                    var b = this;
                    cc.assetManager.postLoadNative(this, function(k) {
                        b._loading = !1
                    })
                }
            },
            destroy: function() {
                cc.audioEngine.uncache(this);
                this._super()
            }
        });
        cc.AudioClip = m;
        q.exports = m
    }, {
        "../event/event-target": 151,
        "./CCAsset": 73
    }],
    75: [function(h, q, m) {
        var f = function() {
                this.textureID = this.offsetY = this.offsetX = this.h =
                    this.w = this.v = this.u = 0;
                this.valid = !1;
                this.xAdvance = 0
            },
            e = function(b) {
                this._letterDefinitions = {};
                this._texture = b
            };
        e.prototype = {
            constructor: e,
            addLetterDefinitions: function(b, k) {
                this._letterDefinitions[b] = k
            },
            cloneLetterDefinition: function() {
                var b = {},
                    k;
                for (k in this._letterDefinitions) {
                    var c = new f;
                    cc.js.mixin(c, this._letterDefinitions[k]);
                    b[k] = c
                }
                return b
            },
            getTexture: function() {
                return this._texture
            },
            getLetter: function(b) {
                return this._letterDefinitions[b]
            },
            getLetterDefinitionForChar: function(b) {
                b = b.charCodeAt(0);
                return this._letterDefinitions.hasOwnProperty(b) ? this._letterDefinitions[b] : null
            },
            clear: function() {
                this._letterDefinitions = {}
            }
        };
        h = cc.Class({
            name: "cc.BitmapFont",
            extends: cc.Font,
            properties: {
                fntDataStr: {
                    default: ""
                },
                spriteFrame: {
                    default: null,
                    type: cc.SpriteFrame
                },
                fontSize: {
                    default: -1
                },
                _fntConfig: null,
                _fontDefDictionary: null
            },
            onLoad: function() {
                var b = this.spriteFrame;
                !this._fontDefDictionary && b && (this._fontDefDictionary = new e(b._texture));
                if (b = this._fntConfig) {
                    b = b.fontDefDictionary;
                    for (var k in b) {
                        var c =
                            new f,
                            a = b[k].rect;
                        c.offsetX = b[k].xOffset;
                        c.offsetY = b[k].yOffset;
                        c.w = a.width;
                        c.h = a.height;
                        c.u = a.x;
                        c.v = a.y;
                        c.textureID = 0;
                        c.valid = !0;
                        c.xAdvance = b[k].xAdvance;
                        this._fontDefDictionary.addLetterDefinitions(k, c)
                    }
                }
            }
        });
        cc.BitmapFont = h;
        cc.BitmapFont.FontLetterDefinition = f;
        cc.BitmapFont.FontAtlas = e;
        q.exports = h
    }, {}],
    76: [function(h, q, m) {
        h = cc.Class({
            name: "cc.BufferAsset",
            extends: cc.Asset,
            ctor: function() {
                this._buffer = null
            },
            properties: {
                _nativeAsset: {
                    get: function() {
                        return this._buffer
                    },
                    set: function(f) {
                        this._buffer =
                            f.buffer || f
                    },
                    override: !0
                },
                buffer: function() {
                    return this._buffer
                }
            }
        });
        cc.BufferAsset = q.exports = h
    }, {}],
    77: [function(h, q, m) {
        h = cc.Class({
            name: "cc.Font",
            extends: cc.Asset
        });
        cc.Font = q.exports = h
    }, {}],
    78: [function(h, q, m) {
        h = cc.Class({
            name: "cc.JsonAsset",
            extends: cc.Asset,
            properties: {
                json: null
            }
        });
        q.exports = cc.JsonAsset = h
    }, {}],
    79: [function(h, q, m) {
        h = cc.Class({
            name: "cc.LabelAtlas",
            extends: cc.BitmapFont,
            onLoad: function() {
                this.spriteFrame ? this._fntConfig ? this._super() : cc.warnID(9101, this.name) : cc.warnID(9100, this.name)
            }
        });
        cc.LabelAtlas = h;
        q.exports = h
    }, {}],
    80: [function(h, q, m) {
        var f = cc.Enum({
                AUTO: 0,
                SINGLE_INSTANCE: 1,
                MULTI_INSTANCE: 2
            }),
            e = cc.Class({
                name: "cc.Prefab",
                extends: cc.Asset,
                ctor: function() {
                    this._createFunction = null;
                    this._instantiatedTimes = 0
                },
                properties: {
                    data: null,
                    optimizationPolicy: f.AUTO,
                    asyncLoadAssets: !1,
                    readonly: {
                        default: !1,
                        editorOnly: !0
                    }
                },
                statics: {
                    OptimizationPolicy: f,
                    OptimizationPolicyThreshold: 3
                },
                createNode: !1,
                compileCreateFunction: function() {
                    this._createFunction = h("../platform/instantiate-jit").compile(this.data)
                },
                _doInstantiate: function(b) {
                    this.data._prefab || cc.warnID(3700);
                    this._createFunction || this.compileCreateFunction();
                    return this._createFunction(b)
                },
                _instantiate: function() {
                    !0;
                    if (this.optimizationPolicy !== f.SINGLE_INSTANCE && (this.optimizationPolicy === f.MULTI_INSTANCE || this._instantiatedTimes + 1 >= e.OptimizationPolicyThreshold)) {
                        var b = this._doInstantiate();
                        this.data._instantiate(b)
                    } else b = this.data._instantiate();
                    ++this._instantiatedTimes;
                    !1;
                    !1;
                    return b
                },
                destroy: function() {
                    this.data && this.data.destroy();
                    this._super()
                }
            });
        cc.Prefab = q.exports = e;
        cc.js.obsolete(cc, "cc._Prefab", "Prefab")
    }, {
        "../platform/instantiate-jit": 223
    }],
    81: [function(h, q, m) {
        var f = function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("../../renderer/gfx")),
            e = h("../renderer");
        h = h("./CCTexture2D");
        m = cc.Enum({
            RB_FMT_D24S8: f["default"].RB_FMT_D24S8,
            RB_FMT_S8: f["default"].RB_FMT_S8,
            RB_FMT_D16: f["default"].RB_FMT_D16
        });
        h = cc.Class({
            name: "cc.RenderTexture",
            extends: h,
            statics: {
                DepthStencilFormat: m
            },
            ctor: function() {
                this._framebuffer = null
            },
            initWithSize: function(b,
                k, c) {
                this.width = Math.floor(b || cc.visibleRect.width);
                this.height = Math.floor(k || cc.visibleRect.height);
                this._resetUnderlyingMipmaps();
                var a = {
                    colors: [this._texture]
                };
                this._depthStencilBuffer && this._depthStencilBuffer.destroy();
                if (c) {
                    var d = new f["default"].RenderBuffer(e.device, c, b, k);
                    c === f["default"].RB_FMT_D24S8 ? a.depthStencil = d : c === f["default"].RB_FMT_S8 ? a.stencil = d : c === f["default"].RB_FMT_D16 && (a.depth = d)
                }
                this._depthStencilBuffer = d;
                this._framebuffer && this._framebuffer.destroy();
                this._framebuffer =
                    new f["default"].FrameBuffer(e.device, b, k, a);
                this._packable = !1;
                this.loaded = !0;
                this.emit("load")
            },
            updateSize: function(b, k) {
                this.width = Math.floor(b || cc.visibleRect.width);
                this.height = Math.floor(k || cc.visibleRect.height);
                this._resetUnderlyingMipmaps();
                var c = this._depthStencilBuffer;
                c && c.update(this.width, this.height);
                this._framebuffer._width = b;
                this._framebuffer._height = k
            },
            drawTextureAt: function(b, k, c) {
                b._image && 0 !== b._image.width && this._texture.updateSubImage({
                    x: k,
                    y: c,
                    image: b._image,
                    width: b.width,
                    height: b.height,
                    level: 0,
                    flipY: !1,
                    premultiplyAlpha: b._premultiplyAlpha
                })
            },
            readPixels: function(b, k, c, a, d) {
                if (!this._framebuffer || !this._texture) return b;
                k = k || 0;
                c = c || 0;
                a = a || this.width;
                d = d || this.height;
                b = b || new Uint8Array(a * d * 4);
                var l = cc.game._renderContext,
                    g = l.getParameter(l.FRAMEBUFFER_BINDING);
                l.bindFramebuffer(l.FRAMEBUFFER, this._framebuffer.getHandle());
                l.readPixels(k, c, a, d, l.RGBA, l.UNSIGNED_BYTE, b);
                l.bindFramebuffer(l.FRAMEBUFFER, g);
                return b
            },
            destroy: function() {
                this._super();
                this._framebuffer && (this._framebuffer.destroy(),
                    this._framebuffer = null)
            }
        });
        cc.RenderTexture = q.exports = h
    }, {
        "../../renderer/gfx": 334,
        "../renderer": 236,
        "./CCTexture2D": 88
    }],
    82: [function(h, q, m) {
        h = cc.Class({
            name: "cc.SceneAsset",
            extends: cc.Asset,
            properties: {
                scene: null,
                asyncLoadAssets: void 0
            }
        });
        cc.SceneAsset = h;
        q.exports = h
    }, {}],
    83: [function(h, q, m) {
        h = cc.Class({
            name: "cc.Script",
            extends: cc.Asset
        });
        cc._Script = h;
        q = cc.Class({
            name: "cc.JavaScript",
            extends: h
        });
        cc._JavaScript = q;
        h = cc.Class({
            name: "cc.TypeScript",
            extends: h
        });
        cc._TypeScript = h
    }, {}],
    84: [function(h, q,
        m) {
        h = cc.Class({
            name: "cc.SpriteAtlas",
            extends: cc.Asset,
            properties: {
                _spriteFrames: {
                    default: {}
                }
            },
            getTexture: function() {
                var f = Object.keys(this._spriteFrames);
                return 0 < f.length ? (f = this._spriteFrames[f[0]]) ? f.getTexture() : null : null
            },
            getSpriteFrame: function(f) {
                var e = this._spriteFrames[f];
                if (!e) return null;
                e.name || (e.name = f);
                return e
            },
            getSpriteFrames: function() {
                var f = [],
                    e = this._spriteFrames,
                    b;
                for (b in e) f.push(this.getSpriteFrame(b));
                return f
            }
        });
        cc.SpriteAtlas = h;
        q.exports = h
    }, {}],
    85: [function(h, q, m) {
        var f =
            h("../event/event-target"),
            e = [{
                u: 0,
                v: 0
            }, {
                u: 0,
                v: 0
            }, {
                u: 0,
                v: 0
            }, {
                u: 0,
                v: 0
            }],
            b = cc.Class({
                name: "cc.SpriteFrame",
                extends: h("../assets/CCAsset"),
                mixins: [f],
                properties: {
                    _textureSetter: {
                        set: function(b) {
                            b && (!1, this._texture !== b && this._refreshTexture(b))
                        }
                    },
                    insetTop: {
                        get: function() {
                            return this._capInsets[1]
                        },
                        set: function(b) {
                            this._capInsets[1] = b;
                            this._texture && this._calculateSlicedUV()
                        }
                    },
                    insetBottom: {
                        get: function() {
                            return this._capInsets[3]
                        },
                        set: function(b) {
                            this._capInsets[3] = b;
                            this._texture && this._calculateSlicedUV()
                        }
                    },
                    insetLeft: {
                        get: function() {
                            return this._capInsets[0]
                        },
                        set: function(b) {
                            this._capInsets[0] = b;
                            this._texture && this._calculateSlicedUV()
                        }
                    },
                    insetRight: {
                        get: function() {
                            return this._capInsets[2]
                        },
                        set: function(b) {
                            this._capInsets[2] = b;
                            this._texture && this._calculateSlicedUV()
                        }
                    }
                },
                ctor: function(b, c, a, d, l) {
                    f.call(this);
                    this._rect = null;
                    this.uv = [];
                    this._originalSize = this._offset = this._original = this._texture = null;
                    this._flipY = this._flipX = this._rotated = !1;
                    this.vertices = null;
                    this._capInsets = [0, 0, 0, 0];
                    this.uvSliced = [];
                    !1;
                    void 0 !== b && this.setTexture(b, c, a, d, l)
                },
                textureLoaded: function() {
                    return this._texture && this._texture.loaded
                },
                onTextureLoaded: function(b, c) {
                    if (!this.textureLoaded()) return this.once("load", b, c), this.ensureLoadTexture(), !1;
                    b.call(c);
                    return !0
                },
                isRotated: function() {
                    return this._rotated
                },
                setRotated: function(b) {
                    this._rotated = b;
                    this._texture && this._calculateUV()
                },
                isFlipX: function() {
                    return this._flipX
                },
                isFlipY: function() {
                    return this._flipY
                },
                setFlipX: function(b) {
                    this._flipX = b;
                    this._texture && this._calculateUV()
                },
                setFlipY: function(b) {
                    this._flipY = b;
                    this._texture && this._calculateUV()
                },
                getRect: function() {
                    return cc.rect(this._rect)
                },
                setRect: function(b) {
                    this._rect = b;
                    this._texture && this._calculateUV()
                },
                getOriginalSize: function() {
                    return cc.size(this._originalSize)
                },
                setOriginalSize: function(b) {
                    this._originalSize ? (this._originalSize.width = b.width, this._originalSize.height = b.height) : this._originalSize = cc.size(b)
                },
                getTexture: function() {
                    return this._texture
                },
                _textureLoadedCallback: function() {
                    var b = this._texture;
                    if (b) {
                        var c =
                            b.width;
                        b = b.height;
                        this._rect ? this._checkRect(this._texture) : this._rect = cc.rect(0, 0, c, b);
                        this._originalSize || this.setOriginalSize(cc.size(c, b));
                        this._offset || this.setOffset(cc.v2(0, 0));
                        this._calculateUV();
                        this.emit("load")
                    }
                },
                _refreshTexture: function(b) {
                    this._texture = b;
                    b.loaded ? this._textureLoadedCallback() : b.once("load", this._textureLoadedCallback, this)
                },
                getOffset: function() {
                    return cc.v2(this._offset)
                },
                setOffset: function(b) {
                    this._offset = cc.v2(b)
                },
                clone: function() {
                    return new b(this._texture, this.getRect(),
                        this._rotated, this.getOffset(), this.getOriginalSize())
                },
                setTexture: function(b, c, a, d, l) {
                    if (1 !== arguments.length || b !== this._texture)
                        if (this._rect = c || null, d ? this.setOffset(d) : this._offset = null, l ? this.setOriginalSize(l) : this._originalSize = null, this._rotated = a || !1, "string" === typeof b) cc.errorID(3401);
                        else return b instanceof cc.Texture2D && this._refreshTexture(b), !0
                },
                ensureLoadTexture: function() {
                    this._texture && !this._texture.loaded && (this._refreshTexture(this._texture), cc.assetManager.postLoadNative(this._texture))
                },
                _checkRect: function(b) {
                    var c = this._rect,
                        a = c.x,
                        d = c.y;
                    this._rotated ? (a += c.height, d += c.width) : (a += c.width, d += c.height);
                    a > b.width && cc.errorID(3300, b.nativeUrl + "/" + this.name, a, b.width);
                    d > b.height && cc.errorID(3400, b.nativeUrl + "/" + this.name, d, b.height)
                },
                _flipXY: function(b) {
                    if (this._flipX) {
                        var c = b[0];
                        b[0] = b[1];
                        b[1] = c;
                        c = b[2];
                        b[2] = b[3];
                        b[3] = c
                    }
                    this._flipY && (c = b[0], b[0] = b[2], b[2] = c, c = b[1], b[1] = b[3], b[3] = c)
                },
                _calculateSlicedUV: function() {
                    var b = this._rect,
                        c = this._texture.width,
                        a = this._texture.height,
                        d = this._capInsets[0],
                        l = b.width - d - this._capInsets[2],
                        g = this._capInsets[1],
                        n = this._capInsets[3],
                        f = b.height - g - n,
                        t = this.uvSliced;
                    t.length = 0;
                    if (this._rotated)
                        for (e[0].u = b.x / c, e[1].u = (b.x + n) / c, e[2].u = (b.x + n + f) / c, e[3].u = (b.x + b.height) / c, e[3].v = b.y / a, e[2].v = (b.y + d) / a, e[1].v = (b.y + d + l) / a, e[0].v = (b.y + b.width) / a, this._flipXY(e), b = 0; 4 > b; ++b)
                            for (c = e[b], a = 0; 4 > a; ++a) t.push({
                                u: c.u,
                                v: e[3 - a].v
                            });
                    else
                        for (e[0].u = b.x / c, e[1].u = (b.x + d) / c, e[2].u = (b.x + d + l) / c, e[3].u = (b.x + b.width) / c, e[3].v = b.y / a, e[2].v = (b.y + g) / a, e[1].v = (b.y + g + f) / a, e[0].v = (b.y +
                                b.height) / a, this._flipXY(e), b = 0; 4 > b; ++b)
                            for (c = e[b], a = 0; 4 > a; ++a) t.push({
                                u: e[a].u,
                                v: c.v
                            })
                },
                _setDynamicAtlasFrame: function(b) {
                    b && (this._original = {
                        _texture: this._texture,
                        _x: this._rect.x,
                        _y: this._rect.y
                    }, this._texture = b.texture, this._rect.x = b.x, this._rect.y = b.y, this._calculateUV())
                },
                _resetDynamicAtlasFrame: function() {
                    this._original && (this._rect.x = this._original._x, this._rect.y = this._original._y, this._texture = this._original._texture, this._original = null, this._calculateUV())
                },
                _calculateUV: function() {
                    var b =
                        this._rect,
                        c = this._texture,
                        a = this.uv,
                        d = c.width;
                    c = c.height;
                    if (this._rotated) {
                        var l = 0 === d ? 0 : b.x / d,
                            g = 0 === d ? 0 : (b.x + b.height) / d,
                            n = 0 === c ? 0 : (b.y + b.width) / c;
                        b = 0 === c ? 0 : b.y / c;
                        a[0] = l;
                        a[1] = b;
                        a[2] = l;
                        a[3] = n;
                        a[4] = g;
                        a[5] = b;
                        a[6] = g;
                        a[7] = n
                    } else l = 0 === d ? 0 : b.x / d, g = 0 === d ? 0 : (b.x + b.width) / d, n = 0 === c ? 0 : (b.y + b.height) / c, b = 0 === c ? 0 : b.y / c, a[0] = l, a[1] = n, a[2] = g, a[3] = n, a[4] = l, a[5] = b, a[6] = g, a[7] = b;
                    this._flipX && (b = a[0], a[0] = a[2], a[2] = b, b = a[1], a[1] = a[3], a[3] = b, b = a[4], a[4] = a[6], a[6] = b, b = a[5], a[5] = a[7], a[7] = b);
                    this._flipY && (b = a[0], a[0] =
                        a[4], a[4] = b, b = a[1], a[1] = a[5], a[5] = b, b = a[2], a[2] = a[6], a[6] = b, b = a[3], a[3] = a[7], a[7] = b);
                    if (a = this.vertices)
                        for (a.nu.length = 0, b = a.nv.length = 0; b < a.u.length; b++) a.nu[b] = a.u[b] / d, a.nv[b] = a.v[b] / c;
                    this._calculateSlicedUV()
                },
                _serialize: (!1, !1),
                _deserialize: function(b, c) {
                    (c = b.rect) && (this._rect = new cc.Rect(c[0], c[1], c[2], c[3]));
                    b.offset && this.setOffset(new cc.Vec2(b.offset[0], b.offset[1]));
                    b.originalSize && this.setOriginalSize(new cc.Size(b.originalSize[0], b.originalSize[1]));
                    this._rotated = 1 === b.rotated;
                    this._name =
                        b.name;
                    if (c = b.capInsets) this._capInsets[0] = c[0], this._capInsets[1] = c[1], this._capInsets[2] = c[2], this._capInsets[3] = c[3];
                    !1;
                    if (this.vertices = b.vertices) this.vertices.nu = [], this.vertices.nv = [];
                    !1
                }
            });
        h = b.prototype;
        h.copyWithZone = h.clone;
        h.copy = h.clone;
        h.initWithTexture = h.setTexture;
        cc.SpriteFrame = b;
        q.exports = b
    }, {
        "../assets/CCAsset": 73,
        "../event/event-target": 151
    }],
    86: [function(h, q, m) {
        h = h("./CCFont");
        h = cc.Class({
            name: "cc.TTFFont",
            extends: h,
            properties: {
                _fontFamily: null,
                _nativeAsset: {
                    type: cc.String,
                    get: function() {
                        return this._fontFamily
                    },
                    set: function(f) {
                        this._fontFamily = f || "Arial"
                    },
                    override: !0
                },
                _nativeDep: {
                    get: function() {
                        return {
                            uuid: this._uuid,
                            __nativeName__: this._native,
                            ext: cc.path.extname(this._native),
                            __isNative__: !0
                        }
                    },
                    override: !0
                }
            }
        });
        cc.TTFFont = q.exports = h
    }, {
        "./CCFont": 77
    }],
    87: [function(h, q, m) {
        h = cc.Class({
            name: "cc.TextAsset",
            extends: cc.Asset,
            properties: {
                text: ""
            },
            toString: function() {
                return this.text
            }
        });
        q.exports = cc.TextAsset = h
    }, {}],
    88: [function(h, q, m) {
        function f() {
            for (var a in w) w[a] = void 0;
            n.length = 0;
            w.images = n;
            return w
        }
        m = function(a) {
            return a &&
                a.__esModule ? a : {
                    default: a
                }
        }(h("../../renderer/gfx"));
        var e = h("../event/event-target"),
            b = h("../renderer");
        h("../platform/CCClass");
        var k = new(h("../platform/id-generater"))("Tex"),
            c = 1024,
            a = cc.Enum({
                RGB565: m["default"].TEXTURE_FMT_R5_G6_B5,
                RGB5A1: m["default"].TEXTURE_FMT_R5_G5_B5_A1,
                RGBA4444: m["default"].TEXTURE_FMT_R4_G4_B4_A4,
                RGB888: m["default"].TEXTURE_FMT_RGB8,
                RGBA8888: m["default"].TEXTURE_FMT_RGBA8,
                RGBA32F: m["default"].TEXTURE_FMT_RGBA32F,
                A8: m["default"].TEXTURE_FMT_A8,
                I8: m["default"].TEXTURE_FMT_L8,
                AI8: m["default"].TEXTURE_FMT_L8_A8,
                RGB_PVRTC_2BPPV1: m["default"].TEXTURE_FMT_RGB_PVRTC_2BPPV1,
                RGBA_PVRTC_2BPPV1: m["default"].TEXTURE_FMT_RGBA_PVRTC_2BPPV1,
                RGB_A_PVRTC_2BPPV1: c++,
                RGB_PVRTC_4BPPV1: m["default"].TEXTURE_FMT_RGB_PVRTC_4BPPV1,
                RGBA_PVRTC_4BPPV1: m["default"].TEXTURE_FMT_RGBA_PVRTC_4BPPV1,
                RGB_A_PVRTC_4BPPV1: c++,
                RGB_ETC1: m["default"].TEXTURE_FMT_RGB_ETC1,
                RGBA_ETC1: c++,
                RGB_ETC2: m["default"].TEXTURE_FMT_RGB_ETC2,
                RGBA_ETC2: m["default"].TEXTURE_FMT_RGBA_ETC2
            }),
            d = cc.Enum({
                REPEAT: 10497,
                CLAMP_TO_EDGE: 33071,
                MIRRORED_REPEAT: 33648
            }),
            l = cc.Enum({
                LINEAR: 9729,
                NEAREST: 9728
            }),
            g = {
                9728: 0,
                9729: 1
            },
            n = [],
            w = {
                width: void 0,
                height: void 0,
                minFilter: void 0,
                magFilter: void 0,
                wrapS: void 0,
                wrapT: void 0,
                format: void 0,
                genMipmaps: void 0,
                images: void 0,
                image: void 0,
                flipY: void 0,
                premultiplyAlpha: void 0
            },
            t = cc.Class({
                name: "cc.Texture2D",
                extends: h("../assets/CCAsset"),
                mixins: [e],
                properties: {
                    _nativeAsset: {
                        get: function() {
                            return this._image
                        },
                        set: function(a) {
                            a._compressed && a._data ? this.initWithData(a._data, this._format, a.width, a.height) :
                                this.initWithElement(a)
                        },
                        override: !0
                    },
                    _format: a.RGBA8888,
                    _premultiplyAlpha: !1,
                    _flipY: !1,
                    _minFilter: l.LINEAR,
                    _magFilter: l.LINEAR,
                    _mipFilter: l.LINEAR,
                    _wrapS: d.CLAMP_TO_EDGE,
                    _wrapT: d.CLAMP_TO_EDGE,
                    _isAlphaAtlas: !1,
                    _genMipmaps: !1,
                    genMipmaps: {
                        get: function() {
                            return this._genMipmaps
                        },
                        set: function(a) {
                            if (this._genMipmaps !== a) {
                                var d = f();
                                d.genMipmaps = a;
                                this.update(d)
                            }
                        }
                    },
                    _packable: !0,
                    packable: {
                        get: function() {
                            return this._packable
                        },
                        set: function(a) {
                            this._packable = a
                        }
                    },
                    _nativeDep: {
                        get: function() {
                            return {
                                __isNative__: !0,
                                uuid: this._uuid,
                                ext: this._native,
                                __flipY__: this._flipY,
                                __premultiplyAlpha__: this._premultiplyAlpha
                            }
                        },
                        override: !0
                    }
                },
                statics: {
                    PixelFormat: a,
                    WrapMode: d,
                    Filter: l,
                    _FilterIndex: g,
                    extnames: ".png .jpg .jpeg .bmp .webp .pvr .pkm".split(" "),
                    _parseExt: function(d, c) {
                        var b = cc.renderer.device;
                        d = d.split("_");
                        for (var l = "", g = "", n = 999, k = c, p = cc.macro.SUPPORT_TEXTURE_FORMATS, e = 0; e < d.length; e++) {
                            var u = d[e].split("@"),
                                f = u[0];
                            f = t.extnames[f.charCodeAt(0) - 48] || f;
                            var w = p.indexOf(f);
                            if (-1 !== w && w < n) {
                                if (u = u[1] ? parseInt(u[1]) :
                                    c, ".pvr" !== f || b.ext("WEBGL_compressed_texture_pvrtc"))
                                    if (u !== a.RGB_ETC1 && u !== a.RGBA_ETC1 || b.ext("WEBGL_compressed_texture_etc1"))
                                        if (u !== a.RGB_ETC2 && u !== a.RGBA_ETC2 || b.ext("WEBGL_compressed_texture_etc"))
                                            if (".webp" !== f || cc.sys.capabilities.webp) n = w, g = f, k = u
                            } else l || (l = f)
                        }
                        return {
                            bestExt: g,
                            bestFormat: k,
                            defaultExt: l
                        }
                    }
                },
                ctor: function() {
                    this._id = k.getNewId();
                    this.loaded = !1;
                    this.height = this.width = 0;
                    this._hashDirty = !0;
                    this._hash = 0;
                    this._texture = null;
                    !1
                },
                getImpl: function() {
                    this._texture || (this._texture = new b.Texture2D(b.device, {}));
                    return this._texture
                },
                getId: function() {
                    return this._id
                },
                toString: function() {
                    return this.nativeUrl || ""
                },
                update: function(a) {
                    if (a) {
                        var d = !1;
                        void 0 !== a.width && (this.width = a.width);
                        void 0 !== a.height && (this.height = a.height);
                        void 0 !== a.minFilter && (this._minFilter = a.minFilter, a.minFilter = g[a.minFilter]);
                        void 0 !== a.magFilter && (this._magFilter = a.magFilter, a.magFilter = g[a.magFilter]);
                        void 0 !== a.mipFilter && (this._mipFilter = a.mipFilter, a.mipFilter = g[a.mipFilter]);
                        void 0 !== a.wrapS && (this._wrapS = a.wrapS);
                        void 0 !==
                            a.wrapT && (this._wrapT = a.wrapT);
                        void 0 !== a.format && (this._format = a.format);
                        void 0 !== a.flipY && (this._flipY = a.flipY, d = !0);
                        void 0 !== a.premultiplyAlpha && (this._premultiplyAlpha = a.premultiplyAlpha, d = !0);
                        void 0 !== a.genMipmaps && (this._genMipmaps = a.genMipmaps);
                        cc.sys.capabilities.imageBitmap && this._image instanceof ImageBitmap ? this._checkImageBitmap(this._upload.bind(this, a, d)) : this._upload(a, d)
                    }
                },
                _upload: function(a, d) {
                    d && this._image && (a.image = this._image);
                    a.images && 0 < a.images.length ? this._image = a.images[0] :
                        void 0 !== a.image && (this._image = a.image, a.images || (n.length = 0, a.images = n), a.images.push(a.image));
                    this._texture && this._texture.update(a);
                    this._hashDirty = !0
                },
                initWithElement: function(a, d) {
                    if (a)
                        if (this._image = a, a.complete || a instanceof HTMLCanvasElement) this.handleLoadedTexture(d);
                        else if (cc.sys.capabilities.imageBitmap && a instanceof ImageBitmap) this._checkImageBitmap(this.handleLoadedTexture.bind(this));
                    else {
                        var c = this;
                        a.addEventListener("load", function() {
                            c.handleLoadedTexture(d)
                        });
                        a.addEventListener("error",
                            function(a) {
                                cc.warnID(3119, a.message)
                            })
                    }
                },
                initWithData: function(a, d, c, l) {
                    var n = f();
                    n.image = a;
                    n.images = [n.image];
                    n.genMipmaps = this._genMipmaps;
                    n.premultiplyAlpha = this._premultiplyAlpha;
                    n.flipY = this._flipY;
                    n.minFilter = g[this._minFilter];
                    n.magFilter = g[this._magFilter];
                    n.wrapS = this._wrapS;
                    n.wrapT = this._wrapT;
                    n.format = this._getGFXPixelFormat(d);
                    n.width = c;
                    n.height = l;
                    this._texture ? this._texture.update(n) : this._texture = new b.Texture2D(b.device, n);
                    this.width = c;
                    this.height = l;
                    this._updateFormat();
                    this._checkPackable();
                    this.loaded = !0;
                    this.emit("load");
                    return !0
                },
                getHtmlElementObj: function() {
                    return this._image
                },
                destroy: function() {
                    cc.sys.capabilities.imageBitmap && this._image instanceof ImageBitmap && this._image.close && this._image.close();
                    this._packable && cc.dynamicAtlasManager && cc.dynamicAtlasManager.deleteAtlasTexture(this);
                    this._image = null;
                    this._texture && this._texture.destroy();
                    this._super()
                },
                getPixelFormat: function() {
                    return this._format
                },
                hasPremultipliedAlpha: function() {
                    return this._premultiplyAlpha || !1
                },
                isAlphaAtlas: function() {
                    return this._isAlphaAtlas
                },
                handleLoadedTexture: function(a) {
                    if (this._image && this._image.width && this._image.height) {
                        this.width = this._image.width;
                        this.height = this._image.height;
                        var d = f();
                        d.image = this._image;
                        d.images = [d.image];
                        d.width = this.width;
                        d.height = this.height;
                        d.genMipmaps = this._genMipmaps;
                        d.format = this._getGFXPixelFormat(this._format);
                        d.premultiplyAlpha = this._premultiplyAlpha;
                        d.flipY = this._flipY;
                        d.minFilter = g[this._minFilter];
                        d.magFilter = g[this._magFilter];
                        d.wrapS = this._wrapS;
                        d.wrapT = this._wrapT;
                        this._texture ? this._texture.update(d) :
                            this._texture = new b.Texture2D(b.device, d);
                        this._updateFormat();
                        this._checkPackable();
                        this.loaded = !0;
                        this.emit("load");
                        !a && cc.macro.CLEANUP_IMAGE_CACHE && (this._image instanceof HTMLImageElement ? this._clearImage() : cc.sys.capabilities.imageBitmap && this._image instanceof ImageBitmap && this._image.close && this._image.close())
                    }
                },
                description: function() {
                    return "<cc.Texture2D | Name = " + this.nativeUrl + " | Dimensions = " + this.width + " x " + this.height + ">"
                },
                releaseTexture: function() {
                    this._image = null;
                    this._texture &&
                        this._texture.destroy()
                },
                setWrapMode: function(a, d) {
                    if (this._wrapS !== a || this._wrapT !== d) {
                        var c = f();
                        c.wrapS = a;
                        c.wrapT = d;
                        this.update(c)
                    }
                },
                setFilters: function(a, d) {
                    if (this._minFilter !== a || this._magFilter !== d) {
                        var c = f();
                        c.minFilter = a;
                        c.magFilter = d;
                        this.update(c)
                    }
                },
                setFlipY: function(a) {
                    if (this._flipY !== a) {
                        var d = f();
                        d.flipY = a;
                        d.premultiplyAlpha = this._premultiplyAlpha;
                        this.update(d)
                    }
                },
                setPremultiplyAlpha: function(a) {
                    if (this._premultiplyAlpha !== a) {
                        var d = f();
                        d.flipY = this._flipY;
                        d.premultiplyAlpha = a;
                        this.update(d)
                    }
                },
                _updateFormat: function() {
                    this._isAlphaAtlas = this._format === a.RGBA_ETC1 || this._format === a.RGB_A_PVRTC_4BPPV1 || this._format === a.RGB_A_PVRTC_2BPPV1;
                    !1
                },
                _checkPackable: function() {
                    var a = cc.dynamicAtlasManager;
                    if (a)
                        if (this._isCompressed()) this._packable = !1;
                        else {
                            var d = this.width,
                                c = this.height;
                            !this._image || d > a.maxFrameSize || c > a.maxFrameSize || this._getHash() !== a.Atlas.DEFAULT_HASH ? this._packable = !1 : this._image && this._image instanceof HTMLCanvasElement && (this._packable = !0)
                        }
                },
                _getOpts: function() {
                    var a = f();
                    a.width = this.width;
                    a.height = this.height;
                    a.genMipmaps = this._genMipmaps;
                    a.format = this._format;
                    a.premultiplyAlpha = this._premultiplyAlpha;
                    a.anisotropy = this._anisotropy;
                    a.flipY = this._flipY;
                    a.minFilter = g[this._minFilter];
                    a.magFilter = g[this._magFilter];
                    a.mipFilter = g[this._mipFilter];
                    a.wrapS = this._wrapS;
                    a.wrapT = this._wrapT;
                    return a
                },
                _getGFXPixelFormat: function(d) {
                    d === a.RGBA_ETC1 ? d = a.RGB_ETC1 : d === a.RGB_A_PVRTC_4BPPV1 ? d = a.RGB_PVRTC_4BPPV1 : d === a.RGB_A_PVRTC_2BPPV1 && (d = a.RGB_PVRTC_2BPPV1);
                    return d
                },
                _resetUnderlyingMipmaps: function(a) {
                    var d =
                        this._getOpts();
                    d.images = a || [null];
                    this._texture ? this._texture.update(d) : this._texture = new b.Texture2D(b.device, d)
                },
                _serialize: (!1, !1),
                _deserialize: function(a) {
                    a = a.split(",");
                    var d = a[0];
                    if (d)
                        if (d = t._parseExt(d, this._format), d.bestExt) this._setRawAsset(d.bestExt), this._format = d.bestFormat;
                        else {
                            if (!d.defaultExt) throw Error(cc.debug.getError(3121));
                            this._setRawAsset(d.defaultExt);
                            cc.warnID(3120, d.defaultExt, d.defaultExt)
                        }
                    8 === a.length && (this._minFilter = parseInt(a[1]), this._magFilter = parseInt(a[2]), this._wrapS =
                        parseInt(a[3]), this._wrapT = parseInt(a[4]), this._premultiplyAlpha = 49 === a[5].charCodeAt(0), this._genMipmaps = 49 === a[6].charCodeAt(0), this._packable = 49 === a[7].charCodeAt(0))
                },
                _getHash: function() {
                    if (!this._hashDirty) return this._hash;
                    var a = this._genMipmaps ? 1 : 0,
                        c = this._premultiplyAlpha ? 1 : 0,
                        b = this._flipY ? 1 : 0,
                        g = this._minFilter === l.LINEAR ? 1 : 2,
                        n = this._magFilter === l.LINEAR ? 1 : 2,
                        k = this._wrapS === d.REPEAT ? 1 : this._wrapS === d.CLAMP_TO_EDGE ? 2 : 3,
                        e = this._wrapT === d.REPEAT ? 1 : this._wrapT === d.CLAMP_TO_EDGE ? 2 : 3,
                        t = this._format;
                    !1;
                    this._hash = Number("" + g + n + t + k + e + a + c + b);
                    this._hashDirty = !1;
                    return this._hash
                },
                _isCompressed: function() {
                    return this._format < a.A8 || this._format > a.RGBA32F
                },
                _clearImage: function() {
                    this._image.src = ""
                },
                _checkImageBitmap: function(a) {
                    var d = this,
                        c = this._image,
                        b = this._flipY,
                        l = this._premultiplyAlpha;
                    this._flipY !== c.flipY || this._premultiplyAlpha !== c.premultiplyAlpha ? createImageBitmap(c, {
                        imageOrientation: b !== c.flipY ? "flipY" : "none",
                        premultiplyAlpha: l ? "premultiply" : "none"
                    }).then(function(g) {
                        c.close && c.close();
                        g.flipY = b;
                        g.premultiplyAlpha = l;
                        d._image = g;
                        a()
                    }, function(a) {
                        cc.error(a.message)
                    }) : a()
                }
            });
        cc.Texture2D = q.exports = t
    }, {
        "../../renderer/gfx": 334,
        "../assets/CCAsset": 73,
        "../event/event-target": 151,
        "../platform/CCClass": 204,
        "../platform/id-generater": 221,
        "../renderer": 236
    }],
    89: [function(h, q, m) {
        h("./CCAsset");
        h("./CCFont");
        h("./CCPrefab");
        h("./CCAudioClip");
        h("./CCScripts");
        h("./CCSceneAsset");
        h("./CCSpriteFrame");
        h("./CCTexture2D");
        h("./CCRenderTexture");
        h("./CCTTFFont");
        h("./CCSpriteAtlas");
        h("./CCBitmapFont");
        h("./CCLabelAtlas");
        h("./CCTextAsset");
        h("./CCJsonAsset");
        h("./CCBufferAsset");
        h("./material")
    }, {
        "./CCAsset": 73,
        "./CCAudioClip": 74,
        "./CCBitmapFont": 75,
        "./CCBufferAsset": 76,
        "./CCFont": 77,
        "./CCJsonAsset": 78,
        "./CCLabelAtlas": 79,
        "./CCPrefab": 80,
        "./CCRenderTexture": 81,
        "./CCSceneAsset": 82,
        "./CCScripts": 83,
        "./CCSpriteAtlas": 84,
        "./CCSpriteFrame": 85,
        "./CCTTFFont": 86,
        "./CCTextAsset": 87,
        "./CCTexture2D": 88,
        "./material": 96
    }],
    90: [function(h, q, m) {
        m = function(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }(h("../CCAsset"));
        var f = h("./effect-parser");
        h = cc.Class({
            name: "cc.EffectAsset",
            extends: m["default"],
            ctor: function() {
                this._effect = null
            },
            properties: {
                properties: Object,
                techniques: [],
                shaders: []
            },
            onLoad: function() {
                if (cc.game.renderType !== cc.game.RENDER_TYPE_CANVAS) {
                    for (var e = cc.renderer._forward._programLib, b = 0; b < this.shaders.length; b++) e.define(this.shaders[b]);
                    this._initEffect()
                }
            },
            _initEffect: function() {
                this._effect || (this._effect = (0, f.parseEffect)(this), Object.freeze(this._effect))
            },
            getInstantiatedEffect: function() {
                this._initEffect();
                return this._effect.clone()
            },
            getEffect: function() {
                this._initEffect();
                return this._effect
            }
        });
        q.exports = cc.EffectAsset = h
    }, {
        "../CCAsset": 73,
        "./effect-parser": 93
    }],
    91: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        var f = h("../CCAsset"),
            e = h("../CCTexture2D"),
            b = h("./CCEffectAsset");
        h("../../utils/texture-util");
        var k = cc.gfx;
        h = cc.Enum({
            SPRITE: "2d-sprite",
            GRAY_SPRITE: "2d-gray-sprite",
            UNLIT: "unlit"
        });
        var c = cc.Class({
            name: "cc.Material",
            extends: f,
            ctor: function() {
                this._manualHash = this.loaded = !1;
                this._dirty = !0;
                this._effect = null
            },
            properties: {
                _defines: {
                    default: void 0,
                    type: Object
                },
                _props: {
                    default: void 0,
                    type: Object
                },
                _effectAsset: {
                    type: b,
                    default: null
                },
                _techniqueIndex: 0,
                _techniqueData: Object,
                effectName: void 0,
                effectAsset: {
                    get: function() {
                        return this._effectAsset
                    },
                    set: function(a) {
                        cc.game.renderType !== cc.game.RENDER_TYPE_CANVAS && ((this._effectAsset = a) ? this._effect = this._effectAsset.getInstantiatedEffect() : cc.error("Can not set an empty effect asset."))
                    }
                },
                effect: {
                    get: function() {
                        return this._effect
                    }
                },
                techniqueIndex: {
                    get: function() {
                        return this._techniqueIndex
                    },
                    set: function(a) {
                        this._techniqueIndex = a;
                        this._effect.switchTechnique(a)
                    }
                }
            },
            statics: {
                getBuiltinMaterial: function(a) {
                    return cc.game.renderType === cc.game.RENDER_TYPE_CANVAS ? new cc.Material : cc.assetManager.builtins.getBuiltin("material", "builtin-" + a)
                },
                BUILTIN_NAME: h,
                createWithBuiltin: function(a, d) {
                    void 0 === d && (d = 0);
                    a = cc.assetManager.builtins.getBuiltin("effect", "builtin-" + a);
                    return c.create(a, d)
                },
                create: function(a, d) {
                    void 0 === d && (d = 0);
                    if (!a) return null;
                    var b = new c;
                    b.effectAsset = a;
                    b.techniqueIndex = d;
                    return b
                }
            },
            setProperty: function(a, d, c, b) {
                if (cc.game.renderType !== cc.game.RENDER_TYPE_CANVAS) {
                    "string" === typeof c && (c = parseInt(c));
                    if (d instanceof e) {
                        var l = d.isAlphaAtlas(),
                            g = "CC_USE_ALPHA_ATLAS_" + a,
                            k = this.getDefine(g, c);
                        (l || k) && this.define(g, l);
                        d.loaded || cc.assetManager.postLoadNative(d)
                    }
                    this._effect.setProperty(a, d, c, b)
                }
            },
            getProperty: function(a, d) {
                "string" === typeof d && (d = parseInt(d));
                return this._effect.getProperty(a, d)
            },
            define: function(a, d, c, b) {
                cc.game.renderType !== cc.game.RENDER_TYPE_CANVAS && ("string" ===
                    typeof c && (c = parseInt(c)), this._effect.define(a, d, c, b))
            },
            getDefine: function(a, d) {
                "string" === typeof d && (d = parseInt(d));
                return this._effect.getDefine(a, d)
            },
            setCullMode: function(a, d) {
                void 0 === a && (a = k.CULL_BACK);
                this._effect.setCullMode(a, d)
            },
            setDepth: function(a, d, c, b) {
                void 0 === a && (a = !1);
                void 0 === d && (d = !1);
                void 0 === c && (c = k.DS_FUNC_LESS);
                this._effect.setDepth(a, d, c, b)
            },
            setBlend: function(a, d, c, b, n, e, t, p, u) {
                void 0 === a && (a = !1);
                void 0 === d && (d = k.BLEND_FUNC_ADD);
                void 0 === c && (c = k.BLEND_SRC_ALPHA);
                void 0 === b &&
                    (b = k.BLEND_ONE_MINUS_SRC_ALPHA);
                void 0 === n && (n = k.BLEND_FUNC_ADD);
                void 0 === e && (e = k.BLEND_SRC_ALPHA);
                void 0 === t && (t = k.BLEND_ONE_MINUS_SRC_ALPHA);
                void 0 === p && (p = 4294967295);
                this._effect.setBlend(a, d, c, b, n, e, t, p, u)
            },
            setStencilEnabled: function(a, d) {
                void 0 === a && (a = k.STENCIL_INHERIT);
                this._effect.setStencilEnabled(a, d)
            },
            setStencil: function(a, d, c, b, n, e, t, p, u) {
                void 0 === a && (a = k.STENCIL_INHERIT);
                void 0 === d && (d = k.DS_FUNC_ALWAYS);
                void 0 === c && (c = 0);
                void 0 === b && (b = 255);
                void 0 === n && (n = k.STENCIL_OP_KEEP);
                void 0 ===
                    e && (e = k.STENCIL_OP_KEEP);
                void 0 === t && (t = k.STENCIL_OP_KEEP);
                void 0 === p && (p = 255);
                this._effect.setStencil(a, d, c, b, n, e, t, p, u)
            },
            updateHash: function(a) {
                this._manualHash = a;
                this._effect && this._effect.updateHash(a)
            },
            getHash: function() {
                return this._manualHash || this._effect && this._effect.getHash()
            },
            onLoad: function() {
                this.effectAsset = this._effectAsset;
                if (this._effect) {
                    this._techniqueIndex && this._effect.switchTechnique(this._techniqueIndex);
                    var a = this._techniqueData = this._techniqueData || {};
                    for (d in a) {
                        var d = parseInt(d);
                        var c = a[d];
                        if (c) {
                            for (var b in c.defines) this.define(b, c.defines[b], d);
                            for (var n in c.props) this.setProperty(n, c.props[n], d)
                        }
                    }
                }
            }
        });
        m["default"] = c;
        cc.Material = c;
        q.exports = m["default"]
    }, {
        "../../utils/texture-util": 294,
        "../CCAsset": 73,
        "../CCTexture2D": 88,
        "./CCEffectAsset": 90
    }],
    92: [function(h, q, m) {
        function f(c, a) {
            for (var d = 0; d < a.length; d++) {
                var b = a[d];
                b.enumerable = b.enumerable || !1;
                b.configurable = !0;
                "value" in b && (b.writable = !0);
                Object.defineProperty(c, b.key, b)
            }
        }

        function e(c, a, d) {
            a && f(c.prototype, a);
            d &&
                f(c, d);
            return c
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var b = function(c) {
                return c && c.__esModule ? c : {
                    default: c
                }
            }(h("../../../renderer/core/pass")),
            k = cc.gfx;
        h = function() {
            function c() {
                this._dirty = !0;
                this._name = "";
                this._technique = null
            }
            var a = c.prototype;
            a._createPassProp = function(a, c) {
                var d = c._properties[a];
                if (d) {
                    var b = Object.create(null);
                    b.name = a;
                    b.type = d.type;
                    d.value instanceof Float32Array ? b.value = new Float32Array(d.value) : b.value = d.value;
                    return c._properties[a] = b
                }
            };
            a._setPassProperty = function(a, c, g, n) {
                var d =
                    g._properties.hasOwnProperty(a);
                if (d) {
                    if (d.value === c) return
                } else this._createPassProp(a, g);
                this._dirty = !0;
                return b["default"].prototype.setProperty.call(g, a, c, n)
            };
            a.setProperty = function(a, c, b, n) {
                var d = !1,
                    l = this.passes,
                    g = 0,
                    k = l.length;
                void 0 !== b && (g = b, k = b + 1);
                for (b = g; b < k; b++) this._setPassProperty(a, c, l[b], n) && (d = !0);
                d || cc.warnID(9103, this.name, a)
            };
            a.getProperty = function(a, c) {
                var d = this.passes;
                if (!(c >= d.length)) {
                    var b = 0,
                        l = d.length;
                    void 0 !== c && (b = c, l = c + 1);
                    for (c = b; c < l; c++)
                        if (b = d[c].getProperty(a), void 0 !==
                            b) return b
                }
            };
            a.define = function(a, c, b, n) {
                var d = !1,
                    l = this.passes,
                    g = 0,
                    k = l.length;
                void 0 !== b && (g = b, k = b + 1);
                for (b = g; b < k; b++) l[b].define(a, c, n) && (d = !0);
                d || cc.warnID(9104, this.name, a)
            };
            a.getDefine = function(a, c) {
                var d = this.passes;
                if (!(c >= d.length)) {
                    var b = 0,
                        l = d.length;
                    void 0 !== c && (b = c, l = c + 1);
                    for (c = b; c < l; c++)
                        if (b = d[c].getDefine(a), void 0 !== b) return b
                }
            };
            a.setCullMode = function(a, c) {
                void 0 === a && (a = k.CULL_BACK);
                var d = this.passes,
                    b = 0,
                    l = d.length;
                void 0 !== c && (b = c, l = c + 1);
                for (c = b; c < l; c++) d[c].setCullMode(a);
                this._dirty = !0
            };
            a.setDepth = function(a, c, b, n) {
                var d = this.passes,
                    l = 0,
                    g = d.length;
                void 0 !== n && (l = n, g = n + 1);
                for (n = l; n < g; n++) d[n].setDepth(a, c, b);
                this._dirty = !0
            };
            a.setBlend = function(a, c, b, n, k, e, p, u, f) {
                var d = this.passes,
                    l = 0,
                    g = d.length;
                void 0 !== f && (l = f, g = f + 1);
                for (f = l; f < g; f++) d[f].setBlend(a, c, b, n, k, e, p, u);
                this._dirty = !0
            };
            a.setStencilEnabled = function(a, c) {
                void 0 === a && (a = k.STENCIL_INHERIT);
                var d = this.passes,
                    b = 0,
                    l = d.length;
                void 0 !== c && (b = c, l = c + 1);
                for (c = b; c < l; c++) d[c].setStencilEnabled(a);
                this._dirty = !0
            };
            a.setStencil = function(a,
                c, b, n, k, e, p, u, f) {
                var d = this.passes,
                    l = 0,
                    g = d.length;
                void 0 !== f && (l = f, g = f + 1);
                for (f = l; f < g; f++) l = d[f], l.setStencilFront(a, c, b, n, k, e, p, u), l.setStencilBack(a, c, b, n, k, e, p, u);
                this._dirty = !0
            };
            e(c, [{
                key: "name",
                get: function() {
                    return this._name
                }
            }, {
                key: "technique",
                get: function() {
                    return this._technique
                }
            }, {
                key: "passes",
                get: function() {
                    return []
                }
            }]);
            return c
        }();
        m["default"] = h;
        cc.EffectBase = h;
        q.exports = m["default"]
    }, {
        "../../../renderer/core/pass": 325
    }],
    93: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(d, b) {
            var l = b.properties || {},
                g = cc.renderer._forward._programLib.getTemplate(b.program);
            b = function(a) {
                if (!g.uniforms.find(function(d) {
                        return d.name === a
                    })) return cc.warnID(9107, d.name, a), "continue"
            };
            for (var n in l) b(n);
            var k = {};
            g.uniforms.forEach(function(d) {
                var b = d.name,
                    g = k[b] = Object.assign({}, d);
                d = (b = l[b]) ? b.type === a["default"].PARAM_TEXTURE_2D ? null : b.type === a["default"].PARAM_INT || b.type === a["default"].PARAM_FLOAT ? Array.isArray(b.value) ? b.value[0] : b.value : new Float32Array(b.value) : c.enums2default[d.type];
                g.value = d
            });
            return k
        }

        function b(a) {
            var d = {};
            cc.renderer._forward._programLib.getTemplate(a.program).defines.forEach(function(a) {
                d[a.name] = c.enums2default[a.type]
            });
            return d
        }
        m.__esModule = !0;
        m.parseEffect = function(a) {
            for (var c = a.techniques.length, g = Array(c), t = 0; t < c; ++t) {
                for (var p = a.techniques[t], u = p.name || t, f = p.passes.length, h = Array(f), B = 0; B < f; ++B) {
                    var E = p.passes[B],
                        y = E.name || B,
                        z = a.name + "-" + u + "-" + y,
                        x = E.stage || "opaque",
                        m = e(a, E),
                        G = b(E);
                    y = h[B] = new k["default"](y, z, E.program, x, m, G);
                    E.rasterizerState && y.setCullMode(E.rasterizerState.cullMode);
                    (z = E.blendState && E.blendState.targets[0]) && y.setBlend(z.blend, z.blendEq, z.blendSrc, z.blendDst, z.blendAlphaEq, z.blendSrcAlpha, z.blendDstAlpha, z.blendColor);
                    if (E = E.depthStencilState) y.setDepth(E.depthTest, E.depthWrite, E.depthFunc), y.setStencilFront(E.stencilTest, E.stencilFuncFront, E.stencilRefFront, E.stencilMaskFront, E.stencilFailOpFront, E.stencilZFailOpFront, E.stencilZPassOpFront, E.stencilWriteMaskFront), y.setStencilBack(E.stencilTest, E.stencilFuncBack, E.stencilRefBack, E.stencilMaskBack, E.stencilFailOpBack,
                        E.stencilZFailOpBack, E.stencilZPassOpBack, E.stencilWriteMaskBack)
                }
                g[t] = new l["default"](u, h)
            }
            return new d["default"](a.name, g, 0, a)
        };
        var k = f(h("../../../renderer/core/pass")),
            c = h("../../../renderer/types"),
            a = f(h("../../../renderer/enums")),
            d = f(h("./effect")),
            l = f(h("../../../renderer/core/technique"));
        !1
    }, {
        "../../../renderer/core/pass": 325,
        "../../../renderer/core/technique": 327,
        "../../../renderer/enums": 329,
        "../../../renderer/types": 358,
        "./effect": 95
    }],
    94: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ?
                a : {
                    default: a
                }
        }

        function e(a, c) {
            for (var d = 0; d < c.length; d++) {
                var b = c[d];
                b.enumerable = b.enumerable || !1;
                b.configurable = !0;
                "value" in b && (b.writable = !0);
                Object.defineProperty(a, b.key, b)
            }
        }

        function b(a, c, b) {
            c && e(a.prototype, c);
            b && e(a, b);
            return a
        }

        function k(a, c) {
            a.prototype = Object.create(c.prototype);
            a.prototype.constructor = a;
            a.__proto__ = c
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var c = f(h("../../../renderer/murmurhash2_gc")),
            a = f(h("./utils"));
        h = function(d) {
            function l(a) {
                var c = d.call(this) || this;
                c._effect = void 0;
                c._passes = [];
                c._stagePasses = {};
                c._hash = 0;
                c.init(a);
                return c
            }
            k(l, d);
            b(l, [{
                key: "effect",
                get: function() {
                    return this._effect
                }
            }, {
                key: "name",
                get: function() {
                    return this._effect && this._effect.name + " (variant)"
                }
            }, {
                key: "passes",
                get: function() {
                    return this._passes
                }
            }, {
                key: "stagePasses",
                get: function() {
                    return this._stagePasses
                }
            }]);
            var g = l.prototype;
            g._onEffectChanged = function() {};
            g.init = function(a) {
                a instanceof l && (a = a.effect);
                this._effect = a;
                this._dirty = !0;
                if (a) {
                    a = a.passes;
                    var d = this._passes;
                    d.length = 0;
                    for (var c =
                            this._stagePasses = {}, b = 0; b < a.length; b++) {
                        var g = d[b] = Object.setPrototypeOf({}, a[b]);
                        g._properties = Object.setPrototypeOf({}, a[b]._properties);
                        g._defines = Object.setPrototypeOf({}, a[b]._defines);
                        c[g._stage] || (c[g._stage] = []);
                        c[g._stage].push(g)
                    }
                }
            };
            g.updateHash = function(a) {};
            g.getHash = function() {
                if (!this._dirty) return this._hash;
                this._dirty = !1;
                var d = "" + a["default"].serializePasses(this._passes);
                var b = this._effect;
                b && (d += a["default"].serializePasses(b.passes));
                this._hash = (0, c["default"])(d, 666);
                this.updateHash(this._hash);
                return this._hash
            };
            return l
        }(f(h("./effect-base"))["default"]);
        m["default"] = h;
        cc.EffectVariant = h;
        q.exports = m["default"]
    }, {
        "../../../renderer/murmurhash2_gc": 352,
        "./effect-base": 92,
        "./utils": 99
    }],
    95: [function(h, q, m) {
        function f(b, c) {
            for (var a = 0; a < c.length; a++) {
                var d = c[a];
                d.enumerable = d.enumerable || !1;
                d.configurable = !0;
                "value" in d && (d.writable = !0);
                Object.defineProperty(b, d.key, d)
            }
        }

        function e(b, c, a) {
            c && f(b.prototype, c);
            a && f(b, a);
            return b
        }

        function b(b, c) {
            b.prototype = Object.create(c.prototype);
            b.prototype.constructor =
                b;
            b.__proto__ = c
        }
        m.__esModule = !0;
        m["default"] = void 0;
        h = function(k) {
            function c(a, c, b, n) {
                var d = k.call(this) || this;
                d._techniques = [];
                d._asset = null;
                d.init(a, c, b, n, !0);
                return d
            }
            b(c, k);
            e(c, [{
                key: "technique",
                get: function() {
                    return this._technique
                }
            }, {
                key: "passes",
                get: function() {
                    return this._technique.passes
                }
            }]);
            var a = c.prototype;
            a.init = function(a, c, b, n, k) {
                this._name = a;
                this._techniques = c;
                this._technique = c[b];
                this._asset = n
            };
            a.switchTechnique = function(a) {
                a >= this._techniques.length ? cc.warn("Can not switch to technique with index [" +
                    a + "]") : this._technique = this._techniques[a]
            };
            a.clear = function() {
                this._techniques = []
            };
            a.clone = function() {
                for (var a = [], b = 0; b < this._techniques.length; b++) a.push(this._techniques[b].clone());
                b = this._techniques.indexOf(this._technique);
                return new c(this._name, a, b, this._asset)
            };
            return c
        }(function(b) {
            return b && b.__esModule ? b : {
                default: b
            }
        }(h("./effect-base"))["default"]);
        m["default"] = h;
        cc.Effect = h;
        q.exports = m["default"]
    }, {
        "./effect-base": 92
    }],
    96: [function(h, q, m) {
            h("./CCEffectAsset");
            h("./CCMaterial");
            h("./material-variant")
        },
        {
            "./CCEffectAsset": 90,
            "./CCMaterial": 91,
            "./material-variant": 98
        }
    ],
    97: [function(h, q, m) {
        function f(c) {
            return c && c.__esModule ? c : {
                default: c
            }
        }

        function e(c, a) {
            c.prototype = Object.create(a.prototype);
            c.prototype.constructor = c;
            c.__proto__ = a
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var b = f(h("./utils"));
        h = f(h("../../utils/pool"));
        var k = new(function(c) {
            function a() {
                var a = arguments.length;
                for (var d = Array(a), b = 0; b < a; b++) d[b] = arguments[b];
                a = c.call.apply(c, [this].concat(d)) || this;
                a.enabled = !1;
                a._pool = {};
                return a
            }
            e(a,
                c);
            var d = a.prototype;
            d.get = function(a, d) {
                var c = this._pool;
                if (a instanceof cc.MaterialVariant) {
                    if (!a._owner) return a._owner = d, a;
                    if (a._owner === d) return a;
                    a = a.material
                }
                if (this.enabled) {
                    var l = a.effectAsset._uuid;
                    if (c[l]) {
                        var g = b["default"].serializeDefines(a._effect._defines) + b["default"].serializeTechniques(a._effect._techniques);
                        g = c[l][g] && c[l][g].pop()
                    }
                }
                g ? this.count-- : (g = new cc.MaterialVariant(a), g._name = a._name + " (Instance)", g._uuid = a._uuid);
                g._owner = d;
                return g
            };
            d.put = function(a) {
                if (this.enabled &&
                    a._owner) {
                    var d = this._pool,
                        c = a.effectAsset._uuid;
                    d[c] || (d[c] = {});
                    var l = b["default"].serializeDefines(a._effect._defines) + b["default"].serializeTechniques(a._effect._techniques);
                    d[c][l] || (d[c][l] = []);
                    this.count > this.maxSize || (this._clean(a), d[c][l].push(a), this.count++)
                }
            };
            d.clear = function() {
                this._pool = {};
                this.count = 0
            };
            d._clean = function(a) {
                a._owner = null
            };
            return a
        }(h["default"]));
        h["default"].register("material", k);
        m["default"] = k;
        q.exports = m["default"]
    }, {
        "../../utils/pool": 288,
        "./utils": 99
    }],
    98: [function(h,
        q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, d) {
            for (var c = 0; c < d.length; c++) {
                var b = d[c];
                b.enumerable = b.enumerable || !1;
                b.configurable = !0;
                "value" in b && (b.writable = !0);
                Object.defineProperty(a, b.key, b)
            }
        }

        function b(a, d, c) {
            d && e(a.prototype, d);
            c && e(a, c);
            return a
        }

        function k(a, d) {
            a.prototype = Object.create(d.prototype);
            a.prototype.constructor = a;
            a.__proto__ = d
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var c = f(h("./CCMaterial")),
            a = f(h("./effect-variant")),
            d = f(h("./material-pool")),
            l, g, n;
        h = cc._decorator.ccclass;
        h = (l = h("cc.MaterialVariant"), l(g = (n = function(l) {
            function g(a) {
                var d = l.call(this) || this;
                d._owner = null;
                d._material = null;
                d.init(a);
                return d
            }
            k(g, l);
            g.createWithBuiltin = function(a, d) {
                return g.create(c["default"].getBuiltinMaterial(a), d)
            };
            g.create = function(a, c) {
                return a ? d["default"].get(a, c) : null
            };
            b(g, [{
                key: "uuid",
                get: function() {
                    return this._material.uuid
                }
            }, {
                key: "owner",
                get: function() {
                    return this._owner
                }
            }, {
                key: "material",
                get: function() {
                    return this._material
                }
            }]);
            g.prototype.init = function(d) {
                this._effect =
                    new a["default"](d.effect);
                this._effectAsset = d._effectAsset;
                this._material = d
            };
            return g
        }(c["default"]), n)) || g);
        m["default"] = h;
        cc.MaterialVariant = h;
        q.exports = m["default"]
    }, {
        "./CCMaterial": 91,
        "./effect-variant": 94,
        "./material-pool": 97
    }],
    99: [function(h, q, m) {
        function f(b) {
            var c = "",
                a;
            for (a in b) c += a + b[a];
            return c
        }

        function e(k) {
            var c = "",
                a;
            for (a in k) {
                var d = k[a],
                    l = d.value;
                l && (d.type === b["default"].PARAM_TEXTURE_2D || d.type === b["default"].PARAM_TEXTURE_CUBE ? c += l._id + ";" : c += l.toString() + ";")
            }
            return c
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var b = function(b) {
            return b && b.__esModule ? b : {
                default: b
            }
        }(h("../../../renderer/enums"));
        m["default"] = {
            serializeDefines: f,
            serializePasses: function(b) {
                for (var c = "", a = 0; a < b.length; a++) {
                    var d = b[a],
                        l = d._programName + d._cullMode;
                    d._blend && (l += d._blendEq + d._blendAlphaEq + d._blendSrc + d._blendDst + d._blendSrcAlpha + d._blendDstAlpha + d._blendColor);
                    d._depthTest && (l += d._depthWrite + d._depthFunc);
                    d._stencilTest && (l += d._stencilFuncFront + d._stencilRefFront + d._stencilMaskFront + d._stencilFailOpFront +
                        d._stencilZFailOpFront + d._stencilZPassOpFront + d._stencilWriteMaskFront + d._stencilFuncBack + d._stencilRefBack + d._stencilMaskBack + d._stencilFailOpBack + d._stencilZFailOpBack + d._stencilZPassOpBack + d._stencilWriteMaskBack);
                    l += e(d._properties);
                    l += f(d._defines);
                    c += l
                }
                return c
            },
            serializeUniforms: e
        };
        q.exports = m["default"]
    }, {
        "../../../renderer/enums": 329
    }],
    100: [function(h, q, m) {
        function f(c, b) {
            var l = b._target;
            if (l) {
                var g = l;
                var n = a;
                var k = d;
                a: {
                    for (var e = g, f = n, h = k, w = c._parent.scaleX, z = c._parent.scaleY, x = 0, m = 0, G =
                            c._parent;;) {
                        x += G.x;
                        m += G.y;
                        G = G._parent;
                        if (!G) {
                            f.x = f.y = 0;
                            h.x = h.y = 1;
                            break a
                        }
                        if (G === e) break;
                        var F = G.scaleX,
                            q = G.scaleY;
                        x *= F;
                        m *= q;
                        w *= F;
                        z *= q
                    }
                    h.x = 0 !== w ? 1 / w : 1;h.y = 0 !== z ? 1 / z : 1;f.x = -x;f.y = -m
                }
            } else g = c._parent;
            e = g instanceof cc.Scene ? cc.visibleRect : g._contentSize;
            f = g._anchorPoint;
            h = (!0, g instanceof cc.Scene);
            w = c.x;
            z = c.y;
            g = c._anchorPoint;
            b._alignFlags & 56 && (F = e.width, h ? (m = cc.visibleRect.left.x, G = cc.visibleRect.right.x) : (m = -f.x * F, G = m + F), m += b._isAbsLeft ? b._left : b._left * F, G -= b._isAbsRight ? b._right : b._right * F, l &&
                (m += n.x, m *= k.x, G += n.x, G *= k.x), x = g.x, q = c.scaleX, 0 > q && (x = 1 - x, q = -q), b.isStretchWidth ? (w = G - m, 0 !== q && (c.width = w / q), w = m + x * w) : (w = c.width * q, b.isAlignHorizontalCenter ? (m = b._isAbsHorizontalCenter ? b._horizontalCenter : b._horizontalCenter * F, G = (.5 - f.x) * e.width, l && (m *= k.x, G += n.x, G *= k.x), w = G + (x - .5) * w + m) : w = b.isAlignLeft ? m + x * w : G + (x - 1) * w));
            b._alignFlags & 7 && (z = e.height, h ? (m = cc.visibleRect.bottom.y, x = cc.visibleRect.top.y) : (m = -f.y * z, x = m + z), m += b._isAbsBottom ? b._bottom : b._bottom * z, x -= b._isAbsTop ? b._top : b._top * z, l && (m += n.y,
                m *= k.y, x += n.y, x *= k.y), h = g.y, G = c.scaleY, 0 > G && (h = 1 - h, G = -G), b.isStretchHeight ? (g = x - m, 0 !== G && (c.height = g / G), z = m + h * g) : (g = c.height * G, b.isAlignVerticalCenter ? (b = b._isAbsVerticalCenter ? b._verticalCenter : b._verticalCenter * z, e = (.5 - f.y) * e.height, l && (b *= k.y, e += n.y, e *= k.y), z = e + (h - .5) * g + b) : z = b.isAlignBottom ? m + h * g : x + (h - 1) * g));
            c.setPosition(w, z)
        }

        function e(a) {
            var d = a._widget;
            d && (!1, f(a, d), !0, d.alignMode !== c.ALWAYS ? g.remove(d) : l.push(d));
            a = a._children;
            for (d = 0; d < a.length; d++) {
                var b = a[d];
                b._active && e(b)
            }
        }

        function b() {
            !1;
            var a = cc.director.getScene();
            if (a) {
                g.isAligning = !0;
                if (g._nodesOrderDirty) l.length = 0, e(a), g._nodesOrderDirty = !1;
                else {
                    var d = g._activeWidgetsIterator;
                    !1;
                    for (d.i = 0; d.i < l.length; ++d.i) a = l[d.i], f(a.node, a)
                }
                g.isAligning = !1
            }!1
        }

        function k(a) {
            var d = a._parent;
            cc.Node.isNode(d) && k(d);
            var c = a._widget || a.getComponent(cc.Widget);
            c && d && f(a, c)
        }!0;
        h("../CCNode");
        var c = cc.Enum({
                ONCE: 0,
                ON_WINDOW_RESIZE: 1,
                ALWAYS: 2
            }),
            a = cc.Vec2.ZERO,
            d = cc.Vec2.ONE;
        !1;
        var l = [],
            g = cc._widgetManager = q.exports = {
                _AlignFlags: {
                    TOP: 1,
                    MID: 2,
                    BOT: 4,
                    LEFT: 8,
                    CENTER: 16,
                    RIGHT: 32
                },
                isAligning: !1,
                _nodesOrderDirty: !1,
                _activeWidgetsIterator: new cc.js.array.MutableForwardIterator(l),
                init: function(a) {
                    a.on(cc.Director.EVENT_AFTER_UPDATE, b);
                    !1;
                    a = this.onResized.bind(this);
                    cc.view.on("canvas-resize", a);
                    window.addEventListener("orientationchange", a)
                },
                add: function(a) {
                    a.node._widget = a;
                    this._nodesOrderDirty = !0;
                    !1
                },
                remove: function(a) {
                    a.node._widget = null;
                    this._activeWidgetsIterator.remove(a);
                    !1
                },
                onResized: function() {
                    var a = cc.director.getScene();
                    a && this.refreshWidgetOnResized(a)
                },
                refreshWidgetOnResized: function(a) {
                    var d = cc.Node.isNode(a) && a.getComponent(cc.Widget);
                    d && d.enabled && d.alignMode === c.ON_WINDOW_RESIZE && this.add(d);
                    a = a._children;
                    for (d = 0; d < a.length; d++) this.refreshWidgetOnResized(a[d])
                },
                updateAlignment: k,
                AlignMode: c
            };
        !1
    }, {
        "../CCNode": 40
    }],
    101: [function(h, q, m) {
        function f() {
            for (var a = 0, d = Number.MAX_VALUE; a < v.length; a++) {
                var c = v[a];
                c._depth < d && (E.main = c, d = c._depth)
            }
        }

        function e() {
            if (A) {
                var a = A.getNode(),
                    d = cc.game.canvas;
                a.z = d.height / 1.1566;
                a.x = d.width / 2;
                a.y = d.height / 2
            }
        }
        var b = h("../value-types"),
            k = h("../geom-utils"),
            c = h("../utils/affine-transform"),
            a = h("../renderer/index"),
            d = h("../renderer/render-flow"),
            l = h("../CCGame"),
            g = null;
        !1;
        g = h("../../renderer/scene/camera");
        var n = cc.mat4(),
            w = cc.mat4(),
            t = cc.v3(),
            p = cc.v3(),
            u = cc.v3(),
            v = [],
            A = null;
        h = cc.Enum({
            COLOR: 1,
            DEPTH: 2,
            STENCIL: 4
        });
        var B = cc.Enum({
                OPAQUE: 1,
                TRANSPARENT: 2
            }),
            E = cc.Class({
                name: "cc.Camera",
                extends: cc.Component,
                ctor: function() {
                    if (l.renderType !== l.RENDER_TYPE_CANVAS) {
                        var a = new g;
                        a.setStages(["opaque"]);
                        a.dirty = !0;
                        this._inited = !1;
                        this._camera = a
                    } else this._inited = !0
                },
                editor: !1,
                properties: {
                    _cullingMask: 4294967295,
                    _clearFlags: h.DEPTH | h.STENCIL,
                    _backgroundColor: cc.color(0, 0, 0, 255),
                    _depth: 0,
                    _zoomRatio: 1,
                    _targetTexture: null,
                    _fov: 60,
                    _orthoSize: 10,
                    _nearClip: 1,
                    _farClip: 4096,
                    _ortho: !0,
                    _rect: cc.rect(0, 0, 1, 1),
                    _renderStages: 1,
                    _alignWithScreen: !0,
                    zoomRatio: {
                        get: function() {
                            return this._zoomRatio
                        },
                        set: function(a) {
                            this._zoomRatio = a
                        },
                        tooltip: !1
                    },
                    fov: {
                        get: function() {
                            return this._fov
                        },
                        set: function(a) {
                            this._fov = a
                        },
                        tooltip: !1
                    },
                    orthoSize: {
                        get: function() {
                            return this._orthoSize
                        },
                        set: function(a) {
                            this._orthoSize = a
                        },
                        tooltip: !1
                    },
                    nearClip: {
                        get: function() {
                            return this._nearClip
                        },
                        set: function(a) {
                            this._nearClip = a;
                            this._updateClippingpPlanes()
                        },
                        tooltip: !1
                    },
                    farClip: {
                        get: function() {
                            return this._farClip
                        },
                        set: function(a) {
                            this._farClip = a;
                            this._updateClippingpPlanes()
                        },
                        tooltip: !1
                    },
                    ortho: {
                        get: function() {
                            return this._ortho
                        },
                        set: function(a) {
                            this._ortho = a;
                            this._updateProjection()
                        },
                        tooltip: !1
                    },
                    rect: {
                        get: function() {
                            return this._rect
                        },
                        set: function(a) {
                            this._rect = a;
                            this._updateRect()
                        },
                        tooltip: !1
                    },
                    cullingMask: {
                        get: function() {
                            return this._cullingMask
                        },
                        set: function(a) {
                            this._cullingMask = a;
                            this._updateCameraMask()
                        },
                        tooltip: !1
                    },
                    clearFlags: {
                        get: function() {
                            return this._clearFlags
                        },
                        set: function(a) {
                            this._clearFlags = a;
                            this._camera && this._camera.setClearFlags(a)
                        },
                        tooltip: !1
                    },
                    backgroundColor: {
                        get: function() {
                            return this._backgroundColor
                        },
                        set: function(a) {
                            this._backgroundColor.equals(a) || (this._backgroundColor.set(a), this._updateBackgroundColor())
                        },
                        tooltip: !1
                    },
                    depth: {
                        get: function() {
                            return this._depth
                        },
                        set: function(a) {
                            E.main ===
                                this ? this._depth < a && f() : E.main && a < E.main._depth && v.includes(this) && (E.main = this);
                            this._depth = a;
                            this._camera && this._camera.setPriority(a)
                        },
                        tooltip: !1
                    },
                    targetTexture: {
                        get: function() {
                            return this._targetTexture
                        },
                        set: function(a) {
                            this._targetTexture = a;
                            this._updateTargetTexture()
                        },
                        tooltip: !1
                    },
                    renderStages: {
                        get: function() {
                            return this._renderStages
                        },
                        set: function(a) {
                            this._renderStages = a;
                            this._updateStages()
                        },
                        tooltip: !1
                    },
                    alignWithScreen: {
                        get: function() {
                            return this._alignWithScreen
                        },
                        set: function(a) {
                            this._alignWithScreen =
                                a
                        }
                    },
                    _is3D: {
                        get: function() {
                            return this.node && this.node._is3DNode
                        }
                    }
                },
                statics: {
                    main: null,
                    cameras: v,
                    ClearFlags: h,
                    findCamera: function(a) {
                        for (var d = 0, c = v.length; d < c; d++) {
                            var b = v[d];
                            if (b.containsNode(a)) return b
                        }
                        return null
                    },
                    _findRendererCamera: function(d) {
                        for (var c = a.scene._cameras, b = 0; b < c._count; b++)
                            if (c._data[b]._cullingMask & d._cullingMask) return c._data[b];
                        return null
                    },
                    _setupDebugCamera: function() {
                        if (!A && l.renderType !== l.RENDER_TYPE_CANVAS) {
                            var d = new g;
                            A = d;
                            d.setStages(["opaque"]);
                            d.setFov(60 * Math.PI /
                                180);
                            d.setNear(.1);
                            d.setFar(4096);
                            d.dirty = !0;
                            d.cullingMask = 1 << cc.Node.BuiltinGroupIndex.DEBUG;
                            d.setPriority(cc.macro.MAX_ZINDEX);
                            d.setClearFlags(0);
                            d.setColor(0, 0, 0, 0);
                            var c = new cc.Node;
                            d.setNode(c);
                            e();
                            cc.view.on("design-resolution-changed", e);
                            a.scene.addCamera(d)
                        }
                    }
                },
                _updateCameraMask: function() {
                    this._camera && (this._camera.cullingMask = this._cullingMask & ~(1 << cc.Node.BuiltinGroupIndex.DEBUG))
                },
                _updateBackgroundColor: function() {
                    if (this._camera) {
                        var a = this._backgroundColor;
                        this._camera.setColor(a.r /
                            255, a.g / 255, a.b / 255, a.a / 255)
                    }
                },
                _updateTargetTexture: function() {
                    if (this._camera) {
                        var a = this._targetTexture;
                        this._camera.setFrameBuffer(a ? a._framebuffer : null)
                    }
                },
                _updateClippingpPlanes: function() {
                    this._camera && (this._camera.setNear(this._nearClip), this._camera.setFar(this._farClip))
                },
                _updateProjection: function() {
                    this._camera && this._camera.setType(this._ortho ? 1 : 0)
                },
                _updateRect: function() {
                    if (this._camera) {
                        var a = this._rect;
                        this._camera.setRect(a.x, a.y, a.width, a.height)
                    }
                },
                _updateStages: function() {
                    var a =
                        this._renderStages,
                        d = [];
                    a & B.OPAQUE && d.push("opaque");
                    a & B.TRANSPARENT && d.push("transparent");
                    this._camera.setStages(d)
                },
                _init: function() {
                    if (!this._inited) {
                        this._inited = !0;
                        var a = this._camera;
                        a && (a.setNode(this.node), a.setClearFlags(this._clearFlags), a.setPriority(this._depth), this._updateBackgroundColor(), this._updateCameraMask(), this._updateTargetTexture(), this._updateClippingpPlanes(), this._updateProjection(), this._updateStages(), this._updateRect(), this.beforeDraw())
                    }
                },
                __preload: function() {
                    this._init()
                },
                onEnable: function() {
                    if (!0, l.renderType !== l.RENDER_TYPE_CANVAS) cc.director.on(cc.Director.EVENT_BEFORE_DRAW, this.beforeDraw, this), a.scene.addCamera(this._camera);
                    v.push(this);
                    (!E.main || this._depth < E.main._depth) && (E.main = this)
                },
                onDisable: function() {
                    if (!0, l.renderType !== l.RENDER_TYPE_CANVAS) cc.director.off(cc.Director.EVENT_BEFORE_DRAW, this.beforeDraw, this), a.scene.removeCamera(this._camera);
                    cc.js.array.fastRemove(v, this);
                    E.main === this && (E.main = null, f())
                },
                getScreenToWorldMatrix2D: function(a) {
                    this.getWorldToScreenMatrix2D(a);
                    b.Mat4.invert(a, a);
                    return a
                },
                getWorldToScreenMatrix2D: function(a) {
                    this.node.getWorldRT(n);
                    var d = this.zoomRatio,
                        c = n.m;
                    c[0] *= d;
                    c[1] *= d;
                    c[4] *= d;
                    c[5] *= d;
                    d = c[12];
                    var l = c[13],
                        g = cc.visibleRect.center;
                    c[12] = g.x - (c[0] * d + c[4] * l);
                    c[13] = g.y - (c[1] * d + c[5] * l);
                    a !== n && b.Mat4.copy(a, n);
                    return a
                },
                getScreenToWorldPoint: function(a, d) {
                    this.node.is3DNode ? (d = d || new cc.Vec3, this._camera.screenToWorld(d, a, cc.visibleRect.width, cc.visibleRect.height)) : (d = d || new cc.Vec2, this.getScreenToWorldMatrix2D(n), b.Vec2.transformMat4(d,
                        a, n));
                    return d
                },
                getWorldToScreenPoint: function(a, d) {
                    this.node.is3DNode ? (d = d || new cc.Vec3, this._camera.worldToScreen(d, a, cc.visibleRect.width, cc.visibleRect.height)) : (d = d || new cc.Vec2, this.getWorldToScreenMatrix2D(n), b.Vec2.transformMat4(d, a, n));
                    return d
                },
                getRay: function(a) {
                    if (!cc.geomUtils) return a;
                    b.Vec3.set(u, a.x, a.y, 1);
                    this._camera.screenToWorld(p, u, cc.visibleRect.width, cc.visibleRect.height);
                    this.ortho ? (b.Vec3.set(u, a.x, a.y, -1), this._camera.screenToWorld(t, u, cc.visibleRect.width, cc.visibleRect.height)) :
                        this.node.getWorldPosition(t);
                    return k.Ray.fromPoints(new k.Ray, t, p)
                },
                containsNode: function(a) {
                    return 0 < (a._cullingMask & this.cullingMask)
                },
                render: function(a) {
                    a = a || cc.director.getScene();
                    if (!a) return null;
                    this.node.getWorldMatrix(n);
                    this.beforeDraw();
                    d.renderCamera(this._camera, a)
                },
                _onAlignWithScreen: function() {
                    var a = cc.game.canvas.height / cc.view._scaleY;
                    this._targetTexture && (!1, a = cc.visibleRect.height);
                    var d = this._fov * cc.macro.RAD;
                    this.node.z = a / (2 * Math.tan(d / 2));
                    d = 2 * Math.atan(Math.tan(d / 2) / this.zoomRatio);
                    this._camera.setFov(d);
                    this._camera.setOrthoHeight(a / 2 / this.zoomRatio);
                    this.node.setRotation(0, 0, 0, 1)
                },
                beforeDraw: function() {
                    if (this._camera) {
                        if (this._alignWithScreen) this._onAlignWithScreen();
                        else {
                            var a = this._fov * cc.macro.RAD;
                            a = 2 * Math.atan(Math.tan(a / 2) / this.zoomRatio);
                            this._camera.setFov(a);
                            this._camera.setOrthoHeight(this._orthoSize / this.zoomRatio)
                        }
                        this._camera.dirty = !0
                    }
                }
            });
        cc.js.mixin(E.prototype, {
            getNodeToCameraTransform: function(a) {
                var d = c.identity();
                a.getWorldMatrix(w);
                this.containsNode(a) &&
                    (this.getWorldToCameraMatrix(n), b.Mat4.mul(w, w, n));
                c.fromMat4(d, w);
                return d
            },
            getCameraToWorldPoint: function(a, d) {
                return this.getScreenToWorldPoint(a, d)
            },
            getWorldToCameraPoint: function(a, d) {
                return this.getWorldToScreenPoint(a, d)
            },
            getCameraToWorldMatrix: function(a) {
                return this.getScreenToWorldMatrix2D(a)
            },
            getWorldToCameraMatrix: function(a) {
                return this.getWorldToScreenMatrix2D(a)
            }
        });
        q.exports = cc.Camera = E
    }, {
        "../../renderer/scene/camera": 354,
        "../CCGame": 39,
        "../geom-utils": 159,
        "../renderer/index": 236,
        "../renderer/render-flow": 237,
        "../utils/affine-transform": 277,
        "../value-types": 301
    }],
    102: [function(h, q, m) {
        cc.Collider.Box = cc.Class({
            properties: {
                _offset: cc.v2(0, 0),
                _size: cc.size(100, 100),
                offset: {
                    tooltip: !1,
                    get: function() {
                        return this._offset
                    },
                    set: function(f) {
                        this._offset = f
                    },
                    type: cc.Vec2
                },
                size: {
                    tooltip: !1,
                    get: function() {
                        return this._size
                    },
                    set: function(f) {
                        this._size.width = 0 > f.width ? 0 : f.width;
                        this._size.height = 0 > f.height ? 0 : f.height
                    },
                    type: cc.Size
                }
            },
            resetInEditor: !1
        });
        h = cc.Class({
            name: "cc.BoxCollider",
            extends: cc.Collider,
            mixins: [cc.Collider.Box],
            editor: !1
        });
        cc.BoxCollider = q.exports = h
    }, {}],
    103: [function(h, q, m) {
        cc.Collider.Circle = cc.Class({
            properties: {
                _offset: cc.v2(0, 0),
                _radius: 50,
                offset: {
                    tooltip: !1,
                    get: function() {
                        return this._offset
                    },
                    set: function(f) {
                        this._offset = f
                    },
                    type: cc.Vec2
                },
                radius: {
                    tooltip: !1,
                    get: function() {
                        return this._radius
                    },
                    set: function(f) {
                        this._radius = 0 > f ? 0 : f
                    }
                }
            },
            resetInEditor: !1
        });
        h = cc.Class({
            name: "cc.CircleCollider",
            extends: cc.Collider,
            mixins: [cc.Collider.Circle],
            editor: !1
        });
        cc.CircleCollider = q.exports = h
    }, {}],
    104: [function(h, q,
        m) {
        h = cc.Class({
            name: "cc.Collider",
            extends: cc.Component,
            properties: {
                editing: {
                    default: !1,
                    serializable: !1,
                    tooltip: !1
                },
                tag: {
                    tooltip: !1,
                    default: 0,
                    range: [0, 1E7],
                    type: cc.Integer
                }
            },
            onDisable: function() {
                cc.director.getCollisionManager().removeCollider(this)
            },
            onEnable: function() {
                cc.director.getCollisionManager().addCollider(this)
            }
        });
        cc.Collider = q.exports = h
    }, {}],
    105: [function(h, q, m) {
        var f = function(a) {
                return a && a.__esModule ? a : {
                    default: a
                }
            }(h("../value-types/vec2")),
            e = h("./CCContact"),
            b = e.CollisionType,
            k = h("../CCNode").EventType,
            c = new f["default"];
        h = cc.Class({
            mixins: [cc.EventTarget],
            properties: {
                enabled: !1,
                enabledDrawBoundingBox: !1
            },
            ctor: function() {
                this._contacts = [];
                this._colliders = [];
                this._debugDrawer = null;
                this._enabledDebugDraw = !1;
                cc.director._scheduler && cc.director._scheduler.enableForTarget(this)
            },
            update: function(a) {
                if (this.enabled) {
                    var d, c = this._colliders;
                    a = 0;
                    for (d = c.length; a < d; a++) this.updateCollider(c[a]);
                    var g = this._contacts;
                    c = [];
                    a = 0;
                    for (d = g.length; a < d; a++) {
                        var n = g[a].updateState();
                        n !== b.None && c.push([n, g[a]])
                    }
                    a = 0;
                    for (d = c.length; a < d; a++) g = c[a], this._doCollide(g[0], g[1]);
                    this.drawColliders()
                }
            },
            _doCollide: function(a, d) {
                switch (a) {
                    case b.CollisionEnter:
                        var c = "onCollisionEnter";
                        break;
                    case b.CollisionStay:
                        c = "onCollisionStay";
                        break;
                    case b.CollisionExit:
                        c = "onCollisionExit"
                }
                a = d.collider1;
                d = d.collider2;
                var g = a.node._components,
                    n = d.node._components,
                    k;
                var e = 0;
                for (k = g.length; e < k; e++) {
                    var p = g[e];
                    p[c] && p[c](d, a)
                }
                e = 0;
                for (k = n.length; e < k; e++) p = n[e], p[c] && p[c](a, d)
            },
            shouldCollide: function(a, d) {
                a = a.node;
                d = d.node;
                var c = cc.game.collisionMatrix;
                return a !== d && c[a.groupIndex][d.groupIndex]
            },
            initCollider: function(a) {
                if (!a.world) {
                    var d = a.world = {};
                    d.aabb = cc.rect();
                    d.preAabb = cc.rect();
                    d.matrix = cc.mat4();
                    d.radius = 0;
                    a instanceof cc.BoxCollider ? (d.position = null, d.points = [cc.v2(), cc.v2(), cc.v2(), cc.v2()]) : a instanceof cc.PolygonCollider ? (d.position = null, d.points = a.points.map(function(a) {
                        return cc.v2(a.x, a.y)
                    })) : a instanceof cc.CircleCollider && (d.position = cc.v2(), d.points = null)
                }
            },
            updateCollider: function(a) {
                var d = a.offset,
                    b = a.world,
                    g = b.aabb,
                    n = b.matrix;
                a.node.getWorldMatrix(n);
                var k = b.preAabb;
                k.x = g.x;
                k.y = g.y;
                k.width = g.width;
                k.height = g.height;
                if (a instanceof cc.BoxCollider) {
                    a = a.size;
                    g.x = d.x - a.width / 2;
                    g.y = d.y - a.height / 2;
                    g.width = a.width;
                    g.height = a.height;
                    k = b.points;
                    d = k[0];
                    a = k[1];
                    b = k[2];
                    k = k[3];
                    var e = g.x,
                        p = g.y,
                        u = g.width,
                        h = g.height,
                        A = n.m,
                        B = A[0],
                        E = A[1],
                        y = A[4],
                        z = A[5];
                    n = B * e + y * p + A[12];
                    e = E * e + z * p + A[13];
                    p = B * u;
                    u *= E;
                    y *= h;
                    h *= z;
                    a.x = n;
                    a.y = e;
                    b.x = p + n;
                    b.y = u + e;
                    d.x = y + n;
                    d.y = h + e;
                    k.x = p + y + n;
                    k.y = u + h + e;
                    n = Math.min(d.x, a.x, b.x, k.x);
                    h = Math.min(d.y, a.y, b.y, k.y);
                    z = Math.max(d.x,
                        a.x, b.x, k.x);
                    d = Math.max(d.y, a.y, b.y, k.y);
                    g.x = n;
                    g.y = h;
                    g.width = z - n;
                    g.height = d - h
                } else if (a instanceof cc.CircleCollider) f["default"].transformMat4(c, a.offset, n), b.position.x = c.x, b.position.y = c.y, d = n.m, k = d[12], h = d[13], d[12] = d[13] = 0, c.x = a.radius, c.y = 0, f["default"].transformMat4(c, c, n), n = Math.sqrt(c.x * c.x + c.y * c.y), b.radius = n, g.x = b.position.x - n, g.y = b.position.y - n, g.width = 2 * n, g.height = 2 * n, d[12] = k, d[13] = h;
                else if (a instanceof cc.PolygonCollider) {
                    a = a.points;
                    b = b.points;
                    b.length = a.length;
                    h = k = 1E6;
                    u = z = -1E6;
                    y = 0;
                    for (E = a.length; y < E; y++) b[y] || (b[y] = cc.v2()), c.x = a[y].x + d.x, c.y = a[y].y + d.y, f["default"].transformMat4(c, c, n), e = c.x, p = c.y, b[y].x = e, b[y].y = p, e > z && (z = e), e < k && (k = e), p > u && (u = p), p < h && (h = p);
                    g.x = k;
                    g.y = h;
                    g.width = z - k;
                    g.height = u - h
                }
            },
            addCollider: function(a) {
                var d = this._colliders;
                if (-1 === d.indexOf(a)) {
                    for (var c = 0, b = d.length; c < b; c++) {
                        var n = d[c];
                        this.shouldCollide(a, n) && (n = new e(a, n), this._contacts.push(n))
                    }
                    d.push(a);
                    this.initCollider(a)
                }
                a.node.on(k.GROUP_CHANGED, this.onNodeGroupChanged, this)
            },
            removeCollider: function(a) {
                var d =
                    this._colliders,
                    c = d.indexOf(a);
                if (0 <= c) {
                    d.splice(c, 1);
                    d = this._contacts;
                    for (c = d.length - 1; 0 <= c; c--) {
                        var g = d[c];
                        if (g.collider1 === a || g.collider2 === a) g.touching && this._doCollide(b.CollisionExit, g), d.splice(c, 1)
                    }
                    a.node.off(k.GROUP_CHANGED, this.onNodeGroupChanged, this)
                } else cc.errorID(6600)
            },
            onNodeGroupChanged: function(a) {
                a = a.getComponents(cc.Collider);
                for (var d = 0, c = a.length; d < c; d++) {
                    var b = a[d];
                    cc.PhysicsCollider && b instanceof cc.PhysicsCollider || (this.removeCollider(b), this.addCollider(b))
                }
            },
            drawColliders: function() {
                if (this._enabledDebugDraw) {
                    this._checkDebugDrawValid();
                    var a = this._debugDrawer;
                    a.clear();
                    for (var d = this._colliders, c = 0, b = d.length; c < b; c++) {
                        var n = d[c];
                        a.strokeColor = cc.Color.WHITE;
                        if (n instanceof cc.BoxCollider || n instanceof cc.PolygonCollider) {
                            var k = n.world.points;
                            if (0 < k.length) {
                                a.moveTo(k[0].x, k[0].y);
                                for (var e = 1; e < k.length; e++) a.lineTo(k[e].x, k[e].y);
                                a.close();
                                a.stroke()
                            }
                        } else n instanceof cc.CircleCollider && (a.circle(n.world.position.x, n.world.position.y, n.world.radius), a.stroke());
                        this.enabledDrawBoundingBox && (n = n.world.aabb, a.strokeColor = cc.Color.BLUE,
                            a.moveTo(n.xMin, n.yMin), a.lineTo(n.xMin, n.yMax), a.lineTo(n.xMax, n.yMax), a.lineTo(n.xMax, n.yMin), a.close(), a.stroke())
                    }
                }
            },
            _checkDebugDrawValid: function() {
                if (!this._debugDrawer || !this._debugDrawer.isValid) {
                    var a = new cc.Node("COLLISION_MANAGER_DEBUG_DRAW");
                    a.zIndex = cc.macro.MAX_ZINDEX;
                    cc.game.addPersistRootNode(a);
                    this._debugDrawer = a.addComponent(cc.Graphics)
                }
            }
        });
        cc.js.getset(h.prototype, "enabledDebugDraw", function() {
            return this._enabledDebugDraw
        }, function(a) {
            a && !this._enabledDebugDraw ? (this._checkDebugDrawValid(),
                this._debugDrawer.node.active = !0) : !a && this._enabledDebugDraw && (this._debugDrawer.clear(!0), this._debugDrawer.node.active = !1);
            this._enabledDebugDraw = a
        });
        cc.CollisionManager = q.exports = h
    }, {
        "../CCNode": 40,
        "../value-types/vec2": 310,
        "./CCContact": 106
    }],
    106: [function(h, q, m) {
        function f(b, c) {
            this.collider1 = b;
            this.collider2 = c;
            this.touching = !1;
            var a = b instanceof cc.BoxCollider || b instanceof cc.PolygonCollider,
                d = c instanceof cc.BoxCollider || c instanceof cc.PolygonCollider,
                l = b instanceof cc.CircleCollider,
                g = c instanceof
            cc.CircleCollider;
            a && d ? this.testFunc = e.polygonPolygon : l && g ? this.testFunc = e.circleCircle : a && g ? this.testFunc = e.polygonCircle : l && d ? (this.testFunc = e.polygonCircle, this.collider1 = c, this.collider2 = b) : cc.errorID(6601, cc.js.getClassName(b), cc.js.getClassName(c))
        }
        var e = h("./CCIntersection"),
            b = cc.Enum({
                None: 0,
                CollisionEnter: 1,
                CollisionStay: 2,
                CollisionExit: 3
            });
        f.prototype.test = function() {
            var b = this.collider1.world,
                c = this.collider2.world;
            return b.aabb.intersects(c.aabb) ? this.testFunc === e.polygonPolygon ? this.testFunc(b.points,
                c.points) : this.testFunc === e.circleCircle ? this.testFunc(b, c) : this.testFunc === e.polygonCircle ? this.testFunc(b.points, c) : !1 : !1
        };
        f.prototype.updateState = function() {
            var k = this.test(),
                c = b.None;
            k && !this.touching ? (this.touching = !0, c = b.CollisionEnter) : k && this.touching ? c = b.CollisionStay : !k && this.touching && (this.touching = !1, c = b.CollisionExit);
            return c
        };
        f.CollisionType = b;
        q.exports = f
    }, {
        "./CCIntersection": 107
    }],
    107: [function(h, q, m) {
        function f(c, a, d, b) {
            var l = (b.x - d.x) * (c.y - d.y) - (b.y - d.y) * (c.x - d.x),
                n = (a.x - c.x) * (c.y -
                    d.y) - (a.y - c.y) * (c.x - d.x);
            c = (b.y - d.y) * (a.x - c.x) - (b.x - d.x) * (a.y - c.y);
            return 0 !== c && (l /= c, n /= c, 0 <= l && 1 >= l && 0 <= n && 1 >= n) ? !0 : !1
        }

        function e(c, a, d) {
            for (var b = d.length, g = 0; g < b; ++g)
                if (f(c, a, d[g], d[(g + 1) % b])) return !0;
            return !1
        }

        function b(c, a) {
            var d = !1,
                b = c.x;
            c = c.y;
            for (var g = a.length, n = 0, k = g - 1; n < g; k = n++) {
                var e = a[n].x,
                    p = a[n].y,
                    f = a[k].x;
                k = a[k].y;
                p > c !== k > c && b < (f - e) * (c - p) / (k - p) + e && (d = !d)
            }
            return d
        }

        function k(c, a, d, b) {
            var l = d.x - a.x,
                n = d.y - a.y,
                k = l * l + n * n,
                e = ((c.x - a.x) * l + (c.y - a.y) * n) / k;
            a = b ? k ? 0 > e ? a : 1 < e ? d : cc.v2(a.x + e * l, a.y +
                e * n) : a : cc.v2(a.x + e * l, a.y + e * n);
            l = c.x - a.x;
            n = c.y - a.y;
            return Math.sqrt(l * l + n * n)
        }
        h = {};
        h.lineLine = f;
        h.lineRect = function(c, a, d) {
            var b = new cc.Vec2(d.x, d.y),
                g = new cc.Vec2(d.x, d.yMax),
                n = new cc.Vec2(d.xMax, d.yMax);
            d = new cc.Vec2(d.xMax, d.y);
            return f(c, a, b, g) || f(c, a, g, n) || f(c, a, n, d) || f(c, a, d, b) ? !0 : !1
        };
        h.linePolygon = e;
        h.rectRect = function(c, a) {
            var d = c.y,
                b = c.x + c.width,
                g = c.y + c.height,
                n = a.x,
                k = a.y,
                e = a.y + a.height;
            return c.x <= a.x + a.width && b >= n && d <= e && g >= k
        };
        h.rectPolygon = function(c, a) {
            var d, l = new cc.Vec2(c.x, c.y),
                g = new cc.Vec2(c.x,
                    c.yMax),
                n = new cc.Vec2(c.xMax, c.yMax),
                k = new cc.Vec2(c.xMax, c.y);
            if (e(l, g, a) || e(g, n, a) || e(n, k, a) || e(k, l, a)) return !0;
            var t = 0;
            for (d = a.length; t < d; ++t)
                if (b(a[t], c)) return !0;
            return b(l, a) || b(g, a) || b(n, a) || b(k, a) ? !0 : !1
        };
        h.polygonPolygon = function(c, a) {
            var d;
            var l = 0;
            for (d = c.length; l < d; ++l)
                if (e(c[l], c[(l + 1) % d], a)) return !0;
            l = 0;
            for (d = a.length; l < d; ++l)
                if (b(a[l], c)) return !0;
            l = 0;
            for (d = c.length; l < d; ++l)
                if (b(c[l], a)) return !0;
            return !1
        };
        h.circleCircle = function(c, a) {
            return c.position.sub(a.position).mag() < c.radius + a.radius
        };
        h.polygonCircle = function(c, a) {
            var d = a.position;
            if (b(d, c)) return !0;
            for (var l = 0, g = c.length; l < g; l++)
                if (k(d, 0 === l ? c[c.length - 1] : c[l - 1], c[l], !0) < a.radius) return !0;
            return !1
        };
        h.pointInPolygon = b;
        h.pointLineDistance = k;
        cc.Intersection = q.exports = h
    }, {}],
    108: [function(h, q, m) {
        cc.Collider.Polygon = cc.Class({
            properties: {
                threshold: {
                    default: 1,
                    serializable: !1,
                    visible: !1
                },
                _offset: cc.v2(0, 0),
                offset: {
                    get: function() {
                        return this._offset
                    },
                    set: function(f) {
                        this._offset = f
                    },
                    type: cc.Vec2
                },
                points: {
                    tooltip: !1,
                    default: function() {
                        return [cc.v2(-50, -50), cc.v2(50, -50), cc.v2(50, 50), cc.v2(-50, 50)]
                    },
                    type: [cc.Vec2]
                }
            },
            resetPointsByContour: !1
        });
        h = cc.Class({
            name: "cc.PolygonCollider",
            extends: cc.Collider,
            mixins: [cc.Collider.Polygon],
            editor: !1
        });
        cc.PolygonCollider = q.exports = h
    }, {}],
    109: [function(h, q, m) {
        h("./CCCollisionManager");
        h("./CCCollider");
        h("./CCBoxCollider");
        h("./CCCircleCollider");
        h("./CCPolygonCollider")
    }, {
        "./CCBoxCollider": 102,
        "./CCCircleCollider": 103,
        "./CCCollider": 104,
        "./CCCollisionManager": 105,
        "./CCPolygonCollider": 108
    }],
    110: [function(h, q,
        m) {
        function f(a, d) {
            var c = d.constructor._executionOrder;
            d = d._id;
            for (var b = 0, l = a.length - 1, g = l >>> 1; b <= l; g = b + l >>> 1) {
                var n = a[g],
                    k = n.constructor._executionOrder;
                if (k > c) l = g - 1;
                else if (k < c) b = g + 1;
                else if (n = n._id, n > d) l = g - 1;
                else {
                    if (!(n < d)) return g;
                    b = g + 1
                }
            }
            return ~b
        }

        function e(a, d) {
            for (var c = a.array, b = a.i + 1; b < c.length;) {
                var l = c[b];
                l._enabled && l.node._activeInHierarchy ? ++b : (a.removeAt(b), d && (l._objFlags &= ~d))
            }
        }

        function b(a, d) {
            return a.constructor._executionOrder - d.constructor._executionOrder
        }

        function k(a, d, c, b) {
            !0;
            var l = "var a=it.array;for(it.i=0;it.i<a.length;++it.i){var c=a[it.i];" + a + "}";
            b = d ? Function("it", "dt", l) : Function("it", l);
            a = Function("c", "dt", a);
            return function(d, l) {
                try {
                    b(d, l)
                } catch (C) {
                    cc._throw(C);
                    var g = d.array;
                    c && (g[d.i]._objFlags |= c);
                    for (++d.i; d.i < g.length; ++d.i) try {
                        a(g[d.i], l)
                    } catch (G) {
                        cc._throw(G), c && (g[d.i]._objFlags |= c)
                    }
                }
            }
        }

        function c() {
            this.startInvoker = new g(w);
            this.updateInvoker = new n(t);
            this.lateUpdateInvoker = new n(p);
            this._deferredComps = [];
            this._updating = !1
        }
        h("./platform/CCClass");
        m = h("./platform/CCObject").Flags;
        var a = h("./platform/js").array,
            d = m.IsStartCalled,
            l = m.IsOnEnableCalled;
        h = cc.Class({
            __ctor__: function(d) {
                var c = a.MutableForwardIterator;
                this._zero = new c([]);
                this._neg = new c([]);
                this._pos = new c([]);
                !1;
                this._invoke = d
            },
            statics: {
                stableRemoveInactive: e
            },
            add: null,
            remove: null,
            invoke: null
        });
        var g = cc.Class({
                extends: h,
                add: function(a) {
                    var d = a.constructor._executionOrder;
                    (0 === d ? this._zero : 0 > d ? this._neg : this._pos).array.push(a)
                },
                remove: function(a) {
                    var d = a.constructor._executionOrder;
                    (0 === d ? this._zero : 0 > d ? this._neg :
                        this._pos).fastRemove(a)
                },
                cancelInactive: function(a) {
                    e(this._zero, a);
                    e(this._neg, a);
                    e(this._pos, a)
                },
                invoke: function() {
                    var a = this._neg;
                    0 < a.array.length && (a.array.sort(b), this._invoke(a), a.array.length = 0);
                    this._invoke(this._zero);
                    this._zero.array.length = 0;
                    a = this._pos;
                    0 < a.array.length && (a.array.sort(b), this._invoke(a), a.array.length = 0)
                }
            }),
            n = cc.Class({
                extends: h,
                add: function(a) {
                    var d = a.constructor._executionOrder;
                    if (0 === d) this._zero.array.push(a);
                    else {
                        d = 0 > d ? this._neg.array : this._pos.array;
                        var c = f(d, a);
                        0 > c && d.splice(~c, 0, a)
                    }
                },
                remove: function(a) {
                    var d = a.constructor._executionOrder;
                    0 === d ? this._zero.fastRemove(a) : (d = 0 > d ? this._neg : this._pos, a = f(d.array, a), 0 <= a && d.removeAt(a))
                },
                invoke: function(a) {
                    0 < this._neg.array.length && this._invoke(this._neg, a);
                    this._invoke(this._zero, a);
                    0 < this._pos.array.length && this._invoke(this._pos, a)
                }
            }),
            w = k("c.start();c._objFlags|=" + d, !1, d),
            t = k("c.update(dt)", !0),
            p = k("c.lateUpdate(dt)", !0);
        h = cc.Class({
            ctor: c,
            unscheduleAll: c,
            statics: {
                LifeCycleInvoker: h,
                OneOffInvoker: g,
                createInvokeImpl: k,
                invokeOnEnable: function(a) {
                    var d = cc.director._compScheduler,
                        c = a.array;
                    for (a.i = 0; a.i < c.length; ++a.i) {
                        var b = c[a.i];
                        b._enabled && (b.onEnable(), !b.node._activeInHierarchy || d._onEnabled(b))
                    }
                }
            },
            _onEnabled: function(a) {
                cc.director.getScheduler().resumeTarget(a);
                a._objFlags |= l;
                this._updating ? this._deferredComps.push(a) : this._scheduleImmediate(a)
            },
            _onDisabled: function(c) {
                cc.director.getScheduler().pauseTarget(c);
                c._objFlags &= ~l;
                var b = this._deferredComps.indexOf(c);
                0 <= b ? a.fastRemoveAt(this._deferredComps, b) :
                    (!c.start || c._objFlags & d || this.startInvoker.remove(c), c.update && this.updateInvoker.remove(c), c.lateUpdate && this.lateUpdateInvoker.remove(c))
            },
            enableComp: function(a, d) {
                if (!(a._objFlags & l)) {
                    if (a.onEnable) {
                        if (d) {
                            d.add(a);
                            return
                        }
                        a.onEnable();
                        if (!a.node._activeInHierarchy) return
                    }
                    this._onEnabled(a)
                }
            },
            disableComp: function(a) {
                a._objFlags & l && (a.onDisable && a.onDisable(), this._onDisabled(a))
            },
            _scheduleImmediate: function(a) {
                "function" !== typeof a.start || a._objFlags & d || this.startInvoker.add(a);
                "function" === typeof a.update &&
                    this.updateInvoker.add(a);
                "function" === typeof a.lateUpdate && this.lateUpdateInvoker.add(a)
            },
            _deferredSchedule: function() {
                for (var a = this._deferredComps, d = 0, c = a.length; d < c; d++) this._scheduleImmediate(a[d]);
                a.length = 0
            },
            _startForNewComps: function() {
                0 < this._deferredComps.length && (this._deferredSchedule(), this.startInvoker.invoke())
            },
            startPhase: function() {
                this._updating = !0;
                this.startInvoker.invoke();
                this._startForNewComps()
            },
            updatePhase: function(a) {
                this.updateInvoker.invoke(a)
            },
            lateUpdatePhase: function(a) {
                this.lateUpdateInvoker.invoke(a);
                this._updating = !1;
                this._startForNewComps()
            }
        });
        q.exports = h
    }, {
        "./platform/CCClass": 204,
        "./platform/CCObject": 210,
        "./platform/js": 225,
        "./utils/misc": 286
    }],
    111: [function(h, q, m) {
        var f = h("../../animation/animation-animator"),
            e = h("../../animation/animation-clip");
        m = h("../event/event-target");
        var b = h("../platform/js"),
            k = cc.Enum({
                PLAY: "play",
                STOP: "stop",
                PAUSE: "pause",
                RESUME: "resume",
                LASTFRAME: "lastframe",
                FINISHED: "finished"
            });
        h = cc.Class({
            name: "cc.Animation",
            extends: h("./CCComponent"),
            mixins: [m],
            editor: !1,
            statics: {
                EventType: k
            },
            ctor: function() {
                cc.EventTarget.call(this);
                this._animator = null;
                this._nameToState = b.createMap(!0);
                this._didInit = !1;
                this._currentClip = null
            },
            properties: {
                _defaultClip: {
                    default: null,
                    type: e
                },
                defaultClip: {
                    type: e,
                    get: function() {
                        return this._defaultClip
                    },
                    set: function(c) {
                        !0
                    },
                    tooltip: !1
                },
                currentClip: {
                    get: function() {
                        return this._currentClip
                    },
                    set: function(c) {
                        this._currentClip = c
                    },
                    type: e,
                    visible: !1
                },
                _writableClips: {
                    get: function() {
                        return this._clips
                    },
                    set: function(c) {
                        this._didInit = !1;
                        this._clips =
                            c;
                        this._init()
                    },
                    type: [e]
                },
                _clips: {
                    default: [],
                    type: [e],
                    tooltip: !1,
                    visible: !0
                },
                playOnLoad: {
                    default: !1,
                    tooltip: !1
                }
            },
            start: function() {
                if ((!0, this.playOnLoad) && this._defaultClip && (!this._animator || !this._animator.isPlaying)) {
                    var c = this.getAnimationState(this._defaultClip.name);
                    this._animator.playState(c)
                }
            },
            onEnable: function() {
                this._animator && this._animator.resume()
            },
            onDisable: function() {
                this._animator && this._animator.pause()
            },
            onDestroy: function() {
                this.stop()
            },
            getClips: function() {
                return this._clips
            },
            play: function(c,
                a) {
                c = this.playAdditive(c, a);
                this._animator.stopStatesExcept(c);
                return c
            },
            playAdditive: function(c, a) {
                this._init();
                if (c = this.getAnimationState(c || this._defaultClip && this._defaultClip.name)) {
                    this.enabled = !0;
                    var d = this._animator;
                    d.isPlaying && c.isPlaying ? c.isPaused ? d.resumeState(c) : (d.stopState(c), d.playState(c, a)) : d.playState(c, a);
                    this.enabledInHierarchy || d.pause();
                    this.currentClip = c.clip
                }
                return c
            },
            stop: function(c) {
                this._didInit && (c ? (c = this._nameToState[c]) && this._animator.stopState(c) : this._animator.stop())
            },
            pause: function(c) {
                this._didInit && (c ? (c = this._nameToState[c]) && this._animator.pauseState(c) : this.enabled = !1)
            },
            resume: function(c) {
                this._didInit && (c ? (c = this._nameToState[c]) && this._animator.resumeState(c) : this.enabled = !0)
            },
            setCurrentTime: function(c, a) {
                this._init();
                a ? (a = this._nameToState[a]) && this._animator.setStateTime(a, c) : this._animator.setStateTime(c)
            },
            getAnimationState: function(c) {
                this._init();
                c = this._nameToState[c];
                !1;
                c && !c.curveLoaded && this._animator._reloadClip(c);
                return c || null
            },
            addClip: function(c,
                a) {
                if (c) {
                    this._init();
                    cc.js.array.contains(this._clips, c) || this._clips.push(c);
                    a = a || c.name;
                    var d = this._nameToState[a];
                    if (d) {
                        if (d.clip === c) return d;
                        d = this._clips.indexOf(d.clip); - 1 !== d && this._clips.splice(d, 1)
                    }
                    c = new cc.AnimationState(c, a);
                    return this._nameToState[a] = c
                }
                cc.warnID(3900)
            },
            removeClip: function(c, a) {
                if (c) {
                    this._init();
                    var d;
                    for (d in this._nameToState) {
                        var b = this._nameToState[d];
                        if (b.clip === c) break
                    }
                    if (c === this._defaultClip) {
                        if (!a) {
                            !0;
                            cc.warnID(3902);
                            return
                        }
                        this._defaultClip = null
                    }
                    if (b && b.isPlaying) {
                        if (!a) {
                            !0;
                            cc.warnID(3903);
                            return
                        }
                        this.stop(b.name)
                    }
                    this._clips = this._clips.filter(function(a) {
                        return a !== c
                    });
                    b && delete this._nameToState[b.name]
                } else cc.warnID(3901)
            },
            sample: function(c) {
                this._init();
                c ? (c = this._nameToState[c]) && c.sample() : this._animator.sample()
            },
            on: function(c, a, d, b) {
                this._init();
                a = this._EventTargetOn(c, a, d, b);
                if ("lastframe" === c) {
                    c = this._nameToState;
                    for (var l in c) c[l]._lastframeEventOn = !0
                }
                return a
            },
            off: function(c, a, d, b) {
                this._init();
                if ("lastframe" === c) {
                    var l = this._nameToState,
                        n;
                    for (n in l) l[n]._lastframeEventOn = !1
                }
                this._EventTargetOff(c, a, d, b)
            },
            _init: function() {
                this._didInit || (this._didInit = !0, this._animator = new f(this.node, this), this._createStates())
            },
            _createStates: function() {
                this._nameToState = b.createMap(!0);
                for (var c, a = !1, d = 0; d < this._clips.length; ++d) {
                    var l = this._clips[d];
                    l && (c = new cc.AnimationState(l), !1, this._nameToState[c.name] = c, this._defaultClip === l && (a = c))
                }
                this._defaultClip && !a && (c = new cc.AnimationState(this._defaultClip), !1, this._nameToState[c.name] = c)
            }
        });
        h.prototype._EventTargetOn = m.prototype.on;
        h.prototype._EventTargetOff = m.prototype.off;
        cc.Animation = q.exports = h
    }, {
        "../../animation/animation-animator": 10,
        "../../animation/animation-clip": 11,
        "../event/event-target": 151,
        "../platform/js": 225,
        "./CCComponent": 116
    }],
    112: [function(h, q, m) {
        var f = h("../utils/misc");
        m = h("./CCComponent");
        var e = h("../assets/CCAudioClip");
        h = cc.Class({
            name: "cc.AudioSource",
            extends: m,
            editor: !1,
            ctor: function() {
                this.audio = new cc._Audio
            },
            properties: {
                _clip: {
                    default: null,
                    type: e
                },
                _volume: 1,
                _mute: !1,
                _loop: !1,
                _pausedFlag: {
                    default: !1,
                    serializable: !1
                },
                _firstlyEnabled: !0,
                isPlaying: {
                    get: function() {
                        return this.audio.getState() === cc._Audio.State.PLAYING
                    },
                    visible: !1
                },
                clip: {
                    get: function() {
                        return this._clip
                    },
                    set: function(b) {
                        if (b !== this._clip) {
                            if (!(b instanceof e)) return cc.error("Wrong type of AudioClip.");
                            this._clip = b;
                            this.audio.stop();
                            this.audio.src = this._clip;
                            this.preload && this._clip._ensureLoaded()
                        }
                    },
                    type: e,
                    tooltip: !1,
                    animatable: !1
                },
                volume: {
                    get: function() {
                        return this._volume
                    },
                    set: function(b) {
                        this._volume = b = f.clamp01(b);
                        this._mute ||
                            this.audio.setVolume(b);
                        return b
                    },
                    tooltip: !1
                },
                mute: {
                    get: function() {
                        return this._mute
                    },
                    set: function(b) {
                        this._mute = b;
                        this.audio.setVolume(b ? 0 : this._volume);
                        return b
                    },
                    animatable: !1,
                    tooltip: !1
                },
                loop: {
                    get: function() {
                        return this._loop
                    },
                    set: function(b) {
                        this._loop = b;
                        this.audio.setLoop(b);
                        return b
                    },
                    animatable: !1,
                    tooltip: !1
                },
                playOnLoad: {
                    default: !1,
                    tooltip: !1,
                    animatable: !1
                },
                preload: {
                    default: !1,
                    animatable: !1
                }
            },
            _pausedCallback: function() {
                this.audio.getState() === cc._Audio.State.PLAYING && (this.audio.pause(), this._pausedFlag = !0)
            },
            _restoreCallback: function() {
                this._pausedFlag && this.audio.resume();
                this._pausedFlag = !1
            },
            onLoad: function() {
                this.audio.src || (this.audio.src = this._clip);
                this.preload && this._clip._ensureLoaded()
            },
            onEnable: function() {
                this.playOnLoad && this._firstlyEnabled && (this._firstlyEnabled = !1, this.play());
                cc.game.on(cc.game.EVENT_HIDE, this._pausedCallback, this);
                cc.game.on(cc.game.EVENT_SHOW, this._restoreCallback, this)
            },
            onDisable: function() {
                this.stop();
                cc.game.off(cc.game.EVENT_HIDE, this._pausedCallback, this);
                cc.game.off(cc.game.EVENT_SHOW,
                    this._restoreCallback, this)
            },
            onDestroy: function() {
                this.audio.destroy()
            },
            play: function() {
                if (this._clip) {
                    var b = this.audio;
                    b.setVolume(this._mute ? 0 : this._volume);
                    b.setLoop(this._loop);
                    b.setCurrentTime(0);
                    b.play()
                }
            },
            stop: function() {
                this.audio.stop()
            },
            pause: function() {
                this.audio.pause()
            },
            resume: function() {
                this.audio.resume()
            },
            rewind: function() {
                this.audio.setCurrentTime(0)
            },
            getCurrentTime: function() {
                return this.audio.getCurrentTime()
            },
            setCurrentTime: function(b) {
                this.audio.setCurrentTime(b);
                return b
            },
            getDuration: function() {
                return this.audio.getDuration()
            }
        });
        cc.AudioSource = q.exports = h
    }, {
        "../assets/CCAudioClip": 74,
        "../utils/misc": 286,
        "./CCComponent": 116
    }],
    113: [function(h, q, m) {
        function f(b) {
            b.stopPropagation()
        }
        var e = "touchstart touchmove touchend mousedown mousemove mouseup mouseenter mouseleave mousewheel".split(" ");
        h = cc.Class({
            name: "cc.BlockInputEvents",
            extends: h("./CCComponent"),
            editor: {
                menu: "i18n:MAIN_MENU.component.ui/Block Input Events",
                inspector: "packages://inspector/inspectors/comps/block-input-events.js",
                help: "i18n:COMPONENT.help_url.block_input_events"
            },
            onEnable: function() {
                for (var b = 0; b < e.length; b++) this.node.on(e[b], f, this)
            },
            onDisable: function() {
                for (var b = 0; b < e.length; b++) this.node.off(e[b], f, this)
            }
        });
        cc.BlockInputEvents = q.exports = h
    }, {
        "./CCComponent": 116
    }],
    114: [function(h, q, m) {
        m = h("./CCComponent");
        h = h("../utils/gray-sprite-state");
        var f = cc.Enum({
                NONE: 0,
                COLOR: 1,
                SPRITE: 2,
                SCALE: 3
            }),
            e = cc.Enum({
                NORMAL: 0,
                HOVER: 1,
                PRESSED: 2,
                DISABLED: 3
            });
        h = cc.Class({
            name: "cc.Button",
            extends: m,
            mixins: [h],
            ctor: function() {
                this._hovered = this._pressed = !1;
                this._toColor = this._fromColor =
                    null;
                this._time = 0;
                this._transitionFinished = !0;
                this._toScale = this._fromScale = cc.Vec2.ZERO;
                this._sprite = this._spriteMaterial = this._graySpriteMaterial = this._originalScale = null
            },
            editor: !1,
            properties: {
                interactable: {
                    default: !0,
                    tooltip: !1,
                    notify: function() {
                        this._updateState();
                        this.interactable || this._resetState()
                    },
                    animatable: !1
                },
                _resizeToTarget: {
                    animatable: !1,
                    set: function(b) {
                        b && this._resizeNodeToTargetNode()
                    }
                },
                enableAutoGrayEffect: {
                    default: !1,
                    tooltip: !1,
                    notify: function() {
                        this._updateDisabledState(!0)
                    }
                },
                transition: {
                    default: f.NONE,
                    tooltip: !1,
                    type: f,
                    animatable: !1,
                    notify: function(b) {
                        this._updateTransition(b)
                    },
                    formerlySerializedAs: "transition"
                },
                normalColor: {
                    default: cc.Color.WHITE,
                    displayName: "Normal",
                    tooltip: !1,
                    notify: function() {
                        this.transition === f.Color && this._getButtonState() === e.NORMAL && (this._getTarget().opacity = this.normalColor.a);
                        this._updateState()
                    }
                },
                pressedColor: {
                    default: cc.color(211, 211, 211),
                    displayName: "Pressed",
                    tooltip: !1,
                    notify: function() {
                        this.transition === f.Color && this._getButtonState() ===
                            e.PRESSED && (this._getTarget().opacity = this.pressedColor.a);
                        this._updateState()
                    },
                    formerlySerializedAs: "pressedColor"
                },
                hoverColor: {
                    default: cc.Color.WHITE,
                    displayName: "Hover",
                    tooltip: !1,
                    notify: function() {
                        this.transition === f.Color && this._getButtonState() === e.HOVER && (this._getTarget().opacity = this.hoverColor.a);
                        this._updateState()
                    },
                    formerlySerializedAs: "hoverColor"
                },
                disabledColor: {
                    default: cc.color(124, 124, 124),
                    displayName: "Disabled",
                    tooltip: !1,
                    notify: function() {
                        this.transition === f.Color && this._getButtonState() ===
                            e.DISABLED && (this._getTarget().opacity = this.disabledColor.a);
                        this._updateState()
                    }
                },
                duration: {
                    default: .1,
                    range: [0, 10],
                    tooltip: !1
                },
                zoomScale: {
                    default: 1.2,
                    tooltip: !1
                },
                normalSprite: {
                    default: null,
                    type: cc.SpriteFrame,
                    displayName: "Normal",
                    tooltip: !1,
                    notify: function() {
                        this._updateState()
                    }
                },
                pressedSprite: {
                    default: null,
                    type: cc.SpriteFrame,
                    displayName: "Pressed",
                    tooltip: !1,
                    formerlySerializedAs: "pressedSprite",
                    notify: function() {
                        this._updateState()
                    }
                },
                hoverSprite: {
                    default: null,
                    type: cc.SpriteFrame,
                    displayName: "Hover",
                    tooltip: !1,
                    formerlySerializedAs: "hoverSprite",
                    notify: function() {
                        this._updateState()
                    }
                },
                disabledSprite: {
                    default: null,
                    type: cc.SpriteFrame,
                    displayName: "Disabled",
                    tooltip: !1,
                    notify: function() {
                        this._updateState()
                    }
                },
                target: {
                    default: null,
                    type: cc.Node,
                    tooltip: !1,
                    notify: function(b) {
                        this._applyTarget();
                        b && this.target !== b && this._unregisterTargetEvent(b)
                    }
                },
                clickEvents: {
                    default: [],
                    type: cc.Component.EventHandler,
                    tooltip: !1
                }
            },
            statics: {
                Transition: f
            },
            __preload: function() {
                this._applyTarget();
                this._resetState()
            },
            _resetState: function() {
                this._hovered =
                    this._pressed = !1;
                var b = this._getTarget(),
                    k = this.transition,
                    c = this._originalScale;
                k === f.COLOR && this.interactable ? this._setTargetColor(this.normalColor) : k === f.SCALE && c && b.setScale(c.x, c.y);
                this._transitionFinished = !0
            },
            onEnable: function() {
                this.normalSprite && this.normalSprite.ensureLoadTexture();
                this.hoverSprite && this.hoverSprite.ensureLoadTexture();
                this.pressedSprite && this.pressedSprite.ensureLoadTexture();
                this.disabledSprite && this.disabledSprite.ensureLoadTexture();
                !0;
                this._registerNodeEvent();
                this._updateState()
            },
            onDisable: function() {
                this._resetState();
                !0;
                this._unregisterNodeEvent()
            },
            _getTarget: function() {
                return this.target ? this.target : this.node
            },
            _onTargetSpriteFrameChanged: function(b) {
                this.transition === f.SPRITE && this._setCurrentStateSprite(b.spriteFrame)
            },
            _onTargetColorChanged: function(b) {
                this.transition === f.COLOR && this._setCurrentStateColor(b)
            },
            _onTargetScaleChanged: function() {
                var b = this._getTarget();
                this._originalScale && (this.transition !== f.SCALE || this._transitionFinished) && (this._originalScale.x = b.scaleX,
                    this._originalScale.y = b.scaleY)
            },
            _setTargetColor: function(b) {
                var k = this._getTarget();
                b = b.clone();
                k.opacity = b.a;
                b.a = 255;
                k.color = b
            },
            _getStateColor: function(b) {
                switch (b) {
                    case e.NORMAL:
                        return this.normalColor;
                    case e.HOVER:
                        return this.hoverColor;
                    case e.PRESSED:
                        return this.pressedColor;
                    case e.DISABLED:
                        return this.disabledColor
                }
            },
            _getStateSprite: function(b) {
                switch (b) {
                    case e.NORMAL:
                        return this.normalSprite;
                    case e.HOVER:
                        return this.hoverSprite;
                    case e.PRESSED:
                        return this.pressedSprite;
                    case e.DISABLED:
                        return this.disabledSprite
                }
            },
            _setCurrentStateColor: function(b) {
                switch (this._getButtonState()) {
                    case e.NORMAL:
                        this.normalColor = b;
                        break;
                    case e.HOVER:
                        this.hoverColor = b;
                        break;
                    case e.PRESSED:
                        this.pressedColor = b;
                        break;
                    case e.DISABLED:
                        this.disabledColor = b
                }
            },
            _setCurrentStateSprite: function(b) {
                switch (this._getButtonState()) {
                    case e.NORMAL:
                        this.normalSprite = b;
                        break;
                    case e.HOVER:
                        this.hoverSprite = b;
                        break;
                    case e.PRESSED:
                        this.pressedSprite = b;
                        break;
                    case e.DISABLED:
                        this.disabledSprite = b
                }
            },
            update: function(b) {
                var k = this._getTarget();
                this._transitionFinished ||
                    this.transition !== f.COLOR && this.transition !== f.SCALE || (this.time += b, b = 1, 0 < this.duration && (b = this.time / this.duration), 1 <= b && (b = 1), this.transition === f.COLOR ? (k = this._fromColor.lerp(this._toColor, b), this._setTargetColor(k)) : this.transition === f.SCALE && this._originalScale && (k.scale = this._fromScale.lerp(this._toScale, b)), 1 === b && (this._transitionFinished = !0))
            },
            _registerNodeEvent: function() {
                this.node.on(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this);
                this.node.on(cc.Node.EventType.TOUCH_MOVE, this._onTouchMove,
                    this);
                this.node.on(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this);
                this.node.on(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancel, this);
                this.node.on(cc.Node.EventType.MOUSE_ENTER, this._onMouseMoveIn, this);
                this.node.on(cc.Node.EventType.MOUSE_LEAVE, this._onMouseMoveOut, this)
            },
            _unregisterNodeEvent: function() {
                this.node.off(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this);
                this.node.off(cc.Node.EventType.TOUCH_MOVE, this._onTouchMove, this);
                this.node.off(cc.Node.EventType.TOUCH_END, this._onTouchEnded,
                    this);
                this.node.off(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancel, this);
                this.node.off(cc.Node.EventType.MOUSE_ENTER, this._onMouseMoveIn, this);
                this.node.off(cc.Node.EventType.MOUSE_LEAVE, this._onMouseMoveOut, this)
            },
            _registerTargetEvent: function(b) {
                !1;
                b.on(cc.Node.EventType.SCALE_CHANGED, this._onTargetScaleChanged, this)
            },
            _unregisterTargetEvent: function(b) {
                !1;
                b.off(cc.Node.EventType.SCALE_CHANGED, this._onTargetScaleChanged, this)
            },
            _getTargetSprite: function(b) {
                var k = null;
                b && (k = b.getComponent(cc.Sprite));
                return k
            },
            _applyTarget: function() {
                var b = this._getTarget();
                this._sprite = this._getTargetSprite(b);
                this._originalScale || (this._originalScale = cc.Vec2.ZERO);
                this._originalScale.x = b.scaleX;
                this._originalScale.y = b.scaleY;
                this._registerTargetEvent(b)
            },
            _onTouchBegan: function(b) {
                this.interactable && this.enabledInHierarchy && (this._pressed = !0, this._updateState(), b.stopPropagation())
            },
            _onTouchMove: function(b) {
                if (this.interactable && this.enabledInHierarchy && this._pressed) {
                    var k = this.node._hitTest(b.touch.getLocation()),
                        c = this._getTarget(),
                        a = this._originalScale;
                    this.transition === f.SCALE && a ? k ? (this._fromScale.x = a.x, this._fromScale.y = a.y, this._toScale.x = a.x * this.zoomScale, this._toScale.y = a.y * this.zoomScale, this._transitionFinished = !1) : (this.time = 0, this._transitionFinished = !0, c.setScale(a.x, a.y)) : this._applyTransition(k ? e.PRESSED : e.NORMAL);
                    b.stopPropagation()
                }
            },
            _onTouchEnded: function(b) {
                this.interactable && this.enabledInHierarchy && (this._pressed && (cc.Component.EventHandler.emitEvents(this.clickEvents, b), this.node.emit("click",
                    this)), this._pressed = !1, this._updateState(), b.stopPropagation())
            },
            _onTouchCancel: function() {
                this.interactable && this.enabledInHierarchy && (this._pressed = !1, this._updateState())
            },
            _onMouseMoveIn: function() {
                this._pressed || !this.interactable || !this.enabledInHierarchy || this.transition === f.SPRITE && !this.hoverSprite || this._hovered || (this._hovered = !0, this._updateState())
            },
            _onMouseMoveOut: function() {
                this._hovered && (this._hovered = !1, this._updateState())
            },
            _updateState: function() {
                var b = this._getButtonState();
                this._applyTransition(b);
                this._updateDisabledState()
            },
            _getButtonState: function() {
                return this.interactable ? this._pressed ? e.PRESSED : this._hovered ? e.HOVER : e.NORMAL : e.DISABLED
            },
            _updateColorTransitionImmediately: function(b) {
                b = this._getStateColor(b);
                this._setTargetColor(b);
                this._fromColor = b.clone();
                this._toColor = b
            },
            _updateColorTransition: function(b) {
                if (!1, b === e.DISABLED) this._updateColorTransitionImmediately(b);
                else {
                    var k = this._getTarget();
                    b = this._getStateColor(b);
                    this._fromColor = k.color.clone();
                    this._toColor = b;
                    this.time = 0;
                    this._transitionFinished = !1
                }
            },
            _updateSpriteTransition: function(b) {
                b = this._getStateSprite(b);
                this._sprite && b && (this._sprite.spriteFrame = b)
            },
            _updateScaleTransition: function(b) {
                b === e.PRESSED ? this._zoomUp() : this._zoomBack()
            },
            _zoomUp: function() {
                this._originalScale && (this._fromScale.x = this._originalScale.x, this._fromScale.y = this._originalScale.y, this._toScale.x = this._originalScale.x * this.zoomScale, this._toScale.y = this._originalScale.y * this.zoomScale, this.time = 0, this._transitionFinished = !1)
            },
            _zoomBack: function() {
                if (this._originalScale) {
                    var b =
                        this._getTarget();
                    this._fromScale.x = b.scaleX;
                    this._fromScale.y = b.scaleY;
                    this._toScale.x = this._originalScale.x;
                    this._toScale.y = this._originalScale.y;
                    this.time = 0;
                    this._transitionFinished = !1
                }
            },
            _updateTransition: function(b) {
                b === f.COLOR ? this._updateColorTransitionImmediately(e.NORMAL) : b === f.SPRITE && this._updateSpriteTransition(e.NORMAL);
                this._updateState()
            },
            _applyTransition: function(b) {
                var k = this.transition;
                k === f.COLOR ? this._updateColorTransition(b) : k === f.SPRITE ? this._updateSpriteTransition(b) : k === f.SCALE &&
                    this._updateScaleTransition(b)
            },
            _resizeNodeToTargetNode: !1,
            _updateDisabledState: function(b) {
                this._sprite && (this.enableAutoGrayEffect || b) && (b = !1, this.transition === f.SPRITE && this.disabledSprite || (b = this.enableAutoGrayEffect && !this.interactable), this._switchGrayMaterial(b, this._sprite))
            }
        });
        cc.Button = q.exports = h
    }, {
        "../utils/gray-sprite-state": 283,
        "./CCComponent": 116
    }],
    115: [function(h, q, m) {
        var f = h("../camera/CCCamera");
        h = h("./CCComponent");
        var e = cc.Class({
            name: "cc.Canvas",
            extends: h,
            editor: !1,
            resetInEditor: !1,
            statics: {
                instance: null
            },
            properties: {
                _designResolution: cc.size(960, 640),
                designResolution: {
                    get: function() {
                        return cc.size(this._designResolution)
                    },
                    set: function(b) {
                        this._designResolution.width = b.width;
                        this._designResolution.height = b.height;
                        this.applySettings()
                    },
                    tooltip: !1
                },
                _fitWidth: !1,
                _fitHeight: !0,
                fitHeight: {
                    get: function() {
                        return this._fitHeight
                    },
                    set: function(b) {
                        this._fitHeight !== b && (this._fitHeight = b, this.applySettings())
                    },
                    tooltip: !1
                },
                fitWidth: {
                    get: function() {
                        return this._fitWidth
                    },
                    set: function(b) {
                        this._fitWidth !==
                            b && (this._fitWidth = b, this.applySettings())
                    },
                    tooltip: !1
                }
            },
            _fitDesignResolution: !1,
            __preload: function() {
                !1;
                if (e.instance) return cc.warnID(6700, this.node.name, e.instance.node.name);
                e.instance = this;
                this.applySettings();
                var b = this.getComponent(cc.Widget);
                b && b.updateAlignment();
                !1
            },
            start: function() {
                if (!f.main && cc.game.renderType !== cc.game.RENDER_TYPE_CANVAS) {
                    var b = new cc.Node("Main Camera");
                    b.parent = this.node;
                    b.setSiblingIndex(0);
                    b = b.addComponent(f);
                    var k = f.ClearFlags;
                    b.clearFlags = k.COLOR | k.DEPTH | k.STENCIL;
                    b.depth = -1
                }
            },
            onDestroy: function() {
                !1;
                e.instance === this && (e.instance = null)
            },
            applySettings: function() {
                var b = cc.ResolutionPolicy;
                b = this.fitHeight && this.fitWidth ? b.SHOW_ALL : this.fitHeight || this.fitWidth ? this.fitWidth ? b.FIXED_WIDTH : b.FIXED_HEIGHT : b.NO_BORDER;
                var k = this._designResolution;
                !1;
                cc.view.setDesignResolutionSize(k.width, k.height, b)
            }
        });
        cc.Canvas = q.exports = e
    }, {
        "../camera/CCCamera": 101,
        "./CCComponent": 116
    }],
    116: [function(h, q, m) {
        var f = h("../platform/CCObject");
        m = h("../platform/js");
        var e = new(h("../platform/id-generater"))("Comp"),
            b = f.Flags.IsOnLoadCalled,
            k = !!cc.ActionManager;
        h = cc.Class({
            name: "cc.Component",
            extends: f,
            ctor: function() {
                this._id = e.getNewId();
                this.__eventTargets = []
            },
            properties: {
                node: {
                    default: null,
                    visible: !1
                },
                name: {
                    get: function() {
                        if (this._name) return this._name;
                        var c = cc.js.getClassName(this),
                            a = c.lastIndexOf(".");
                        0 <= a && (c = c.slice(a + 1));
                        return this.node.name + "<" + c + ">"
                    },
                    set: function(c) {
                        this._name = c
                    },
                    visible: !1
                },
                uuid: {
                    get: function() {
                        return this._id
                    },
                    visible: !1
                },
                __scriptAsset: !1,
                _enabled: !0,
                enabled: {
                    get: function() {
                        return this._enabled
                    },
                    set: function(c) {
                        if (this._enabled !== c && (this._enabled = c, this.node._activeInHierarchy)) {
                            var a = cc.director._compScheduler;
                            c ? a.enableComp(this) : a.disableComp(this)
                        }
                    },
                    visible: !1,
                    animatable: !0
                },
                enabledInHierarchy: {
                    get: function() {
                        return this._enabled && this.node._activeInHierarchy
                    },
                    visible: !1
                },
                _isOnLoadCalled: {
                    get: function() {
                        return this._objFlags & b
                    }
                }
            },
            update: null,
            lateUpdate: null,
            __preload: null,
            onLoad: null,
            start: null,
            onEnable: null,
            onDisable: null,
            onDestroy: null,
            onFocusInEditor: null,
            onLostFocusInEditor: null,
            resetInEditor: null,
            addComponent: function(c) {
                return this.node.addComponent(c)
            },
            getComponent: function(c) {
                return this.node.getComponent(c)
            },
            getComponents: function(c) {
                return this.node.getComponents(c)
            },
            getComponentInChildren: function(c) {
                return this.node.getComponentInChildren(c)
            },
            getComponentsInChildren: function(c) {
                return this.node.getComponentsInChildren(c)
            },
            _getLocalBounds: null,
            onRestore: null,
            destroy: function() {
                !1;
                this._super() && this._enabled && this.node._activeInHierarchy && cc.director._compScheduler.disableComp(this)
            },
            _onPreDestroy: function() {
                k && cc.director.getActionManager().removeAllActionsFromTarget(this);
                this.unscheduleAllCallbacks();
                for (var c = this.__eventTargets, a = c.length - 1; 0 <= a; --a) {
                    var d = c[a];
                    d && d.targetOff(this)
                }
                c.length = 0;
                !1;
                cc.director._nodeActivator.destroyComp(this);
                this.node._removeComponent(this)
            },
            _instantiate: function(c) {
                c || (c = cc.instantiate._clone(this, this));
                c.node = null;
                return c
            },
            schedule: function(c, a, d, b) {
                cc.assertID(c, 1619);
                a = a || 0;
                cc.assertID(0 <= a, 1620);
                d = isNaN(d) ? cc.macro.REPEAT_FOREVER : d;
                b = b || 0;
                var l = cc.director.getScheduler(),
                    n = l.isTargetPaused(this);
                l.schedule(c, this, a, d, b, n)
            },
            scheduleOnce: function(c, a) {
                this.schedule(c, 0, 0, a)
            },
            unschedule: function(c) {
                c && cc.director.getScheduler().unschedule(c, this)
            },
            unscheduleAllCallbacks: function() {
                cc.director.getScheduler().unscheduleAllForTarget(this)
            }
        });
        h._requireComponent = null;
        h._executionOrder = 0;
        !1;
        !1;
        !1;
        m.value(h, "_registerEditorProps", function(c, a) {
            var d = a.requireComponent;
            d && (c._requireComponent = d);
            (a = a.executionOrder) && "number" === typeof a &&
                (c._executionOrder = a);
            !1;
            !1;
            !1
        });
        h.prototype.__scriptUuid = "";
        cc.Component = q.exports = h
    }, {
        "../platform/CCObject": 210,
        "../platform/id-generater": 221,
        "../platform/js": 225
    }],
    117: [function(h, q, m) {
        cc.Component.EventHandler = cc.Class({
            name: "cc.ClickEvent",
            properties: {
                target: {
                    default: null,
                    type: cc.Node
                },
                component: "",
                _componentId: "",
                _componentName: {
                    get: function() {
                        this._genCompIdIfNeeded();
                        return this._compId2Name(this._componentId)
                    },
                    set: function(f) {
                        this._componentId = this._compName2Id(f)
                    }
                },
                handler: {
                    default: ""
                },
                customEventData: {
                    default: ""
                }
            },
            statics: {
                emitEvents: function(f) {
                    if (0 < arguments.length) {
                        var e = Array(arguments.length - 1);
                        for (var b = 0, k = e.length; b < k; b++) e[b] = arguments[b + 1]
                    }
                    b = 0;
                    for (k = f.length; b < k; b++) {
                        var c = f[b];
                        c instanceof cc.Component.EventHandler && c.emit(e)
                    }
                }
            },
            emit: function(f) {
                var e = this.target;
                if (cc.isValid(e)) {
                    this._genCompIdIfNeeded();
                    var b = cc.js._getClassById(this._componentId);
                    e = e.getComponent(b);
                    cc.isValid(e) && (b = e[this.handler], "function" === typeof b && (null != this.customEventData && "" !== this.customEventData &&
                        (f = f.slice(), f.push(this.customEventData)), b.apply(e, f)))
                }
            },
            _compName2Id: function(f) {
                f = cc.js.getClassByName(f);
                return cc.js._getClassId(f)
            },
            _compId2Name: function(f) {
                f = cc.js._getClassById(f);
                return cc.js.getClassName(f)
            },
            _genCompIdIfNeeded: function() {
                this._componentId || (this._componentName = this.component, this.component = "")
            }
        })
    }, {}],
    118: [function(h, q, m) {
        m = h("../platform/CCMacro");
        var f = h("./CCRenderComponent");
        h("../assets/material/CCMaterial");
        var e = h("../renderer/utils/label/label-frame"),
            b = h("../utils/blend-func"),
            k = h("../renderer/utils/utils").deleteFromDynamicAtlas;
        h = m.TextAlignment;
        m = m.VerticalTextAlignment;
        var c = cc.Enum({
                NONE: 0,
                CLAMP: 1,
                SHRINK: 2,
                RESIZE_HEIGHT: 3
            }),
            a = cc.Enum({
                NONE: 0,
                BITMAP: 1,
                CHAR: 2
            }),
            d = cc.Class({
                name: "cc.Label",
                extends: f,
                mixins: [b],
                ctor: function() {
                    !1;
                    this._actualFontSize = 0;
                    this._letterTexture = this._ttfTexture = this._frame = this._assemblerData = null;
                    cc.game.renderType === cc.game.RENDER_TYPE_CANVAS ? this._updateMaterial = this._updateMaterialCanvas : this._updateMaterial = this._updateMaterialWebgl
                },
                editor: !1,
                properties: {
                    _string: {
                        default: "",
                        formerlySerializedAs: "_N$string"
                    },
                    string: {
                        get: function() {
                            return this._string
                        },
                        set: function(a) {
                            var d = this._string;
                            this._string = "" + a;
                            this.string !== d && this.setVertsDirty();
                            this._checkStringEmpty()
                        },
                        multiline: !0,
                        tooltip: !1
                    },
                    horizontalAlign: {
                        default: h.LEFT,
                        type: h,
                        tooltip: !1,
                        notify: function(a) {
                            this.horizontalAlign !== a && this.setVertsDirty()
                        },
                        animatable: !1
                    },
                    verticalAlign: {
                        default: m.TOP,
                        type: m,
                        tooltip: !1,
                        notify: function(a) {
                            this.verticalAlign !== a && this.setVertsDirty()
                        },
                        animatable: !1
                    },
                    actualFontSize: {
                        displayName: "Actual Font Size",
                        animatable: !1,
                        readonly: !0,
                        get: function() {
                            return this._actualFontSize
                        },
                        tooltip: !1
                    },
                    _fontSize: 40,
                    fontSize: {
                        get: function() {
                            return this._fontSize
                        },
                        set: function(a) {
                            this._fontSize !== a && (this._fontSize = a, this.setVertsDirty())
                        },
                        range: [0, 512],
                        tooltip: !1
                    },
                    fontFamily: {
                        default: "Arial",
                        tooltip: !1,
                        notify: function(a) {
                            this.fontFamily !== a && this.setVertsDirty()
                        },
                        animatable: !1
                    },
                    _lineHeight: 40,
                    lineHeight: {
                        get: function() {
                            return this._lineHeight
                        },
                        set: function(a) {
                            this._lineHeight !==
                                a && (this._lineHeight = a, this.setVertsDirty())
                        },
                        tooltip: !1
                    },
                    overflow: {
                        default: c.NONE,
                        type: c,
                        tooltip: !1,
                        notify: function(a) {
                            this.overflow !== a && this.setVertsDirty()
                        },
                        animatable: !1
                    },
                    _enableWrapText: !0,
                    enableWrapText: {
                        get: function() {
                            return this._enableWrapText
                        },
                        set: function(a) {
                            this._enableWrapText !== a && (this._enableWrapText = a, this.setVertsDirty())
                        },
                        animatable: !1,
                        tooltip: !1
                    },
                    _N$file: null,
                    font: {
                        get: function() {
                            return this._N$file
                        },
                        set: function(a) {
                            this.font !== a && (a || (this._isSystemFontUsed = !0), !1, (this._N$file =
                                a) && this._isSystemFontUsed && (this._isSystemFontUsed = !1), this.enabledInHierarchy && this._forceUpdateRenderData())
                        },
                        type: cc.Font,
                        tooltip: !1,
                        animatable: !1
                    },
                    _isSystemFontUsed: !0,
                    useSystemFont: {
                        get: function() {
                            return this._isSystemFontUsed
                        },
                        set: function(a) {
                            if (this._isSystemFontUsed !== a) {
                                this._isSystemFontUsed = !!a;
                                !1;
                                if (a) {
                                    this.font = null;
                                    if (!this.enabledInHierarchy) return;
                                    this._forceUpdateRenderData()
                                }
                                this.markForValidate()
                            }
                        },
                        animatable: !1,
                        tooltip: !1
                    },
                    _bmFontOriginalSize: {
                        displayName: "BMFont Original Size",
                        get: function() {
                            return this._N$file instanceof cc.BitmapFont ? this._N$file.fontSize : -1
                        },
                        visible: !0,
                        animatable: !1
                    },
                    _spacingX: 0,
                    spacingX: {
                        get: function() {
                            return this._spacingX
                        },
                        set: function(a) {
                            this._spacingX = a;
                            this.setVertsDirty()
                        },
                        tooltip: !1
                    },
                    _batchAsBitmap: !1,
                    cacheMode: {
                        default: a.NONE,
                        type: a,
                        tooltip: !1,
                        notify: function(d) {
                            this.cacheMode !== d && (d !== a.BITMAP || this.font instanceof cc.BitmapFont || this._frame && this._frame._resetDynamicAtlasFrame(), d === a.CHAR && (this._ttfTexture = null), this.enabledInHierarchy &&
                                this._forceUpdateRenderData())
                        },
                        animatable: !1
                    },
                    _styleFlags: 0,
                    enableBold: {
                        get: function() {
                            return !!(this._styleFlags & 1)
                        },
                        set: function(a) {
                            a ? this._styleFlags |= 1 : this._styleFlags &= -2;
                            this.setVertsDirty()
                        },
                        animatable: !1,
                        tooltip: !1
                    },
                    enableItalic: {
                        get: function() {
                            return !!(this._styleFlags & 2)
                        },
                        set: function(a) {
                            a ? this._styleFlags |= 2 : this._styleFlags &= -3;
                            this.setVertsDirty()
                        },
                        animatable: !1,
                        tooltip: !1
                    },
                    enableUnderline: {
                        get: function() {
                            return !!(this._styleFlags & 4)
                        },
                        set: function(a) {
                            a ? this._styleFlags |= 4 : this._styleFlags &=
                                -5;
                            this.setVertsDirty()
                        },
                        animatable: !1,
                        tooltip: !1
                    },
                    _underlineHeight: 0,
                    underlineHeight: {
                        get: function() {
                            return this._underlineHeight
                        },
                        set: function(a) {
                            this._underlineHeight !== a && (this._underlineHeight = a, this.setVertsDirty())
                        },
                        tooltip: !1
                    }
                },
                statics: {
                    HorizontalAlign: h,
                    VerticalAlign: m,
                    Overflow: c,
                    CacheMode: a,
                    _shareAtlas: null,
                    clearCharCache: function() {
                        d._shareAtlas && d._shareAtlas.clearAllCache()
                    }
                },
                onLoad: function() {
                    this._batchAsBitmap && this.cacheMode === a.NONE && (this.cacheMode = a.BITMAP, this._batchAsBitmap = !1);
                    cc.game.renderType === cc.game.RENDER_TYPE_CANVAS && (this.cacheMode = a.NONE)
                },
                onEnable: function() {
                    this._super();
                    this.node.on(cc.Node.EventType.SIZE_CHANGED, this._nodeSizeChanged, this);
                    this.node.on(cc.Node.EventType.ANCHOR_CHANGED, this.setVertsDirty, this);
                    this.node.on(cc.Node.EventType.COLOR_CHANGED, this._nodeColorChanged, this);
                    this._forceUpdateRenderData()
                },
                onDisable: function() {
                    this._super();
                    this.node.off(cc.Node.EventType.SIZE_CHANGED, this._nodeSizeChanged, this);
                    this.node.off(cc.Node.EventType.ANCHOR_CHANGED,
                        this.setVertsDirty, this);
                    this.node.off(cc.Node.EventType.COLOR_CHANGED, this._nodeColorChanged, this)
                },
                onDestroy: function() {
                    this._assembler && this._assembler._resetAssemblerData && this._assembler._resetAssemblerData(this._assemblerData);
                    this._letterTexture = this._assemblerData = null;
                    this._ttfTexture && (this._ttfTexture.destroy(), this._ttfTexture = null);
                    this._super()
                },
                _nodeSizeChanged: function() {
                    (!1, this.overflow !== c.NONE) && this.setVertsDirty()
                },
                _nodeColorChanged: function() {
                    this.font instanceof cc.BitmapFont ||
                        this.setVertsDirty()
                },
                setVertsDirty: function() {
                    !1;
                    this._super()
                },
                _updateColor: function() {
                    this.font instanceof cc.BitmapFont || this._srcBlendFactor === cc.macro.BlendFactor.SRC_ALPHA && this.node._renderFlag & cc.RenderFlow.FLAG_OPACITY || this.setVertsDirty();
                    f.prototype._updateColor.call(this)
                },
                _validateRender: function() {
                    if (this.string && this._materials[0]) {
                        var a = this.font;
                        if (!(a instanceof cc.BitmapFont)) return;
                        var d = a.spriteFrame;
                        if (d && d.textureLoaded() && a._fntConfig) return
                    }
                    this.disableRender()
                },
                _resetAssembler: function() {
                    this._resetFrame();
                    f.prototype._resetAssembler.call(this)
                },
                _resetFrame: function() {
                    this._frame && (k(this, this._frame), this._frame = null)
                },
                _checkStringEmpty: function() {
                    this.markForRender(!!this.string)
                },
                _on3DNodeChanged: function() {
                    this._resetAssembler();
                    this._applyFontTexture()
                },
                _onBMFontTextureLoaded: function() {
                    this._frame._texture = this.font.spriteFrame._texture;
                    this.markForRender(!0);
                    this._updateMaterial();
                    this._assembler && this._assembler.updateRenderData(this)
                },
                _onBlendChanged: function() {
                    this.useSystemFont && this.enabledInHierarchy &&
                        this._forceUpdateRenderData()
                },
                _applyFontTexture: function() {
                    var d = this.font;
                    d instanceof cc.BitmapFont ? (this._frame = d = d.spriteFrame) && d.onTextureLoaded(this._onBMFontTextureLoaded, this) : (this._nativeTTF() || (this._frame || (this._frame = new e), this.cacheMode === a.CHAR ? (this._letterTexture = this._assembler._getAssemblerData(), this._frame._refreshTexture(this._letterTexture)) : this._ttfTexture || (this._ttfTexture = new cc.Texture2D, this._assemblerData = this._assembler._getAssemblerData(), this._ttfTexture.initWithElement(this._assemblerData.canvas)),
                        this.cacheMode !== a.CHAR && (this._frame._resetDynamicAtlasFrame(), this._frame._refreshTexture(this._ttfTexture), this._srcBlendFactor === cc.macro.BlendFactor.ONE && this._ttfTexture.setPremultiplyAlpha(!0)), this._updateMaterial()), this._assembler && this._assembler.updateRenderData(this));
                    this.markForValidate()
                },
                _updateMaterialCanvas: function() {
                    this._frame && (this._frame._texture._nativeUrl = this.uuid + "_texture")
                },
                _updateMaterialWebgl: function() {
                    var a = this.getMaterial(0);
                    this._nativeTTF() ? a && this._assembler._updateTTFMaterial(this) :
                        this._frame && (a && a.setProperty("texture", this._frame._texture), b.prototype._updateMaterial.call(this))
                },
                _forceUseCanvas: !1,
                _useNativeTTF: function() {
                    return cc.macro.ENABLE_NATIVE_TTF_RENDERER && !this._forceUseCanvas
                },
                _nativeTTF: function() {
                    return this._useNativeTTF() && !!this._assembler && !!this._assembler._updateTTFMaterial
                },
                _forceUpdateRenderData: function() {
                    this.setVertsDirty();
                    this._resetAssembler();
                    this._applyFontTexture()
                },
                _enableBold: function(a) {
                    !0;
                    cc.warn("`label._enableBold` is deprecated, use `label.enableBold = true` instead please");
                    this.enableBold = !!a
                },
                _enableItalics: function(a) {
                    !0;
                    cc.warn("`label._enableItalics` is deprecated, use `label.enableItalics = true` instead please");
                    this.enableItalic = !!a
                },
                _enableUnderline: function(a) {
                    !0;
                    cc.warn("`label._enableUnderline` is deprecated, use `label.enableUnderline = true` instead please");
                    this.enableUnderline = !!a
                }
            });
        cc.Label = q.exports = d
    }, {
        "../assets/material/CCMaterial": 91,
        "../platform/CCMacro": 209,
        "../renderer/utils/label/label-frame": 239,
        "../renderer/utils/utils": 242,
        "../utils/blend-func": 280,
        "./CCRenderComponent": 126
    }],
    119: [function(h, q, m) {
        h = cc.Class({
            name: "cc.LabelOutline",
            extends: h("./CCComponent"),
            editor: !1,
            properties: {
                _color: cc.Color.WHITE,
                _width: 1,
                color: {
                    tooltip: !1,
                    get: function() {
                        return this._color.clone()
                    },
                    set: function(f) {
                        this._color.equals(f) || this._color.set(f);
                        this._updateRenderData()
                    }
                },
                width: {
                    tooltip: !1,
                    get: function() {
                        return this._width
                    },
                    set: function(f) {
                        this._width !== f && (this._width = f, this._updateRenderData())
                    },
                    range: [0, 512]
                }
            },
            onEnable: function() {
                this._updateRenderData()
            },
            onDisable: function() {
                this._updateRenderData()
            },
            _updateRenderData: function() {
                var f = this.node.getComponent(cc.Label);
                f && f.setVertsDirty()
            }
        });
        cc.LabelOutline = q.exports = h
    }, {
        "./CCComponent": 116
    }],
    120: [function(h, q, m) {
        h = cc.Class({
            name: "cc.LabelShadow",
            extends: h("./CCComponent"),
            editor: !1,
            properties: {
                _color: cc.Color.WHITE,
                _offset: cc.v2(2, 2),
                _blur: 2,
                color: {
                    tooltip: !1,
                    get: function() {
                        return this._color.clone()
                    },
                    set: function(f) {
                        this._color.equals(f) || this._color.set(f);
                        this._updateRenderData()
                    }
                },
                offset: {
                    tooltip: !1,
                    get: function() {
                        return this._offset
                    },
                    set: function(f) {
                        this._offset =
                            f;
                        this._updateRenderData()
                    }
                },
                blur: {
                    tooltip: !1,
                    get: function() {
                        return this._blur
                    },
                    set: function(f) {
                        this._blur = f;
                        this._updateRenderData()
                    },
                    range: [0, 1024]
                }
            },
            onEnable: function() {
                this._updateRenderData()
            },
            onDisable: function() {
                this._updateRenderData()
            },
            _updateRenderData: function() {
                var f = this.node.getComponent(cc.Label);
                f && f.markForRender(!0)
            }
        });
        cc.LabelShadow = q.exports = h
    }, {
        "./CCComponent": 116
    }],
    121: [function(h, q, m) {
        var f = h("../CCNode").EventType,
            e = cc.Enum({
                NONE: 0,
                HORIZONTAL: 1,
                VERTICAL: 2,
                GRID: 3
            }),
            b = cc.Enum({
                NONE: 0,
                CONTAINER: 1,
                CHILDREN: 2
            }),
            k = cc.Enum({
                HORIZONTAL: 0,
                VERTICAL: 1
            }),
            c = cc.Enum({
                BOTTOM_TO_TOP: 0,
                TOP_TO_BOTTOM: 1
            }),
            a = cc.Enum({
                LEFT_TO_RIGHT: 0,
                RIGHT_TO_LEFT: 1
            });
        h = cc.Class({
            name: "cc.Layout",
            extends: h("./CCComponent"),
            editor: !1,
            properties: {
                _layoutSize: cc.size(300, 200),
                _layoutDirty: {
                    default: !0,
                    serializable: !1
                },
                _resize: b.NONE,
                _N$layoutType: e.NONE,
                type: {
                    type: e,
                    get: function() {
                        return this._N$layoutType
                    },
                    set: function(a) {
                        this._N$layoutType = a;
                        !1;
                        this._doLayoutDirty()
                    },
                    tooltip: !1,
                    animatable: !1
                },
                resizeMode: {
                    type: b,
                    tooltip: !1,
                    animatable: !1,
                    get: function() {
                        return this._resize
                    },
                    set: function(a) {
                        if (this.type !== e.NONE || a !== b.CHILDREN) this._resize = a, !1, this._doLayoutDirty()
                    }
                },
                cellSize: {
                    default: cc.size(40, 40),
                    tooltip: !1,
                    type: cc.Size,
                    notify: function() {
                        this._doLayoutDirty()
                    }
                },
                startAxis: {
                    default: k.HORIZONTAL,
                    tooltip: !1,
                    type: k,
                    notify: function() {
                        !1;
                        this._doLayoutDirty()
                    },
                    animatable: !1
                },
                paddingLeft: {
                    default: 0,
                    tooltip: !1,
                    notify: function() {
                        this._doLayoutDirty()
                    }
                },
                paddingRight: {
                    default: 0,
                    tooltip: !1,
                    notify: function() {
                        this._doLayoutDirty()
                    }
                },
                paddingTop: {
                    default: 0,
                    tooltip: !1,
                    notify: function() {
                        this._doLayoutDirty()
                    }
                },
                paddingBottom: {
                    default: 0,
                    tooltip: !1,
                    notify: function() {
                        this._doLayoutDirty()
                    }
                },
                spacingX: {
                    default: 0,
                    notify: function() {
                        this._doLayoutDirty()
                    },
                    tooltip: !1
                },
                spacingY: {
                    default: 0,
                    notify: function() {
                        this._doLayoutDirty()
                    },
                    tooltip: !1
                },
                verticalDirection: {
                    default: c.TOP_TO_BOTTOM,
                    type: c,
                    notify: function() {
                        this._doLayoutDirty()
                    },
                    tooltip: !1,
                    animatable: !1
                },
                horizontalDirection: {
                    default: a.LEFT_TO_RIGHT,
                    type: a,
                    notify: function() {
                        this._doLayoutDirty()
                    },
                    tooltip: !1,
                    animatable: !1
                },
                affectedByScale: {
                    default: !1,
                    notify: function() {
                        this._doLayoutDirty()
                    },
                    animatable: !1,
                    tooltip: !1
                }
            },
            statics: {
                Type: e,
                VerticalDirection: c,
                HorizontalDirection: a,
                ResizeMode: b,
                AxisDirection: k
            },
            onEnable: function() {
                this._addEventListeners();
                this.node.getContentSize().equals(cc.size(0, 0)) && this.node.setContentSize(this._layoutSize);
                this._doLayoutDirty()
            },
            onDisable: function() {
                this._removeEventListeners()
            },
            _doLayoutDirty: function() {
                this._layoutDirty = !0
            },
            _doScaleDirty: function() {
                this._layoutDirty =
                    this._layoutDirty || this.affectedByScale
            },
            _addEventListeners: function() {
                cc.director.on(cc.Director.EVENT_AFTER_UPDATE, this.updateLayout, this);
                this.node.on(f.SIZE_CHANGED, this._resized, this);
                this.node.on(f.ANCHOR_CHANGED, this._doLayoutDirty, this);
                this.node.on(f.CHILD_ADDED, this._childAdded, this);
                this.node.on(f.CHILD_REMOVED, this._childRemoved, this);
                this.node.on(f.CHILD_REORDER, this._doLayoutDirty, this);
                this._addChildrenEventListeners()
            },
            _removeEventListeners: function() {
                cc.director.off(cc.Director.EVENT_AFTER_UPDATE,
                    this.updateLayout, this);
                this.node.off(f.SIZE_CHANGED, this._resized, this);
                this.node.off(f.ANCHOR_CHANGED, this._doLayoutDirty, this);
                this.node.off(f.CHILD_ADDED, this._childAdded, this);
                this.node.off(f.CHILD_REMOVED, this._childRemoved, this);
                this.node.off(f.CHILD_REORDER, this._doLayoutDirty, this);
                this._removeChildrenEventListeners()
            },
            _addChildrenEventListeners: function() {
                for (var a = this.node.children, c = 0; c < a.length; ++c) {
                    var b = a[c];
                    b.on(f.SCALE_CHANGED, this._doScaleDirty, this);
                    b.on(f.SIZE_CHANGED, this._doLayoutDirty,
                        this);
                    b.on(f.POSITION_CHANGED, this._doLayoutDirty, this);
                    b.on(f.ANCHOR_CHANGED, this._doLayoutDirty, this);
                    b.on("active-in-hierarchy-changed", this._doLayoutDirty, this)
                }
            },
            _removeChildrenEventListeners: function() {
                for (var a = this.node.children, c = 0; c < a.length; ++c) {
                    var b = a[c];
                    b.off(f.SCALE_CHANGED, this._doScaleDirty, this);
                    b.off(f.SIZE_CHANGED, this._doLayoutDirty, this);
                    b.off(f.POSITION_CHANGED, this._doLayoutDirty, this);
                    b.off(f.ANCHOR_CHANGED, this._doLayoutDirty, this);
                    b.off("active-in-hierarchy-changed", this._doLayoutDirty,
                        this)
                }
            },
            _childAdded: function(a) {
                a.on(f.SCALE_CHANGED, this._doScaleDirty, this);
                a.on(f.SIZE_CHANGED, this._doLayoutDirty, this);
                a.on(f.POSITION_CHANGED, this._doLayoutDirty, this);
                a.on(f.ANCHOR_CHANGED, this._doLayoutDirty, this);
                a.on("active-in-hierarchy-changed", this._doLayoutDirty, this);
                this._doLayoutDirty()
            },
            _childRemoved: function(a) {
                a.off(f.SCALE_CHANGED, this._doScaleDirty, this);
                a.off(f.SIZE_CHANGED, this._doLayoutDirty, this);
                a.off(f.POSITION_CHANGED, this._doLayoutDirty, this);
                a.off(f.ANCHOR_CHANGED, this._doLayoutDirty,
                    this);
                a.off("active-in-hierarchy-changed", this._doLayoutDirty, this);
                this._doLayoutDirty()
            },
            _resized: function() {
                this._layoutSize = this.node.getContentSize();
                this._doLayoutDirty()
            },
            _doLayoutHorizontally: function(d, l, g, n) {
                var k = this.node.getAnchorPoint(),
                    t = this.node.children,
                    p = 1,
                    f = this.paddingLeft,
                    h = -k.x * d;
                this.horizontalDirection === a.RIGHT_TO_LEFT && (p = -1, h = (1 - k.x) * d, f = this.paddingRight);
                for (var A = h + p * f - p * this.spacingX, B = 0, E = 0, y = 0, z = 0, x = 0, m = 0, G = 0, F = 0; F < t.length; ++F) {
                    var q = t[F];
                    q.activeInHierarchy && G++
                }
                var I =
                    this.cellSize.width;
                this.type !== e.GRID && this.resizeMode === b.CHILDREN && (I = (d - (this.paddingLeft + this.paddingRight) - (G - 1) * this.spacingX) / G);
                for (F = 0; F < t.length; ++F) {
                    q = t[F];
                    var K = this._getUsedScaleValue(q.scaleX);
                    G = this._getUsedScaleValue(q.scaleY);
                    if (q.activeInHierarchy) {
                        this._resize === b.CHILDREN && (q.width = I / K, this.type === e.GRID && (q.height = this.cellSize.height / G));
                        var P = q.anchorX;
                        K *= q.width;
                        var S = q.height * G;
                        y > E && (E = y);
                        S >= E && (y = E, E = S, m = q.getAnchorPoint().y);
                        this.horizontalDirection === a.RIGHT_TO_LEFT &&
                            (P = 1 - q.anchorX);
                        A = A + p * P * K + p * this.spacingX;
                        G = p * (1 - P) * K;
                        if (l) {
                            var M = A + G + p * (0 < p ? this.paddingRight : this.paddingLeft),
                                O = this.horizontalDirection === a.RIGHT_TO_LEFT && M < -k.x * d;
                            if (this.horizontalDirection === a.LEFT_TO_RIGHT && M > (1 - k.x) * d || O) S >= E ? (0 === y && (y = E), B += y, y = E) : (B += E, y = S, E = 0), A = h + p * (f + P * K), z++
                        }
                        P = g(q, B, z);
                        d >= K + this.paddingLeft + this.paddingRight && n && q.setPosition(cc.v2(A, P));
                        q = 1;
                        K = 0 === E ? S : E;
                        this.verticalDirection === c.TOP_TO_BOTTOM ? (x = x || this.node._contentSize.height, q = -1, q = P + q * (K * m + this.paddingBottom),
                            q < x && (x = q)) : (x = x || -this.node._contentSize.height, q = P + q * (K * m + this.paddingTop), q > x && (x = q));
                        A += G
                    }
                }
                return x
            },
            _getVerticalBaseHeight: function(a) {
                var d = 0,
                    c = 0;
                if (this.resizeMode === b.CONTAINER) {
                    for (var n = 0; n < a.length; ++n) {
                        var k = a[n];
                        k.activeInHierarchy && (c++, d += k.height * this._getUsedScaleValue(k.scaleY))
                    }
                    d += (c - 1) * this.spacingY + this.paddingBottom + this.paddingTop
                } else d = this.node.getContentSize().height;
                return d
            },
            _doLayoutVertically: function(d, l, g, n) {
                var k = this.node.getAnchorPoint(),
                    f = this.node.children,
                    p =
                    1,
                    u = this.paddingBottom,
                    h = -k.y * d;
                this.verticalDirection === c.TOP_TO_BOTTOM && (p = -1, h = (1 - k.y) * d, u = this.paddingTop);
                for (var A = h + p * u - p * this.spacingY, B = 0, E = 0, y = 0, z = 0, x = 0, m = 0, G = 0, F = 0; F < f.length; ++F) {
                    var q = f[F];
                    q.activeInHierarchy && G++
                }
                var I = this.cellSize.height;
                this.type !== e.GRID && this.resizeMode === b.CHILDREN && (I = (d - (this.paddingTop + this.paddingBottom) - (G - 1) * this.spacingY) / G);
                for (F = 0; F < f.length; ++F) {
                    q = f[F];
                    var K = this._getUsedScaleValue(q.scaleX);
                    G = this._getUsedScaleValue(q.scaleY);
                    if (q.activeInHierarchy) {
                        this.resizeMode ===
                            b.CHILDREN && (q.height = I / G, this.type === e.GRID && (q.width = this.cellSize.width / K));
                        var P = q.anchorY;
                        K *= q.width;
                        var S = q.height * G;
                        y > E && (E = y);
                        K >= E && (y = E, E = K, m = q.getAnchorPoint().x);
                        this.verticalDirection === c.TOP_TO_BOTTOM && (P = 1 - q.anchorY);
                        A = A + p * P * S + p * this.spacingY;
                        G = p * (1 - P) * S;
                        if (l) {
                            var M = A + G + p * (0 < p ? this.paddingTop : this.paddingBottom),
                                O = this.verticalDirection === c.TOP_TO_BOTTOM && M < -k.y * d;
                            if (this.verticalDirection === c.BOTTOM_TO_TOP && M > (1 - k.y) * d || O) K >= E ? (0 === y && (y = E), B += y, y = E) : (B += E, y = K, E = 0), A = h + p * (u + P * S), z++
                        }
                        P =
                            g(q, B, z);
                        d >= S + (this.paddingTop + this.paddingBottom) && n && q.setPosition(cc.v2(P, A));
                        q = 1;
                        K = 0 === E ? K : E;
                        this.horizontalDirection === a.RIGHT_TO_LEFT ? (q = -1, x = x || this.node._contentSize.width, q = P + q * (K * m + this.paddingLeft), q < x && (x = q)) : (x = x || -this.node._contentSize.width, q = P + q * (K * m + this.paddingRight), q > x && (x = q));
                        A += G
                    }
                }
                return x
            },
            _doLayoutBasic: function() {
                for (var a = this.node.children, c = null, b = 0; b < a.length; ++b) {
                    var n = a[b];
                    n.activeInHierarchy && (c ? c.union(c, n.getBoundingBoxToWorld()) : c = n.getBoundingBoxToWorld())
                }
                c &&
                    (a = this.node.convertToNodeSpaceAR(cc.v2(c.x, c.y)), a = cc.v2(a.x - this.paddingLeft, a.y - this.paddingBottom), c = this.node.convertToNodeSpaceAR(cc.v2(c.xMax, c.yMax)), c = cc.v2(c.x + this.paddingRight, c.y + this.paddingTop), c = c.sub(a), c = cc.size(parseFloat(c.x.toFixed(2)), parseFloat(c.y.toFixed(2))), 0 !== c.width && (this.node.anchorX = parseFloat((-a.x / c.width).toFixed(2))), 0 !== c.height && (this.node.anchorY = parseFloat((-a.y / c.height).toFixed(2))), this.node.setContentSize(c))
            },
            _doLayoutGridAxisHorizontal: function(a, l) {
                var d =
                    l.width,
                    n = 1,
                    k = -a.y * l.height,
                    e = this.paddingBottom;
                this.verticalDirection === c.TOP_TO_BOTTOM && (n = -1, k = (1 - a.y) * l.height, e = this.paddingTop);
                l = function(a, d, c) {
                    return k + n * (d + a.anchorY * a.height * this._getUsedScaleValue(a.scaleY) + e + c * this.spacingY)
                }.bind(this);
                var p = 0;
                this.resizeMode === b.CONTAINER && (p = this._doLayoutHorizontally(d, !0, l, !1), p = k - p, 0 > p && (p *= -1), k = -a.y * p, this.verticalDirection === c.TOP_TO_BOTTOM && (n = -1, k = (1 - a.y) * p));
                this._doLayoutHorizontally(d, !0, l, !0);
                this.resizeMode === b.CONTAINER && this.node.setContentSize(d,
                    p)
            },
            _doLayoutGridAxisVertical: function(d, c) {
                var g = c.height,
                    l = 1,
                    k = -d.x * c.width,
                    e = this.paddingLeft;
                this.horizontalDirection === a.RIGHT_TO_LEFT && (l = -1, k = (1 - d.x) * c.width, e = this.paddingRight);
                c = function(a, d, c) {
                    return k + l * (d + a.anchorX * a.width * this._getUsedScaleValue(a.scaleX) + e + c * this.spacingX)
                }.bind(this);
                var p = 0;
                this.resizeMode === b.CONTAINER && (p = this._doLayoutVertically(g, !0, c, !1), p = k - p, 0 > p && (p *= -1), k = -d.x * p, this.horizontalDirection === a.RIGHT_TO_LEFT && (l = -1, k = (1 - d.x) * p));
                this._doLayoutVertically(g, !0,
                    c, !0);
                this.resizeMode === b.CONTAINER && this.node.setContentSize(p, g)
            },
            _doLayoutGrid: function() {
                var a = this.node.getAnchorPoint(),
                    c = this.node.getContentSize();
                this.startAxis === k.HORIZONTAL ? this._doLayoutGridAxisHorizontal(a, c) : this.startAxis === k.VERTICAL && this._doLayoutGridAxisVertical(a, c)
            },
            _getHorizontalBaseWidth: function(a) {
                var d = 0,
                    c = 0;
                if (this.resizeMode === b.CONTAINER) {
                    for (var n = 0; n < a.length; ++n) {
                        var k = a[n];
                        k.activeInHierarchy && (c++, d += k.width * this._getUsedScaleValue(k.scaleX))
                    }
                    d += (c - 1) * this.spacingX +
                        this.paddingLeft + this.paddingRight
                } else d = this.node.getContentSize().width;
                return d
            },
            _doLayout: function() {
                if (this.type === e.HORIZONTAL) {
                    var a = this._getHorizontalBaseWidth(this.node.children);
                    this._doLayoutHorizontally(a, !1, function(a) {
                        return a.y
                    }, !0);
                    this.node.width = a
                } else this.type === e.VERTICAL ? (a = this._getVerticalBaseHeight(this.node.children), this._doLayoutVertically(a, !1, function(a) {
                        return a.x
                    }, !0), this.node.height = a) : this.type === e.NONE ? this.resizeMode === b.CONTAINER && this._doLayoutBasic() : this.type ===
                    e.GRID && this._doLayoutGrid()
            },
            _getUsedScaleValue: function(a) {
                return this.affectedByScale ? Math.abs(a) : 1
            },
            updateLayout: function() {
                this._layoutDirty && 0 < this.node.children.length && (this._doLayout(), this._layoutDirty = !1)
            }
        });
        cc.Layout = q.exports = h
    }, {
        "../CCNode": 40,
        "./CCComponent": 116
    }],
    122: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }
        var e = f(h("../../renderer/gfx")),
            b = f(h("../value-types/mat4")),
            k = f(h("../value-types/vec2")),
            c = f(h("../assets/material/material-variant")),
            a = h("../utils/misc");
        m = h("./CCRenderComponent");
        var d = h("../renderer/render-flow"),
            l = h("../graphics/graphics"),
            g = new k["default"],
            n = new b["default"],
            w = [],
            t = cc.Enum({
                RECT: 0,
                ELLIPSE: 1,
                IMAGE_STENCIL: 2
            });
        h = cc.Class({
            name: "cc.Mask",
            extends: m,
            editor: !1,
            ctor: function() {
                this._clearMaterial = this._exitMaterial = this._enableMaterial = this._graphics = null
            },
            properties: {
                _spriteFrame: {
                    default: null,
                    type: cc.SpriteFrame
                },
                _type: t.RECT,
                type: {
                    get: function() {
                        return this._type
                    },
                    set: function(a) {
                        this._type !== a && this._resetAssembler();
                        this._type =
                            a;
                        this._type !== t.IMAGE_STENCIL && (this.spriteFrame = null, this.alphaThreshold = 0, this._updateGraphics());
                        this._activateMaterial()
                    },
                    type: t,
                    tooltip: !1
                },
                spriteFrame: {
                    type: cc.SpriteFrame,
                    tooltip: !1,
                    get: function() {
                        return this._spriteFrame
                    },
                    set: function(a) {
                        var d = this._spriteFrame;
                        !1;
                        d !== a && (this._spriteFrame = a, this.setVertsDirty(), this._updateMaterial())
                    }
                },
                alphaThreshold: {
                    default: .1,
                    type: cc.Float,
                    range: [0, 1, .1],
                    slide: !0,
                    tooltip: !1,
                    notify: function() {
                        cc.game.renderType === cc.game.RENDER_TYPE_CANVAS ? cc.warnID(4201) :
                            this._updateMaterial()
                    }
                },
                inverted: {
                    default: !1,
                    type: cc.Boolean,
                    tooltip: !1,
                    notify: function() {
                        cc.game.renderType === cc.game.RENDER_TYPE_CANVAS && cc.warnID(4202)
                    }
                },
                _segments: 64,
                segements: {
                    get: function() {
                        return this._segments
                    },
                    set: function(d) {
                        this._segments = a.clampf(d, 3, 1E4);
                        this._updateGraphics()
                    },
                    type: cc.Integer,
                    tooltip: !1
                },
                _resizeToTarget: {
                    animatable: !1,
                    set: function(a) {
                        a && this._resizeNodeToTargetNode()
                    }
                }
            },
            statics: {
                Type: t
            },
            onRestore: function() {
                this._activateMaterial()
            },
            onEnable: function() {
                this._super();
                this._type !== t.IMAGE_STENCIL && this._updateGraphics();
                this.node.on(cc.Node.EventType.POSITION_CHANGED, this._updateGraphics, this);
                this.node.on(cc.Node.EventType.ROTATION_CHANGED, this._updateGraphics, this);
                this.node.on(cc.Node.EventType.SCALE_CHANGED, this._updateGraphics, this);
                this.node.on(cc.Node.EventType.SIZE_CHANGED, this._updateGraphics, this);
                this.node.on(cc.Node.EventType.ANCHOR_CHANGED, this._updateGraphics, this)
            },
            onDisable: function() {
                this._super();
                this.node.off(cc.Node.EventType.POSITION_CHANGED,
                    this._updateGraphics, this);
                this.node.off(cc.Node.EventType.ROTATION_CHANGED, this._updateGraphics, this);
                this.node.off(cc.Node.EventType.SCALE_CHANGED, this._updateGraphics, this);
                this.node.off(cc.Node.EventType.SIZE_CHANGED, this._updateGraphics, this);
                this.node.off(cc.Node.EventType.ANCHOR_CHANGED, this._updateGraphics, this);
                this.node._renderFlag &= ~d.FLAG_POST_RENDER
            },
            onDestroy: function() {
                this._super();
                this._removeGraphics()
            },
            _resizeNodeToTargetNode: !1,
            _validateRender: function() {
                if (this._type === t.IMAGE_STENCIL) {
                    var a =
                        this._spriteFrame;
                    a && a.textureLoaded() || this.disableRender()
                }
            },
            _activateMaterial: function() {
                this._createGraphics();
                var a = this._materials[0];
                a = a ? c["default"].create(a, this) : c["default"].createWithBuiltin("2d-sprite", this);
                a.define("USE_ALPHA_TEST", !0);
                this._type === t.IMAGE_STENCIL ? (a.define("CC_USE_MODEL", !1), a.define("USE_TEXTURE", !0)) : (a.define("CC_USE_MODEL", !0), a.define("USE_TEXTURE", !1));
                this._enableMaterial || (this._enableMaterial = c["default"].createWithBuiltin("2d-sprite", this));
                this._exitMaterial ||
                    (this._exitMaterial = c["default"].createWithBuiltin("2d-sprite", this), this._exitMaterial.setStencilEnabled(e["default"].STENCIL_DISABLE));
                this._clearMaterial || (this._clearMaterial = c["default"].createWithBuiltin("clear-stencil", this));
                this.setMaterial(0, a);
                this._graphics._materials[0] = a;
                this._updateMaterial()
            },
            _updateMaterial: function() {
                var a = this._materials[0];
                if (a) {
                    if (this._type === t.IMAGE_STENCIL && this.spriteFrame) {
                        var d = this.spriteFrame.getTexture();
                        a.setProperty("texture", d)
                    }
                    a.setProperty("alphaThreshold",
                        this.alphaThreshold)
                }
            },
            _createGraphics: function() {
                this._graphics || (this._graphics = new l, cc.Assembler.init(this._graphics), this._graphics.node = this.node, this._graphics.lineWidth = 0, this._graphics.strokeColor = cc.color(0, 0, 0, 0))
            },
            _updateGraphics: function() {
                var a = this.node,
                    d = this._graphics;
                d.clear(!1);
                var c = a._contentSize.width,
                    b = a._contentSize.height,
                    g = -c * a._anchorPoint.x;
                a = -b * a._anchorPoint.y;
                if (this._type === t.RECT) d.rect(g, a, c, b);
                else if (this._type === t.ELLIPSE) {
                    g = cc.v2(g + c / 2, a + b / 2);
                    c /= 2;
                    b /= 2;
                    a = this._segments;
                    w.length = 0;
                    for (var l = 2 * Math.PI / a, n = 0; n < a; ++n) w.push(cc.v2(c * Math.cos(l * n) + g.x, b * Math.sin(l * n) + g.y));
                    for (g = 0; g < w.length; ++g) b = w[g], 0 === g ? d.moveTo(b.x, b.y) : d.lineTo(b.x, b.y);
                    d.close()
                }
                cc.game.renderType === cc.game.RENDER_TYPE_CANVAS ? d.stroke() : d.fill()
            },
            _removeGraphics: function() {
                this._graphics && (this._graphics.destroy(), this._graphics._destroyImmediate(), this._graphics = null)
            },
            _hitTest: function(a) {
                var d = this.node,
                    c = d.getContentSize(),
                    l = c.width;
                c = c.height;
                d._updateWorldMatrix();
                if (!b["default"].invert(n,
                        d._worldMatrix)) return !1;
                k["default"].transformMat4(g, a, n);
                g.x += d._anchorPoint.x * l;
                g.y += d._anchorPoint.y * c;
                a = !1;
                this.type === t.RECT || this.type === t.IMAGE_STENCIL ? a = 0 <= g.x && 0 <= g.y && g.x <= l && g.y <= c : this.type === t.ELLIPSE && (a = l / 2, d = c / 2, l = g.x - .5 * l, c = g.y - .5 * c, a = 1 > l * l / (a * a) + c * c / (d * d));
                this.inverted && (a = !a);
                return a
            },
            markForRender: function(a) {
                var c = d.FLAG_RENDER | d.FLAG_UPDATE_RENDER_DATA | d.FLAG_POST_RENDER;
                a ? (this.node._renderFlag |= c, this.markForValidate()) : a || (this.node._renderFlag &= ~c)
            },
            disableRender: function() {
                this.node._renderFlag &=
                    ~(d.FLAG_RENDER | d.FLAG_UPDATE_RENDER_DATA | d.FLAG_POST_RENDER)
            }
        });
        cc.Mask = q.exports = h
    }, {
        "../../renderer/gfx": 334,
        "../assets/material/material-variant": 98,
        "../graphics/graphics": 167,
        "../renderer/render-flow": 237,
        "../utils/misc": 286,
        "../value-types/mat4": 303,
        "../value-types/vec2": 310,
        "./CCRenderComponent": 126
    }],
    123: [function(h, q, m) {
        var f = cc.Enum({
                Unified: 0,
                Free: 1
            }),
            e = cc.Enum({
                Horizontal: 0,
                Vertical: 1
            }),
            b = cc.Enum({
                PAGE_TURNING: 0
            });
        h = cc.Class({
            name: "cc.PageView",
            extends: cc.ScrollView,
            editor: !1,
            ctor: function() {
                this._lastPageIdx =
                    this._curPageIdx = 0;
                this._pages = [];
                this._initContentPos = cc.v2();
                this._scrollCenterOffsetX = [];
                this._scrollCenterOffsetY = []
            },
            properties: {
                sizeMode: {
                    default: f.Unified,
                    type: f,
                    tooltip: !1,
                    notify: function() {
                        this._syncSizeMode()
                    }
                },
                direction: {
                    default: e.Horizontal,
                    type: e,
                    tooltip: !1,
                    notify: function() {
                        this._syncScrollDirection()
                    }
                },
                scrollThreshold: {
                    default: .5,
                    type: cc.Float,
                    slide: !0,
                    range: [0, 1, .01],
                    tooltip: !1
                },
                autoPageTurningThreshold: {
                    default: 100,
                    type: cc.Float,
                    tooltip: !1
                },
                pageTurningEventTiming: {
                    default: .1,
                    type: cc.Float,
                    range: [0, 1, .01],
                    tooltip: !1
                },
                indicator: {
                    default: null,
                    type: cc.PageViewIndicator,
                    tooltip: !1,
                    notify: function() {
                        this.indicator && this.indicator.setPageView(this)
                    }
                },
                pageTurningSpeed: {
                    default: .3,
                    type: cc.Float,
                    tooltip: !1
                },
                pageEvents: {
                    default: [],
                    type: cc.Component.EventHandler,
                    tooltip: !1
                }
            },
            statics: {
                SizeMode: f,
                Direction: e,
                EventType: b
            },
            onEnable: function() {
                this._super();
                this.node.on(cc.Node.EventType.SIZE_CHANGED, this._updateAllPagesSize, this);
                !0;
                this.node.on("scroll-ended-with-threshold", this._dispatchPageTurningEvent,
                    this)
            },
            onDisable: function() {
                this._super();
                this.node.off(cc.Node.EventType.SIZE_CHANGED, this._updateAllPagesSize, this);
                !0;
                this.node.off("scroll-ended-with-threshold", this._dispatchPageTurningEvent, this)
            },
            onLoad: function() {
                this._initPages();
                this.indicator && this.indicator.setPageView(this)
            },
            getCurrentPageIndex: function() {
                return this._curPageIdx
            },
            setCurrentPageIndex: function(b) {
                this.scrollToPage(b, !0)
            },
            getPages: function() {
                return this._pages
            },
            addPage: function(b) {
                b && -1 === this._pages.indexOf(b) && this.content &&
                    (this.content.addChild(b), this._pages.push(b), this._updatePageView())
            },
            insertPage: function(b, c) {
                0 > c || !b || -1 !== this._pages.indexOf(b) || !this.content || (c >= this._pages.length ? this.addPage(b) : (this._pages.splice(c, 0, b), this.content.addChild(b), this._updatePageView()))
            },
            removePage: function(b) {
                if (b && this.content) {
                    var c = this._pages.indexOf(b); - 1 === c ? cc.warnID(4300, b.name) : this.removePageAtIndex(c)
                }
            },
            removePageAtIndex: function(b) {
                var c = this._pages;
                if (!(0 > b || b >= c.length)) {
                    var a = c[b];
                    a && (this.content.removeChild(a),
                        c.splice(b, 1), this._updatePageView())
                }
            },
            removeAllPages: function() {
                if (this.content) {
                    for (var b = this._pages, c = 0, a = b.length; c < a; c++) this.content.removeChild(b[c]);
                    this._pages.length = 0;
                    this._updatePageView()
                }
            },
            scrollToPage: function(b, c) {
                0 > b || b >= this._pages.length || (c = void 0 !== c ? c : .3, this._curPageIdx = b, this.scrollToOffset(this._moveOffsetValue(b), c, !0), this.indicator && this.indicator._changedState())
            },
            getScrollEndedEventTiming: function() {
                return this.pageTurningEventTiming
            },
            _syncScrollDirection: function() {
                this.horizontal =
                    this.direction === e.Horizontal;
                this.vertical = this.direction === e.Vertical
            },
            _syncSizeMode: function() {
                if (this.content) {
                    var b = this.content.getComponent(cc.Layout);
                    if (b) {
                        if (this.sizeMode === f.Free && 0 < this._pages.length) {
                            var c = this._pages[this._pages.length - 1];
                            this.direction === e.Horizontal ? (b.paddingLeft = (this._view.width - this._pages[0].width) / 2, b.paddingRight = (this._view.width - c.width) / 2) : this.direction === e.Vertical && (b.paddingTop = (this._view.height - this._pages[0].height) / 2, b.paddingBottom = (this._view.height -
                                c.height) / 2)
                        }
                        b.updateLayout()
                    }
                }
            },
            _updatePageView: function() {
                var b = this.content.getComponent(cc.Layout);
                b && b.enabled && b.updateLayout();
                b = this._pages.length;
                this._curPageIdx >= b && (this._lastPageIdx = this._curPageIdx = 0 === b ? 0 : b - 1);
                for (var c = this._initContentPos, a = 0; a < b; ++a) {
                    var d = this._pages[a];
                    d.setSiblingIndex(a);
                    this.direction === e.Horizontal ? this._scrollCenterOffsetX[a] = Math.abs(c.x + d.x) : this._scrollCenterOffsetY[a] = Math.abs(c.y + d.y)
                }
                this.indicator && this.indicator._refresh()
            },
            _updateAllPagesSize: function() {
                if (this.sizeMode ===
                    f.Unified && this._view)
                    for (var b = this._pages, c = this._view.getContentSize(), a = 0, d = b.length; a < d; a++) b[a].setContentSize(c)
            },
            _initPages: function() {
                if (this.content) {
                    this._initContentPos = this.content.position;
                    for (var b = this.content.children, c = 0; c < b.length; ++c) {
                        var a = b[c];
                        0 <= this._pages.indexOf(a) || this._pages.push(a)
                    }
                    this._syncScrollDirection();
                    this._syncSizeMode();
                    this._updatePageView()
                }
            },
            _dispatchPageTurningEvent: function() {
                this._lastPageIdx !== this._curPageIdx && (this._lastPageIdx = this._curPageIdx, cc.Component.EventHandler.emitEvents(this.pageEvents,
                    this, b.PAGE_TURNING), this.node.emit("page-turning", this))
            },
            _isScrollable: function(b, c, a) {
                if (this.sizeMode === f.Free) {
                    if (this.direction === e.Horizontal) return c = this._scrollCenterOffsetX[c], a = this._scrollCenterOffsetX[a], Math.abs(b.x) >= Math.abs(c - a) * this.scrollThreshold;
                    if (this.direction === e.Vertical) return c = this._scrollCenterOffsetY[c], a = this._scrollCenterOffsetY[a], Math.abs(b.y) >= Math.abs(c - a) * this.scrollThreshold
                } else {
                    if (this.direction === e.Horizontal) return Math.abs(b.x) >= this._view.width * this.scrollThreshold;
                    if (this.direction === e.Vertical) return Math.abs(b.y) >= this._view.height * this.scrollThreshold
                }
            },
            _isQuicklyScrollable: function(b) {
                if (this.direction === e.Horizontal) {
                    if (Math.abs(b.x) > this.autoPageTurningThreshold) return !0
                } else if (this.direction === e.Vertical && Math.abs(b.y) > this.autoPageTurningThreshold) return !0;
                return !1
            },
            _moveOffsetValue: function(b) {
                var c = cc.v2(0, 0);
                this.sizeMode === f.Free ? this.direction === e.Horizontal ? c.x = this._scrollCenterOffsetX[b] : this.direction === e.Vertical && (c.y = this._scrollCenterOffsetY[b]) :
                    this.direction === e.Horizontal ? c.x = b * this._view.width : this.direction === e.Vertical && (c.y = b * this._view.height);
                return c
            },
            _getDragDirection: function(b) {
                if (this.direction === e.Horizontal) return 0 === b.x ? 0 : 0 < b.x ? 1 : -1;
                if (this.direction === e.Vertical) return 0 === b.y ? 0 : 0 > b.y ? 1 : -1
            },
            _handleReleaseLogic: function(b) {
                this._autoScrollToPage();
                this._scrolling && (this._scrolling = !1, this._autoScrolling || this._dispatchEvent("scroll-ended"))
            },
            _autoScrollToPage: function() {
                if (this._startBounceBackIfNeeded()) {
                    var b = this._getHowMuchOutOfBoundary();
                    b = this._clampDelta(b);
                    (0 < b.x || 0 > b.y) && (this._curPageIdx = 0 === this._pages.length ? 0 : this._pages.length - 1);
                    (0 > b.x || 0 < b.y) && (this._curPageIdx = 0);
                    this.indicator && this.indicator._changedState()
                } else {
                    var c = this._touchBeganPosition.sub(this._touchEndPosition);
                    b = this._curPageIdx;
                    var a = b + this._getDragDirection(c),
                        d = this.pageTurningSpeed * Math.abs(b - a);
                    if (a < this._pages.length) {
                        if (this._isScrollable(c, b, a)) {
                            this.scrollToPage(a, d);
                            return
                        }
                        c = this._calculateTouchMoveVelocity();
                        if (this._isQuicklyScrollable(c)) {
                            this.scrollToPage(a,
                                d);
                            return
                        }
                    }
                    this.scrollToPage(b, d)
                }
            },
            _onTouchBegan: function(b, c) {
                this._touchBeganPosition = b.touch.getLocation();
                this._super(b, c)
            },
            _onTouchMoved: function(b, c) {
                this._super(b, c)
            },
            _onTouchEnded: function(b, c) {
                this._touchEndPosition = b.touch.getLocation();
                this._super(b, c)
            },
            _onTouchCancelled: function(b, c) {
                this._touchEndPosition = b.touch.getLocation();
                this._super(b, c)
            },
            _onMouseWheel: function() {}
        });
        cc.PageView = q.exports = h
    }, {}],
    124: [function(h, q, m) {
        var f = cc.Enum({
            HORIZONTAL: 0,
            VERTICAL: 1
        });
        h = cc.Class({
            name: "cc.PageViewIndicator",
            extends: h("./CCComponent"),
            editor: !1,
            properties: {
                _layout: null,
                _pageView: null,
                _indicators: [],
                spriteFrame: {
                    default: null,
                    type: cc.SpriteFrame,
                    tooltip: !1
                },
                direction: {
                    default: f.HORIZONTAL,
                    type: f,
                    tooltip: !1
                },
                cellSize: {
                    default: cc.size(20, 20),
                    tooltip: !1
                },
                spacing: {
                    default: 0,
                    tooltip: !1
                }
            },
            statics: {
                Direction: f
            },
            onLoad: function() {
                this._updateLayout()
            },
            setPageView: function(e) {
                this._pageView = e;
                this._refresh()
            },
            _updateLayout: function() {
                (this._layout = this.getComponent(cc.Layout)) || (this._layout = this.addComponent(cc.Layout));
                this.direction === f.HORIZONTAL ? (this._layout.type = cc.Layout.Type.HORIZONTAL, this._layout.spacingX = this.spacing) : this.direction === f.VERTICAL && (this._layout.type = cc.Layout.Type.VERTICAL, this._layout.spacingY = this.spacing);
                this._layout.resizeMode = cc.Layout.ResizeMode.CONTAINER
            },
            _createIndicator: function() {
                var e = new cc.Node,
                    b = e.addComponent(cc.Sprite);
                b.spriteFrame = this.spriteFrame;
                b.sizeMode = cc.Sprite.SizeMode.CUSTOM;
                e.parent = this.node;
                e.width = this.cellSize.width;
                e.height = this.cellSize.height;
                return e
            },
            _changedState: function() {
                var e = this._indicators;
                if (0 !== e.length) {
                    var b = this._pageView._curPageIdx;
                    if (!(b >= e.length)) {
                        for (var k = 0; k < e.length; ++k) e[k].opacity = 127.5;
                        e[b].opacity = 255
                    }
                }
            },
            _refresh: function() {
                if (this._pageView) {
                    var e = this._indicators,
                        b = this._pageView.getPages();
                    if (b.length !== e.length) {
                        var k;
                        if (b.length > e.length)
                            for (k = 0; k < b.length; ++k) e[k] || (e[k] = this._createIndicator());
                        else
                            for (k = e.length - b.length; 0 < k; --k) this.node.removeChild(e[k - 1]), e.splice(k - 1, 1);
                        this._layout && this._layout.enabledInHierarchy &&
                            this._layout.updateLayout();
                        this._changedState()
                    }
                }
            }
        });
        cc.PageViewIndicator = q.exports = h
    }, {
        "./CCComponent": 116
    }],
    125: [function(h, q, m) {
        var f = h("../utils/misc");
        h = h("./CCComponent");
        var e = cc.Enum({
            HORIZONTAL: 0,
            VERTICAL: 1,
            FILLED: 2
        });
        h = cc.Class({
            name: "cc.ProgressBar",
            extends: h,
            editor: !1,
            _initBarSprite: function() {
                if (this.barSprite) {
                    var b = this.barSprite.node;
                    if (b) {
                        var k = this.node.getContentSize(),
                            c = this.node.getAnchorPoint(),
                            a = b.getContentSize();
                        b.parent === this.node && this.node.setContentSize(a);
                        this.barSprite.fillType ===
                            cc.Sprite.FillType.RADIAL && (this.mode = e.FILLED);
                        a = b.getContentSize();
                        this.mode === e.HORIZONTAL ? this.totalLength = a.width : this.mode === e.VERTICAL ? this.totalLength = a.height : this.totalLength = this.barSprite.fillRange;
                        b.parent === this.node && b.setPosition(cc.v2(-k.width * c.x, 0))
                    }
                }
            },
            _updateBarStatus: function() {
                if (this.barSprite) {
                    var b = this.barSprite.node;
                    if (b) {
                        var k = b.getAnchorPoint(),
                            c = b.getContentSize(),
                            a = b.getPosition(),
                            d = cc.v2(0, .5),
                            l = f.clamp01(this.progress);
                        l *= this.totalLength;
                        switch (this.mode) {
                            case e.HORIZONTAL:
                                this.reverse &&
                                    (d = cc.v2(1, .5));
                                var g = cc.size(l, c.height);
                                var n = this.totalLength;
                                var h = c.height;
                                break;
                            case e.VERTICAL:
                                d = this.reverse ? cc.v2(.5, 1) : cc.v2(.5, 0), g = cc.size(c.width, l), n = c.width, h = this.totalLength
                        }
                        this.mode === e.FILLED ? this.barSprite.type !== cc.Sprite.Type.FILLED ? cc.warn("ProgressBar FILLED mode only works when barSprite's Type is FILLED!") : (this.reverse && (l *= -1), this.barSprite.fillRange = l) : this.barSprite.type !== cc.Sprite.Type.FILLED ? (k = cc.v2(n * (d.x - k.x), h * (d.y - k.y)), b.setPosition(a.x + k.x, a.y + k.y), b.setAnchorPoint(d),
                            b.setContentSize(g)) : cc.warn("ProgressBar non-FILLED mode only works when barSprite's Type is non-FILLED!")
                    }
                }
            },
            properties: {
                barSprite: {
                    default: null,
                    type: cc.Sprite,
                    tooltip: !1,
                    notify: function() {
                        this._initBarSprite()
                    },
                    animatable: !1
                },
                mode: {
                    default: e.HORIZONTAL,
                    type: e,
                    tooltip: !1,
                    notify: function() {
                        if (this.barSprite) {
                            var b = this.barSprite.node;
                            b && (b = b.getContentSize(), this.mode === e.HORIZONTAL ? this.totalLength = b.width : this.mode === e.VERTICAL ? this.totalLength = b.height : this.mode === e.FILLED && (this.totalLength =
                                this.barSprite.fillRange))
                        }
                    },
                    animatable: !1
                },
                _N$totalLength: 1,
                totalLength: {
                    range: [0, Number.MAX_VALUE],
                    tooltip: !1,
                    get: function() {
                        return this._N$totalLength
                    },
                    set: function(b) {
                        this.mode === e.FILLED && (b = f.clamp01(b));
                        this._N$totalLength = b;
                        this._updateBarStatus()
                    }
                },
                progress: {
                    default: 1,
                    type: cc.Float,
                    range: [0, 1, .1],
                    slide: !0,
                    tooltip: !1,
                    notify: function() {
                        this._updateBarStatus()
                    }
                },
                reverse: {
                    default: !1,
                    tooltip: !1,
                    notify: function() {
                        this.barSprite && (this.barSprite.fillStart = 1 - this.barSprite.fillStart);
                        this._updateBarStatus()
                    },
                    animatable: !1
                }
            },
            statics: {
                Mode: e
            }
        });
        cc.ProgressBar = q.exports = h
    }, {
        "../utils/misc": 286,
        "./CCComponent": 116
    }],
    126: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }
        var e = f(h("../renderer/assembler")),
            b = f(h("../assets/material/material-variant")),
            k = h("../value-types");
        m = h("./CCComponent");
        var c = h("../renderer/render-flow"),
            a = h("../assets/material/CCMaterial"),
            d = new k.Color;
        h = cc.Class({
            name: "RenderComponent",
            extends: m,
            editor: !1,
            properties: {
                _materials: {
                    default: [],
                    type: a
                },
                materials: {
                    get: function() {
                        return this._materials
                    },
                    set: function(a) {
                        this._materials = a;
                        this._activateMaterial()
                    },
                    type: [a],
                    displayName: "Materials",
                    animatable: !1
                }
            },
            ctor: function() {
                this._vertsDirty = !0;
                this._assembler = null
            },
            _resetAssembler: function() {
                e["default"].init(this);
                this._updateColor();
                this.setVertsDirty()
            },
            __preload: function() {
                this._resetAssembler();
                this._activateMaterial()
            },
            onEnable: function() {
                this.node._renderComponent && (this.node._renderComponent.enabled = !1);
                this.node._renderComponent = this;
                this.node._renderFlag |= c.FLAG_OPACITY_COLOR;
                this.setVertsDirty()
            },
            onDisable: function() {
                this.node._renderComponent = null;
                this.disableRender()
            },
            onDestroy: function() {
                for (var a = this._materials, d = 0; d < a.length; d++) cc.pool.material.put(a[d]);
                a.length = 0;
                cc.pool.assembler.put(this._assembler)
            },
            setVertsDirty: function() {
                this._vertsDirty = !0;
                this.markForRender(!0)
            },
            _on3DNodeChanged: function() {
                this._resetAssembler()
            },
            _validateRender: function() {},
            markForValidate: function() {
                cc.RenderFlow.registerValidate(this)
            },
            markForRender: function(a) {
                var d = c.FLAG_RENDER | c.FLAG_UPDATE_RENDER_DATA;
                a ? (this.node._renderFlag |= d, this.markForValidate()) : this.node._renderFlag &= ~d
            },
            disableRender: function() {
                this.node._renderFlag &= ~(c.FLAG_RENDER | c.FLAG_UPDATE_RENDER_DATA)
            },
            getMaterial: function(a) {
                if (0 > a || a >= this._materials.length) return null;
                var d = this._materials[a];
                if (!d) return null;
                var c = b["default"].create(d, this);
                c !== d && this.setMaterial(a, c);
                return c
            },
            getMaterials: function() {
                for (var a = this._materials, d = 0; d < a.length; d++) a[d] = b["default"].create(a[d], this);
                return a
            },
            setMaterial: function(a, d) {
                d !==
                    this._materials[a] && (d = b["default"].create(d, this), this._materials[a] = d);
                this._updateMaterial();
                this.markForRender(!0);
                return d
            },
            _getDefaultMaterial: function() {
                return a.getBuiltinMaterial("2d-sprite")
            },
            _activateMaterial: function() {
                var a = this._materials;
                if (!a[0]) {
                    var d = this._getDefaultMaterial();
                    a[0] = d
                }
                for (d = 0; d < a.length; d++) a[d] = b["default"].create(a[d], this);
                this._updateMaterial()
            },
            _updateMaterial: function() {},
            _updateColor: function() {
                if (this._assembler.updateColor) {
                    var a = this.srcBlendFactor === cc.macro.BlendFactor.ONE;
                    a && k.Color.premultiplyAlpha(d, this.node._color);
                    this._assembler.updateColor(this, a ? d._val : null)
                }
            },
            _checkBacth: function(a, d) {
                var c = this._materials[0];
                if (c && c.getHash() !== a.material.getHash() || a.cullingMask !== d) a._flush(), a.node = c.getDefine("CC_USE_MODEL") ? this.node : a._dummyNode, a.material = c, a.cullingMask = d
            }
        });
        cc.RenderComponent = q.exports = h
    }, {
        "../assets/material/CCMaterial": 91,
        "../assets/material/material-variant": 98,
        "../renderer/assembler": 233,
        "../renderer/render-flow": 237,
        "../value-types": 301,
        "./CCComponent": 116
    }],
    127: [function(h, q, m) {
        m = h("../platform/js");
        var f = h("../platform/CCMacro"),
            e = h("../utils/text-utils"),
            b = new(h("../utils/html-text-parser")),
            k = f.TextAlignment,
            c = f.VerticalTextAlignment;
        h = cc.Label.CacheMode;
        var a = new m.Pool(function(a) {
            !1;
            !1;
            if (!cc.isValid(a)) return !1;
            (a = a.getComponent(cc.LabelOutline)) && (a.width = 0);
            return !0
        }, 20);
        a.get = function(a, b) {
            (a = this._get()) || (a = new cc.PrivateNode("RICHTEXT_CHILD"));
            a.setPosition(0, 0);
            a.setAnchorPoint(.5, .5);
            a.skewX = 0;
            (b = a.getComponent(cc.Label)) || (b = a.addComponent(cc.Label));
            b.string = "";
            b.horizontalAlign = k.LEFT;
            b.verticalAlign = c.CENTER;
            b._forceUseCanvas = !0;
            return a
        };
        h = cc.Class({
            name: "cc.RichText",
            extends: cc.Component,
            ctor: function() {
                this._textArray = null;
                this._labelSegments = [];
                this._labelSegmentsCache = [];
                this._linesWidth = [];
                !1;
                this._updateRichTextStatus = this._updateRichText
            },
            editor: !1,
            properties: {
                string: {
                    default: "<color=#00ff00>Rich</c><color=#0fffff>Text</color>",
                    multiline: !0,
                    tooltip: !1,
                    notify: function() {
                        this._updateRichTextStatus()
                    }
                },
                horizontalAlign: {
                    default: k.LEFT,
                    type: k,
                    tooltip: !1,
                    animatable: !1,
                    notify: function(a) {
                        this.horizontalAlign !== a && (this._layoutDirty = !0, this._updateRichTextStatus())
                    }
                },
                fontSize: {
                    default: 40,
                    tooltip: !1,
                    notify: function(a) {
                        this.fontSize !== a && (this._layoutDirty = !0, this._updateRichTextStatus())
                    }
                },
                _fontFamily: "Arial",
                fontFamily: {
                    tooltip: !1,
                    get: function() {
                        return this._fontFamily
                    },
                    set: function(a) {
                        this._fontFamily !== a && (this._fontFamily = a, this._layoutDirty = !0, this._updateRichTextStatus())
                    },
                    animatable: !1
                },
                font: {
                    default: null,
                    type: cc.TTFFont,
                    tooltip: !1,
                    notify: function(a) {
                        this.font !== a && (this._layoutDirty = !0, this.font ? (!1, this.useSystemFont = !1, this._onTTFLoaded()) : this.useSystemFont = !0, this._updateRichTextStatus())
                    }
                },
                _isSystemFontUsed: !0,
                useSystemFont: {
                    get: function() {
                        return this._isSystemFontUsed
                    },
                    set: function(a) {
                        this._isSystemFontUsed !== a && (this._isSystemFontUsed = a, !1, this._layoutDirty = !0, this._updateRichTextStatus())
                    },
                    animatable: !1,
                    tooltip: !1
                },
                cacheMode: {
                    default: h.NONE,
                    type: h,
                    tooltip: !1,
                    notify: function(a) {
                        this.cacheMode !== a && this._updateRichTextStatus()
                    },
                    animatable: !1
                },
                maxWidth: {
                    default: 0,
                    tooltip: !1,
                    notify: function(a) {
                        this.maxWidth !== a && (this._layoutDirty = !0, this._updateRichTextStatus())
                    }
                },
                lineHeight: {
                    default: 40,
                    tooltip: !1,
                    notify: function(a) {
                        this.lineHeight !== a && (this._layoutDirty = !0, this._updateRichTextStatus())
                    }
                },
                imageAtlas: {
                    default: null,
                    type: cc.SpriteAtlas,
                    tooltip: !1,
                    notify: function(a) {
                        this.imageAtlas !== a && (this._layoutDirty = !0, this._updateRichTextStatus())
                    }
                },
                handleTouchEvent: {
                    default: !0,
                    tooltip: !1,
                    notify: function(a) {
                        this.handleTouchEvent !== a &&
                            this.enabledInHierarchy && (this.handleTouchEvent ? this._addEventListeners() : this._removeEventListeners())
                    }
                }
            },
            statics: {
                HorizontalAlign: k,
                VerticalAlign: c
            },
            onEnable: function() {
                this.handleTouchEvent && this._addEventListeners();
                this._updateRichText();
                this._activateChildren(!0)
            },
            onDisable: function() {
                this.handleTouchEvent && this._removeEventListeners();
                this._activateChildren(!1)
            },
            start: function() {
                this._onTTFLoaded()
            },
            _onColorChanged: function(a) {
                this.node.children.forEach(function(d) {
                    d.color = a
                })
            },
            _addEventListeners: function() {
                this.node.on(cc.Node.EventType.TOUCH_END,
                    this._onTouchEnded, this);
                this.node.on(cc.Node.EventType.COLOR_CHANGED, this._onColorChanged, this)
            },
            _removeEventListeners: function() {
                this.node.off(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this);
                this.node.off(cc.Node.EventType.COLOR_CHANGED, this._onColorChanged, this)
            },
            _updateLabelSegmentTextAttributes: function() {
                this._labelSegments.forEach(function(a) {
                    this._applyTextAttribute(a, null, !0)
                }.bind(this))
            },
            _createFontLabel: function(d) {
                return a.get(d, this)
            },
            _onTTFLoaded: function() {
                if (this.font instanceof cc.TTFFont)
                    if (this.font._nativeAsset) this._layoutDirty = !0, this._updateRichText();
                    else {
                        var a = this;
                        cc.assetManager.postLoadNative(this.font, function(d) {
                            a._layoutDirty = !0;
                            a._updateRichText()
                        })
                    }
                else this._layoutDirty = !0, this._updateRichText()
            },
            _measureText: function(a, c) {
                var d = this,
                    b = function(c) {
                        if (0 === d._labelSegmentsCache.length) {
                            var b = d._createFontLabel(c);
                            d._labelSegmentsCache.push(b)
                        } else b = d._labelSegmentsCache[0];
                        b._styleIndex = a;
                        d._applyTextAttribute(b, c, !0);
                        return b.getContentSize().width
                    };
                return c ?
                    b(c) : b
            },
            _onTouchEnded: function(a) {
                for (var d = this, b = this.node.getComponents(cc.Component), c = function(c) {
                        c = d._labelSegments[c];
                        var g = c._clickHandler,
                            l = c._clickParam;
                        g && d._containsTouchLocation(c, a.touch.getLocation()) && (b.forEach(function(d) {
                            d.enabledInHierarchy && d[g] && d[g](a, l)
                        }), a.stopPropagation())
                    }, k = 0; k < this._labelSegments.length; ++k) c(k)
            },
            _containsTouchLocation: function(a, c) {
                return a.getBoundingBoxToWorld().contains(c)
            },
            _resetState: function() {
                for (var d = this.node.children, c = d.length - 1; 0 <= c; c--) {
                    var b =
                        d[c];
                    if ("RICHTEXT_CHILD" === b.name || "RICHTEXT_Image_CHILD" === b.name) b.parent === this.node ? b.parent = null : d.splice(c, 1), "RICHTEXT_CHILD" === b.name && a.put(b)
                }
                this._labelSegments.length = 0;
                this._labelSegmentsCache.length = 0;
                this._lineOffsetX = this._linesWidth.length = 0;
                this._lineCount = 1;
                this._labelHeight = this._labelWidth = 0;
                this._layoutDirty = !0
            },
            onRestore: !1,
            _activateChildren: function(a) {
                for (var d = this.node.children.length - 1; 0 <= d; d--) {
                    var c = this.node.children[d];
                    "RICHTEXT_CHILD" !== c.name && "RICHTEXT_Image_CHILD" !==
                        c.name || (c.active = a)
                }
            },
            _addLabelSegment: function(a, c) {
                var d = 0 === this._labelSegmentsCache.length ? this._createFontLabel(a) : this._labelSegmentsCache.pop();
                d._styleIndex = c;
                d._lineCount = this._lineCount;
                d.active = this.node.active;
                d.setAnchorPoint(0, 0);
                this._applyTextAttribute(d, a);
                this.node.addChild(d);
                this._labelSegments.push(d);
                return d
            },
            _updateRichTextWithMaxWidth: function(a, c, b) {
                var d = c;
                if (0 < this._lineOffsetX && d + this._lineOffsetX > this.maxWidth)
                    for (c = 0; this._lineOffsetX <= this.maxWidth;) {
                        var g = this._getFirstWordLen(a,
                                c, a.length),
                            l = a.substr(c, g);
                        l = this._measureText(b, l);
                        if (!(this._lineOffsetX + l <= this.maxWidth)) {
                            0 < c && (d = a.substr(0, c), this._addLabelSegment(d, b), a = a.substr(c, a.length), d = this._measureText(b, a));
                            this._updateLineInfo();
                            break
                        }
                        this._lineOffsetX += l;
                        c += g
                    }
                if (d > this.maxWidth)
                    for (a = e.fragmentText(a, d, this.maxWidth, this._measureText(b)), c = 0; c < a.length; ++c) d = this._addLabelSegment(a[c], b), d = d.getContentSize(), this._lineOffsetX += d.width, 1 < a.length && c < a.length - 1 && this._updateLineInfo();
                else this._lineOffsetX += d,
                    this._addLabelSegment(a, b)
            },
            _isLastComponentCR: function(a) {
                return a.length - 1 === a.lastIndexOf("\n")
            },
            _updateLineInfo: function() {
                this._linesWidth.push(this._lineOffsetX);
                this._lineOffsetX = 0;
                this._lineCount++
            },
            _needsUpdateTextLayout: function(a) {
                if (this._layoutDirty || !this._textArray || !a || this._textArray.length !== a.length) return !0;
                for (var d = 0; d < this._textArray.length; ++d) {
                    var c = this._textArray[d],
                        b = a[d];
                    if (c.text !== b.text) return !0;
                    c = c.style;
                    b = b.style;
                    if (c)
                        if (b) {
                            if (!c.outline !== !b.outline || c.size !== b.size ||
                                !c.italic !== !b.italic || c.isImage !== b.isImage || c.src !== b.src || c.imageAlign !== b.imageAlign || c.imageHeight !== b.imageHeight || c.imageWidth !== b.imageWidth || c.imageOffset !== b.imageOffset) return !0
                        } else {
                            if (c.size || c.italic || c.isImage || c.outline) return !0
                        }
                    else if (b && (b.size || b.italic || b.isImage || b.outline)) return !0
                }
                return !1
            },
            _addRichTextImageElement: function(a) {
                var d = this.imageAtlas.getSpriteFrame(a.style.src);
                if (d) {
                    var c = new cc.PrivateNode("RICHTEXT_Image_CHILD"),
                        b = c.addComponent(cc.Sprite);
                    switch (a.style.imageAlign) {
                        case "top":
                            c.setAnchorPoint(0,
                                1);
                            break;
                        case "center":
                            c.setAnchorPoint(0, .5);
                            break;
                        default:
                            c.setAnchorPoint(0, 0)
                    }
                    a.style.imageOffset && (c._imageOffset = a.style.imageOffset);
                    b.type = cc.Sprite.Type.SLICED;
                    b.sizeMode = cc.Sprite.SizeMode.CUSTOM;
                    this.node.addChild(c);
                    this._labelSegments.push(c);
                    var k = d.getRect(),
                        e = k.width;
                    k = k.height;
                    var p = a.style.imageWidth;
                    var f = a.style.imageHeight;
                    f = 0 < f ? f / k : this.lineHeight / k;
                    e *= f;
                    k *= f;
                    0 < p && (e = p);
                    0 < this.maxWidth ? (this._lineOffsetX + e > this.maxWidth && this._updateLineInfo(), this._lineOffsetX += e) : (this._lineOffsetX +=
                        e, this._lineOffsetX > this._labelWidth && (this._labelWidth = this._lineOffsetX));
                    b.spriteFrame = d;
                    c.setContentSize(e, k);
                    c._lineCount = this._lineCount;
                    a.style.event ? (a.style.event.click && (c._clickHandler = a.style.event.click), a.style.event.param ? c._clickParam = a.style.event.param : c._clickParam = "") : c._clickHandler = null
                } else cc.warnID(4400)
            },
            _updateRichText: function() {
                if (this.enabledInHierarchy) {
                    var a = b.parse(this.string);
                    if (this._needsUpdateTextLayout(a)) {
                        this._textArray = a;
                        this._resetState();
                        a = !1;
                        for (var c,
                                g = 0; g < this._textArray.length; ++g) {
                            var n = this._textArray[g],
                                k = n.text;
                            if ("" === k) {
                                if (n.style && n.style.newline) {
                                    this._updateLineInfo();
                                    continue
                                }
                                if (n.style && n.style.isImage && this.imageAtlas) {
                                    this._addRichTextImageElement(n);
                                    continue
                                }
                            }
                            n = k.split("\n");
                            for (var f = 0; f < n.length; ++f)
                                if (c = n[f], "" === c) this._isLastComponentCR(k) && f === n.length - 1 || (this._updateLineInfo(), a = !0);
                                else {
                                    a = !1;
                                    if (0 < this.maxWidth) {
                                        var p = this._measureText(g, c);
                                        this._updateRichTextWithMaxWidth(c, p, g)
                                    } else c = this._addLabelSegment(c, g), c = c.getContentSize(),
                                        this._lineOffsetX += c.width, this._lineOffsetX > this._labelWidth && (this._labelWidth = this._lineOffsetX);
                                    1 < n.length && f < n.length - 1 && this._updateLineInfo()
                                }
                        }
                        a || this._linesWidth.push(this._lineOffsetX);
                        0 < this.maxWidth && (this._labelWidth = this.maxWidth);
                        this._labelHeight = (this._lineCount + e.BASELINE_RATIO) * this.lineHeight;
                        this.node.setContentSize(this._labelWidth, this._labelHeight);
                        this._updateRichTextPosition();
                        this._layoutDirty = !1
                    } else this._textArray = a, this._updateLabelSegmentTextAttributes()
                }
            },
            _getFirstWordLen: function(a,
                c, b) {
                var d = a.charAt(c);
                if (e.isUnicodeCJK(d) || e.isUnicodeSpace(d)) return 1;
                var g = 1;
                for (c += 1; c < b; ++c) {
                    d = a.charAt(c);
                    if (e.isUnicodeSpace(d) || e.isUnicodeCJK(d)) break;
                    g++
                }
                return g
            },
            _updateRichTextPosition: function() {
                for (var a = 0, c = 1, b = this._lineCount, n = 0; n < this._labelSegments.length; ++n) {
                    var f = this._labelSegments[n],
                        t = f._lineCount;
                    t > c && (a = 0, c = t);
                    var p = 0;
                    switch (this.horizontalAlign) {
                        case k.LEFT:
                            p = -this._labelWidth / 2;
                            break;
                        case k.CENTER:
                            p = -this._linesWidth[t - 1] / 2;
                            break;
                        case k.RIGHT:
                            p = this._labelWidth / 2 - this._linesWidth[t -
                                1]
                    }
                    f.x = a + p;
                    p = f.getContentSize();
                    f.y = this.lineHeight * (b - t) - this._labelHeight / 2;
                    t === c && (a += p.width);
                    if (f.getComponent(cc.Sprite)) {
                        t = this.lineHeight;
                        p = this.lineHeight * (1 + e.BASELINE_RATIO);
                        switch (f.anchorY) {
                            case 1:
                                f.y += t + (p - t) / 2;
                                break;
                            case .5:
                                f.y += p / 2;
                                break;
                            default:
                                f.y += (p - t) / 2
                        }
                        f._imageOffset && (p = f._imageOffset.split(","), 1 === p.length && p[0] ? (t = parseFloat(p[0]), Number.isInteger(t) && (f.y += t)) : 2 === p.length && (t = parseFloat(p[0]), p = parseFloat(p[1]), Number.isInteger(t) && (f.x += t), Number.isInteger(p) && (f.y += p)))
                    }(t =
                        f.getComponent(cc.LabelOutline)) && t.width && (f.y -= t.width)
                }
            },
            _convertLiteralColorValue: function(a) {
                var d = a.toUpperCase();
                return cc.Color[d] ? cc.Color[d] : cc.color().fromHEX(a)
            },
            _applyTextAttribute: function(a, c, b) {
                var d = a.getComponent(cc.Label);
                if (d) {
                    var g = a._styleIndex,
                        l = null;
                    this._textArray[g] && (l = this._textArray[g].style);
                    l && l.color ? a.color = this._convertLiteralColorValue(l.color) : a.color = this.node.color;
                    d.cacheMode = this.cacheMode;
                    this.font instanceof cc.Font && !this._isSystemFontUsed ? d.font = this.font :
                        d.fontFamily = this.fontFamily;
                    d.useSystemFont = this._isSystemFontUsed;
                    d.lineHeight = this.lineHeight;
                    d.enableBold = l && l.bold;
                    d.enableItalics = l && l.italic;
                    l && l.italic && (a.skewX = 12);
                    d.enableUnderline = l && l.underline;
                    l && l.outline && ((g = a.getComponent(cc.LabelOutline)) || (g = a.addComponent(cc.LabelOutline)), g.color = this._convertLiteralColorValue(l.outline.color), g.width = l.outline.width);
                    l && l.size ? d.fontSize = l.size : d.fontSize = this.fontSize;
                    null !== c && ("string" !== typeof c && (c = "" + c), d.string = c);
                    b && d._forceUpdateRenderData();
                    l && l.event ? (l.event.click && (a._clickHandler = l.event.click), l.event.param ? a._clickParam = l.event.param : a._clickParam = "") : a._clickHandler = null
                }
            },
            onDestroy: function() {
                for (var d = 0; d < this._labelSegments.length; ++d) this._labelSegments[d].removeFromParent(), a.put(this._labelSegments[d])
            }
        });
        cc.RichText = q.exports = h
    }, {
        "../platform/CCMacro": 209,
        "../platform/js": 225,
        "../utils/html-text-parser": 284,
        "../utils/text-utils": 293
    }],
    128: [function(h, q, m) {
        var f = h("./CCWidget"),
            e = h("../base-ui/CCWidgetManager");
        h = cc.Class({
            name: "cc.SafeArea",
            extends: h("./CCComponent"),
            editor: !1,
            onEnable: function() {
                this.updateArea();
                cc.view.on("canvas-resize", this.updateArea, this)
            },
            onDisable: function() {
                cc.view.off("canvas-resize", this.updateArea, this)
            },
            updateArea: function() {
                var b = this.node.getComponent(f);
                if (b) {
                    !1;
                    b.updateAlignment();
                    var k = this.node.position,
                        c = this.node.getAnchorPoint();
                    b.isAlignTop = b.isAlignBottom = b.isAlignLeft = b.isAlignRight = !0;
                    var a = cc.winSize.width,
                        d = cc.winSize.height,
                        l = cc.sys.getSafeAreaRect();
                    b.top = d - l.y - l.height;
                    b.bottom = l.y;
                    b.left =
                        l.x;
                    b.right = a - l.x - l.width;
                    b.updateAlignment();
                    a = this.node.position;
                    this.node.setAnchorPoint(c.x - (a.x - k.x) / this.node.width, c.y - (a.y - k.y) / this.node.height);
                    e.add(b)
                }
            }
        });
        cc.SafeArea = q.exports = h
    }, {
        "../base-ui/CCWidgetManager": 100,
        "./CCComponent": 116,
        "./CCWidget": 137
    }],
    129: [function(h, q, m) {
        var f = h("../utils/misc");
        h("./CCComponent");
        var e = cc.Enum({
            HORIZONTAL: 0,
            VERTICAL: 1
        });
        h = cc.Class({
            name: "cc.Scrollbar",
            extends: h("./CCComponent"),
            editor: !1,
            properties: {
                _scrollView: null,
                _touching: !1,
                _autoHideRemainingTime: {
                    default: 0,
                    serializable: !1
                },
                _opacity: 255,
                handle: {
                    default: null,
                    type: cc.Sprite,
                    tooltip: !1,
                    notify: function() {
                        this._onScroll(cc.v2(0, 0))
                    },
                    animatable: !1
                },
                direction: {
                    default: e.HORIZONTAL,
                    type: e,
                    tooltip: !1,
                    notify: function() {
                        this._onScroll(cc.v2(0, 0))
                    },
                    animatable: !1
                },
                enableAutoHide: {
                    default: !0,
                    animatable: !1,
                    tooltip: !1
                },
                autoHideTime: {
                    default: 1,
                    animatable: !1,
                    tooltip: !1
                }
            },
            statics: {
                Direction: e
            },
            setTargetScrollView: function(b) {
                this._scrollView = b
            },
            _convertToScrollViewSpace: function(b) {
                var k = this._scrollView.node;
                b = b.convertToWorldSpaceAR(cc.v2(-b.anchorX *
                    b.width, -b.anchorY * b.height));
                b = k.convertToNodeSpaceAR(b);
                b.x += k.anchorX * k.width;
                b.y += k.anchorY * k.height;
                return b
            },
            _setOpacity: function(b) {
                this.handle && (this.node.opacity = b, this.handle.node.opacity = b)
            },
            _onScroll: function(b) {
                if (this._scrollView) {
                    var k = this._scrollView.content;
                    if (k) {
                        var c = k.getContentSize(),
                            a = this._scrollView.node.getContentSize(),
                            d = this.node.getContentSize();
                        if (!this._conditionalDisableScrollBar(c, a)) {
                            this.enableAutoHide && (this._autoHideRemainingTime = this.autoHideTime, this._setOpacity(this._opacity));
                            var l = 0,
                                g = 0,
                                n = 0,
                                f = 0,
                                t = 0;
                            this.direction === e.HORIZONTAL ? (l = c.width, g = a.width, t = d.width, n = b.x, f = -this._convertToScrollViewSpace(k).x) : this.direction === e.VERTICAL && (l = c.height, g = a.height, t = d.height, n = b.y, f = -this._convertToScrollViewSpace(k).y);
                            b = this._calculateLength(l, g, t, n);
                            l = this._calculatePosition(l, g, t, f, n, b);
                            this._updateLength(b);
                            this._updateHanlderPosition(l)
                        }
                    }
                }
            },
            _updateHanlderPosition: function(b) {
                if (this.handle) {
                    var k = this._fixupHandlerPosition();
                    this.handle.node.setPosition(b.x + k.x, b.y + k.y)
                }
            },
            _fixupHandlerPosition: function() {
                var b = this.node.getContentSize(),
                    k = this.node.getAnchorPoint(),
                    c = this.handle.node.getContentSize(),
                    a = this.handle.node.parent;
                k = this.node.convertToWorldSpaceAR(cc.v2(-b.width * k.x, -b.height * k.y));
                a = a.convertToNodeSpaceAR(k);
                this.direction === e.HORIZONTAL ? a = cc.v2(a.x, a.y + (b.height - c.height) / 2) : this.direction === e.VERTICAL && (a = cc.v2(a.x + (b.width - c.width) / 2, a.y));
                this.handle.node.setPosition(a);
                return a
            },
            _onTouchBegan: function() {
                this.enableAutoHide && (this._touching = !0)
            },
            _conditionalDisableScrollBar: function(b,
                k) {
                return b.width <= k.width && this.direction === e.HORIZONTAL || b.height <= k.height && this.direction === e.VERTICAL ? !0 : !1
            },
            _onTouchEnded: function() {
                if (this.enableAutoHide && (this._touching = !1, !(0 >= this.autoHideTime))) {
                    if (this._scrollView) {
                        var b = this._scrollView.content;
                        if (b) {
                            b = b.getContentSize();
                            var k = this._scrollView.node.getContentSize();
                            if (this._conditionalDisableScrollBar(b, k)) return
                        }
                    }
                    this._autoHideRemainingTime = this.autoHideTime
                }
            },
            _calculateLength: function(b, k, c, a) {
                a && (b += 20 * (0 < a ? a : -a));
                return k / b * c
            },
            _calculatePosition: function(b, k, c, a, d, l) {
                b -= k;
                d && (b += Math.abs(d));
                d = 0;
                b && (d = f.clamp01(a / b));
                c = (c - l) * d;
                return this.direction === e.VERTICAL ? cc.v2(0, c) : cc.v2(c, 0)
            },
            _updateLength: function(b) {
                if (this.handle) {
                    var k = this.handle.node,
                        c = k.getContentSize();
                    k.setAnchorPoint(cc.v2(0, 0));
                    this.direction === e.HORIZONTAL ? k.setContentSize(b, c.height) : k.setContentSize(c.width, b)
                }
            },
            _processAutoHide: function(b) {
                !this.enableAutoHide || 0 >= this._autoHideRemainingTime || this._touching || (this._autoHideRemainingTime -= b, this._autoHideRemainingTime <=
                    this.autoHideTime && (this._autoHideRemainingTime = Math.max(0, this._autoHideRemainingTime), this._setOpacity(this._autoHideRemainingTime / this.autoHideTime * this._opacity)))
            },
            start: function() {
                this.enableAutoHide && this._setOpacity(0)
            },
            hide: function() {
                this._autoHideRemainingTime = 0;
                this._setOpacity(0)
            },
            show: function() {
                this._autoHideRemainingTime = this.autoHideTime;
                this._setOpacity(this._opacity)
            },
            update: function(b) {
                this._processAutoHide(b)
            }
        });
        cc.Scrollbar = q.exports = h
    }, {
        "../utils/misc": 286,
        "./CCComponent": 116
    }],
    130: [function(h, q, m) {
        var f = h("../CCNode").EventType,
            e = cc.v2(),
            b = cc.v2();
        m = cc.Enum({
            SCROLL_TO_TOP: 0,
            SCROLL_TO_BOTTOM: 1,
            SCROLL_TO_LEFT: 2,
            SCROLL_TO_RIGHT: 3,
            SCROLLING: 4,
            BOUNCE_TOP: 5,
            BOUNCE_BOTTOM: 6,
            BOUNCE_LEFT: 7,
            BOUNCE_RIGHT: 8,
            SCROLL_ENDED: 9,
            TOUCH_UP: 10,
            AUTOSCROLL_ENDED_WITH_THRESHOLD: 11,
            SCROLL_BEGAN: 12
        });
        var k = {
            "scroll-to-top": m.SCROLL_TO_TOP,
            "scroll-to-bottom": m.SCROLL_TO_BOTTOM,
            "scroll-to-left": m.SCROLL_TO_LEFT,
            "scroll-to-right": m.SCROLL_TO_RIGHT,
            scrolling: m.SCROLLING,
            "bounce-bottom": m.BOUNCE_BOTTOM,
            "bounce-left": m.BOUNCE_LEFT,
            "bounce-right": m.BOUNCE_RIGHT,
            "bounce-top": m.BOUNCE_TOP,
            "scroll-ended": m.SCROLL_ENDED,
            "touch-up": m.TOUCH_UP,
            "scroll-ended-with-threshold": m.AUTOSCROLL_ENDED_WITH_THRESHOLD,
            "scroll-began": m.SCROLL_BEGAN
        };
        h = cc.Class({
            name: "cc.ScrollView",
            extends: h("./CCViewGroup"),
            editor: !1,
            ctor: function() {
                this._rightBoundary = this._leftBoundary = this._bottomBoundary = this._topBoundary = 0;
                this._touchMoveDisplacements = [];
                this._touchMoveTimeDeltas = [];
                this._touchMovePreviousTimestamp = 0;
                this._autoScrollAttenuate =
                    this._autoScrolling = this._touchMoved = !1;
                this._autoScrollStartPosition = cc.v2(0, 0);
                this._autoScrollTargetDelta = cc.v2(0, 0);
                this._autoScrollAccumulatedTime = this._autoScrollTotalTime = 0;
                this._autoScrollBraking = this._autoScrollCurrentlyOutOfBoundary = !1;
                this._autoScrollBrakingStartPosition = cc.v2(0, 0);
                this._outOfBoundaryAmount = cc.v2(0, 0);
                this._outOfBoundaryAmountDirty = !0;
                this._stopMouseWheel = !1;
                this._mouseWheelEventElapsedTime = 0;
                this._isScrollEndedWithThresholdEventFired = !1;
                this._scrollEventEmitMask = 0;
                this._scrolling =
                    this._isBouncing = !1
            },
            properties: {
                content: {
                    default: void 0,
                    type: cc.Node,
                    tooltip: !1,
                    formerlySerializedAs: "content",
                    notify: function(c) {
                        this._calculateBoundary()
                    }
                },
                horizontal: {
                    default: !0,
                    animatable: !1,
                    tooltip: !1
                },
                vertical: {
                    default: !0,
                    animatable: !1,
                    tooltip: !1
                },
                inertia: {
                    default: !0,
                    tooltip: !1
                },
                brake: {
                    default: .5,
                    type: cc.Float,
                    range: [0, 1, .1],
                    tooltip: !1
                },
                elastic: {
                    default: !0,
                    animatable: !1,
                    tooltip: !1
                },
                bounceDuration: {
                    default: 1,
                    range: [0, 10],
                    tooltip: !1
                },
                horizontalScrollBar: {
                    default: void 0,
                    type: cc.Scrollbar,
                    tooltip: !1,
                    notify: function() {
                        this.horizontalScrollBar && (this.horizontalScrollBar.setTargetScrollView(this), this._updateScrollBar(0))
                    },
                    animatable: !1
                },
                verticalScrollBar: {
                    default: void 0,
                    type: cc.Scrollbar,
                    tooltip: !1,
                    notify: function() {
                        this.verticalScrollBar && (this.verticalScrollBar.setTargetScrollView(this), this._updateScrollBar(0))
                    },
                    animatable: !1
                },
                scrollEvents: {
                    default: [],
                    type: cc.Component.EventHandler,
                    tooltip: !1
                },
                cancelInnerEvents: {
                    default: !0,
                    animatable: !1,
                    tooltip: !1
                },
                _view: {
                    get: function() {
                        if (this.content) return this.content.parent
                    }
                }
            },
            statics: {
                EventType: m
            },
            scrollToBottom: function(c, a) {
                var d = this._calculateMovePercentDelta({
                    anchor: cc.v2(0, 0),
                    applyToHorizontal: !1,
                    applyToVertical: !0
                });
                c ? this._startAutoScroll(d, c, !1 !== a) : this._moveContent(d, !0)
            },
            scrollToTop: function(c, a) {
                var d = this._calculateMovePercentDelta({
                    anchor: cc.v2(0, 1),
                    applyToHorizontal: !1,
                    applyToVertical: !0
                });
                c ? this._startAutoScroll(d, c, !1 !== a) : this._moveContent(d)
            },
            scrollToLeft: function(c, a) {
                var d = this._calculateMovePercentDelta({
                    anchor: cc.v2(0, 0),
                    applyToHorizontal: !0,
                    applyToVertical: !1
                });
                c ? this._startAutoScroll(d, c, !1 !== a) : this._moveContent(d)
            },
            scrollToRight: function(c, a) {
                var d = this._calculateMovePercentDelta({
                    anchor: cc.v2(1, 0),
                    applyToHorizontal: !0,
                    applyToVertical: !1
                });
                c ? this._startAutoScroll(d, c, !1 !== a) : this._moveContent(d)
            },
            scrollToTopLeft: function(c, a) {
                var d = this._calculateMovePercentDelta({
                    anchor: cc.v2(0, 1),
                    applyToHorizontal: !0,
                    applyToVertical: !0
                });
                c ? this._startAutoScroll(d, c, !1 !== a) : this._moveContent(d)
            },
            scrollToTopRight: function(c, a) {
                var d = this._calculateMovePercentDelta({
                    anchor: cc.v2(1,
                        1),
                    applyToHorizontal: !0,
                    applyToVertical: !0
                });
                c ? this._startAutoScroll(d, c, !1 !== a) : this._moveContent(d)
            },
            scrollToBottomLeft: function(c, a) {
                var d = this._calculateMovePercentDelta({
                    anchor: cc.v2(0, 0),
                    applyToHorizontal: !0,
                    applyToVertical: !0
                });
                c ? this._startAutoScroll(d, c, !1 !== a) : this._moveContent(d)
            },
            scrollToBottomRight: function(c, a) {
                var d = this._calculateMovePercentDelta({
                    anchor: cc.v2(1, 0),
                    applyToHorizontal: !0,
                    applyToVertical: !0
                });
                c ? this._startAutoScroll(d, c, !1 !== a) : this._moveContent(d)
            },
            scrollToOffset: function(c,
                a, d) {
                var b = this.getMaxScrollOffset(),
                    g = cc.v2(0, 0);
                0 === b.x ? g.x = 0 : g.x = c.x / b.x;
                0 === b.y ? g.y = 1 : g.y = (b.y - c.y) / b.y;
                this.scrollTo(g, a, d)
            },
            getScrollOffset: function() {
                var c = this._getContentTopBoundary() - this._topBoundary,
                    a = this._getContentLeftBoundary() - this._leftBoundary;
                return cc.v2(a, c)
            },
            getMaxScrollOffset: function() {
                var c = this._view.getContentSize(),
                    a = this.content.getContentSize(),
                    d = a.width - c.width;
                c = a.height - c.height;
                return cc.v2(0 <= d ? d : 0, 0 <= c ? c : 0)
            },
            scrollToPercentHorizontal: function(c, a, d) {
                c = this._calculateMovePercentDelta({
                    anchor: cc.v2(c,
                        0),
                    applyToHorizontal: !0,
                    applyToVertical: !1
                });
                a ? this._startAutoScroll(c, a, !1 !== d) : this._moveContent(c)
            },
            scrollTo: function(c, a, d) {
                c = this._calculateMovePercentDelta({
                    anchor: cc.v2(c),
                    applyToHorizontal: !0,
                    applyToVertical: !0
                });
                a ? this._startAutoScroll(c, a, !1 !== d) : this._moveContent(c)
            },
            scrollToPercentVertical: function(c, a, d) {
                c = this._calculateMovePercentDelta({
                    anchor: cc.v2(0, c),
                    applyToHorizontal: !1,
                    applyToVertical: !0
                });
                a ? this._startAutoScroll(c, a, !1 !== d) : this._moveContent(c)
            },
            stopAutoScroll: function() {
                this._autoScrolling = !1;
                this._autoScrollAccumulatedTime = this._autoScrollTotalTime
            },
            setContentPosition: function(c) {
                c.fuzzyEquals(this.getContentPosition(), 1E-4) || (this.content.setPosition(c), this._outOfBoundaryAmountDirty = !0)
            },
            getContentPosition: function() {
                return this.content.getPosition()
            },
            isScrolling: function() {
                return this._scrolling
            },
            isAutoScrolling: function() {
                return this._autoScrolling
            },
            _registerEvent: function() {
                this.node.on(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this, !0);
                this.node.on(cc.Node.EventType.TOUCH_MOVE,
                    this._onTouchMoved, this, !0);
                this.node.on(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this, !0);
                this.node.on(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancelled, this, !0);
                this.node.on(cc.Node.EventType.MOUSE_WHEEL, this._onMouseWheel, this, !0)
            },
            _unregisterEvent: function() {
                this.node.off(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this, !0);
                this.node.off(cc.Node.EventType.TOUCH_MOVE, this._onTouchMoved, this, !0);
                this.node.off(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this, !0);
                this.node.off(cc.Node.EventType.TOUCH_CANCEL,
                    this._onTouchCancelled, this, !0);
                this.node.off(cc.Node.EventType.MOUSE_WHEEL, this._onMouseWheel, this, !0)
            },
            _onMouseWheel: function(c, a) {
                this.enabledInHierarchy && !this._hasNestedViewGroup(c, a) && (a = cc.v2(0, 0), !1, !1, this.vertical ? a = cc.v2(0, -.1 * c.getScrollY()) : this.horizontal && (a = cc.v2(-.1 * c.getScrollY(), 0)), this._mouseWheelEventElapsedTime = 0, this._processDeltaMove(a), this._stopMouseWheel || (this._handlePressLogic(), this.schedule(this._checkMouseWheel, 1 / 60), this._stopMouseWheel = !0), this._stopPropagationIfTargetIsMe(c))
            },
            _checkMouseWheel: function(c) {
                this._getHowMuchOutOfBoundary().fuzzyEquals(cc.v2(0, 0), 1E-4) ? (this._mouseWheelEventElapsedTime += c, .1 < this._mouseWheelEventElapsedTime && (this._onScrollBarTouchEnded(), this.unschedule(this._checkMouseWheel), this._dispatchEvent("scroll-ended"), this._stopMouseWheel = !1)) : (this._processInertiaScroll(), this.unschedule(this._checkMouseWheel), this._dispatchEvent("scroll-ended"), this._stopMouseWheel = !1)
            },
            _calculateMovePercentDelta: function(c) {
                var a = c.anchor,
                    d = c.applyToHorizontal;
                c = c.applyToVertical;
                this._calculateBoundary();
                a = a.clampf(cc.v2(0, 0), cc.v2(1, 1));
                var b = this._view.getContentSize(),
                    g = this.content.getContentSize(),
                    n = this._getContentBottomBoundary() - this._bottomBoundary;
                n = -n;
                var k = this._getContentLeftBoundary() - this._leftBoundary;
                k = -k;
                var e = cc.v2(0, 0);
                d && (d = g.width - b.width, e.x = k - d * a.x);
                c && (d = g.height - b.height, e.y = n - d * a.y);
                return e
            },
            _moveContentToTopLeft: function(c) {
                var a = this.content.getContentSize(),
                    d = this._getContentBottomBoundary() - this._bottomBoundary;
                d = -d;
                var b =
                    cc.v2(0, 0),
                    g = this._getContentLeftBoundary() - this._leftBoundary;
                g = -g;
                if (a.height < c.height) {
                    var n = a.height - c.height;
                    b.y = d - n
                }
                a.width < c.width && (b.x = g);
                this._updateScrollBarState();
                this._moveContent(b);
                this._adjustContentOutOfBoundary()
            },
            _calculateBoundary: function() {
                if (this.content) {
                    var c = this.content.getComponent(cc.Layout);
                    c && c.enabledInHierarchy && c.updateLayout();
                    c = this._view.getContentSize();
                    var a = c.height * this._view.anchorY;
                    this._leftBoundary = -(c.width * this._view.anchorX);
                    this._bottomBoundary = -a;
                    this._rightBoundary = this._leftBoundary + c.width;
                    this._topBoundary = this._bottomBoundary + c.height;
                    this._moveContentToTopLeft(c)
                }
            },
            _hasNestedViewGroup: function(c, a) {
                if (c.eventPhase === cc.Event.CAPTURING_PHASE) {
                    if (a)
                        for (var d = 0; d < a.length; ++d) {
                            var b = a[d];
                            if (this.node === b) {
                                if (c.target.getComponent(cc.ViewGroup)) return !0;
                                break
                            }
                            if (b.getComponent(cc.ViewGroup)) return !0
                        }
                    return !1
                }
            },
            _stopPropagationIfTargetIsMe: function(c) {
                c.eventPhase === cc.Event.AT_TARGET && c.target === this.node && c.stopPropagation()
            },
            _onTouchBegan: function(c,
                a) {
                this.enabledInHierarchy && !this._hasNestedViewGroup(c, a) && (a = c.touch, this.content && this._handlePressLogic(a), this._touchMoved = !1, this._stopPropagationIfTargetIsMe(c))
            },
            _onTouchMoved: function(c, a) {
                this.enabledInHierarchy && !this._hasNestedViewGroup(c, a) && (a = c.touch, this.content && this._handleMoveLogic(a), this.cancelInnerEvents && (7 < a.getLocation().sub(a.getStartLocation()).mag() && !this._touchMoved && c.target !== this.node && (a = new cc.Event.EventTouch(c.getTouches(), c.bubbles), a.type = cc.Node.EventType.TOUCH_CANCEL,
                    a.touch = c.touch, a.simulate = !0, c.target.dispatchEvent(a), this._touchMoved = !0), this._stopPropagationIfTargetIsMe(c)))
            },
            _onTouchEnded: function(c, a) {
                this.enabledInHierarchy && !this._hasNestedViewGroup(c, a) && (this._dispatchEvent("touch-up"), a = c.touch, this.content && this._handleReleaseLogic(a), this._touchMoved ? c.stopPropagation() : this._stopPropagationIfTargetIsMe(c))
            },
            _onTouchCancelled: function(c, a) {
                this.enabledInHierarchy && !this._hasNestedViewGroup(c, a) && (c.simulate || (a = c.touch, this.content && this._handleReleaseLogic(a)),
                    this._stopPropagationIfTargetIsMe(c))
            },
            _processDeltaMove: function(c) {
                this._scrollChildren(c);
                this._gatherTouchMove(c)
            },
            _getLocalAxisAlignDelta: function(c) {
                this.node.convertToNodeSpaceAR(c.getLocation(), e);
                this.node.convertToNodeSpaceAR(c.getPreviousLocation(), b);
                return e.sub(b)
            },
            _handleMoveLogic: function(c) {
                c = this._getLocalAxisAlignDelta(c);
                this._processDeltaMove(c)
            },
            _scrollChildren: function(c) {
                c = this._clampDelta(c);
                if (this.elastic) {
                    var a = this._getHowMuchOutOfBoundary();
                    c.x *= 0 === a.x ? 1 : .5;
                    c.y *= 0 ===
                        a.y ? 1 : .5
                }
                this.elastic || (a = this._getHowMuchOutOfBoundary(c), c = c.add(a));
                a = -1;
                0 < c.y ? this.content.y - this.content.anchorY * this.content.height + c.y >= this._bottomBoundary && (a = "scroll-to-bottom") : 0 > c.y && this.content.y - this.content.anchorY * this.content.height + this.content.height + c.y <= this._topBoundary && (a = "scroll-to-top");
                0 > c.x ? this.content.x - this.content.anchorX * this.content.width + this.content.width + c.x <= this._rightBoundary && (a = "scroll-to-right") : 0 < c.x && this.content.x - this.content.anchorX * this.content.width +
                    c.x >= this._leftBoundary && (a = "scroll-to-left");
                this._moveContent(c, !1);
                if (0 !== c.x || 0 !== c.y) this._scrolling || (this._scrolling = !0, this._dispatchEvent("scroll-began")), this._dispatchEvent("scrolling"); - 1 !== a && this._dispatchEvent(a)
            },
            _handlePressLogic: function() {
                this._autoScrolling && this._dispatchEvent("scroll-ended");
                this._isBouncing = this._autoScrolling = !1;
                this._touchMovePreviousTimestamp = (new Date).getMilliseconds();
                this._touchMoveDisplacements.length = 0;
                this._touchMoveTimeDeltas.length = 0;
                this._onScrollBarTouchBegan()
            },
            _clampDelta: function(c) {
                var a = this.content.getContentSize(),
                    d = this._view.getContentSize();
                a.width < d.width && (c.x = 0);
                a.height < d.height && (c.y = 0);
                return c
            },
            _gatherTouchMove: function(c) {
                for (c = this._clampDelta(c); 5 <= this._touchMoveDisplacements.length;) this._touchMoveDisplacements.shift(), this._touchMoveTimeDeltas.shift();
                this._touchMoveDisplacements.push(c);
                c = (new Date).getMilliseconds();
                this._touchMoveTimeDeltas.push((c - this._touchMovePreviousTimestamp) / 1E3);
                this._touchMovePreviousTimestamp = c
            },
            _startBounceBackIfNeeded: function() {
                if (!this.elastic) return !1;
                var c = this._getHowMuchOutOfBoundary();
                c = this._clampDelta(c);
                if (c.fuzzyEquals(cc.v2(0, 0), 1E-4)) return !1;
                this._startAutoScroll(c, Math.max(this.bounceDuration, 0), !0);
                this._isBouncing || (0 < c.y && this._dispatchEvent("bounce-top"), 0 > c.y && this._dispatchEvent("bounce-bottom"), 0 < c.x && this._dispatchEvent("bounce-right"), 0 > c.x && this._dispatchEvent("bounce-left"), this._isBouncing = !0);
                return !0
            },
            _processInertiaScroll: function() {
                if (!this._startBounceBackIfNeeded() && this.inertia) {
                    var c = this._calculateTouchMoveVelocity();
                    !c.fuzzyEquals(cc.v2(0, 0), 1E-4) && 1 > this.brake && this._startInertiaScroll(c)
                }
                this._onScrollBarTouchEnded()
            },
            _handleReleaseLogic: function(c) {
                c = this._getLocalAxisAlignDelta(c);
                this._gatherTouchMove(c);
                this._processInertiaScroll();
                this._scrolling && (this._scrolling = !1, this._autoScrolling || this._dispatchEvent("scroll-ended"))
            },
            _isOutOfBoundary: function() {
                return !this._getHowMuchOutOfBoundary().fuzzyEquals(cc.v2(0, 0), 1E-4)
            },
            _isNecessaryAutoScrollBrake: function() {
                if (this._autoScrollBraking) return !0;
                if (this._isOutOfBoundary()) {
                    if (!this._autoScrollCurrentlyOutOfBoundary) return this._autoScrollBraking =
                        this._autoScrollCurrentlyOutOfBoundary = !0, this._autoScrollBrakingStartPosition = this.getContentPosition(), !0
                } else this._autoScrollCurrentlyOutOfBoundary = !1;
                return !1
            },
            getScrollEndedEventTiming: function() {
                return 1E-4
            },
            _processAutoScrolling: function(c) {
                var a = this._isNecessaryAutoScrollBrake(),
                    d = a ? .05 : 1;
                this._autoScrollAccumulatedTime += 1 / d * c;
                var b = Math.min(1, this._autoScrollAccumulatedTime / this._autoScrollTotalTime);
                this._autoScrollAttenuate && (c = b - 1, b = c * c * c * c * c + 1);
                var g = this._autoScrollStartPosition.add(this._autoScrollTargetDelta.mul(b));
                c = 1E-4 >= Math.abs(b - 1);
                Math.abs(b - 1) <= this.getScrollEndedEventTiming() && !this._isScrollEndedWithThresholdEventFired && (this._dispatchEvent("scroll-ended-with-threshold"), this._isScrollEndedWithThresholdEventFired = !0);
                this.elastic ? (g = g.sub(this._autoScrollBrakingStartPosition), a && (g = g.mul(d)), g = this._autoScrollBrakingStartPosition.add(g)) : (a = g.sub(this.getContentPosition()), a = this._getHowMuchOutOfBoundary(a), a.fuzzyEquals(cc.v2(0, 0), 1E-4) || (g = g.add(a), c = !0));
                c && (this._autoScrolling = !1);
                a = g.sub(this.getContentPosition());
                this._moveContent(this._clampDelta(a), c);
                this._dispatchEvent("scrolling");
                this._autoScrolling || (this._scrolling = this._isBouncing = !1, this._dispatchEvent("scroll-ended"))
            },
            _startInertiaScroll: function(c) {
                var a = c.mul(.7);
                this._startAttenuatingAutoScroll(a, c)
            },
            _calculateAttenuatedFactor: function(c) {
                return 0 >= this.brake ? 1 - this.brake : 1 / (1 + 1.4E-5 * c + c * c * 8E-9) * (1 - this.brake)
            },
            _startAttenuatingAutoScroll: function(c, a) {
                a = this._calculateAutoScrollTimeByInitalSpeed(a.mag());
                var d = c.normalize(),
                    b = this.content.getContentSize(),
                    g = this._view.getContentSize(),
                    n = b.width - g.width;
                b = b.height - g.height;
                g = this._calculateAttenuatedFactor(n);
                var k = this._calculateAttenuatedFactor(b);
                d = cc.v2(d.x * n * (1 - this.brake) * g, d.y * b * k * (1 - this.brake));
                n = c.mag();
                n = d.mag() / n;
                d = d.add(c);
                0 < this.brake && 7 < n && (n = Math.sqrt(n), d = c.mul(n).add(c));
                0 < this.brake && 3 < n && (n = 3, a *= n);
                0 === this.brake && 1 < n && (a *= n);
                this._startAutoScroll(d, a, !0)
            },
            _calculateAutoScrollTimeByInitalSpeed: function(c) {
                return Math.sqrt(Math.sqrt(c / 5))
            },
            _startAutoScroll: function(c, a, d) {
                c = this._flattenVectorByDirection(c);
                this._autoScrolling = !0;
                this._autoScrollTargetDelta = c;
                this._autoScrollAttenuate = d;
                this._autoScrollStartPosition = this.getContentPosition();
                this._autoScrollTotalTime = a;
                this._autoScrollAccumulatedTime = 0;
                this._isScrollEndedWithThresholdEventFired = this._autoScrollBraking = !1;
                this._autoScrollBrakingStartPosition = cc.v2(0, 0);
                this._getHowMuchOutOfBoundary().fuzzyEquals(cc.v2(0, 0), 1E-4) || (this._autoScrollCurrentlyOutOfBoundary = !0)
            },
            _calculateTouchMoveVelocity: function() {
                var c = this._touchMoveTimeDeltas.reduce(function(a,
                    c) {
                    return a + c
                }, 0);
                if (0 >= c || .5 <= c) return cc.v2(0, 0);
                var a = cc.v2(0, 0);
                a = this._touchMoveDisplacements.reduce(function(a, c) {
                    return a.add(c)
                }, a);
                return cc.v2(a.x * (1 - this.brake) / c, a.y * (1 - this.brake) / c)
            },
            _flattenVectorByDirection: function(c) {
                c.x = this.horizontal ? c.x : 0;
                c.y = this.vertical ? c.y : 0;
                return c
            },
            _moveContent: function(c, a) {
                c = this._flattenVectorByDirection(c);
                c = this.getContentPosition().add(c);
                this.setContentPosition(c);
                c = this._getHowMuchOutOfBoundary();
                this._updateScrollBar(c);
                this.elastic && a && this._startBounceBackIfNeeded()
            },
            _getContentLeftBoundary: function() {
                return this.getContentPosition().x - this.content.getAnchorPoint().x * this.content.getContentSize().width
            },
            _getContentRightBoundary: function() {
                var c = this.content.getContentSize();
                return this._getContentLeftBoundary() + c.width
            },
            _getContentTopBoundary: function() {
                var c = this.content.getContentSize();
                return this._getContentBottomBoundary() + c.height
            },
            _getContentBottomBoundary: function() {
                return this.getContentPosition().y - this.content.getAnchorPoint().y * this.content.getContentSize().height
            },
            _getHowMuchOutOfBoundary: function(c) {
                c = c || cc.v2(0, 0);
                if (c.fuzzyEquals(cc.v2(0, 0), 1E-4) && !this._outOfBoundaryAmountDirty) return this._outOfBoundaryAmount;
                var a = cc.v2(0, 0);
                this._getContentLeftBoundary() + c.x > this._leftBoundary ? a.x = this._leftBoundary - (this._getContentLeftBoundary() + c.x) : this._getContentRightBoundary() + c.x < this._rightBoundary && (a.x = this._rightBoundary - (this._getContentRightBoundary() + c.x));
                this._getContentTopBoundary() + c.y < this._topBoundary ? a.y = this._topBoundary - (this._getContentTopBoundary() +
                    c.y) : this._getContentBottomBoundary() + c.y > this._bottomBoundary && (a.y = this._bottomBoundary - (this._getContentBottomBoundary() + c.y));
                c.fuzzyEquals(cc.v2(0, 0), 1E-4) && (this._outOfBoundaryAmount = a, this._outOfBoundaryAmountDirty = !1);
                return a = this._clampDelta(a)
            },
            _updateScrollBarState: function() {
                if (this.content) {
                    var c = this.content.getContentSize(),
                        a = this._view.getContentSize();
                    this.verticalScrollBar && (c.height < a.height ? this.verticalScrollBar.hide() : this.verticalScrollBar.show());
                    this.horizontalScrollBar &&
                        (c.width < a.width ? this.horizontalScrollBar.hide() : this.horizontalScrollBar.show())
                }
            },
            _updateScrollBar: function(c) {
                this.horizontalScrollBar && this.horizontalScrollBar._onScroll(c);
                this.verticalScrollBar && this.verticalScrollBar._onScroll(c)
            },
            _onScrollBarTouchBegan: function() {
                this.horizontalScrollBar && this.horizontalScrollBar._onTouchBegan();
                this.verticalScrollBar && this.verticalScrollBar._onTouchBegan()
            },
            _onScrollBarTouchEnded: function() {
                this.horizontalScrollBar && this.horizontalScrollBar._onTouchEnded();
                this.verticalScrollBar && this.verticalScrollBar._onTouchEnded()
            },
            _dispatchEvent: function(c) {
                if ("scroll-ended" === c) this._scrollEventEmitMask = 0;
                else if ("scroll-to-top" === c || "scroll-to-bottom" === c || "scroll-to-left" === c || "scroll-to-right" === c) {
                    var a = 1 << k[c];
                    if (this._scrollEventEmitMask & a) return;
                    this._scrollEventEmitMask |= a
                }
                cc.Component.EventHandler.emitEvents(this.scrollEvents, this, k[c]);
                this.node.emit(c, this)
            },
            _adjustContentOutOfBoundary: function() {
                this._outOfBoundaryAmountDirty = !0;
                if (this._isOutOfBoundary()) {
                    var c =
                        this._getHowMuchOutOfBoundary(cc.v2(0, 0));
                    c = this.getContentPosition().add(c);
                    this.content && (this.content.setPosition(c), this._updateScrollBar(0))
                }
            },
            start: function() {
                this._calculateBoundary();
                this.content && cc.director.once(cc.Director.EVENT_BEFORE_DRAW, this._adjustContentOutOfBoundary, this)
            },
            _hideScrollbar: function() {
                this.horizontalScrollBar && this.horizontalScrollBar.hide();
                this.verticalScrollBar && this.verticalScrollBar.hide()
            },
            onDisable: function() {
                !0;
                this._unregisterEvent();
                this.content && (this.content.off(f.SIZE_CHANGED,
                    this._calculateBoundary, this), this.content.off(f.SCALE_CHANGED, this._calculateBoundary, this), this._view && (this._view.off(f.POSITION_CHANGED, this._calculateBoundary, this), this._view.off(f.SCALE_CHANGED, this._calculateBoundary, this), this._view.off(f.SIZE_CHANGED, this._calculateBoundary, this)));
                this._hideScrollbar();
                this.stopAutoScroll()
            },
            onEnable: function() {
                !0;
                this._registerEvent();
                this.content && (this.content.on(f.SIZE_CHANGED, this._calculateBoundary, this), this.content.on(f.SCALE_CHANGED, this._calculateBoundary,
                    this), this._view && (this._view.on(f.POSITION_CHANGED, this._calculateBoundary, this), this._view.on(f.SCALE_CHANGED, this._calculateBoundary, this), this._view.on(f.SIZE_CHANGED, this._calculateBoundary, this)));
                this._updateScrollBarState()
            },
            update: function(c) {
                this._autoScrolling && this._processAutoScrolling(c)
            }
        });
        cc.ScrollView = q.exports = h
    }, {
        "../CCNode": 40,
        "./CCViewGroup": 136
    }],
    131: [function(h, q, m) {
        var f = h("../utils/misc");
        h = h("./CCComponent");
        var e = cc.Enum({
            Horizontal: 0,
            Vertical: 1
        });
        h = cc.Class({
            name: "cc.Slider",
            extends: h,
            editor: !1,
            ctor: function() {
                this._offset = cc.v2();
                this._dragging = this._touchHandle = !1
            },
            properties: {
                handle: {
                    default: null,
                    type: cc.Button,
                    tooltip: !1,
                    notify: function() {
                        !1
                    }
                },
                direction: {
                    default: e.Horizontal,
                    type: e,
                    tooltip: !1
                },
                progress: {
                    default: .5,
                    type: cc.Float,
                    range: [0, 1, .1],
                    slide: !0,
                    tooltip: !1,
                    notify: function() {
                        this._updateHandlePosition()
                    }
                },
                slideEvents: {
                    default: [],
                    type: cc.Component.EventHandler,
                    tooltip: !1
                }
            },
            statics: {
                Direction: e
            },
            __preload: function() {
                this._updateHandlePosition()
            },
            onEnable: function() {
                this.node.on(cc.Node.EventType.TOUCH_START,
                    this._onTouchBegan, this);
                this.node.on(cc.Node.EventType.TOUCH_MOVE, this._onTouchMoved, this);
                this.node.on(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this);
                this.node.on(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancelled, this);
                this.handle && this.handle.isValid && (this.handle.node.on(cc.Node.EventType.TOUCH_START, this._onHandleDragStart, this), this.handle.node.on(cc.Node.EventType.TOUCH_MOVE, this._onTouchMoved, this), this.handle.node.on(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this))
            },
            onDisable: function() {
                this.node.off(cc.Node.EventType.TOUCH_START,
                    this._onTouchBegan, this);
                this.node.off(cc.Node.EventType.TOUCH_MOVE, this._onTouchMoved, this);
                this.node.off(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this);
                this.node.off(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancelled, this);
                this.handle && this.handle.isValid && (this.handle.node.off(cc.Node.EventType.TOUCH_START, this._onHandleDragStart, this), this.handle.node.off(cc.Node.EventType.TOUCH_MOVE, this._onTouchMoved, this), this.handle.node.off(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this))
            },
            _onHandleDragStart: function(b) {
                this._touchHandle = this._dragging = !0;
                this._offset = this.handle.node.convertToNodeSpaceAR(b.touch.getLocation());
                b.stopPropagation()
            },
            _onTouchBegan: function(b) {
                this.handle && (this._dragging = !0, this._touchHandle || this._handleSliderLogic(b.touch), b.stopPropagation())
            },
            _onTouchMoved: function(b) {
                this._dragging && (this._handleSliderLogic(b.touch), b.stopPropagation())
            },
            _onTouchEnded: function(b) {
                this._touchHandle = this._dragging = !1;
                this._offset = cc.v2();
                b.stopPropagation()
            },
            _onTouchCancelled: function(b) {
                this._dragging = !1;
                b.stopPropagation()
            },
            _handleSliderLogic: function(b) {
                this._updateProgress(b);
                this._emitSlideEvent()
            },
            _emitSlideEvent: function() {
                cc.Component.EventHandler.emitEvents(this.slideEvents, this);
                this.node.emit("slide", this)
            },
            _updateProgress: function(b) {
                if (this.handle) {
                    var k = this.node;
                    b = k.convertToNodeSpaceAR(b.getLocation());
                    this.direction === e.Horizontal ? this.progress = f.clamp01((b.x - this._offset.x + k.anchorX * k.width) / k.width) : this.progress = f.clamp01((b.y - this._offset.y + k.anchorY * k.height) / k.height)
                }
            },
            _updateHandlePosition: function() {
                if (this.handle) {
                    var b =
                        this.direction === e.Horizontal ? cc.v2(-this.node.width * this.node.anchorX + this.progress * this.node.width, 0) : cc.v2(0, -this.node.height * this.node.anchorY + this.progress * this.node.height);
                    b = this.node.convertToWorldSpaceAR(b);
                    this.handle.node.position = this.handle.node.parent.convertToNodeSpaceAR(b)
                }
            }
        });
        cc.Slider = q.exports = h
    }, {
        "../utils/misc": 286,
        "./CCComponent": 116
    }],
    132: [function(h, q, m) {
        var f = h("../utils/misc");
        h("../CCNode");
        m = h("./CCRenderComponent");
        var e = h("../utils/blend-func"),
            b = cc.Enum({
                SIMPLE: 0,
                SLICED: 1,
                TILED: 2,
                FILLED: 3,
                MESH: 4
            });
        h = cc.Enum({
            HORIZONTAL: 0,
            VERTICAL: 1,
            RADIAL: 2
        });
        var k = cc.Enum({
                CUSTOM: 0,
                TRIMMED: 1,
                RAW: 2
            }),
            c = cc.Enum({
                NORMAL: 0,
                GRAY: 1
            });
        m = cc.Class({
            name: "cc.Sprite",
            extends: m,
            mixins: [e],
            editor: !1,
            properties: {
                _spriteFrame: {
                    default: null,
                    type: cc.SpriteFrame
                },
                _type: b.SIMPLE,
                _sizeMode: k.TRIMMED,
                _fillType: 0,
                _fillCenter: cc.v2(0, 0),
                _fillStart: 0,
                _fillRange: 0,
                _isTrimmedMode: !0,
                _atlas: {
                    default: null,
                    type: cc.SpriteAtlas,
                    tooltip: !1,
                    editorOnly: !0,
                    visible: !0,
                    animatable: !1
                },
                spriteFrame: {
                    get: function() {
                        return this._spriteFrame
                    },
                    set: function(a, d) {
                        d = this._spriteFrame;
                        !1;
                        d !== a && (this._spriteFrame = a, this._applySpriteFrame(d), !1)
                    },
                    type: cc.SpriteFrame
                },
                type: {
                    get: function() {
                        return this._type
                    },
                    set: function(a) {
                        this._type !== a && (this._type = a, this.setVertsDirty(), this._resetAssembler())
                    },
                    type: b,
                    animatable: !1,
                    tooltip: !1
                },
                fillType: {
                    get: function() {
                        return this._fillType
                    },
                    set: function(a) {
                        a !== this._fillType && (this._fillType = a, this.setVertsDirty(), this._resetAssembler())
                    },
                    type: h,
                    tooltip: !1
                },
                fillCenter: {
                    get: function() {
                        return this._fillCenter
                    },
                    set: function(a) {
                        this._fillCenter.x = a.x;
                        this._fillCenter.y = a.y;
                        this._type === b.FILLED && this.setVertsDirty()
                    },
                    tooltip: !1
                },
                fillStart: {
                    get: function() {
                        return this._fillStart
                    },
                    set: function(a) {
                        this._fillStart = f.clampf(a, -1, 1);
                        this._type === b.FILLED && this.setVertsDirty()
                    },
                    tooltip: !1
                },
                fillRange: {
                    get: function() {
                        return this._fillRange
                    },
                    set: function(a) {
                        this._fillRange = f.clampf(a, -1, 1);
                        this._type === b.FILLED && this.setVertsDirty()
                    },
                    tooltip: !1
                },
                trim: {
                    get: function() {
                        return this._isTrimmedMode
                    },
                    set: function(a) {
                        this._isTrimmedMode !==
                            a && (this._isTrimmedMode = a, this._type !== b.SIMPLE && this._type !== b.MESH || this.setVertsDirty())
                    },
                    animatable: !1,
                    tooltip: !1
                },
                sizeMode: {
                    get: function() {
                        return this._sizeMode
                    },
                    set: function(a) {
                        this._sizeMode = a;
                        a !== k.CUSTOM && this._applySpriteSize()
                    },
                    animatable: !1,
                    type: k,
                    tooltip: !1
                }
            },
            statics: {
                FillType: h,
                Type: b,
                SizeMode: k,
                State: c
            },
            setVisible: function(a) {
                this.enabled = a
            },
            setState: function() {},
            getState: function() {},
            __preload: function() {
                this._super();
                !1;
                this._applySpriteFrame()
            },
            onEnable: function() {
                this._super();
                this._spriteFrame && this._spriteFrame.ensureLoadTexture();
                this.node.on(cc.Node.EventType.SIZE_CHANGED, this.setVertsDirty, this);
                this.node.on(cc.Node.EventType.ANCHOR_CHANGED, this.setVertsDirty, this)
            },
            onDisable: function() {
                this._super();
                this.node.off(cc.Node.EventType.SIZE_CHANGED, this.setVertsDirty, this);
                this.node.off(cc.Node.EventType.ANCHOR_CHANGED, this.setVertsDirty, this)
            },
            _updateMaterial: function() {
                var a = this._spriteFrame && this._spriteFrame.getTexture(),
                    d = this.getMaterial(0);
                d && (void 0 !== d.getDefine("USE_TEXTURE") &&
                    d.define("USE_TEXTURE", !0), d.setProperty("texture", a));
                e.prototype._updateMaterial.call(this)
            },
            _applyAtlas: !1,
            _validateRender: function() {
                var a = this._spriteFrame;
                this._materials[0] && a && a.textureLoaded() || this.disableRender()
            },
            _applySpriteSize: function() {
                if (this._spriteFrame && this.isValid) {
                    if (k.RAW === this._sizeMode) this.node.setContentSize(this._spriteFrame._originalSize);
                    else if (k.TRIMMED === this._sizeMode) {
                        var a = this._spriteFrame._rect;
                        this.node.setContentSize(a.width, a.height)
                    }
                    this.setVertsDirty()
                }
            },
            _applySpriteFrame: function(a) {
                var d = a && a.getTexture();
                d && !d.loaded && a.off("load", this._applySpriteSize, this);
                this._updateMaterial();
                (a = this._spriteFrame) ? (d = a.getTexture()) && d.loaded ? this._applySpriteSize() : (this.disableRender(), a.once("load", this._applySpriteSize, this)): this.disableRender();
                !1
            }
        });
        !1;
        cc.Sprite = q.exports = m
    }, {
        "../CCNode": 40,
        "../utils/blend-func": 280,
        "../utils/misc": 286,
        "./CCRenderComponent": 126
    }],
    133: [function(h, q, m) {
        m = h("../utils/gray-sprite-state");
        m = cc.Class({
            name: "cc.Toggle",
            extends: h("./CCButton"),
            mixins: [m],
            editor: !1,
            properties: {
                _N$isChecked: !0,
                isChecked: {
                    get: function() {
                        return this._N$isChecked
                    },
                    set: function(f) {
                        if (f !== this._N$isChecked) {
                            var e = this.toggleGroup || this._toggleContainer;
                            e && e.enabled && this._N$isChecked && !e.allowSwitchOff || (this._N$isChecked = f, this._updateCheckMark(), e && e.enabled && e.updateToggles(this), cc.Toggle._triggerEventInScript_isChecked && this._emitToggleEvents())
                        }
                    },
                    tooltip: !1
                },
                toggleGroup: {
                    default: null,
                    tooltip: !1,
                    type: h("./CCToggleGroup")
                },
                checkMark: {
                    default: null,
                    type: cc.Sprite,
                    tooltip: !1
                },
                checkEvents: {
                    default: [],
                    type: cc.Component.EventHandler
                },
                _resizeToTarget: {
                    animatable: !1,
                    set: function(f) {
                        f && this._resizeNodeToTargetNode()
                    }
                }
            },
            statics: {
                _triggerEventInScript_check: !1,
                _triggerEventInScript_isChecked: !1
            },
            onEnable: function() {
                this._super();
                !0;
                this._registerToggleEvent();
                this.toggleGroup && this.toggleGroup.enabledInHierarchy && this.toggleGroup.addToggle(this)
            },
            onDisable: function() {
                this._super();
                !0;
                this._unregisterToggleEvent();
                this.toggleGroup && this.toggleGroup.enabledInHierarchy &&
                    this.toggleGroup.removeToggle(this)
            },
            _hideCheckMark: function() {
                this._N$isChecked = !1;
                this._updateCheckMark()
            },
            toggle: function(f) {
                this.isChecked = !this.isChecked;
                cc.Toggle._triggerEventInScript_isChecked || !cc.Toggle._triggerEventInScript_check && !f || this._emitToggleEvents()
            },
            check: function() {
                this.isChecked = !0;
                !cc.Toggle._triggerEventInScript_isChecked && cc.Toggle._triggerEventInScript_check && this._emitToggleEvents()
            },
            uncheck: function() {
                this.isChecked = !1;
                !cc.Toggle._triggerEventInScript_isChecked && cc.Toggle._triggerEventInScript_check &&
                    this._emitToggleEvents()
            },
            _updateCheckMark: function() {
                this.checkMark && (this.checkMark.node.active = !!this.isChecked)
            },
            _updateDisabledState: function() {
                this._super();
                this.enableAutoGrayEffect && this.checkMark && this._switchGrayMaterial(!this.interactable, this.checkMark)
            },
            _registerToggleEvent: function() {
                this.node.on("click", this.toggle, this)
            },
            _unregisterToggleEvent: function() {
                this.node.off("click", this.toggle, this)
            },
            _emitToggleEvents: function() {
                this.node.emit("toggle", this);
                this.checkEvents && cc.Component.EventHandler.emitEvents(this.checkEvents,
                    this)
            }
        });
        cc.Toggle = q.exports = m;
        h("../platform/js").get(m.prototype, "_toggleContainer", function() {
            var f = this.node.parent;
            return cc.Node.isNode(f) ? f.getComponent(cc.ToggleContainer) : null
        })
    }, {
        "../platform/js": 225,
        "../utils/gray-sprite-state": 283,
        "./CCButton": 114,
        "./CCToggleGroup": 135
    }],
    134: [function(h, q, m) {
        m = cc.Class({
            name: "cc.ToggleContainer",
            extends: cc.Component,
            editor: !1,
            properties: {
                allowSwitchOff: {
                    tooltip: !1,
                    default: !1
                },
                checkEvents: {
                    default: [],
                    type: cc.Component.EventHandler
                }
            },
            updateToggles: function(f) {
                this.enabledInHierarchy &&
                    f.isChecked && (this.toggleItems.forEach(function(e) {
                        e !== f && e.isChecked && e.enabled && e._hideCheckMark()
                    }), this.checkEvents && cc.Component.EventHandler.emitEvents(this.checkEvents, f))
            },
            _allowOnlyOneToggleChecked: function() {
                var f = !1;
                this.toggleItems.forEach(function(e) {
                    f ? e._hideCheckMark() : e.isChecked && (f = !0)
                });
                return f
            },
            _makeAtLeastOneToggleChecked: function() {
                if (!this._allowOnlyOneToggleChecked() && !this.allowSwitchOff) {
                    var f = this.toggleItems;
                    0 < f.length && f[0].check()
                }
            },
            onEnable: function() {
                this.node.on("child-added",
                    this._allowOnlyOneToggleChecked, this);
                this.node.on("child-removed", this._makeAtLeastOneToggleChecked, this)
            },
            onDisable: function() {
                this.node.off("child-added", this._allowOnlyOneToggleChecked, this);
                this.node.off("child-removed", this._makeAtLeastOneToggleChecked, this)
            },
            start: function() {
                this._makeAtLeastOneToggleChecked()
            }
        });
        h("../platform/js").get(m.prototype, "toggleItems", function() {
            return this.node._children.map(function(f) {
                return f.getComponent(cc.Toggle)
            }).filter(Boolean)
        });
        cc.ToggleContainer = q.exports =
            m
    }, {
        "../platform/js": 225
    }],
    135: [function(h, q, m) {
        var f = cc.Class({
                name: "cc.ToggleGroup",
                extends: cc.Component,
                ctor: function() {
                    this._toggleItems = []
                },
                editor: !1,
                properties: {
                    allowSwitchOff: {
                        tooltip: !1,
                        default: !1
                    },
                    toggleItems: {
                        get: function() {
                            return this._toggleItems
                        }
                    }
                },
                updateToggles: function(b) {
                    this.enabledInHierarchy && this._toggleItems.forEach(function(k) {
                        b.isChecked && k !== b && k.isChecked && k.enabled && k._hideCheckMark()
                    })
                },
                addToggle: function(b) {
                    -1 === this._toggleItems.indexOf(b) && this._toggleItems.push(b);
                    this._allowOnlyOneToggleChecked()
                },
                removeToggle: function(b) {
                    b = this._toggleItems.indexOf(b); - 1 < b && this._toggleItems.splice(b, 1);
                    this._makeAtLeastOneToggleChecked()
                },
                _allowOnlyOneToggleChecked: function() {
                    var b = !1;
                    this._toggleItems.forEach(function(k) {
                        b && k.enabled && k._hideCheckMark();
                        k.isChecked && k.enabled && (b = !0)
                    });
                    return b
                },
                _makeAtLeastOneToggleChecked: function() {
                    this._allowOnlyOneToggleChecked() || this.allowSwitchOff || 0 < this._toggleItems.length && (this._toggleItems[0].isChecked = !0)
                },
                start: function() {
                    this._makeAtLeastOneToggleChecked()
                }
            }),
            e = !1;
        h("../platform/js").get(cc, "ToggleGroup", function() {
            e || (cc.errorID(1405, "cc.ToggleGroup", "cc.ToggleContainer"), e = !0);
            return f
        });
        q.exports = f
    }, {
        "../platform/js": 225
    }],
    136: [function(h, q, m) {
        h = cc.Class({
            name: "cc.ViewGroup",
            extends: h("./CCComponent")
        });
        cc.ViewGroup = q.exports = h
    }, {
        "./CCComponent": 116
    }],
    137: [function(h, q, m) {
        var f = h("../base-ui/CCWidgetManager"),
            e = f.AlignMode;
        m = f._AlignFlags;
        var b = m.TOP,
            k = m.MID,
            c = m.BOT,
            a = m.LEFT,
            d = m.CENTER,
            l = m.RIGHT,
            g = b | c,
            n = a | l;
        h = cc.Class({
            name: "cc.Widget",
            extends: h("./CCComponent"),
            editor: !1,
            properties: {
                target: {
                    get: function() {
                        return this._target
                    },
                    set: function(a) {
                        this._target = a;
                        !1
                    },
                    type: cc.Node,
                    tooltip: !1
                },
                isAlignTop: {
                    get: function() {
                        return 0 < (this._alignFlags & b)
                    },
                    set: function(a) {
                        this._setAlign(b, a)
                    },
                    animatable: !1,
                    tooltip: !1
                },
                isAlignVerticalCenter: {
                    get: function() {
                        return 0 < (this._alignFlags & k)
                    },
                    set: function(a) {
                        a ? (this.isAlignBottom = this.isAlignTop = !1, this._alignFlags |= k) : this._alignFlags &= ~k
                    },
                    animatable: !1,
                    tooltip: !1
                },
                isAlignBottom: {
                    get: function() {
                        return 0 < (this._alignFlags & c)
                    },
                    set: function(a) {
                        this._setAlign(c, a)
                    },
                    animatable: !1,
                    tooltip: !1
                },
                isAlignLeft: {
                    get: function() {
                        return 0 < (this._alignFlags & a)
                    },
                    set: function(d) {
                        this._setAlign(a, d)
                    },
                    animatable: !1,
                    tooltip: !1
                },
                isAlignHorizontalCenter: {
                    get: function() {
                        return 0 < (this._alignFlags & d)
                    },
                    set: function(a) {
                        a ? (this.isAlignRight = this.isAlignLeft = !1, this._alignFlags |= d) : this._alignFlags &= ~d
                    },
                    animatable: !1,
                    tooltip: !1
                },
                isAlignRight: {
                    get: function() {
                        return 0 < (this._alignFlags & l)
                    },
                    set: function(a) {
                        this._setAlign(l, a)
                    },
                    animatable: !1,
                    tooltip: !1
                },
                isStretchWidth: {
                    get: function() {
                        return (this._alignFlags & n) === n
                    },
                    visible: !1
                },
                isStretchHeight: {
                    get: function() {
                        return (this._alignFlags & g) === g
                    },
                    visible: !1
                },
                top: {
                    get: function() {
                        return this._top
                    },
                    set: function(a) {
                        this._top = a
                    },
                    tooltip: !1
                },
                bottom: {
                    get: function() {
                        return this._bottom
                    },
                    set: function(a) {
                        this._bottom = a
                    },
                    tooltip: !1
                },
                left: {
                    get: function() {
                        return this._left
                    },
                    set: function(a) {
                        this._left = a
                    },
                    tooltip: !1
                },
                right: {
                    get: function() {
                        return this._right
                    },
                    set: function(a) {
                        this._right = a
                    },
                    tooltip: !1
                },
                horizontalCenter: {
                    get: function() {
                        return this._horizontalCenter
                    },
                    set: function(a) {
                        this._horizontalCenter = a
                    },
                    tooltip: !1
                },
                verticalCenter: {
                    get: function() {
                        return this._verticalCenter
                    },
                    set: function(a) {
                        this._verticalCenter = a
                    },
                    tooltip: !1
                },
                isAbsoluteHorizontalCenter: {
                    get: function() {
                        return this._isAbsHorizontalCenter
                    },
                    set: function(a) {
                        this._isAbsHorizontalCenter = a
                    },
                    animatable: !1
                },
                isAbsoluteVerticalCenter: {
                    get: function() {
                        return this._isAbsVerticalCenter
                    },
                    set: function(a) {
                        this._isAbsVerticalCenter = a
                    },
                    animatable: !1
                },
                isAbsoluteTop: {
                    get: function() {
                        return this._isAbsTop
                    },
                    set: function(a) {
                        this._isAbsTop =
                            a
                    },
                    animatable: !1
                },
                isAbsoluteBottom: {
                    get: function() {
                        return this._isAbsBottom
                    },
                    set: function(a) {
                        this._isAbsBottom = a
                    },
                    animatable: !1
                },
                isAbsoluteLeft: {
                    get: function() {
                        return this._isAbsLeft
                    },
                    set: function(a) {
                        this._isAbsLeft = a
                    },
                    animatable: !1
                },
                isAbsoluteRight: {
                    get: function() {
                        return this._isAbsRight
                    },
                    set: function(a) {
                        this._isAbsRight = a
                    },
                    animatable: !1
                },
                alignMode: {
                    default: e.ON_WINDOW_RESIZE,
                    type: e,
                    tooltip: !1
                },
                _wasAlignOnce: {
                    default: void 0,
                    formerlySerializedAs: "isAlignOnce"
                },
                _target: null,
                _alignFlags: 0,
                _left: 0,
                _right: 0,
                _top: 0,
                _bottom: 0,
                _verticalCenter: 0,
                _horizontalCenter: 0,
                _isAbsLeft: !0,
                _isAbsRight: !0,
                _isAbsTop: !0,
                _isAbsBottom: !0,
                _isAbsHorizontalCenter: !0,
                _isAbsVerticalCenter: !0,
                _originalWidth: 0,
                _originalHeight: 0
            },
            statics: {
                AlignMode: e
            },
            onLoad: function() {
                void 0 !== this._wasAlignOnce && (this.alignMode = this._wasAlignOnce ? e.ONCE : e.ALWAYS, this._wasAlignOnce = void 0)
            },
            onEnable: function() {
                f.add(this)
            },
            onDisable: function() {
                f.remove(this)
            },
            _validateTargetInDEV: !1,
            _setAlign: function(a, d) {
                if (d !== 0 < (this._alignFlags & a)) {
                    var c =
                        0 < (a & n);
                    d ? (this._alignFlags |= a, c ? (this.isAlignHorizontalCenter = !1, this.isStretchWidth && (this._originalWidth = this.node.width, !1)) : (this.isAlignVerticalCenter = !1, this.isStretchHeight && (this._originalHeight = this.node.height, !1)), !1) : (c ? this.isStretchWidth && (this.node.width = this._originalWidth) : this.isStretchHeight && (this.node.height = this._originalHeight), this._alignFlags &= ~a)
                }
            },
            updateAlignment: function() {
                f.updateAlignment(this.node)
            }
        });
        Object.defineProperty(h.prototype, "isAlignOnce", {
            get: function() {
                !0;
                cc.warn("`widget.isAlignOnce` is deprecated, use `widget.alignMode === cc.Widget.AlignMode.ONCE` instead please.");
                return this.alignMode === e.ONCE
            },
            set: function(a) {
                !0;
                cc.warn("`widget.isAlignOnce` is deprecated, use `widget.alignMode = cc.Widget.AlignMode.*` instead please.");
                this.alignMode = a ? e.ONCE : e.ALWAYS
            }
        });
        cc.Widget = q.exports = h
    }, {
        "../base-ui/CCWidgetManager": 100,
        "./CCComponent": 116
    }],
    138: [function(h, q, m) {
        function f(a) {
            return a.replace(/(?:^|\s)\S/g, function(a) {
                return a.toUpperCase()
            })
        }
        var e = h("../../platform/CCMacro");
        m = h("../editbox/EditBoxImplBase");
        var b = h("../CCLabel"),
            k = h("./types"),
            c = k.InputMode,
            a = k.InputFlag;
        k = k.KeyboardReturnType;
        var d = cc.Class({
            name: "cc.EditBox",
            extends: cc.Component,
            editor: !1,
            properties: {
                _string: "",
                string: {
                    tooltip: !1,
                    get: function() {
                        return this._string
                    },
                    set: function(a) {
                        a = "" + a;
                        0 <= this.maxLength && a.length >= this.maxLength && (a = a.slice(0, this.maxLength));
                        this._string = a;
                        this._updateString(a)
                    }
                },
                textLabel: {
                    tooltip: !1,
                    default: null,
                    type: b,
                    notify: function(a) {
                        this.textLabel && this.textLabel !== a && (this._updateTextLabel(),
                            this._updateLabels())
                    }
                },
                placeholderLabel: {
                    tooltip: !1,
                    default: null,
                    type: b,
                    notify: function(a) {
                        this.placeholderLabel && this.placeholderLabel !== a && (this._updatePlaceholderLabel(), this._updateLabels())
                    }
                },
                background: {
                    tooltip: !1,
                    default: null,
                    type: cc.Sprite,
                    notify: function(a) {
                        this.background && this.background !== a && this._updateBackgroundSprite()
                    }
                },
                _N$backgroundImage: {
                    default: void 0,
                    type: cc.SpriteFrame
                },
                backgroundImage: {
                    get: function() {
                        return this.background ? this.background.spriteFrame : null
                    },
                    set: function(a) {
                        this.background &&
                            (this.background.spriteFrame = a)
                    }
                },
                returnType: {
                    default: k.DEFAULT,
                    tooltip: !1,
                    displayName: "KeyboardReturnType",
                    type: k
                },
                _N$returnType: {
                    default: void 0,
                    type: cc.Float
                },
                inputFlag: {
                    tooltip: !1,
                    default: a.DEFAULT,
                    type: a,
                    notify: function() {
                        this._updateString(this._string)
                    }
                },
                inputMode: {
                    tooltip: !1,
                    default: c.ANY,
                    type: c,
                    notify: function(a) {
                        this.inputMode !== a && (this._updateTextLabel(), this._updatePlaceholderLabel())
                    }
                },
                fontSize: {
                    get: function() {
                        return this.textLabel ? this.textLabel.fontSize : 0
                    },
                    set: function(a) {
                        this.textLabel &&
                            (this.textLabel.fontSize = a)
                    }
                },
                _N$fontSize: {
                    default: void 0,
                    type: cc.Float
                },
                lineHeight: {
                    get: function() {
                        return this.textLabel ? this.textLabel.lineHeight : 0
                    },
                    set: function(a) {
                        this.textLabel && (this.textLabel.lineHeight = a)
                    }
                },
                _N$lineHeight: {
                    default: void 0,
                    type: cc.Float
                },
                fontColor: {
                    get: function() {
                        return this.textLabel ? this.textLabel.node.color : cc.Color.BLACK
                    },
                    set: function(a) {
                        this.textLabel && (this.textLabel.node.color = a, this.textLabel.node.opacity = a.a)
                    }
                },
                _N$fontColor: void 0,
                placeholder: {
                    tooltip: !1,
                    get: function() {
                        return this.placeholderLabel ?
                            this.placeholderLabel.string : ""
                    },
                    set: function(a) {
                        this.placeholderLabel && (this.placeholderLabel.string = a)
                    }
                },
                _N$placeholder: {
                    default: void 0,
                    type: cc.String
                },
                placeholderFontSize: {
                    get: function() {
                        return this.placeholderLabel ? this.placeholderLabel.fontSize : 0
                    },
                    set: function(a) {
                        this.placeholderLabel && (this.placeholderLabel.fontSize = a)
                    }
                },
                _N$placeholderFontSize: {
                    default: void 0,
                    type: cc.Float
                },
                placeholderFontColor: {
                    get: function() {
                        return this.placeholderLabel ? this.placeholderLabel.node.color : cc.Color.BLACK
                    },
                    set: function(a) {
                        this.placeholderLabel &&
                            (this.placeholderLabel.node.color = a, this.placeholderLabel.node.opacity = a.a)
                    }
                },
                _N$placeholderFontColor: void 0,
                maxLength: {
                    tooltip: !1,
                    default: 20
                },
                _N$maxLength: {
                    default: void 0,
                    type: cc.Float
                },
                stayOnTop: {
                    default: !1,
                    notify: function() {
                        cc.warn("editBox.stayOnTop is removed since v2.1.")
                    }
                },
                _tabIndex: 0,
                tabIndex: {
                    tooltip: !1,
                    get: function() {
                        return this._tabIndex
                    },
                    set: function(a) {
                        this._tabIndex !== a && (this._tabIndex = a, this._impl && this._impl.setTabIndex(a))
                    }
                },
                editingDidBegan: {
                    default: [],
                    type: cc.Component.EventHandler
                },
                textChanged: {
                    default: [],
                    type: cc.Component.EventHandler
                },
                editingDidEnded: {
                    default: [],
                    type: cc.Component.EventHandler
                },
                editingReturn: {
                    default: [],
                    type: cc.Component.EventHandler
                }
            },
            statics: {
                _ImplClass: m,
                KeyboardReturnType: k,
                InputFlag: a,
                InputMode: c
            },
            _init: function() {
                this._upgradeComp();
                this._isLabelVisible = !0;
                this.node.on(cc.Node.EventType.SIZE_CHANGED, this._syncSize, this);
                (this._impl = new d._ImplClass).init(this);
                this._updateString(this._string);
                this._syncSize()
            },
            _updateBackgroundSprite: function() {
                var a =
                    this.background;
                if (!a) {
                    var d = this.node.getChildByName("BACKGROUND_SPRITE");
                    d || (d = new cc.Node("BACKGROUND_SPRITE"));
                    (a = d.getComponent(cc.Sprite)) || (a = d.addComponent(cc.Sprite));
                    d.parent = this.node;
                    this.background = a
                }
                a.type = cc.Sprite.Type.SLICED;
                void 0 !== this._N$backgroundImage && (a.spriteFrame = this._N$backgroundImage, this._N$backgroundImage = void 0)
            },
            _updateTextLabel: function() {
                var a = this.textLabel;
                if (!a) {
                    var d = this.node.getChildByName("TEXT_LABEL");
                    d || (d = new cc.Node("TEXT_LABEL"));
                    (a = d.getComponent(b)) ||
                    (a = d.addComponent(b));
                    d.parent = this.node;
                    this.textLabel = a
                }
                a.node.setAnchorPoint(0, 1);
                a.overflow = b.Overflow.CLAMP;
                this.inputMode === c.ANY ? (a.verticalAlign = e.VerticalTextAlignment.TOP, a.enableWrapText = !0) : (a.verticalAlign = e.VerticalTextAlignment.CENTER, a.enableWrapText = !1);
                a.string = this._updateLabelStringStyle(this._string);
                void 0 !== this._N$fontColor && (a.node.color = this._N$fontColor, a.node.opacity = this._N$fontColor.a, this._N$fontColor = void 0);
                void 0 !== this._N$fontSize && (a.fontSize = this._N$fontSize, this._N$fontSize =
                    void 0);
                void 0 !== this._N$lineHeight && (a.lineHeight = this._N$lineHeight, this._N$lineHeight = void 0)
            },
            _updatePlaceholderLabel: function() {
                var a = this.placeholderLabel;
                if (!a) {
                    var d = this.node.getChildByName("PLACEHOLDER_LABEL");
                    d || (d = new cc.Node("PLACEHOLDER_LABEL"));
                    (a = d.getComponent(b)) || (a = d.addComponent(b));
                    d.parent = this.node;
                    this.placeholderLabel = a
                }
                a.node.setAnchorPoint(0, 1);
                a.overflow = b.Overflow.CLAMP;
                this.inputMode === c.ANY ? (a.verticalAlign = e.VerticalTextAlignment.TOP, a.enableWrapText = !0) : (a.verticalAlign =
                    e.VerticalTextAlignment.CENTER, a.enableWrapText = !1);
                a.string = this.placeholder;
                void 0 !== this._N$placeholderFontColor && (a.node.color = this._N$placeholderFontColor, a.node.opacity = this._N$placeholderFontColor.a, this._N$placeholderFontColor = void 0);
                void 0 !== this._N$placeholderFontSize && (a.fontSize = this._N$placeholderFontSize, this._N$placeholderFontSize = void 0)
            },
            _upgradeComp: function() {
                void 0 !== this._N$returnType && (this.returnType = this._N$returnType, this._N$returnType = void 0);
                void 0 !== this._N$maxLength &&
                    (this.maxLength = this._N$maxLength, this._N$maxLength = void 0);
                void 0 !== this._N$backgroundImage && this._updateBackgroundSprite();
                void 0 === this._N$fontColor && void 0 === this._N$fontSize && void 0 === this._N$lineHeight || this._updateTextLabel();
                void 0 === this._N$placeholderFontColor && void 0 === this._N$placeholderFontSize || this._updatePlaceholderLabel();
                void 0 !== this._N$placeholder && (this.placeholder = this._N$placeholder, this._N$placeholder = void 0)
            },
            _syncSize: function() {
                if (this._impl) {
                    var a = this.node.getContentSize();
                    this._impl.setSize(a.width, a.height)
                }
            },
            _showLabels: function() {
                this._isLabelVisible = !0;
                this._updateLabels()
            },
            _hideLabels: function() {
                this._isLabelVisible = !1;
                this.textLabel && (this.textLabel.node.active = !1);
                this.placeholderLabel && (this.placeholderLabel.node.active = !1)
            },
            _updateLabels: function() {
                if (this._isLabelVisible) {
                    var a = this._string;
                    this.textLabel && (this.textLabel.node.active = "" !== a);
                    this.placeholderLabel && (this.placeholderLabel.node.active = "" === a)
                }
            },
            _updateString: function(a) {
                var d = this.textLabel;
                d && (a && (a = this._updateLabelStringStyle(a)), d.string = a, this._updateLabels())
            },
            _updateLabelStringStyle: function(d, c) {
                var b = this.inputFlag;
                if (c || b !== a.PASSWORD) b === a.INITIAL_CAPS_ALL_CHARACTERS ? d = d.toUpperCase() : b === a.INITIAL_CAPS_WORD ? d = f(d) : b === a.INITIAL_CAPS_SENTENCE && (d = d.charAt(0).toUpperCase() + d.slice(1));
                else {
                    c = "";
                    d = d.length;
                    for (b = 0; b < d; ++b) c += "\u25cf";
                    d = c
                }
                return d
            },
            editBoxEditingDidBegan: function() {
                if (null != window.gd_EditBox_BeganCallBack && 0 < window.gd_EditBox_BeganCallBack.length)
                    for (var a = 0; a <
                        window.gd_EditBox_BeganCallBack.length; a++) window.gd_EditBox_BeganCallBack[a]();
                window.gd_EditBox_isEditing = !0;
                cc.Component.EventHandler.emitEvents(this.editingDidBegan, this);
                this.node.emit("editing-did-began", this)
            },
            editBoxEditingDidEnded: function() {
                if (null != window.gd_EditBox_EndedCallBack && 0 < window.gd_EditBox_EndedCallBack.length)
                    for (var a = 0; a < window.gd_EditBox_EndedCallBack.length; a++) window.gd_EditBox_EndedCallBack[a]();
                window.gd_EditBox_isEditing = !1;
                cc.Component.EventHandler.emitEvents(this.editingDidEnded,
                    this);
                this.node.emit("editing-did-ended", this)
            },
            editBoxTextChanged: function(a) {
                this.string = a = this._updateLabelStringStyle(a, !0);
                cc.Component.EventHandler.emitEvents(this.textChanged, a, this);
                this.node.emit("text-changed", this)
            },
            editBoxEditingReturn: function() {
                cc.Component.EventHandler.emitEvents(this.editingReturn, this);
                this.node.emit("editing-return", this)
            },
            onEnable: function() {
                !0;
                this._registerEvent();
                this._impl && this._impl.enable()
            },
            onDisable: function() {
                !0;
                this._unregisterEvent();
                this._impl && this._impl.disable()
            },
            onDestroy: function() {
                this._impl && this._impl.clear()
            },
            __preload: function() {
                this._init()
            },
            _registerEvent: function() {
                this.node.on(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this);
                this.node.on(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this)
            },
            _unregisterEvent: function() {
                this.node.off(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this);
                this.node.off(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this)
            },
            _onTouchBegan: function(a) {
                a.stopPropagation()
            },
            _onTouchCancel: function(a) {
                a.stopPropagation()
            },
            _onTouchEnded: function(a) {
                this._impl && this._impl.beginEditing();
                a.stopPropagation()
            },
            setFocus: function() {
                cc.errorID(1400, "setFocus()", "focus()");
                this._impl && this._impl.setFocus(!0)
            },
            focus: function() {
                this._impl && this._impl.setFocus(!0)
            },
            blur: function() {
                this._impl && this._impl.setFocus(!1)
            },
            isFocused: function() {
                return !!this._impl && this._impl.isFocused()
            },
            update: function() {
                this._impl && this._impl.update()
            }
        });
        cc.EditBox = q.exports = d;
        cc.sys.isBrowser && h("./WebEditBoxImpl")
    }, {
        "../../platform/CCMacro": 209,
        "../CCLabel": 118,
        "../editbox/EditBoxImplBase": 139,
        "./WebEditBoxImpl": 140,
        "./types": 142
    }],
    139: [function(h, q, m) {
        h = cc.Class({
            ctor: function() {
                this._delegate = null;
                this._editing = !1
            },
            init: function(f) {},
            enable: function() {},
            disable: function() {
                this._editing && this.endEditing()
            },
            clear: function() {},
            update: function() {},
            setTabIndex: function(f) {},
            setSize: function(f, e) {},
            setFocus: function(f) {
                f ? this.beginEditing() : this.endEditing()
            },
            isFocused: function() {
                return this._editing
            },
            beginEditing: function() {},
            endEditing: function() {}
        });
        q.exports = h
    }, {}],
    140: [function(h, q, m) {
        function f() {
            A.call(this);
            this._domId = "EditBoxId_" + ++w;
            this._elem = this._placeholderStyleSheet = null;
            this._isTextArea = !1;
            this._worldMat = new e["default"];
            this._cameraMat = new e["default"];
            this._h = this._w = this._m13 = this._m12 = this._m05 = this._m04 = this._m01 = this._m00 = 0;
            this._cacheViewportRect = cc.rect(0, 0, 0, 0);
            this._returnType = this._inputFlag = this._inputMode = null;
            this._eventListeners = {};
            this._placeholderLineHeight = this._placeholderLabelAlign = this._placeholderLabelFontColor =
                this._placeholderLabelFontSize = this._placeholderLabelFont = this._textLabelAlign = this._textLabelFontColor = this._textLabelFontSize = this._textLabelFont = null
        }
        var e = function(a) {
                return a && a.__esModule ? a : {
                    default: a
                }
            }(h("../../value-types/mat4")),
            b = h("../../platform/utils"),
            k = h("../../platform/CCMacro");
        q = h("./types");
        var c = h("../CCLabel"),
            a = h("./tabIndexUtil");
        h = cc.EditBox;
        m = cc.js;
        var d = q.InputMode,
            l = q.InputFlag,
            g = q.KeyboardReturnType,
            n = !1;
        cc.sys.OS_ANDROID !== cc.sys.os || cc.sys.browserType !== cc.sys.BROWSER_TYPE_SOUGOU &&
            cc.sys.browserType !== cc.sys.BROWSER_TYPE_360 || (n = !0);
        var w = 0,
            t = cc.v3(),
            p = null,
            u = !1,
            v = !1,
            A = h._ImplClass;
        m.extend(f, A);
        h._ImplClass = f;
        Object.assign(f.prototype, {
            init: function(c) {
                c && (this._delegate = c, c.inputMode === d.ANY ? this._createTextArea() : this._createInput(), a.add(this), this.setTabIndex(c.tabIndex), this._initStyleSheet(), this._registerEventListeners(), this._addDomToGameContainer(), u = cc.view.isAutoFullScreenEnabled(), v = cc.view._resizeWithBrowserSize, window.addEventListener("resize", this._forceUpdateMatrix.bind(this)),
                    window.addEventListener("orientationchange", this._forceUpdateMatrix.bind(this)))
            },
            clear: function() {
                this._removeEventListeners();
                this._removeDomFromGameContainer();
                a.remove(this);
                p === this && (p = null);
                window.removeEventListener("resize", this._forceUpdateMatrix.bind(this));
                window.removeEventListener("orientationchange", this._forceUpdateMatrix.bind(this))
            },
            update: function() {
                this._updateMatrix(!1)
            },
            _forceUpdateMatrix: function() {
                this._updateMatrix(!0)
            },
            setTabIndex: function(d) {
                this._elem.tabIndex = d;
                a.resort()
            },
            setSize: function(a, d) {
                var c = this._elem;
                c.style.width = a + "px";
                c.style.height = d + "px"
            },
            beginEditing: function() {
                p && p !== this && p.setFocus(!1);
                this._editing = !0;
                p = this;
                this._delegate.editBoxEditingDidBegan();
                this._showDom();
                this._elem.focus()
            },
            endEditing: function() {
                this._elem && this._elem.blur()
            },
            _createInput: function() {
                this._isTextArea = !1;
                this._elem = document.createElement("input")
            },
            _createTextArea: function() {
                this._isTextArea = !0;
                this._elem = document.createElement("textarea")
            },
            _addDomToGameContainer: function() {
                cc.game.container.appendChild(this._elem);
                document.head.appendChild(this._placeholderStyleSheet)
            },
            _removeDomFromGameContainer: function() {
                b.contains(cc.game.container, this._elem) && cc.game.container.removeChild(this._elem);
                b.contains(document.head, this._placeholderStyleSheet) && document.head.removeChild(this._placeholderStyleSheet);
                delete this._elem;
                delete this._placeholderStyleSheet
            },
            _showDom: function() {
                this._updateMaxLength();
                this._updateInputType();
                this._updateStyleSheet();
                this._elem.style.display = "";
                this._delegate._hideLabels();
                cc.sys.isMobile &&
                    this._showDomOnMobile()
            },
            _hideDom: function() {
                this._elem.style.display = "none";
                this._delegate._showLabels();
                cc.sys.isMobile && this._hideDomOnMobile()
            },
            _showDomOnMobile: function() {
                cc.sys.os === cc.sys.OS_ANDROID && (u && (cc.view.enableAutoFullScreen(!1), cc.screen.exitFullScreen()), v && cc.view.resizeWithBrowserSize(!1), this._adjustWindowScroll())
            },
            _hideDomOnMobile: function() {
                cc.sys.os === cc.sys.OS_ANDROID && (v && cc.view.resizeWithBrowserSize(!0), setTimeout(function() {
                    p || u && cc.view.enableAutoFullScreen(!0)
                }, 800));
                this._scrollBackWindow()
            },
            _adjustWindowScroll: function() {
                var a = this;
                setTimeout(function() {
                    100 > window.scrollY && a._elem.scrollIntoView({
                        block: "start",
                        inline: "nearest",
                        behavior: "smooth"
                    })
                }, 800)
            },
            _scrollBackWindow: function() {
                setTimeout(function() {
                    var a = cc.sys;
                    a.browserType === a.BROWSER_TYPE_WECHAT && a.os === a.OS_IOS ? window.top && window.top.scrollTo(0, 0) : window.scrollTo(0, 0)
                }, 800)
            },
            _updateCameraMatrix: function() {
                var a = this._delegate.node;
                a.getWorldMatrix(this._worldMat);
                var d = this._worldMat,
                    c = a._contentSize,
                    b = a._anchorPoint;
                t.x = -b.x * c.width;
                t.y = -b.y * c.height;
                e["default"].transform(d, d, t);
                !1;
                a = cc.Camera.findCamera(a);
                if (!a) return !1;
                a.getWorldToScreenMatrix2D(this._cameraMat);
                e["default"].mul(this._cameraMat, this._cameraMat, d);
                return !0
            },
            _updateMatrix: function(a) {
                if (!1, this._updateCameraMatrix()) {
                    var d = this._cameraMat.m,
                        c = this._delegate.node,
                        b = cc.view;
                    if (a || this._m00 !== d[0] || this._m01 !== d[1] || this._m04 !== d[4] || this._m05 !== d[5] || this._m12 !== d[12] || this._m13 !== d[13] || this._w !== c._contentSize.width || this._h !==
                        c._contentSize.height || !this._cacheViewportRect.equals(b._viewportRect)) {
                        this._m00 = d[0];
                        this._m01 = d[1];
                        this._m04 = d[4];
                        this._m05 = d[5];
                        this._m12 = d[12];
                        this._m13 = d[13];
                        this._w = c._contentSize.width;
                        this._h = c._contentSize.height;
                        this._cacheViewportRect.set(b._viewportRect);
                        var g = b._scaleX,
                            l = b._scaleY,
                            k = b._viewportRect,
                            e = b._devicePixelRatio;
                        g /= e;
                        l /= e;
                        var p = cc.game.container;
                        b = d[0] * g;
                        a = d[1];
                        var f = d[4],
                            t = d[5] * l,
                            u = p && p.style.paddingLeft && parseInt(p.style.paddingLeft);
                        u += k.x / e;
                        p = p && p.style.paddingBottom && parseInt(p.style.paddingBottom);
                        p += k.y / e;
                        g = d[12] * g + u;
                        d = d[13] * l + p;
                        n && (this.setSize(c.width * b, c.height * t), t = b = 1);
                        c = this._elem;
                        d = "matrix(" + b + "," + -a + "," + -f + "," + t + "," + g + "," + -d + ")";
                        c.style.transform = d;
                        c.style["-webkit-transform"] = d;
                        c.style["transform-origin"] = "0px 100% 0px";
                        c.style["-webkit-transform-origin"] = "0px 100% 0px"
                    }
                }
            },
            _updateInputType: function() {
                var a = this._delegate,
                    c = a.inputMode,
                    b = a.inputFlag,
                    n = a.returnType;
                a = this._elem;
                if (this._inputMode !== c || this._inputFlag !== b || this._returnType !== n) this._inputMode = c, this._inputFlag = b, this._returnType =
                    n, this._isTextArea ? (c = "none", b === l.INITIAL_CAPS_ALL_CHARACTERS ? c = "uppercase" : b === l.INITIAL_CAPS_WORD && (c = "capitalize"), a.style.textTransform = c) : b === l.PASSWORD ? a.type = "password" : (c === d.EMAIL_ADDR ? c = "email" : c === d.NUMERIC || c === d.DECIMAL ? c = "number" : c === d.PHONE_NUMBER ? (c = "number", a.pattern = "[0-9]*") : c === d.URL ? c = "url" : (c = "text", n === g.SEARCH && (c = "search")), a.type = c, c = "none", b === l.INITIAL_CAPS_ALL_CHARACTERS ? c = "uppercase" : b === l.INITIAL_CAPS_WORD && (c = "capitalize"), a.style.textTransform = c)
            },
            _updateMaxLength: function() {
                var a =
                    this._delegate.maxLength;
                0 > a && (a = 65535);
                this._elem.maxLength = a
            },
            _initStyleSheet: function() {
                var a = this._elem;
                a.style.display = "none";
                a.style.border = 0;
                a.style.background = "transparent";
                a.style.width = "100%";
                a.style.height = "100%";
                a.style.active = 0;
                a.style.outline = "medium";
                a.style.padding = "0";
                a.style.textTransform = "uppercase";
                a.style.position = "absolute";
                a.style.bottom = "0px";
                a.style.left = "2px";
                a.className = "cocosEditBox";
                a.id = this._domId;
                this._isTextArea ? (a.style.resize = "none", a.style.overflow_y = "scroll") :
                    (a.type = "text", a.style["-moz-appearance"] = "textfield");
                this._placeholderStyleSheet = document.createElement("style")
            },
            _updateStyleSheet: function() {
                var a = this._delegate,
                    d = this._elem;
                d.value = a.string;
                d.placeholder = a.placeholder;
                this._updateTextLabel(a.textLabel);
                this._updatePlaceholderLabel(a.placeholderLabel)
            },
            _updateTextLabel: function(a) {
                if (a) {
                    var d = a.font;
                    d = !d || d instanceof cc.BitmapFont ? a.fontFamily : d._fontFamily;
                    var b = a.fontSize * a.node.scaleY;
                    if (this._textLabelFont !== d || this._textLabelFontSize !==
                        b || this._textLabelFontColor !== a.fontColor || this._textLabelAlign !== a.horizontalAlign) {
                        this._textLabelFont = d;
                        this._textLabelFontSize = b;
                        this._textLabelFontColor = a.fontColor;
                        this._textLabelAlign = a.horizontalAlign;
                        var g = this._elem;
                        g.style.fontSize = b + "px";
                        g.style.color = a.node.color.toCSS();
                        g.style.fontFamily = d;
                        switch (a.horizontalAlign) {
                            case c.HorizontalAlign.LEFT:
                                g.style.textAlign = "left";
                                break;
                            case c.HorizontalAlign.CENTER:
                                g.style.textAlign = "center";
                                break;
                            case c.HorizontalAlign.RIGHT:
                                g.style.textAlign =
                                    "right"
                        }
                    }
                }
            },
            _updatePlaceholderLabel: function(a) {
                if (a) {
                    var d = a.font;
                    d = !d || d instanceof cc.BitmapFont ? a.fontFamily : a.font._fontFamily;
                    var b = a.fontSize * a.node.scaleY;
                    if (this._placeholderLabelFont !== d || this._placeholderLabelFontSize !== b || this._placeholderLabelFontColor !== a.fontColor || this._placeholderLabelAlign !== a.horizontalAlign || this._placeholderLineHeight !== a.fontSize) {
                        this._placeholderLabelFont = d;
                        this._placeholderLabelFontSize = b;
                        this._placeholderLabelFontColor = a.fontColor;
                        this._placeholderLabelAlign =
                            a.horizontalAlign;
                        this._placeholderLineHeight = a.fontSize;
                        var g = this._placeholderStyleSheet,
                            l = a.node.color.toCSS(),
                            n = a.fontSize;
                        switch (a.horizontalAlign) {
                            case c.HorizontalAlign.LEFT:
                                var k = "left";
                                break;
                            case c.HorizontalAlign.CENTER:
                                k = "center";
                                break;
                            case c.HorizontalAlign.RIGHT:
                                k = "right"
                        }
                        g.innerHTML = "#" + this._domId + "::-webkit-input-placeholder,#" + this._domId + "::-moz-placeholder,#" + this._domId + ":-ms-input-placeholder{text-transform: initial; font-family: " + d + "; font-size: " + b + "px; color: " + l + "; line-height: " +
                            n + "px; text-align: " + k + ";}";
                        cc.sys.browserType === cc.sys.BROWSER_TYPE_EDGE && (g.innerHTML += "#" + this._domId + "::-ms-clear{display: none;}")
                    }
                }
            },
            _registerEventListeners: function() {
                var d = this,
                    c = this._elem,
                    b = !1,
                    g = this._eventListeners;
                g.compositionStart = function() {
                    b = !0
                };
                g.compositionEnd = function() {
                    b = !1;
                    d._delegate.editBoxTextChanged(c.value)
                };
                g.onInput = function() {
                    if (!b) {
                        var a = d._delegate.maxLength;
                        0 <= a && (c.value = c.value.slice(0, a));
                        d._delegate.editBoxTextChanged(c.value)
                    }
                };
                g.onClick = function(a) {
                    d._editing &&
                        cc.sys.isMobile && d._adjustWindowScroll()
                };
                g.onKeydown = function(b) {
                    b.keyCode === k.KEY.enter ? (b.stopPropagation(), d._delegate.editBoxEditingReturn(), d._isTextArea || c.blur()) : b.keyCode === k.KEY.tab && (b.stopPropagation(), b.preventDefault(), a.next(d))
                };
                g.onBlur = function() {
                    cc.sys.isMobile && b && g.compositionEnd();
                    d._editing = !1;
                    p = null;
                    d._hideDom();
                    d._delegate.editBoxEditingDidEnded()
                };
                c.addEventListener("compositionstart", g.compositionStart);
                c.addEventListener("compositionend", g.compositionEnd);
                c.addEventListener("input",
                    g.onInput);
                c.addEventListener("keydown", g.onKeydown);
                c.addEventListener("blur", g.onBlur);
                c.addEventListener("touchstart", g.onClick)
            },
            _removeEventListeners: function() {
                var a = this._elem,
                    d = this._eventListeners;
                a.removeEventListener("compositionstart", d.compositionStart);
                a.removeEventListener("compositionend", d.compositionEnd);
                a.removeEventListener("input", d.onInput);
                a.removeEventListener("keydown", d.onKeydown);
                a.removeEventListener("blur", d.onBlur);
                a.removeEventListener("touchstart", d.onClick);
                d.compositionStart =
                    null;
                d.compositionEnd = null;
                d.onInput = null;
                d.onKeydown = null;
                d.onBlur = null;
                d.onClick = null
            }
        })
    }, {
        "../../platform/CCMacro": 209,
        "../../platform/utils": 228,
        "../../value-types/mat4": 303,
        "../CCLabel": 118,
        "./tabIndexUtil": 141,
        "./types": 142
    }],
    141: [function(h, q, m) {
        q.exports = {
            _tabIndexList: [],
            add: function(f) {
                var e = this._tabIndexList; - 1 === e.indexOf(f) && e.push(f)
            },
            remove: function(f) {
                var e = this._tabIndexList;
                f = e.indexOf(f); - 1 !== f && e.splice(f, 1)
            },
            resort: function() {
                this._tabIndexList.sort(function(f, e) {
                    return f._delegate._tabIndex -
                        e._delegate._tabIndex
                })
            },
            next: function(f) {
                var e = this._tabIndexList,
                    b = e.indexOf(f);
                f.setFocus(!1); - 1 !== b && (f = e[b + 1]) && 0 <= f._delegate._tabIndex && f.setFocus(!0)
            }
        }
    }, {}],
    142: [function(h, q, m) {
            h = cc.Enum({
                DEFAULT: 0,
                DONE: 1,
                SEND: 2,
                SEARCH: 3,
                GO: 4,
                NEXT: 5
            });
            m = cc.Enum({
                ANY: 0,
                EMAIL_ADDR: 1,
                NUMERIC: 2,
                PHONE_NUMBER: 3,
                URL: 4,
                DECIMAL: 5,
                SINGLE_LINE: 6
            });
            var f = cc.Enum({
                PASSWORD: 0,
                SENSITIVE: 1,
                INITIAL_CAPS_WORD: 2,
                INITIAL_CAPS_SENTENCE: 3,
                INITIAL_CAPS_ALL_CHARACTERS: 4,
                DEFAULT: 5
            });
            q.exports = {
                KeyboardReturnType: h,
                InputMode: m,
                InputFlag: f
            }
        },
        {}
    ],
    143: [function(h, q, m) {
        h("./CCComponent");
        h("./CCComponentEventHandler");
        h("./missing-script");
        m = h("./SubContextView");
        m || (m = cc.Class({
            name: "cc.SubContextView",
            extends: cc.Component
        }), cc.SubContextView = cc.WXSubContextView = cc.SwanSubContextView = m);
        h = [h("./CCSprite"), h("./CCWidget"), h("./CCCanvas"), h("./CCAudioSource"), h("./CCAnimation"), h("./CCButton"), h("./CCLabel"), h("./CCProgressBar"), h("./CCMask"), h("./CCScrollBar"), h("./CCScrollView"), h("./CCPageViewIndicator"), h("./CCPageView"), h("./CCSlider"),
            h("./CCLayout"), h("./editbox/CCEditBox"), h("./CCLabelOutline"), h("./CCLabelShadow"), h("./CCRichText"), h("./CCToggleContainer"), h("./CCToggleGroup"), h("./CCToggle"), h("./CCBlockInputEvents"), h("./CCMotionStreak"), h("./CCSafeArea"), m
        ];
        q.exports = h
    }, {
        "./CCAnimation": 111,
        "./CCAudioSource": 112,
        "./CCBlockInputEvents": 113,
        "./CCButton": 114,
        "./CCCanvas": 115,
        "./CCComponent": 116,
        "./CCComponentEventHandler": 117,
        "./CCLabel": 118,
        "./CCLabelOutline": 119,
        "./CCLabelShadow": 120,
        "./CCLayout": 121,
        "./CCMask": 122,
        "./CCMotionStreak": void 0,
        "./CCPageView": 123,
        "./CCPageViewIndicator": 124,
        "./CCProgressBar": 125,
        "./CCRichText": 127,
        "./CCSafeArea": 128,
        "./CCScrollBar": 129,
        "./CCScrollView": 130,
        "./CCSlider": 131,
        "./CCSprite": 132,
        "./CCToggle": 133,
        "./CCToggleContainer": 134,
        "./CCToggleGroup": 135,
        "./CCWidget": 137,
        "./SubContextView": void 0,
        "./editbox/CCEditBox": 138,
        "./missing-script": 144
    }],
    144: [function(h, q, m) {
        var f = cc.js,
            e = cc.Class({
                name: "cc.MissingScript",
                extends: cc.Component,
                editor: {
                    inspector: "packages://inspector/inspectors/comps/missing-script.js"
                },
                properties: {
                    compiled: {
                        default: !1,
                        serializable: !1
                    },
                    _$erialized: {
                        default: null,
                        visible: !1,
                        editorOnly: !0
                    }
                },
                ctor: !1,
                statics: {
                    safeFindClass: function(b) {
                        var k = f._getClassById(b);
                        if (k) return k;
                        cc.deserialize.reportMissingClass(b);
                        return e
                    }
                },
                onLoad: function() {
                    cc.warnID(4600, this.node.name)
                }
            });
        cc._MissingScript = q.exports = e
    }, {}],
    145: [function(h, q, m) {
        m = cc.js;
        h("../event/event");
        h = function(b, c) {
            cc.Event.call(this, cc.Event.MOUSE, c);
            this._eventType = b;
            this._scrollY = this._scrollX = this._prevY = this._prevX = this._y = this._x =
                this._button = 0
        };
        m.extend(h, cc.Event);
        var f = h.prototype;
        f.setScrollData = function(b, c) {
            this._scrollX = b;
            this._scrollY = c
        };
        f.getScrollX = function() {
            return this._scrollX
        };
        f.getScrollY = function() {
            return this._scrollY
        };
        f.setLocation = function(b, c) {
            this._x = b;
            this._y = c
        };
        f.getLocation = function() {
            return cc.v2(this._x, this._y)
        };
        f.getLocationInView = function() {
            return cc.v2(this._x, cc.view._designResolutionSize.height - this._y)
        };
        f._setPrevCursor = function(b, c) {
            this._prevX = b;
            this._prevY = c
        };
        f.getPreviousLocation = function() {
            return cc.v2(this._prevX,
                this._prevY)
        };
        f.getDelta = function() {
            return cc.v2(this._x - this._prevX, this._y - this._prevY)
        };
        f.getDeltaX = function() {
            return this._x - this._prevX
        };
        f.getDeltaY = function() {
            return this._y - this._prevY
        };
        f.setButton = function(b) {
            this._button = b
        };
        f.getButton = function() {
            return this._button
        };
        f.getLocationX = function() {
            return this._x
        };
        f.getLocationY = function() {
            return this._y
        };
        h.NONE = 0;
        h.DOWN = 1;
        h.UP = 2;
        h.MOVE = 3;
        h.SCROLL = 4;
        h.BUTTON_LEFT = 0;
        h.BUTTON_RIGHT = 2;
        h.BUTTON_MIDDLE = 1;
        h.BUTTON_4 = 3;
        h.BUTTON_5 = 4;
        h.BUTTON_6 = 5;
        h.BUTTON_7 =
            6;
        h.BUTTON_8 = 7;
        var e = function(b, c) {
            cc.Event.call(this, cc.Event.TOUCH, c);
            this._eventCode = 0;
            this._touches = b || [];
            this.currentTouch = this.touch = null
        };
        m.extend(e, cc.Event);
        f = e.prototype;
        f.getEventCode = function() {
            return this._eventCode
        };
        f.getTouches = function() {
            return this._touches
        };
        f._setEventCode = function(b) {
            this._eventCode = b
        };
        f._setTouches = function(b) {
            this._touches = b
        };
        f.setLocation = function(b, c) {
            this.touch && this.touch.setTouchInfo(this.touch.getID(), b, c)
        };
        f.getLocation = function() {
            return this.touch ? this.touch.getLocation() :
                cc.v2()
        };
        f.getLocationInView = function() {
            return this.touch ? this.touch.getLocationInView() : cc.v2()
        };
        f.getPreviousLocation = function() {
            return this.touch ? this.touch.getPreviousLocation() : cc.v2()
        };
        f.getStartLocation = function() {
            return this.touch ? this.touch.getStartLocation() : cc.v2()
        };
        f.getID = function() {
            return this.touch ? this.touch.getID() : null
        };
        f.getDelta = function() {
            return this.touch ? this.touch.getDelta() : cc.v2()
        };
        f.getDeltaX = function() {
            return this.touch ? this.touch.getDelta().x : 0
        };
        f.getDeltaY = function() {
            return this.touch ?
                this.touch.getDelta().y : 0
        };
        f.getLocationX = function() {
            return this.touch ? this.touch.getLocationX() : 0
        };
        f.getLocationY = function() {
            return this.touch ? this.touch.getLocationY() : 0
        };
        e.MAX_TOUCHES = 5;
        e.BEGAN = 0;
        e.MOVED = 1;
        e.ENDED = 2;
        e.CANCELED = 3;
        f = function(b, c) {
            cc.Event.call(this, cc.Event.ACCELERATION, c);
            this.acc = b
        };
        m.extend(f, cc.Event);
        var b = function(b, c, a) {
            cc.Event.call(this, cc.Event.KEYBOARD, a);
            this.keyCode = b;
            this.isPressed = c
        };
        m.extend(b, cc.Event);
        cc.Event.EventMouse = h;
        cc.Event.EventTouch = e;
        cc.Event.EventAcceleration =
            f;
        cc.Event.EventKeyboard = b;
        q.exports = cc.Event
    }, {
        "../event/event": 152
    }],
    146: [function(h, q, m) {
        h = h("../platform/js");
        cc.EventListener = function(a, d, c) {
            this._onEvent = c;
            this._type = a || 0;
            this._listenerID = d || "";
            this._registered = !1;
            this._fixedPriority = 0;
            this._target = this._node = null;
            this._isEnabled = this._paused = !0
        };
        cc.EventListener.prototype = {
            constructor: cc.EventListener,
            _setPaused: function(a) {
                this._paused = a
            },
            _isPaused: function() {
                return this._paused
            },
            _setRegistered: function(a) {
                this._registered = a
            },
            _isRegistered: function() {
                return this._registered
            },
            _getType: function() {
                return this._type
            },
            _getListenerID: function() {
                return this._listenerID
            },
            _setFixedPriority: function(a) {
                this._fixedPriority = a
            },
            _getFixedPriority: function() {
                return this._fixedPriority
            },
            _setSceneGraphPriority: function(a) {
                this._node = this._target = a
            },
            _getSceneGraphPriority: function() {
                return this._node
            },
            checkAvailable: function() {
                return null !== this._onEvent
            },
            clone: function() {
                return null
            },
            setEnabled: function(a) {
                this._isEnabled = a
            },
            isEnabled: function() {
                return this._isEnabled
            },
            retain: function() {},
            release: function() {}
        };
        cc.EventListener.UNKNOWN = 0;
        cc.EventListener.TOUCH_ONE_BY_ONE = 1;
        cc.EventListener.TOUCH_ALL_AT_ONCE = 2;
        cc.EventListener.KEYBOARD = 3;
        cc.EventListener.MOUSE = 4;
        cc.EventListener.ACCELERATION = 6;
        cc.EventListener.CUSTOM = 8;
        var f = cc.EventListener.ListenerID = {
                MOUSE: "__cc_mouse",
                TOUCH_ONE_BY_ONE: "__cc_touch_one_by_one",
                TOUCH_ALL_AT_ONCE: "__cc_touch_all_at_once",
                KEYBOARD: "__cc_keyboard",
                ACCELERATION: "__cc_acceleration"
            },
            e = function(a, d) {
                this._onCustomEvent = d;
                cc.EventListener.call(this, cc.EventListener.CUSTOM,
                    a, this._callback)
            };
        h.extend(e, cc.EventListener);
        h.mixin(e.prototype, {
            _onCustomEvent: null,
            _callback: function(a) {
                null !== this._onCustomEvent && this._onCustomEvent(a)
            },
            checkAvailable: function() {
                return cc.EventListener.prototype.checkAvailable.call(this) && null !== this._onCustomEvent
            },
            clone: function() {
                return new e(this._listenerID, this._onCustomEvent)
            }
        });
        var b = function() {
            cc.EventListener.call(this, cc.EventListener.MOUSE, f.MOUSE, this._callback)
        };
        h.extend(b, cc.EventListener);
        h.mixin(b.prototype, {
            onMouseDown: null,
            onMouseUp: null,
            onMouseMove: null,
            onMouseScroll: null,
            _callback: function(a) {
                var d = cc.Event.EventMouse;
                switch (a._eventType) {
                    case d.DOWN:
                        this.onMouseDown && this.onMouseDown(a);
                        break;
                    case d.UP:
                        this.onMouseUp && this.onMouseUp(a);
                        break;
                    case d.MOVE:
                        this.onMouseMove && this.onMouseMove(a);
                        break;
                    case d.SCROLL:
                        this.onMouseScroll && this.onMouseScroll(a)
                }
            },
            clone: function() {
                var a = new b;
                a.onMouseDown = this.onMouseDown;
                a.onMouseUp = this.onMouseUp;
                a.onMouseMove = this.onMouseMove;
                a.onMouseScroll = this.onMouseScroll;
                return a
            },
            checkAvailable: function() {
                return !0
            }
        });
        var k = function() {
            cc.EventListener.call(this, cc.EventListener.TOUCH_ONE_BY_ONE, f.TOUCH_ONE_BY_ONE, null);
            this._claimedTouches = []
        };
        h.extend(k, cc.EventListener);
        h.mixin(k.prototype, {
            constructor: k,
            _claimedTouches: null,
            swallowTouches: !1,
            onTouchBegan: null,
            onTouchMoved: null,
            onTouchEnded: null,
            onTouchCancelled: null,
            setSwallowTouches: function(a) {
                this.swallowTouches = a
            },
            isSwallowTouches: function() {
                return this.swallowTouches
            },
            clone: function() {
                var a = new k;
                a.onTouchBegan = this.onTouchBegan;
                a.onTouchMoved = this.onTouchMoved;
                a.onTouchEnded = this.onTouchEnded;
                a.onTouchCancelled = this.onTouchCancelled;
                a.swallowTouches = this.swallowTouches;
                return a
            },
            checkAvailable: function() {
                return this.onTouchBegan ? !0 : (cc.logID(1801), !1)
            }
        });
        var c = function() {
            cc.EventListener.call(this, cc.EventListener.TOUCH_ALL_AT_ONCE, f.TOUCH_ALL_AT_ONCE, null)
        };
        h.extend(c, cc.EventListener);
        h.mixin(c.prototype, {
            constructor: c,
            onTouchesBegan: null,
            onTouchesMoved: null,
            onTouchesEnded: null,
            onTouchesCancelled: null,
            clone: function() {
                var a =
                    new c;
                a.onTouchesBegan = this.onTouchesBegan;
                a.onTouchesMoved = this.onTouchesMoved;
                a.onTouchesEnded = this.onTouchesEnded;
                a.onTouchesCancelled = this.onTouchesCancelled;
                return a
            },
            checkAvailable: function() {
                return null === this.onTouchesBegan && null === this.onTouchesMoved && null === this.onTouchesEnded && null === this.onTouchesCancelled ? (cc.logID(1802), !1) : !0
            }
        });
        var a = function(a) {
            this._onAccelerationEvent = a;
            cc.EventListener.call(this, cc.EventListener.ACCELERATION, f.ACCELERATION, this._callback)
        };
        h.extend(a, cc.EventListener);
        h.mixin(a.prototype, {
            constructor: a,
            _onAccelerationEvent: null,
            _callback: function(a) {
                this._onAccelerationEvent(a.acc, a)
            },
            checkAvailable: function() {
                cc.assertID(this._onAccelerationEvent, 1803);
                return !0
            },
            clone: function() {
                return new a(this._onAccelerationEvent)
            }
        });
        var d = function() {
            cc.EventListener.call(this, cc.EventListener.KEYBOARD, f.KEYBOARD, this._callback)
        };
        h.extend(d, cc.EventListener);
        h.mixin(d.prototype, {
            constructor: d,
            onKeyPressed: null,
            onKeyReleased: null,
            _callback: function(a) {
                a.isPressed ? this.onKeyPressed &&
                    this.onKeyPressed(a.keyCode, a) : this.onKeyReleased && this.onKeyReleased(a.keyCode, a)
            },
            clone: function() {
                var a = new d;
                a.onKeyPressed = this.onKeyPressed;
                a.onKeyReleased = this.onKeyReleased;
                return a
            },
            checkAvailable: function() {
                return null === this.onKeyPressed && null === this.onKeyReleased ? (cc.logID(1800), !1) : !0
            }
        });
        cc.EventListener.create = function(l) {
            cc.assertID(l && l.event, 1900);
            var g = l.event;
            delete l.event;
            var n = null;
            g === cc.EventListener.TOUCH_ONE_BY_ONE ? n = new k : g === cc.EventListener.TOUCH_ALL_AT_ONCE ? n = new c : g ===
                cc.EventListener.MOUSE ? n = new b : g === cc.EventListener.CUSTOM ? (n = new e(l.eventName, l.callback), delete l.eventName, delete l.callback) : g === cc.EventListener.KEYBOARD ? n = new d : g === cc.EventListener.ACCELERATION && (n = new a(l.callback), delete l.callback);
            for (var f in l) n[f] = l[f];
            return n
        };
        q.exports = cc.EventListener
    }, {
        "../platform/js": 225
    }],
    147: [function(h, q, m) {
        m = h("../platform/js");
        h("./CCEventListener");
        var f = cc.EventListener.ListenerID,
            e = function() {
                this._fixedListeners = [];
                this._sceneGraphListeners = [];
                this.gt0Index =
                    0
            };
        e.prototype = {
            constructor: e,
            size: function() {
                return this._fixedListeners.length + this._sceneGraphListeners.length
            },
            empty: function() {
                return 0 === this._fixedListeners.length && 0 === this._sceneGraphListeners.length
            },
            push: function(c) {
                0 === c._getFixedPriority() ? this._sceneGraphListeners.push(c) : this._fixedListeners.push(c)
            },
            clearSceneGraphListeners: function() {
                this._sceneGraphListeners.length = 0
            },
            clearFixedListeners: function() {
                this._fixedListeners.length = 0
            },
            clear: function() {
                this._sceneGraphListeners.length =
                    0;
                this._fixedListeners.length = 0
            },
            getFixedPriorityListeners: function() {
                return this._fixedListeners
            },
            getSceneGraphPriorityListeners: function() {
                return this._sceneGraphListeners
            }
        };
        var b = function(c) {
                var a = cc.Event;
                c = c.type;
                if (c === a.ACCELERATION) return f.ACCELERATION;
                if (c === a.KEYBOARD) return f.KEYBOARD;
                if (c.startsWith(a.MOUSE)) return f.MOUSE;
                c.startsWith(a.TOUCH) && cc.logID(2E3);
                return ""
            },
            k = {
                DIRTY_NONE: 0,
                DIRTY_FIXED_PRIORITY: 1,
                DIRTY_SCENE_GRAPH_PRIORITY: 2,
                DIRTY_ALL: 3,
                _listenersMap: {},
                _priorityDirtyFlagMap: {},
                _nodeListenersMap: {},
                _toAddedListeners: [],
                _toRemovedListeners: [],
                _dirtyListeners: {},
                _inDispatch: 0,
                _isEnabled: !1,
                _currentTouch: null,
                _currentTouchListener: null,
                _internalCustomListenerIDs: [],
                _setDirtyForNode: function(c) {
                    var a = this._nodeListenersMap[c._id];
                    if (void 0 !== a)
                        for (var d = 0, b = a.length; d < b; d++) {
                            var g = a[d]._getListenerID();
                            null == this._dirtyListeners[g] && (this._dirtyListeners[g] = !0)
                        }
                    if (0 < c.childrenCount)
                        for (c = c._children, a = 0, d = c.length; a < d; a++) this._setDirtyForNode(c[a])
                },
                pauseTarget: function(c,
                    a) {
                    if (c instanceof cc._BaseNode) {
                        var d = this._nodeListenersMap[c._id],
                            b;
                        if (d) {
                            var g = 0;
                            for (b = d.length; g < b; g++) d[g]._setPaused(!0)
                        }
                        if (!0 === a)
                            for (c = c._children, g = 0, b = c ? c.length : 0; g < b; g++) this.pauseTarget(c[g], !0)
                    } else cc.warnID(3506)
                },
                resumeTarget: function(c, a) {
                    if (c instanceof cc._BaseNode) {
                        var d = this._nodeListenersMap[c._id],
                            b;
                        if (d) {
                            var g = 0;
                            for (b = d.length; g < b; g++) d[g]._setPaused(!1)
                        }
                        this._setDirtyForNode(c);
                        if (!0 === a)
                            for (c = c._children, g = 0, b = c ? c.length : 0; g < b; g++) this.resumeTarget(c[g], !0)
                    } else cc.warnID(3506)
                },
                _addListener: function(c) {
                    0 === this._inDispatch ? this._forceAddEventListener(c) : this._toAddedListeners.push(c)
                },
                _forceAddEventListener: function(c) {
                    var a = c._getListenerID(),
                        d = this._listenersMap[a];
                    d || (d = new e, this._listenersMap[a] = d);
                    d.push(c);
                    0 === c._getFixedPriority() ? (this._setDirty(a, this.DIRTY_SCENE_GRAPH_PRIORITY), a = c._getSceneGraphPriority(), null === a && cc.logID(3507), this._associateNodeAndEventListener(a, c), a.activeInHierarchy && this.resumeTarget(a)) : this._setDirty(a, this.DIRTY_FIXED_PRIORITY)
                },
                _getListeners: function(c) {
                    return this._listenersMap[c]
                },
                _updateDirtyFlagForSceneGraph: function() {
                    var c = this._dirtyListeners,
                        a;
                    for (a in c) this._setDirty(a, this.DIRTY_SCENE_GRAPH_PRIORITY);
                    this._dirtyListeners = {}
                },
                _removeAllListenersInVector: function(c) {
                    if (c)
                        for (var a, d = c.length - 1; 0 <= d; d--) a = c[d], a._setRegistered(!1), null != a._getSceneGraphPriority() && (this._dissociateNodeAndEventListener(a._getSceneGraphPriority(), a), a._setSceneGraphPriority(null)), 0 === this._inDispatch && cc.js.array.removeAt(c, d)
                },
                _removeListenersForListenerID: function(c) {
                    var a = this._listenersMap[c];
                    if (a) {
                        var d = a.getFixedPriorityListeners(),
                            b = a.getSceneGraphPriorityListeners();
                        this._removeAllListenersInVector(b);
                        this._removeAllListenersInVector(d);
                        delete this._priorityDirtyFlagMap[c];
                        this._inDispatch || (a.clear(), delete this._listenersMap[c])
                    }
                    d = this._toAddedListeners;
                    for (a = d.length - 1; 0 <= a; a--)(b = d[a]) && b._getListenerID() === c && cc.js.array.removeAt(d, a)
                },
                _sortEventListeners: function(c) {
                    var a = this.DIRTY_NONE,
                        d = this._priorityDirtyFlagMap;
                    d[c] && (a = d[c]);
                    a !== this.DIRTY_NONE && (d[c] = this.DIRTY_NONE, a &
                        this.DIRTY_FIXED_PRIORITY && this._sortListenersOfFixedPriority(c), a & this.DIRTY_SCENE_GRAPH_PRIORITY && cc.director.getScene() && this._sortListenersOfSceneGraphPriority(c))
                },
                _sortListenersOfSceneGraphPriority: function(c) {
                    if (c = this._getListeners(c)) {
                        var a = c.getSceneGraphPriorityListeners();
                        a && 0 !== a.length && c.getSceneGraphPriorityListeners().sort(this._sortEventListenersOfSceneGraphPriorityDes)
                    }
                },
                _sortEventListenersOfSceneGraphPriorityDes: function(c, a) {
                    var d = c._getSceneGraphPriority(),
                        b = a._getSceneGraphPriority();
                    if (!(a && b && b._activeInHierarchy && null !== b._parent)) return -1;
                    if (!c || !d || !d._activeInHierarchy || null === d._parent) return 1;
                    c = d;
                    a = b;
                    for (var g = !1; c._parent._id !== a._parent._id;) c = null === c._parent._parent ? (g = !0, b) : c._parent, a = null === a._parent._parent ? (g = !0, d) : a._parent;
                    if (c._id === a._id) {
                        if (c._id === b._id) return -1;
                        if (c._id === d._id) return 1
                    }
                    return g ? c._localZOrder - a._localZOrder : a._localZOrder - c._localZOrder
                },
                _sortListenersOfFixedPriority: function(b) {
                    if (b = this._listenersMap[b]) {
                        var a = b.getFixedPriorityListeners();
                        if (a && 0 !== a.length) {
                            a.sort(this._sortListenersOfFixedPriorityAsc);
                            for (var d = 0, c = a.length; d < c && !(0 <= a[d]._getFixedPriority());) ++d;
                            b.gt0Index = d
                        }
                    }
                },
                _sortListenersOfFixedPriorityAsc: function(b, a) {
                    return b._getFixedPriority() - a._getFixedPriority()
                },
                _onUpdateListeners: function(b) {
                    var a = b.getFixedPriorityListeners(),
                        d = b.getSceneGraphPriorityListeners(),
                        c, g = this._toRemovedListeners;
                    if (d)
                        for (c = d.length - 1; 0 <= c; c--) {
                            var n = d[c];
                            n._isRegistered() || (cc.js.array.removeAt(d, c), n = g.indexOf(n), -1 !== n && g.splice(n,
                                1))
                        }
                    if (a)
                        for (c = a.length - 1; 0 <= c; c--) n = a[c], n._isRegistered() || (cc.js.array.removeAt(a, c), n = g.indexOf(n), -1 !== n && g.splice(n, 1));
                    d && 0 === d.length && b.clearSceneGraphListeners();
                    a && 0 === a.length && b.clearFixedListeners()
                },
                frameUpdateListeners: function() {
                    var b = this._listenersMap,
                        a = this._priorityDirtyFlagMap,
                        d;
                    for (d in b) b[d].empty() && (delete a[d], delete b[d]);
                    b = this._toAddedListeners;
                    if (0 !== b.length) {
                        a = 0;
                        for (d = b.length; a < d; a++) this._forceAddEventListener(b[a]);
                        b.length = 0
                    }
                    0 !== this._toRemovedListeners.length &&
                        this._cleanToRemovedListeners()
                },
                _updateTouchListeners: function(b) {
                    b = this._inDispatch;
                    cc.assertID(0 < b, 3508);
                    if (!(1 < b)) {
                        var a;
                        (a = this._listenersMap[f.TOUCH_ONE_BY_ONE]) && this._onUpdateListeners(a);
                        (a = this._listenersMap[f.TOUCH_ALL_AT_ONCE]) && this._onUpdateListeners(a);
                        cc.assertID(1 === b, 3509);
                        b = this._toAddedListeners;
                        if (0 !== b.length) {
                            a = 0;
                            for (var d = b.length; a < d; a++) this._forceAddEventListener(b[a]);
                            this._toAddedListeners.length = 0
                        }
                        0 !== this._toRemovedListeners.length && this._cleanToRemovedListeners()
                    }
                },
                _cleanToRemovedListeners: function() {
                    for (var b = this._toRemovedListeners, a = 0; a < b.length; a++) {
                        var d = b[a],
                            l = this._listenersMap[d._getListenerID()];
                        if (l) {
                            var g = l.getFixedPriorityListeners(),
                                n = l.getSceneGraphPriorityListeners();
                            n && (l = n.indexOf(d), -1 !== l && n.splice(l, 1));
                            g && (l = g.indexOf(d), -1 !== l && g.splice(l, 1))
                        }
                    }
                    b.length = 0
                },
                _onTouchEventCallback: function(b, a) {
                    if (!b._isRegistered()) return !1;
                    var d = a.event,
                        c = d.currentTouch;
                    d.currentTarget = b._node;
                    var g = !1,
                        n, e = d.getEventCode(),
                        f = cc.Event.EventTouch;
                    if (e === f.BEGAN) {
                        if (!cc.macro.ENABLE_MULTI_TOUCH &&
                            k._currentTouch && (n = k._currentTouchListener._node) && n.activeInHierarchy) return !1;
                        b.onTouchBegan && (g = b.onTouchBegan(c, d)) && b._registered && (b._claimedTouches.push(c), k._currentTouchListener = b, k._currentTouch = c)
                    } else if (0 < b._claimedTouches.length && -1 !== (n = b._claimedTouches.indexOf(c))) {
                        g = !0;
                        if (!cc.macro.ENABLE_MULTI_TOUCH && k._currentTouch && k._currentTouch !== c) return !1;
                        if (e === f.MOVED && b.onTouchMoved) b.onTouchMoved(c, d);
                        else e === f.ENDED ? (b.onTouchEnded && b.onTouchEnded(c, d), b._registered && b._claimedTouches.splice(n,
                            1), k._clearCurTouch()) : e === f.CANCELED && (b.onTouchCancelled && b.onTouchCancelled(c, d), b._registered && b._claimedTouches.splice(n, 1), k._clearCurTouch())
                    }
                    return d.isStopped() ? (k._updateTouchListeners(d), !0) : g && b.swallowTouches ? (a.needsMutableSet && a.touches.splice(c, 1), !0) : !1
                },
                _dispatchTouchEvent: function(b) {
                    this._sortEventListeners(f.TOUCH_ONE_BY_ONE);
                    this._sortEventListeners(f.TOUCH_ALL_AT_ONCE);
                    var a = this._getListeners(f.TOUCH_ONE_BY_ONE),
                        d = this._getListeners(f.TOUCH_ALL_AT_ONCE);
                    if (null !== a || null !==
                        d) {
                        var c = b.getTouches(),
                            g = cc.js.array.copy(c),
                            n = {
                                event: b,
                                needsMutableSet: a && d,
                                touches: g,
                                selTouch: null
                            };
                        if (a)
                            for (var k = 0; k < c.length; k++) b.currentTouch = c[k], b._propagationStopped = b._propagationImmediateStopped = !1, this._dispatchEventToListeners(a, this._onTouchEventCallback, n);
                        if (d && 0 < g.length && (this._dispatchEventToListeners(d, this._onTouchesEventCallback, {
                                event: b,
                                touches: g
                            }), b.isStopped())) return;
                        this._updateTouchListeners(b)
                    }
                },
                _onTouchesEventCallback: function(b, a) {
                    if (!b._registered) return !1;
                    var d =
                        cc.Event.EventTouch,
                        c = a.event;
                    a = a.touches;
                    var g = c.getEventCode();
                    c.currentTarget = b._node;
                    g === d.BEGAN && b.onTouchesBegan ? b.onTouchesBegan(a, c) : g === d.MOVED && b.onTouchesMoved ? b.onTouchesMoved(a, c) : g === d.ENDED && b.onTouchesEnded ? b.onTouchesEnded(a, c) : g === d.CANCELED && b.onTouchesCancelled && b.onTouchesCancelled(a, c);
                    return c.isStopped() ? (k._updateTouchListeners(c), !0) : !1
                },
                _associateNodeAndEventListener: function(b, a) {
                    var d = this._nodeListenersMap[b._id];
                    d || (d = [], this._nodeListenersMap[b._id] = d);
                    d.push(a)
                },
                _dissociateNodeAndEventListener: function(b,
                    a) {
                    var d = this._nodeListenersMap[b._id];
                    d && (cc.js.array.remove(d, a), 0 === d.length && delete this._nodeListenersMap[b._id])
                },
                _dispatchEventToListeners: function(b, a, d) {
                    var c = !1,
                        g = b.getFixedPriorityListeners(),
                        n = b.getSceneGraphPriorityListeners(),
                        k = 0;
                    if (g && 0 !== g.length)
                        for (; k < b.gt0Index; ++k) {
                            var e = g[k];
                            if (e.isEnabled() && !e._isPaused() && e._isRegistered() && a(e, d)) {
                                c = !0;
                                break
                            }
                        }
                    if (n && !c)
                        for (b = 0; b < n.length; b++)
                            if (e = n[b], e.isEnabled() && !e._isPaused() && e._isRegistered() && a(e, d)) {
                                c = !0;
                                break
                            }
                    if (g && !c)
                        for (; k < g.length &&
                            (e = g[k], !e.isEnabled() || e._isPaused() || !e._isRegistered() || !a(e, d)); ++k);
                },
                _setDirty: function(b, a) {
                    var d = this._priorityDirtyFlagMap;
                    null == d[b] ? d[b] = a : d[b] |= a
                },
                _sortNumberAsc: function(b, a) {
                    return b - a
                },
                hasEventListener: function(b) {
                    return !!this._getListeners(b)
                },
                addListener: function(b, a) {
                    cc.assertID(b && a, 3503);
                    if (cc.js.isNumber(a) || a instanceof cc._BaseNode) {
                        if (b instanceof cc.EventListener) {
                            if (b._isRegistered()) {
                                cc.logID(3505);
                                return
                            }
                        } else cc.assertID(!cc.js.isNumber(a), 3504), b = cc.EventListener.create(b);
                        if (b.checkAvailable()) {
                            if (cc.js.isNumber(a)) {
                                if (0 === a) {
                                    cc.logID(3500);
                                    return
                                }
                                b._setSceneGraphPriority(null);
                                b._setFixedPriority(a);
                                b._setRegistered(!0);
                                b._setPaused(!1)
                            } else b._setSceneGraphPriority(a), b._setFixedPriority(0), b._setRegistered(!0);
                            this._addListener(b);
                            return b
                        }
                    } else cc.warnID(3506)
                },
                addCustomListener: function(b, a) {
                    b = new cc.EventListener.create({
                        event: cc.EventListener.CUSTOM,
                        eventName: b,
                        callback: a
                    });
                    this.addListener(b, 1);
                    return b
                },
                removeListener: function(b) {
                    if (null != b) {
                        var a = this._listenersMap,
                            d;
                        for (d in a) {
                            var c = a[d],
                                g = c.getFixedPriorityListeners();
                            var n = c.getSceneGraphPriorityListeners();
                            (n = this._removeListenerInVector(n, b)) ? this._setDirty(b._getListenerID(), this.DIRTY_SCENE_GRAPH_PRIORITY): (n = this._removeListenerInVector(g, b)) && this._setDirty(b._getListenerID(), this.DIRTY_FIXED_PRIORITY);
                            c.empty() && (delete this._priorityDirtyFlagMap[b._getListenerID()], delete a[d]);
                            if (n) break
                        }
                        if (!n)
                            for (a = this._toAddedListeners, d = a.length - 1; 0 <= d; d--)
                                if (c = a[d], c === b) {
                                    cc.js.array.removeAt(a, d);
                                    c._setRegistered(!1);
                                    break
                                }
                        this._currentTouchListener === b && this._clearCurTouch()
                    }
                },
                _clearCurTouch: function() {
                    this._currentTouch = this._currentTouchListener = null
                },
                _removeListenerInCallback: function(b, a) {
                    if (null == b) return !1;
                    for (var d = b.length - 1; 0 <= d; d--) {
                        var c = b[d];
                        if (c._onCustomEvent === a || c._onEvent === a) return c._setRegistered(!1), null != c._getSceneGraphPriority() && (this._dissociateNodeAndEventListener(c._getSceneGraphPriority(), c), c._setSceneGraphPriority(null)), 0 === this._inDispatch ? cc.js.array.removeAt(b, d) : this._toRemovedListeners.push(c), !0
                    }
                    return !1
                },
                _removeListenerInVector: function(b, a) {
                    if (null == b) return !1;
                    for (var d = b.length - 1; 0 <= d; d--) {
                        var c = b[d];
                        if (c === a) return c._setRegistered(!1), null != c._getSceneGraphPriority() && (this._dissociateNodeAndEventListener(c._getSceneGraphPriority(), c), c._setSceneGraphPriority(null)), 0 === this._inDispatch ? cc.js.array.removeAt(b, d) : this._toRemovedListeners.push(c), !0
                    }
                    return !1
                },
                removeListeners: function(b, a) {
                    var d;
                    if (cc.js.isNumber(b) || b instanceof cc._BaseNode)
                        if (void 0 !== b._id) {
                            if (d = this._nodeListenersMap[b._id]) {
                                var c =
                                    cc.js.array.copy(d);
                                for (d = 0; d < c.length; d++) this.removeListener(c[d]);
                                delete this._nodeListenersMap[b._id]
                            }
                            c = this._toAddedListeners;
                            for (d = 0; d < c.length;) {
                                var g = c[d];
                                g._getSceneGraphPriority() === b ? (g._setSceneGraphPriority(null), g._setRegistered(!1), c.splice(d, 1)) : ++d
                            }
                            if (!0 === a)
                                for (b = b.children, d = 0, a = b.length; d < a; d++) this.removeListeners(b[d], !0)
                        } else b === cc.EventListener.TOUCH_ONE_BY_ONE ? this._removeListenersForListenerID(f.TOUCH_ONE_BY_ONE) : b === cc.EventListener.TOUCH_ALL_AT_ONCE ? this._removeListenersForListenerID(f.TOUCH_ALL_AT_ONCE) :
                            b === cc.EventListener.MOUSE ? this._removeListenersForListenerID(f.MOUSE) : b === cc.EventListener.ACCELERATION ? this._removeListenersForListenerID(f.ACCELERATION) : b === cc.EventListener.KEYBOARD ? this._removeListenersForListenerID(f.KEYBOARD) : cc.logID(3501);
                    else cc.warnID(3506)
                },
                removeCustomListeners: function(b) {
                    this._removeListenersForListenerID(b)
                },
                removeAllListeners: function() {
                    var b = this._listenersMap,
                        a = this._internalCustomListenerIDs,
                        d;
                    for (d in b) - 1 === a.indexOf(d) && this._removeListenersForListenerID(d)
                },
                setPriority: function(b, a) {
                    if (null != b) {
                        var d = this._listenersMap,
                            c;
                        for (c in d) {
                            var g = d[c].getFixedPriorityListeners();
                            if (g && -1 !== g.indexOf(b)) {
                                null != b._getSceneGraphPriority() && cc.logID(3502);
                                b._getFixedPriority() !== a && (b._setFixedPriority(a), this._setDirty(b._getListenerID(), this.DIRTY_FIXED_PRIORITY));
                                break
                            }
                        }
                    }
                },
                setEnabled: function(b) {
                    this._isEnabled = b
                },
                isEnabled: function() {
                    return this._isEnabled
                },
                dispatchEvent: function(c) {
                    if (this._isEnabled)
                        if (this._updateDirtyFlagForSceneGraph(), this._inDispatch++,
                            c && c.getType) {
                            if (c.getType().startsWith(cc.Event.TOUCH)) this._dispatchTouchEvent(c);
                            else {
                                var a = b(c);
                                this._sortEventListeners(a);
                                a = this._listenersMap[a];
                                null != a && (this._dispatchEventToListeners(a, this._onListenerCallback, c), this._onUpdateListeners(a))
                            }
                            this._inDispatch--
                        } else cc.errorID(3511)
                },
                _onListenerCallback: function(b, a) {
                    a.currentTarget = b._target;
                    b._onEvent(a);
                    return a.isStopped()
                },
                dispatchCustomEvent: function(b, a) {
                    b = new cc.Event.EventCustom(b);
                    b.setUserData(a);
                    this.dispatchEvent(b)
                }
            };
        m.get(cc,
            "eventManager",
            function() {
                cc.errorID(1405, "cc.eventManager", "cc.EventTarget or cc.systemEvent");
                return k
            });
        q.exports = cc.internal.eventManager = k
    }, {
        "../platform/js": 225,
        "./CCEventListener": 146
    }],
    148: [function(h, q, m) {
        cc.Touch = function(f, e, b) {
            this._lastModified = 0;
            this.setTouchInfo(b, f, e)
        };
        cc.Touch.prototype = {
            constructor: cc.Touch,
            getLocation: function() {
                return cc.v2(this._point.x, this._point.y)
            },
            getLocationX: function() {
                return this._point.x
            },
            getLocationY: function() {
                return this._point.y
            },
            getPreviousLocation: function() {
                return cc.v2(this._prevPoint.x,
                    this._prevPoint.y)
            },
            getStartLocation: function() {
                return cc.v2(this._startPoint.x, this._startPoint.y)
            },
            getDelta: function() {
                return this._point.sub(this._prevPoint)
            },
            getLocationInView: function() {
                return cc.v2(this._point.x, cc.view._designResolutionSize.height - this._point.y)
            },
            getPreviousLocationInView: function() {
                return cc.v2(this._prevPoint.x, cc.view._designResolutionSize.height - this._prevPoint.y)
            },
            getStartLocationInView: function() {
                return cc.v2(this._startPoint.x, cc.view._designResolutionSize.height - this._startPoint.y)
            },
            getID: function() {
                return this._id
            },
            setTouchInfo: function(f, e, b) {
                this._prevPoint = this._point;
                this._point = cc.v2(e || 0, b || 0);
                this._id = f;
                this._startPointCaptured || (this._startPoint = cc.v2(this._point), cc.view._convertPointWithScale(this._startPoint), this._startPointCaptured = !0)
            },
            _setPoint: function(f, e) {
                void 0 === e ? (this._point.x = f.x, this._point.y = f.y) : (this._point.x = f, this._point.y = e)
            },
            _setPrevPoint: function(f, e) {
                this._prevPoint = void 0 === e ? cc.v2(f.x, f.y) : cc.v2(f || 0, e || 0)
            }
        }
    }, {}],
    149: [function(h, q, m) {
        h("./CCEvent");
        h("./CCTouch");
        h("./CCEventListener");
        h = h("./CCEventManager");
        q.exports = h;
        !1
    }, {
        "./CCEvent": 145,
        "./CCEventListener": 146,
        "./CCEventManager": 147,
        "./CCTouch": 148
    }],
    150: [function(h, q, m) {
        function f() {
            e.call(this)
        }
        m = cc.js;
        var e = h("../platform/callbacks-invoker");
        m.extend(f, e);
        f.prototype.emit = function(b, k) {
            var c = this._callbackTable[b.type];
            if (c) {
                var a = !c.isInvoking;
                c.isInvoking = !0;
                for (var d = c.callbackInfos, l = 0, g = d.length; l < g; ++l) {
                    var n = d[l];
                    if (n && n.callback && (n.callback.call(n.target, b, k), b._propagationImmediateStopped)) break
                }
                a &&
                    (c.isInvoking = !1, c.containCanceled && c.purgeCanceled())
            }
        };
        q.exports = f;
        !1
    }, {
        "../platform/callbacks-invoker": 217
    }],
    151: [function(h, q, m) {
        function f() {
            e.call(this)
        }
        m = h("../platform/js");
        var e = h("../platform/callbacks-invoker"),
            b = m.array.fastRemove;
        m.extend(f, e);
        h = f.prototype;
        h.__on = h.on;
        h.on = function(b, c, a, d) {
            if (c) return this.hasEventListener(b, c, a) || (this.__on(b, c, a, d), a && a.__eventTargets && a.__eventTargets.push(this)), c;
            cc.errorID(6800)
        };
        h.__off = h.off;
        h.off = function(k, c, a) {
            if (c) this.__off(k, c, a), a && a.__eventTargets &&
                b(a.__eventTargets, this);
            else if (c = this._callbackTable[k]) {
                c = c.callbackInfos;
                for (a = 0; a < c.length; ++a) {
                    var d = c[a] && c[a].target;
                    d && d.__eventTargets && b(d.__eventTargets, this)
                }
                this.removeAll(k)
            }
        };
        h.targetOff = function(k) {
            this.removeAll(k);
            k && k.__eventTargets && b(k.__eventTargets, this)
        };
        h.once = function(b, c, a) {
            this.on(b, c, a, !0)
        };
        h.dispatchEvent = function(b) {
            this.emit(b.type, b)
        };
        h.clear = function() {
            for (var b in this._callbackTable)
                for (var c = this._callbackTable[b].callbackInfos, a = c.length - 1; 0 <= a; a--) {
                    var d = c[a];
                    d && this.off(b, d.callback, d.target)
                }
        };
        cc.EventTarget = q.exports = f
    }, {
        "../platform/callbacks-invoker": 217,
        "../platform/js": 225
    }],
    152: [function(h, q, m) {
        h = h("../platform/js");
        cc.Event = function(b, k) {
            this.type = b;
            this.bubbles = !!k;
            this.currentTarget = this.target = null;
            this.eventPhase = 0;
            this._propagationImmediateStopped = this._propagationStopped = !1
        };
        cc.Event.prototype = {
            constructor: cc.Event,
            unuse: function() {
                this.type = cc.Event.NO_TYPE;
                this.currentTarget = this.target = null;
                this.eventPhase = cc.Event.NONE;
                this._propagationImmediateStopped =
                    this._propagationStopped = !1
            },
            reuse: function(b, k) {
                this.type = b;
                this.bubbles = k || !1
            },
            stopPropagation: function() {
                this._propagationStopped = !0
            },
            stopPropagationImmediate: function() {
                this._propagationImmediateStopped = !0
            },
            isStopped: function() {
                return this._propagationStopped || this._propagationImmediateStopped
            },
            getCurrentTarget: function() {
                return this.currentTarget
            },
            getType: function() {
                return this.type
            }
        };
        cc.Event.NO_TYPE = "no_type";
        cc.Event.TOUCH = "touch";
        cc.Event.MOUSE = "mouse";
        cc.Event.KEYBOARD = "keyboard";
        cc.Event.ACCELERATION =
            "acceleration";
        cc.Event.NONE = 0;
        cc.Event.CAPTURING_PHASE = 1;
        cc.Event.AT_TARGET = 2;
        cc.Event.BUBBLING_PHASE = 3;
        var f = function(b, k) {
            cc.Event.call(this, b, k);
            this.detail = null
        };
        h.extend(f, cc.Event);
        f.prototype.reset = f;
        f.prototype.setUserData = function(b) {
            this.detail = b
        };
        f.prototype.getUserData = function() {
            return this.detail
        };
        f.prototype.getEventName = cc.Event.prototype.getType;
        var e = new h.Pool(10);
        f.put = function(b) {
            e.put(b)
        };
        f.get = function(b, k) {
            var c = e._get();
            c ? c.reset(b, k) : c = new f(b, k);
            return c
        };
        cc.Event.EventCustom =
            f;
        q.exports = cc.Event
    }, {
        "../platform/js": 225
    }],
    153: [function(h, q, m) {
        h("./event");
        h("./event-listeners");
        h("./event-target");
        h("./system-event")
    }, {
        "./event": 152,
        "./event-listeners": 150,
        "./event-target": 151,
        "./system-event": 154
    }],
    154: [function(h, q, m) {
        m = h("../event/event-target");
        var f = h("../event-manager"),
            e = h("../platform/CCInputManager"),
            b = cc.Enum({
                KEY_DOWN: "keydown",
                KEY_UP: "keyup",
                DEVICEMOTION: "devicemotion"
            }),
            k = null,
            c = null;
        h = cc.Class({
            name: "SystemEvent",
            extends: m,
            statics: {
                EventType: b
            },
            setAccelerometerEnabled: function(a) {
                !1;
                a && window.DeviceMotionEvent && "function" === typeof DeviceMotionEvent.requestPermission ? DeviceMotionEvent.requestPermission().then(function(a) {
                    console.log("Device Motion Event request permission: " + a);
                    e.setAccelerometerEnabled("granted" === a)
                }) : e.setAccelerometerEnabled(a)
            },
            setAccelerometerInterval: function(a) {
                !1;
                e.setAccelerometerInterval(a)
            },
            on: function(a, d, l, g) {
                !1;
                this._super(a, d, l, g);
                if (a === b.KEY_DOWN || a === b.KEY_UP) k || (k = cc.EventListener.create({
                    event: cc.EventListener.KEYBOARD,
                    onKeyPressed: function(a,
                        d) {
                        d.type = b.KEY_DOWN;
                        cc.systemEvent.dispatchEvent(d)
                    },
                    onKeyReleased: function(a, d) {
                        d.type = b.KEY_UP;
                        cc.systemEvent.dispatchEvent(d)
                    }
                })), f.hasEventListener(cc.EventListener.ListenerID.KEYBOARD) || f.addListener(k, 1);
                a === b.DEVICEMOTION && (c || (c = cc.EventListener.create({
                    event: cc.EventListener.ACCELERATION,
                    callback: function(a, d) {
                        d.type = b.DEVICEMOTION;
                        cc.systemEvent.dispatchEvent(d)
                    }
                })), f.hasEventListener(cc.EventListener.ListenerID.ACCELERATION) || f.addListener(c, 1))
            },
            off: function(a, d, l) {
                !1;
                this._super(a, d,
                    l);
                !k || a !== b.KEY_DOWN && a !== b.KEY_UP || (d = this.hasEventListener(b.KEY_DOWN), l = this.hasEventListener(b.KEY_UP), d || l || f.removeListener(k));
                c && a === b.DEVICEMOTION && f.removeListener(c)
            }
        });
        cc.SystemEvent = q.exports = h;
        cc.systemEvent = new cc.SystemEvent
    }, {
        "../event-manager": 149,
        "../event/event-target": 151,
        "../platform/CCInputManager": 208
    }],
    155: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = f(h("../value-types/vec3")),
            b = f(h("../value-types/mat3")),
            k = f(h("./enums")),
            c = new e["default"],
            a = new e["default"],
            d = new b["default"];
        h = function() {
            function b(a, b, d, c, g, l) {
                this._type = this.halfExtents = this.center = void 0;
                this._type = k["default"].SHAPE_AABB;
                this.center = new e["default"](a, b, d);
                this.halfExtents = new e["default"](c, g, l)
            }
            b.create = function(a, d, c, g, l, k) {
                return new b(a, d, c, g, l, k)
            };
            b.clone = function(a) {
                return new b(a.center.x, a.center.y, a.center.z, a.halfExtents.x, a.halfExtents.y, a.halfExtents.z)
            };
            b.copy = function(a, b) {
                e["default"].copy(a.center, b.center);
                e["default"].copy(a.halfExtents, b.halfExtents);
                return a
            };
            b.fromPoints = function(b, d, g) {
                e["default"].scale(b.center, e["default"].add(c, d, g), .5);
                e["default"].scale(b.halfExtents, e["default"].sub(a, g, d), .5);
                return b
            };
            b.set = function(a, b, d, c, g, l, k) {
                e["default"].set(a.center, b, d, c);
                e["default"].set(a.halfExtents, g, l, k);
                return a
            };
            var g = b.prototype;
            g.getBoundary = function(a, b) {
                e["default"].sub(a, this.center, this.halfExtents);
                e["default"].add(b, this.center, this.halfExtents)
            };
            g.transform = function(a, b, c, g, l) {
                l ||
                    (l = this);
                e["default"].transformMat4(l.center, this.center, a);
                b = l.halfExtents;
                c = this.halfExtents;
                g = d.m;
                a = a.m;
                g[0] = Math.abs(a[0]);
                g[1] = Math.abs(a[1]);
                g[2] = Math.abs(a[2]);
                g[3] = Math.abs(a[4]);
                g[4] = Math.abs(a[5]);
                g[5] = Math.abs(a[6]);
                g[6] = Math.abs(a[8]);
                g[7] = Math.abs(a[9]);
                g[8] = Math.abs(a[10]);
                e["default"].transformMat3(b, c, d)
            };
            return b
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../value-types/mat3": 302,
        "../value-types/vec3": 311,
        "./enums": 157
    }],
    156: [function(h, q, m) {
        function f(a, b) {
            return e.Vec3.dot(b.n,
                a) - b.d
        }
        m.__esModule = !0;
        m.point_plane = f;
        m.pt_point_plane = function(a, b, d) {
            var c = f(b, d);
            return e.Vec3.subtract(a, b, e.Vec3.multiplyScalar(a, d.n, c))
        };
        m.pt_point_aabb = function(a, b, c) {
            e.Vec3.copy(a, b);
            e.Vec3.subtract(d, c.center, c.halfExtents);
            e.Vec3.add(l, c.center, c.halfExtents);
            a.x = a.x < d.x ? d.x : a.x;
            a.y = a.y < d.x ? d.y : a.y;
            a.z = a.z < d.x ? d.z : a.z;
            a.x = a.x > l.x ? l.x : a.x;
            a.y = a.y > l.x ? l.y : a.y;
            a.z = a.z > l.x ? l.z : a.z;
            return a
        };
        m.pt_point_obb = function(d, l, p) {
            var f = p.orientation.m;
            e.Vec3.set(b, f[0], f[1], f[2]);
            e.Vec3.set(k, f[3],
                f[4], f[5]);
            e.Vec3.set(c, f[6], f[7], f[8]);
            g[0] = b;
            g[1] = k;
            g[2] = c;
            n[0] = p.halfExtents.x;
            n[1] = p.halfExtents.y;
            n[2] = p.halfExtents.z;
            e.Vec3.subtract(a, l, p.center);
            e.Vec3.set(d, p.center.x, p.center.y, p.center.z);
            for (l = 0; 3 > l; l++) p = e.Vec3.dot(a, g[l]), p > n[l] && (p = n[l]), p < -n[l] && (p = -n[l]), d.x += p * g[l].x, d.y += p * g[l].y, d.z += p * g[l].z;
            return d
        };
        var e = h("../value-types"),
            b = new e.Vec3,
            k = new e.Vec3,
            c = new e.Vec3,
            a = new e.Vec3,
            d = new e.Vec3,
            l = new e.Vec3,
            g = Array(3),
            n = Array(3)
    }, {
        "../value-types": 301
    }],
    157: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        m["default"] = {
            SHAPE_RAY: 1,
            SHAPE_LINE: 2,
            SHAPE_SPHERE: 4,
            SHAPE_AABB: 8,
            SHAPE_OBB: 16,
            SHAPE_PLANE: 32,
            SHAPE_TRIANGLE: 64,
            SHAPE_FRUSTUM: 128,
            SHAPE_FRUSTUM_ACCURATE: 256
        };
        q.exports = m["default"]
    }, {}],
    158: [function(h, q, m) {
            function f(a) {
                return a && a.__esModule ? a : {
                    default: a
                }
            }

            function e(a, b) {
                for (var d = 0; d < b.length; d++) {
                    var c = b[d];
                    c.enumerable = c.enumerable || !1;
                    c.configurable = !0;
                    "value" in c && (c.writable = !0);
                    Object.defineProperty(a, c.key, c)
                }
            }

            function b(a, b, d) {
                b && e(a.prototype, b);
                d && e(a, d);
                return a
            }
            m.__esModule = !0;
            m["default"] = void 0;
            var k = h("../value-types"),
                c = f(h("./enums")),
                a = f(h("./plane")),
                d = Array(8);
            d[0] = new k.Vec3(1, 1, 1);
            d[1] = new k.Vec3(-1, 1, 1);
            d[2] = new k.Vec3(-1, -1, 1);
            d[3] = new k.Vec3(1, -1, 1);
            d[4] = new k.Vec3(1, 1, -1);
            d[5] = new k.Vec3(-1, 1, -1);
            d[6] = new k.Vec3(-1, -1, -1);
            d[7] = new k.Vec3(1, -1, -1);
            h = function() {
                function l() {
                    this._type = this.vertices = this.planes = void 0;
                    this._type = c["default"].SHAPE_FRUSTUM;
                    this.planes = Array(6);
                    for (var b = 0; 6 > b; ++b) this.planes[b] = a["default"].create(0, 0, 0, 0);
                    this.vertices =
                        Array(8);
                    for (b = 0; 8 > b; ++b) this.vertices[b] = new k.Vec3
                }
                l.create = function() {
                    return new l
                };
                l.clone = function(a) {
                    return l.copy(new l, a)
                };
                l.copy = function(b, d) {
                    b._type = d._type;
                    for (var c = 0; 6 > c; ++c) a["default"].copy(b.planes[c], d.planes[c]);
                    for (c = 0; 8 > c; ++c) k.Vec3.copy(b.vertices[c], d.vertices[c]);
                    return b
                };
                b(l, [{
                    key: "accurate",
                    set: function(a) {
                        this._type = a ? c["default"].SHAPE_FRUSTUM_ACCURATE : c["default"].SHAPE_FRUSTUM
                    }
                }]);
                var g = l.prototype;
                g.update = function(a, b) {
                    a = a.m;
                    k.Vec3.set(this.planes[0].n, a[3] + a[0], a[7] +
                        a[4], a[11] + a[8]);
                    this.planes[0].d = -(a[15] + a[12]);
                    k.Vec3.set(this.planes[1].n, a[3] - a[0], a[7] - a[4], a[11] - a[8]);
                    this.planes[1].d = -(a[15] - a[12]);
                    k.Vec3.set(this.planes[2].n, a[3] + a[1], a[7] + a[5], a[11] + a[9]);
                    this.planes[2].d = -(a[15] + a[13]);
                    k.Vec3.set(this.planes[3].n, a[3] - a[1], a[7] - a[5], a[11] - a[9]);
                    this.planes[3].d = -(a[15] - a[13]);
                    k.Vec3.set(this.planes[4].n, a[3] + a[2], a[7] + a[6], a[11] + a[10]);
                    this.planes[4].d = -(a[15] + a[14]);
                    k.Vec3.set(this.planes[5].n, a[3] - a[2], a[7] - a[6], a[11] - a[10]);
                    this.planes[5].d = -(a[15] -
                        a[14]);
                    if (this._type === c["default"].SHAPE_FRUSTUM_ACCURATE) {
                        for (a = 0; 6 > a; a++) {
                            var g = this.planes[a],
                                l = 1 / g.n.length();
                            k.Vec3.multiplyScalar(g.n, g.n, l);
                            g.d *= l
                        }
                        for (a = 0; 8 > a; a++) k.Vec3.transformMat4(this.vertices[a], d[a], b)
                    }
                };
                g.transform = function(b) {
                    if (this._type === c["default"].SHAPE_FRUSTUM_ACCURATE) {
                        for (var d = 0; 8 > d; d++) k.Vec3.transformMat4(this.vertices[d], this.vertices[d], b);
                        a["default"].fromPoints(this.planes[0], this.vertices[1], this.vertices[5], this.vertices[6]);
                        a["default"].fromPoints(this.planes[1],
                            this.vertices[3], this.vertices[7], this.vertices[4]);
                        a["default"].fromPoints(this.planes[2], this.vertices[6], this.vertices[7], this.vertices[3]);
                        a["default"].fromPoints(this.planes[3], this.vertices[0], this.vertices[4], this.vertices[5]);
                        a["default"].fromPoints(this.planes[4], this.vertices[2], this.vertices[3], this.vertices[0]);
                        a["default"].fromPoints(this.planes[0], this.vertices[7], this.vertices[6], this.vertices[5])
                    }
                };
                return l
            }();
            m["default"] = h;
            h.createOrtho = function() {
                var b = new k.Vec3;
                return function(d,
                    c, l, e, p, f) {
                    c /= 2;
                    l /= 2;
                    k.Vec3.set(b, c, l, e);
                    k.Vec3.transformMat4(d.vertices[0], b, f);
                    k.Vec3.set(b, -c, l, e);
                    k.Vec3.transformMat4(d.vertices[1], b, f);
                    k.Vec3.set(b, -c, -l, e);
                    k.Vec3.transformMat4(d.vertices[2], b, f);
                    k.Vec3.set(b, c, -l, e);
                    k.Vec3.transformMat4(d.vertices[3], b, f);
                    k.Vec3.set(b, c, l, p);
                    k.Vec3.transformMat4(d.vertices[4], b, f);
                    k.Vec3.set(b, -c, l, p);
                    k.Vec3.transformMat4(d.vertices[5], b, f);
                    k.Vec3.set(b, -c, -l, p);
                    k.Vec3.transformMat4(d.vertices[6], b, f);
                    k.Vec3.set(b, c, -l, p);
                    k.Vec3.transformMat4(d.vertices[7],
                        b, f);
                    a["default"].fromPoints(d.planes[0], d.vertices[1], d.vertices[6], d.vertices[5]);
                    a["default"].fromPoints(d.planes[1], d.vertices[3], d.vertices[4], d.vertices[7]);
                    a["default"].fromPoints(d.planes[2], d.vertices[6], d.vertices[3], d.vertices[7]);
                    a["default"].fromPoints(d.planes[3], d.vertices[0], d.vertices[5], d.vertices[4]);
                    a["default"].fromPoints(d.planes[4], d.vertices[2], d.vertices[0], d.vertices[3]);
                    a["default"].fromPoints(d.planes[0], d.vertices[7], d.vertices[5], d.vertices[6])
                }
            }();
            q.exports = m["default"]
        },
        {
            "../value-types": 301,
            "./enums": 157,
            "./plane": 163
        }
    ],
    159: [function(h, q, m) {
        function f(b) {
            return b && b.__esModule ? b : {
                default: b
            }
        }
        m.__esModule = !0;
        var e = {
            enums: !0,
            Triangle: !0,
            Aabb: !0,
            Ray: !0,
            intersect: !0,
            Sphere: !0,
            Obb: !0,
            Frustum: !0,
            Line: !0,
            Plane: !0
        };
        m.Plane = m.Line = m.Frustum = m.Obb = m.Sphere = m.intersect = m.Ray = m.Aabb = m.Triangle = m.enums = void 0;
        var b = f(h("./enums"));
        m.enums = b["default"];
        b = f(h("./triangle"));
        m.Triangle = b["default"];
        b = f(h("./aabb"));
        m.Aabb = b["default"];
        b = f(h("./ray"));
        m.Ray = b["default"];
        b = f(h("./intersect"));
        m.intersect = b["default"];
        b = f(h("./sphere"));
        m.Sphere = b["default"];
        b = f(h("./obb"));
        m.Obb = b["default"];
        b = f(h("./frustum"));
        m.Frustum = b["default"];
        b = f(h("./line"));
        m.Line = b["default"];
        b = f(h("./plane"));
        m.Plane = b["default"];
        var k = h("./distance");
        Object.keys(k).forEach(function(b) {
            "default" !== b && "__esModule" !== b && (Object.prototype.hasOwnProperty.call(e, b) || (m[b] = k[b]))
        });
        cc.geomUtils = q.exports
    }, {
        "./aabb": 155,
        "./distance": 156,
        "./enums": 157,
        "./frustum": 158,
        "./intersect": 160,
        "./line": 161,
        "./obb": 162,
        "./plane": 163,
        "./ray": 164,
        "./sphere": 165,
        "./triangle": 166
    }],
    160: [function(h, q, m) {
        function f() {
            if ("function" !== typeof WeakMap) return null;
            var a = new WeakMap;
            f = function() {
                return a
            };
            return a
        }

        function e(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function b(a, b, c, g, l, n) {
            d.Vec3.set(n[0], a.x + c.x * b.x + g.x * b.y + l.x * b.z, a.y + c.y * b.x + g.y * b.y + l.y * b.z, a.z + c.z * b.x + g.z * b.y + l.z * b.z);
            d.Vec3.set(n[1], a.x - c.x * b.x + g.x * b.y + l.x * b.z, a.y - c.y * b.x + g.y * b.y + l.y * b.z, a.z - c.z * b.x + g.z * b.y + l.z * b.z);
            d.Vec3.set(n[2], a.x + c.x * b.x - g.x * b.y + l.x * b.z, a.y + c.y *
                b.x - g.y * b.y + l.y * b.z, a.z + c.z * b.x - g.z * b.y + l.z * b.z);
            d.Vec3.set(n[3], a.x + c.x * b.x + g.x * b.y - l.x * b.z, a.y + c.y * b.x + g.y * b.y - l.y * b.z, a.z + c.z * b.x + g.z * b.y - l.z * b.z);
            d.Vec3.set(n[4], a.x - c.x * b.x - g.x * b.y - l.x * b.z, a.y - c.y * b.x - g.y * b.y - l.y * b.z, a.z - c.z * b.x - g.z * b.y - l.z * b.z);
            d.Vec3.set(n[5], a.x + c.x * b.x - g.x * b.y - l.x * b.z, a.y + c.y * b.x - g.y * b.y - l.y * b.z, a.z + c.z * b.x - g.z * b.y - l.z * b.z);
            d.Vec3.set(n[6], a.x - c.x * b.x + g.x * b.y - l.x * b.z, a.y - c.y * b.x + g.y * b.y - l.y * b.z, a.z - c.z * b.x + g.z * b.y - l.z * b.z);
            d.Vec3.set(n[7], a.x - c.x * b.x - g.x * b.y + l.x * b.z, a.y -
                c.y * b.x - g.y * b.y + l.y * b.z, a.z - c.z * b.x - g.z * b.y + l.z * b.z)
        }

        function k(a, b) {
            for (var c = d.Vec3.dot(b, a[0]), g = c, l = 1; 8 > l; ++l) {
                var n = d.Vec3.dot(b, a[l]);
                c = n < c ? n : c;
                g = n > g ? n : g
            }
            return [c, g]
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var c = e(h("../../renderer/gfx")),
            a = e(h("../../renderer/memop/recycle-pool")),
            d = h("../value-types"),
            l = e(h("./aabb")),
            g = function(a) {
                if (a && a.__esModule) return a;
                if (null === a || "object" !== typeof a && "function" !== typeof a) return {
                    default: a
                };
                var b = f();
                if (b && b.has(a)) return b.get(a);
                var d = {},
                    c = Object.defineProperty &&
                    Object.getOwnPropertyDescriptor,
                    g;
                for (g in a)
                    if (Object.prototype.hasOwnProperty.call(a, g)) {
                        var l = c ? Object.getOwnPropertyDescriptor(a, g) : null;
                        l && (l.get || l.set) ? Object.defineProperty(d, g, l) : d[g] = a[g]
                    }
                d["default"] = a;
                b && b.set(a, d);
                return d
            }(h("./distance")),
            n = e(h("./enums")),
            w = e(h("./ray")),
            t = e(h("./triangle")),
            p = function() {
                function a(a, b, c, g) {
                    d.Vec3.set(a, b[c * g], b[c * g + 1], b[c * g + 2])
                }
                var b = t["default"].create(),
                    g = Infinity;
                return function(d, l) {
                    g = Infinity;
                    for (var n = l._subMeshes, k = 0; k < n.length; k++)
                        if (n[k]._primitiveType ===
                            c["default"].PT_TRIANGLES) {
                            var e = l._subDatas[k] || l._subDatas[0],
                                p = l._getAttrMeshData(k, c["default"].ATTR_POSITION),
                                f = e.getIData(Uint16Array);
                            e = e.vfm.element(c["default"].ATTR_POSITION).num;
                            for (var t = 0; t < f.length; t += 3) {
                                a(b.a, p, f[t], e);
                                a(b.b, p, f[t + 1], e);
                                a(b.c, p, f[t + 2], e);
                                var h = A(d, b);
                                0 < h && h < g && (g = h)
                            }
                        }
                    return g
                }
            }(),
            u = function() {
                function b(a, d) {
                    for (var c = a.children, g = c.length - 1; 0 <= g; g--) b(c[g], d);
                    d(a)
                }

                function c(a, b) {
                    return a.distance - b.distance
                }

                function g(a, b, d) {
                    d = d.m;
                    var c = b.x,
                        g = b.y;
                    b = b.z;
                    var l = d[3] *
                        c + d[7] * g + d[11] * b;
                    l = l ? 1 / l : 1;
                    a.x = (d[0] * c + d[4] * g + d[8] * b) * l;
                    a.y = (d[1] * c + d[5] * g + d[9] * b) * l;
                    a.z = (d[2] * c + d[6] * g + d[10] * b) * l;
                    return a
                }
                var n = new a["default"](function() {
                        return {
                            distance: 0,
                            node: null
                        }
                    }, 1),
                    k = [],
                    e = l["default"].create(),
                    p = new d.Vec3,
                    f = new d.Vec3,
                    t = new w["default"],
                    h = cc.mat4(),
                    u = cc.mat4(),
                    v = new d.Vec3;
                return function(a, w, A, B) {
                    n.reset();
                    k.length = 0;
                    a = a || cc.director.getScene();
                    b(a, function(a) {
                        if (!B || B(a)) {
                            d.Mat4.invert(u, a.getWorldMatrix(h));
                            d.Vec3.transformMat4(t.o, w.o, u);
                            d.Vec3.normalize(t.d, g(t.d,
                                w.d, u));
                            var b = Infinity,
                                c = a._renderComponent;
                            c instanceof cc.MeshRenderer ? b = x(t, c._boundingBox) : a.width && a.height && (d.Vec3.set(p, -a.width * a.anchorX, -a.height * a.anchorY, a.z), d.Vec3.set(f, a.width * (1 - a.anchorX), a.height * (1 - a.anchorY), a.z), l["default"].fromPoints(e, p, f), b = x(t, e));
                            0 < b && Infinity > b && (A && (b = A(t, a, b)), 0 < b && Infinity > b && (d.Vec3.scale(v, t.d, b), g(v, v, h), b = n.add(), b.node = a, b.distance = d.Vec3.mag(v), k.push(b)))
                        }
                    });
                    k.sort(c);
                    return k
                }
            }();
        h = function() {
            var a = new d.Vec3(0, 0, 0);
            return function(b, c) {
                var g =
                    d.Vec3.dot(b.d, c.n);
                if (Math.abs(g) < Number.EPSILON) return 0;
                d.Vec3.multiplyScalar(a, c.n, c.d);
                b = d.Vec3.dot(d.Vec3.subtract(a, a, b.o), c.n) / g;
                return 0 > b ? 0 : b
            }
        }();
        var v = function() {
                var a = new d.Vec3(0, 0, 0);
                return function(b, c) {
                    d.Vec3.subtract(a, b.e, b.s);
                    b = (c.d - d.Vec3.dot(b.s, c.n)) / d.Vec3.dot(a, c.n);
                    return 0 > b || 1 < b ? 0 : b
                }
            }(),
            A = function() {
                var a = new d.Vec3(0, 0, 0),
                    b = new d.Vec3(0, 0, 0),
                    c = new d.Vec3(0, 0, 0),
                    g = new d.Vec3(0, 0, 0),
                    l = new d.Vec3(0, 0, 0);
                return function(n, k, e) {
                    d.Vec3.subtract(a, k.b, k.a);
                    d.Vec3.subtract(b, k.c,
                        k.a);
                    d.Vec3.cross(c, n.d, b);
                    var p = d.Vec3.dot(a, c);
                    if (p < Number.EPSILON && (!e || p > -Number.EPSILON)) return 0;
                    e = 1 / p;
                    d.Vec3.subtract(g, n.o, k.a);
                    k = d.Vec3.dot(g, c) * e;
                    if (0 > k || 1 < k) return 0;
                    d.Vec3.cross(l, g, a);
                    n = d.Vec3.dot(n.d, l) * e;
                    if (0 > n || 1 < k + n) return 0;
                    n = d.Vec3.dot(b, l) * e;
                    return 0 > n ? 0 : n
                }
            }(),
            B = A,
            E = function() {
                var a = new d.Vec3(0, 0, 0),
                    b = new d.Vec3(0, 0, 0),
                    c = new d.Vec3(0, 0, 0),
                    g = new d.Vec3(0, 0, 0),
                    l = new d.Vec3(0, 0, 0),
                    n = new d.Vec3(0, 0, 0);
                return function(k, e, p) {
                    d.Vec3.subtract(a, e.b, e.a);
                    d.Vec3.subtract(b, e.c, e.a);
                    d.Vec3.subtract(c,
                        k.s, k.e);
                    d.Vec3.cross(l, a, b);
                    var f = d.Vec3.dot(c, l);
                    if (0 >= f) return 0;
                    d.Vec3.subtract(g, k.s, e.a);
                    k = d.Vec3.dot(g, l);
                    if (0 > k || k > f) return 0;
                    d.Vec3.cross(n, c, g);
                    k = d.Vec3.dot(b, n);
                    if (0 > k || k > f) return 0;
                    var t = -d.Vec3.dot(a, n);
                    if (0 > t || k + t > f) return 0;
                    p && (f = 1 / f, k *= f, t *= f, f = 1 - k - t, d.Vec3.set(p, e.a.x * f + e.b.x * k + e.c.x * t, e.a.y * f + e.b.y * k + e.c.y * t, e.a.z * f + e.b.z * k + e.c.z * t));
                    return 1
                }
            }(),
            y = function() {
                var a = new d.Vec3(0, 0, 0),
                    b = new d.Vec3(0, 0, 0),
                    c = new d.Vec3(0, 0, 0),
                    g = new d.Vec3(0, 0, 0),
                    l = new d.Vec3(0, 0, 0),
                    n = new d.Vec3(0, 0,
                        0),
                    k = new d.Vec3(0, 0, 0);
                return function(e, p, f, t, h, u, v) {
                    d.Vec3.subtract(a, p, e);
                    d.Vec3.subtract(b, f, e);
                    d.Vec3.subtract(c, t, e);
                    d.Vec3.subtract(g, h, e);
                    d.Vec3.cross(n, g, a);
                    p = d.Vec3.dot(b, n);
                    if (0 <= p) {
                        u = -d.Vec3.dot(c, n);
                        if (0 > u) return 0;
                        e = d.Vec3.dot(d.Vec3.cross(k, a, c), b);
                        if (0 > e) return 0;
                        if (v) {
                            var w = 1 / (u + p + e);
                            u *= w;
                            p *= w;
                            e *= w;
                            d.Vec3.set(v, f.x * u + t.x * p + h.x * e, f.y * u + t.y * p + h.y * e, f.z * u + t.z * p + h.z * e)
                        }
                    } else {
                        d.Vec3.subtract(l, u, e);
                        t = d.Vec3.dot(l, n);
                        if (0 > t) return 0;
                        e = d.Vec3.dot(d.Vec3.cross(k, a, b), l);
                        if (0 > e) return 0;
                        v &&
                            (p = -p, w = 1 / (t + p + e), t *= w, p *= w, e *= w, d.Vec3.set(v, f.x * t + u.x * p + h.x * e, f.y * t + u.y * p + h.y * e, f.z * t + u.z * p + h.z * e))
                    }
                    return 1
                }
            }(),
            z = function() {
                var a = new d.Vec3(0, 0, 0);
                return function(b, c) {
                    var g = c.radius,
                        l = b.d;
                    g *= g;
                    d.Vec3.subtract(a, c.center, b.o);
                    b = a.lengthSqr();
                    l = d.Vec3.dot(a, l);
                    c = g - (b - l * l);
                    if (0 > c) return 0;
                    c = Math.sqrt(c);
                    g = b < g ? l + c : l - c;
                    return 0 > g ? 0 : g
                }
            }(),
            x = function() {
                var a = new d.Vec3,
                    b = new d.Vec3;
                return function(c, g) {
                    var l = c.o;
                    c = c.d;
                    var n = 1 / c.x,
                        k = 1 / c.y;
                    c = 1 / c.z;
                    d.Vec3.subtract(a, g.center, g.halfExtents);
                    d.Vec3.add(b,
                        g.center, g.halfExtents);
                    g = (a.x - l.x) * n;
                    n *= b.x - l.x;
                    var e = (a.y - l.y) * k;
                    k *= b.y - l.y;
                    var p = (a.z - l.z) * c;
                    c *= b.z - l.z;
                    l = Math.max(Math.max(Math.min(g, n), Math.min(e, k)), Math.min(p, c));
                    g = Math.min(Math.min(Math.max(g, n), Math.max(e, k)), Math.max(p, c));
                    return 0 > g || l > g ? 0 : l
                }
            }(),
            C = x,
            G = function() {
                var a = new d.Vec3,
                    b = new d.Vec3,
                    c = new d.Vec3,
                    g = new d.Vec3,
                    l = new d.Vec3,
                    n = new d.Vec3,
                    k = new d.Vec3,
                    e = Array(3),
                    p = Array(3),
                    f = Array(3),
                    t = Array(6);
                return function(h, u) {
                    e[0] = u.halfExtents.x;
                    e[1] = u.halfExtents.y;
                    e[2] = u.halfExtents.z;
                    a =
                        u.center;
                    b = h.o;
                    c = h.d;
                    h = u.orientation.m;
                    d.Vec3.set(g, h[0], h[1], h[2]);
                    d.Vec3.set(l, h[3], h[4], h[5]);
                    d.Vec3.set(n, h[6], h[7], h[8]);
                    d.Vec3.subtract(k, a, b);
                    p[0] = d.Vec3.dot(g, c);
                    p[1] = d.Vec3.dot(l, c);
                    p[2] = d.Vec3.dot(n, c);
                    f[0] = d.Vec3.dot(g, k);
                    f[1] = d.Vec3.dot(l, k);
                    f[2] = d.Vec3.dot(n, k);
                    for (h = 0; 3 > h; ++h) {
                        if (0 === p[h]) {
                            if (0 < -f[h] - e[h] || 0 > -f[h] + e[h]) return 0;
                            p[h] = 1E-7
                        }
                        t[2 * h + 0] = (f[h] + e[h]) / p[h];
                        t[2 * h + 1] = (f[h] - e[h]) / p[h]
                    }
                    h = Math.max(Math.max(Math.min(t[0], t[1]), Math.min(t[2], t[3])), Math.min(t[4], t[5]));
                    u = Math.min(Math.min(Math.max(t[0],
                        t[1]), Math.max(t[2], t[3])), Math.max(t[4], t[5]));
                    return 0 > u || h > u || 0 > h ? 0 : h
                }
            }(),
            F = function() {
                var a = new d.Vec3,
                    b = new d.Vec3,
                    c = new d.Vec3,
                    g = new d.Vec3;
                return function(l, n) {
                    d.Vec3.subtract(a, l.center, l.halfExtents);
                    d.Vec3.add(b, l.center, l.halfExtents);
                    d.Vec3.subtract(c, n.center, n.halfExtents);
                    d.Vec3.add(g, n.center, n.halfExtents);
                    return a.x <= g.x && b.x >= c.x && a.y <= g.y && b.y >= c.y && a.z <= g.z && b.z >= c.z
                }
            }(),
            H = function() {
                for (var a = Array(15), c = 0; 15 > c; c++) a[c] = new d.Vec3(0, 0, 0);
                var g = Array(8),
                    l = Array(8);
                for (c = 0; 8 > c; c++) g[c] =
                    new d.Vec3(0, 0, 0), l[c] = new d.Vec3(0, 0, 0);
                var n = new d.Vec3,
                    e = new d.Vec3;
                return function(c, p) {
                    var f = p.orientation.m;
                    d.Vec3.set(a[0], 1, 0, 0);
                    d.Vec3.set(a[1], 0, 1, 0);
                    d.Vec3.set(a[2], 0, 0, 1);
                    d.Vec3.set(a[3], f[0], f[1], f[2]);
                    d.Vec3.set(a[4], f[3], f[4], f[5]);
                    d.Vec3.set(a[5], f[6], f[7], f[8]);
                    for (f = 0; 3 > f; ++f) d.Vec3.cross(a[3 * f + 6], a[f], a[0]), d.Vec3.cross(a[3 * f + 7], a[f], a[1]), d.Vec3.cross(a[3 * f + 7], a[f], a[2]);
                    d.Vec3.subtract(n, c.center, c.halfExtents);
                    d.Vec3.add(e, c.center, c.halfExtents);
                    d.Vec3.set(g[0], n.x, e.y, e.z);
                    d.Vec3.set(g[1], n.x, e.y, n.z);
                    d.Vec3.set(g[2], n.x, n.y, e.z);
                    d.Vec3.set(g[3], n.x, n.y, n.z);
                    d.Vec3.set(g[4], e.x, e.y, e.z);
                    d.Vec3.set(g[5], e.x, e.y, n.z);
                    d.Vec3.set(g[6], e.x, n.y, e.z);
                    d.Vec3.set(g[7], e.x, n.y, n.z);
                    b(p.center, p.halfExtents, a[3], a[4], a[5], l);
                    for (c = 0; 15 > c; ++c)
                        if (p = k(g, a[c]), f = k(l, a[c]), f[0] > p[1] || p[0] > f[1]) return 0;
                    return 1
                }
            }(),
            I = function(a, b) {
                var c = a.halfExtents.x * Math.abs(b.n.x) + a.halfExtents.y * Math.abs(b.n.y) + a.halfExtents.z * Math.abs(b.n.z);
                a = d.Vec3.dot(b.n, a.center);
                return a + c < b.d ? -1 : a - c > b.d ?
                    0 : 1
            },
            K = function(a, b) {
                for (var d = 0; d < b.planes.length; d++)
                    if (-1 === I(a, b.planes[d])) return 0;
                return 1
            },
            P = function() {
                for (var a = Array(8), b = 0, c = 0, g = 0; g < a.length; g++) a[g] = new d.Vec3(0, 0, 0);
                return function(g, l) {
                    for (var n, k = !1, e = 0; e < l.planes.length; e++) {
                        n = I(g, l.planes[e]);
                        if (-1 === n) return 0;
                        1 === n && (k = !0)
                    }
                    if (!k) return 1;
                    for (n = 0; n < l.vertices.length; n++) d.Vec3.subtract(a[n], l.vertices[n], g.center);
                    for (n = c = b = 0; n < l.vertices.length; n++) a[n].x > g.halfExtents.x ? b++ : a[n].x < -g.halfExtents.x && c++;
                    if (b === l.vertices.length ||
                        c === l.vertices.length) return 0;
                    for (n = c = b = 0; n < l.vertices.length; n++) a[n].y > g.halfExtents.y ? b++ : a[n].y < -g.halfExtents.y && c++;
                    if (b === l.vertices.length || c === l.vertices.length) return 0;
                    for (n = c = b = 0; n < l.vertices.length; n++) a[n].z > g.halfExtents.z ? b++ : a[n].z < -g.halfExtents.z && c++;
                    return b === l.vertices.length || c === l.vertices.length ? 0 : 1
                }
            }(),
            S = function() {
                var a = new d.Vec3(0, 0, 0),
                    b = new d.Mat3;
                return function(c, g) {
                    d.Vec3.subtract(a, g, c.center);
                    d.Vec3.transformMat3(a, a, d.Mat3.transpose(b, c.orientation));
                    c = c.halfExtents;
                    return Math.abs(a.x) < c.x && Math.abs(a.y) < c.y && Math.abs(a.z) < c.z
                }
            }(),
            M = function() {
                var a = function(a, b, d, c) {
                    return Math.abs(a.x * b + a.y * d + a.z * c)
                };
                return function(b, c) {
                    var g = b.orientation.m;
                    g = b.halfExtents.x * a(c.n, g[0], g[1], g[2]) + b.halfExtents.y * a(c.n, g[3], g[4], g[5]) + b.halfExtents.z * a(c.n, g[6], g[7], g[8]);
                    b = d.Vec3.dot(c.n, b.center);
                    return b + g < c.d ? -1 : b - g > c.d ? 0 : 1
                }
            }(),
            O = function(a, b) {
                for (var d = 0; d < b.planes.length; d++)
                    if (-1 === M(a, b.planes[d])) return 0;
                return 1
            },
            L = function() {
                for (var a = Array(8), b = 0, c = 0, g = 0, l = 0; l <
                    a.length; l++) a[l] = new d.Vec3(0, 0, 0);
                var n = function(a, b, d, c) {
                    return a.x * b + a.y * d + a.z * c
                };
                return function(l, k) {
                    for (var e, p = !1, f = 0; f < k.planes.length; f++) {
                        e = M(l, k.planes[f]);
                        if (-1 === e) return 0;
                        1 === e && (p = !0)
                    }
                    if (!p) return 1;
                    for (e = 0; e < k.vertices.length; e++) d.Vec3.subtract(a[e], k.vertices[e], l.center);
                    g = c = 0;
                    e = l.orientation.m;
                    for (p = 0; p < k.vertices.length; p++) b = n(a[p], e[0], e[1], e[2]), b > l.halfExtents.x ? c++ : b < -l.halfExtents.x && g++;
                    if (c === k.vertices.length || g === k.vertices.length) return 0;
                    for (p = g = c = 0; p < k.vertices.length; p++) b =
                        n(a[p], e[3], e[4], e[5]), b > l.halfExtents.y ? c++ : b < -l.halfExtents.y && g++;
                    if (c === k.vertices.length || g === k.vertices.length) return 0;
                    for (p = g = c = 0; p < k.vertices.length; p++) b = n(a[p], e[6], e[7], e[8]), b > l.halfExtents.z ? c++ : b < -l.halfExtents.z && g++;
                    return c === k.vertices.length || g === k.vertices.length ? 0 : 1
                }
            }(),
            U = function() {
                for (var a = Array(15), c = 0; 15 > c; c++) a[c] = new d.Vec3(0, 0, 0);
                var g = Array(8),
                    l = Array(8);
                for (c = 0; 8 > c; c++) g[c] = new d.Vec3(0, 0, 0), l[c] = new d.Vec3(0, 0, 0);
                return function(c, n) {
                    var e = c.orientation.m,
                        p = n.orientation.m;
                    d.Vec3.set(a[0], e[0], e[1], e[2]);
                    d.Vec3.set(a[1], e[3], e[4], e[5]);
                    d.Vec3.set(a[2], e[6], e[7], e[8]);
                    d.Vec3.set(a[3], p[0], p[1], p[2]);
                    d.Vec3.set(a[4], p[3], p[4], p[5]);
                    d.Vec3.set(a[5], p[6], p[7], p[8]);
                    for (e = 0; 3 > e; ++e) d.Vec3.cross(a[3 * e + 6], a[e], a[0]), d.Vec3.cross(a[3 * e + 7], a[e], a[1]), d.Vec3.cross(a[3 * e + 7], a[e], a[2]);
                    b(c.center, c.halfExtents, a[0], a[1], a[2], g);
                    b(n.center, n.halfExtents, a[3], a[4], a[5], l);
                    for (c = 0; 15 > c; ++c)
                        if (n = k(g, a[c]), e = k(l, a[c]), e[0] > n[1] || n[0] > e[1]) return 0;
                    return 1
                }
            }(),
            V = function(a, b) {
                var c =
                    d.Vec3.dot(b.n, a.center);
                a = a.radius * b.n.length();
                return c + a < b.d ? -1 : c - a > b.d ? 0 : 1
            },
            Z = function(a, b) {
                for (var d = 0; d < b.planes.length; d++)
                    if (-1 === V(a, b.planes[d])) return 0;
                return 1
            },
            da = function() {
                var a = new d.Vec3(0, 0, 0),
                    b = [1, -1, 1, -1, 1, -1];
                return function(c, g) {
                    for (var l = 0; 6 > l; l++) {
                        var n = g.planes[l],
                            k = c.radius,
                            e = c.center,
                            p = n.n;
                        n = n.d;
                        var f = d.Vec3.dot(p, e);
                        if (f + k < n) return 0;
                        if (!(f - k > n))
                            for (d.Vec3.add(a, e, d.Vec3.multiplyScalar(a, p, k)), k = 0; 6 > k; k++)
                                if (k !== l && k !== l + b[l] && (e = g.planes[k], d.Vec3.dot(e.n, a) < e.d)) return 0
                    }
                    return 1
                }
            }(),
            Q = function(a, b) {
                var c = a.radius + b.radius;
                return d.Vec3.squaredDistance(a.center, b.center) < c * c
            },
            R = function() {
                var a = new d.Vec3;
                return function(b, c) {
                    g.pt_point_aabb(a, b.center, c);
                    return d.Vec3.squaredDistance(b.center, a) < b.radius * b.radius
                }
            }(),
            fa = function() {
                var a = new d.Vec3;
                return function(b, c) {
                    g.pt_point_obb(a, b.center, c);
                    return d.Vec3.squaredDistance(b.center, a) < b.radius * b.radius
                }
            }();
        p = {
            rayAabb: C,
            rayMesh: p,
            raycast: u,
            rayTriangle: B,
            ray_sphere: z,
            ray_aabb: x,
            ray_obb: G,
            ray_plane: h,
            ray_triangle: A,
            line_plane: v,
            line_triangle: E,
            line_quad: y,
            sphere_sphere: Q,
            sphere_aabb: R,
            sphere_obb: fa,
            sphere_plane: V,
            sphere_frustum: Z,
            sphere_frustum_accurate: da,
            aabb_aabb: F,
            aabb_obb: H,
            aabb_plane: I,
            aabb_frustum: K,
            aabb_frustum_accurate: P,
            obb_obb: U,
            obb_plane: M,
            obb_frustum: O,
            obb_frustum_accurate: L,
            obb_point: S,
            resolve: function(a, b, d) {
                void 0 === d && (d = null);
                var c = a._type,
                    g = b._type,
                    l = this[c | g];
                return c < g ? l(a, b, d) : l(b, a, d)
            }
        };
        p[n["default"].SHAPE_RAY | n["default"].SHAPE_SPHERE] = z;
        p[n["default"].SHAPE_RAY | n["default"].SHAPE_AABB] = x;
        p[n["default"].SHAPE_RAY |
            n["default"].SHAPE_OBB] = G;
        p[n["default"].SHAPE_RAY | n["default"].SHAPE_PLANE] = h;
        p[n["default"].SHAPE_RAY | n["default"].SHAPE_TRIANGLE] = A;
        p[n["default"].SHAPE_LINE | n["default"].SHAPE_PLANE] = v;
        p[n["default"].SHAPE_LINE | n["default"].SHAPE_TRIANGLE] = E;
        p[n["default"].SHAPE_SPHERE] = Q;
        p[n["default"].SHAPE_SPHERE | n["default"].SHAPE_AABB] = R;
        p[n["default"].SHAPE_SPHERE | n["default"].SHAPE_OBB] = fa;
        p[n["default"].SHAPE_SPHERE | n["default"].SHAPE_PLANE] = V;
        p[n["default"].SHAPE_SPHERE | n["default"].SHAPE_FRUSTUM] = Z;
        p[n["default"].SHAPE_SPHERE | n["default"].SHAPE_FRUSTUM_ACCURATE] = da;
        p[n["default"].SHAPE_AABB] = F;
        p[n["default"].SHAPE_AABB | n["default"].SHAPE_OBB] = H;
        p[n["default"].SHAPE_AABB | n["default"].SHAPE_PLANE] = I;
        p[n["default"].SHAPE_AABB | n["default"].SHAPE_FRUSTUM] = K;
        p[n["default"].SHAPE_AABB | n["default"].SHAPE_FRUSTUM_ACCURATE] = P;
        p[n["default"].SHAPE_OBB] = U;
        p[n["default"].SHAPE_OBB | n["default"].SHAPE_PLANE] = M;
        p[n["default"].SHAPE_OBB | n["default"].SHAPE_FRUSTUM] = O;
        p[n["default"].SHAPE_OBB | n["default"].SHAPE_FRUSTUM_ACCURATE] =
            L;
        m["default"] = p;
        q.exports = m["default"]
    }, {
        "../../renderer/gfx": 334,
        "../../renderer/memop/recycle-pool": 349,
        "../value-types": 301,
        "./aabb": 155,
        "./distance": 156,
        "./enums": 157,
        "./ray": 164,
        "./triangle": 166
    }],
    161: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        var f = h("../value-types"),
            e = function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("./enums"));
        h = function() {
            function b(b, c, a, d, l, g) {
                void 0 === b && (b = 0);
                void 0 === c && (c = 0);
                void 0 === a && (a = 0);
                void 0 === d && (d = 0);
                void 0 === l && (l = 0);
                void 0 === g && (g = -1);
                this._type =
                    this.e = this.s = void 0;
                this._type = e["default"].SHAPE_LINE;
                this.s = new f.Vec3(b, c, a);
                this.e = new f.Vec3(d, l, g)
            }
            b.create = function(k, c, a, d, l, g) {
                return new b(k, c, a, d, l, g)
            };
            b.clone = function(k) {
                return new b(k.s.x, k.s.y, k.s.z, k.e.x, k.e.y, k.e.z)
            };
            b.copy = function(b, c) {
                f.Vec3.copy(b.s, c.s);
                f.Vec3.copy(b.e, c.e);
                return b
            };
            b.fromPoints = function(b, c, a) {
                f.Vec3.copy(b.s, c);
                f.Vec3.copy(b.e, a);
                return b
            };
            b.set = function(b, c, a, d, l, g, n) {
                b.s.x = c;
                b.s.y = a;
                b.s.z = d;
                b.e.x = l;
                b.e.y = g;
                b.e.z = n;
                return b
            };
            b.len = function(b) {
                return f.Vec3.distance(b.s,
                    b.e)
            };
            b.prototype.length = function() {
                return f.Vec3.distance(this.s, this.e)
            };
            return b
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../value-types": 301,
        "./enums": 157
    }],
    162: [function(h, q, m) {
        function f(a, b) {
            for (var d = 0; d < b.length; d++) {
                var c = b[d];
                c.enumerable = c.enumerable || !1;
                c.configurable = !0;
                "value" in c && (c.writable = !0);
                Object.defineProperty(a, c.key, c)
            }
        }

        function e(a, b, d) {
            b && f(a.prototype, b);
            d && f(a, d);
            return a
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var b = h("../value-types"),
            k = function(a) {
                return a && a.__esModule ?
                    a : {
                        default: a
                    }
            }(h("./enums")),
            c = new b.Vec3,
            a = new b.Vec3,
            d = new b.Mat3;
        h = function() {
            function l(a, d, c, g, l, e, f, h, E, y, z, x, m, G, F) {
                void 0 === a && (a = 0);
                void 0 === d && (d = 0);
                void 0 === c && (c = 0);
                void 0 === g && (g = 1);
                void 0 === l && (l = 1);
                void 0 === e && (e = 1);
                void 0 === f && (f = 1);
                void 0 === h && (h = 0);
                void 0 === E && (E = 0);
                void 0 === y && (y = 0);
                void 0 === z && (z = 1);
                void 0 === x && (x = 0);
                void 0 === m && (m = 0);
                void 0 === G && (G = 0);
                void 0 === F && (F = 1);
                this._type = this.orientation = this.halfExtents = this.center = void 0;
                this._type = k["default"].SHAPE_OBB;
                this.center =
                    new b.Vec3(a, d, c);
                this.halfExtents = new b.Vec3(g, l, e);
                this.orientation = new b.Mat3(f, h, E, y, z, x, m, G, F)
            }
            l.create = function(a, b, d, c, g, k, e, f, h, y, z, x, m, G, F) {
                return new l(a, b, d, c, g, k, e, f, h, y, z, x, m, G, F)
            };
            l.clone = function(a) {
                var b = a.orientation.m;
                return new l(a.center.x, a.center.y, a.center.z, a.halfExtents.x, a.halfExtents.y, a.halfExtents.z, b[0], b[1], b[2], b[3], b[4], b[5], b[6], b[7], b[8])
            };
            l.copy = function(a, d) {
                b.Vec3.copy(a.center, d.center);
                b.Vec3.copy(a.halfExtents, d.halfExtents);
                b.Mat3.copy(a.orientation, d.orientation);
                return a
            };
            l.fromPoints = function(d, g, l) {
                b.Vec3.multiplyScalar(d.center, b.Vec3.add(c, g, l), .5);
                b.Vec3.multiplyScalar(d.halfExtents, b.Vec3.subtract(a, l, g), .5);
                b.Mat3.identity(d.orientation);
                return d
            };
            l.set = function(a, d, c, g, l, k, e, f, h, y, z, x, m, G, F, q) {
                b.Vec3.set(a.center, d, c, g);
                b.Vec3.set(a.halfExtents, l, k, e);
                b.Mat3.set(a.orientation, f, h, y, z, x, m, G, F, q);
                return a
            };
            e(l, [{
                key: "type",
                get: function() {
                    return this._type
                }
            }]);
            var g = l.prototype;
            g.getBoundary = function(a, g) {
                var l = this.halfExtents,
                    n = d.m,
                    k = this.orientation.m;
                n[0] = Math.abs(k[0]);
                n[1] = Math.abs(k[1]);
                n[2] = Math.abs(k[2]);
                n[3] = Math.abs(k[3]);
                n[4] = Math.abs(k[4]);
                n[5] = Math.abs(k[5]);
                n[6] = Math.abs(k[6]);
                n[7] = Math.abs(k[7]);
                n[8] = Math.abs(k[8]);
                b.Vec3.transformMat3(c, l, d);
                b.Vec3.subtract(a, this.center, c);
                b.Vec3.add(g, this.center, c)
            };
            g.transform = function(a, d, c, g, l) {
                b.Vec3.transformMat4(l.center, this.center, a);
                b.Mat3.fromQuat(l.orientation, c);
                b.Vec3.multiply(l.halfExtents, this.halfExtents, g)
            };
            g.translateAndRotate = function(a, d, c) {
                b.Vec3.transformMat4(c.center, this.center,
                    a);
                b.Mat3.fromQuat(c.orientation, d)
            };
            g.setScale = function(a, d) {
                b.Vec3.multiply(d.halfExtents, this.halfExtents, a)
            };
            return l
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../value-types": 301,
        "./enums": 157
    }],
    163: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        var f = h("../value-types"),
            e = function(a) {
                return a && a.__esModule ? a : {
                    default: a
                }
            }(h("./enums")),
            b = new f.Vec3(0, 0, 0),
            k = new f.Vec3(0, 0, 0),
            c = cc.mat4(),
            a = cc.v4();
        h = function() {
            function d(a, b, d, c) {
                void 0 === a && (a = 0);
                void 0 === b && (b = 1);
                void 0 === d && (d = 0);
                void 0 ===
                    c && (c = 0);
                this._type = this.d = this.n = void 0;
                this._type = e["default"].SHAPE_PLANE;
                this.n = new f.Vec3(a, b, d);
                this.d = c
            }
            d.create = function(a, b, c, k) {
                return new d(a, b, c, k)
            };
            d.clone = function(a) {
                return new d(a.n.x, a.n.y, a.n.z, a.d)
            };
            d.copy = function(a, b) {
                f.Vec3.copy(a.n, b.n);
                a.d = b.d;
                return a
            };
            d.fromPoints = function(a, d, c, e) {
                f.Vec3.subtract(b, c, d);
                f.Vec3.subtract(k, e, d);
                f.Vec3.normalize(a.n, f.Vec3.cross(a.n, b, k));
                a.d = f.Vec3.dot(a.n, d);
                return a
            };
            d.set = function(a, b, d, c, k) {
                a.n.x = b;
                a.n.y = d;
                a.n.z = c;
                a.d = k;
                return a
            };
            d.fromNormalAndPoint =
                function(a, b, d) {
                    f.Vec3.copy(a.n, b);
                    a.d = f.Vec3.dot(b, d);
                    return a
                };
            d.normalize = function(a, b) {
                var d = b.n.len();
                f.Vec3.normalize(a.n, b.n);
                0 < d && (a.d = b.d / d);
                return a
            };
            d.prototype.transform = function(b) {
                f.Mat4.invert(c, b);
                f.Mat4.transpose(c, c);
                f.Vec4.set(a, this.n.x, this.n.y, this.n.z, this.d);
                f.Vec4.transformMat4(a, a, c);
                f.Vec3.set(this.n, a.x, a.y, a.z);
                this.d = a.w
            };
            return d
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../value-types": 301,
        "./enums": 157
    }],
    164: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        var f =
            h("../value-types"),
            e = function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("./enums"));
        h = function() {
            function b(b, c, a, d, l, g) {
                void 0 === b && (b = 0);
                void 0 === c && (c = 0);
                void 0 === a && (a = 0);
                void 0 === d && (d = 0);
                void 0 === l && (l = 0);
                void 0 === g && (g = -1);
                this._type = this.d = this.o = void 0;
                this._type = e["default"].SHAPE_RAY;
                this.o = new f.Vec3(b, c, a);
                this.d = new f.Vec3(d, l, g)
            }
            b.create = function(k, c, a, d, l, g) {
                void 0 === k && (k = 0);
                void 0 === c && (c = 0);
                void 0 === a && (a = 0);
                void 0 === d && (d = 0);
                void 0 === l && (l = 0);
                void 0 === g && (g = 1);
                return new b(k,
                    c, a, d, l, g)
            };
            b.clone = function(k) {
                return new b(k.o.x, k.o.y, k.o.z, k.d.x, k.d.y, k.d.z)
            };
            b.copy = function(b, c) {
                f.Vec3.copy(b.o, c.o);
                f.Vec3.copy(b.d, c.d);
                return b
            };
            b.fromPoints = function(b, c, a) {
                f.Vec3.copy(b.o, c);
                f.Vec3.normalize(b.d, f.Vec3.subtract(b.d, a, c));
                return b
            };
            b.set = function(b, c, a, d, l, g, n) {
                b.o.x = c;
                b.o.y = a;
                b.o.z = d;
                b.d.x = l;
                b.d.y = g;
                b.d.z = n;
                return b
            };
            b.prototype.computeHit = function(b, c) {
                f.Vec3.normalize(b, this.d);
                f.Vec3.scaleAndAdd(b, this.o, b, c)
            };
            return b
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../value-types": 301,
        "./enums": 157
    }],
    165: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        var f = h("../value-types"),
            e = function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("./enums")),
            b = new f.Vec3;
        h = function() {
            function k(a, b, c, g) {
                void 0 === a && (a = 0);
                void 0 === b && (b = 0);
                void 0 === c && (c = 0);
                void 0 === g && (g = 1);
                this._type = this.radius = this.center = void 0;
                this._type = e["default"].SHAPE_SPHERE;
                this.center = new f.Vec3(a, b, c);
                this.radius = g
            }
            k.create = function(a, b, c, g) {
                return new k(a, b, c, g)
            };
            k.clone = function(a) {
                return new k(a.center.x, a.center.y,
                    a.center.z, a.radius)
            };
            k.copy = function(a, b) {
                f.Vec3.copy(a.center, b.center);
                a.radius = b.radius;
                return a
            };
            k.fromPoints = function(a, d, c) {
                f.Vec3.multiplyScalar(a.center, f.Vec3.add(b, d, c), .5);
                a.radius = .5 * f.Vec3.subtract(b, c, d).len();
                return a
            };
            k.set = function(a, b, c, g, n) {
                a.center.x = b;
                a.center.y = c;
                a.center.z = g;
                a.radius = n;
                return a
            };
            var c = k.prototype;
            c.clone = function() {
                return k.clone(this)
            };
            c.copy = function(a) {
                return k.copy(this, a)
            };
            c.getBoundary = function(a, b) {
                f.Vec3.set(a, this.center.x - this.radius, this.center.y -
                    this.radius, this.center.z - this.radius);
                f.Vec3.set(b, this.center.x + this.radius, this.center.y + this.radius, this.center.z + this.radius)
            };
            c.transform = function(a, b, c, g, n) {
                f.Vec3.transformMat4(n.center, this.center, a);
                n.radius = this.radius * g.maxAxis()
            };
            c.translateAndRotate = function(a, b, c) {
                f.Vec3.transformMat4(c.center, this.center, a)
            };
            c.setScale = function(a, b) {
                b.radius = this.radius * a.maxAxis()
            };
            return k
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../value-types": 301,
        "./enums": 157
    }],
    166: [function(h, q, m) {
        function f(b) {
            return b &&
                b.__esModule ? b : {
                    default: b
                }
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = f(h("../value-types/vec3")),
            b = f(h("./enums"));
        h = function() {
            function k(c, a, d, l, g, n, k, f, p) {
                this._type = this.c = this.b = this.a = void 0;
                this.a = new e["default"](c, a, d);
                this.b = new e["default"](l, g, n);
                this.c = new e["default"](k, f, p);
                this._type = b["default"].SHAPE_TRIANGLE
            }
            k.create = function(b, a, d, l, g, n, e, f, p) {
                return new k(b, a, d, l, g, n, e, f, p)
            };
            k.clone = function(b) {
                return new k(b.a.x, b.a.y, b.a.z, b.b.x, b.b.y, b.b.z, b.c.x, b.c.y, b.c.z)
            };
            k.copy = function(b,
                a) {
                e["default"].copy(b.a, a.a);
                e["default"].copy(b.b, a.b);
                e["default"].copy(b.c, a.c);
                return b
            };
            k.fromPoints = function(b, a, d, l) {
                e["default"].copy(b.a, a);
                e["default"].copy(b.b, d);
                e["default"].copy(b.c, l);
                return b
            };
            k.set = function(b, a, d, l, g, n, e, k, p, f) {
                b.a.x = a;
                b.a.y = d;
                b.a.z = l;
                b.b.x = g;
                b.b.y = n;
                b.b.z = e;
                b.c.x = k;
                b.c.y = p;
                b.c.z = f;
                return b
            };
            return k
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../value-types/vec3": 311,
        "./enums": 157
    }],
    167: [function(h, q, m) {
        m = h("../components/CCRenderComponent");
        var f = h("../assets/material/CCMaterial"),
            e = h("./types"),
            b = e.LineCap,
            k = e.LineJoin,
            c = cc.Class({
                name: "cc.Graphics",
                extends: m,
                editor: !1,
                ctor: function() {
                    this._impl = new c._Impl(this)
                },
                properties: {
                    _lineWidth: 2,
                    _strokeColor: cc.Color.BLACK,
                    _lineJoin: k.MITER,
                    _lineCap: b.BUTT,
                    _fillColor: cc.Color.WHITE,
                    _miterLimit: 10,
                    lineWidth: {
                        get: function() {
                            return this._lineWidth
                        },
                        set: function(a) {
                            this._lineWidth = a;
                            this._impl.lineWidth = a
                        }
                    },
                    lineJoin: {
                        get: function() {
                            return this._lineJoin
                        },
                        set: function(a) {
                            this._lineJoin = a;
                            this._impl.lineJoin = a
                        },
                        type: k
                    },
                    lineCap: {
                        get: function() {
                            return this._lineCap
                        },
                        set: function(a) {
                            this._lineCap = a;
                            this._impl.lineCap = a
                        },
                        type: b
                    },
                    strokeColor: {
                        get: function() {
                            return this._strokeColor
                        },
                        set: function(a) {
                            this._impl.strokeColor = this._strokeColor = cc.color(a)
                        }
                    },
                    fillColor: {
                        get: function() {
                            return this._fillColor
                        },
                        set: function(a) {
                            this._impl.fillColor = this._fillColor = cc.color(a)
                        }
                    },
                    miterLimit: {
                        get: function() {
                            return this._miterLimit
                        },
                        set: function(a) {
                            this._miterLimit = a;
                            this._impl.miterLimit = a
                        }
                    }
                },
                statics: {
                    LineJoin: k,
                    LineCap: b
                },
                onRestore: function() {
                    this._impl || (this._impl = new c._Impl(this))
                },
                onDestroy: function() {
                    this.clear(!0);
                    this._super();
                    this._impl = null
                },
                _getDefaultMaterial: function() {
                    return f.getBuiltinMaterial("2d-graphics")
                },
                _updateMaterial: function() {
                    var a = this._materials[0];
                    a && (void 0 !== a.getDefine("CC_USE_MODEL") && a.define("CC_USE_MODEL", !0), void 0 !== a.getDefine("CC_SUPPORT_standard_derivatives") && cc.sys.glExtension("OES_standard_derivatives") && a.define("CC_SUPPORT_standard_derivatives", !0))
                },
                moveTo: function(a, b) {
                    (!0, a instanceof cc.Vec2) ? cc.warn("[moveTo] : Can not pass Vec2 as [x, y] value, please check it."):
                        this._impl.moveTo(a, b)
                },
                lineTo: function(a, b) {
                    (!0, a instanceof cc.Vec2) ? cc.warn("[moveTo] : Can not pass Vec2 as [x, y] value, please check it."): this._impl.lineTo(a, b)
                },
                bezierCurveTo: function(a, b, c, g, n, e) {
                    this._impl.bezierCurveTo(a, b, c, g, n, e)
                },
                quadraticCurveTo: function(a, b, c, g) {
                    this._impl.quadraticCurveTo(a, b, c, g)
                },
                arc: function(a, b, c, g, n, e) {
                    this._impl.arc(a, b, c, g, n, e)
                },
                ellipse: function(a, b, c, g) {
                    this._impl.ellipse(a, b, c, g)
                },
                circle: function(a, b, c) {
                    this._impl.circle(a, b, c)
                },
                rect: function(a, b, c, g) {
                    this._impl.rect(a,
                        b, c, g)
                },
                roundRect: function(a, b, c, g, n) {
                    this._impl.roundRect(a, b, c, g, n)
                },
                fillRect: function(a, b, c, g) {
                    this.rect(a, b, c, g);
                    this.fill()
                },
                clear: function(a) {
                    this._impl.clear(a);
                    this._assembler && this._assembler.clear(a)
                },
                close: function() {
                    this._impl.close()
                },
                stroke: function() {
                    this._assembler || this._resetAssembler();
                    this._assembler.stroke(this)
                },
                fill: function() {
                    this._assembler || this._resetAssembler();
                    this._assembler.fill(this)
                }
            });
        cc.Graphics = q.exports = c;
        cc.Graphics.Types = e;
        cc.Graphics.Helper = h("./helper")
    }, {
        "../assets/material/CCMaterial": 91,
        "../components/CCRenderComponent": 126,
        "./helper": 168,
        "./types": 170
    }],
    168: [function(h, q, m) {
        function f(a, b, d, c, g, k, h, B, E, y, z) {
            if (!(10 < y)) {
                var n = .5 * (b + c);
                var p = .5 * (d + g);
                var t = .5 * (c + k);
                var u = .5 * (g + h);
                var v = .5 * (k + B);
                var w = .5 * (h + E);
                var A = .5 * (n + t);
                var m = .5 * (p + u);
                var q = B - b;
                var M = E - d;
                c = l((c - B) * M - (g - E) * q);
                k = l((k - B) * M - (h - E) * q);
                (c + k) * (c + k) < a._tessTol * (q * q + M * M) ? a._addPoint(B, E, 0 === z ? z | e.PT_BEVEL : z) : (t = .5 * (t + v), u = .5 * (u + w), q = .5 * (A + t), M = .5 * (m + u), f(a, b, d, n, p, A, m, q, M, y + 1, 0), f(a, q, M, t, u, v, w, B, E, y + 1, z))
            }
        }
        var e = h("./types").PointFlags,
            b = Math.PI,
            k = Math.min,
            c = Math.max,
            a = Math.cos,
            d = Math.sin,
            l = Math.abs,
            g = Math.sign;
        q.exports = {
            arc: function(g, e, f, p, h, v, A) {
                A = A || !1;
                var n = 0,
                    t = 0,
                    u = 0,
                    w = 0;
                v -= h;
                if (A)
                    if (l(v) >= 2 * b) v = 2 * b;
                    else
                        for (; 0 > v;) v += 2 * b;
                else if (l(v) >= 2 * b) v = 2 * -b;
                else
                    for (; 0 < v;) v -= 2 * b;
                var x = 0 | c(1, k(l(v) / (.5 * b) + .5, 5));
                var m = v / x / 2;
                m = l(4 / 3 * (1 - a(m)) / d(m));
                A || (m = -m);
                for (A = 0; A <= x; A++) {
                    var G = h + A / x * v;
                    var F = a(G);
                    var q = d(G);
                    G = e + F * p;
                    var I = f + q * p;
                    q = -q * p * m;
                    F = F * p * m;
                    0 === A ? g.moveTo(G, I) : g.bezierCurveTo(n + u, t + w, G - q, I - F, G, I);
                    n = G;
                    t = I;
                    u = q;
                    w = F
                }
            },
            ellipse: function(a,
                b, d, c, g) {
                a.moveTo(b - c, d);
                a.bezierCurveTo(b - c, d + .5522847493 * g, b - .5522847493 * c, d + g, b, d + g);
                a.bezierCurveTo(b + .5522847493 * c, d + g, b + c, d + .5522847493 * g, b + c, d);
                a.bezierCurveTo(b + c, d - .5522847493 * g, b + .5522847493 * c, d - g, b, d - g);
                a.bezierCurveTo(b - .5522847493 * c, d - g, b - c, d - .5522847493 * g, b - c, d);
                a.close()
            },
            roundRect: function(a, b, d, c, e, f) {
                if (.1 > f) a.rect(b, d, c, e);
                else {
                    var n = k(f, .5 * l(c)) * g(c);
                    f = k(f, .5 * l(e)) * g(e);
                    a.moveTo(b, d + f);
                    a.lineTo(b, d + e - f);
                    a.bezierCurveTo(b, d + e - f * (1 - .5522847493), b + n * (1 - .5522847493), d + e, b + n, d + e);
                    a.lineTo(b +
                        c - n, d + e);
                    a.bezierCurveTo(b + c - n * (1 - .5522847493), d + e, b + c, d + e - f * (1 - .5522847493), b + c, d + e - f);
                    a.lineTo(b + c, d + f);
                    a.bezierCurveTo(b + c, d + f * (1 - .5522847493), b + c - n * (1 - .5522847493), d, b + c - n, d);
                    a.lineTo(b + n, d);
                    a.bezierCurveTo(b + n * (1 - .5522847493), d, b, d + f * (1 - .5522847493), b, d + f);
                    a.close()
                }
            },
            tesselateBezier: f
        }
    }, {
        "./types": 170
    }],
    169: [function(h, q, m) {
        h("./graphics")
    }, {
        "./graphics": 167
    }],
    170: [function(h, q, m) {
        h = cc.Enum({
            BUTT: 0,
            ROUND: 1,
            SQUARE: 2
        });
        m = cc.Enum({
            BEVEL: 0,
            ROUND: 1,
            MITER: 2
        });
        var f = cc.Enum({
            PT_CORNER: 1,
            PT_LEFT: 2,
            PT_BEVEL: 4,
            PT_INNERBEVEL: 8
        });
        q.exports = {
            LineCap: h,
            LineJoin: m,
            PointFlags: f
        }
    }, {}],
    171: [function(h, q, m) {
        h("./platform");
        h("./assets");
        !0;
        h("./CCNode");
        h("./CCPrivateNode");
        h("./CCScene");
        h("./components");
        h("./graphics");
        h("./collider");
        h("./collider/CCIntersection");
        h("./physics");
        h("./camera/CCCamera");
        h("./geom-utils");
        h("./mesh");
        h("./3d");
        h("./base-ui/CCWidgetManager")
    }, {
        "./3d": 30,
        "./CCNode": 40,
        "./CCPrivateNode": 41,
        "./CCScene": 42,
        "./assets": 89,
        "./base-ui/CCWidgetManager": 100,
        "./camera/CCCamera": 101,
        "./collider": 109,
        "./collider/CCIntersection": 107,
        "./components": 143,
        "./geom-utils": 159,
        "./graphics": 169,
        "./mesh": 174,
        "./physics": 189,
        "./platform": 222
    }],
    172: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, b, d) {
            a[b] = d._val
        }

        function b(a, b, d) {
            a[b] = d.x;
            a[b + 1] = d.y
        }

        function k(a, b, d) {
            a[b] = d.x;
            a[b + 1] = d.y;
            a[b + 2] = d.z
        }
        var c = f(h("../../renderer/core/input-assembler")),
            a = f(h("../../renderer/gfx")),
            d = h("./mesh-data"),
            l = h("../renderer");
        h = h("../event/event-target");
        var g = {
                5120: "getInt8",
                5121: "getUint8",
                5122: "getInt16",
                5123: "getUint16",
                5124: "getInt32",
                5125: "getUint32",
                5126: "getFloat32"
            },
            n = {
                5120: "setInt8",
                5121: "setUint8",
                5122: "setInt16",
                5123: "setUint16",
                5124: "setInt32",
                5125: "setUint32",
                5126: "setFloat32"
            },
            w = function() {
                var a = new ArrayBuffer(2);
                (new DataView(a)).setInt16(0, 256, !0);
                return 256 === (new Int16Array(a))[0]
            }();
        h = cc.Class({
            name: "cc.Mesh",
            extends: cc.Asset,
            mixins: [h],
            properties: {
                _nativeAsset: {
                    override: !0,
                    get: function() {
                        return this._buffer
                    },
                    set: function(a) {
                        this._buffer = ArrayBuffer.isView(a) ?
                            a.buffer : a;
                        this.initWithBuffer()
                    }
                },
                _vertexBundles: {
                    default: null,
                    type: d.VertexBundle
                },
                _primitives: {
                    default: null,
                    Primitive: d.Primitive
                },
                _minPos: cc.v3(),
                _maxPos: cc.v3(),
                subMeshes: {
                    get: function() {
                        return this._subMeshes
                    },
                    set: function(a) {
                        this._subMeshes = a
                    }
                },
                subDatas: {
                    get: function() {
                        return this._subDatas
                    }
                }
            },
            ctor: function() {
                this._subMeshes = [];
                this._subDatas = [];
                this.loaded = !1
            },
            initWithBuffer: function() {
                this._subMeshes.length = 0;
                for (var b = this._primitives, g = 0; g < b.length; g++) {
                    var e = b[g],
                        n = e.data;
                    n = new Uint8Array(this._buffer,
                        n.offset, n.length);
                    var k = this._vertexBundles[e.vertexBundleIndices[0]],
                        f = k.data;
                    k = new a["default"].VertexFormat(k.formats);
                    var h = new Uint8Array(this._buffer, f.offset, f.length),
                        w = this._canVertexFormatBatch(k),
                        z = new d.MeshData;
                    z.vData = h;
                    z.iData = n;
                    z.vfm = k;
                    z.offset = f.offset;
                    z.canBatch = w;
                    this._subDatas.push(z);
                    !1;
                    f = new a["default"].VertexBuffer(l.device, k, a["default"].USAGE_STATIC, h);
                    e = new a["default"].IndexBuffer(l.device, e.indexUnit, a["default"].USAGE_STATIC, n);
                    this._subMeshes.push(new c["default"](f,
                        e))
                }
                this.loaded = !0;
                this.emit("load")
            },
            _canVertexFormatBatch: function(b) {
                var d = b._attr2el[a["default"].ATTR_POSITION];
                return !d || d.type === a["default"].ATTR_TYPE_FLOAT32 && 0 === b._bytes % 4
            },
            init: function(b, g, e, n) {
                void 0 === e && (e = !1);
                void 0 === n && (n = 0);
                var k = new Uint8Array(b._bytes * g);
                g = new d.MeshData;
                g.vData = k;
                g.vfm = b;
                g.vDirty = !0;
                g.canBatch = this._canVertexFormatBatch(b);
                !0;
                b = new a["default"].VertexBuffer(l.device, b, e ? a["default"].USAGE_DYNAMIC : a["default"].USAGE_STATIC, k);
                g.vb = b;
                this._subMeshes[n] = new c["default"](g.vb);
                if (b = this._subDatas[n]) b.vb && b.vb.destroy(), b.ib && b.ib.destroy();
                this._subDatas[n] = g;
                this.loaded = !0;
                this.emit("load");
                this.emit("init-format")
            },
            setVertices: function(d, c, g) {
                g = this._subDatas[g || 0];
                var l = g.vfm.element(d);
                if (!l) return cc.warn("Cannot find " + d + " attribute in vertex defines.");
                var n = "number" === typeof c[0],
                    p = l.num,
                    f = n ? c.length / p | 0 : c.length;
                g.vData.byteLength < f * l.stride && g.setVData(new Uint8Array(f * g.vfm._bytes));
                var h = 4;
                d === a["default"].ATTR_COLOR ? n ? (f = g.getVData(), h = 1) : f = g.getVData(Uint32Array) :
                    f = g.getVData(Float32Array);
                var t = l.stride / h;
                l = l.offset / h;
                if (n)
                    for (d = 0, n = c.length / p; d < n; d++) {
                        h = d * p;
                        for (var u = d * t + l, w = 0; w < p; w++) f[u + w] = c[h + w]
                    } else
                        for (p = d === a["default"].ATTR_COLOR ? e : 2 === p ? b : k, d = 0, n = c.length; d < n; d++) p(f, d * t + l, c[d]);
                g.vDirty = !0
            },
            setIndices: function(b, d, c) {
                d = d || 0;
                var g = b;
                b instanceof Uint16Array ? g = new Uint8Array(b.buffer, b.byteOffset, b.byteLength) : Array.isArray(b) && (g = new Uint16Array(b), g = new Uint8Array(g.buffer, g.byteOffset, g.byteLength));
                c = c ? a["default"].USAGE_DYNAMIC : a["default"].USAGE_STATIC;
                b = this._subDatas[d];
                b.ib ? (b.iData = g, b.iDirty = !0) : (b.iData = g, !0, g = new a["default"].IndexBuffer(l.device, a["default"].INDEX_FMT_UINT16, c, g, g.byteLength / a["default"].IndexBuffer.BYTES_PER_INDEX[a["default"].INDEX_FMT_UINT16]), b.ib = g, this._subMeshes[d]._indexBuffer = b.ib)
            },
            setPrimitiveType: function(a, b) {
                b = b || 0;
                this._subMeshes[b] ? this._subMeshes[b]._primitiveType = a : cc.warn("Do not have sub mesh at index " + b)
            },
            clear: function() {
                this._subMeshes.length = 0;
                for (var a = this._subDatas, b = 0, d = a.length; b < d; b++) {
                    var c =
                        a[b].vb;
                    c && c.destroy();
                    (c = a[b].ib) && c.destroy()
                }
                a.length = 0
            },
            setBoundingBox: function(a, b) {
                this._minPos = a;
                this._maxPos = b
            },
            destroy: function() {
                this.clear()
            },
            _uploadData: function() {
                for (var a = this._subDatas, b = 0, d = a.length; b < d; b++) {
                    var c = a[b];
                    c.vDirty && (c.vb.update(0, c.vData), c.vDirty = !1);
                    c.iDirty && (c.ib.update(0, c.iData), c.iDirty = !1)
                }
            },
            _getAttrMeshData: function(a, b) {
                var d = this._subDatas[a];
                if (!d) return [];
                var c = d.vfm,
                    l = c.element(b);
                if (!l) return [];
                d.attrDatas || (d.attrDatas = {});
                var e = d.attrDatas;
                if (a = e[b]) return a;
                a = e[b] = [];
                var n = d.vData;
                b = new DataView(n.buffer, n.byteOffset, n.byteLength);
                d = l.stride;
                e = l.offset;
                var k = l.num,
                    p = l.bytes / k;
                l = g[l.type];
                c = n.byteLength / c._bytes;
                for (n = 0; n < c; n++)
                    for (var f = n * d + e, h = 0; h < k; h++) {
                        var t = b[l](f + h * p, w);
                        a.push(t)
                    }
                return a
            },
            copyAttribute: function(a, b, d, c, g) {
                var l = !1,
                    e = this._subDatas[a];
                if (!e) return l;
                var k = e.vfm,
                    p = k.element(b);
                if (!p) return l;
                var f = n[p.type];
                if (!f) return l;
                a = this._getAttrMeshData(a, b);
                e = e.vData.byteLength / k._bytes;
                k = p.bytes / p.num;
                if (0 < a.length) {
                    d = new DataView(d, g);
                    p = p.num;
                    for (g = 0; g < e; ++g)
                        for (l = g * p, b = 0; b < p; ++b) d[f](c * g + k * b, a[l + b], w);
                    l = !0
                }
                return l
            },
            copyIndices: function(b, d) {
                b = this._subDatas[b];
                if (!b) return !1;
                var c = b.iData;
                b = c.length / 2;
                c = new DataView(c.buffer, c.byteOffset, c.byteLength);
                for (var l = g[a["default"].INDEX_FMT_UINT8], e = 0; e < b; ++e) d[e] = c[l](2 * e);
                return !0
            }
        });
        cc.Mesh = q.exports = h
    }, {
        "../../renderer/core/input-assembler": 324,
        "../../renderer/gfx": 334,
        "../event/event-target": 151,
        "../renderer": 236,
        "./mesh-data": 175
    }],
    173: [function(h, q, m) {
        function f(a) {
            return a &&
                a.__esModule ? a : {
                    default: a
                }
        }
        var e = f(h("../../renderer/gfx")),
            b = f(h("../../renderer/core/input-assembler")),
            k = f(h("../geom-utils/aabb")),
            c = f(h("../value-types/vec3")),
            a = f(h("../value-types/mat4")),
            d = f(h("../assets/material/material-variant"));
        m = h("../components/CCRenderComponent");
        var l = h("./CCMesh"),
            g = h("../renderer/render-flow"),
            n = h("../renderer"),
            w = h("../assets/material/CCMaterial"),
            t = cc.Enum({
                OFF: 0,
                ON: 1
            });
        h = cc.Class({
            name: "cc.MeshRenderer",
            extends: m,
            editor: !1,
            properties: {
                _mesh: {
                    default: null,
                    type: l
                },
                _receiveShadows: !1,
                _shadowCastingMode: t.OFF,
                _enableAutoBatch: !1,
                mesh: {
                    get: function() {
                        return this._mesh
                    },
                    set: function(a) {
                        this._mesh !== a && (this._setMesh(a), a ? (this.markForRender(!0), this.node._renderFlag |= g.FLAG_TRANSFORM) : this.disableRender())
                    },
                    type: l,
                    animatable: !1
                },
                textures: {
                    default: [],
                    type: cc.Texture2D,
                    visible: !1
                },
                receiveShadows: {
                    get: function() {
                        return this._receiveShadows
                    },
                    set: function(a) {
                        this._receiveShadows = a;
                        this._updateReceiveShadow()
                    },
                    animatable: !1
                },
                shadowCastingMode: {
                    get: function() {
                        return this._shadowCastingMode
                    },
                    set: function(a) {
                        this._shadowCastingMode = a;
                        this._updateCastShadow()
                    },
                    type: t,
                    animatable: !1
                },
                enableAutoBatch: {
                    get: function() {
                        return this._enableAutoBatch
                    },
                    set: function(a) {
                        this._enableAutoBatch = a
                    }
                }
            },
            statics: {
                ShadowCastingMode: t
            },
            ctor: function() {
                this._boundingBox = cc.geomUtils && new k["default"];
                !0;
                this._debugDatas = {
                    wireFrame: [],
                    normal: []
                }
            },
            onEnable: function() {
                var a = this;
                this._super();
                this._mesh && !this._mesh.loaded ? (this.disableRender(), this._mesh.once("load", function() {
                        a.isValid && (a._setMesh(a._mesh), a.markForRender(!0))
                    }),
                    cc.assetManager.postLoadNative(this._mesh)) : this._setMesh(this._mesh);
                this._updateRenderNode();
                this._updateMaterial()
            },
            onDestroy: function() {
                this._setMesh(null);
                cc.pool.assembler.put(this._assembler)
            },
            _updateRenderNode: function() {
                this._assembler.setRenderNode(this.node)
            },
            _setMesh: function(a) {
                cc.geomUtils && a && k["default"].fromPoints(this._boundingBox, a._minPos, a._maxPos);
                this._mesh && this._mesh.off("init-format", this._updateMeshAttribute, this);
                a && a.on("init-format", this._updateMeshAttribute, this);
                this._mesh =
                    a;
                this._assembler && (this._assembler._worldDatas = {});
                this._updateMeshAttribute()
            },
            _getDefaultMaterial: function() {
                return w.getBuiltinMaterial("unlit")
            },
            _validateRender: function() {
                var a = this._mesh;
                a && 0 < a._subDatas.length || this.disableRender()
            },
            _updateMaterial: function() {
                var a = this.textures;
                if (a && 0 < a.length)
                    for (var b = this._getDefaultMaterial(), c = 0; c < a.length; c++) {
                        var g = this._materials[c];
                        g && g._uuid !== b._uuid || (g || (g = d["default"].create(b, this), this.setMaterial(c, g)), g.setProperty("diffuseTexture", a[c]))
                    }
                this._updateReceiveShadow();
                this._updateCastShadow();
                this._updateMeshAttribute()
            },
            _updateReceiveShadow: function() {
                for (var a = this.getMaterials(), b = 0; b < a.length; b++) a[b].define("CC_USE_SHADOW_MAP", this._receiveShadows, void 0, !0)
            },
            _updateCastShadow: function() {
                for (var a = this.getMaterials(), b = 0; b < a.length; b++) a[b].define("CC_CASTING_SHADOW", this._shadowCastingMode === t.ON, void 0, !0)
            },
            _updateMeshAttribute: function() {
                var a = this._mesh && this._mesh.subDatas;
                if (a) {
                    for (var b = this.getMaterials(), d = 0; d < b.length && a[d]; d++) {
                        var c = a[d].vfm,
                            g =
                            b[d];
                        g.define("CC_USE_ATTRIBUTE_COLOR", !!c.element(e["default"].ATTR_COLOR), void 0, !0);
                        g.define("CC_USE_ATTRIBUTE_UV0", !!c.element(e["default"].ATTR_UV0), void 0, !0);
                        g.define("CC_USE_ATTRIBUTE_NORMAL", !!c.element(e["default"].ATTR_NORMAL), void 0, !0);
                        g.define("CC_USE_ATTRIBUTE_TANGENT", !!c.element(e["default"].ATTR_TANGENT), void 0, !0)
                    }!0;
                    for (var l in this._debugDatas) this._debugDatas[l].length = 0;
                    !1
                }
            },
            _checkBacth: function() {}
        });
        !0;
        var p = cc.Color.BLACK,
            u = cc.Color.RED,
            v = [cc.v3(), cc.v3()],
            A = cc.mat4(),
            B = {
                normal: function(g, l, k, p) {
                    l = k.vfm;
                    var f = l.element(e["default"].ATTR_NORMAL),
                        h = l.element(e["default"].ATTR_POSITION);
                    k = l.element(e["default"].ATTR_JOINTS);
                    var t = l.element(e["default"].ATTR_WEIGHTS);
                    if (f && h) {
                        l = [];
                        var w = [];
                        c["default"].set(v[0], 5, 0, 0);
                        a["default"].invert(A, g.node._worldMatrix);
                        c["default"].transformMat4Normal(v[0], v[0], A);
                        var B = v[0].mag();
                        var y = g.mesh;
                        g = y._getAttrMeshData(p, e["default"].ATTR_POSITION);
                        var E = y._getAttrMeshData(p, e["default"].ATTR_NORMAL),
                            z = y._getAttrMeshData(p, e["default"].ATTR_JOINTS);
                        p = y._getAttrMeshData(p, e["default"].ATTR_WEIGHTS);
                        y = g.length / h.num;
                        for (var x = 0; x < y; x++) {
                            var m = x * f.num,
                                L = x * h.num;
                            c["default"].set(v[0], E[m], E[m + 1], E[m + 2]);
                            c["default"].set(v[1], g[L], g[L + 1], g[L + 2]);
                            c["default"].scaleAndAdd(v[0], v[1], v[0], B);
                            for (m = 0; 2 > m; m++) {
                                w.push(v[m].x, v[m].y, v[m].z);
                                if (k) {
                                    L = x * k.num;
                                    for (var q = 0; q < k.num; q++) w.push(z[L + q])
                                }
                                if (t)
                                    for (L = x * t.num, q = 0; q < t.num; q++) w.push(p[L + q])
                            }
                            l.push(2 * x, 2 * x + 1)
                        }
                        f = [{
                            name: e["default"].ATTR_POSITION,
                            type: e["default"].ATTR_TYPE_FLOAT32,
                            num: 3
                        }];
                        k && f.push({
                            name: e["default"].ATTR_JOINTS,
                            type: e["default"].ATTR_TYPE_FLOAT32,
                            num: k.num
                        });
                        t && f.push({
                            name: e["default"].ATTR_WEIGHTS,
                            type: e["default"].ATTR_TYPE_FLOAT32,
                            num: t.num
                        });
                        k = new e["default"].VertexFormat(f);
                        k = new e["default"].VertexBuffer(n.device, k, e["default"].USAGE_STATIC, new Float32Array(w));
                        l = new Uint16Array(l);
                        l = new e["default"].IndexBuffer(n.device, e["default"].INDEX_FMT_UINT16, e["default"].USAGE_STATIC, l, l.length);
                        w = d["default"].createWithBuiltin("unlit");
                        w.setProperty("diffuseColor", u);
                        return {
                            material: w,
                            ia: new b["default"](k,
                                l, e["default"].PT_LINES)
                        }
                    }
                },
                wireFrame: function(a, c, g) {
                    g = g.getIData(Uint16Array);
                    a = d["default"].createWithBuiltin("unlit");
                    a.setProperty("diffuseColor", p);
                    for (var l = [], k = 0; k < g.length; k += 3) {
                        var f = g[k + 0],
                            h = g[k + 1],
                            t = g[k + 2];
                        l.push(f, h, h, t, t, f)
                    }
                    g = new Uint16Array(l);
                    g = new e["default"].IndexBuffer(n.device, e["default"].INDEX_FMT_UINT16, e["default"].USAGE_STATIC, g, g.length);
                    return {
                        material: a,
                        ia: new b["default"](c._vertexBuffer, g, e["default"].PT_LINES)
                    }
                }
            };
        h.prototype._updateDebugDatas = function() {
            var a = this._debugDatas,
                b = this._mesh.subMeshes,
                d = this._mesh._subDatas,
                c;
            for (c in a) {
                var g = a[c];
                if (g.length !== b.length && cc.macro["SHOW_MESH_" + c.toUpperCase()]) {
                    g.length = b.length;
                    for (var l = 0; l < b.length; l++) g[l] = B[c](this, b[l], d[l], l)
                }
            }
        };
        cc.MeshRenderer = q.exports = h
    }, {
        "../../renderer/core/input-assembler": 324,
        "../../renderer/gfx": 334,
        "../assets/material/CCMaterial": 91,
        "../assets/material/material-variant": 98,
        "../components/CCRenderComponent": 126,
        "../geom-utils/aabb": 155,
        "../renderer": 236,
        "../renderer/render-flow": 237,
        "../value-types/mat4": 303,
        "../value-types/vec3": 311,
        "./CCMesh": 172
    }],
    174: [function(h, q, m) {
        h("./CCMesh");
        !0;
        h("./CCMeshRenderer");
        h("./mesh-renderer")
    }, {
        "./CCMesh": 172,
        "./CCMeshRenderer": 173,
        "./mesh-renderer": 176
    }],
    175: [function(h, q, m) {
        function f() {
            this.vfm = this.uint16IData = this.iData = this.uint32VData = this.float32VData = this.vData = null;
            this.offset = 0;
            this.ib = this.vb = null;
            this.iDirty = this.vDirty = !1;
            this.enable = !0
        }
        m.__esModule = !0;
        m.MeshData = f;
        m.Primitive = m.VertexBundle = m.VertexFormat = m.BufferRange = void 0;
        h = function(b) {
            return b &&
                b.__esModule ? b : {
                    default: b
                }
        }(h("../../renderer/gfx"));
        q = cc.Class({
            name: "cc.BufferRange",
            properties: {
                offset: 0,
                length: 0
            }
        });
        m.BufferRange = q;
        var e = cc.Class({
            name: "cc.mesh.VertexFormat",
            properties: {
                name: "",
                type: -1,
                num: -1,
                normalize: !1
            }
        });
        m.VertexFormat = e;
        e = cc.Class({
            name: "cc.mesh.VertexBundle",
            properties: {
                data: {
                    default: null,
                    type: q
                },
                formats: {
                    default: [],
                    type: e
                },
                verticesCount: 0
            }
        });
        m.VertexBundle = e;
        h = cc.Class({
            name: "cc.mesh.Primitive",
            properties: {
                vertexBundleIndices: {
                    default: [],
                    type: cc.Float
                },
                data: {
                    default: null,
                    type: q
                },
                indexUnit: h["default"].INDEX_FMT_UINT16,
                topology: h["default"].PT_TRIANGLES
            }
        });
        m.Primitive = h;
        f.prototype.setVData = function(b) {
            this.vData = b;
            this.uint32VData = this.float32VData = null
        };
        f.prototype.getVData = function(b) {
            return b === Float32Array ? (this.float32VData || (this.float32VData = new Float32Array(this.vData.buffer, this.vData.byteOffset, this.vData.byteLength / 4)), this.float32VData) : b === Uint32Array ? (this.uint32VData || (this.uint32VData = new Uint32Array(this.vData.buffer, this.vData.byteOffset, this.vData.byteLength /
                4)), this.uint32VData) : this.vData
        };
        f.prototype.getIData = function(b) {
            return b === Uint16Array ? (this.uint16IData || (this.uint16IData = new Uint16Array(this.iData.buffer, this.iData.byteOffset, this.iData.byteLength / 2)), this.uint16IData) : this.iData
        }
    }, {
        "../../renderer/gfx": 334
    }],
    176: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var b = f(h("../renderer/assembler")),
            k = f(h("../../renderer/gfx")),
            c = f(h("../value-types/vec3"));
        h = h("./CCMeshRenderer");
        var a = new c["default"],
            d = function(b) {
                function d() {
                    return b.apply(this, arguments) || this
                }
                e(d, b);
                var l = d.prototype;
                l.init = function(a) {
                    b.prototype.init.call(this, a);
                    this._worldDatas = {};
                    this._renderNode = null
                };
                l.setRenderNode = function(a) {
                    this._renderNode = a
                };
                l.fillBuffers = function(a, b) {
                    if (a.mesh) {
                        a.mesh._uploadData();
                        for (var d = b.cullingMask === a.node._cullingMask, c = a.enableAutoBatch, g = a._materials, l = a.mesh._subMeshes, e = a.mesh.subDatas,
                                n = 0; n < l.length; n++) {
                            var f = l[n],
                                h = e[n],
                                t = g[n] || g[0];
                            c && h.canBatch && f._primitiveType === k["default"].PT_TRIANGLES ? (d && t.getHash() === b.material.getHash() || b._flush(), b.material = t, b.cullingMask = a.node._cullingMask, b.node = b._dummyNode, this._fillBuffer(a, h, b, n)) : (b._flush(), b.material = t, b.cullingMask = a.node._cullingMask, b.node = this._renderNode, b._flushIA(f))
                        }(!0, !cc.macro.SHOW_MESH_WIREFRAME && !cc.macro.SHOW_MESH_NORMAL) || a.node._cullingMask & 1 << cc.Node.BuiltinGroupIndex.DEBUG || (b._flush(), b.node = this._renderNode,
                            a._updateDebugDatas(), cc.macro.SHOW_MESH_WIREFRAME && this._drawDebugDatas(a, b, "wireFrame"), cc.macro.SHOW_MESH_NORMAL && this._drawDebugDatas(a, b, "normal"))
                    }
                };
                l._fillBuffer = function(a, b, d, c) {
                    var g = b.getVData(Float32Array),
                        l = b.vfm,
                        e = g.byteLength / l._bytes | 0;
                    b = b.getIData(Uint16Array);
                    var n = b.length,
                        k = d.getBuffer("mesh", l),
                        p = k.request(e, n),
                        f = p.indiceOffset,
                        h = p.byteOffset >> 2;
                    p = p.vertexOffset;
                    var t = k._vData;
                    k = k._iData;
                    !d.worldMatDirty && this._worldDatas[c] || this._updateWorldVertices(c, e, g, l, a.node._worldMatrix);
                    t.set(this._worldDatas[c], h);
                    for (a = 0; a < n; a++) k[f + a] = p + b[a]
                };
                l._updateWorldVertices = function(b, d, g, l, e) {
                    var n = this._worldDatas[b];
                    n || (n = this._worldDatas[b] = new Float32Array(g.length), n.set(g));
                    b = l._bytes / 4;
                    l = l._elements;
                    for (var p = 0, f = l.length; p < f; p++) {
                        var h = l[p],
                            t = h.offset / 4;
                        if (h.name === k["default"].ATTR_POSITION || h.name === k["default"].ATTR_NORMAL) {
                            h = h.name === k["default"].ATTR_NORMAL ? c["default"].transformMat4Normal : c["default"].transformMat4;
                            for (var u = 0; u < d; u++) {
                                var v = u * b + t;
                                a.x = g[v];
                                a.y = g[v + 1];
                                a.z =
                                    g[v + 2];
                                h(a, a, e);
                                n[v] = a.x;
                                n[v + 1] = a.y;
                                n[v + 2] = a.z
                            }
                        }
                    }
                };
                l._drawDebugDatas = function(a, b, d) {
                    if (a = a._debugDatas[d])
                        for (d = 0; d < a.length; d++) {
                            var c = a[d];
                            c && (b.material = c.material, b._flushIA(c.ia))
                        }
                };
                return d
            }(b["default"]);
        m["default"] = d;
        b["default"].register(h, d);
        q.exports = m["default"]
    }, {
        "../../renderer/gfx": 334,
        "../renderer/assembler": 233,
        "../value-types/vec3": 311,
        "./CCMeshRenderer": 173
    }],
    177: [function(h, q, m) {
        function f() {
            this._activatingStack = []
        }
        var e = h("./component-scheduler");
        m = h("./platform/CCObject").Flags;
        var b = h("./platform/js"),
            k = m.IsPreloadStarted,
            c = m.IsOnLoadStarted,
            a = m.IsOnLoadCalled,
            d = m.Deactivating,
            l = cc.Class({
                extends: e.LifeCycleInvoker,
                add: function(a) {
                    this._zero.array.push(a)
                },
                remove: function(a) {
                    this._zero.fastRemove(a)
                },
                cancelInactive: function(a) {
                    e.LifeCycleInvoker.stableRemoveInactive(this._zero, a)
                },
                invoke: function() {
                    this._invoke(this._zero);
                    this._zero.array.length = 0
                }
            }),
            g = e.createInvokeImpl("c.__preload();"),
            n = e.createInvokeImpl("c.onLoad();c._objFlags|=" + a, !1, a),
            w = new b.Pool(4);
        w.get = function() {
            var a =
                this._get() || {
                    preload: new l(g),
                    onLoad: new e.OneOffInvoker(n),
                    onEnable: new e.OneOffInvoker(e.invokeOnEnable)
                };
            a.preload._zero.i = -1;
            var b = a.onLoad;
            b._zero.i = -1;
            b._neg.i = -1;
            b._pos.i = -1;
            b = a.onEnable;
            b._zero.i = -1;
            b._neg.i = -1;
            b._pos.i = -1;
            return a
        };
        h = cc.Class({
            ctor: f,
            reset: f,
            _activateNodeRecursively: function(a, c, g, l) {
                if (a._objFlags & d) cc.errorID(3816, a.name);
                else {
                    a._activeInHierarchy = !0;
                    for (var e = a._components.length, n = 0; n < e; ++n) {
                        var k = a._components[n];
                        if (k instanceof cc.Component) this.activateComp(k, c, g,
                            l);
                        else {
                            var p = a,
                                f = n;
                            !1;
                            k ? p._removeComponent(k) : b.array.removeAt(p._components, f);
                            --n;
                            --e
                        }
                    }
                    a._childArrivalOrder = a._children.length;
                    e = 0;
                    for (n = a._children.length; e < n; ++e) p = a._children[e], p._localZOrder = 4294901760 & p._localZOrder | e + 1, p._active && this._activateNodeRecursively(p, c, g, l);
                    a._onPostActivated(!0)
                }
            },
            _deactivateNodeRecursively: function(a) {
                !1;
                a._objFlags |= d;
                a._activeInHierarchy = !1;
                for (var b = a._components.length, c = 0; c < b; ++c) {
                    var g = a._components[c];
                    if (g._enabled && (cc.director._compScheduler.disableComp(g),
                            a._activeInHierarchy)) {
                        a._objFlags &= ~d;
                        return
                    }
                }
                b = 0;
                for (c = a._children.length; b < c; ++b)
                    if (g = a._children[b], g._activeInHierarchy && (this._deactivateNodeRecursively(g), a._activeInHierarchy)) {
                        a._objFlags &= ~d;
                        return
                    }
                a._onPostActivated(!1);
                a._objFlags &= ~d
            },
            activateNode: function(a, b) {
                if (b) b = w.get(), this._activatingStack.push(b), this._activateNodeRecursively(a, b.preload, b.onLoad, b.onEnable), b.preload.invoke(), b.onLoad.invoke(), b.onEnable.invoke(), this._activatingStack.pop(), w.put(b);
                else {
                    this._deactivateNodeRecursively(a);
                    b = this._activatingStack;
                    for (var d = 0; d < b.length; d++) {
                        var g = b[d];
                        g.preload.cancelInactive(k);
                        g.onLoad.cancelInactive(c);
                        g.onEnable.cancelInactive()
                    }
                }
                a.emit("active-in-hierarchy-changed", a)
            },
            activateComp: function(b, d, g, l) {
                cc.isValid(b, !0) && (b._objFlags & k || (b._objFlags |= k, b.__preload && (d ? d.add(b) : b.__preload())), b._objFlags & c || (b._objFlags |= c, b.onLoad ? g ? g.add(b) : (b.onLoad(), b._objFlags |= a) : b._objFlags |= a), b._enabled && b.node._activeInHierarchy && cc.director._compScheduler.enableComp(b, l))
            },
            destroyComp: function(b) {
                cc.director._compScheduler.disableComp(b);
                b.onDestroy && b._objFlags & a && b.onDestroy()
            },
            resetComp: !1
        });
        q.exports = h
    }, {
        "./component-scheduler": 110,
        "./platform/CCObject": 210,
        "./platform/js": 225,
        "./utils/misc": 286
    }],
    178: [function(h, q, m) {
        function f() {
            this.localPoint = cc.v2();
            this.tangentImpulse = this.normalImpulse = 0
        }

        function e() {}
        var b = h("./CCPhysicsTypes").PTM_RATIO,
            k = h("./CCPhysicsTypes").ContactType,
            c = [],
            a = [cc.v2(), cc.v2()],
            d = new b2.WorldManifold,
            l = {
                points: [],
                separations: [],
                normal: cc.v2()
            },
            g = [new f, new f];
        new b2.Manifold;
        var n = {
                type: 0,
                localPoint: cc.v2(),
                localNormal: cc.v2(),
                points: []
            },
            w = {
                normalImpulses: [],
                tangentImpulses: []
            };
        e.prototype.init = function(a) {
            this.colliderA = a.GetFixtureA().collider;
            this.colliderB = a.GetFixtureB().collider;
            this.disabledOnce = this.disabled = !1;
            this._impulse = null;
            this._inverted = !1;
            this._b2contact = a;
            a._contact = this
        };
        e.prototype.reset = function() {
            this.setTangentSpeed(0);
            this.resetFriction();
            this.resetRestitution();
            this.colliderB = this.colliderA = null;
            this.disabled = !1;
            this._impulse = null;
            this._b2contact = this._b2contact._contact = null
        };
        e.prototype.getWorldManifold = function() {
            var c = l.points,
                g = l.separations,
                e = l.normal;
            this._b2contact.GetWorldManifold(d);
            var n = d.points,
                k = d.separations,
                f = this._b2contact.GetManifold().pointCount;
            c.length = g.length = f;
            for (var h = 0; h < f; h++) {
                var w = a[h];
                w.x = n[h].x * b;
                w.y = n[h].y * b;
                c[h] = w;
                g[h] = k[h] * b
            }
            e.x = d.normal.x;
            e.y = d.normal.y;
            this._inverted && (e.x *= -1, e.y *= -1);
            return l
        };
        e.prototype.getManifold = function() {
            for (var a = n.points, d = n.localNormal, c = n.localPoint, l = this._b2contact.GetManifold(), e = l.points, k = a.length =
                    l.pointCount, f = 0; f < k; f++) {
                var h = g[f],
                    w = e[f];
                h.localPoint.x = w.localPoint.x * b;
                h.localPoint.Y = w.localPoint.Y * b;
                h.normalImpulse = w.normalImpulse * b;
                h.tangentImpulse = w.tangentImpulse;
                a[f] = h
            }
            c.x = l.localPoint.x * b;
            c.y = l.localPoint.y * b;
            d.x = l.localNormal.x;
            d.y = l.localNormal.y;
            n.type = l.type;
            this._inverted && (d.x *= -1, d.y *= -1);
            return n
        };
        e.prototype.getImpulse = function() {
            var a = this._impulse;
            if (!a) return null;
            for (var d = w.normalImpulses, c = w.tangentImpulses, g = a.count, l = 0; l < g; l++) d[l] = a.normalImpulses[l] * b, c[l] = a.tangentImpulses[l];
            c.length = d.length = g;
            return w
        };
        e.prototype.emit = function(a) {
            switch (a) {
                case k.BEGIN_CONTACT:
                    var b = "onBeginContact";
                    break;
                case k.END_CONTACT:
                    b = "onEndContact";
                    break;
                case k.PRE_SOLVE:
                    b = "onPreSolve";
                    break;
                case k.POST_SOLVE:
                    b = "onPostSolve"
            }
            a = this.colliderA;
            var d = this.colliderB,
                c = a.body,
                g = d.body,
                l;
            if (c.enabledContactListener) {
                c = c.node._components;
                this._inverted = !1;
                var e = 0;
                for (l = c.length; e < l; e++) {
                    var n = c[e];
                    n[b] && n[b](this, a, d)
                }
            }
            if (g.enabledContactListener)
                for (c = g.node._components, this._inverted = !0, e = 0, l =
                    c.length; e < l; e++) n = c[e], n[b] && n[b](this, d, a);
            if (this.disabled || this.disabledOnce) this.setEnabled(!1), this.disabledOnce = !1
        };
        e.get = function(a) {
            var b = 0 === c.length ? new cc.PhysicsContact : c.pop();
            b.init(a);
            return b
        };
        e.put = function(a) {
            if (a = a._contact) c.push(a), a.reset()
        };
        h = e.prototype;
        h.setEnabled = function(a) {
            this._b2contact.SetEnabled(a)
        };
        h.isTouching = function() {
            return this._b2contact.IsTouching()
        };
        h.setTangentSpeed = function(a) {
            this._b2contact.SetTangentSpeed(a / b)
        };
        h.getTangentSpeed = function() {
            return this._b2contact.GetTangentSpeed() *
                b
        };
        h.setFriction = function(a) {
            this._b2contact.SetFriction(a)
        };
        h.getFriction = function() {
            return this._b2contact.GetFriction()
        };
        h.resetFriction = function() {
            return this._b2contact.ResetFriction()
        };
        h.setRestitution = function(a) {
            this._b2contact.SetRestitution(a)
        };
        h.getRestitution = function() {
            return this._b2contact.GetRestitution()
        };
        h.resetRestitution = function() {
            return this._b2contact.ResetRestitution()
        };
        e.ContactType = k;
        cc.PhysicsContact = q.exports = e
    }, {
        "./CCPhysicsTypes": 180
    }],
    179: [function(h, q, m) {
        m = h("./CCPhysicsTypes");
        var f = m.ContactType,
            e = m.BodyType,
            b = m.RayCastType,
            k = m.DrawBits,
            c = m.PTM_RATIO,
            a = m.PHYSICS_ANGLE_TO_ANGLE,
            d = h("./utils").convertToNodeRotation,
            l = h("./platform/CCPhysicsDebugDraw"),
            g = new b2.AABB,
            n = new b2.Vec2,
            w = new b2.Vec2,
            t = cc.v2(),
            p = cc.Class({
                mixins: [cc.EventTarget],
                statics: {
                    DrawBits: k,
                    PTM_RATIO: c,
                    VELOCITY_ITERATIONS: 10,
                    POSITION_ITERATIONS: 10,
                    FIXED_TIME_STEP: 1 / 60,
                    MAX_ACCUMULATOR: .2
                },
                ctor: function() {
                    this._debugDrawFlags = 0;
                    this._world = this._debugDrawer = null;
                    this._bodies = [];
                    this._joints = [];
                    this._contactMap = {};
                    this._contactID = 0;
                    this._delayEvents = [];
                    this._accumulator = 0;
                    cc.director._scheduler && cc.director._scheduler.enableForTarget(this);
                    this.enabledAccumulator = !1
                },
                pushDelayEvent: function(a, b, d) {
                    this._steping ? this._delayEvents.push({
                        target: a,
                        func: b,
                        args: d
                    }) : a[b].apply(a, d)
                },
                update: function(a) {
                    var b = this._world;
                    if (b && this.enabled) {
                        this.emit("before-step");
                        this._steping = !0;
                        var d = p.VELOCITY_ITERATIONS,
                            c = p.POSITION_ITERATIONS;
                        if (this.enabledAccumulator) {
                            this._accumulator += a;
                            a = p.FIXED_TIME_STEP;
                            var g = p.MAX_ACCUMULATOR;
                            for (this._accumulator > g && (this._accumulator = g); this._accumulator > a;) b.Step(a, d, c), this._accumulator -= a
                        } else b.Step(1 / cc.game.config.frameRate, d, c);
                        this.debugDrawFlags && (this._checkDebugDrawValid(), this._debugDrawer.clear(), b.DrawDebugData());
                        this._steping = !1;
                        b = this._delayEvents;
                        d = 0;
                        for (c = b.length; d < c; d++) a = b[d], a.target[a.func].apply(a.target, a.args);
                        b.length = 0;
                        this._syncNode()
                    }
                },
                testPoint: function(a) {
                    var b = n.x = a.x / c;
                    a = n.y = a.y / c;
                    var d = .2 / c;
                    g.lowerBound.x = b - d;
                    g.lowerBound.y = a - d;
                    g.upperBound.x = b + d;
                    g.upperBound.y = a + d;
                    b = this._aabbQueryCallback;
                    b.init(n);
                    this._world.QueryAABB(b, g);
                    return (b = b.getFixture()) ? b.collider : null
                },
                testAABB: function(a) {
                    g.lowerBound.x = a.xMin / c;
                    g.lowerBound.y = a.yMin / c;
                    g.upperBound.x = a.xMax / c;
                    g.upperBound.y = a.yMax / c;
                    a = this._aabbQueryCallback;
                    a.init();
                    this._world.QueryAABB(a, g);
                    return a.getFixtures().map(function(a) {
                        return a.collider
                    })
                },
                rayCast: function(a, d, g) {
                    if (a.equals(d)) return [];
                    g = g || b.Closest;
                    n.x = a.x / c;
                    n.y = a.y / c;
                    w.x = d.x / c;
                    w.y = d.y / c;
                    var l = this._raycastQueryCallback;
                    l.init(g);
                    this._world.RayCast(l, n, w);
                    a = l.getFixtures();
                    if (0 < a.length) {
                        d = l.getPoints();
                        var e = l.getNormals();
                        l = l.getFractions();
                        for (var k = [], f = 0, p = a.length; f < p; f++) {
                            var h = a[f],
                                u = h.collider;
                            if (g === b.AllClosest) {
                                var t = k.find(function(a) {
                                    return a.collider === u
                                });
                                if (t) {
                                    l[f] < t.fraction && (t.fixtureIndex = u._getFixtureIndex(h), t.point.x = d[f].x * c, t.point.y = d[f].y * c, t.normal.x = e[f].x, t.normal.y = e[f].y, t.fraction = l[f]);
                                    continue
                                }
                            }
                            k.push({
                                collider: u,
                                fixtureIndex: u._getFixtureIndex(h),
                                point: cc.v2(d[f].x * c, d[f].y * c),
                                normal: cc.v2(e[f]),
                                fraction: l[f]
                            })
                        }
                        return k
                    }
                    return []
                },
                syncPosition: function() {
                    for (var a = this._bodies, b = 0; b < a.length; b++) a[b].syncPosition()
                },
                syncRotation: function() {
                    for (var a = this._bodies, b = 0; b < a.length; b++) a[b].syncRotation()
                },
                _registerContactFixture: function(a) {
                    this._contactListener.registerContactFixture(a)
                },
                _unregisterContactFixture: function(a) {
                    this._contactListener.unregisterContactFixture(a)
                },
                _addBody: function(a, b) {
                    var d = this._world,
                        c = a.node;
                    d && c && (a._b2Body = d.CreateBody(b), a._b2Body.body = a, this._bodies.push(a))
                },
                _removeBody: function(a) {
                    var b = this._world;
                    b && (a._b2Body.body = null, b.DestroyBody(a._b2Body), a._b2Body = null, cc.js.array.remove(this._bodies, a))
                },
                _addJoint: function(a, b) {
                    if (b = this._world.CreateJoint(b)) b._joint = a, a._joint = b, this._joints.push(a)
                },
                _removeJoint: function(a) {
                    a._isValid() && this._world.DestroyJoint(a._joint);
                    a._joint && (a._joint._joint = null);
                    cc.js.array.remove(this._joints, a)
                },
                _initCallback: function() {
                    if (!this._world) cc.warn("Please init PhysicsManager first");
                    else if (!this._contactListener) {
                        var a =
                            new cc.PhysicsContactListener;
                        a.setBeginContact(this._onBeginContact);
                        a.setEndContact(this._onEndContact);
                        a.setPreSolve(this._onPreSolve);
                        a.setPostSolve(this._onPostSolve);
                        this._world.SetContactListener(a);
                        this._contactListener = a;
                        this._aabbQueryCallback = new cc.PhysicsAABBQueryCallback;
                        this._raycastQueryCallback = new cc.PhysicsRayCastCallback
                    }
                },
                _init: function() {
                    this.enabled = !0;
                    this.debugDrawFlags = k.e_shapeBit
                },
                _getWorld: function() {
                    return this._world
                },
                _syncNode: function() {
                    for (var b = this._bodies, g = 0,
                            l = b.length; g < l; g++) {
                        var n = b[g],
                            k = n.node,
                            f = n._b2Body,
                            p = f.GetPosition();
                        t.x = p.x * c;
                        t.y = p.y * c;
                        f = f.GetAngle() * a;
                        null !== k.parent.parent && (t = k.parent.convertToNodeSpaceAR(t), f = d(k.parent, f));
                        p = k._eventMask;
                        k._eventMask = 0;
                        k.position = t;
                        k.angle = -f;
                        k._eventMask = p;
                        n.type === e.Animated && n.resetVelocity()
                    }
                },
                _onBeginContact: function(a) {
                    cc.PhysicsContact.get(a).emit(f.BEGIN_CONTACT)
                },
                _onEndContact: function(a) {
                    var b = a._contact;
                    b && (b.emit(f.END_CONTACT), cc.PhysicsContact.put(a))
                },
                _onPreSolve: function(a) {
                    (a = a._contact) &&
                    a.emit(f.PRE_SOLVE)
                },
                _onPostSolve: function(a, b) {
                    if (a = a._contact) a._impulse = b, a.emit(f.POST_SOLVE), a._impulse = null
                },
                _checkDebugDrawValid: function() {
                    if (!this._debugDrawer || !this._debugDrawer.isValid) {
                        var a = new cc.Node("PHYSICS_MANAGER_DEBUG_DRAW");
                        a.zIndex = cc.macro.MAX_ZINDEX;
                        cc.game.addPersistRootNode(a);
                        this._debugDrawer = a.addComponent(cc.Graphics);
                        a = new l(this._debugDrawer);
                        a.SetFlags(this.debugDrawFlags);
                        this._world.SetDebugDraw(a)
                    }
                }
            });
        cc.js.getset(p.prototype, "enabled", function() {
                return this._enabled
            },
            function(a) {
                !1;
                if (a && !this._world) {
                    var b = new b2.World(new b2.Vec2(0, -10));
                    b.SetAllowSleeping(!0);
                    this._world = b;
                    this._initCallback()
                }
                this._enabled = a
            });
        cc.js.getset(p.prototype, "debugDrawFlags", function() {
            return this._debugDrawFlags
        }, function(a) {
            !1;
            a && !this._debugDrawFlags ? this._debugDrawer && this._debugDrawer.node && (this._debugDrawer.node.active = !0) : !a && this._debugDrawFlags && this._debugDrawer && this._debugDrawer.node && (this._debugDrawer.node.active = !1);
            a && (this._checkDebugDrawValid(), this._world.m_debugDraw.SetFlags(a));
            if (this._debugDrawFlags = a) this._checkDebugDrawValid(), this._world.m_debugDraw.SetFlags(a)
        });
        cc.js.getset(p.prototype, "gravity", function() {
            if (this._world) {
                var a = this._world.GetGravity();
                return cc.v2(a.x * c, a.y * c)
            }
            return cc.v2()
        }, function(a) {
            this._world && this._world.SetGravity(new b2.Vec2(a.x / c, a.y / c))
        });
        cc.PhysicsManager = q.exports = p
    }, {
        "./CCPhysicsTypes": 180,
        "./platform/CCPhysicsDebugDraw": 201,
        "./utils": 203
    }],
    180: [function(h, q, m) {
        h = cc.Enum({
            Static: 0,
            Kinematic: 1,
            Dynamic: 2,
            Animated: 3
        });
        cc.RigidBodyType =
            h;
        m = cc.Enum({
            Closest: 0,
            Any: 1,
            AllClosest: 2,
            All: 3
        });
        cc.RayCastType = m;
        q.exports = {
            BodyType: h,
            ContactType: {
                BEGIN_CONTACT: "begin-contact",
                END_CONTACT: "end-contact",
                PRE_SOLVE: "pre-solve",
                POST_SOLVE: "post-solve"
            },
            RayCastType: m,
            DrawBits: b2.DrawFlags,
            PTM_RATIO: 32,
            ANGLE_TO_PHYSICS_ANGLE: -Math.PI / 180,
            PHYSICS_ANGLE_TO_ANGLE: -180 / Math.PI
        }
    }, {}],
    181: [function(h, q, m) {
        function f(a, b) {
            var d = b.length;
            return b[0 > a ? d - -a % d : a % d]
        }

        function e(a, b, d) {
            for (var c = []; b < a;) b += d.length;
            for (; a <= b; ++a) c.push(f(a, d));
            return c
        }

        function b(p) {
            n(p);
            for (var h = [], u, w, E, y, z = cc.v2(), x = cc.v2(), m = 0, G = 0, F = 0; F < p.length; ++F)
                if (c(F, p)) {
                    w = E = 1E8;
                    for (var q = 0; q < p.length; ++q) a(f(F - 1, p), f(F, p), f(q, p)) && l(f(F - 1, p), f(F, p), f(q - 1, p)) && (y = t(f(F - 1, p), f(F, p), f(q, p), f(q - 1, p)), c(f(F + 1, p), f(F, p), y) && (u = g(f(F, p), y), u < w && (w = u, z = y, m = q))), a(f(F + 1, p), f(F, p), f(q + 1, p)) && l(f(F + 1, p), f(F, p), f(q, p)) && (y = t(f(F + 1, p), f(F, p), f(q, p), f(q + 1, p)), a(f(F - 1, p), f(F, p), y) && (u = g(f(F, p), y), u < E && (E = u, G = q, x = y)));
                    if (m == (G + 1) % p.length) q = z.add(x).div(2), G = e(F, G, p), G.push(q), p = e(m, F, p), p.push(q);
                    else {
                        w =
                            0;
                        for (u = m; G < m;) G += p.length;
                        for (q = m; q <= G; ++q) k(F, q, p) && (m = 1 / (g(f(F, p), f(q, p)) + 1), c(q, p) ? l(f(q - 1, p), f(q, p), f(F, p)) && d(f(q + 1, p), f(q, p), f(F, p)) ? m += 3 : m += 2 : m += 1, m > w && (u = q, w = m));
                        G = e(F, u, p);
                        p = e(u, F, p)
                    }
                    h = h.concat(b(G));
                    return h = h.concat(b(p))
                }
            h.push(p);
            for (F = h.length - 1; 0 <= F; F--) 0 == h[F].length && h.splice(F, 0);
            return h
        }

        function k(a, b, g) {
            if (c(a, g)) {
                if (d(f(a, g), f(a - 1, g), f(b, g)) && l(f(a, g), f(a + 1, g), f(b, g))) return !1
            } else if (l(f(a, g), f(a + 1, g), f(b, g)) || d(f(a, g), f(a - 1, g), f(b, g))) return !1;
            if (c(b, g)) {
                if (d(f(b, g), f(b - 1,
                        g), f(a, g)) && l(f(b, g), f(b + 1, g), f(a, g))) return !1
            } else if (l(f(b, g), f(b + 1, g), f(a, g)) || d(f(b, g), f(b - 1, g), f(a, g))) return !1;
            for (var e = 0; e < g.length; ++e)
                if ((e + 1) % g.length != a && e != a && (e + 1) % g.length != b && e != b) {
                    var n = cc.v2();
                    var k = f(a, g),
                        p = f(b, g),
                        h = f(e, g);
                    var t = f(e + 1, g);
                    if (k == h || k == t || p == h || p == t) n = !1;
                    else {
                        var u = k.x;
                        k = k.y;
                        var v = p.x;
                        p = p.y;
                        var w = h.x;
                        h = h.y;
                        var A = t.x;
                        var m = t.y;
                        Math.max(u, v) < Math.min(w, A) || Math.max(w, A) < Math.min(u, v) || Math.max(k, p) < Math.min(h, m) || Math.max(h, m) < Math.min(k, p) ? n = !1 : (t = (m - h) * (v - u) - (A - w) *
                            (p - k), 1E-6 > Math.abs(t) ? n = !1 : (A = ((A - w) * (k - h) - (m - h) * (u - w)) / t, t = ((v - u) * (k - h) - (p - k) * (u - w)) / t, 0 < A && 1 > A && 0 < t && 1 > t ? (n.x = u + A * (v - u), n.y = k + A * (p - k), n = !0) : n = !1))
                    }
                    if (n) return !1
                }
            return !0
        }

        function c(a, b, d) {
            if ("undefined" === typeof d) {
                d = a;
                var c = b;
                a = f(d - 1, c);
                b = f(d, c);
                d = f(d + 1, c)
            }
            return 0 > p(a, b, d)
        }

        function a(a, b, d) {
            return 0 < p(a, b, d)
        }

        function d(a, b, d) {
            return 0 <= p(a, b, d)
        }

        function l(a, b, d) {
            return 0 >= p(a, b, d)
        }

        function g(a, b) {
            var d = b.x - a.x;
            a = b.y - a.y;
            return d * d + a * a
        }

        function n(a) {
            w(a) || a.reverse()
        }

        function w(a) {
            if (3 > a.length) return !0;
            var b, d = 0;
            for (b = 0; b < a.length; b++) {
                var c = (b + 1) % a.length;
                d += a[b].x * a[c].y;
                d -= a[b].y * a[c].x
            }
            return 0 < d / 2
        }

        function t(a, b, d, c) {
            var g = cc.v2(),
                l = b.y - a.y;
            b = a.x - b.x;
            a = l * a.x + b * a.y;
            var e = c.y - d.y;
            c = d.x - c.x;
            d = e * d.x + c * d.y;
            var n = l * c - e * b;
            1E-6 >= Math.abs(n - 0) || (g.x = (c * a - b * d) / n, g.y = (l * d - e * a) / n);
            return g
        }

        function p(a, b, d) {
            return a.x * (b.y - d.y) + b.x * (d.y - a.y) + d.x * (a.y - b.y)
        }
        q.exports = {
            ConvexPartition: b,
            ForceCounterClockWise: n,
            IsCounterClockWise: w
        }
    }, {}],
    182: [function(h, q, m) {
        var f = h("../CCNode").EventType,
            e = h("./CCPhysicsTypes").PTM_RATIO,
            b = h("./CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE,
            k = h("./CCPhysicsTypes").PHYSICS_ANGLE_TO_ANGLE,
            c = h("./utils").getWorldRotation,
            a = h("./CCPhysicsTypes").BodyType,
            d = new b2.Vec2,
            l = new b2.Vec2,
            g = cc.Vec2.ZERO;
        h = cc.Class({
            name: "cc.RigidBody",
            extends: cc.Component,
            editor: !1,
            properties: {
                _type: a.Dynamic,
                _allowSleep: !0,
                _gravityScale: 1,
                _linearDamping: 0,
                _angularDamping: 0,
                _linearVelocity: cc.v2(0, 0),
                _angularVelocity: 0,
                _fixedRotation: !1,
                enabled: {
                    get: function() {
                        return this._enabled
                    },
                    set: function() {
                        cc.warnID(8200)
                    },
                    visible: !1,
                    override: !0
                },
                enabledContactListener: {
                    default: !1,
                    tooltip: !1
                },
                bullet: {
                    default: !1,
                    tooltip: !1
                },
                type: {
                    type: a,
                    tooltip: !1,
                    get: function() {
                        return this._type
                    },
                    set: function(b) {
                        this._type = b;
                        this._b2Body && (b === a.Animated ? this._b2Body.SetType(a.Kinematic) : this._b2Body.SetType(b))
                    }
                },
                allowSleep: {
                    tooltip: !1,
                    get: function() {
                        return this._b2Body ? this._b2Body.IsSleepingAllowed() : this._allowSleep
                    },
                    set: function(a) {
                        this._allowSleep = a;
                        this._b2Body && this._b2Body.SetSleepingAllowed(a)
                    }
                },
                gravityScale: {
                    tooltip: !1,
                    get: function() {
                        return this._gravityScale
                    },
                    set: function(a) {
                        this._gravityScale = a;
                        this._b2Body && this._b2Body.SetGravityScale(a)
                    }
                },
                linearDamping: {
                    tooltip: !1,
                    get: function() {
                        return this._linearDamping
                    },
                    set: function(a) {
                        this._linearDamping = a;
                        this._b2Body && this._b2Body.SetLinearDamping(this._linearDamping)
                    }
                },
                angularDamping: {
                    tooltip: !1,
                    get: function() {
                        return this._angularDamping
                    },
                    set: function(a) {
                        this._angularDamping = a;
                        this._b2Body && this._b2Body.SetAngularDamping(a)
                    }
                },
                linearVelocity: {
                    tooltip: !1,
                    type: cc.Vec2,
                    get: function() {
                        var a = this._linearVelocity;
                        if (this._b2Body) {
                            var b = this._b2Body.GetLinearVelocity();
                            a.x = b.x * e;
                            a.y = b.y * e
                        }
                        return a
                    },
                    set: function(a) {
                        this._linearVelocity = a;
                        var b = this._b2Body;
                        if (b) {
                            var d = b.m_linearVelocity;
                            d.Set(a.x / e, a.y / e);
                            b.SetLinearVelocity(d)
                        }
                    }
                },
                angularVelocity: {
                    tooltip: !1,
                    get: function() {
                        return this._b2Body ? this._b2Body.GetAngularVelocity() * k : this._angularVelocity
                    },
                    set: function(a) {
                        this._angularVelocity = a;
                        this._b2Body && this._b2Body.SetAngularVelocity(a * b)
                    }
                },
                fixedRotation: {
                    tooltip: !1,
                    get: function() {
                        return this._fixedRotation
                    },
                    set: function(a) {
                        this._fixedRotation = a;
                        this._b2Body && this._b2Body.SetFixedRotation(a)
                    }
                },
                awake: {
                    visible: !1,
                    tooltip: !1,
                    get: function() {
                        return !!this._b2Body && this._b2Body.IsAwake()
                    },
                    set: function(a) {
                        this._b2Body && this._b2Body.SetAwake(a)
                    }
                },
                awakeOnLoad: {
                    default: !0,
                    tooltip: !1,
                    animatable: !1
                },
                active: {
                    visible: !1,
                    get: function() {
                        return !!this._b2Body && this._b2Body.IsActive()
                    },
                    set: function(a) {
                        this._b2Body && this._b2Body.SetActive(a)
                    }
                }
            },
            getLocalPoint: function(a, b) {
                b = b || cc.v2();
                this._b2Body && (d.Set(a.x / e, a.y / e), a =
                    this._b2Body.GetLocalPoint(d, b), b.x = a.x * e, b.y = a.y * e);
                return b
            },
            getWorldPoint: function(a, b) {
                b = b || cc.v2();
                this._b2Body && (d.Set(a.x / e, a.y / e), a = this._b2Body.GetWorldPoint(d, b), b.x = a.x * e, b.y = a.y * e);
                return b
            },
            getWorldVector: function(a, b) {
                b = b || cc.v2();
                this._b2Body && (d.Set(a.x / e, a.y / e), a = this._b2Body.GetWorldVector(d, b), b.x = a.x * e, b.y = a.y * e);
                return b
            },
            getLocalVector: function(a, b) {
                b = b || cc.v2();
                this._b2Body && (d.Set(a.x / e, a.y / e), a = this._b2Body.GetLocalVector(d, b), b.x = a.x * e, b.y = a.y * e);
                return b
            },
            getWorldPosition: function(a) {
                a =
                    a || cc.v2();
                if (this._b2Body) {
                    var b = this._b2Body.GetPosition();
                    a.x = b.x * e;
                    a.y = b.y * e
                }
                return a
            },
            getWorldRotation: function() {
                return this._b2Body ? this._b2Body.GetAngle() * k : 0
            },
            getLocalCenter: function(a) {
                a = a || cc.v2();
                if (this._b2Body) {
                    var b = this._b2Body.GetLocalCenter();
                    a.x = b.x * e;
                    a.y = b.y * e
                }
                return a
            },
            getWorldCenter: function(a) {
                a = a || cc.v2();
                if (this._b2Body) {
                    var b = this._b2Body.GetWorldCenter();
                    a.x = b.x * e;
                    a.y = b.y * e
                }
                return a
            },
            getLinearVelocityFromWorldPoint: function(a, b) {
                b = b || cc.v2();
                this._b2Body && (d.Set(a.x / e, a.y /
                    e), a = this._b2Body.GetLinearVelocityFromWorldPoint(d, b), b.x = a.x * e, b.y = a.y * e);
                return b
            },
            getMass: function() {
                return this._b2Body ? this._b2Body.GetMass() : 0
            },
            getInertia: function() {
                return this._b2Body ? this._b2Body.GetInertia() * e * e : 0
            },
            getJointList: function() {
                if (!this._b2Body) return [];
                var a = [],
                    b = this._b2Body.GetJointList();
                if (!b) return [];
                a.push(b.joint._joint);
                for (var d = b.prev; d;) a.push(d.joint._joint), d = d.prev;
                for (b = b.next; b;) a.push(b.joint._joint), b = b.next;
                return a
            },
            applyForce: function(a, b, c) {
                this._b2Body &&
                    (d.Set(a.x / e, a.y / e), l.Set(b.x / e, b.y / e), this._b2Body.ApplyForce(d, l, c))
            },
            applyForceToCenter: function(a, b) {
                this._b2Body && (d.Set(a.x / e, a.y / e), this._b2Body.ApplyForceToCenter(d, b))
            },
            applyTorque: function(a, b) {
                this._b2Body && this._b2Body.ApplyTorque(a / e, b)
            },
            applyLinearImpulse: function(a, b, c) {
                this._b2Body && (d.Set(a.x / e, a.y / e), l.Set(b.x / e, b.y / e), this._b2Body.ApplyLinearImpulse(d, l, c))
            },
            applyAngularImpulse: function(a, b) {
                this._b2Body && this._b2Body.ApplyAngularImpulse(a / e / e, b)
            },
            syncPosition: function(b) {
                var d =
                    this._b2Body;
                if (d) {
                    var c = this.node.convertToWorldSpaceAR(g);
                    var l = this.type === a.Animated ? d.GetLinearVelocity() : d.GetPosition();
                    l.x = c.x / e;
                    l.y = c.y / e;
                    this.type === a.Animated && b ? (b = d.GetPosition(), c = cc.game.config.frameRate, l.x = (l.x - b.x) * c, l.y = (l.y - b.y) * c, d.SetAwake(!0), d.SetLinearVelocity(l)) : d.SetTransformVec(l, d.GetAngle())
                }
            },
            syncRotation: function(d) {
                var g = this._b2Body;
                if (g) {
                    var l = b * c(this.node);
                    if (this.type === a.Animated && d) {
                        d = g.GetAngle();
                        var e = cc.game.config.frameRate;
                        g.SetAwake(!0);
                        g.SetAngularVelocity((l -
                            d) * e)
                    } else g.SetTransformVec(g.GetPosition(), l)
                }
            },
            resetVelocity: function() {
                var a = this._b2Body;
                if (a) {
                    var b = a.m_linearVelocity;
                    b.Set(0, 0);
                    a.SetLinearVelocity(b);
                    a.SetAngularVelocity(0)
                }
            },
            onEnable: function() {
                this._init()
            },
            onDisable: function() {
                this._destroy()
            },
            _registerNodeEvents: function() {
                var a = this.node;
                a.on(f.POSITION_CHANGED, this._onNodePositionChanged, this);
                a.on(f.ROTATION_CHANGED, this._onNodeRotationChanged, this);
                a.on(f.SCALE_CHANGED, this._onNodeScaleChanged, this)
            },
            _unregisterNodeEvents: function() {
                var a =
                    this.node;
                a.off(f.POSITION_CHANGED, this._onNodePositionChanged, this);
                a.off(f.ROTATION_CHANGED, this._onNodeRotationChanged, this);
                a.off(f.SCALE_CHANGED, this._onNodeScaleChanged, this)
            },
            _onNodePositionChanged: function() {
                this.syncPosition(!0)
            },
            _onNodeRotationChanged: function(a) {
                this.syncRotation(!0)
            },
            _onNodeScaleChanged: function(a) {
                if (this._b2Body) {
                    a = this.getComponents(cc.PhysicsCollider);
                    for (var b = 0; b < a.length; b++) a[b].apply()
                }
            },
            _init: function() {
                cc.director.getPhysicsManager().pushDelayEvent(this, "__init", [])
            },
            _destroy: function() {
                cc.director.getPhysicsManager().pushDelayEvent(this, "__destroy", [])
            },
            __init: function() {
                if (!this._inited) {
                    this._registerNodeEvents();
                    var d = new b2.BodyDef;
                    this.type === a.Animated ? d.type = a.Kinematic : d.type = this.type;
                    d.allowSleep = this.allowSleep;
                    d.gravityScale = this.gravityScale;
                    d.linearDamping = this.linearDamping;
                    d.angularDamping = this.angularDamping;
                    var l = this.linearVelocity;
                    d.linearVelocity = new b2.Vec2(l.x / e, l.y / e);
                    d.angularVelocity = this.angularVelocity * b;
                    d.fixedRotation = this.fixedRotation;
                    d.bullet = this.bullet;
                    l = this.node;
                    var k = l.convertToWorldSpaceAR(g);
                    d.position = new b2.Vec2(k.x / e, k.y / e);
                    d.angle = -Math.PI / 180 * c(l);
                    d.awake = this.awakeOnLoad;
                    cc.director.getPhysicsManager()._addBody(this, d);
                    this._inited = !0
                }
            },
            __destroy: function() {
                this._inited && (cc.director.getPhysicsManager()._removeBody(this), this._unregisterNodeEvents(), this._inited = !1)
            },
            _getBody: function() {
                return this._b2Body
            }
        });
        cc.RigidBody = q.exports = h
    }, {
        "../CCNode": 40,
        "./CCPhysicsTypes": 180,
        "./utils": 203
    }],
    183: [function(h, q, m) {
        h = h("../../../external/box2d/box2d");
        window.b2 = {};
        for (var f in h) - 1 === f.indexOf("b2_") && (q = f.replace("b2", ""), b2[q] = h[f]);
        b2.maxPolygonVertices = 8
    }, {
        "../../../external/box2d/box2d": 374
    }],
    184: [function(h, q, m) {
        var f = h("../CCPhysicsTypes").PTM_RATIO;
        h = cc.Class({
            name: "cc.PhysicsBoxCollider",
            extends: cc.PhysicsCollider,
            mixins: [cc.Collider.Box],
            editor: {
                menu: !1,
                requireComponent: cc.RigidBody
            },
            _createShape: function(e) {
                var b = Math.abs(e.x),
                    k = Math.abs(e.y);
                e = this.size.width / 2 / f * b;
                var c = this.size.height / 2 / f * k;
                b *= this.offset.x / f;
                k *= this.offset.y / f;
                var a = new b2.PolygonShape;
                a.SetAsBox(e, c, new b2.Vec2(b, k), 0);
                return a
            }
        });
        cc.PhysicsBoxCollider = q.exports = h
    }, {
        "../CCPhysicsTypes": 180
    }],
    185: [function(h, q, m) {
        var f = h("../CCPhysicsTypes").PTM_RATIO;
        h = cc.Class({
            name: "cc.PhysicsChainCollider",
            extends: cc.PhysicsCollider,
            editor: {
                menu: !1,
                inspector: !1,
                requireComponent: cc.RigidBody
            },
            properties: {
                loop: !1,
                points: {
                    default: function() {
                        return [cc.v2(-50, 0), cc.v2(50, 0)]
                    },
                    type: [cc.Vec2]
                },
                threshold: {
                    default: 1,
                    serializable: !1,
                    visible: !1
                }
            },
            _createShape: function(e) {
                for (var b =
                        new b2.ChainShape, k = this.points, c = [], a = 0; a < k.length; a++) {
                    var d = k[a];
                    c.push(new b2.Vec2(d.x / f * e.x, d.y / f * e.y))
                }
                this.loop ? b.CreateLoop(c, c.length) : b.CreateChain(c, c.length);
                return b
            },
            resetInEditor: !1,
            resetPointsByContour: !1
        });
        cc.PhysicsChainCollider = q.exports = h
    }, {
        "../CCPhysicsTypes": 180
    }],
    186: [function(h, q, m) {
        var f = h("../CCPhysicsTypes").PTM_RATIO;
        h = cc.Class({
            name: "cc.PhysicsCircleCollider",
            extends: cc.PhysicsCollider,
            mixins: [cc.Collider.Circle],
            editor: {
                menu: !1,
                requireComponent: cc.RigidBody
            },
            _createShape: function(e) {
                var b =
                    Math.abs(e.x),
                    k = this.offset.x / f * b;
                e = this.offset.y / f * Math.abs(e.y);
                var c = new b2.CircleShape;
                c.m_radius = this.radius / f * b;
                c.m_p = new b2.Vec2(k, e);
                return c
            }
        });
        cc.PhysicsCircleCollider = q.exports = h
    }, {
        "../CCPhysicsTypes": 180
    }],
    187: [function(h, q, m) {
        var f = h("../CCPhysicsTypes").PTM_RATIO,
            e = h("../utils").getWorldScale;
        h = cc.Class({
            name: "cc.PhysicsCollider",
            extends: cc.Collider,
            ctor: function() {
                this._fixtures = [];
                this._shapes = [];
                this._inited = !1;
                this._rect = cc.rect()
            },
            properties: {
                _density: 1,
                _sensor: !1,
                _friction: .2,
                _restitution: 0,
                density: {
                    tooltip: !1,
                    get: function() {
                        return this._density
                    },
                    set: function(b) {
                        this._density = b
                    }
                },
                sensor: {
                    tooltip: !1,
                    get: function() {
                        return this._sensor
                    },
                    set: function(b) {
                        this._sensor = b
                    }
                },
                friction: {
                    tooltip: !1,
                    get: function() {
                        return this._friction
                    },
                    set: function(b) {
                        this._friction = b
                    }
                },
                restitution: {
                    tooltip: !1,
                    get: function() {
                        return this._restitution
                    },
                    set: function(b) {
                        this._restitution = b
                    }
                },
                body: {
                    default: null,
                    type: cc.RigidBody,
                    visible: !1
                }
            },
            onDisable: function() {
                this._destroy()
            },
            onEnable: function() {
                this._init()
            },
            start: function() {
                this._init()
            },
            _getFixtureIndex: function(b) {
                return this._fixtures.indexOf(b)
            },
            _init: function() {
                cc.director.getPhysicsManager().pushDelayEvent(this, "__init", [])
            },
            _destroy: function() {
                cc.director.getPhysicsManager().pushDelayEvent(this, "__destroy", [])
            },
            __init: function() {
                if (!this._inited) {
                    var b = this.body || this.getComponent(cc.RigidBody);
                    if (b) {
                        var k = b._getBody();
                        if (k) {
                            var c = b.node,
                                a = e(c);
                            this._scale = a;
                            a = 0 === a.x && 0 === a.y ? [] : this._createShape(a);
                            a instanceof Array || (a = [a]);
                            var d = 1 << c.groupIndex,
                                l = 0;
                            c = cc.game.collisionMatrix[c.groupIndex];
                            for (var g = 0; g < c.length; g++) c[g] && (l |= 1 << g);
                            d = {
                                categoryBits: d,
                                maskBits: l,
                                groupIndex: 0
                            };
                            l = cc.director.getPhysicsManager();
                            for (c = 0; c < a.length; c++) {
                                g = a[c];
                                var n = new b2.FixtureDef;
                                n.density = this.density;
                                n.isSensor = this.sensor;
                                n.friction = this.friction;
                                n.restitution = this.restitution;
                                n.shape = g;
                                n.filter = d;
                                n = k.CreateFixture(n);
                                n.collider = this;
                                b.enabledContactListener && l._registerContactFixture(n);
                                this._shapes.push(g);
                                this._fixtures.push(n)
                            }
                            this.body = b;
                            this._inited = !0
                        }
                    }
                }
            },
            __destroy: function() {
                if (this._inited) {
                    for (var b = this._fixtures, e = this.body._getBody(), c = cc.director.getPhysicsManager(), a = b.length - 1; 0 <= a; a--) {
                        var d = b[a];
                        d.collider = null;
                        c._unregisterContactFixture(d);
                        e && e.DestroyFixture(d)
                    }
                    this.body = null;
                    this._fixtures.length = 0;
                    this._shapes.length = 0;
                    this._inited = !1
                }
            },
            _createShape: function() {},
            apply: function() {
                this._destroy();
                this._init()
            },
            getAABB: function() {
                for (var b = 1E7, e = 1E7, c = -1E7, a = -1E7, d = this._fixtures, l = 0; l < d.length; l++)
                    for (var g = d[l], n = g.GetShape().GetChildCount(),
                            h = 0; h < n; h++) {
                        var t = g.GetAABB(h);
                        t.lowerBound.x < b && (b = t.lowerBound.x);
                        t.lowerBound.y < e && (e = t.lowerBound.y);
                        t.upperBound.x > c && (c = t.upperBound.x);
                        t.upperBound.y > a && (a = t.upperBound.y)
                    }
                b *= f;
                e *= f;
                c *= f;
                a *= f;
                d = this._rect;
                d.x = b;
                d.y = e;
                d.width = c - b;
                d.height = a - e;
                return d
            }
        });
        cc.PhysicsCollider = q.exports = h
    }, {
        "../CCPhysicsTypes": 180,
        "../utils": 203
    }],
    188: [function(h, q, m) {
        var f = h("../CCPhysicsTypes").PTM_RATIO,
            e = h("../CCPolygonSeparator");
        h = cc.Class({
            name: "cc.PhysicsPolygonCollider",
            extends: cc.PhysicsCollider,
            mixins: [cc.Collider.Polygon],
            editor: {
                menu: !1,
                inspector: !1,
                requireComponent: cc.RigidBody
            },
            _createShape: function(b) {
                var k = [],
                    c = this.points;
                0 < c.length && c[0].equals(c[c.length - 1]) && --c.length;
                c = e.ConvexPartition(c);
                for (var a = this.offset, d = 0; d < c.length; d++) {
                    for (var l = c[d], g = null, n = [], h = null, t = 0, p = l.length; t < p; t++) {
                        g || (g = new b2.PolygonShape);
                        var u = l[t];
                        u = new b2.Vec2((u.x + a.x) / f * b.x, (u.y + a.y) / f * b.y);
                        n.push(u);
                        h || (h = u);
                        n.length === b2.maxPolygonVertices && (g.Set(n, n.length), k.push(g), g = null, t < p - 1 && (n = [h, n[n.length - 1]]))
                    }
                    g && (g.Set(n, n.length),
                        k.push(g))
                }
                return k
            }
        });
        cc.PhysicsPolygonCollider = q.exports = h
    }, {
        "../CCPhysicsTypes": 180,
        "../CCPolygonSeparator": 181
    }],
    189: [function(h, q, m) {
        h("./box2d-adapter");
        h("./CCPhysicsManager");
        h("./CCRigidBody");
        h("./CCPhysicsContact");
        h("./collider/CCPhysicsCollider");
        h("./collider/CCPhysicsChainCollider");
        h("./collider/CCPhysicsCircleCollider");
        h("./collider/CCPhysicsBoxCollider");
        h("./collider/CCPhysicsPolygonCollider");
        h("./joint/CCJoint");
        h("./joint/CCDistanceJoint");
        h("./joint/CCRevoluteJoint");
        h("./joint/CCMouseJoint");
        h("./joint/CCMotorJoint");
        h("./joint/CCPrismaticJoint");
        h("./joint/CCWeldJoint");
        h("./joint/CCWheelJoint");
        h("./joint/CCRopeJoint");
        h("./platform/CCPhysicsContactListner");
        h("./platform/CCPhysicsAABBQueryCallback");
        h("./platform/CCPhysicsRayCastCallback")
    }, {
        "./CCPhysicsContact": 178,
        "./CCPhysicsManager": 179,
        "./CCRigidBody": 182,
        "./box2d-adapter": 183,
        "./collider/CCPhysicsBoxCollider": 184,
        "./collider/CCPhysicsChainCollider": 185,
        "./collider/CCPhysicsCircleCollider": 186,
        "./collider/CCPhysicsCollider": 187,
        "./collider/CCPhysicsPolygonCollider": 188,
        "./joint/CCDistanceJoint": 190,
        "./joint/CCJoint": 191,
        "./joint/CCMotorJoint": 192,
        "./joint/CCMouseJoint": 193,
        "./joint/CCPrismaticJoint": 194,
        "./joint/CCRevoluteJoint": 195,
        "./joint/CCRopeJoint": 196,
        "./joint/CCWeldJoint": 197,
        "./joint/CCWheelJoint": 198,
        "./platform/CCPhysicsAABBQueryCallback": 199,
        "./platform/CCPhysicsContactListner": 200,
        "./platform/CCPhysicsRayCastCallback": 202
    }],
    190: [function(h, q, m) {
        var f = h("../CCPhysicsTypes").PTM_RATIO;
        h = cc.Class({
            name: "cc.DistanceJoint",
            extends: cc.Joint,
            editor: !1,
            properties: {
                _distance: 1,
                _frequency: 0,
                _dampingRatio: 0,
                distance: {
                    tooltip: !1,
                    get: function() {
                        return this._distance
                    },
                    set: function(e) {
                        this._distance = e;
                        this._joint && this._joint.SetLength(e)
                    }
                },
                frequency: {
                    tooltip: !1,
                    get: function() {
                        return this._frequency
                    },
                    set: function(e) {
                        this._frequency = e;
                        this._joint && this._joint.SetFrequency(e)
                    }
                },
                dampingRatio: {
                    tooltip: !1,
                    get: function() {
                        return this._dampingRatio
                    },
                    set: function(e) {
                        this._dampingRatio = e;
                        this._joint && this._joint.SetDampingRatio(e)
                    }
                }
            },
            _createJointDef: function() {
                var e = new b2.DistanceJointDef;
                e.localAnchorA = new b2.Vec2(this.anchor.x / f, this.anchor.y / f);
                e.localAnchorB = new b2.Vec2(this.connectedAnchor.x / f, this.connectedAnchor.y / f);
                e.length = this.distance / f;
                e.dampingRatio = this.dampingRatio;
                e.frequencyHz = this.frequency;
                return e
            }
        });
        cc.DistanceJoint = q.exports = h
    }, {
        "../CCPhysicsTypes": 180
    }],
    191: [function(h, q, m) {
            var f = h("../CCPhysicsTypes").PTM_RATIO;
            h = cc.Class({
                name: "cc.Joint",
                extends: cc.Component,
                editor: {
                    requireComponent: cc.RigidBody
                },
                properties: {
                    anchor: {
                        default: cc.v2(0,
                            0),
                        tooltip: !1
                    },
                    connectedAnchor: {
                        default: cc.v2(0, 0),
                        tooltip: !1
                    },
                    connectedBody: {
                        default: null,
                        type: cc.RigidBody,
                        tooltip: !1
                    },
                    collideConnected: {
                        default: !1,
                        tooltip: !1
                    }
                },
                onDisable: function() {
                    this._destroy()
                },
                onEnable: function() {
                    this._init()
                },
                start: function() {
                    this._init()
                },
                apply: function() {
                    this._destroy();
                    this._init()
                },
                getWorldAnchor: function() {
                    if (this._joint) {
                        var e = this._joint.GetAnchorA();
                        return cc.v2(e.x * f, e.y * f)
                    }
                    return cc.Vec2.ZERO
                },
                getWorldConnectedAnchor: function() {
                    if (this._joint) {
                        var e = this._joint.GetAnchorB();
                        return cc.v2(e.x * f, e.y * f)
                    }
                    return cc.Vec2.ZERO
                },
                getReactionForce: function(e) {
                    var b = cc.v2();
                    return this._joint ? this._joint.GetReactionForce(e, b) : b
                },
                getReactionTorque: function(e) {
                    return this._joint ? this._joint.GetReactionTorque(e) : 0
                },
                _init: function() {
                    cc.director.getPhysicsManager().pushDelayEvent(this, "__init", [])
                },
                _destroy: function() {
                    cc.director.getPhysicsManager().pushDelayEvent(this, "__destroy", [])
                },
                __init: function() {
                    if (!this._inited && (this.body = this.getComponent(cc.RigidBody), this._isValid())) {
                        var e =
                            this._createJointDef();
                        e && (e.bodyA = this.body._getBody(), e.bodyB = this.connectedBody._getBody(), e.collideConnected = this.collideConnected, cc.director.getPhysicsManager()._addJoint(this, e), this._inited = !0)
                    }
                },
                __destroy: function() {
                    this._inited && (cc.director.getPhysicsManager()._removeJoint(this), this._joint = null, this._inited = !1)
                },
                _createJointDef: function() {
                    return null
                },
                _isValid: function() {
                    return this.body && this.body._getBody() && this.connectedBody && this.connectedBody._getBody()
                }
            });
            cc.Joint = q.exports = h
        },
        {
            "../CCPhysicsTypes": 180
        }
    ],
    192: [function(h, q, m) {
        var f = h("../CCPhysicsTypes").PTM_RATIO,
            e = h("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE;
        h = cc.Class({
            name: "cc.MotorJoint",
            extends: cc.Joint,
            editor: !1,
            properties: {
                _linearOffset: cc.v2(0, 0),
                _angularOffset: 0,
                _maxForce: 1,
                _maxTorque: 1,
                _correctionFactor: .3,
                anchor: {
                    tooltip: !1,
                    default: cc.v2(0, 0),
                    override: !0,
                    visible: !1
                },
                connectedAnchor: {
                    tooltip: !1,
                    default: cc.v2(0, 0),
                    override: !0,
                    visible: !1
                },
                linearOffset: {
                    tooltip: !1,
                    get: function() {
                        return this._linearOffset
                    },
                    set: function(b) {
                        this._linearOffset =
                            b;
                        this._joint && this._joint.SetLinearOffset(new b2.Vec2(b.x / f, b.y / f))
                    }
                },
                angularOffset: {
                    tooltip: !1,
                    get: function() {
                        return this._angularOffset
                    },
                    set: function(b) {
                        this._angularOffset = b;
                        this._joint && this._joint.SetAngularOffset(b)
                    }
                },
                maxForce: {
                    tooltip: !1,
                    get: function() {
                        return this._maxForce
                    },
                    set: function(b) {
                        this._maxForce = b;
                        this._joint && this._joint.SetMaxForce(b)
                    }
                },
                maxTorque: {
                    tooltip: !1,
                    get: function() {
                        return this._maxTorque
                    },
                    set: function(b) {
                        this._maxTorque = b;
                        this._joint && this._joint.SetMaxTorque(b)
                    }
                },
                correctionFactor: {
                    tooltip: !1,
                    get: function() {
                        return this._correctionFactor
                    },
                    set: function(b) {
                        this._correctionFactor = b;
                        this._joint && this._joint.SetCorrectionFactor(b)
                    }
                }
            },
            _createJointDef: function() {
                var b = new b2.MotorJointDef;
                b.linearOffset = new b2.Vec2(this.linearOffset.x / f, this.linearOffset.y / f);
                b.angularOffset = this.angularOffset * e;
                b.maxForce = this.maxForce;
                b.maxTorque = this.maxTorque;
                b.correctionFactor = this.correctionFactor;
                return b
            }
        });
        cc.MotorJoint = q.exports = h
    }, {
        "../CCPhysicsTypes": 180
    }],
    193: [function(h, q, m) {
        var f = h("../CCPhysicsTypes").PTM_RATIO,
            e = new b2.Vec2;
        h = cc.Class({
            name: "cc.MouseJoint",
            extends: cc.Joint,
            editor: !1,
            properties: {
                _target: 1,
                _frequency: 5,
                _dampingRatio: .7,
                _maxForce: 0,
                connectedBody: {
                    default: null,
                    type: cc.RigidBody,
                    visible: !1,
                    override: !0
                },
                collideConnected: {
                    default: !0,
                    visible: !1,
                    override: !0
                },
                anchor: {
                    tooltip: !1,
                    default: cc.v2(0, 0),
                    override: !0,
                    visible: !1
                },
                connectedAnchor: {
                    tooltip: !1,
                    default: cc.v2(0, 0),
                    override: !0,
                    visible: !1
                },
                mouseRegion: {
                    tooltip: !1,
                    default: null,
                    type: cc.Node
                },
                target: {
                    tooltip: !1,
                    visible: !1,
                    get: function() {
                        return this._target
                    },
                    set: function(b) {
                        this._target = b;
                        this._joint && (e.x = b.x / f, e.y = b.y / f, this._joint.SetTarget(e))
                    }
                },
                frequency: {
                    tooltip: !1,
                    get: function() {
                        return this._frequency
                    },
                    set: function(b) {
                        this._frequency = b;
                        this._joint && this._joint.SetFrequency(b)
                    }
                },
                dampingRatio: {
                    tooltip: !1,
                    get: function() {
                        return this._dampingRatio
                    },
                    set: function(b) {
                        this._dampingRatio = b;
                        this._joint && this._joint.SetDampingRatio(b)
                    }
                },
                maxForce: {
                    tooltip: !1,
                    visible: !1,
                    get: function() {
                        return this._maxForce
                    },
                    set: function(b) {
                        this._maxForce = b;
                        this._joint && this._joint.SetMaxForce(b)
                    }
                }
            },
            onLoad: function() {
                var b = this.mouseRegion || this.node;
                b.on(cc.Node.EventType.TOUCH_START, this.onTouchBegan, this);
                b.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this);
                b.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);
                b.on(cc.Node.EventType.TOUCH_CANCEL, this.onTouchEnd, this)
            },
            onEnable: function() {},
            start: function() {},
            onTouchBegan: function(b) {
                var e = cc.director.getPhysicsManager();
                b = this._pressPoint = b.touch.getLocation();
                cc.Camera && cc.Camera.main && (b = cc.Camera.main.getScreenToWorldPoint(b));
                if (e =
                    e.testPoint(b))(this.connectedBody = e.body).awake = !0, this.maxForce = 1E3 * this.connectedBody.getMass(), this.target = b, this._init()
            },
            onTouchMove: function(b) {
                this._pressPoint = b.touch.getLocation()
            },
            onTouchEnd: function(b) {
                this._destroy();
                this._pressPoint = null
            },
            _createJointDef: function() {
                var b = new b2.MouseJointDef;
                e.x = this.target.x / f;
                e.y = this.target.y / f;
                b.target = e;
                b.maxForce = this.maxForce;
                b.dampingRatio = this.dampingRatio;
                b.frequencyHz = this.frequency;
                return b
            },
            update: function() {
                if (this._pressPoint && this._isValid()) {
                    var b =
                        cc.Camera.findCamera(this.node);
                    this.target = b ? b.getScreenToWorldPoint(this._pressPoint) : this._pressPoint
                }
            }
        });
        cc.MouseJoint = q.exports = h
    }, {
        "../CCPhysicsTypes": 180
    }],
    194: [function(h, q, m) {
        var f = h("../CCPhysicsTypes").PTM_RATIO,
            e = h("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE;
        h = cc.Class({
            name: "cc.PrismaticJoint",
            extends: cc.Joint,
            editor: !1,
            properties: {
                localAxisA: {
                    default: cc.v2(1, 0),
                    tooltip: !1
                },
                referenceAngle: {
                    default: 0,
                    tooltip: !1
                },
                enableLimit: {
                    default: !1,
                    tooltip: !1
                },
                enableMotor: {
                    default: !1,
                    tooltip: !1
                },
                lowerLimit: {
                    default: 0,
                    tooltip: !1
                },
                upperLimit: {
                    default: 0,
                    tooltip: !1
                },
                _maxMotorForce: 0,
                _motorSpeed: 0,
                maxMotorForce: {
                    tooltip: !1,
                    get: function() {
                        return this._maxMotorForce
                    },
                    set: function(b) {
                        this._maxMotorForce = b;
                        this._joint && this._joint.SetMaxMotorForce(b)
                    }
                },
                motorSpeed: {
                    tooltip: !1,
                    get: function() {
                        return this._motorSpeed
                    },
                    set: function(b) {
                        this._motorSpeed = b;
                        this._joint && this._joint.SetMotorSpeed(b)
                    }
                }
            },
            _createJointDef: function() {
                var b = new b2.PrismaticJointDef;
                b.localAnchorA = new b2.Vec2(this.anchor.x / f, this.anchor.y / f);
                b.localAnchorB =
                    new b2.Vec2(this.connectedAnchor.x / f, this.connectedAnchor.y / f);
                b.localAxisA = new b2.Vec2(this.localAxisA.x, this.localAxisA.y);
                b.referenceAngle = this.referenceAngle * e;
                b.enableLimit = this.enableLimit;
                b.lowerTranslation = this.lowerLimit / f;
                b.upperTranslation = this.upperLimit / f;
                b.enableMotor = this.enableMotor;
                b.maxMotorForce = this.maxMotorForce;
                b.motorSpeed = this.motorSpeed;
                return b
            }
        });
        cc.PrismaticJoint = q.exports = h
    }, {
        "../CCPhysicsTypes": 180
    }],
    195: [function(h, q, m) {
        var f = h("../CCPhysicsTypes").PTM_RATIO,
            e = h("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE,
            b = h("../CCPhysicsTypes").PHYSICS_ANGLE_TO_ANGLE;
        h = cc.Class({
            name: "cc.RevoluteJoint",
            extends: cc.Joint,
            editor: !1,
            properties: {
                _maxMotorTorque: 0,
                _motorSpeed: 0,
                _enableLimit: !1,
                _enableMotor: !1,
                referenceAngle: {
                    default: 0,
                    tooltip: !1
                },
                lowerAngle: {
                    default: 0,
                    tooltip: !1
                },
                upperAngle: {
                    default: 0,
                    tooltip: !1
                },
                maxMotorTorque: {
                    tooltip: !1,
                    get: function() {
                        return this._maxMotorTorque
                    },
                    set: function(b) {
                        this._maxMotorTorque = b;
                        this._joint && this._joint.SetMaxMotorTorque(b)
                    }
                },
                motorSpeed: {
                    tooltip: !1,
                    get: function() {
                        return this._motorSpeed
                    },
                    set: function(b) {
                        this._motorSpeed = b;
                        this._joint && this._joint.SetMotorSpeed(b * e)
                    }
                },
                enableLimit: {
                    tooltip: !1,
                    get: function() {
                        return this._enableLimit
                    },
                    set: function(b) {
                        this._enableLimit = b;
                        this._joint && this._joint.EnableLimit(b)
                    }
                },
                enableMotor: {
                    tooltip: !1,
                    get: function() {
                        return this._enableMotor
                    },
                    set: function(b) {
                        this._enableMotor = b;
                        this._joint && this._joint.EnableMotor(b)
                    }
                }
            },
            getJointAngle: function() {
                return this._joint ? this._joint.GetJointAngle() * b : 0
            },
            setLimits: function(b, c) {
                if (this._joint) return this._joint.SetLimits(b *
                    e, c * e)
            },
            _createJointDef: function() {
                var b = new b2.RevoluteJointDef;
                b.localAnchorA = new b2.Vec2(this.anchor.x / f, this.anchor.y / f);
                b.localAnchorB = new b2.Vec2(this.connectedAnchor.x / f, this.connectedAnchor.y / f);
                b.lowerAngle = this.upperAngle * e;
                b.upperAngle = this.lowerAngle * e;
                b.maxMotorTorque = this.maxMotorTorque;
                b.motorSpeed = this.motorSpeed * e;
                b.enableLimit = this.enableLimit;
                b.enableMotor = this.enableMotor;
                b.referenceAngle = this.referenceAngle * e;
                return b
            }
        });
        cc.RevoluteJoint = q.exports = h
    }, {
        "../CCPhysicsTypes": 180
    }],
    196: [function(h, q, m) {
        var f = h("../CCPhysicsTypes").PTM_RATIO;
        h = cc.Class({
            name: "cc.RopeJoint",
            extends: cc.Joint,
            editor: !1,
            properties: {
                _maxLength: 1,
                maxLength: {
                    tooltip: !1,
                    get: function() {
                        return this._maxLength
                    },
                    set: function(e) {
                        this._maxLength = e;
                        this._joint && this._joint.SetMaxLength(e)
                    }
                }
            },
            _createJointDef: function() {
                var e = new b2.RopeJointDef;
                e.localAnchorA = new b2.Vec2(this.anchor.x / f, this.anchor.y / f);
                e.localAnchorB = new b2.Vec2(this.connectedAnchor.x / f, this.connectedAnchor.y / f);
                e.maxLength = this.maxLength /
                    f;
                return e
            }
        });
        cc.RopeJoint = q.exports = h
    }, {
        "../CCPhysicsTypes": 180
    }],
    197: [function(h, q, m) {
        var f = h("../CCPhysicsTypes").PTM_RATIO,
            e = h("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE;
        h = cc.Class({
            name: "cc.WeldJoint",
            extends: cc.Joint,
            editor: !1,
            properties: {
                referenceAngle: {
                    default: 0,
                    tooltip: !1
                },
                _frequency: 0,
                _dampingRatio: 0,
                frequency: {
                    tooltip: !1,
                    get: function() {
                        return this._frequency
                    },
                    set: function(b) {
                        this._frequency = b;
                        this._joint && this._joint.SetFrequency(b)
                    }
                },
                dampingRatio: {
                    tooltip: !1,
                    get: function() {
                        return this._dampingRatio
                    },
                    set: function(b) {
                        this._dampingRatio = b;
                        this._joint && this._joint.SetDampingRatio(b)
                    }
                }
            },
            _createJointDef: function() {
                var b = new b2.WeldJointDef;
                b.localAnchorA = new b2.Vec2(this.anchor.x / f, this.anchor.y / f);
                b.localAnchorB = new b2.Vec2(this.connectedAnchor.x / f, this.connectedAnchor.y / f);
                b.referenceAngle = this.referenceAngle * e;
                b.frequencyHz = this.frequency;
                b.dampingRatio = this.dampingRatio;
                return b
            }
        });
        cc.WeldJoint = q.exports = h
    }, {
        "../CCPhysicsTypes": 180
    }],
    198: [function(h, q, m) {
        var f = h("../CCPhysicsTypes").PTM_RATIO,
            e = h("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE;
        h = cc.Class({
            name: "cc.WheelJoint",
            extends: cc.Joint,
            editor: !1,
            properties: {
                _maxMotorTorque: 0,
                _motorSpeed: 0,
                _enableMotor: !1,
                _frequency: 2,
                _dampingRatio: .7,
                localAxisA: {
                    default: cc.v2(1, 0),
                    tooltip: !1
                },
                maxMotorTorque: {
                    tooltip: !1,
                    get: function() {
                        return this._maxMotorTorque
                    },
                    set: function(b) {
                        this._maxMotorTorque = b;
                        this._joint && this._joint.SetMaxMotorTorque(b)
                    }
                },
                motorSpeed: {
                    tooltip: !1,
                    get: function() {
                        return this._motorSpeed
                    },
                    set: function(b) {
                        this._motorSpeed = b;
                        this._joint &&
                            this._joint.SetMotorSpeed(b * e)
                    }
                },
                enableMotor: {
                    tooltip: !1,
                    get: function() {
                        return this._enableMotor
                    },
                    set: function(b) {
                        this._enableMotor = b;
                        this._joint && this._joint.EnableMotor(b)
                    }
                },
                frequency: {
                    tooltip: !1,
                    get: function() {
                        return this._frequency
                    },
                    set: function(b) {
                        this._frequency = b;
                        this._joint && this._joint.SetSpringFrequencyHz(b)
                    }
                },
                dampingRatio: {
                    tooltip: !1,
                    get: function() {
                        return this._dampingRatio
                    },
                    set: function(b) {
                        this._dampingRatio = b;
                        this._joint && this._joint.SetDampingRatio(b)
                    }
                }
            },
            _createJointDef: function() {
                var b =
                    new b2.WheelJointDef;
                b.localAnchorA = new b2.Vec2(this.anchor.x / f, this.anchor.y / f);
                b.localAnchorB = new b2.Vec2(this.connectedAnchor.x / f, this.connectedAnchor.y / f);
                b.localAxisA = new b2.Vec2(this.localAxisA.x, this.localAxisA.y);
                b.maxMotorTorque = this.maxMotorTorque;
                b.motorSpeed = this.motorSpeed * e;
                b.enableMotor = this.enableMotor;
                b.dampingRatio = this.dampingRatio;
                b.frequencyHz = this.frequency;
                return b
            }
        });
        cc.WheelJoint = q.exports = h
    }, {
        "../CCPhysicsTypes": 180
    }],
    199: [function(h, q, m) {
        function f() {
            this._point = new b2.Vec2;
            this._isPoint = !1;
            this._fixtures = []
        }
        var e = h("../CCPhysicsTypes").BodyType;
        f.prototype.init = function(b) {
            b ? (this._isPoint = !0, this._point.x = b.x, this._point.y = b.y) : this._isPoint = !1;
            this._fixtures.length = 0
        };
        f.prototype.ReportFixture = function(b) {
            if (b.GetBody().GetType() === e.Dynamic)
                if (this._isPoint) {
                    if (b.TestPoint(this._point)) return this._fixtures.push(b), !1
                } else this._fixtures.push(b);
            return !0
        };
        f.prototype.getFixture = function() {
            return this._fixtures[0]
        };
        f.prototype.getFixtures = function() {
            return this._fixtures
        };
        cc.PhysicsAABBQueryCallback = q.exports = f
    }, {
        "../CCPhysicsTypes": 180
    }],
    200: [function(h, q, m) {
        function f() {
            this._contactFixtures = []
        }
        f.prototype.setBeginContact = function(e) {
            this._BeginContact = e
        };
        f.prototype.setEndContact = function(e) {
            this._EndContact = e
        };
        f.prototype.setPreSolve = function(e) {
            this._PreSolve = e
        };
        f.prototype.setPostSolve = function(e) {
            this._PostSolve = e
        };
        f.prototype.BeginContact = function(e) {
            if (this._BeginContact) {
                var b = e.GetFixtureA(),
                    k = e.GetFixtureB(),
                    c = this._contactFixtures;
                e._shouldReport = !1;
                if (-1 !==
                    c.indexOf(b) || -1 !== c.indexOf(k)) e._shouldReport = !0, this._BeginContact(e)
            }
        };
        f.prototype.EndContact = function(e) {
            this._EndContact && e._shouldReport && (e._shouldReport = !1, this._EndContact(e))
        };
        f.prototype.PreSolve = function(e, b) {
            this._PreSolve && e._shouldReport && this._PreSolve(e, b)
        };
        f.prototype.PostSolve = function(e, b) {
            this._PostSolve && e._shouldReport && this._PostSolve(e, b)
        };
        f.prototype.registerContactFixture = function(e) {
            this._contactFixtures.push(e)
        };
        f.prototype.unregisterContactFixture = function(e) {
            cc.js.array.remove(this._contactFixtures,
                e)
        };
        cc.PhysicsContactListener = q.exports = f
    }, {}],
    201: [function(h, q, m) {
        function f(a) {
            b2.Draw.call(this);
            this._drawer = a;
            this._xf = this._dxf = new b2.Transform
        }
        var e = h("../CCPhysicsTypes").PTM_RATIO,
            b = cc.v2(),
            k = cc.Color.GREEN,
            c = cc.Color.RED;
        cc.js.extend(f, b2.Draw);
        cc.js.mixin(f.prototype, {
            _DrawPolygon: function(a, d) {
                for (var c = this._drawer, g = 0; g < d; g++) {
                    b2.Transform.MulXV(this._xf, a[g], b);
                    var k = b.x * e,
                        f = b.y * e;
                    0 === g ? c.moveTo(k, f) : c.lineTo(k, f)
                }
                c.close()
            },
            DrawPolygon: function(a, b, c) {
                this._applyStrokeColor(c);
                this._DrawPolygon(a,
                    b);
                this._drawer.stroke()
            },
            DrawSolidPolygon: function(a, b, c) {
                this._applyFillColor(c);
                this._DrawPolygon(a, b);
                this._drawer.fill();
                this._drawer.stroke()
            },
            _DrawCircle: function(a, b) {
                var d = this._xf.p;
                this._drawer.circle((a.x + d.x) * e, (a.y + d.y) * e, b * e)
            },
            DrawCircle: function(a, b, c) {
                this._applyStrokeColor(c);
                this._DrawCircle(a, b);
                this._drawer.stroke()
            },
            DrawSolidCircle: function(a, b, c, g) {
                this._applyFillColor(g);
                this._DrawCircle(a, b);
                this._drawer.fill()
            },
            DrawSegment: function(a, d, c) {
                var g = this._drawer;
                a.x === d.x && a.y ===
                    d.y ? (this._applyFillColor(c), this._DrawCircle(a, 2 / e), g.fill()) : (this._applyStrokeColor(c), b2.Transform.MulXV(this._xf, a, b), g.moveTo(b.x * e, b.y * e), b2.Transform.MulXV(this._xf, d, b), g.lineTo(b.x * e, b.y * e), g.stroke())
            },
            DrawTransform: function(a) {
                var d = this._drawer;
                d.strokeColor = c;
                b.x = b.y = 0;
                b2.Transform.MulXV(a, b, b);
                d.moveTo(b.x * e, b.y * e);
                b.x = 1;
                b.y = 0;
                b2.Transform.MulXV(a, b, b);
                d.lineTo(b.x * e, b.y * e);
                d.stroke();
                d.strokeColor = k;
                b.x = b.y = 0;
                b2.Transform.MulXV(a, b, b);
                d.moveTo(b.x * e, b.y * e);
                b.x = 0;
                b.y = 1;
                b2.Transform.MulXV(a,
                    b, b);
                d.lineTo(b.x * e, b.y * e);
                d.stroke()
            },
            DrawPoint: function(a, b, c) {},
            _applyStrokeColor: function(a) {
                var b = this._drawer.strokeColor;
                b.r = 255 * a.r;
                b.g = 255 * a.g;
                b.b = 255 * a.b;
                b.a = 150;
                this._drawer.strokeColor = b
            },
            _applyFillColor: function(a) {
                var b = this._drawer.fillColor;
                b.r = 255 * a.r;
                b.g = 255 * a.g;
                b.b = 255 * a.b;
                b.a = 150;
                this._drawer.fillColor = b
            },
            PushTransform: function(a) {
                this._xf = a
            },
            PopTransform: function() {
                this._xf = this._dxf
            }
        });
        q.exports = f
    }, {
        "../CCPhysicsTypes": 180
    }],
    202: [function(h, q, m) {
        function f() {
            this._type = 0;
            this._fixtures = [];
            this._points = [];
            this._normals = [];
            this._fractions = []
        }
        f.prototype.init = function(e) {
            this._type = e;
            this._fixtures.length = 0;
            this._points.length = 0;
            this._normals.length = 0;
            this._fractions.length = 0
        };
        f.prototype.ReportFixture = function(e, b, k, c) {
            if (0 === this._type) return this._fixtures[0] = e, this._points[0] = b, this._normals[0] = k, this._fractions[0] = c;
            this._fixtures.push(e);
            this._points.push(cc.v2(b));
            this._normals.push(cc.v2(k));
            this._fractions.push(c);
            return 1 === this._type ? 0 : 2 <= this._type ? 1 : c
        };
        f.prototype.getFixtures =
            function() {
                return this._fixtures
            };
        f.prototype.getPoints = function() {
            return this._points
        };
        f.prototype.getNormals = function() {
            return this._normals
        };
        f.prototype.getFractions = function() {
            return this._fractions
        };
        cc.PhysicsRayCastCallback = q.exports = f
    }, {}],
    203: [function(h, q, m) {
        q.exports = {
            getWorldRotation: function(f) {
                var e = f.angle;
                for (f = f.parent; f.parent;) e += f.angle, f = f.parent;
                return -e
            },
            getWorldScale: function(f) {
                var e = f.scaleX,
                    b = f.scaleY;
                for (f = f.parent; f.parent;) e *= f.scaleX, b *= f.scaleY, f = f.parent;
                return cc.v2(e,
                    b)
            },
            convertToNodeRotation: function(f, e) {
                e -= -f.angle;
                for (f = f.parent; f.parent;) e -= -f.angle, f = f.parent;
                return e
            }
        }
    }, {}],
    204: [function(h, q, m) {
        function f(a, b, d, c, g) {
            g = c["default"];
            !1;
            B.setClassAttr(a, d, "default", g);
            !1;
            g = a.__props__;
            0 > g.indexOf(d) && g.push(d);
            u(a, c, b, d, !1);
            !1;
            !1
        }

        function e(a, b, d, c, g) {
            var l = c.get,
                e = c.set,
                k = a.prototype,
                n = !Object.getOwnPropertyDescriptor(k, d);
            l && (!1, u(a, c, b, d, !0), !1, !1, B.setClassAttr(a, d, "serializable", !1), !1, g || v.get(k, d, l, n, n), !1, !1);
            e && (g || (!1, v.set(k, d, e, n, n)), !1, !1)
        }

        function b(a) {
            return "function" ===
                typeof a ? (!1, a()) : a
        }

        function k(a, b, d) {
            for (var c in b) a.hasOwnProperty(c) || d && !d(c) || Object.defineProperty(a, c, v.getPropertyDescriptor(b, c))
        }

        function c(a, b, d, c) {
            var l = c.__ctor__,
                e = c.ctor,
                f = c.__ES6__;
            !1;
            f ? (l = [e], c = e) : (l = l ? [l] : n(b, d, c), c = G(l, b, a, c), v.value(c, "extend", function(a) {
                a["extends"] = this;
                return p(a)
            }, !0));
            v.value(c, "__ctors__", 0 < l.length ? l : null, !0);
            e = c.prototype;
            b && (f || (v.extend(c, b), e = c.prototype), c.$super = b, !1);
            if (d) {
                for (b = d.length - 1; 0 <= b; b--) {
                    var h = d[b];
                    k(e, h.prototype);
                    k(c, h, function(a) {
                        return h.hasOwnProperty(a) &&
                            !0
                    });
                    p._isCCClass(h) && k(B.getClassAttrs(c), B.getClassAttrs(h))
                }
                e.constructor = c
            }
            f || (e.__initProps__ = g);
            v.setClassName(a, c);
            return c
        }

        function a(a, b, d, g) {
            var l = cc.Component,
                e = cc._RF.peek();
            if (e && v.isChildClassOf(b, l)) {
                if (v.isChildClassOf(e.cls, l)) return cc.errorID(3615), null;
                !1;
                a = a || e.script
            }
            a = c(a, b, d, g);
            if (e)
                if (v.isChildClassOf(b, l)) {
                    if (b = e.uuid) v._setClassId(b, a), !1;
                    e.cls = a
                } else v.isChildClassOf(e.cls, l) || (e.cls = a);
            return a
        }

        function d(a) {
            var b = v.getClassName(a),
                d = a.constructor;
            b = "new " + b + "(";
            for (var c =
                    0; c < d.__props__.length; c++) {
                var g = a[d.__props__[c]];
                !1;
                b += g;
                c < d.__props__.length - 1 && (b += ",")
            }
            return b + ")"
        }

        function l(a) {
            return JSON.stringify(a).replace(/\u2028/g, "\\u2028").replace(/\u2029/g, "\\u2029")
        }

        function g(a) {
            var b = B.getClassAttrs(a),
                c = a.__props__;
            null === c && (x.init(), c = a.__props__);
            for (var g = [], e = "", k = 0; k < c.length; k++) {
                var n = c[k],
                    p = n + E + "default";
                if (p in b) {
                    n = C.test(n) ? "this." + n + "=" : "this[" + l(n) + "]=";
                    p = b[p];
                    if ("object" === typeof p && p) p = p instanceof cc.ValueType ? d(p) : Array.isArray(p) ? "[]" : "{}";
                    else if ("function" === typeof p) {
                        var f = g.length;
                        g.push(p);
                        p = "F[" + f + "]()";
                        !1
                    } else p = "string" === typeof p ? l(p) : p;
                    n = n + p + ";\n";
                    e += n
                }
            }
            b = 0 === g.length ? Function(e) : Function("F", "return (function(){\n" + e + "})")(g);
            a.prototype.__initProps__ = b;
            b.call(this)
        }

        function n(a, b, d) {
            var c = [];
            a = [a].concat(b);
            for (b = 0; b < a.length; b++) {
                var g = a[b];
                if (g) {
                    g = p._isCCClass(g) ? g.__ctors__ || [] : [g];
                    for (var l = 0; l < g.length; l++) {
                        var e = c,
                            k = g[l];
                        0 > e.indexOf(k) && e.push(k)
                    }
                }
            }(d = d.ctor) && c.push(d);
            return c
        }

        function w(a, b, d) {
            d = !1;
            for (var c in b)
                if (!(0 <=
                        z.indexOf(c))) {
                    var g = b[c];
                    if ("function" === typeof g) {
                        var l = v.getPropertyDescriptor(a.prototype, c);
                        if (l && (l = l.value, "function" === typeof l)) {
                            F.test(g) && (d = !0, b[c] = function(a, b) {
                                return function() {
                                    var d = this._super;
                                    this._super = a;
                                    var c = b.apply(this, arguments);
                                    this._super = d;
                                    return c
                                }
                            }(l, g));
                            continue
                        }!1
                    }
                }
            return d
        }

        function t(a, b, d, c, g, l) {
            a.__props__ = [];
            c && c.__props__ && (a.__props__ = c.__props__.slice());
            if (g)
                for (c = 0; c < g.length; ++c) {
                    var k = g[c];
                    k.__props__ && (a.__props__ = a.__props__.concat(k.__props__.filter(function(b) {
                        return 0 >
                            a.__props__.indexOf(b)
                    })))
                }
            if (d) {
                y.preprocessAttrs(d, b, a, l);
                for (var n in d) g = d[n], "default" in g ? f(a, b, n, g, l) : e(a, b, n, g, l)
            }
            var p = B.getClassAttrs(a);
            a.__values__ = a.__props__.filter(function(a) {
                return !1 !== p[a + E + "serializable"]
            })
        }

        function p(b) {
            b = b || {};
            var d = b.name,
                c = b["extends"],
                g = b.mixins,
                l = a(d, c, g, b);
            d || (d = cc.js.getClassName(l));
            l._sealed = !0;
            c && (c._sealed = !1);
            var e = b.properties;
            "function" === typeof e || c && null === c.__props__ || g && g.some(function(a) {
                return null === a.__props__
            }) ? (!1, x.push({
                cls: l,
                props: e,
                mixins: g
            }), l.__props__ = l.__values__ = null) : t(l, d, e, c, b.mixins, b.__ES6__);
            if (g = b.statics)
                for (n in !1, g) l[n] = g[n];
            for (var k in b)
                if (!(0 <= z.indexOf(k))) {
                    var n = b[k];
                    y.validateMethodWithProps(n, k, d, l, c) && v.value(l.prototype, k, n, !0, !0)
                }(b = b.editor) && v.isChildClassOf(c, cc.Component) && cc.Component._registerEditorProps(l, b);
            return l
        }

        function u(a, b, d, c, g) {
            function l() {
                n = c + E;
                return k = B.getClassAttrs(a)
            }

            function e(a, d) {
                if (a in b) {
                    var c = b[a];
                    typeof c === d && ((k || l())[n + a] = c)
                }
            }
            var k = null,
                n = "";
            !1;
            !1;
            if (d = b.type) H[d] ?
                ((k || l())[n + "type"] = d, !1) : "Object" === d ? !1 : d === B.ScriptUuid ? ((k || l())[n + "type"] = "Script", k[n + "ctor"] = cc.ScriptAsset) : "object" === typeof d ? A.isEnum(d) ? ((k || l())[n + "type"] = "Enum", k[n + "enumList"] = A.getList(d)) : !1 : ("function" === typeof d && ((k || l())[n + "type"] = "Object", k[n + "ctor"] = d), !1);
            b.editorOnly && (!1, (k || l())[n + "editorOnly"] = !0);
            !1;
            !1 === b.serializable && (!1, (k || l())[n + "serializable"] = !1);
            e("formerlySerializedAs", "string");
            !1;
            !1;
            if (d = b.range) Array.isArray(d) ? 2 <= d.length ? ((k || l())[n + "min"] = d[0], k[n + "max"] =
                d[1], 2 < d.length && (k[n + "step"] = d[2])) : !1 : !1;
            e("min", "number");
            e("max", "number");
            e("step", "number")
        }
        var v = h("./js"),
            A = h("./CCEnum");
        h("./utils");
        var B = h("./attribute"),
            E = B.DELIMETER,
            y = h("./preprocess-class");
        h("./requiring-frame");
        var z = "name extends mixins ctor __ctor__ properties statics editor __ES6__".split(" "),
            x = {
                datas: null,
                push: function(a) {
                    if (this.datas) this.datas.push(a);
                    else {
                        this.datas = [a];
                        var b = this;
                        setTimeout(function() {
                            b.init()
                        }, 0)
                    }
                },
                init: function() {
                    var a = this.datas;
                    if (a) {
                        for (var b = 0; b <
                            a.length; ++b) {
                            var d = a[b],
                                c = d.cls,
                                g = d.props;
                            "function" === typeof g && (g = g());
                            var l = v.getClassName(c);
                            g ? t(c, l, g, c.$super, d.mixins) : cc.errorID(3633, l)
                        }
                        this.datas = null
                    }
                }
            },
            C = /^[A-Za-z_$][0-9A-Za-z_$]*$/,
            G = function(a, b, d, c) {
                var g = "return function CCClass(){\n";
                b && w(b, c, d) && (g += "this._super=null;\n");
                g += "this.__initProps__(CCClass);\n";
                a = a.length;
                if (0 < a)
                    if (1 === a) g += "CCClass.__ctors__[0].apply(this,arguments);\n";
                    else
                        for (g += "var cs=CCClass.__ctors__;\n", b = 0; b < a; b++) g += "cs[" + b + "].apply(this,arguments);\n";
                return Function(g + "}")()
            },
            F = /xyz/.test(function() {
                xyz
            }) ? /\b\._super\b/ : /.*/;
        /xyz/.test(function() {
            xyz
        });
        p._isCCClass = function(a) {
            return a && a.hasOwnProperty("__ctors__")
        };
        p._fastDefine = function(a, b, d) {
            v.setClassName(a, b);
            a = b.__props__ = b.__values__ = Object.keys(d);
            b = B.getClassAttrs(b);
            for (var c = 0; c < a.length; c++) {
                var g = a[c];
                b[g + E + "visible"] = !1;
                b[g + E + "default"] = d[g]
            }
        };
        p.Attr = B;
        p.attr = B.attr;
        p.getInheritanceChain = function(a) {
            for (var b = [];;) {
                a = v.getSuper(a);
                if (!a) break;
                a !== Object && b.push(a)
            }
            return b
        };
        var H = {
            Integer: "Number",
            Float: "Number",
            Boolean: "Boolean",
            String: "String"
        };
        cc.Class = p;
        q.exports = {
            isArray: function(a) {
                a = b(a);
                return Array.isArray(a)
            },
            fastDefine: p._fastDefine,
            getNewValueTypeCode: (!0, d),
            IDENTIFIER_RE: C,
            escapeForJS: l,
            getDefault: b
        };
        !1
    }, {
        "./CCEnum": 206,
        "./attribute": 216,
        "./js": 225,
        "./preprocess-class": 226,
        "./requiring-frame": 227,
        "./utils": 228
    }],
    205: [function(h, q, m) {
        function f(a) {
            return a
        }

        function e(a, b) {
            return a[b] || (a[b] = {})
        }

        function b(a) {
            return function(b) {
                return "function" === typeof b ? a(b) :
                    function(d) {
                        return a(d, b)
                    }
            }
        }

        function k(a, b, d) {
            return function(a) {
                !1;
                return function(d) {
                    return b(d, a)
                }
            }
        }

        function c(a, b) {
            !1;
            return e(a, "__ccclassCache__")
        }

        function a(a, b, d) {
            return a(function(a, g) {
                if (a = c(a, b)) g = void 0 !== d ? d : g, a = e(a, "proto"), e(a, "editor")[b] = g
            }, b)
        }
        h("./CCClass");
        var d = h("./preprocess-class"),
            l = h("./js"),
            g = k.bind(null, !1),
            n = k.bind(null, !1),
            w = k.bind(null, !1);
        h = b(function(a, b) {
            var d = l.getSuper(a);
            d === Object && (d = null);
            b = {
                name: b,
                extends: d,
                ctor: a,
                __ES6__: !0
            };
            if (d = a.__ccclassCache__)(d = d.proto) &&
                l.mixin(b, d), a.__ccclassCache__ = void 0;
            a = cc.Class(b);
            !1;
            return a
        });
        m = b(f);
        g = a(g, "requireComponent");
        var t = n(f);
        w = a(w, "executionOrder");
        var p = b(f),
            u = b(f),
            v = n(f),
            A = n(f);
        n = n(f);
        cc._decorator = q.exports = {
            ccclass: h,
            property: function(a, b, g) {
                function k(a, b, g) {
                    var k = c(a.constructor);
                    if (k) {
                        var p = e(k, "proto");
                        p = e(p, "properties");
                        a = a.constructor;
                        var f = n,
                            h, t = g && (g.get || g.set);
                        f && (h = d.getFullFormOfProperty(f, t));
                        h = l.mixin(p[b] || {}, h || f || {});
                        if (t) !1, g.get && (h.get = g.get), g.set && (h.set = g.set);
                        else {
                            !1;
                            t = void 0;
                            if (g) {
                                if (g.initializer) a: {
                                    k =
                                    g.initializer;
                                    try {
                                        var u = k()
                                    } catch (L) {
                                        t = k;
                                        break a
                                    }
                                    t = "object" !== typeof u || null === u ? u : k
                                }
                            } else {
                                if (!(u = k["default"])) {
                                    a: {
                                        try {
                                            var v = new a
                                        } catch (L) {
                                            !1;
                                            u = {};
                                            break a
                                        }
                                        u = v
                                    }
                                    u = k["default"] = u
                                }
                                k = u;
                                k.hasOwnProperty(b) && (t = k[b])
                            }!1;
                            !1;
                            h["default"] = t
                        }
                        p[b] = h
                    }
                }
                var n = null;
                if ("undefined" === typeof b) return n = a, k;
                k(a, b, g)
            },
            executeInEditMode: m,
            requireComponent: g,
            menu: t,
            executionOrder: w,
            disallowMultiple: p,
            playOnFocus: u,
            inspector: v,
            icon: A,
            help: n,
            mixins: function() {
                for (var a = [], b = 0; b < arguments.length; b++) a[b] = arguments[b];
                return function(b) {
                    (b =
                        c(b, "mixins")) && (e(b, "proto").mixins = a)
                }
            }
        }
    }, {
        "./CCClass": 204,
        "./js": 225,
        "./preprocess-class": 226,
        "./utils": 228
    }],
    206: [function(h, q, m) {
        function f(b) {
            if ("__enums__" in b) return b;
            e.value(b, "__enums__", null, !0);
            for (var k = -1, c = Object.keys(b), a = 0; a < c.length; a++) {
                var d = c[a],
                    l = b[d];
                if (-1 === l) l = ++k, b[d] = l;
                else if ("number" === typeof l) k = l;
                else if ("string" === typeof l && Number.isInteger(parseFloat(d))) continue;
                l = "" + l;
                d !== l && (!1, e.value(b, l, d))
            }
            return b
        }
        var e = h("./js");
        f.isEnum = function(b) {
            return b && b.hasOwnProperty("__enums__")
        };
        f.getList = function(b) {
            if (b.__enums__) return b.__enums__;
            var e = b.__enums__ = [],
                c;
            for (c in b) {
                var a = b[c];
                Number.isInteger(a) && e.push({
                    name: c,
                    value: a
                })
            }
            e.sort(function(a, b) {
                return a.value - b.value
            });
            return e
        };
        !1;
        q.exports = cc.Enum = f
    }, {
        "./js": 225
    }],
    207: [function(h, q, m) {
        var f = h("../event-manager");
        h = h("./CCInputManager");
        var e;
        cc.Acceleration = function(b, e, c, a) {
            this.x = b || 0;
            this.y = e || 0;
            this.z = c || 0;
            this.timestamp = a || 0
        };
        h.setAccelerometerEnabled = function(b) {
            this._accelEnabled !== b && (this._accelEnabled = b, b = cc.director.getScheduler(),
                b.enableForTarget(this), this._accelEnabled ? (this._registerAccelerometerEvent(), this._accelCurTime = 0, b.scheduleUpdate(this)) : (this._unregisterAccelerometerEvent(), this._accelCurTime = 0, b.unscheduleUpdate(this)), !1, !1)
        };
        h.setAccelerometerInterval = function(b) {
            this._accelInterval !== b && (this._accelInterval = b, !1, !1)
        };
        h._registerKeyboardEvent = function() {
            cc.game.canvas.addEventListener("keydown", function(b) {
                f.dispatchEvent(new cc.Event.EventKeyboard(b.keyCode, !0));
                b.stopPropagation();
                b.preventDefault()
            }, !1);
            cc.game.canvas.addEventListener("keyup", function(b) {
                f.dispatchEvent(new cc.Event.EventKeyboard(b.keyCode, !1));
                b.stopPropagation();
                b.preventDefault()
            }, !1)
        };
        h._registerAccelerometerEvent = function() {
            var b = window;
            this._acceleration = new cc.Acceleration;
            this._accelDeviceEvent = b.DeviceMotionEvent || b.DeviceOrientationEvent;
            cc.sys.browserType === cc.sys.BROWSER_TYPE_MOBILE_QQ && (this._accelDeviceEvent = window.DeviceOrientationEvent);
            var k = this._accelDeviceEvent === b.DeviceMotionEvent ? "devicemotion" : "deviceorientation",
                c = navigator.userAgent;
            (/Android/.test(c) || /Adr/.test(c) && cc.sys.browserType === cc.BROWSER_TYPE_UC) && (this._minus = -1);
            e = this.didAccelerate.bind(this);
            b.addEventListener(k, e, !1)
        };
        h._unregisterAccelerometerEvent = function() {
            var b = window,
                k = this._accelDeviceEvent === b.DeviceMotionEvent ? "devicemotion" : "deviceorientation";
            e && b.removeEventListener(k, e, !1)
        };
        h.didAccelerate = function(b) {
            var e = window;
            if (this._accelEnabled) {
                var c = this._acceleration;
                if (this._accelDeviceEvent === window.DeviceMotionEvent) {
                    var a = b.accelerationIncludingGravity;
                    var d = this._accelMinus * a.x * .1;
                    var l = this._accelMinus * a.y * .1;
                    a = .1 * a.z
                } else d = b.gamma / 90 * .981, l = -b.beta / 90 * .981, a = b.alpha / 90 * .981;
                if (cc.view._isRotated) {
                    var g = d;
                    d = -l;
                    l = g
                }
                c.x = d;
                c.y = l;
                c.z = a;
                c.timestamp = b.timeStamp || Date.now();
                b = c.x;
                90 === e.orientation ? (c.x = -c.y, c.y = b) : -90 === e.orientation ? (c.x = c.y, c.y = -b) : 180 === e.orientation && (c.x = -c.x, c.y = -c.y);
                cc.sys.os === cc.sys.OS_ANDROID && cc.sys.browserType !== cc.sys.BROWSER_TYPE_MOBILE_QQ && (c.x = -c.x, c.y = -c.y)
            }
        }
    }, {
        "../event-manager": 149,
        "./CCInputManager": 208
    }],
    208: [function(h,
        q, m) {
        m = h("./CCMacro");
        var f = h("./CCSys"),
            e = h("../event-manager"),
            b = m.TOUCH_TIMEOUT,
            k = cc.v2();
        h = {
            _mousePressed: !1,
            _isRegisterEvent: !1,
            _preTouchPoint: cc.v2(0, 0),
            _prevMousePoint: cc.v2(0, 0),
            _preTouchPool: [],
            _preTouchPoolPointer: 0,
            _touches: [],
            _touchesIntegerDict: {},
            _indexBitsUsed: 0,
            _maxTouches: 8,
            _accelEnabled: !1,
            _accelInterval: .2,
            _accelMinus: 1,
            _accelCurTime: 0,
            _acceleration: null,
            _accelDeviceEvent: null,
            _canvasBoundingRect: {
                left: 0,
                top: 0,
                adjustedLeft: 0,
                adjustedTop: 0,
                width: 0,
                height: 0
            },
            _getUnUsedIndex: function() {
                for (var c =
                        this._indexBitsUsed, a = cc.sys.now(), d = 0; d < this._maxTouches; d++) {
                    if (!(1 & c)) return this._indexBitsUsed |= 1 << d, d;
                    var l = this._touches[d];
                    if (a - l._lastModified > b) return this._removeUsedIndexBit(d), delete this._touchesIntegerDict[l.getID()], d;
                    c >>= 1
                }
                return -1
            },
            _removeUsedIndexBit: function(b) {
                0 > b || b >= this._maxTouches || (this._indexBitsUsed &= ~(1 << b))
            },
            _glView: null,
            _updateCanvasBoundingRect: function() {
                var b = cc.game.canvas,
                    a = this._canvasBoundingRect,
                    d = document.documentElement,
                    l = window.pageXOffset - d.clientLeft;
                d =
                    window.pageYOffset - d.clientTop;
                b.getBoundingClientRect ? (b = b.getBoundingClientRect(), a.left = b.left + l, a.top = b.top + d, a.width = b.width, a.height = b.height) : b instanceof HTMLCanvasElement ? (a.left = l, a.top = d, a.width = b.width, a.height = b.height) : (a.left = l, a.top = d, a.width = parseInt(b.style.width), a.height = parseInt(b.style.height))
            },
            handleTouchesBegin: function(b) {
                for (var a, d, c, g = [], k = this._touchesIntegerDict, h = f.now(), t = 0, p = b.length; t < p; t++)
                    if (a = b[t], c = a.getID(), d = k[c], null == d) {
                        var u = this._getUnUsedIndex(); - 1 ===
                            u ? cc.logID(2300, u) : (d = this._touches[u] = new cc.Touch(a._point.x, a._point.y, a.getID()), d._lastModified = h, d._setPrevPoint(a._prevPoint), k[c] = u, g.push(d))
                    }
                0 < g.length && (this._glView._convertTouchesWithScale(g), b = new cc.Event.EventTouch(g), b._eventCode = cc.Event.EventTouch.BEGAN, e.dispatchEvent(b))
            },
            handleTouchesMove: function(b) {
                for (var a, d, c = [], g = this._touches, k = f.now(), h = 0, t = b.length; h < t; h++) a = b[h], d = a.getID(), d = this._touchesIntegerDict[d], null != d && g[d] && (g[d]._setPoint(a._point), g[d]._setPrevPoint(a._prevPoint),
                    g[d]._lastModified = k, c.push(g[d]));
                0 < c.length && (this._glView._convertTouchesWithScale(c), b = new cc.Event.EventTouch(c), b._eventCode = cc.Event.EventTouch.MOVED, e.dispatchEvent(b))
            },
            handleTouchesEnd: function(b) {
                b = this.getSetOfTouchesEndOrCancel(b);
                0 < b.length && (this._glView._convertTouchesWithScale(b), b = new cc.Event.EventTouch(b), b._eventCode = cc.Event.EventTouch.ENDED, e.dispatchEvent(b));
                this._preTouchPool.length = 0
            },
            handleTouchesCancel: function(b) {
                b = this.getSetOfTouchesEndOrCancel(b);
                0 < b.length && (this._glView._convertTouchesWithScale(b),
                    b = new cc.Event.EventTouch(b), b._eventCode = cc.Event.EventTouch.CANCELED, e.dispatchEvent(b));
                this._preTouchPool.length = 0
            },
            getSetOfTouchesEndOrCancel: function(b) {
                for (var a, d, c, g = [], e = this._touches, k = this._touchesIntegerDict, f = 0, p = b.length; f < p; f++) a = b[f], c = a.getID(), d = k[c], null != d && e[d] && (e[d]._setPoint(a._point), e[d]._setPrevPoint(a._prevPoint), g.push(e[d]), this._removeUsedIndexBit(d), delete k[c]);
                return g
            },
            getPreTouch: function(b) {
                for (var a = null, d = this._preTouchPool, c = b.getID(), g = d.length - 1; 0 <= g; g--)
                    if (d[g].getID() ===
                        c) {
                        a = d[g];
                        break
                    }
                a || (a = b);
                return a
            },
            setPreTouch: function(b) {
                for (var a = !1, d = this._preTouchPool, c = b.getID(), g = d.length - 1; 0 <= g; g--)
                    if (d[g].getID() === c) {
                        d[g] = b;
                        a = !0;
                        break
                    }
                a || (50 >= d.length ? d.push(b) : (d[this._preTouchPoolPointer] = b, this._preTouchPoolPointer = (this._preTouchPoolPointer + 1) % 50))
            },
            getTouchByXY: function(b, a, d) {
                var c = this._preTouchPoint;
                b = this._glView.convertToLocationInView(b, a, d);
                a = new cc.Touch(b.x, b.y, 0);
                a._setPrevPoint(c.x, c.y);
                c.x = b.x;
                c.y = b.y;
                return a
            },
            getMouseEvent: function(b, a, d) {
                var c =
                    this._prevMousePoint;
                d = new cc.Event.EventMouse(d);
                d._setPrevCursor(c.x, c.y);
                c.x = b.x;
                c.y = b.y;
                this._glView._convertMouseToLocationInView(c, a);
                d.setLocation(c.x, c.y);
                return d
            },
            getPointByEvent: function(b, a) {
                cc.sys.browserType !== cc.sys.BROWSER_TYPE_QQ && cc.sys.browserType !== cc.sys.BROWSER_TYPE_UC && cc.sys.browserType !== cc.sys.BROWSER_TYPE_SAFARI || this._updateCanvasBoundingRect();
                if (null != b.pageX) return {
                    x: b.pageX,
                    y: b.pageY
                };
                a.left -= document.body.scrollLeft;
                a.top -= document.body.scrollTop;
                return {
                    x: b.clientX,
                    y: b.clientY
                }
            },
            getTouchesByEvent: function(b, a) {
                for (var d = [], c = this._glView, g, e, h = this._preTouchPoint, t = b.changedTouches.length, p = 0; p < t; p++)
                    if (g = b.changedTouches[p]) {
                        var u = f.BROWSER_TYPE_FIREFOX === f.browserType ? c.convertToLocationInView(g.pageX, g.pageY, a, k) : c.convertToLocationInView(g.clientX, g.clientY, a, k);
                        null != g.identifier ? (g = new cc.Touch(u.x, u.y, g.identifier), e = this.getPreTouch(g).getLocation(), g._setPrevPoint(e.x, e.y), this.setPreTouch(g)) : (g = new cc.Touch(u.x, u.y), g._setPrevPoint(h.x, h.y));
                        h.x =
                            u.x;
                        h.y = u.y;
                        d.push(g)
                    }
                return d
            },
            registerSystemEvent: function(b) {
                if (!this._isRegisterEvent) {
                    this._glView = cc.view;
                    var a = this,
                        d = this._canvasBoundingRect;
                    window.addEventListener("resize", this._updateCanvasBoundingRect.bind(this));
                    var c = f.isMobile,
                        g = "touches" in f.capabilities;
                    if ("mouse" in f.capabilities) {
                        c || (window.addEventListener("mousedown", function() {
                            a._mousePressed = !0
                        }, !1), window.addEventListener("mouseup", function(b) {
                            if (a._mousePressed) {
                                a._mousePressed = !1;
                                var c = a.getPointByEvent(b, d);
                                cc.rect(d.left,
                                    d.top, d.width, d.height).contains(c) || (a.handleTouchesEnd([a.getTouchByXY(c.x, c.y, d)]), c = a.getMouseEvent(c, d, cc.Event.EventMouse.UP), c.setButton(b.button), e.dispatchEvent(c))
                            }
                        }, !1));
                        var k = cc.Event.EventMouse;
                        c = [!c && ["mousedown", k.DOWN, function(d, c, g, l) {
                                a._mousePressed = !0;
                                a.handleTouchesBegin([a.getTouchByXY(g.x, g.y, l)]);
                                b.focus()
                            }], !c && ["mouseup", k.UP, function(b, d, c, g) {
                                a._mousePressed = !1;
                                a.handleTouchesEnd([a.getTouchByXY(c.x, c.y, g)])
                            }], !c && ["mousemove", k.MOVE, function(b, d, c, g) {
                                a.handleTouchesMove([a.getTouchByXY(c.x,
                                    c.y, g)]);
                                a._mousePressed || d.setButton(null)
                            }],
                            ["mousewheel", k.SCROLL, function(a, b) {
                                b.setScrollData(0, a.wheelDelta)
                            }],
                            ["DOMMouseScroll", k.SCROLL, function(a, b) {
                                b.setScrollData(0, -120 * a.detail)
                            }]
                        ];
                        for (k = 0; k < c.length; ++k) {
                            var h = c[k];
                            h && function() {
                                var c = h[1],
                                    g = h[2];
                                b.addEventListener(h[0], function(b) {
                                    var l = a.getPointByEvent(b, d),
                                        k = a.getMouseEvent(l, d, c);
                                    k.setButton(b.button);
                                    g(b, k, l, d);
                                    e.dispatchEvent(k);
                                    b.stopPropagation();
                                    b.preventDefault()
                                }, !1)
                            }()
                        }
                    }
                    if (window.navigator.msPointerEnabled) {
                        var t = {
                            MSPointerDown: a.handleTouchesBegin,
                            MSPointerMove: a.handleTouchesMove,
                            MSPointerUp: a.handleTouchesEnd,
                            MSPointerCancel: a.handleTouchesCancel
                        };
                        c = function(c) {
                            var g = t[c];
                            b.addEventListener(c, function(b) {
                                var c = document.documentElement;
                                d.adjustedLeft = d.left - c.scrollLeft;
                                d.adjustedTop = d.top - c.scrollTop;
                                g.call(a, [a.getTouchByXY(b.clientX, b.clientY, d)]);
                                b.stopPropagation()
                            }, !1)
                        };
                        for (var p in t) c(p)
                    }
                    if (g) {
                        var u = {
                            touchstart: function(d) {
                                a.handleTouchesBegin(d);
                                b.focus()
                            },
                            touchmove: function(b) {
                                a.handleTouchesMove(b)
                            },
                            touchend: function(b) {
                                a.handleTouchesEnd(b)
                            },
                            touchcancel: function(b) {
                                a.handleTouchesCancel(b)
                            }
                        };
                        g = function(c) {
                            var g = u[c];
                            b.addEventListener(c, function(b) {
                                if (b.changedTouches) {
                                    var c = document.body;
                                    d.adjustedLeft = d.left - (c.scrollLeft || window.scrollX || 0);
                                    d.adjustedTop = d.top - (c.scrollTop || window.scrollY || 0);
                                    g(a.getTouchesByEvent(b, d));
                                    b.stopPropagation();
                                    b.preventDefault()
                                }
                            }, !1)
                        };
                        for (var v in u) g(v)
                    }
                    this._registerKeyboardEvent();
                    this._isRegisterEvent = !0
                }
            },
            _registerKeyboardEvent: function() {},
            _registerAccelerometerEvent: function() {},
            update: function(b) {
                this._accelCurTime >
                    this._accelInterval && (this._accelCurTime -= this._accelInterval, e.dispatchEvent(new cc.Event.EventAcceleration(this._acceleration)));
                this._accelCurTime += b
            }
        };
        q.exports = cc.internal.inputManager = h
    }, {
        "../event-manager": 149,
        "./CCMacro": 209,
        "./CCSys": 213
    }],
    209: [function(h, q, m) {
        cc.macro = {
            RAD: Math.PI / 180,
            DEG: 180 / Math.PI,
            REPEAT_FOREVER: Number.MAX_VALUE - 1,
            FLT_EPSILON: 1.192092896E-7,
            MIN_ZINDEX: -Math.pow(2, 15),
            MAX_ZINDEX: Math.pow(2, 15) - 1,
            ONE: 1,
            ZERO: 0,
            SRC_ALPHA: 770,
            SRC_ALPHA_SATURATE: 776,
            SRC_COLOR: 768,
            DST_ALPHA: 772,
            DST_COLOR: 774,
            ONE_MINUS_SRC_ALPHA: 771,
            ONE_MINUS_SRC_COLOR: 769,
            ONE_MINUS_DST_ALPHA: 773,
            ONE_MINUS_DST_COLOR: 775,
            ONE_MINUS_CONSTANT_ALPHA: 32772,
            ONE_MINUS_CONSTANT_COLOR: 32770,
            ORIENTATION_PORTRAIT: 1,
            ORIENTATION_LANDSCAPE: 2,
            ORIENTATION_AUTO: 3,
            DENSITYDPI_DEVICE: "device-dpi",
            DENSITYDPI_HIGH: "high-dpi",
            DENSITYDPI_MEDIUM: "medium-dpi",
            DENSITYDPI_LOW: "low-dpi",
            FIX_ARTIFACTS_BY_STRECHING_TEXEL_TMX: !0,
            DIRECTOR_STATS_POSITION: cc.v2(0, 0),
            ENABLE_STACKABLE_ACTIONS: !0,
            TOUCH_TIMEOUT: 5E3,
            BATCH_VERTEX_COUNT: 2E4,
            ENABLE_TILEDMAP_CULLING: !0,
            ENABLE_TRANSPARENT_CANVAS: !1,
            ENABLE_WEBGL_ANTIALIAS: !1,
            ENABLE_CULLING: !1,
            CLEANUP_IMAGE_CACHE: !1,
            SHOW_MESH_WIREFRAME: !1,
            SHOW_MESH_NORMAL: !1,
            ENABLE_MULTI_TOUCH: !0,
            ALLOW_IMAGE_BITMAP: !cc.sys.isMobile,
            ENABLE_NATIVE_TTF_RENDERER: !0
        };
        Object.defineProperty(cc.macro, "ROTATE_ACTION_CCW", {
            set: function(f) {
                cc.RotateTo && cc.RotateBy && (cc.RotateTo._reverse = cc.RotateBy._reverse = f)
            }
        });
        cc.macro.SUPPORT_TEXTURE_FORMATS = ".pkm .pvr .webp .jpg .jpeg .bmp .png".split(" ");
        cc.macro.KEY = {
            none: 0,
            back: 6,
            menu: 18,
            backspace: 8,
            tab: 9,
            enter: 13,
            shift: 16,
            ctrl: 17,
            alt: 18,
            pause: 19,
            capslock: 20,
            escape: 27,
            space: 32,
            pageup: 33,
            pagedown: 34,
            end: 35,
            home: 36,
            left: 37,
            up: 38,
            right: 39,
            down: 40,
            select: 41,
            insert: 45,
            Delete: 46,
            0: 48,
            1: 49,
            2: 50,
            3: 51,
            4: 52,
            5: 53,
            6: 54,
            7: 55,
            8: 56,
            9: 57,
            a: 65,
            b: 66,
            c: 67,
            d: 68,
            e: 69,
            f: 70,
            g: 71,
            h: 72,
            i: 73,
            j: 74,
            k: 75,
            l: 76,
            m: 77,
            n: 78,
            o: 79,
            p: 80,
            q: 81,
            r: 82,
            s: 83,
            t: 84,
            u: 85,
            v: 86,
            w: 87,
            x: 88,
            y: 89,
            z: 90,
            num0: 96,
            num1: 97,
            num2: 98,
            num3: 99,
            num4: 100,
            num5: 101,
            num6: 102,
            num7: 103,
            num8: 104,
            num9: 105,
            "*": 106,
            "+": 107,
            "-": 109,
            numdel: 110,
            "/": 111,
            f1: 112,
            f2: 113,
            f3: 114,
            f4: 115,
            f5: 116,
            f6: 117,
            f7: 118,
            f8: 119,
            f9: 120,
            f10: 121,
            f11: 122,
            f12: 123,
            numlock: 144,
            scrolllock: 145,
            ";": 186,
            semicolon: 186,
            equal: 187,
            "=": 187,
            ",": 188,
            comma: 188,
            dash: 189,
            ".": 190,
            period: 190,
            forwardslash: 191,
            grave: 192,
            "[": 219,
            openbracket: 219,
            backslash: 220,
            "]": 221,
            closebracket: 221,
            quote: 222,
            dpadLeft: 1E3,
            dpadRight: 1001,
            dpadUp: 1003,
            dpadDown: 1004,
            dpadCenter: 1005
        };
        cc.macro.ImageFormat = cc.Enum({
            JPG: 0,
            PNG: 1,
            TIFF: 2,
            WEBP: 3,
            PVR: 4,
            ETC: 5,
            S3TC: 6,
            ATITC: 7,
            TGA: 8,
            RAWDATA: 9,
            UNKNOWN: 10
        });
        cc.macro.BlendFactor = cc.Enum({
            ONE: 1,
            ZERO: 0,
            SRC_ALPHA: 770,
            SRC_COLOR: 768,
            DST_ALPHA: 772,
            DST_COLOR: 774,
            ONE_MINUS_SRC_ALPHA: 771,
            ONE_MINUS_SRC_COLOR: 769,
            ONE_MINUS_DST_ALPHA: 773,
            ONE_MINUS_DST_COLOR: 775
        });
        cc.macro.TextAlignment = cc.Enum({
            LEFT: 0,
            CENTER: 1,
            RIGHT: 2
        });
        cc.macro.VerticalTextAlignment = cc.Enum({
            TOP: 0,
            CENTER: 1,
            BOTTOM: 2
        });
        q.exports = cc.macro
    }, {}],
    210: [function(h, q, m) {
        function f() {
            this._name = "";
            this._objFlags = 0
        }
        var e = h("./js"),
            b = h("./CCClass");
        b.fastDefine("cc.Object", f, {
            _name: "",
            _objFlags: 0
        });
        e.value(f, "Flags", {
            Destroyed: 1,
            DontSave: 8,
            EditorOnly: 16,
            Dirty: 32,
            DontDestroy: 64,
            PersistentMask: -4192741,
            Destroying: 128,
            Deactivating: 256,
            LockedInEditor: 512,
            HideInHierarchy: 1024,
            IsPreloadStarted: 8192,
            IsOnLoadStarted: 32768,
            IsOnLoadCalled: 16384,
            IsOnEnableCalled: 2048,
            IsStartCalled: 65536,
            IsEditorOnEnableCalled: 4096,
            IsPositionLocked: 2097152,
            IsRotationLocked: 131072,
            IsScaleLocked: 262144,
            IsAnchorLocked: 524288,
            IsSizeLocked: 1048576
        });
        var k = [];
        e.value(f, "_deferredDestroy", function() {
            for (var b = k.length, a = 0; a < b; ++a) {
                var d = k[a];
                d._objFlags & 1 || d._destroyImmediate()
            }
            b ===
                k.length ? k.length = 0 : k.splice(0, b);
            !1
        });
        !1;
        h = f.prototype;
        e.getset(h, "name", function() {
            return this._name
        }, function(b) {
            this._name = b
        }, !0);
        e.get(h, "isValid", function() {
            return !(this._objFlags & 1)
        }, !0);
        !1;
        !1;
        h.destroy = function() {
            if (this._objFlags & 1) return cc.warnID(5E3), !1;
            if (this._objFlags & 4) return !1;
            this._objFlags |= 4;
            k.push(this);
            !1;
            return !0
        };
        !1;
        !1;
        h._destruct = function() {
            var c = this.constructor,
                a = c.__destruct__;
            if (!a) {
                var d = this instanceof cc._BaseNode || this instanceof cc.Component,
                    l = d ? "_id" : null;
                a = {};
                for (f in this)
                    if (this.hasOwnProperty(f) &&
                        f !== l) switch (typeof this[f]) {
                        case "string":
                            a[f] = "";
                            break;
                        case "object":
                        case "function":
                            a[f] = null
                    }
                if (cc.Class._isCCClass(c)) {
                    l = cc.Class.Attr.getClassAttrs(c);
                    for (var g = c.__props__, k = 0; k < g.length; k++) {
                        var f = g[k];
                        var h = f + cc.Class.Attr.DELIMETER + "default";
                        if (h in l && (!d || "_id" !== f)) switch (typeof l[h]) {
                            case "string":
                                a[f] = "";
                                break;
                            case "object":
                            case "function":
                                a[f] = null;
                                break;
                            case "undefined":
                                a[f] = void 0
                        }
                    }
                }!0;
                d = "";
                for (f in a) l = b.IDENTIFIER_RE.test(f) ? "o." + f + "=" : "o[" + b.escapeForJS(f) + "]=", g = a[f], "" === g &&
                    (g = '""'), d += l + g + ";\n";
                a = Function("o", d);
                e.value(c, "__destruct__", a, !0)
            }
            a(this)
        };
        h._onPreDestroy = null;
        h._destroyImmediate = function() {
            this._objFlags & 1 ? cc.errorID(5E3) : (this._onPreDestroy && this._onPreDestroy(), !0, this._destruct(), this._objFlags |= 1)
        };
        !1;
        h._deserialize = null;
        cc.isValid = function(b, a) {
            return "object" === typeof b ? !!b && !(b._objFlags & (a ? 5 : 1)) : "undefined" !== typeof b
        };
        !1;
        !1;
        cc.Object = q.exports = f
    }, {
        "./CCClass": 204,
        "./js": 225
    }],
    211: [function(h, q, m) {
        h = h("../platform/js");
        cc.SAXParser = function() {
            (!0,
                window.DOMParser) ? (this._isSupportDOMParser = !0, this._parser = new DOMParser) : (this._isSupportDOMParser = !1, this._parser = null)
        };
        cc.SAXParser.prototype = {
            constructor: cc.SAXParser,
            parse: function(f) {
                return this._parseXML(f)
            },
            _parseXML: function(f) {
                if (this._isSupportDOMParser) var e = this._parser.parseFromString(f, "text/xml");
                else e = new ActiveXObject("Microsoft.XMLDOM"), e.async = "false", e.loadXML(f);
                return e
            }
        };
        cc.PlistParser = function() {
            cc.SAXParser.call(this)
        };
        h.extend(cc.PlistParser, cc.SAXParser);
        h.mixin(cc.PlistParser.prototype, {
            parse: function(f) {
                f = this._parseXML(f).documentElement;
                if ("plist" !== f.tagName) return cc.warnID(5100), {};
                for (var e = null, b = 0, k = f.childNodes.length; b < k && (e = f.childNodes[b], 1 !== e.nodeType); b++);
                return this._parseNode(e)
            },
            _parseNode: function(f) {
                var e = null,
                    b = f.tagName;
                if ("dict" === b) e = this._parseDict(f);
                else if ("array" === b) e = this._parseArray(f);
                else if ("string" === b)
                    if (1 === f.childNodes.length) e = f.firstChild.nodeValue;
                    else
                        for (e = "", b = 0; b < f.childNodes.length; b++) e += f.childNodes[b].nodeValue;
                else "false" === b ?
                    e = !1 : "true" === b ? e = !0 : "real" === b ? e = parseFloat(f.firstChild.nodeValue) : "integer" === b && (e = parseInt(f.firstChild.nodeValue, 10));
                return e
            },
            _parseArray: function(f) {
                for (var e = [], b = 0, k = f.childNodes.length; b < k; b++) {
                    var c = f.childNodes[b];
                    1 === c.nodeType && e.push(this._parseNode(c))
                }
                return e
            },
            _parseDict: function(f) {
                for (var e = {}, b = null, k = 0, c = f.childNodes.length; k < c; k++) {
                    var a = f.childNodes[k];
                    1 === a.nodeType && ("key" === a.tagName ? b = a.firstChild.nodeValue : e[b] = this._parseNode(a))
                }
                return e
            }
        });
        cc.saxParser = new cc.SAXParser;
        cc.plistParser = new cc.PlistParser;
        q.exports = {
            saxParser: cc.saxParser,
            plistParser: cc.plistParser
        }
    }, {
        "../platform/js": 225
    }],
    212: [function(h, q, m) {
        cc.screen = {
            _supportsFullScreen: !1,
            _onfullscreenchange: null,
            _onfullscreenerror: null,
            _preOnFullScreenChange: null,
            _preOnFullScreenError: null,
            _preOnTouch: null,
            _touchEvent: "",
            _fn: null,
            _fnMap: ["requestFullscreen exitFullscreen fullscreenchange fullscreenEnabled fullscreenElement fullscreenerror".split(" "), "requestFullScreen exitFullScreen fullScreenchange fullScreenEnabled fullScreenElement fullscreenerror".split(" "),
                "webkitRequestFullScreen webkitCancelFullScreen webkitfullscreenchange webkitIsFullScreen webkitCurrentFullScreenElement webkitfullscreenerror".split(" "), "mozRequestFullScreen mozCancelFullScreen mozfullscreenchange mozFullScreen mozFullScreenElement mozfullscreenerror".split(" "), "msRequestFullscreen msExitFullscreen MSFullscreenChange msFullscreenEnabled msFullscreenElement msfullscreenerror".split(" ")
            ],
            init: function() {
                this._fn = {};
                var f, e, b = this._fnMap;
                var k = 0;
                for (f = b.length; k < f; k++)
                    if ((e = b[k]) &&
                        "undefined" !== typeof document[e[1]]) {
                        k = 0;
                        for (f = e.length; k < f; k++) this._fn[b[0][k]] = e[k];
                        break
                    }
                this._supportsFullScreen = void 0 !== this._fn.requestFullscreen;
                this._touchEvent = "ontouchend" in window ? "touchend" : "mousedown"
            },
            fullScreen: function() {
                return !!this._supportsFullScreen && !!(document[this._fn.fullscreenElement] || document[this._fn.webkitFullscreenElement] || document[this._fn.mozFullScreenElement])
            },
            requestFullScreen: function(f, e, b) {
                if (f && "video" === f.tagName.toLowerCase()) {
                    if (cc.sys.os === cc.sys.OS_IOS &&
                        cc.sys.isBrowser && 0 < f.readyState) {
                        f.webkitEnterFullscreen && f.webkitEnterFullscreen();
                        return
                    }
                    f.setAttribute("x5-video-player-fullscreen", "true")
                }
                if (this._supportsFullScreen) {
                    f = f || document.documentElement;
                    if (e) {
                        var k = this._fn.fullscreenchange;
                        this._onfullscreenchange && document.removeEventListener(k, this._onfullscreenchange);
                        this._onfullscreenchange = e;
                        document.addEventListener(k, e, !1)
                    }
                    b && (e = this._fn.fullscreenerror, this._onfullscreenerror && document.removeEventListener(e, this._onfullscreenerror), this._onfullscreenerror =
                        b, document.addEventListener(e, b, {
                            once: !0
                        }));
                    f = f[this._fn.requestFullscreen]();
                    "undefined" === typeof document[this._fn.fullscreenerror] && window.Promise && f instanceof Promise && f["catch"](function(b) {})
                }
            },
            exitFullScreen: function(f) {
                if (f && "video" === f.tagName.toLowerCase()) {
                    if (cc.sys.os === cc.sys.OS_IOS && cc.sys.isBrowser) {
                        f.webkitExitFullscreen && f.webkitExitFullscreen();
                        return
                    }
                    f.setAttribute("x5-video-player-fullscreen", "false")
                }
                return !this._supportsFullScreen || document[this._fn.exitFullscreen]()
            },
            autoFullScreen: function(f,
                e) {
                f = f || document.body;
                this._ensureFullScreen(f, e);
                this.requestFullScreen(f, e)
            },
            disableAutoFullScreen: function(f) {
                f = cc.game.canvas || f;
                var e = this._touchEvent;
                this._preOnTouch && (f.removeEventListener(e, this._preOnTouch), this._preOnTouch = null)
            },
            _ensureFullScreen: function(f, e) {
                function b() {
                    k._preOnFullScreenError = null;
                    k._preOnTouch && c.removeEventListener(d, k._preOnTouch);
                    k._preOnTouch = function() {
                        k._preOnTouch = null;
                        k.requestFullScreen(f, e)
                    };
                    c.addEventListener(d, k._preOnTouch, {
                        once: !0
                    })
                }
                var k = this,
                    c = cc.game.canvas ||
                    f,
                    a = this._fn.fullscreenerror,
                    d = this._touchEvent;
                this._preOnFullScreenError && f.removeEventListener(a, this._preOnFullScreenError);
                this._preOnFullScreenError = b;
                f.addEventListener(a, b, {
                    once: !0
                })
            }
        };
        cc.screen.init()
    }, {}],
    213: [function(h, q, m) {
        function f() {
            cc.sys = {};
            var b = cc.sys;
            b.LANGUAGE_ENGLISH = "en";
            b.LANGUAGE_CHINESE = "zh";
            b.LANGUAGE_FRENCH = "fr";
            b.LANGUAGE_ITALIAN = "it";
            b.LANGUAGE_GERMAN = "de";
            b.LANGUAGE_SPANISH = "es";
            b.LANGUAGE_DUTCH = "du";
            b.LANGUAGE_RUSSIAN = "ru";
            b.LANGUAGE_KOREAN = "ko";
            b.LANGUAGE_JAPANESE =
                "ja";
            b.LANGUAGE_HUNGARIAN = "hu";
            b.LANGUAGE_PORTUGUESE = "pt";
            b.LANGUAGE_ARABIC = "ar";
            b.LANGUAGE_NORWEGIAN = "no";
            b.LANGUAGE_POLISH = "pl";
            b.LANGUAGE_TURKISH = "tr";
            b.LANGUAGE_UKRAINIAN = "uk";
            b.LANGUAGE_ROMANIAN = "ro";
            b.LANGUAGE_BULGARIAN = "bg";
            b.LANGUAGE_UNKNOWN = "unknown";
            b.OS_IOS = "iOS";
            b.OS_ANDROID = "Android";
            b.OS_WINDOWS = "Windows";
            b.OS_MARMALADE = "Marmalade";
            b.OS_LINUX = "Linux";
            b.OS_BADA = "Bada";
            b.OS_BLACKBERRY = "Blackberry";
            b.OS_OSX = "OS X";
            b.OS_WP8 = "WP8";
            b.OS_WINRT = "WINRT";
            b.OS_UNKNOWN = "Unknown";
            b.UNKNOWN = -1;
            b.WIN32 =
                0;
            b.LINUX = 1;
            b.MACOS = 2;
            b.ANDROID = 3;
            b.IPHONE = 4;
            b.IPAD = 5;
            b.BLACKBERRY = 6;
            b.NACL = 7;
            b.EMSCRIPTEN = 8;
            b.TIZEN = 9;
            b.WINRT = 10;
            b.WP8 = 11;
            b.MOBILE_BROWSER = 100;
            b.DESKTOP_BROWSER = 101;
            b.EDITOR_PAGE = 102;
            b.EDITOR_CORE = 103;
            b.WECHAT_GAME = 104;
            b.QQ_PLAY = 105;
            b.FB_PLAYABLE_ADS = 106;
            b.BAIDU_GAME = 107;
            b.VIVO_GAME = 108;
            b.OPPO_GAME = 109;
            b.HUAWEI_GAME = 110;
            b.XIAOMI_GAME = 111;
            b.JKW_GAME = 112;
            b.ALIPAY_GAME = 113;
            b.WECHAT_GAME_SUB = 114;
            b.BAIDU_GAME_SUB = 115;
            b.QTT_GAME = 116;
            b.BYTEDANCE_GAME = 117;
            b.BYTEDANCE_GAME_SUB = 118;
            b.LINKSURE = 119;
            b.BROWSER_TYPE_WECHAT =
                "wechat";
            b.BROWSER_TYPE_ANDROID = "androidbrowser";
            b.BROWSER_TYPE_IE = "ie";
            b.BROWSER_TYPE_EDGE = "edge";
            b.BROWSER_TYPE_QQ = "qqbrowser";
            b.BROWSER_TYPE_MOBILE_QQ = "mqqbrowser";
            b.BROWSER_TYPE_UC = "ucbrowser";
            b.BROWSER_TYPE_UCBS = "ucbs";
            b.BROWSER_TYPE_360 = "360browser";
            b.BROWSER_TYPE_BAIDU_APP = "baiduboxapp";
            b.BROWSER_TYPE_BAIDU = "baidubrowser";
            b.BROWSER_TYPE_MAXTHON = "maxthon";
            b.BROWSER_TYPE_OPERA = "opera";
            b.BROWSER_TYPE_OUPENG = "oupeng";
            b.BROWSER_TYPE_MIUI = "miuibrowser";
            b.BROWSER_TYPE_FIREFOX = "firefox";
            b.BROWSER_TYPE_SAFARI =
                "safari";
            b.BROWSER_TYPE_CHROME = "chrome";
            b.BROWSER_TYPE_LIEBAO = "liebao";
            b.BROWSER_TYPE_QZONE = "qzone";
            b.BROWSER_TYPE_SOUGOU = "sogou";
            b.BROWSER_TYPE_HUAWEI = "huawei";
            b.BROWSER_TYPE_UNKNOWN = "unknown";
            b.isNative = (!1, !1);
            b.isBrowser = "object" === typeof window && "object" === typeof document && !0;
            b.glExtension = function(a) {
                return !!cc.renderer.device.ext(a)
            };
            b.getMaxJointMatrixSize = function() {
                if (!b._maxJointMatrixSize) {
                    var a = cc.game._renderContext;
                    a = Math.floor(a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS) / 4) - 10;
                    b._maxJointMatrixSize =
                        50 > a ? 0 : 50
                }
                return b._maxJointMatrixSize
            };
            b.getSafeAreaRect = function() {
                var a = cc.view.getVisibleSize();
                return cc.rect(0, 0, a.width, a.height)
            };
            if (e.__globalAdapter && e.__globalAdapter.adaptSys) e.__globalAdapter.adaptSys(b);
            else {
                !1;
                !1;
                !1;
                var k = window,
                    c = k.navigator,
                    a = document,
                    d = a.documentElement,
                    l = c.userAgent.toLowerCase();
                !1;
                b.isMobile = /mobile|android|iphone|ipad/.test(l);
                "undefined" !== typeof FbPlayableAd ? b.platform = b.FB_PLAYABLE_ADS : b.platform = b.isMobile ? b.MOBILE_BROWSER : b.DESKTOP_BROWSER;
                var g = (g = c.language) ||
                    c.browserLanguage;
                b.languageCode = g.toLowerCase();
                g = g ? g.split("-")[0] : b.LANGUAGE_ENGLISH;
                b.language = g;
                var n = !1;
                g = !1;
                var f = "";
                var h = 0;
                var p = /android\s*(\d+(?:\.\d+)*)/i.exec(l) || /android\s*(\d+(?:\.\d+)*)/i.exec(c.platform);
                p && (n = !0, f = p[1] || "", h = parseInt(f) || 0);
                if (p = /(iPad|iPhone|iPod).*OS ((\d+_?){2,3})/i.exec(l)) g = !0, f = p[2] || "", h = parseInt(f) || 0;
                else if (/(iPhone|iPad|iPod)/.exec(c.platform) || "MacIntel" === c.platform && c.maxTouchPoints && 1 < c.maxTouchPoints) g = !0, f = "", h = 0;
                p = b.OS_UNKNOWN; - 1 !== c.appVersion.indexOf("Win") ?
                    p = b.OS_WINDOWS : g ? p = b.OS_IOS : -1 !== c.appVersion.indexOf("Mac") ? p = b.OS_OSX : -1 !== c.appVersion.indexOf("X11") && -1 === c.appVersion.indexOf("Linux") ? p = b.OS_UNIX : n ? p = b.OS_ANDROID : -1 === c.appVersion.indexOf("Linux") && -1 === l.indexOf("ubuntu") || (p = b.OS_LINUX);
                b.os = p;
                b.osVersion = f;
                b.osMainVersion = h;
                b.browserType = b.BROWSER_TYPE_UNKNOWN;
                (function() {
                    var a = /qq|ucbrowser|ubrowser|edge|HuaweiBrowser/i,
                        d = /chrome|safari|firefox|trident|opera|opr\/|oupeng/i;
                    a = (a = /mqqbrowser|micromessenger|qqbrowser|sogou|qzone|liebao|maxthon|ucbs|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|miuibrowser/i.exec(l) ||
                        a.exec(l) || d.exec(l)) ? a[0].toLowerCase() : b.BROWSER_TYPE_UNKNOWN;
                    "safari" === a && n ? a = b.BROWSER_TYPE_ANDROID : "qq" === a && l.match(/android.*applewebkit/i) && (a = b.BROWSER_TYPE_ANDROID);
                    b.browserType = {
                        micromessenger: b.BROWSER_TYPE_WECHAT,
                        trident: b.BROWSER_TYPE_IE,
                        edge: b.BROWSER_TYPE_EDGE,
                        "360 aphone": b.BROWSER_TYPE_360,
                        mxbrowser: b.BROWSER_TYPE_MAXTHON,
                        "opr/": b.BROWSER_TYPE_OPERA,
                        ubrowser: b.BROWSER_TYPE_UC,
                        huaweibrowser: b.BROWSER_TYPE_HUAWEI
                    }[a] || a
                })();
                b.browserVersion = "";
                (function() {
                    var a = /(qq|chrome|safari|firefox|trident|opera|opr\/|oupeng)(mobile)?(browser)?\/?([\d.]+)/i,
                        d = l.match(/(mqqbrowser|micromessenger|qqbrowser|sogou|qzone|liebao|maxthon|uc|ucbs|360 aphone|360|baiduboxapp|baidu|maxthon|mxbrowser|miui(?:.hybrid)?)(mobile)?(browser)?\/?([\d.]+)/i);
                    d || (d = l.match(a));
                    b.browserVersion = d ? d[4] : ""
                })();
                g = window.innerWidth || document.documentElement.clientWidth;
                f = window.innerHeight || document.documentElement.clientHeight;
                h = window.devicePixelRatio || 1;
                b.windowPixelResolution = {
                    width: h * g,
                    height: h * f
                };
                b._checkWebGLRenderMode = function() {
                    if (cc.game.renderType !== cc.game.RENDER_TYPE_WEBGL) throw Error("This feature supports WebGL render mode only.");
                };
                g = document.createElement("canvas");
                try {
                    var u = b.localStorage = k.localStorage;
                    u.setItem("storage", "");
                    u.removeItem("storage");
                    u = null
                } catch (E) {
                    u = function() {
                        cc.warnID(5200)
                    }, b.localStorage = {
                        getItem: u,
                        setItem: u,
                        removeItem: u,
                        clear: u
                    }
                }
                u = g.toDataURL("image/webp").startsWith("data:image/webp");
                f = !!g.getContext("2d");
                h = !1;
                !1;
                k.WebGLRenderingContext && (h = !0);
                var v = b.capabilities = {
                    canvas: f,
                    opengl: h,
                    webp: u,
                    imageBitmap: !1
                };
                "undefined" !== typeof createImageBitmap && "undefined" !== typeof Blob && (g.width = g.height = 2, createImageBitmap(g, {}).then(function(a) {
                    v.imageBitmap = !0;
                    a.close && a.close()
                })["catch"](function(a) {}));
                (void 0 !== d.ontouchstart || void 0 !== a.ontouchstart || c.msPointerEnabled) && (v.touches = !0);
                void 0 !== d.onmouseup && (v.mouse = !0);
                void 0 !== d.onkeyup && (v.keyboard = !0);
                (k.DeviceMotionEvent || k.DeviceOrientationEvent) && (v.accelerometer = !0);
                var A = {
                    ONLY_ONE: !1,
                    WEB_AUDIO: !!(window.AudioContext || window.webkitAudioContext || window.mozAudioContext),
                    DELAY_CREATE_CTX: !1
                };
                b.os === b.OS_IOS && (A.USE_LOADER_EVENT = "loadedmetadata");
                b.browserType ===
                    b.BROWSER_TYPE_FIREFOX && (A.DELAY_CREATE_CTX = !0, A.USE_LOADER_EVENT = "canplay");
                b.os === b.OS_ANDROID && b.browserType === b.BROWSER_TYPE_UC && (A.ONE_SOURCE = !0);
                try {
                    A.WEB_AUDIO && (A.context = new(window.AudioContext || window.webkitAudioContext || window.mozAudioContext), A.DELAY_CREATE_CTX && setTimeout(function() {
                        A.context = new(window.AudioContext || window.webkitAudioContext || window.mozAudioContext)
                    }, 0))
                } catch (E) {
                    A.WEB_AUDIO = !1, cc.logID(5201)
                }
                var B = [];
                (function() {
                    var a = document.createElement("audio");
                    a.canPlayType &&
                        (a.canPlayType('audio/ogg; codecs="vorbis"') && B.push(".ogg"), a.canPlayType("audio/mpeg") && B.push(".mp3"), a.canPlayType('audio/wav; codecs="1"') && B.push(".wav"), a.canPlayType("audio/mp4") && B.push(".mp4"), a.canPlayType("audio/x-m4a") && B.push(".m4a"))
                })();
                A.format = B;
                b.__audioSupport = A
            }
            b.NetworkType = {
                NONE: 0,
                LAN: 1,
                WWAN: 2
            };
            b.getNetworkType = function() {
                return b.NetworkType.LAN
            };
            b.getBatteryLevel = function() {
                return 1
            };
            b.garbageCollect = function() {};
            b.restartVM = function() {};
            b.isObjectValid = function(a) {
                return a ?
                    !0 : !1
            };
            b.dump = function() {
                var a = "" + ("isMobile : " + this.isMobile + "\r\n");
                a += "language : " + this.language + "\r\n";
                a += "browserType : " + this.browserType + "\r\n";
                a += "browserVersion : " + this.browserVersion + "\r\n";
                a += "capabilities : " + JSON.stringify(this.capabilities) + "\r\n";
                a += "os : " + this.os + "\r\n";
                a += "osVersion : " + this.osVersion + "\r\n";
                a += "platform : " + this.platform + "\r\n";
                a += "Using " + (cc.game.renderType === cc.game.RENDER_TYPE_WEBGL ? "WEBGL" : "CANVAS") + " renderer.\r\n";
                cc.log(a)
            };
            b.openURL = function(a) {
                !1;
                !1;
                window.open(a)
            };
            b.now = function() {
                return Date.now ? Date.now() : +new Date
            };
            return b
        }!0;
        var e = "undefined" === typeof window ? global : window;
        h = cc && cc.sys ? cc.sys : f();
        q.exports = h
    }, {}],
    214: [function(h, q, m) {
        var f = h("../event/event-target");
        m = h("../platform/js");
        var e = h("../renderer");
        h("../platform/CCClass");
        var b = {
            init: function() {
                this.html = document.getElementsByTagName("html")[0]
            },
            availWidth: function(a) {
                return a && a !== this.html ? a.clientWidth : window.innerWidth
            },
            availHeight: function(a) {
                return a && a !== this.html ? a.clientHeight :
                    window.innerHeight
            },
            meta: {
                width: "device-width"
            },
            adaptationType: cc.sys.browserType
        };
        cc.sys.os === cc.sys.OS_IOS && (b.adaptationType = cc.sys.BROWSER_TYPE_SAFARI);
        switch (b.adaptationType) {
            case cc.sys.BROWSER_TYPE_SAFARI:
                b.meta["minimal-ui"] = "true";
                / OS \d/.test(navigator.userAgent) && !~navigator.userAgent.indexOf("CriOS") && !navigator.userAgent.indexOf("Mozilla") && /Safari\/[\d\.]+$/.test(navigator.userAgent) && (b.availWidth = function() {
                    return window.innerWidth
                }, b.availHeight = function() {
                    return window.innerHeight
                });
                break;
            case cc.sys.BROWSER_TYPE_SOUGOU:
            case cc.sys.BROWSER_TYPE_UC:
                b.meta["minimal-ui"] = "false", b.availWidth = function(a) {
                    return a.clientWidth
                }, b.availHeight = function(a) {
                    return a.clientHeight
                }
        }
        var k = null,
            c = function() {
                f.call(this);
                var a = cc.ContainerStrategy,
                    d = cc.ContentStrategy;
                b.init(this);
                this._frameSize = cc.size(0, 0);
                this._designResolutionSize = cc.size(0, 0);
                this._originalDesignResolutionSize = cc.size(0, 0);
                this._scaleY = this._scaleX = 1;
                this._viewportRect = cc.rect(0, 0, 0, 0);
                this._visibleRect = cc.rect(0, 0, 0,
                    0);
                this._autoFullScreen = !1;
                this._devicePixelRatio = 1;
                !1;
                this._maxPixelRatio = 2;
                this._retinaEnabled = !1;
                this._resizeCallback = null;
                this._resizeWithBrowserSize = this._resizing = !1;
                this._orientationChanging = !0;
                this._isRotated = !1;
                this._orientation = cc.macro.ORIENTATION_AUTO;
                this._isAdjustViewport = !0;
                this._antiAliasEnabled = !1;
                this._resolutionPolicy = null;
                this._rpExactFit = new cc.ResolutionPolicy(a.EQUAL_TO_FRAME, d.EXACT_FIT);
                this._rpShowAll = new cc.ResolutionPolicy(a.EQUAL_TO_FRAME, d.SHOW_ALL);
                this._rpNoBorder =
                    new cc.ResolutionPolicy(a.EQUAL_TO_FRAME, d.NO_BORDER);
                this._rpFixedHeight = new cc.ResolutionPolicy(a.EQUAL_TO_FRAME, d.FIXED_HEIGHT);
                this._rpFixedWidth = new cc.ResolutionPolicy(a.EQUAL_TO_FRAME, d.FIXED_WIDTH);
                cc.game.once(cc.game.EVENT_ENGINE_INITED, this.init, this)
            };
        cc.js.extend(c, f);
        cc.js.mixin(c.prototype, {
            init: function() {
                this._initFrameSize();
                var a = cc.game.canvas.width,
                    b = cc.game.canvas.height;
                this._designResolutionSize.width = a;
                this._designResolutionSize.height = b;
                this._originalDesignResolutionSize.width =
                    a;
                this._originalDesignResolutionSize.height = b;
                this._viewportRect.width = a;
                this._viewportRect.height = b;
                this._visibleRect.width = a;
                this._visibleRect.height = b;
                cc.winSize.width = this._visibleRect.width;
                cc.winSize.height = this._visibleRect.height;
                cc.visibleRect && cc.visibleRect.init(this._visibleRect)
            },
            _resizeEvent: function(a) {
                var b = this.setDesignResolutionSize ? this : cc.view;
                var c = cc.sys;
                if (c.browserType === c.BROWSER_TYPE_UC && c.os === c.OS_IOS) setTimeout(function() {
                    b._resizeEvent(a)
                }, 0);
                else {
                    c = b._frameSize.width;
                    var g = b._frameSize.height,
                        e = b._isRotated;
                    if (cc.sys.isMobile) {
                        var k = cc.game.container.style,
                            f = k.margin;
                        k.margin = "0";
                        k.display = "none";
                        b._initFrameSize();
                        k.margin = f;
                        k.display = "block"
                    } else b._initFrameSize();
                    if (!0 === a || b._isRotated !== e || b._frameSize.width !== c || b._frameSize.height !== g) c = b._originalDesignResolutionSize.width, g = b._originalDesignResolutionSize.height, b._resizing = !0, 0 < c && b.setDesignResolutionSize(c, g, b._resolutionPolicy), b._resizing = !1, b.emit("canvas-resize"), b._resizeCallback && b._resizeCallback.call(),
                        cc.sys.browserType != cc.sys.BROWSER_TYPE_SAFARI || !/ OS \d/.test(navigator.userAgent) || ~navigator.userAgent.indexOf("CriOS") || navigator.userAgent.indexOf("Mozilla") || !/Safari\/[\d\.]+$/.test(navigator.userAgent) || 90 != window.orientation && -90 != window.orientation || window.scrollTo(0, 0)
                }
            },
            _orientationChange: function() {
                cc.view._orientationChanging = !0;
                cc.view._resizeEvent();
                cc.sys.browserType === cc.sys.BROWSER_TYPE_SAFARI && cc.sys.isMobile && setTimeout(function() {
                    window.innerHeight > window.innerWidth && window.scrollTo(0,
                        1)
                }, 500)
            },
            _resize: function() {
                cc.view._resizeEvent(!1)
            },
            resizeWithBrowserSize: function(a) {
                a ? this._resizeWithBrowserSize || (this._resizeWithBrowserSize = !0, window.addEventListener("resize", this._resize), window.addEventListener("orientationchange", this._orientationChange)) : this._resizeWithBrowserSize && (this._resizeWithBrowserSize = !1, window.removeEventListener("resize", this._resize), window.removeEventListener("orientationchange", this._orientationChange))
            },
            setResizeCallback: function(a) {
                !1;
                "function" !== typeof a &&
                    null != a || (this._resizeCallback = a)
            },
            setOrientation: function(a) {
                (a &= cc.macro.ORIENTATION_AUTO) && this._orientation !== a && (this._orientation = a, this.setDesignResolutionSize(this._originalDesignResolutionSize.width, this._originalDesignResolutionSize.height, this._resolutionPolicy))
            },
            _initFrameSize: function() {
                var a = this._frameSize,
                    d = b.availWidth(cc.game.frame),
                    c = b.availHeight(cc.game.frame),
                    g = d >= c;
                (!1, !cc.sys.isMobile) || g && this._orientation & cc.macro.ORIENTATION_LANDSCAPE || !g && this._orientation & cc.macro.ORIENTATION_PORTRAIT ?
                    (a.width = d, a.height = c, cc.game.container.style["-webkit-transform"] = "rotate(0deg)", cc.game.container.style.transform = "rotate(0deg)", this._isRotated = !1) : (a.width = c, a.height = d, cc.game.container.style["-webkit-transform"] = "rotate(90deg)", cc.game.container.style.transform = "rotate(90deg)", cc.game.container.style["-webkit-transform-origin"] = "0px 0px 0px", cc.game.container.style.transformOrigin = "0px 0px 0px", this._isRotated = !0);
                this._orientationChanging && setTimeout(function() {
                    cc.view._orientationChanging = !1
                }, 1E3)
            },
            _setViewportMeta: function(a, b) {
                var d = document.getElementById("cocosMetaElement");
                d && b && document.head.removeChild(d);
                var c = document.getElementsByName("viewport");
                c = c ? c[0] : null;
                var e;
                var k = c ? c.content : "";
                d = d || document.createElement("meta");
                d.id = "cocosMetaElement";
                d.name = "viewport";
                d.content = "";
                for (e in a)
                    if (-1 == k.indexOf(e)) k += "," + e + "=" + a[e];
                    else if (b) {
                    var f = new RegExp(e + "s*=s*[^,]+");
                    k = k.replace(f, e + "=" + a[e])
                }
                /^,/.test(k) && (k = k.substr(1));
                d.content = k;
                c && (c.content = k);
                document.head.appendChild(d)
            },
            _adjustViewportMeta: function() {
                this._isAdjustViewport && (this._setViewportMeta(b.meta, !1), this._isAdjustViewport = !1)
            },
            adjustViewportMeta: function(a) {
                this._isAdjustViewport = a
            },
            enableRetina: function(a) {
                !1;
                this._retinaEnabled = !!a
            },
            isRetinaEnabled: function() {
                !1;
                return this._retinaEnabled
            },
            enableAntiAlias: function(a) {
                cc.warnID(9200);
                if (this._antiAliasEnabled !== a)
                    if (this._antiAliasEnabled = a, cc.game.renderType === cc.game.RENDER_TYPE_WEBGL) cc.assetManager.assets.forEach(function(b) {
                        if (b instanceof cc.Texture2D) {
                            var d =
                                cc.Texture2D.Filter;
                            a ? b.setFilters(d.LINEAR, d.LINEAR) : b.setFilters(d.NEAREST, d.NEAREST)
                        }
                    });
                    else if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) {
                    var b = cc.game.canvas.getContext("2d");
                    b.imageSmoothingEnabled = a;
                    b.mozImageSmoothingEnabled = a
                }
            },
            isAntiAliasEnabled: function() {
                return this._antiAliasEnabled
            },
            enableAutoFullScreen: function(a) {
                this._autoFullScreen = !1;
                cc.screen.disableAutoFullScreen(cc.game.frame)
            },
            isAutoFullScreenEnabled: function() {
                return this._autoFullScreen
            },
            setCanvasSize: function(a, b) {
                var d =
                    cc.game.canvas,
                    c = cc.game.container;
                d.width = a * this._devicePixelRatio;
                d.height = b * this._devicePixelRatio;
                d.style.width = a + "px";
                d.style.height = b + "px";
                c.style.width = a + "px";
                c.style.height = b + "px";
                this._resizeEvent()
            },
            getCanvasSize: function() {
                return cc.size(cc.game.canvas.width, cc.game.canvas.height)
            },
            getFrameSize: function() {
                return cc.size(this._frameSize.width, this._frameSize.height)
            },
            setFrameSize: function(a, b, c) {
                this._frameSize.width = a;
                this._frameSize.height = b;
                if (void 0 === c || c) cc.game.frame.style.width =
                    a + "px", cc.game.frame.style.height = b + "px";
                this._resizeEvent(!0)
            },
            getVisibleSize: function() {
                return cc.size(this._visibleRect.width, this._visibleRect.height)
            },
            getVisibleSizeInPixel: function() {
                return cc.size(this._visibleRect.width * this._scaleX, this._visibleRect.height * this._scaleY)
            },
            getVisibleOrigin: function() {
                return cc.v2(this._visibleRect.x, this._visibleRect.y)
            },
            getVisibleOriginInPixel: function() {
                return cc.v2(this._visibleRect.x * this._scaleX, this._visibleRect.y * this._scaleY)
            },
            getResolutionPolicy: function() {
                return this._resolutionPolicy
            },
            setResolutionPolicy: function(a) {
                if (a instanceof cc.ResolutionPolicy) this._resolutionPolicy = a;
                else {
                    var b = cc.ResolutionPolicy;
                    a === b.EXACT_FIT && (this._resolutionPolicy = this._rpExactFit);
                    a === b.SHOW_ALL && (this._resolutionPolicy = this._rpShowAll);
                    a === b.NO_BORDER && (this._resolutionPolicy = this._rpNoBorder);
                    a === b.FIXED_HEIGHT && (this._resolutionPolicy = this._rpFixedHeight);
                    a === b.FIXED_WIDTH && (this._resolutionPolicy = this._rpFixedWidth)
                }
            },
            setDesignResolutionSize: function(a, b, c) {
                if (0 < a && 0 < b)
                    if (this.setResolutionPolicy(c),
                        (c = this._resolutionPolicy) && c.preApply(this), cc.sys.isMobile && this._adjustViewportMeta(), this._orientationChanging = !0, this._resizing || this._initFrameSize(), c) {
                        this._originalDesignResolutionSize.width = this._designResolutionSize.width = a;
                        this._originalDesignResolutionSize.height = this._designResolutionSize.height = b;
                        var d = c.apply(this, this._designResolutionSize);
                        d.scale && 2 === d.scale.length && (this._scaleX = d.scale[0], this._scaleY = d.scale[1]);
                        d.viewport && (a = this._viewportRect, b = this._visibleRect, d = d.viewport,
                            a.x = d.x, a.y = d.y, a.width = d.width, a.height = d.height, b.x = 0, b.y = 0, b.width = d.width / this._scaleX, b.height = d.height / this._scaleY);
                        c.postApply(this);
                        cc.winSize.width = this._visibleRect.width;
                        cc.winSize.height = this._visibleRect.height;
                        cc.visibleRect && cc.visibleRect.init(this._visibleRect);
                        e.updateCameraViewport();
                        cc.internal.inputManager._updateCanvasBoundingRect();
                        this.emit("design-resolution-changed")
                    } else cc.logID(2201);
                else cc.errorID(2200)
            },
            getDesignResolutionSize: function() {
                return cc.size(this._designResolutionSize.width,
                    this._designResolutionSize.height)
            },
            setRealPixelResolution: function(a, b, c) {
                !0;
                !0;
                this._setViewportMeta({
                    width: a
                }, !0);
                document.documentElement.style.width = a + "px";
                document.body.style.width = a + "px";
                document.body.style.left = "0px";
                document.body.style.top = "0px";
                this.setDesignResolutionSize(a, b, c)
            },
            setViewportInPoints: function(a, b, c, g) {
                var d = this._scaleX,
                    l = this._scaleY;
                cc.game._renderContext.viewport(a * d + this._viewportRect.x, b * l + this._viewportRect.y, c * d, g * l)
            },
            setScissorInPoints: function(a, b, c, g) {
                var d = this._scaleX,
                    l = this._scaleY;
                a = Math.ceil(a * d + this._viewportRect.x);
                b = Math.ceil(b * l + this._viewportRect.y);
                c = Math.ceil(c * d);
                g = Math.ceil(g * l);
                l = cc.game._renderContext;
                k || (d = l.getParameter(l.SCISSOR_BOX), k = cc.rect(d[0], d[1], d[2], d[3]));
                if (k.x !== a || k.y !== b || k.width !== c || k.height !== g) k.x = a, k.y = b, k.width = c, k.height = g, l.scissor(a, b, c, g)
            },
            isScissorEnabled: function() {
                return cc.game._renderContext.isEnabled(gl.SCISSOR_TEST)
            },
            getScissorRect: function() {
                if (!k) {
                    var a = gl.getParameter(gl.SCISSOR_BOX);
                    k = cc.rect(a[0], a[1], a[2], a[3])
                }
                a =
                    1 / this._scaleX;
                var b = 1 / this._scaleY;
                return cc.rect((k.x - this._viewportRect.x) * a, (k.y - this._viewportRect.y) * b, k.width * a, k.height * b)
            },
            getViewportRect: function() {
                return this._viewportRect
            },
            getScaleX: function() {
                return this._scaleX
            },
            getScaleY: function() {
                return this._scaleY
            },
            getDevicePixelRatio: function() {
                return this._devicePixelRatio
            },
            convertToLocationInView: function(a, b, c, g) {
                g = g || cc.v2();
                a = this._devicePixelRatio * (a - (c.adjustedLeft ? c.adjustedLeft : c.left));
                b = this._devicePixelRatio * ((c.adjustedTop ? c.adjustedTop :
                    c.top) + c.height - b);
                this._isRotated ? (g.x = cc.game.canvas.width - b, g.y = a) : (g.x = a, g.y = b);
                return g
            },
            _convertMouseToLocationInView: function(a, b) {
                var d = this._viewportRect;
                a.x = (this._devicePixelRatio * (a.x - b.left) - d.x) / this._scaleX;
                a.y = (this._devicePixelRatio * (b.top + b.height - a.y) - d.y) / this._scaleY
            },
            _convertPointWithScale: function(a) {
                var b = this._viewportRect;
                a.x = (a.x - b.x) / this._scaleX;
                a.y = (a.y - b.y) / this._scaleY
            },
            _convertTouchesWithScale: function(a) {
                for (var b = this._viewportRect, c = this._scaleX, g = this._scaleY,
                        e, k, f = 0; f < a.length; f++) e = a[f], k = e._point, e = e._prevPoint, k.x = (k.x - b.x) / c, k.y = (k.y - b.y) / g, e.x = (e.x - b.x) / c, e.y = (e.y - b.y) / g
            }
        });
        cc.ContainerStrategy = cc.Class({
            name: "ContainerStrategy",
            preApply: function(a) {},
            apply: function(a, b) {},
            postApply: function(a) {},
            _setupContainer: function(a, b, c) {
                var d = cc.game.canvas;
                this._setupStyle(a, b, c);
                var l = a._devicePixelRatio = 1;
                !1;
                a.isRetinaEnabled() && (l = a._devicePixelRatio = Math.min(a._maxPixelRatio, window.devicePixelRatio || 1));
                d.width = b * l;
                d.height = c * l
            },
            _setupStyle: function(a,
                b, c) {
                var d = cc.game.canvas,
                    l = cc.game.container;
                cc.sys.os === cc.sys.OS_ANDROID && (document.body.style.width = (a._isRotated ? c : b) + "px", document.body.style.height = (a._isRotated ? b : c) + "px");
                l.style.width = d.style.width = b + "px";
                l.style.height = d.style.height = c + "px"
            },
            _fixContainer: function() {
                document.body.insertBefore(cc.game.container, document.body.firstChild);
                var a = document.body.style;
                a.width = window.innerWidth + "px";
                a.height = window.innerHeight + "px";
                a.overflow = "hidden";
                a = cc.game.container.style;
                a.position = "fixed";
                a.left = a.top = "0px";
                document.body.scrollTop = 0
            }
        });
        cc.ContentStrategy = cc.Class({
            name: "ContentStrategy",
            ctor: function() {
                this._result = {
                    scale: [1, 1],
                    viewport: null
                }
            },
            _buildResult: function(a, b, c, g, e, k) {
                2 > Math.abs(a - c) && (c = a);
                2 > Math.abs(b - g) && (g = b);
                a = cc.rect((a - c) / 2, (b - g) / 2, c, g);
                cc.game.renderType === cc.game.RENDER_TYPE_CANVAS;
                this._result.scale = [e, k];
                this._result.viewport = a;
                return this._result
            },
            preApply: function(a) {},
            apply: function(a, b) {
                return {
                    scale: [1, 1]
                }
            },
            postApply: function(a) {}
        });
        (function() {
            var a = cc.Class({
                    name: "EqualToFrame",
                    extends: cc.ContainerStrategy,
                    apply: function(a) {
                        var b = a._frameSize.height,
                            d = cc.game.container.style;
                        this._setupContainer(a, a._frameSize.width, a._frameSize.height);
                        a._isRotated ? d.margin = "0 0 0 " + b + "px" : d.margin = "0px";
                        d.padding = "0px"
                    }
                }),
                b = cc.Class({
                    name: "ProportionalToFrame",
                    extends: cc.ContainerStrategy,
                    apply: function(a, b) {
                        var d = a._frameSize.width,
                            c = a._frameSize.height,
                            g = cc.game.container.style,
                            l = b.width;
                        b = b.height;
                        var e = d / l,
                            k = c / b,
                            n, f;
                        e < k ? (n = d, f = b * e) : (n = l * k, f = c);
                        l = Math.round((d - n) / 2);
                        f = Math.round((c -
                            f) / 2);
                        this._setupContainer(a, d - 2 * l, c - 2 * f);
                        !0;
                        a._isRotated ? g.margin = "0 0 0 " + c + "px" : g.margin = "0px";
                        g.paddingLeft = l + "px";
                        g.paddingRight = l + "px";
                        g.paddingTop = f + "px";
                        g.paddingBottom = f + "px"
                    }
                });
            cc.Class({
                name: "EqualToWindow",
                extends: a,
                preApply: function(a) {
                    this._super(a);
                    cc.game.frame = document.documentElement
                },
                apply: function(a) {
                    this._super(a);
                    this._fixContainer()
                }
            });
            cc.Class({
                name: "ProportionalToWindow",
                extends: b,
                preApply: function(a) {
                    this._super(a);
                    cc.game.frame = document.documentElement
                },
                apply: function(a,
                    b) {
                    this._super(a, b);
                    this._fixContainer()
                }
            });
            var l = cc.Class({
                    name: "OriginalContainer",
                    extends: cc.ContainerStrategy,
                    apply: function(a) {
                        this._setupContainer(a, cc.game.canvas.width, cc.game.canvas.height)
                    }
                }),
                g = ("undefined" === typeof window ? global : window).__globalAdapter;
            g && (g.adaptContainerStrategy && g.adaptContainerStrategy(cc.ContainerStrategy.prototype), g.adaptView && g.adaptView(c.prototype));
            cc.ContainerStrategy.EQUAL_TO_FRAME = new a;
            cc.ContainerStrategy.PROPORTION_TO_FRAME = new b;
            cc.ContainerStrategy.ORIGINAL_CONTAINER =
                new l;
            a = cc.Class({
                name: "ExactFit",
                extends: cc.ContentStrategy,
                apply: function(a, b) {
                    a = cc.game.canvas.width;
                    var d = cc.game.canvas.height;
                    return this._buildResult(a, d, a, d, a / b.width, d / b.height)
                }
            });
            b = cc.Class({
                name: "ShowAll",
                extends: cc.ContentStrategy,
                apply: function(a, b) {
                    a = cc.game.canvas.width;
                    var d = cc.game.canvas.height,
                        c = b.width;
                    b = b.height;
                    var g = a / c,
                        l = d / b,
                        e = 0,
                        k, n;
                    g < l ? (e = g, k = a, n = b * e) : (e = l, k = c * e, n = d);
                    return this._buildResult(a, d, k, n, e, e)
                }
            });
            l = cc.Class({
                name: "NoBorder",
                extends: cc.ContentStrategy,
                apply: function(a,
                    b) {
                    a = cc.game.canvas.width;
                    var d = cc.game.canvas.height,
                        c = b.width;
                    b = b.height;
                    var g = a / c,
                        l = d / b,
                        e, k, n;
                    g < l ? (e = l, k = c * e, n = d) : (e = g, k = a, n = b * e);
                    return this._buildResult(a, d, k, n, e, e)
                }
            });
            g = cc.Class({
                name: "FixedHeight",
                extends: cc.ContentStrategy,
                apply: function(a, b) {
                    a = cc.game.canvas.width;
                    var d = cc.game.canvas.height;
                    b = d / b.height;
                    return this._buildResult(a, d, a, d, b, b)
                }
            });
            var e = cc.Class({
                name: "FixedWidth",
                extends: cc.ContentStrategy,
                apply: function(a, b) {
                    a = cc.game.canvas.width;
                    var d = cc.game.canvas.height;
                    b = a / b.width;
                    return this._buildResult(a, d, a, d, b, b)
                }
            });
            cc.ContentStrategy.EXACT_FIT = new a;
            cc.ContentStrategy.SHOW_ALL = new b;
            cc.ContentStrategy.NO_BORDER = new l;
            cc.ContentStrategy.FIXED_HEIGHT = new g;
            cc.ContentStrategy.FIXED_WIDTH = new e
        })();
        cc.ResolutionPolicy = cc.Class({
            name: "cc.ResolutionPolicy",
            ctor: function(a, b) {
                this._contentStrategy = this._containerStrategy = null;
                this.setContainerStrategy(a);
                this.setContentStrategy(b)
            },
            preApply: function(a) {
                this._containerStrategy.preApply(a);
                this._contentStrategy.preApply(a)
            },
            apply: function(a,
                b) {
                this._containerStrategy.apply(a, b);
                return this._contentStrategy.apply(a, b)
            },
            postApply: function(a) {
                this._containerStrategy.postApply(a);
                this._contentStrategy.postApply(a)
            },
            setContainerStrategy: function(a) {
                a instanceof cc.ContainerStrategy && (this._containerStrategy = a)
            },
            setContentStrategy: function(a) {
                a instanceof cc.ContentStrategy && (this._contentStrategy = a)
            }
        });
        m.get(cc.ResolutionPolicy.prototype, "canvasSize", function() {
            return cc.v2(cc.game.canvas.width, cc.game.canvas.height)
        });
        cc.ResolutionPolicy.EXACT_FIT =
            0;
        cc.ResolutionPolicy.NO_BORDER = 1;
        cc.ResolutionPolicy.SHOW_ALL = 2;
        cc.ResolutionPolicy.FIXED_HEIGHT = 3;
        cc.ResolutionPolicy.FIXED_WIDTH = 4;
        cc.ResolutionPolicy.UNKNOWN = 5;
        cc.view = new c;
        cc.winSize = cc.size();
        q.exports = cc.view
    }, {
        "../event/event-target": 151,
        "../platform/CCClass": 204,
        "../platform/js": 225,
        "../renderer": 236
    }],
    215: [function(h, q, m) {
        cc.visibleRect = {
            topLeft: cc.v2(0, 0),
            topRight: cc.v2(0, 0),
            top: cc.v2(0, 0),
            bottomLeft: cc.v2(0, 0),
            bottomRight: cc.v2(0, 0),
            bottom: cc.v2(0, 0),
            center: cc.v2(0, 0),
            left: cc.v2(0, 0),
            right: cc.v2(0, 0),
            width: 0,
            height: 0,
            init: function(f) {
                var e = this.width = f.width,
                    b = this.height = f.height,
                    k = f.x;
                f = f.y;
                var c = f + b,
                    a = k + e;
                this.topLeft.x = k;
                this.topLeft.y = c;
                this.topRight.x = a;
                this.topRight.y = c;
                this.top.x = k + e / 2;
                this.top.y = c;
                this.bottomLeft.x = k;
                this.bottomLeft.y = f;
                this.bottomRight.x = a;
                this.bottomRight.y = f;
                this.bottom.x = k + e / 2;
                this.bottom.y = f;
                this.center.x = k + e / 2;
                this.center.y = f + b / 2;
                this.left.x = k;
                this.left.y = f + b / 2;
                this.right.x = a;
                this.right.y = f + b / 2
            }
        }
    }, {}],
    216: [function(h, q, m) {
        function f(b, a) {
            a = a ? Object.create(a) : {};
            k.value(b, "__attrs__", a);
            return a
        }

        function e(b) {
            var a;
            if (!(a = b.hasOwnProperty("__attrs__") && b.__attrs__))
                if ("function" !== typeof b) a = f(b, e(b.constructor));
                else {
                    for (var d = cc.Class.getInheritanceChain(b), c = d.length - 1; 0 <= c; c--) {
                        var g = d[c];
                        g.hasOwnProperty("__attrs__") && g.__attrs__ || (a = d[c + 1], f(g, a && a.__attrs__))
                    }
                    a = d[0];
                    f(b, a && a.__attrs__);
                    a = b.__attrs__
                }
            return a
        }

        function b(b, a) {
            this.name = b;
            this["default"] = a
        }
        var k = h("./js");
        h("./utils");
        b.prototype.toString = function() {
            return this.name
        };
        cc.Integer = new b("Integer",
            0);
        cc.Float = new b("Float", 0);
        !1;
        cc.Boolean = new b("Boolean", !1);
        cc.String = new b("String", "");
        q.exports = {
            PrimitiveType: b,
            attr: function(b, a, d) {
                b = e(b);
                !0;
                a += "$_$";
                d = {};
                for (var c in b) c.startsWith(a) && (d[c.slice(a.length)] = b[c]);
                return d
            },
            getClassAttrs: e,
            setClassAttr: function(b, a, d, l) {
                e(b)[a + "$_$" + d] = l
            },
            DELIMETER: "$_$",
            getTypeChecker_ET: (!1, !1),
            getObjTypeChecker_ET: (!1, !1),
            ScriptUuid: {}
        }
    }, {
        "./CCClass": 204,
        "./js": 225,
        "./utils": 228
    }],
    217: [function(h, q, m) {
        function f() {}

        function e() {
            this.callback = f;
            this.target =
                void 0;
            this.once = !1
        }

        function b() {
            this.callbackInfos = [];
            this.containCanceled = this.isInvoking = !1
        }

        function k() {
            this._callbackTable = c.createMap(!0)
        }
        var c = h("./js"),
            a = c.array.fastRemoveAt;
        e.prototype.set = function(a, b, d) {
            this.callback = a;
            this.target = b;
            this.once = !!d
        };
        var d = new c.Pool(function(a) {
            a.callback = f;
            a.target = void 0;
            a.once = !1;
            return !0
        }, 32);
        d.get = function() {
            return this._get() || new e
        };
        h = b.prototype;
        h.removeByCallback = function(b) {
            for (var c = 0; c < this.callbackInfos.length; ++c) {
                var g = this.callbackInfos[c];
                g && g.callback === b && (d.put(g), a(this.callbackInfos, c), --c)
            }
        };
        h.removeByTarget = function(b) {
            for (var c = 0; c < this.callbackInfos.length; ++c) {
                var g = this.callbackInfos[c];
                g && g.target === b && (d.put(g), a(this.callbackInfos, c), --c)
            }
        };
        h.cancel = function(a) {
            var b = this.callbackInfos[a];
            b && (d.put(b), this.callbackInfos[a] = null);
            this.containCanceled = !0
        };
        h.cancelAll = function() {
            for (var a = 0; a < this.callbackInfos.length; a++) {
                var b = this.callbackInfos[a];
                b && (d.put(b), this.callbackInfos[a] = null)
            }
            this.containCanceled = !0
        };
        h.purgeCanceled =
            function() {
                for (var b = this.callbackInfos.length - 1; 0 <= b; --b) this.callbackInfos[b] || a(this.callbackInfos, b);
                this.containCanceled = !1
            };
        h.clear = function() {
            this.cancelAll();
            this.callbackInfos.length = 0;
            this.containCanceled = this.isInvoking = !1
        };
        var l = new c.Pool(function(a) {
            a.callbackInfos = [];
            a.isInvoking = !1;
            a.containCanceled = !1;
            return !0
        }, 16);
        l.get = function() {
            return this._get() || new b
        };
        h = k.prototype;
        h.on = function(a, b, c, e) {
            var g = this._callbackTable[a];
            g || (g = this._callbackTable[a] = l.get());
            a = d.get();
            a.set(b, c,
                e);
            g.callbackInfos.push(a)
        };
        h.hasEventListener = function(a, b, d) {
            var c = this._callbackTable[a];
            if (!c) return !1;
            a = c.callbackInfos;
            if (!b) {
                if (c.isInvoking) {
                    for (b = 0; b < a.length; ++b)
                        if (a[b]) return !0;
                    return !1
                }
                return 0 < a.length
            }
            for (c = 0; c < a.length; ++c) {
                var g = a[c];
                if (g && g.callback === b && g.target === d) return !0
            }
            return !1
        };
        h.removeAll = function(a) {
            if ("string" === typeof a) {
                var b = this._callbackTable[a];
                b && (b.isInvoking ? b.cancelAll() : (b.clear(), l.put(b), delete this._callbackTable[a]))
            } else if (a)
                for (b in this._callbackTable) {
                    var d =
                        this._callbackTable[b];
                    if (d.isInvoking)
                        for (var c = d.callbackInfos, g = 0; g < c.length; ++g) {
                            var e = c[g];
                            e && e.target === a && d.cancel(g)
                        } else d.removeByTarget(a)
                }
        };
        h.off = function(b, c, l) {
            if (b = this._callbackTable[b])
                for (var g = b.callbackInfos, e = 0; e < g.length; ++e) {
                    var k = g[e];
                    if (k && k.callback === c && k.target === l) {
                        b.isInvoking ? b.cancel(e) : (a(g, e), d.put(k));
                        break
                    }
                }
        };
        h.emit = function(a, b, d, c, l, e) {
            var g = this._callbackTable[a];
            if (g) {
                var k = !g.isInvoking;
                g.isInvoking = !0;
                for (var n = g.callbackInfos, f = 0, p = n.length; f < p; ++f) {
                    var h =
                        n[f];
                    if (h) {
                        var t = h.target,
                            u = h.callback;
                        h.once && this.off(a, u, t);
                        t ? u.call(t, b, d, c, l, e) : u(b, d, c, l, e)
                    }
                }
                k && (g.isInvoking = !1, g.containCanceled && g.purgeCanceled())
            }
        };
        !1;
        q.exports = k
    }, {
        "./js": 225
    }],
    218: [function(h, q, m) {
        function f(e, b) {
            for (var k = 0; k < b.length; k++) {
                var c = b[k];
                Array.isArray(c) ? f(e, c) : e.push(c)
            }
        }
        q.exports = {
            flattenCodeArray: function(e) {
                var b = [];
                f(b, e);
                return b.join("")
            }
        }
    }, {}],
    219: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, b) {
            a.x = b[1];
            a.y = b[2];
            a.z = b[3];
            a.w = b[4]
        }

        function b(a, b) {
            for (var d = a[4][b[0]], c = d[0], g = new c[0], l = c[1], e = c[2], k = d[d.length - 1], n = 1; n < k; ++n) g[l[d[n]]] = b[n];
            for (; n < b.length; ++n)(0, I[c[d[n] + e]])(a, g, l[d[n]], b[n]);
            return g
        }

        function k(a, b, d) {
            var c = new b;
            c._deserialize ? c._deserialize(d, a[0]) : cc.errorID(5303, p["default"].getClassName(b));
            return c
        }

        function c(a, b, d, c) {
            0 <= c ? b[d] = a[5][c] : a[7][3 * ~c] = b
        }

        function a(a) {
            return function(b, d, c, g) {
                d[c] = g;
                for (d = 0; d < g.length; ++d) a(b, g, d, g[d])
            }
        }

        function d(a, b, d, c) {
            b[d] = null;
            a[8][c] = b
        }

        function l(a, d, c, g) {
            d[c] = b(a,
                g)
        }

        function g(a, b, d, c, g, l) {
            var e = a(b);
            if (!e) {
                if (g) {
                    d[c] = function(b, d, c) {
                        return function() {
                            var g;
                            (g = a(c)) || (l || t.reportMissingClass(c), g = Object);
                            b[d] = g;
                            return new g
                        }
                    }(d, c, b);
                    return
                }
                l || t.reportMissingClass(b);
                e = Object
            }
            d[c] = e
        }

        function n(a, b, d) {
            var c = d || p["default"]._getClassById;
            a = a[3];
            for (var l = 0; l < a.length; ++l) {
                var e = a[l];
                if ("string" !== typeof e) {
                    !0;
                    if ("function" === typeof e[0]) throw Error("Can not deserialize the same JSON data again.");
                    g(c, e[0], e, G, b, d)
                } else g(c, e, a, l, b, d)
            }
        }

        function w(a) {
            var b = a[4];
            if (b) {
                a = a[3];
                for (var d = 0; d < b.length; ++d) {
                    var c = b[d];
                    c[0] = a[c[0]]
                }
            }
        }

        function t(a, d, c) {
            !1;
            "string" === typeof a && (a = JSON.parse(a));
            var g = !d;
            d = d || H.pool.get();
            d.init(a);
            c = c || {};
            var l = a[0],
                e = !1;
            "object" === typeof l && (e = l.preprocessed, l = l.version);
            if (1 > l) throw Error(cc.debug.getError(5304, l));
            c._version = l;
            c.result = d;
            a[0] = c;
            e || (n(a, !1, c.classFinder), w(a));
            cc.game._isCloning = !0;
            c = a[5];
            l = a;
            e = l[5];
            var f = l[6],
                p = 0 === f ? 0 : f.length,
                h = e[e.length - 1],
                t = e.length - p;
            "number" !== typeof h ? h = 0 : (0 > h && (h = ~h), --t);
            for (var u = 0; u <
                t; ++u) e[u] = b(l, e[u]);
            t = l[3];
            for (var v = 0; v < p; ++v, ++u) {
                var A = f[v],
                    B = e[u];
                0 <= A ? e[u] = k(l, t[A], B) : (A = ~A, (0, I[A])(l, e, u, B))
            }
            l = h;
            cc.game._isCloning = !1;
            if (a[7]) {
                e = a[7];
                f = a[2];
                p = e.length - 1;
                h = 0;
                for (u = 3 * e[p]; h < u; h += 3) t = e[h], v = c[e[h + 2]], A = e[h + 1], 0 <= A ? t[f[A]] = v : t[~A] = v;
                for (; h < p; h += 3) u = c[e[h]], t = c[e[h + 2]], v = e[h + 1], 0 <= v ? u[f[v]] = t : u[~v] = t
            }
            e = a[5];
            f = a[2];
            p = a[1];
            h = a[8];
            u = a[9];
            a = a[10];
            for (t = 0; t < h.length; ++t) v = h[t], "number" === typeof v && (h[t] = e[v]), v = u[t], "number" === typeof v && (v = 0 <= v ? f[v] : ~v, u[t] = v), v = a[t], "number" ===
                typeof v && (a[t] = p[v]);
            g && H.pool.put(d);
            return c[l]
        }
        m.__esModule = !0;
        m["default"] = t;
        m.unpackJSONs = function(a, b) {
            if (1 > a[0]) throw Error(cc.debug.getError(5304, a[0]));
            n(a, !0, b);
            w(a);
            b = new K(a[0]);
            var d = a[1],
                c = a[2],
                g = a[3],
                l = a[4];
            a = a[F];
            for (var e = 0; e < a.length; ++e) a[e].unshift(b, d, c, g, l);
            return a
        };
        m.packCustomObjData = function(a, b) {
            return [1, z, z, [a], z, [b],
                [0], z, [],
                [],
                []
            ]
        };
        m.hasNativeDep = function(a) {
            a = a[5];
            a = a[a.length - 1];
            return "number" === typeof a && 0 > a
        };
        m.getDependUuidList = function(a) {
            var b = a[1];
            return a[10].map(function(a) {
                return b[a]
            })
        };
        var p = f(h("./js"));
        q = f(h("../value-types/vec2"));
        m = f(h("../value-types/vec3"));
        var u = f(h("../value-types/vec4")),
            v = f(h("../value-types/color")),
            A = f(h("../value-types/size")),
            B = f(h("../value-types/rect")),
            E = f(h("../value-types/quat")),
            y = f(h("../value-types/mat4")),
            z = 0,
            x = [q["default"], m["default"], u["default"], E["default"], v["default"], A["default"], B["default"], y["default"]],
            C = [function(a, b) {
                a.x = b[1];
                a.y = b[2]
            }, function(a, b) {
                a.x = b[1];
                a.y = b[2];
                a.z = b[3]
            }, e, e, function(a, b) {
                a._val = b[1]
            }, function(a, b) {
                a.width =
                    b[1];
                a.height = b[2]
            }, function(a, b) {
                a.x = b[1];
                a.y = b[2];
                a.width = b[3];
                a.height = b[4]
            }, function(a, b) {
                y["default"].fromArray(a, b, 1)
            }],
            G = 0,
            F = 5,
            H = function() {
                function a() {
                    this.uuidList = this.uuidPropList = this.uuidObjList = null
                }
                var b = a.prototype;
                b.init = function(a) {
                    this.uuidObjList = a[8];
                    this.uuidPropList = a[9];
                    this.uuidList = a[10]
                };
                b.reset = function() {
                    this.uuidPropList = this.uuidObjList = this.uuidList = null
                };
                b.push = function(a, b, d) {
                    this.uuidObjList.push(a);
                    this.uuidPropList.push(b);
                    this.uuidList.push(d)
                };
                return a
            }();
        H.pool =
            new p["default"].Pool(function(a) {
                a.reset()
            }, 5);
        H.pool.get = function() {
            return this._get() || new H
        };
        !1;
        !1;
        var I = Array(13);
        I[0] = function(a, b, d, c) {
            b[d] = c
        };
        I[1] = c;
        I[2] = a(c);
        I[3] = a(d);
        I[4] = l;
        I[5] = function(a, b, d, c) {
            C[c[0]](b[d], c)
        };
        I[6] = d;
        I[7] = function(a, b, d, c) {
            b[d].set(c)
        };
        I[8] = function(a, b, d, c) {
            a = new x[c[0]];
            C[c[0]](a, c);
            b[d] = a
        };
        I[9] = a(l);
        I[10] = function(a, b, d, c) {
            b[d] = k(a, a[3][c[0]], c[1])
        };
        I[11] = function(a, b, d, c) {
            var g = c[0];
            b[d] = g;
            for (b = 1; b < c.length; b += 3)(0, I[c[b + 1]])(a, g, c[b], c[b + 2])
        };
        I[12] = function(a,
            b, d, c) {
            var g = c[0];
            b[d] = g;
            for (b = 0; b < g.length; ++b) {
                d = g[b];
                var l = c[b + 1];
                if (0 !== l)(0, I[l])(a, g, b, d)
            }
        };
        t.Details = H;
        var K = function(a) {
            this.preprocessed = !0;
            this.version = a
        };
        !1;
        !1;
        !1;
        !1
    }, {
        "../value-types/color": 300,
        "../value-types/mat4": 303,
        "../value-types/quat": 304,
        "../value-types/rect": 305,
        "../value-types/size": 306,
        "../value-types/vec2": 310,
        "../value-types/vec3": 311,
        "../value-types/vec4": 312,
        "./js": 225
    }],
    220: [function(h, q, m) {
        h = function(f) {
            return f && f.__esModule ? f : {
                default: f
            }
        }(h("./deserialize-compiled"));
        h["default"].reportMissingClass = function(f) {
            !1;
            cc.warnID(5302, f)
        };
        !0;
        cc.deserialize = h["default"]
    }, {
        "./deserialize-compiled": 219,
        "./deserialize-editor": void 0
    }],
    221: [function(h, q, m) {
        function f(e) {
            this.id = 0 | 998 * Math.random();
            this.prefix = e ? e + "." : ""
        }
        f.prototype.getNewId = function() {
            return this.prefix + ++this.id
        };
        f.global = new f("global");
        q.exports = f
    }, {}],
    222: [function(h, q, m) {
        h("./js");
        h("./CCClass");
        h("./CCClassDecorator");
        h("./CCEnum");
        h("./CCObject");
        h("./callbacks-invoker");
        h("./deserialize");
        h("./instantiate");
        h("./instantiate-jit");
        h("./requiring-frame");
        h("./CCSys");
        h("./CCMacro");
        !0;
        h("./CCVisibleRect")
    }, {
        "./CCClass": 204,
        "./CCClassDecorator": 205,
        "./CCEnum": 206,
        "./CCMacro": 209,
        "./CCObject": 210,
        "./CCSys": 213,
        "./CCVisibleRect": 215,
        "./callbacks-invoker": 217,
        "./deserialize": 220,
        "./instantiate": 224,
        "./instantiate-jit": 223,
        "./js": 225,
        "./requiring-frame": 227
    }],
    223: [function(h, q, m) {
        function f(a) {
            if (a === Float32Array) return "Float32Array";
            if (a === Float64Array) return "Float64Array";
            if (a === Int8Array) return "Int8Array";
            if (a === Int16Array) return "Int16Array";
            if (a === Int32Array) return "Int32Array";
            if (a === Uint8Array) return "Uint8Array";
            if (a === Uint16Array) return "Uint16Array";
            if (a === Uint32Array) return "Uint32Array";
            if (a === Uint8ClampedArray) return "Uint8ClampedArray";
            throw Error("Unknown TypedArray to instantiate: " + a);
        }

        function e(a, b) {
            this.varName = a;
            this.expression = b
        }

        function b(a, b) {
            return b instanceof e ? new e(b.varName, a + b.expression) : a + b
        }

        function k(a, d, c) {
            Array.isArray(c) ? (c[0] = b(d, c[0]), a.push(c)) : a.push(b(d, c) + ";")
        }

        function c(a) {
            this._exps = [];
            this._targetExp = a
        }

        function a(a, b) {
            if ("function" === typeof a) try {
                a = a()
            } catch (C) {
                return !1
            }
            if (a === b) return !0;
            if (a && b && "object" === typeof a && "object" === typeof b && a.constructor === b.constructor)
                if (a instanceof cc.ValueType) {
                    if (a.equals(b)) return !0
                } else {
                    if (Array.isArray(a)) return 0 === a.length && 0 === b.length;
                    if (a.constructor === Object) return p.isEmptyObject(a) && p.isEmptyObject(b)
                }
            return !1
        }

        function d(a) {
            return B.test(a) ? "." + a : "[" + E(a) + "]"
        }

        function l(a, b) {
            this.parent = b;
            this.objsToClear_iN$t = [];
            this.codeArray = [];
            this.objs = [];
            this.funcs = [];
            this.funcModuleCache = p.createMap();
            p.mixin(this.funcModuleCache, y);
            this.globalVariables = [];
            this.localVariableId = this.globalVariableId = 0;
            this.codeArray.push("var o,t;", "if(R){", "o=R;", "}else{", "o=R=new " + this.getFuncModule(a.constructor, !0) + "();", "}");
            p.value(a, "_iN$t", {
                globalVar: "R"
            }, !0);
            this.objsToClear_iN$t.push(a);
            this.enumerateObject(this.codeArray, a);
            var d;
            0 < this.globalVariables.length && (d = "var " + this.globalVariables.join(",") + ";");
            a = v.flattenCodeArray(["return (function(R){",
                d || [], this.codeArray, "return o;", "})"
            ]);
            this.result = Function("O", "F", a)(this.objs, this.funcs);
            a = 0;
            for (b = this.objsToClear_iN$t.length; a < b; ++a) this.objsToClear_iN$t[a]._iN$t = null;
            this.objsToClear_iN$t.length = 0
        }
        var g = h("./CCObject"),
            n = g.Flags.Destroyed,
            w = g.Flags.PersistentMask,
            t = h("./attribute"),
            p = h("./js"),
            u = h("./CCClass"),
            v = h("./compiler"),
            A = t.DELIMETER + "default",
            B = u.IDENTIFIER_RE,
            E = u.escapeForJS,
            y = {
                "cc.Node": "cc.Node",
                "cc.Sprite": "cc.Sprite",
                "cc.Label": "cc.Label",
                "cc.Button": "cc.Button",
                "cc.Widget": "cc.Widget",
                "cc.Animation": "cc.Animation",
                "cc.ClickEvent": !1,
                "cc.PrefabInfo": !1
            };
        try {
            !Float32Array.name && (Float32Array.name = "Float32Array"), !Float64Array.name && (Float64Array.name = "Float64Array"), !Int8Array.name && (Int8Array.name = "Int8Array"), !Int16Array.name && (Int16Array.name = "Int16Array"), !Int32Array.name && (Int32Array.name = "Int32Array"), !Uint8Array.name && (Uint8Array.name = "Uint8Array"), !Uint16Array.name && (Uint16Array.name = "Uint16Array"), !Uint32Array.name && (Uint32Array.name = "Uint32Array"), !Uint8ClampedArray.name &&
                (Uint8ClampedArray.name = "Uint8ClampedArray")
        } catch (z) {}
        e.prototype.toString = function() {
            return "var " + this.varName + "=" + this.expression + ";"
        };
        c.prototype.append = function(a, b) {
            this._exps.push([a, b])
        };
        c.prototype.writeCode = function(a) {
            if (1 < this._exps.length) {
                a.push("t=" + this._targetExp + ";");
                var b = "t"
            } else {
                if (1 !== this._exps.length) return;
                b = this._targetExp
            }
            for (var c = 0; c < this._exps.length; c++) {
                var g = this._exps[c];
                k(a, b + d(g[0]) + "=", g[1])
            }
        };
        c.pool = new p.Pool(function(a) {
            a._exps.length = 0;
            a._targetExp = null
        }, 1);
        c.pool.get = function(a) {
            var b = this._get() || new c;
            b._targetExp = a;
            return b
        };
        h = l.prototype;
        h.getFuncModule = function(a, b) {
            var d = p.getClassName(a);
            if (d) {
                var c = this.funcModuleCache[d];
                if (c) return c;
                if (void 0 === c && (c = -1 !== d.indexOf("."))) try {
                    if (c = a === Function("return " + d)()) return this.funcModuleCache[d] = d
                } catch (F) {}
            }
            c = this.funcs.indexOf(a);
            0 > c && (c = this.funcs.length, this.funcs.push(a));
            a = "F[" + c + "]";
            b && (a = "(" + a + ")");
            return this.funcModuleCache[d] = a
        };
        h.getObjRef = function(a) {
            var b = this.objs.indexOf(a);
            0 > b &&
                (b = this.objs.length, this.objs.push(a));
            return "O[" + b + "]"
        };
        h.setValueType = function(a, b, d, g) {
            g = c.pool.get(g);
            var l = b.constructor.__props__;
            l || (l = Object.keys(b));
            for (var e = 0; e < l.length; e++) {
                var k = l[e],
                    n = d[k];
                b[k] !== n && (n = this.enumerateField(d, k, n), g.append(k, n))
            }
            g.writeCode(a);
            c.pool.put(g)
        };
        h.enumerateCCClass = function(b, c, g) {
            var l = g.__values__;
            g = t.getClassAttrs(g);
            for (var e = 0; e < l.length; e++) {
                var k = l[e],
                    n = c[k],
                    f = g[k + A];
                if (!a(f, n)) {
                    if ("object" === typeof n && n instanceof cc.ValueType && (f = u.getDefault(f)) &&
                        f.constructor === n.constructor) {
                        k = "o" + d(k);
                        this.setValueType(b, f, n, k);
                        continue
                    }
                    this.setObjProp(b, c, k, n)
                }
            }
        };
        h.instantiateArray = function(a) {
            if (0 === a.length) return "[]";
            var b = "a" + ++this.localVariableId,
                d = [new e(b, "new Array(" + a.length + ")")];
            p.value(a, "_iN$t", {
                globalVar: "",
                source: d
            }, !0);
            this.objsToClear_iN$t.push(a);
            for (var c = 0; c < a.length; ++c) {
                var g = b + "[" + c + "]=",
                    l = this.enumerateField(a, c, a[c]);
                k(d, g, l)
            }
            return d
        };
        h.instantiateTypedArray = function(a) {
            var b = a.constructor.name || f(a.constructor);
            if (0 === a.length) return "new " +
                b;
            var d = "a" + ++this.localVariableId;
            b = [new e(d, "new " + b + "(" + a.length + ")")];
            a._iN$t = {
                globalVar: "",
                source: b
            };
            this.objsToClear_iN$t.push(a);
            for (var c = 0; c < a.length; ++c) 0 !== a[c] && k(b, d + "[" + c + "]=", a[c]);
            return b
        };
        h.enumerateField = function(a, d, c) {
            if ("object" === typeof c && c) return (a = c._iN$t) ? (c = a.globalVar, c || (c = a.globalVar = "v" + ++this.globalVariableId, this.globalVariables.push(c), a.source[0] = b(c + "=", a.source[0])), c) : ArrayBuffer.isView(c) ? this.instantiateTypedArray(c) : Array.isArray(c) ? this.instantiateArray(c) :
                this.instantiateObj(c);
            if ("function" === typeof c) return this.getFuncModule(c);
            if ("string" === typeof c) return E(c);
            "_objFlags" === d && a instanceof g && (c &= w);
            return c
        };
        h.setObjProp = function(a, b, c, g) {
            var l = "o" + d(c) + "=";
            b = this.enumerateField(b, c, g);
            k(a, l, b)
        };
        h.enumerateObject = function(a, b) {
            var c = b.constructor;
            if (cc.Class._isCCClass(c)) this.enumerateCCClass(a, b, c);
            else
                for (var d in b) !b.hasOwnProperty(d) || 95 === d.charCodeAt(0) && 95 === d.charCodeAt(1) && "__type__" !== d || (c = b[d], "object" === typeof c && c && c === b._iN$t ||
                    this.setObjProp(a, b, d, c))
        };
        h.instantiateObj = function(a) {
            if (a instanceof cc.ValueType) return u.getNewValueTypeCode(a);
            if (a instanceof cc.Asset) return this.getObjRef(a);
            if (a._objFlags & n) return null;
            var b = a.constructor;
            if (cc.Class._isCCClass(b)) {
                if (this.parent)
                    if (this.parent instanceof cc.Component) {
                        if (a instanceof cc._BaseNode || a instanceof cc.Component) return this.getObjRef(a)
                    } else if (this.parent instanceof cc._BaseNode)
                    if (a instanceof cc._BaseNode) {
                        if (!a.isChildOf(this.parent)) return this.getObjRef(a)
                    } else if (a instanceof cc.Component && !a.node.isChildOf(this.parent)) return this.getObjRef(a);
                b = new e("o", "new " + this.getFuncModule(b, !0) + "()")
            } else if (b === Object) b = new e("o", "{}");
            else {
                if (b) return this.getObjRef(a);
                b = new e("o", "Object.create(null)")
            }
            b = [b];
            p.value(a, "_iN$t", {
                globalVar: "",
                source: b
            }, !0);
            this.objsToClear_iN$t.push(a);
            this.enumerateObject(b, a);
            return ["(function(){", b, "return o;})();"]
        };
        q.exports = {
            compile: function(a) {
                return (new l(a, a instanceof cc._BaseNode && a)).result
            },
            equalsToDefault: a
        };
        !1
    }, {
        "./CCClass": 204,
        "./CCObject": 210,
        "./attribute": 216,
        "./compiler": 218,
        "./js": 225
    }],
    224: [function(h, q, m) {
        function f(a, b) {
            if (!b) {
                if ("object" !== typeof a || Array.isArray(a) || !a || !cc.isValid(a)) return !1, null;
                !1
            }
            if (a instanceof c) {
                if (a._instantiate) return cc.game._isCloning = !0, a = a._instantiate(null, !0), cc.game._isCloning = !1, a;
                if (a instanceof cc.Asset) return !1, null
            }
            cc.game._isCloning = !0;
            a = e(a);
            cc.game._isCloning = !1;
            return a
        }

        function e(a, c) {
            if (Array.isArray(a) || g && g(a)) return !1, null;
            var d = a._iN$t ? a._iN$t : a.constructor ? new a.constructor :
                Object.create(null);
            b(a, d, c);
            a = 0;
            for (c = w.length; a < c; ++a) w[a]._iN$t = null;
            w.length = 0;
            return d
        }

        function b(b, d, g) {
            n.value(b, "_iN$t", d, !0);
            w.push(b);
            var e = b.constructor;
            if (cc.Class._isCCClass(e)) {
                var f = e.__values__;
                for (e = 0; e < f.length; e++) {
                    var p = f[e],
                        h = b[p];
                    if ("object" === typeof h && h) {
                        var t = d[p];
                        t instanceof a && t.constructor === h.constructor ? t.set(h) : d[p] = h._iN$t || k(h, g)
                    } else d[p] = h
                }
            } else
                for (f in b) !b.hasOwnProperty(f) || 95 === f.charCodeAt(0) && 95 === f.charCodeAt(1) && "__type__" !== f || (e = b[f], "object" === typeof e &&
                    e ? e !== d && (d[f] = e._iN$t || k(e, g)) : d[f] = e);
            b instanceof c && (d._objFlags &= l)
        }

        function k(c, g) {
            if (c instanceof a) return c.clone();
            if (c instanceof cc.Asset) return c;
            if (ArrayBuffer.isView(c)) {
                g = c.length;
                var l = new c.constructor(g);
                c._iN$t = l;
                w.push(c);
                for (var e = 0; e < g; ++e) l[e] = c[e];
                return l
            }
            if (Array.isArray(c)) {
                e = c.length;
                l = Array(e);
                n.value(c, "_iN$t", l, !0);
                w.push(c);
                for (var f = 0; f < e; ++f) {
                    var p = c[f];
                    l[f] = "object" === typeof p && p ? p._iN$t || k(p, g) : p
                }
                return l
            }
            if (c._objFlags & d) return null;
            l = c.constructor;
            if (cc.Class._isCCClass(l)) {
                if (g)
                    if (g instanceof cc.Component) {
                        if (c instanceof cc._BaseNode || c instanceof cc.Component) return c
                    } else if (g instanceof cc._BaseNode)
                    if (c instanceof cc._BaseNode) {
                        if (!c.isChildOf(g)) return c
                    } else if (c instanceof cc.Component && !c.node.isChildOf(g)) return c;
                l = new l
            } else if (l === Object) l = {};
            else {
                if (l) return c;
                l = Object.create(null)
            }
            b(c, l, g);
            return l
        }
        var c = h("./CCObject"),
            a = h("../value-types/value-type"),
            d = c.Flags.Destroyed,
            l = c.Flags.PersistentMask,
            g = h("./utils").isDomNode,
            n = h("./js"),
            w = [];
        f._clone = e;
        cc.instantiate = f;
        q.exports =
            f
    }, {
        "../value-types/value-type": 309,
        "./CCObject": 210,
        "./js": 225,
        "./utils": 228
    }],
    225: [function(h, q, m) {
        function f(a, b) {
            for (; a;) {
                var c = Object.getOwnPropertyDescriptor(a, b);
                if (c) return c;
                a = Object.getPrototypeOf(a)
            }
            return null
        }

        function e(a, b) {
            a.splice(b, 1)
        }

        function b(a, b) {
            b = a.indexOf(b);
            return 0 <= b ? (e(a, b), !0) : !1
        }

        function k(a, b) {
            void 0 === b && (b = a, a = null);
            this.get = null;
            this.count = 0;
            this._pool = Array(b);
            this._cleanup = a
        }
        var c = new(h("./id-generater"))("TmpCId."),
            a = {
                isNumber: function(a) {
                    return "number" === typeof a ||
                        a instanceof Number
                },
                isString: function(a) {
                    return "string" === typeof a || a instanceof String
                },
                addon: function(a) {
                    a = a || {};
                    for (var b = 1, c = arguments.length; b < c; b++) {
                        var d = arguments[b];
                        if (d)
                            if ("object" !== typeof d) cc.errorID(5402, d);
                            else
                                for (var g in d)
                                    if (!(g in a)) {
                                        var l = g,
                                            e = a,
                                            k = f(d, l);
                                        Object.defineProperty(e, l, k)
                                    }
                    }
                    return a
                },
                mixin: function(a) {
                    a = a || {};
                    for (var b = 1, c = arguments.length; b < c; b++) {
                        var d = arguments[b];
                        if (d)
                            if ("object" !== typeof d) cc.errorID(5403, d);
                            else
                                for (var g in d) {
                                    var l = g,
                                        e = a,
                                        k = f(d, l);
                                    Object.defineProperty(e,
                                        l, k)
                                }
                    }
                    return a
                },
                extend: function(a, b) {
                    !1;
                    for (var c in b) b.hasOwnProperty(c) && (a[c] = b[c]);
                    a.prototype = Object.create(b.prototype, {
                        constructor: {
                            value: a,
                            writable: !0,
                            configurable: !0
                        }
                    });
                    return a
                },
                getSuper: function(a) {
                    return (a = (a = a.prototype) && Object.getPrototypeOf(a)) && a.constructor
                },
                isChildClassOf: function(b, c) {
                    if (b && c) {
                        if ("function" !== typeof b) return !1;
                        if ("function" !== typeof c) return !1, !1;
                        if (b === c) return !0;
                        for (;;) {
                            b = a.getSuper(b);
                            if (!b) break;
                            if (b === c) return !0
                        }
                    }
                    return !1
                },
                clear: function(a) {
                    for (var b = Object.keys(a),
                            c = 0; c < b.length; c++) delete a[b[c]]
                },
                isEmptyObject: function(a) {
                    for (var b in a) return !1;
                    return !0
                },
                getPropertyDescriptor: f
            },
            d = {
                value: void 0,
                enumerable: !1,
                writable: !1,
                configurable: !0
            };
        a.value = function(a, b, c, g, l) {
            d.value = c;
            d.writable = g;
            d.enumerable = l;
            Object.defineProperty(a, b, d);
            d.value = void 0
        };
        var l = {
            get: null,
            set: null,
            enumerable: !1
        };
        a.getset = function(a, b, c, d, g, e) {
            "function" !== typeof d && (g = d, d = void 0);
            l.get = c;
            l.set = d;
            l.enumerable = g;
            l.configurable = e;
            Object.defineProperty(a, b, l);
            l.get = null;
            l.set = null
        };
        var g = {
            get: null,
            enumerable: !1,
            configurable: !1
        };
        a.get = function(a, b, c, d, l) {
            g.get = c;
            g.enumerable = d;
            g.configurable = l;
            Object.defineProperty(a, b, g);
            g.get = null
        };
        var n = {
            set: null,
            enumerable: !1,
            configurable: !1
        };
        a.set = function(a, b, c, d, g) {
            n.set = c;
            n.enumerable = d;
            n.configurable = g;
            Object.defineProperty(a, b, n);
            n.set = null
        };
        a.getClassName = function(b) {
            if ("function" === typeof b) {
                var c = b.prototype;
                if (c && c.hasOwnProperty("__classname__") && c.__classname__) return c.__classname__;
                c = "";
                b.name && (c = b.name);
                b.toString && (b = b.toString(),
                    (b = "[" === b.charAt(0) ? b.match(/\[\w+\s*(\w+)\]/) : b.match(/function\s*(\w+)/)) && 2 === b.length && (c = b[1]));
                return "Object" !== c ? c : ""
            }
            return b && b.constructor ? a.getClassName(b.constructor) : ""
        };
        (function() {
            function b(b, c, d) {
                a.getset(a, c, function() {
                    return Object.assign({}, d)
                }, function(b) {
                    a.clear(d);
                    Object.assign(d, b)
                });
                return function(c, g) {
                    g.prototype.hasOwnProperty(b) && delete d[g.prototype[b]];
                    a.value(g.prototype, b, c);
                    if (c) {
                        var l = d[c];
                        l && l !== g ? (c = "A Class already exists with the same " + b + ' : "' + c + '".', !1, cc.error(c)) :
                            d[c] = g
                    }
                }
            }
            var d = {},
                g = {};
            a._setClassId = b("__cid__", "_registeredClassIds", d);
            var l = b("__classname__", "_registeredClassNames", g);
            a.setClassName = function(b, d) {
                l(b, d);
                d.prototype.hasOwnProperty("__cid__") || (b = b || c.getNewId()) && a._setClassId(b, d)
            };
            a.unregisterClass = function() {
                for (var a = 0; a < arguments.length; a++) {
                    var b = arguments[a].prototype,
                        c = b.__cid__;
                    c && delete d[c];
                    (b = b.__classname__) && delete g[b]
                }
            };
            a._getClassById = function(a) {
                return d[a]
            };
            a.getClassByName = function(a) {
                return g[a]
            };
            a._getClassId = function(a,
                b) {
                b = "undefined" === typeof b || b;
                if ("function" === typeof a && a.prototype.hasOwnProperty("__cid__")) return a = a.prototype.__cid__, !b && !1, a;
                if (a && a.constructor) {
                    var c = a.constructor.prototype;
                    if (c && c.hasOwnProperty("__cid__")) return a = a.__cid__, !b && !1, a
                }
                return ""
            }
        })();
        a.obsolete = function(b, c, d, g) {
            function l() {
                !1;
                return this[k]
            }
            var e = /([^.]+)$/;
            c = e.exec(c)[0];
            var k = e.exec(d)[0];
            g ? a.getset(b, c, l, function(a) {
                !1;
                this[k] = a
            }) : a.get(b, c, l)
        };
        a.obsoletes = function(b, c, d, g) {
            for (var l in d) a.obsolete(b, c + "." + l, d[l], g)
        };
        var w = /(%d)|(%s)/,
            t = /%s/;
        a.formatStr = function() {
            var a = arguments.length;
            if (0 === a) return "";
            var b = arguments[0];
            if (1 === a) return "" + b;
            if ("string" === typeof b && w.test(b))
                for (var c = 1; c < a; ++c) {
                    var d = arguments[c],
                        g = "number" === typeof d ? w : t;
                    b = g.test(b) ? b.replace(g, "" + d) : b + (" " + d)
                } else
                    for (c = 1; c < a; ++c) b += " " + arguments[c];
            return b
        };
        a.shiftArguments = function() {
            for (var a = arguments.length - 1, b = Array(a), c = 0; c < a; ++c) b[c] = arguments[c + 1];
            return b
        };
        a.createMap = function(a) {
            var b = Object.create(null);
            a && (b["."] = !0, b["/"] = !0,
                delete b["."], delete b["/"]);
            return b
        };
        a.array = {
            remove: b,
            fastRemove: function(a, b) {
                b = a.indexOf(b);
                0 <= b && (a[b] = a[a.length - 1], --a.length)
            },
            removeAt: e,
            fastRemoveAt: function(a, b) {
                var c = a.length;
                0 > b || b >= c || (a[b] = a[c - 1], a.length = c - 1)
            },
            contains: function(a, b) {
                return 0 <= a.indexOf(b)
            },
            verifyType: function(a, b) {
                if (a && 0 < a.length)
                    for (var c = 0; c < a.length; c++)
                        if (!(a[c] instanceof b)) return cc.logID(1300), !1;
                return !0
            },
            removeArray: function(a, c) {
                for (var d = 0, g = c.length; d < g; d++) b(a, c[d])
            },
            appendObjectsAt: function(a, b, c) {
                a.splice.apply(a, [c, 0].concat(b));
                return a
            },
            copy: function(a) {
                var b, c = a.length,
                    d = Array(c);
                for (b = 0; b < c; b += 1) d[b] = a[b];
                return d
            },
            MutableForwardIterator: h("../utils/mutable-forward-iterator")
        };
        k.prototype._get = function() {
            if (0 < this.count) {
                --this.count;
                var a = this._pool[this.count];
                this._pool[this.count] = null;
                return a
            }
            return null
        };
        k.prototype.put = function(a) {
            var b = this._pool;
            this.count < b.length && (!this._cleanup || !1 !== this._cleanup(a)) && (b[this.count] = a, ++this.count)
        };
        k.prototype.resize = function(a) {
            0 <= a && (this._pool.length =
                a, this.count > a && (this.count = a))
        };
        a.Pool = k;
        cc.js = a;
        q.exports = a
    }, {
        "../utils/mutable-forward-iterator": 287,
        "./id-generater": 221
    }],
    226: [function(h, q, m) {
        function f(a, b, l, g) {
            if (a.get || a.set) !1;
            else if (a.hasOwnProperty("default")) {
                var d = "_N$" + b;
                a.get = function() {
                    return this[d]
                };
                a.set = function(a) {
                    var b = this[d];
                    this[d] = a;
                    l.call(this, b)
                };
                !1;
                b = {};
                g[d] = b;
                for (var e in c) g = c[e], a.hasOwnProperty(e) && (b[e] = a[e], g.canUsedInGet || delete a[e])
            } else !1
        }

        function e(a, b, c) {
            a = a ? {
                _short: !0
            } : {
                _short: !0,
                default: b
            };
            c && (a.type =
                c);
            return a
        }
        var b = h("./js"),
            k = h("./attribute"),
            c = {
                default: {},
                serializable: {},
                editorOnly: {},
                formerlySerializedAs: {}
            };
        m.getFullFormOfProperty = function(a, c) {
            return a && a.constructor === Object ? null : Array.isArray(a) && 0 < a.length ? e(c, [], a) : "function" === typeof a ? e(c, b.isChildClassOf(a, cc.ValueType) ? new a : null, a) : a instanceof k.PrimitiveType ? e(c, a["default"]) : e(c, a)
        };
        m.preprocessAttrs = function(a, b, c, g) {
            for (var d in a)
                if (g = a[d], (c = m.getFullFormOfProperty(g, !1)) && (g = a[d] = c), g) {
                    !1;
                    !1;
                    if (c = g.notify) !1, f(g, d, c, a);
                    if ("type" in g) a: {
                        c = g;g = g.type;
                        var l = b,
                            e = d,
                            k = (!1, !1);
                        if (Array.isArray(g)) {
                            if (k && "default" in c) {
                                var u = h("./CCClass").isArray;
                                u(c["default"]) || cc.warnID(5507, l, e)
                            }
                            if (!(0 < g.length)) {
                                cc.errorID(5508, l, e);
                                break a
                            }
                            c.type = g = g[0]
                        }
                        if ("function" === typeof g) g === String ? (c.type = cc.String, k && cc.warnID(3608, '"' + l + "." + e + '"')) : g === Boolean ? (c.type = cc.Boolean, k && cc.warnID(3609, '"' + l + "." + e + '"')) : g === Number && (c.type = cc.Float, k && cc.warnID(3610, '"' + l + "." + e + '"'));
                        else if (k) switch (g) {
                            case "Number":
                                cc.warnID(5510, l, e);
                                break;
                            case "String":
                                cc.warn('The type of "' + l + "." + e + '" must be cc.String, not "String".');
                                break;
                            case "Boolean":
                                cc.warn('The type of "' + l + "." + e + '" must be cc.Boolean, not "Boolean".');
                                break;
                            case "Float":
                                cc.warn('The type of "' + l + "." + e + '" must be cc.Float, not "Float".');
                                break;
                            case "Integer":
                                cc.warn('The type of "' + l + "." + e + '" must be cc.Integer, not "Integer".');
                                break;
                            case null:
                                cc.warnID(5511, l, e)
                        }!1
                    }
                }
        };
        !1;
        m.validateMethodWithProps = function(a, b, c, g, e) {
            !1;
            if ("function" !== typeof a && null !== a) return !1, !1;
            !1;
            return !0
        }
    }, {
        "./CCClass": 204,
        "./attribute": 216,
        "./js": 225
    }],
    227: [function(h, q, m) {
        var f = [];
        cc._RF = {
            push: function(e, b, k) {
                void 0 === k && (k = b, b = "");
                f.push({
                    uuid: b,
                    script: k,
                    module: e,
                    exports: e.exports,
                    beh: null
                })
            },
            pop: function() {
                var e = f.pop(),
                    b = e.module,
                    k = b.exports;
                if (k === e.exports) {
                    for (var c in k) return;
                    b.exports = e.cls
                }
            },
            peek: function() {
                return f[f.length - 1]
            }
        };
        !1
    }, {}],
    228: [function(h, q, m) {
        h("./js");
        q.exports = {
            contains: function(f, e) {
                if ("function" == typeof f.contains) return f.contains(e);
                if ("function" == typeof f.compareDocumentPosition) return !!(16 &
                    f.compareDocumentPosition(e));
                if (e = e.parentNode) {
                    do {
                        if (e === f) return !0;
                        e = e.parentNode
                    } while (null !== e)
                }
                return !1
            },
            isDomNode: "object" === typeof window && ("function" === typeof Node ? function(f) {
                return f instanceof Node
            } : function(f) {
                return f && "object" === typeof f && "number" === typeof f.nodeType && "string" === typeof f.nodeName
            }),
            callInNextTick: function(f, e, b) {
                f && setTimeout(function() {
                    f(e, b)
                }, 0)
            }
        };
        !1;
        !1
    }, {
        "./js": 225
    }],
    229: [function(h, q, m) {
        h("./platform/js");
        h("./value-types");
        h("./utils");
        h("./platform/CCInputManager");
        h("./platform/CCInputExtension");
        h("./event");
        h("./platform/CCSys");
        h("./platform/CCMacro");
        h("./asset-manager");
        h("./CCDirector");
        h("./renderer");
        !0;
        h("./platform/CCView");
        h("./platform/CCScreen");
        h("./CCScheduler");
        h("./event-manager")
    }, {
        "./CCDirector": 38,
        "./CCScheduler": 43,
        "./asset-manager": 61,
        "./event": 153,
        "./event-manager": 149,
        "./platform/CCInputExtension": 207,
        "./platform/CCInputManager": 208,
        "./platform/CCMacro": 209,
        "./platform/CCScreen": 212,
        "./platform/CCSys": 213,
        "./platform/CCView": 214,
        "./platform/js": 225,
        "./renderer": 236,
        "./utils": 285,
        "./value-types": 301
    }],
    230: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, b) {
            for (var c = 0; c < b.length; c++) {
                var d = b[c];
                d.enumerable = d.enumerable || !1;
                d.configurable = !0;
                "value" in d && (d.writable = !0);
                Object.defineProperty(a, d.key, d)
            }
        }

        function b(a, b, c) {
            b && e(a.prototype, b);
            c && e(a, c);
            return a
        }

        function k(a) {
            if (void 0 === a) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
            return a
        }

        function c(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var a = f(h("./assembler")),
            d = f(h("./utils/dynamic-atlas/manager")),
            l = f(h("./webgl/render-data"));
        h("../value-types");
        h = function(a) {
            function g() {
                var b = a.call(this) || this;
                b._renderData = new l["default"];
                b._renderData.init(k(b));
                b.initData();
                b.initLocal();
                return b
            }
            c(g, a);
            var e = g.prototype;
            e.initData = function() {
                this._renderData.createQuadData(0, this.verticesFloats, this.indicesCount)
            };
            e.initLocal = function() {
                this._local = [];
                this._local.length =
                    4
            };
            e.updateColor = function(a, b) {
                var c = this._renderData.uintVDatas[0];
                if (c) {
                    b = null != b ? b : a.node.color._val;
                    a = this.floatsPerVert;
                    for (var d = this.colorOffset, g = c.length; d < g; d += a) c[d] = b
                }
            };
            e.getBuffer = function() {
                return cc.renderer._handle._meshBuffer
            };
            e.updateWorldVerts = function(a) {
                var b = this._local,
                    c = this._renderData.vDatas[0],
                    d = a.node._worldMatrix.m,
                    g = d[0],
                    l = d[1],
                    e = d[4],
                    k = d[5];
                a = d[12];
                d = d[13];
                var n = b[0],
                    f = b[2],
                    h = b[1],
                    t = b[3];
                b = this.floatsPerVert;
                var w = 0;
                if (1 === g && 0 === l && 0 === e && 1 === k) c[w] = n + a, c[w + 1] = h + d,
                    w += b, c[w] = f + a, c[w + 1] = h + d, w += b, c[w] = n + a, c[w + 1] = t + d, w += b, c[w] = f + a, c[w + 1] = t + d;
                else {
                    var m = g * n;
                    g *= f;
                    n *= l;
                    l *= f;
                    f = e * h;
                    e *= t;
                    h *= k;
                    k *= t;
                    c[w] = m + f + a;
                    c[w + 1] = n + h + d;
                    w += b;
                    c[w] = g + f + a;
                    c[w + 1] = l + h + d;
                    w += b;
                    c[w] = m + e + a;
                    c[w + 1] = n + k + d;
                    w += b;
                    c[w] = g + e + a;
                    c[w + 1] = l + k + d
                }
            };
            e.fillBuffers = function(a, b) {
                b.worldMatDirty && this.updateWorldVerts(a);
                a = this._renderData;
                var c = a.vDatas[0];
                a = a.iDatas[0];
                var d = this.getBuffer(b);
                b = d.request(this.verticesCount, this.indicesCount);
                var g = b.byteOffset >> 2,
                    l = d._vData;
                c.length + g > l.length ? l.set(c.subarray(0,
                    l.length - g), g) : l.set(c, g);
                c = d._iData;
                d = b.indiceOffset;
                b = b.vertexOffset;
                g = 0;
                for (l = a.length; g < l; g++) c[d++] = b + a[g]
            };
            e.packToDynamicAtlas = function(a, b) {
                !1;
                if (!b._original && d["default"] && b._texture.packable) {
                    var c = d["default"].insertSpriteFrame(b);
                    c && b._setDynamicAtlasFrame(c)
                }(c = a._materials[0]) && c.getProperty("texture") !== b._texture && (a._vertsDirty = !0, a._updateMaterial())
            };
            b(g, [{
                key: "verticesFloats",
                get: function() {
                    return this.verticesCount * this.floatsPerVert
                }
            }]);
            return g
        }(a["default"]);
        m["default"] =
            h;
        cc.js.addon(h.prototype, {
            floatsPerVert: 5,
            verticesCount: 4,
            indicesCount: 6,
            uvOffset: 2,
            colorOffset: 4
        });
        cc.Assembler2D = h;
        q.exports = m["default"]
    }, {
        "../value-types": 301,
        "./assembler": 233,
        "./utils/dynamic-atlas/manager": void 0,
        "./webgl/render-data": 273
    }],
    231: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        var f = h("./webgl/vertex-format"),
            e = function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("../value-types/vec3")),
            b = [];
        for (h = 0; 4 > h; h++) b.push(cc.v3());
        h = {
            floatsPerVert: 6,
            uvOffset: 3,
            colorOffset: 5,
            getBuffer: function(b) {
                return b._meshBuffer3D
            },
            getVfmt: function() {
                return f.vfmt3D
            },
            updateWorldVerts: function(k) {
                k = k.node._worldMatrix;
                var c = this._local,
                    a = this._renderData.vDatas[0];
                e["default"].set(b[0], c[0], c[1], 0);
                e["default"].set(b[1], c[2], c[1], 0);
                e["default"].set(b[2], c[0], c[3], 0);
                e["default"].set(b[3], c[2], c[3], 0);
                c = this.floatsPerVert;
                for (var d = 0; 4 > d; d++) {
                    var l = b[d];
                    e["default"].transformMat4(l, l, k);
                    var g = c * d;
                    a[g] = l.x;
                    a[g + 1] = l.y;
                    a[g + 2] = l.z
                }
            }
        };
        cc.Assembler3D = h;
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../value-types/vec3": 311,
        "./webgl/vertex-format": 275
    }],
    232: [function(h, q, m) {
        function f(b, a) {
            b.prototype = Object.create(a.prototype);
            b.prototype.constructor = b;
            b.__proto__ = a
        }

        function e(c) {
            Object.getOwnPropertyDescriptor(c, "__assemblerId__") || (c.__assemblerId__ = ++b);
            return c.__assemblerId__
        }
        m.__esModule = !0;
        m["default"] = void 0;
        h = function(b) {
            return b && b.__esModule ? b : {
                default: b
            }
        }(h("../utils/pool"));
        var b = 0,
            k = new(function(b) {
                function a() {
                    var a = arguments.length;
                    for (var c = Array(a), d = 0; d < a; d++) c[d] = arguments[d];
                    a = b.call.apply(b, [this].concat(c)) || this;
                    a._pool = {};
                    return a
                }
                f(a, b);
                var c = a.prototype;
                c.put = function(a) {
                    if (a)
                        if (this.enabled) {
                            var b = e(a.constructor),
                                c = this._pool;
                            c[b] || (c[b] = []);
                            this.count > this.maxSize || (this._clean(a), c[b].push(a), this.count++)
                        } else !1
                };
                c.get = function(a) {
                    if (this.enabled) {
                        var b = this._pool;
                        var c = e(a);
                        b = b[c] && b[c].pop()
                    }
                    b ? this.count-- : b = new a;
                    return b
                };
                c.clear = function() {
                    !1;
                    this._pool = {};
                    this.count = 0
                };
                c._clean = function(a) {
                    !1;
                    a._renderComp = null
                };
                return a
            }(h["default"]));
        h["default"].register("assembler", k);
        m["default"] = k;
        q.exports =
            m["default"]
    }, {
        "../utils/pool": 288
    }],
    233: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        var f = h("./webgl/vertex-format"),
            e = function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("./assembler-pool"));
        h = function() {
            function b() {
                this._extendNative && this._extendNative()
            }
            var e = b.prototype;
            e.init = function(b) {
                this._renderComp = b
            };
            e.updateRenderData = function(b) {};
            e.fillBuffers = function(b, a) {};
            e.getVfmt = function() {
                return f.vfmtPosUvColor
            };
            return b
        }();
        m["default"] = h;
        h.register = function(b, e) {
            b.__assembler__ =
                e
        };
        h.init = function(b) {
            for (var k = b.constructor, c = k.__assembler__; !c;) {
                k = k.$super;
                if (!k) {
                    cc.warn("Can not find assembler for render component : [" + cc.js.getClassName(b) + "]");
                    return
                }
                c = k.__assembler__
            }
            c.getConstructor && (c = c.getConstructor(b));
            b._assembler && b._assembler.constructor === c || (k = e["default"].get(c), k.init(b), b._assembler = k)
        };
        cc.Assembler = h;
        q.exports = m["default"]
    }, {
        "./assembler-pool": 232,
        "./webgl/vertex-format": 275
    }],
    234: [function(h, q, m) {
        h = function(f) {
            try {
                var e = f.getContext("2d")
            } catch (b) {
                console.error(b);
                return
            }
            this._canvas = f;
            this._ctx = e;
            this._caps = {};
            this._stats = {
                drawcalls: 0
            };
            this._sx = this._sy = this._sw = this._sh = this._vx = this._vy = this._vw = this._vh = 0
        };
        h.prototype._restoreTexture = function(f) {};
        h.prototype.setViewport = function(f, e, b, k) {
            if (this._vx !== f || this._vy !== e || this._vw !== b || this._vh !== k) this._vx = f, this._vy = e, this._vw = b, this._vh = k
        };
        h.prototype.setScissor = function(f, e, b, k) {
            if (this._sx !== f || this._sy !== e || this._sw !== b || this._sh !== k) this._sx = f, this._sy = e, this._sw = b, this._sh = k
        };
        h.prototype.clear = function(f) {
            var e =
                this._ctx;
            e.clearRect(this._vx, this._vy, this._vw, this._vh);
            !f || 0 === f[0] && 0 === f[1] && 0 === f[2] || (e.fillStyle = "rgb(" + f[0] + "," + f[1] + "," + f[2] + ")", e.globalAlpha = f[3], e.fillRect(this._vx, this._vy, this._vw, this._vh))
        };
        h.prototype.resetDrawCalls = function() {
            this._stats.drawcalls = 0
        };
        h.prototype.getDrawCalls = function() {
            return this._stats.drawcalls
        };
        q.exports = h
    }, {}],
    235: [function(h, q, m) {
        h = function(f, e) {
            this._device = f;
            this._height = this._width = 4;
            this._image = null;
            e && (void 0 !== e.width && (this._width = e.width), void 0 !==
                e.height && (this._height = e.height), this.updateImage(e))
        };
        h.prototype.update = function(f) {
            this.updateImage(f)
        };
        h.prototype.updateImage = function(f) {
            f.images && f.images[0] && (f = f.images[0]) && f !== this._image && (this._image = f)
        };
        h.prototype.destroy = function() {
            this._image = null
        };
        q.exports = h
    }, {}],
    236: [function(h, q, m) {
        function f(b) {
            return b && b.__esModule ? b : {
                default: b
            }
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = f(h("../../renderer/gfx")),
            b = f(h("../../renderer/core/input-assembler")),
            k = f(h("../../renderer/core/pass"));
        b = cc.renderer = {
            Texture2D: null,
            InputAssembler: b["default"],
            Pass: k["default"],
            renderEngine: null,
            canvas: null,
            device: null,
            scene: null,
            drawCalls: 0,
            _handle: null,
            _cameraNode: null,
            _camera: null,
            _forward: null,
            _flow: null,
            initWebGL: function(b, a) {
                h("./webgl/assemblers");
                var c = h("./webgl/model-batcher");
                this.Texture2D = e["default"].Texture2D;
                this.canvas = b;
                this._flow = cc.RenderFlow;
                !1;
                var l = h("../../renderer/scene/scene"),
                    g = h("../../renderer/renderers/forward-renderer");
                this.device = new e["default"].Device(b, a);
                this.scene =
                    new l;
                b = new e["default"].Texture2D(this.device, {
                    images: [],
                    width: 128,
                    height: 128,
                    wrapS: e["default"].WRAP_REPEAT,
                    wrapT: e["default"].WRAP_REPEAT,
                    format: e["default"].TEXTURE_FMT_RGB8,
                    genMipmaps: !1
                });
                this._forward = new g(this.device, {
                    defaultTexture: b,
                    programTemplates: [],
                    programChunks: {}
                });
                this._handle = new c(this.device, this.scene);
                this._flow.init(this._handle, this._forward)
            },
            initCanvas: function(b) {
                var a = h("./canvas"),
                    c = h("./canvas/Texture2D"),
                    l = h("./canvas/Device");
                this.Device = l;
                this.Texture2D = c;
                this.canvas =
                    b;
                this.device = new l(b);
                this._camera = {
                    a: 1,
                    b: 0,
                    c: 0,
                    d: 1,
                    tx: 0,
                    ty: 0
                };
                this._handle = new a.RenderComponentHandle(this.device, this._camera);
                this._forward = new a.ForwardRenderer;
                this._flow = cc.RenderFlow;
                this._flow.init(this._handle, this._forward)
            },
            updateCameraViewport: function() {
                if (!0, cc.director) {
                    var b = cc.director.getScene();
                    b && b.setScale(1, 1, 1)
                }
                cc.game.renderType === cc.game.RENDER_TYPE_CANVAS && (b = cc.view.getViewportRect(), this.device.setViewport(b.x, b.y, b.width, b.height), this._camera.a = cc.view.getScaleX(),
                    this._camera.d = cc.view.getScaleY(), this._camera.tx = b.x, this._camera.ty = b.y + b.height)
            },
            render: function(b, a) {
                this.device.resetDrawCalls();
                b && (this._flow.render(b, a), this.drawCalls = this.device.getDrawCalls())
            },
            clear: function() {
                this._handle.reset();
                this._forward.clear()
            }
        };
        m["default"] = b;
        q.exports = m["default"]
    }, {
        "../../renderer/core/input-assembler": 324,
        "../../renderer/core/pass": 325,
        "../../renderer/gfx": 334,
        "../../renderer/renderers/forward-renderer": 353,
        "../../renderer/scene/scene": 357,
        "./canvas": void 0,
        "./canvas/Device": 234,
        "./canvas/Texture2D": 235,
        "./webgl/assemblers": 246,
        "./webgl/model-batcher": 271
    }],
    237: [function(h, q, m) {
        function f() {
            this._func = b;
            this._next = null
        }

        function e(b, e) {
            var h = new f;
            h._next = e || y;
            switch (b) {
                case k:
                case c:
                    h._func = h._doNothing;
                    break;
                case a:
                    h._func = h._localTransform;
                    break;
                case d:
                    h._func = h._worldTransform;
                    break;
                case g:
                    h._func = h._opacity;
                    break;
                case n:
                    h._func = h._color;
                    break;
                case l:
                    h._func = h._updateRenderData;
                    break;
                case t:
                    h._func = h._render;
                    break;
                case p:
                    h._func = h._children;
                    break;
                case u:
                    h._func = h._postRender
            }
            return h
        }

        function b(a) {
            for (var b = a._renderFlag, c = z, d = null, g = v; 0 < g;) g & b && (d = e(g, d)), g >>= 1;
            (c[b] = d)._func(a)
        }
        m = 0;
        var k = 1 << m++,
            c = 1 << m++,
            a = 1 << m++,
            d = 1 << m++;
        h = a | d;
        var l = 1 << m++,
            g = 1 << m++,
            n = 1 << m++,
            w = g | n,
            t = 1 << m++,
            p = 1 << m++,
            u = 1 << m++,
            v = 1 << m++,
            A, B, E = 0;
        m = f.prototype;
        m._doNothing = function() {};
        m._localTransform = function(b) {
            b._updateLocalMatrix();
            b._renderFlag &= ~a;
            this._next._func(b)
        };
        m._worldTransform = function(a) {
            A.worldMatDirty++;
            var b = a._matrix,
                c = a._trs,
                g = b.m;
            g[12] = c[0];
            g[13] = c[1];
            g[14] =
                c[2];
            a._mulMat(a._worldMatrix, a._parent._worldMatrix, b);
            a._renderFlag &= ~d;
            this._next._func(a);
            A.worldMatDirty--
        };
        m._opacity = function(a) {
            A.parentOpacityDirty++;
            this._next._func(a);
            a._renderFlag &= ~g;
            A.parentOpacityDirty--
        };
        m._color = function(a) {
            var b = a._renderComponent;
            b && b._updateColor();
            a._renderFlag &= ~n;
            this._next._func(a)
        };
        m._updateRenderData = function(a) {
            var b = a._renderComponent;
            b._assembler.updateRenderData(b);
            a._renderFlag &= ~l;
            this._next._func(a)
        };
        m._render = function(a) {
            var b = a._renderComponent;
            b._checkBacth(A, a._cullingMask);
            b._assembler.fillBuffers(b, A);
            this._next._func(a)
        };
        m._children = function(a) {
            for (var b = E, c = A, g = c.parentOpacity, l = c.parentOpacity *= a._opacity / 255, e = (c.worldMatDirty ? d : 0) | (c.parentOpacityDirty ? w : 0), k = a._children, n = 0, f = k.length; n < f; n++) {
                var h = k[n];
                h._renderFlag |= e;
                if (h._activeInHierarchy && 0 !== h._opacity) {
                    E = h._cullingMask = 0 === h.groupIndex ? b : 1 << h.groupIndex;
                    var p = h._color._val;
                    h._color._fastSetA(h._opacity * l);
                    z[h._renderFlag]._func(h);
                    h._color._val = p
                }
            }
            c.parentOpacity = g;
            this._next._func(a)
        };
        m._postRender = function(a) {
            var b = a._renderComponent;
            b._checkBacth(A, a._cullingMask);
            b._assembler.postFillBuffers(b, A);
            this._next._func(a)
        };
        var y = new f;
        y._func = y._doNothing;
        y._next = y;
        var z = {};
        f.flows = z;
        f.createFlow = e;
        var x = [];
        f.registerValidate = function(a) {
            a._inValidateList || (x.push(a), a._inValidateList = !0)
        };
        f.validateRenderers = function() {
            for (var a = 0, b = x.length; a < b; a++) {
                var c = x[a];
                c.isValid && (c.enabledInHierarchy ? c._validateRender() : c.disableRender(), c._inValidateList = !1)
            }
            x.length = 0
        };
        f.visitRootNode =
            function(a) {
                f.validateRenderers();
                var b = E;
                E = a._cullingMask;
                a._renderFlag & d ? (A.worldMatDirty++, a._calculWorldMatrix(), a._renderFlag &= ~d, z[a._renderFlag]._func(a), A.worldMatDirty--) : z[a._renderFlag]._func(a);
                E = b
            };
        f.render = function(a, b) {
            A.reset();
            A.walking = !0;
            f.visitRootNode(a);
            A.terminate();
            A.walking = !1;
            B.render(A._renderScene, b)
        };
        f.renderCamera = function(a, b) {
            A.reset();
            A.walking = !0;
            f.visitRootNode(b);
            A.terminate();
            A.walking = !1;
            B.renderCamera(a, A._renderScene)
        };
        f.init = function(a, b) {
            A = a;
            B = b;
            z[0] = y;
            for (a =
                1; a < v; a++) z[a] = new f
        };
        f.getBachther = function() {
            return A
        };
        f.FLAG_DONOTHING = k;
        f.FLAG_BREAK_FLOW = c;
        f.FLAG_LOCAL_TRANSFORM = a;
        f.FLAG_WORLD_TRANSFORM = d;
        f.FLAG_TRANSFORM = h;
        f.FLAG_OPACITY = g;
        f.FLAG_COLOR = n;
        f.FLAG_OPACITY_COLOR = w;
        f.FLAG_UPDATE_RENDER_DATA = l;
        f.FLAG_RENDER = t;
        f.FLAG_CHILDREN = p;
        f.FLAG_POST_RENDER = u;
        f.FLAG_FINAL = v;
        q.exports = cc.RenderFlow = f
    }, {}],
    238: [function(h, q, m) {
        function f(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = function(a) {
                return a && a.__esModule ? a : {
                    default: a
                }
            }(h("../../assembler-2d")),
            b = h("../../../utils/text-utils"),
            k = h("../../../platform/CCMacro"),
            c = h("../../../components/CCLabel").Overflow,
            a = h("../utils").shareLabelInfo,
            d = function() {
                this["char"] = "";
                this.valid = !0;
                this.line = this.y = this.x = 0;
                this.hash = ""
            },
            l = cc.rect(),
            g = null,
            n = [],
            w = [],
            t = [],
            p = [],
            u = null,
            v = 0,
            A = 0,
            B = 0,
            E = 0,
            y = 0,
            z = 1,
            x = null,
            C = cc.size(),
            G = "",
            F = 0,
            H = 0,
            I = 0,
            K = 0,
            P = 0,
            S = 0,
            M = 0,
            O = !1,
            L = 0,
            U = 0,
            V = 0;
        h = function(e) {
            function h() {
                return e.apply(this, arguments) ||
                    this
            }
            f(h, e);
            var m = h.prototype;
            m.updateRenderData = function(a) {
                a._vertsDirty && g !== a && (g = a, this._reserveQuads(a, a.string.toString().length), this._updateFontFamily(a), this._updateProperties(a), this._updateLabelInfo(a), this._updateContent(), this.updateWorldVerts(a), g._actualFontSize = F, g.node.setContentSize(C), g._vertsDirty = !1, g = null, this._resetProperties())
            };
            m._updateFontScale = function() {
                z = F / H
            };
            m._updateFontFamily = function(b) {
                var c = b.font;
                x = c.spriteFrame;
                u = c._fntConfig;
                a.fontAtlas = c._fontDefDictionary;
                this.packToDynamicAtlas(b, x)
            };
            m._updateLabelInfo = function() {
                a.hash = "";
                a.margin = 0
            };
            m._updateProperties = function(b) {
                G = b.string.toString();
                F = b.fontSize;
                H = u ? u.fontSize : b.fontSize;
                I = b.horizontalAlign;
                K = b.verticalAlign;
                P = b.spacingX;
                M = b.overflow;
                S = b._lineHeight;
                C.width = b.node.width;
                C.height = b.node.height;
                M === c.NONE ? (O = !1, C.width += 2 * a.margin, C.height += 2 * a.margin) : M === c.RESIZE_HEIGHT ? (O = !0, C.height += 2 * a.margin) : O = b.enableWrapText;
                a.lineHeight = S;
                a.fontSize = F;
                this._setupBMFontOverflowMetrics()
            };
            m._resetProperties =
                function() {
                    x = u = null;
                    a.hash = "";
                    a.margin = 0
                };
            m._updateContent = function() {
                this._updateFontScale();
                this._computeHorizontalKerningForText();
                this._alignText()
            };
            m._computeHorizontalKerningForText = function() {
                var a = G,
                    b = a.length,
                    c;
                u && (c = u.kerningDict);
                if (c && !cc.js.isEmptyObject(c))
                    for (var d = -1, g = 0; g < b; ++g) {
                        var l = a.charCodeAt(g);
                        d = c[d << 16 | 65535 & l] || 0;
                        n[g] = g < b - 1 ? d : 0;
                        d = l
                    } else n.length = 0
            };
            m._multilineTextWrap = function(d) {
                for (var g = G.length, l = 0, e = 0, k = 0, f = 0, h = 0, p = 0, w = 0, B, x = cc.v2(0, 0), m = 0; m < g;) {
                    var q = G.charAt(m);
                    if ("\n" ===
                        q) t.push(h), h = 0, l++, e = 0, k -= S * this._getFontScale() + 0, this._recordPlaceholderInfo(m, q), m++;
                    else {
                        for (var r = d(G, m, g), F = p, H = w, I = h, K = e, Z = !1, Q = 0; Q < r; ++Q) {
                            var R = m + Q;
                            q = G.charAt(R);
                            if ("\r" === q) this._recordPlaceholderInfo(R, q);
                            else if (B = a.fontAtlas.getLetterDefinitionForChar(q, a)) {
                                var da = K + B.offsetX * z - a.margin;
                                if (O && 0 < V && 0 < e && da + B.w * z > V && !b.isUnicodeSpace(q)) {
                                    t.push(h);
                                    h = 0;
                                    l++;
                                    e = 0;
                                    k -= S * this._getFontScale() + 0;
                                    Z = !0;
                                    break
                                }
                                x.x = da;
                                x.y = k - B.offsetY * z + a.margin;
                                this._recordLetterInfo(x, q, R, l);
                                R + 1 < n.length && R < g - 1 && (K +=
                                    n[R + 1]);
                                K += B.xAdvance * z + P - 2 * a.margin;
                                I = x.x + B.w * z - a.margin;
                                F < x.y && (F = x.y);
                                H > x.y - B.h * z && (H = x.y - B.h * z)
                            } else this._recordPlaceholderInfo(R, q), B = "", u && (B = u.atlasName), console.log("Can't find letter definition in texture atlas " + B + " for letter:" + q)
                        }
                        Z || (e = K, h = I, p < F && (p = F), w > H && (w = H), f < h && (f = h), m += r)
                    }
                }
                t.push(h);
                v = l + 1;
                A = v * S * this._getFontScale();
                1 < v && (A += 0 * (v - 1));
                C.width = L;
                C.height = U;
                0 >= L && (C.width = parseFloat(f.toFixed(2)) + 2 * a.margin);
                0 >= U && (C.height = parseFloat(A.toFixed(2)) + 2 * a.margin);
                E = C.height;
                y = 0;
                M !==
                    c.CLAMP && (0 < p && (E = C.height + p), w < -A && (y = A + w));
                return !0
            };
            m._getFirstCharLen = function() {
                return 1
            };
            m._getFontScale = function() {
                return M === c.SHRINK ? z : 1
            };
            m._getFirstWordLen = function(c, d, g) {
                var l = c.charAt(d);
                if (b.isUnicodeCJK(l) || "\n" === l || b.isUnicodeSpace(l)) return 1;
                var e = 1,
                    k = a.fontAtlas.getLetterDefinitionForChar(l, a);
                if (!k) return e;
                for (var n = k.xAdvance * z + P, f = d + 1; f < g; ++f) {
                    l = c.charAt(f);
                    k = a.fontAtlas.getLetterDefinitionForChar(l, a);
                    if (!k) break;
                    d = n + k.offsetX * z;
                    if (d + k.w * z > V && !b.isUnicodeSpace(l) && 0 < V) break;
                    n += k.xAdvance * z + P;
                    if ("\n" === l || b.isUnicodeSpace(l) || b.isUnicodeCJK(l)) break;
                    e++
                }
                return e
            };
            m._multilineTextWrapByWord = function() {
                return this._multilineTextWrap(this._getFirstWordLen)
            };
            m._multilineTextWrapByChar = function() {
                return this._multilineTextWrap(this._getFirstCharLen)
            };
            m._recordPlaceholderInfo = function(b, c) {
                if (b >= w.length) {
                    var g = new d;
                    w.push(g)
                }
                w[b]["char"] = c;
                w[b].hash = c.charCodeAt(0) + a.hash;
                w[b].valid = !1
            };
            m._recordLetterInfo = function(b, c, g, l) {
                if (g >= w.length) {
                    var e = new d;
                    w.push(e)
                }
                e = c.charCodeAt(0) +
                    a.hash;
                w[g].line = l;
                w[g]["char"] = c;
                w[g].hash = e;
                w[g].valid = a.fontAtlas.getLetter(e).valid;
                w[g].x = b.x;
                w[g].y = b.y
            };
            m._alignText = function() {
                A = 0;
                t.length = 0;
                this._multilineTextWrapByWord();
                this._computeAlignmentOffset();
                M === c.SHRINK && 0 < F && this._isVerticalClamp() && this._shrinkLabelToContentSize(this._isVerticalClamp);
                this._updateQuads() || M === c.SHRINK && this._shrinkLabelToContentSize(this._isHorizontalClamp)
            };
            m._scaleFontSizeDown = function(a) {
                var b = !0;
                a || (a = .1, b = !1);
                F = a;
                b && this._updateContent()
            };
            m._shrinkLabelToContentSize =
                function(a) {
                    for (var b = 0, c = 0 | F, d; b < c;) {
                        var g = d = b + c + 1 >> 1;
                        if (0 >= g) break;
                        z = g / H;
                        this._multilineTextWrapByWord();
                        this._computeAlignmentOffset();
                        a() ? c = d - 1 : b = d
                    }
                    a = b;
                    0 <= a && this._scaleFontSizeDown(a)
                };
            m._isVerticalClamp = function() {
                return A > C.height
            };
            m._isHorizontalClamp = function() {
                for (var b = !1, c = 0, d = G.length; c < d; ++c) {
                    var g = w[c];
                    if (g.valid) {
                        var l = a.fontAtlas.getLetter(g.hash);
                        l = g.x + l.w * z;
                        g = g.line;
                        if (0 < L)
                            if (O) {
                                if (t[g] > C.width && (l > C.width || 0 > l)) {
                                    b = !0;
                                    break
                                }
                            } else if (l > C.width) {
                            b = !0;
                            break
                        }
                    }
                }
                return b
            };
            m._isHorizontalClamped =
                function(a, b) {
                    b = t[b];
                    a = a > C.width || 0 > a;
                    return O ? b > C.width && a : a
                };
            m._updateQuads = function() {
                var b = x ? x._texture : a.fontAtlas.getTexture(),
                    d = g.node;
                this.verticesCount = this.indicesCount = 0;
                this._renderData && (this._renderData.dataLength = 0);
                var e = d._anchorPoint.x * C.width;
                d = d._anchorPoint.y * C.height;
                for (var k = !0, n = 0, f = G.length; n < f; ++n) {
                    var h = w[n];
                    if (h.valid) {
                        var t = a.fontAtlas.getLetter(h.hash);
                        l.height = t.h;
                        l.width = t.w;
                        l.x = t.u;
                        l.y = t.v;
                        var u = h.y + B;
                        if (0 < U) {
                            if (u > E) {
                                var v = u - E;
                                l.y += v;
                                l.height -= v;
                                u -= v
                            }
                            u - t.h * z < y && M ===
                                c.CLAMP && (l.height = u < y ? 0 : (u - y) / z)
                        }
                        v = h.line;
                        var A = h.x + t.w / 2 * z + p[v];
                        if (0 < L && this._isHorizontalClamped(A, v))
                            if (M === c.CLAMP) l.width = 0;
                            else if (M === c.SHRINK) {
                            if (C.width > t.w) {
                                k = !1;
                                break
                            }
                            l.width = 0
                        }
                        0 < l.height && 0 < l.width && (t = this._determineRect(l), this.appendQuad(g, b, l, t, h.x + p[h.line] - e, u - d, z))
                    }
                }
                this._quadsUpdated(g);
                return k
            };
            m._determineRect = function(a) {
                var b = x.isRotated(),
                    c = x._originalSize,
                    d = x._rect,
                    g = x._offset,
                    l = g.x + (c.width - d.width) / 2;
                c = g.y - (c.height - d.height) / 2;
                b ? (g = a.x, a.x = d.x + d.height - a.y - a.height -
                    c, a.y = g + d.y - l, 0 > a.y && (a.height += c)) : (a.x += d.x - l, a.y += d.y + c);
                return b
            };
            m._computeAlignmentOffset = function() {
                p.length = 0;
                switch (I) {
                    case k.TextAlignment.LEFT:
                        for (var a = 0; a < v; ++a) p.push(0);
                        break;
                    case k.TextAlignment.CENTER:
                        a = 0;
                        for (var b = t.length; a < b; a++) p.push((C.width - t[a]) / 2);
                        break;
                    case k.TextAlignment.RIGHT:
                        for (a = 0, b = t.length; a < b; a++) p.push(C.width - t[a])
                }
                B = C.height;
                K !== k.VerticalTextAlignment.TOP && (a = C.height - A + S * this._getFontScale() - H * z, K === k.VerticalTextAlignment.BOTTOM ? B -= a : B -= a / 2)
            };
            m._setupBMFontOverflowMetrics =
                function() {
                    var a = C.width,
                        b = C.height;
                    M === c.RESIZE_HEIGHT && (b = 0);
                    M === c.NONE && (b = a = 0);
                    L = a;
                    U = b;
                    V = a
                };
            m.updateWorldVerts = function() {};
            m.appendQuad = function(a, b, c, d, g, l, e) {};
            m._quadsUpdated = function(a) {};
            m._reserveQuads = function() {};
            return h
        }(e["default"]);
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../../../components/CCLabel": 118,
        "../../../platform/CCMacro": 209,
        "../../../utils/text-utils": 293,
        "../../assembler-2d": 230,
        "../utils": 242
    }],
    239: [function(h, q, m) {
        function f() {
            this._rect = null;
            this.uv = [];
            this._original =
                this._texture = null
        }
        f.prototype = {
            constructor: f,
            getRect: function() {
                return cc.rect(this._rect)
            },
            setRect: function(e) {
                this._rect = e;
                this._texture && this._calculateUV()
            },
            _setDynamicAtlasFrame: function(e) {
                e && (this._original = {
                    _texture: this._texture,
                    _x: this._rect.x,
                    _y: this._rect.y
                }, this._texture = e.texture, this._rect.x = e.x, this._rect.y = e.y, this._calculateUV())
            },
            _resetDynamicAtlasFrame: function() {
                this._original && (this._rect.x = this._original._x, this._rect.y = this._original._y, this._texture = this._original._texture,
                    this._original = null, this._calculateUV())
            },
            _refreshTexture: function(e) {
                this._texture = e;
                this._rect = cc.rect(0, 0, e.width, e.height);
                this._calculateUV()
            },
            _calculateUV: function() {
                var e = this._rect,
                    b = this._texture,
                    k = this.uv,
                    c = b.width,
                    a = b.height;
                b = 0 === c ? 0 : e.x / c;
                c = 0 === c ? 0 : (e.x + e.width) / c;
                var d = 0 === a ? 0 : (e.y + e.height) / a;
                e = 0 === a ? 0 : e.y / a;
                k[0] = b;
                k[1] = d;
                k[2] = c;
                k[3] = d;
                k[4] = b;
                k[5] = e;
                k[6] = c;
                k[7] = e
            }
        };
        q.exports = f
    }, {}],
    240: [function(h, q, m) {
        function f(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }

        function e(a, b) {
            this._texture = null;
            this._labelInfo = b;
            this._char = a;
            this._context = this._canvas = this._data = this._hash = null;
            this._offsetY = this._height = this._width = 0;
            this._hash = a.charCodeAt(0) + b.hash
        }

        function b(a, b) {
            var c = new g;
            c.initWithSize(a, b);
            c.update();
            this._fontDefDictionary = new u(c);
            this._nexty = this._y = this._x = 0;
            this._width = a;
            this._height = b;
            cc.director.on(cc.Director.EVENT_BEFORE_SCENE_LAUNCH, this.beforeSceneLoad, this)
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var k = function(a) {
                return a &&
                    a.__esModule ? a : {
                        default: a
                    }
            }(h("../../webgl/assemblers/label/2d/bmfont")),
            c = h("../../../components/CCLabel"),
            a = h("../../../components/CCLabelOutline"),
            d = h("../../../utils/text-utils"),
            l = h("../../../components/CCComponent"),
            g = h("../../../assets/CCRenderTexture"),
            n = cc.js.isChildClassOf(a, l),
            w = h("../utils").getFontFamily,
            t = h("../utils").shareLabelInfo,
            p = cc.BitmapFont.FontLetterDefinition,
            u = cc.BitmapFont.FontAtlas,
            v = cc.Color.WHITE,
            A = (1 / 255).toFixed(3);
        e.prototype = {
            constructor: e,
            updateRenderData: function() {
                this._updateProperties();
                this._updateTexture()
            },
            _updateProperties: function() {
                this._texture = new cc.Texture2D;
                this._data = c._canvasPool.get();
                this._canvas = this._data.canvas;
                this._context = this._data.context;
                this._context.font = this._labelInfo.fontDesc;
                var a = d.safeMeasureText(this._context, this._char, this._labelInfo.fontDesc),
                    b = 2 * this._labelInfo.margin + 2;
                this._width = parseFloat(a.toFixed(2)) + b;
                this._height = (1 + d.BASELINE_RATIO) * this._labelInfo.fontSize + b;
                this._offsetY = -this._labelInfo.fontSize * d.BASELINE_RATIO / 2;
                this._canvas.width !==
                    this._width && (this._canvas.width = this._width);
                this._canvas.height !== this._height && (this._canvas.height = this._height);
                this._texture.initWithElement(this._canvas)
            },
            _updateTexture: function() {
                var a = this._context,
                    b = this._labelInfo,
                    c = this._canvas.width,
                    g = this._canvas.height,
                    l = this._labelInfo.fontSize,
                    e = c / 2;
                l = g / 2 + l * d.MIDDLE_RATIO + l * d.BASELINE_OFFSET;
                var k = b.color;
                a.lineJoin = "round";
                a.textAlign = "center";
                a.clearRect(0, 0, c, g);
                a.fillStyle = "rgba(" + k.r + ", " + k.g + ", " + k.b + ", " + A + ")";
                a.fillRect(0, 0, c, g);
                a.font = b.fontDesc;
                a.fillStyle = "rgba(" + k.r + ", " + k.g + ", " + k.b + ", 1)";
                b.isOutlined && 0 < b.margin && (c = b.out || v, a.strokeStyle = "rgba(" + c.r + ", " + c.g + ", " + c.b + ", " + c.a / 255 + ")", a.lineWidth = 2 * b.margin, a.strokeText(this._char, e, l));
                a.fillText(this._char, e, l);
                this._texture.handleLoadedTexture()
            },
            destroy: function() {
                this._texture.destroy();
                this._texture = null;
                c._canvasPool.put(this._data)
            }
        };
        cc.js.mixin(b.prototype, {
            insertLetterTexture: function(a) {
                var b = a._texture,
                    c = b.width,
                    d = b.height;
                this._x + c + 0 > this._width && (this._x = 0, this._y = this._nexty);
                this._y + d > this._nexty && (this._nexty = this._y + d + 0);
                if (this._nexty > this._height) return null;
                this._fontDefDictionary._texture.drawTextureAt(b, this._x, this._y);
                this._dirty = !0;
                b = new p;
                b.u = this._x + 1;
                b.v = this._y + 1;
                b.texture = this._fontDefDictionary._texture;
                b.valid = !0;
                b.w = a._width - 2;
                b.h = a._height - 2;
                b.xAdvance = b.w;
                b.offsetY = a._offsetY;
                this._x += c + 0;
                this._fontDefDictionary.addLetterDefinitions(a._hash, b);
                return b
            },
            update: function() {
                this._dirty && (this._fontDefDictionary._texture.update(), this._dirty = !1)
            },
            reset: function() {
                this._nexty =
                    this._y = this._x = 0;
                for (var a = this._fontDefDictionary._letterDefinitions, b = 0, c = a.length; b < c; b++) {
                    var d = a[b];
                    d.isValid && d.destroy()
                }
                this._fontDefDictionary.clear()
            },
            destroy: function() {
                this.reset();
                this._fontDefDictionary._texture.destroy();
                this._fontDefDictionary._texture = null
            },
            beforeSceneLoad: function() {
                this.clearAllCache()
            },
            clearAllCache: function() {
                this.destroy();
                var a = new g;
                a.initWithSize(this._width, this._height);
                a.update();
                this._fontDefDictionary._texture = a
            },
            getLetter: function(a) {
                return this._fontDefDictionary._letterDefinitions[a]
            },
            getTexture: function() {
                return this._fontDefDictionary.getTexture()
            },
            getLetterDefinitionForChar: function(a, b) {
                var c = a.charCodeAt(0) + b.hash;
                c = this._fontDefDictionary._letterDefinitions[c];
                c || (a = new e(a, b), a.updateRenderData(), c = this.insertLetterTexture(a), a.destroy());
                return c
            }
        });
        var B = null;
        h = function(c) {
            function d() {
                return c.apply(this, arguments) || this
            }
            f(d, c);
            var g = d.prototype;
            g._getAssemblerData = function() {
                B || (B = new b(2048, 2048), cc.Label._shareAtlas = B);
                return B.getTexture()
            };
            g._updateFontFamily = function(b) {
                t.fontAtlas =
                    B;
                t.fontFamily = w(b);
                var c = n && b.getComponent(a);
                c && c.enabled ? (t.isOutlined = !0, t.margin = c.width, t.out = c.color.clone(), t.out.a = c.color.a * b.node.color.a / 255) : (t.isOutlined = !1, t.margin = 0)
            };
            g._updateLabelInfo = function(a) {
                t.fontDesc = this._getFontDesc();
                t.color = a.node.color;
                a = t.color.toHEX();
                var b = "";
                t.isOutlined && 0 < t.margin && (b = b + t.margin + t.out.toHEX());
                t.hash = "" + t.fontSize + t.fontFamily + a + b
            };
            g._getFontDesc = function() {
                var a = t.fontSize.toString() + "px ";
                return a += t.fontFamily
            };
            g._computeHorizontalKerningForText =
                function() {};
            g._determineRect = function(a) {
                return !1
            };
            return d
        }(k["default"]);
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../../../assets/CCRenderTexture": 81,
        "../../../components/CCComponent": 116,
        "../../../components/CCLabel": 118,
        "../../../components/CCLabelOutline": 119,
        "../../../utils/text-utils": 293,
        "../../webgl/assemblers/label/2d/bmfont": 247,
        "../utils": 242
    }],
    241: [function(h, q, m) {
        function f(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] =
            void 0;
        var e = function(a) {
                return a && a.__esModule ? a : {
                    default: a
                }
            }(h("../../assembler-2d")),
            b = h("../../../utils/text-utils"),
            k = h("../../../platform/CCMacro"),
            c = h("../../../components/CCLabel"),
            a = h("../../../components/CCLabelOutline"),
            d = h("../../../components/CCLabelShadow"),
            l = c.Overflow,
            g = h("../utils").deleteFromDynamicAtlas,
            n = h("../utils").getFontFamily,
            w = (1 / 255).toFixed(3),
            t = null,
            p = null,
            u = null,
            v = "",
            A = "",
            B = 0,
            E = 0,
            y = [],
            z = cc.Size.ZERO,
            x = 0,
            C = 0,
            G = 0,
            F = null,
            H = "",
            I = l.NONE,
            K = !1,
            P = !1,
            S = null,
            M = cc.Color.WHITE,
            O = null,
            L = cc.Color.BLACK,
            U = cc.rect(),
            V = cc.Size.ZERO,
            Z = cc.Size.ZERO,
            da = !1,
            Q = !1,
            R = !1,
            fa = 0,
            ba = cc.Vec2.ZERO,
            W = 0,
            aa, ca = ["left", "center", "right"];
        h = function(e) {
            function h() {
                return e.apply(this, arguments) || this
            }
            f(h, e);
            var m = h.prototype;
            m._getAssemblerData = function() {
                aa = c._canvasPool.get();
                aa.canvas.width = aa.canvas.height = 1;
                return aa
            };
            m._resetAssemblerData = function(a) {
                a && c._canvasPool.put(a)
            };
            m.updateRenderData = function(a) {
                e.prototype.updateRenderData.call(this, a);
                a._vertsDirty && (this._updateProperties(a),
                    this._calculateLabelFont(), this._updateLabelDimensions(), this._updateTexture(a), this._calDynamicAtlas(a), a._actualFontSize = B, a.node.setContentSize(Z), this.updateVerts(a), a._vertsDirty = !1, u = p = t = null)
            };
            m.updateVerts = function() {};
            m._updatePaddingRect = function() {
                var a = 0,
                    b = 0,
                    c = 0,
                    d = 0,
                    g = 0;
                V.width = V.height = 0;
                S && (a = b = c = d = g = S.width, V.width = V.height = 2 * g);
                O && (g = O.blur + g, c = Math.max(c, -O._offset.x + g), d = Math.max(d, O._offset.x + g), a = Math.max(a, O._offset.y + g), b = Math.max(b, -O._offset.y + g));
                Q && (g = E * Math.tan(.20943951),
                    d += g, V.width += g);
                U.x = c;
                U.y = a;
                U.width = c + d;
                U.height = a + b
            };
            m._updateProperties = function(b) {
                var c = b._assemblerData;
                t = c.context;
                p = c.canvas;
                u = b._frame._original ? b._frame._original._texture : b._frame._texture;
                A = b.string.toString();
                E = B = b._fontSize;
                fa = b.underlineHeight || E / 8;
                I = b.overflow;
                z.width = b.node.width;
                z.height = b.node.height;
                Z = b.node.getContentSize();
                x = b._lineHeight;
                C = b.horizontalAlign;
                G = b.verticalAlign;
                F = b.node.color;
                da = b.enableBold;
                Q = b.enableItalic;
                R = b.enableUnderline;
                H = n(b);
                P = b.srcBlendFactor === cc.macro.BlendFactor.ONE;
                !1;
                K = I !== l.NONE && (I === l.RESIZE_HEIGHT || b.enableWrapText);
                (S = (S = a && b.getComponent(a)) && S.enabled && 0 < S.width ? S : null) && M.set(S.color);
                if (O = (O = d && b.getComponent(d)) && O.enabled ? O : null) L.set(O.color), L.a = L.a * b.node.color.a / 255;
                this._updatePaddingRect()
            };
            m._calculateFillTextStartPosition = function() {
                var a = 0;
                C === k.TextAlignment.RIGHT ? a = z.width - U.width : C === k.TextAlignment.CENTER && (a = (z.width - U.width) / 2);
                var c = this._getLineHeight() * (y.length - 1),
                    d = B * (1 - b.BASELINE_RATIO / 2);
                G !== k.VerticalTextAlignment.TOP && (c =
                    c + U.height + B - z.height, G === k.VerticalTextAlignment.BOTTOM ? (c += b.BASELINE_RATIO / 2 * B, d -= c) : d -= c / 2);
                d += b.BASELINE_OFFSET * B;
                return cc.v2(a + U.x, d + U.y)
            };
            m._setupOutline = function() {
                t.strokeStyle = "rgba(" + M.r + ", " + M.g + ", " + M.b + ", " + M.a / 255 + ")";
                t.lineWidth = 2 * S.width
            };
            m._setupShadow = function() {
                t.shadowColor = "rgba(" + L.r + ", " + L.g + ", " + L.b + ", " + L.a / 255 + ")";
                t.shadowBlur = O.blur;
                t.shadowOffsetX = O.offset.x;
                t.shadowOffsetY = -O.offset.y
            };
            m._drawTextEffect = function(a, b) {
                if (O || S || R) {
                    var c = 1 < y.length && O,
                        d = this._measureText(t,
                            v);
                    O && this._setupShadow();
                    S && this._setupOutline();
                    for (var g = 0; g < y.length; ++g) {
                        var l = a.x;
                        var e = a.y + g * b;
                        c && (S && t.strokeText(y[g], l, e), t.fillText(y[g], l, e));
                        R && (W = d(y[g]), C === k.TextAlignment.RIGHT ? ba.x = a.x - W : C === k.TextAlignment.CENTER ? ba.x = a.x - W / 2 : ba.x = a.x, ba.y = e + E / 8, t.fillRect(ba.x, ba.y, W, fa))
                    }
                    c && (t.shadowColor = "transparent")
                }
            };
            m._updateTexture = function() {
                t.clearRect(0, 0, p.width, p.height);
                t.lineJoin = "round";
                if (P) t.fillStyle = "rgba(" + F.r + ", " + F.g + ", " + F.b + ", " + F.a / 255 + ")";
                else {
                    var a = S ? M : F;
                    t.fillStyle =
                        "rgba(" + a.r + ", " + a.g + ", " + a.b + ", " + w + ")";
                    t.fillRect(0, 0, p.width, p.height);
                    t.fillStyle = "rgba(" + F.r + ", " + F.g + ", " + F.b + ", 1)"
                }
                a = this._calculateFillTextStartPosition();
                var b = this._getLineHeight(),
                    c = a.x;
                this._drawTextEffect(a, b);
                for (var d = 0; d < y.length; ++d) {
                    var g = a.y + d * b;
                    S && t.strokeText(y[d], c, g);
                    t.fillText(y[d], c, g)
                }
                O && (t.shadowColor = "transparent");
                u.handleLoadedTexture()
            };
            m._calDynamicAtlas = function(a) {
                if (a.cacheMode === c.CacheMode.BITMAP) {
                    var b = a._frame;
                    g(a, b);
                    b._original || b.setRect(cc.rect(0, 0, p.width,
                        p.height));
                    this.packToDynamicAtlas(a, b)
                }
            };
            m._updateLabelDimensions = function() {
                z.width = Math.min(z.width, 2048);
                z.height = Math.min(z.height, 2048);
                var a = !1;
                p.width !== z.width && (p.width = z.width, a = !0);
                p.height !== z.height && (p.height = z.height, a = !0);
                a && (t.font = v);
                t.textAlign = ca[C]
            };
            m._getFontDesc = function() {
                var a = B.toString() + "px ";
                a += H;
                da && (a = "bold " + a);
                Q && (a = "italic " + a);
                return a
            };
            m._getLineHeight = function() {
                var a = x;
                a = 0 === a ? B : a * B / E;
                return 0 | a
            };
            m._calculateParagraphLength = function(a, c) {
                for (var d = [], g = 0; g < a.length; ++g) {
                    var l =
                        b.safeMeasureText(c, a[g], v);
                    d.push(l)
                }
                return d
            };
            m._measureText = function(a, c) {
                return function(d) {
                    return b.safeMeasureText(a, d, c)
                }
            };
            m._calculateShrinkFont = function(a) {
                var c = this._calculateParagraphLength(a, t),
                    d, g, l = 0;
                if (K) {
                    if (c = Z.width, l = Z.height, !(0 > c || 0 > l)) {
                        for (var e, k = 0, n = 0 | B + 1, f; k < n;) {
                            f = k + n + 1 >> 1;
                            if (0 >= f) {
                                cc.logID(4003);
                                break
                            }
                            B = f;
                            v = this._getFontDesc();
                            t.font = v;
                            var h = this._getLineHeight();
                            for (d = g = 0; d < a.length; ++d) e = b.safeMeasureText(t, a[d], v), e = b.fragmentText(a[d], e, c, this._measureText(t, v)), g += e.length *
                                h;
                            g > l ? n = f - 1 : k = f
                        }
                        0 === k ? cc.logID(4003) : (B = k, v = this._getFontDesc(), t.font = v)
                    }
                } else {
                    g = a.length * this._getLineHeight();
                    for (d = 0; d < a.length; ++d) l < c[d] && (l = c[d]);
                    B = E * Math.min(1, (z.width - U.width) / l, z.height / g) | 0;
                    v = this._getFontDesc();
                    t.font = v
                }
            };
            m._calculateWrapText = function(a) {
                if (K) {
                    y = [];
                    for (var c = Z.width, d = 0; d < a.length; ++d) {
                        var g = b.safeMeasureText(t, a[d], v);
                        g = b.fragmentText(a[d], g, c, this._measureText(t, v));
                        y = y.concat(g)
                    }
                }
            };
            m._calculateLabelFont = function() {
                var a = A.split("\n");
                y = a;
                v = this._getFontDesc();
                t.font =
                    v;
                switch (I) {
                    case l.NONE:
                        for (var c = 0, d = 0; d < a.length; ++d) {
                            var g = b.safeMeasureText(t, a[d], v);
                            c = c > g ? c : g
                        }
                        a = (y.length + b.BASELINE_RATIO) * this._getLineHeight();
                        c = parseFloat(c.toFixed(2));
                        a = parseFloat(a.toFixed(2));
                        z.width = c + U.width;
                        z.height = a + U.height;
                        Z.width = c + V.width;
                        Z.height = a + V.height;
                        break;
                    case l.SHRINK:
                        this._calculateShrinkFont(a);
                        this._calculateWrapText(a);
                        break;
                    case l.CLAMP:
                        this._calculateWrapText(a);
                        break;
                    case l.RESIZE_HEIGHT:
                        this._calculateWrapText(a), c = (y.length + b.BASELINE_RATIO) * this._getLineHeight(),
                            z.height = c + U.height, Z.height = c + V.height
                }
            };
            return h
        }(e["default"]);
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../../../components/CCLabel": 118,
        "../../../components/CCLabelOutline": 119,
        "../../../components/CCLabelShadow": 120,
        "../../../platform/CCMacro": 209,
        "../../../utils/text-utils": 293,
        "../../assembler-2d": 230,
        "../utils": 242
    }],
    242: [function(h, q, m) {
        var f = h("./dynamic-atlas/manager");
        h = cc.Color.WHITE;
        q.exports = {
            deleteFromDynamicAtlas: function(e, b) {
                b && b._original && f && (f.deleteAtlasSpriteFrame(b), b._resetDynamicAtlasFrame())
            },
            getFontFamily: function(e) {
                if (e.useSystemFont) return e.fontFamily || "Arial";
                if (e.font) {
                    if (e.font._nativeAsset) return e.font._nativeAsset;
                    cc.assetManager.postLoadNative(e.font, function(b) {
                        e.setVertsDirty()
                    })
                }
                return "Arial"
            },
            shareLabelInfo: {
                fontAtlas: null,
                fontSize: 0,
                lineHeight: 0,
                hAlign: 0,
                vAlign: 0,
                hash: "",
                fontFamily: "",
                fontDesc: "Arial",
                color: h,
                isOutlined: !1,
                out: h,
                margin: 0
            }
        }
    }, {
        "./dynamic-atlas/manager": void 0
    }],
    243: [function(h, q, m) {
        function f(d, g, n) {
            n = n || 2;
            var f = g && g.length,
                h = f ? g[0] * n : d.length,
                p = e(d, 0, h,
                    n, !0),
                t = [];
            if (!p) return t;
            var v;
            if (f) {
                var w = n;
                f = [];
                var A;
                var B = 0;
                for (A = g.length; B < A; B++) {
                    var y = g[B] * w;
                    var E = B < A - 1 ? g[B + 1] * w : d.length;
                    y = e(d, y, E, w, !1);
                    y === y.next && (y.steiner = !0);
                    f.push(l(y))
                }
                f.sort(c);
                for (B = 0; B < f.length; B++) {
                    g = f[B];
                    w = p;
                    if (w = a(g, w)) g = u(w, g), b(g, g.next);
                    p = b(p, p.next)
                }
            }
            if (d.length > 80 * n) {
                var m = v = d[0];
                var x = f = d[1];
                for (w = n; w < h; w += n) B = d[w], g = d[w + 1], B < m && (m = B), g < x && (x = g), B > v && (v = B), g > f && (f = g);
                v = Math.max(v - m, f - x)
            }
            k(p, t, n, m, x, v);
            return t
        }

        function e(a, b, c, d, g) {
            if (g === 0 < E(a, b, c, d))
                for (g = b; g < c; g +=
                    d) var l = v(g, a[g], a[g + 1], l);
            else
                for (g = c - d; g >= b; g -= d) l = v(g, a[g], a[g + 1], l);
            l && w(l, l.next) && (A(l), l = l.next);
            return l
        }

        function b(a, b) {
            if (!a) return a;
            b || (b = a);
            do {
                var c = !1;
                if (a.steiner || !w(a, a.next) && 0 !== n(a.prev, a, a.next)) a = a.next;
                else {
                    A(a);
                    a = b = a.prev;
                    if (a === a.next) return null;
                    c = !0
                }
            } while (c || a !== b);
            return b
        }

        function k(a, c, l, e, f, h, v) {
            if (a) {
                if (!v && h) {
                    var B = a,
                        y = B;
                    do null === y.z && (y.z = d(y.x, y.y, e, f, h)), y.prevZ = y.prev, y = y.nextZ = y.next; while (y !== B);
                    y.prevZ.nextZ = null;
                    y.prevZ = null;
                    B = y;
                    var E, m, x, z, C = 1;
                    do {
                        y = B;
                        var q =
                            B = null;
                        for (m = 0; y;) {
                            m++;
                            var G = y;
                            for (E = x = 0; E < C && (x++, G = G.nextZ, G); E++);
                            for (z = C; 0 < x || 0 < z && G;) 0 === x ? (E = G, G = G.nextZ, z--) : 0 !== z && G ? y.z <= G.z ? (E = y, y = y.nextZ, x--) : (E = G, G = G.nextZ, z--) : (E = y, y = y.nextZ, x--), q ? q.nextZ = E : B = E, E.prevZ = q, q = E;
                            y = G
                        }
                        q.nextZ = null;
                        C *= 2
                    } while (1 < m)
                }
                for (B = a; a.prev !== a.next;) {
                    y = a.prev;
                    G = a.next;
                    if (h) a: {
                        q = a;z = e;
                        var F = f,
                            H = h;m = q.prev;x = q;C = q.next;
                        if (0 <= n(m, x, C)) q = !1;
                        else {
                            var Q = m.x > x.x ? m.x > C.x ? m.x : C.x : x.x > C.x ? x.x : C.x,
                                R = m.y > x.y ? m.y > C.y ? m.y : C.y : x.y > C.y ? x.y : C.y;
                            E = d(m.x < x.x ? m.x < C.x ? m.x : C.x : x.x < C.x ? x.x :
                                C.x, m.y < x.y ? m.y < C.y ? m.y : C.y : x.y < C.y ? x.y : C.y, z, F, H);
                            z = d(Q, R, z, F, H);
                            for (F = q.nextZ; F && F.z <= z;) {
                                if (F !== q.prev && F !== q.next && g(m.x, m.y, x.x, x.y, C.x, C.y, F.x, F.y) && 0 <= n(F.prev, F, F.next)) {
                                    q = !1;
                                    break a
                                }
                                F = F.nextZ
                            }
                            for (F = q.prevZ; F && F.z >= E;) {
                                if (F !== q.prev && F !== q.next && g(m.x, m.y, x.x, x.y, C.x, C.y, F.x, F.y) && 0 <= n(F.prev, F, F.next)) {
                                    q = !1;
                                    break a
                                }
                                F = F.prevZ
                            }
                            q = !0
                        }
                    }
                    else a: if (q = a, m = q.prev, x = q, C = q.next, 0 <= n(m, x, C)) q = !1;
                        else {
                            for (E = q.next.next; E !== q.prev;) {
                                if (g(m.x, m.y, x.x, x.y, C.x, C.y, E.x, E.y) && 0 <= n(E.prev, E, E.next)) {
                                    q = !1;
                                    break a
                                }
                                E =
                                    E.next
                            }
                            q = !0
                        } if (q) c.push(y.i / l), c.push(a.i / l), c.push(G.i / l), A(a), B = a = G.next;
                    else if (a = G, a === B) {
                        if (v)
                            if (1 === v) {
                                v = c;
                                B = l;
                                y = a;
                                do G = y.prev, q = y.next.next, !w(G, q) && t(G, y, y.next, q) && p(G, q) && p(q, G) && (v.push(G.i / B), v.push(y.i / B), v.push(q.i / B), A(y), A(y.next), y = a = q), y = y.next; while (y !== a);
                                a = y;
                                k(a, c, l, e, f, h, 2)
                            } else {
                                if (2 === v) a: {
                                    v = a;do {
                                        for (B = v.next.next; B !== v.prev;) {
                                            if (y = v.i !== B.i) {
                                                y = v;
                                                G = B;
                                                if (q = y.next.i !== G.i && y.prev.i !== G.i) {
                                                    b: {
                                                        q = y;do {
                                                            if (q.i !== y.i && q.next.i !== y.i && q.i !== G.i && q.next.i !== G.i && t(q, q.next, y, G)) {
                                                                q = !0;
                                                                break b
                                                            }
                                                            q = q.next
                                                        } while (q !== y);q = !1
                                                    }
                                                    q = !q
                                                }
                                                if (q = q && p(y, G) && p(G, y)) {
                                                    q = y;
                                                    m = !1;
                                                    x = (y.x + G.x) / 2;
                                                    G = (y.y + G.y) / 2;
                                                    do q.y > G !== q.next.y > G && x < (q.next.x - q.x) * (G - q.y) / (q.next.y - q.y) + q.x && (m = !m), q = q.next; while (q !== y);
                                                    q = m
                                                }
                                                y = q
                                            }
                                            if (y) {
                                                a = u(v, B);
                                                v = b(v, v.next);
                                                a = b(a, a.next);
                                                k(v, c, l, e, f, h);
                                                k(a, c, l, e, f, h);
                                                break a
                                            }
                                            B = B.next
                                        }
                                        v = v.next
                                    } while (v !== a)
                                }
                            }
                        else k(b(a), c, l, e, f, h, 1);
                        break
                    }
                }
            }
        }

        function c(a, b) {
            return a.x - b.x
        }

        function a(a, b) {
            var c = b,
                d = a.x,
                l = a.y,
                e = -Infinity;
            do {
                if (l <= c.y && l >= c.next.y) {
                    var k = c.x + (l - c.y) * (c.next.x - c.x) / (c.next.y -
                        c.y);
                    if (k <= d && k > e) {
                        e = k;
                        if (k === d) {
                            if (l === c.y) return c;
                            if (l === c.next.y) return c.next
                        }
                        var n = c.x < c.next.x ? c : c.next
                    }
                }
                c = c.next
            } while (c !== b);
            if (!n) return null;
            if (d === e) return n.prev;
            b = n;
            k = n.x;
            var f = n.y,
                h = Infinity;
            for (c = n.next; c !== b;) {
                if (d >= c.x && c.x >= k && g(l < f ? d : e, l, k, f, l < f ? e : d, l, c.x, c.y)) {
                    var t = Math.abs(l - c.y) / (d - c.x);
                    (t < h || t === h && c.x > n.x) && p(c, a) && (n = c, h = t)
                }
                c = c.next
            }
            return n
        }

        function d(a, b, c, d, g) {
            a = 32767 * (a - c) / g;
            b = 32767 * (b - d) / g;
            a = 16711935 & (a | a << 8);
            a = 252645135 & (a | a << 4);
            a = 858993459 & (a | a << 2);
            b = 16711935 & (b |
                b << 8);
            b = 252645135 & (b | b << 4);
            b = 858993459 & (b | b << 2);
            return 1431655765 & (a | a << 1) | (1431655765 & (b | b << 1)) << 1
        }

        function l(a) {
            var b = a,
                c = a;
            do b.x < c.x && (c = b), b = b.next; while (b !== a);
            return c
        }

        function g(a, b, c, d, g, l, e, k) {
            return 0 <= (g - e) * (b - k) - (a - e) * (l - k) && 0 <= (a - e) * (d - k) - (c - e) * (b - k) && 0 <= (c - e) * (l - k) - (g - e) * (d - k)
        }

        function n(a, b, c) {
            return (b.y - a.y) * (c.x - b.x) - (b.x - a.x) * (c.y - b.y)
        }

        function w(a, b) {
            return a.x === b.x && a.y === b.y
        }

        function t(a, b, c, d) {
            return w(a, b) && w(c, d) || w(a, d) && w(c, b) ? !0 : 0 < n(a, b, c) !== 0 < n(a, b, d) && 0 < n(c, d, a) !== 0 <
                n(c, d, b)
        }

        function p(a, b) {
            return 0 > n(a.prev, a, a.next) ? 0 <= n(a, b, a.next) && 0 <= n(a, a.prev, b) : 0 > n(a, b, a.prev) || 0 > n(a, a.next, b)
        }

        function u(a, b) {
            var c = new B(a.i, a.x, a.y),
                d = new B(b.i, b.x, b.y),
                g = a.next,
                l = b.prev;
            a.next = b;
            b.prev = a;
            c.next = g;
            g.prev = c;
            d.next = c;
            c.prev = d;
            l.next = d;
            d.prev = l;
            return d
        }

        function v(a, b, c, d) {
            a = new B(a, b, c);
            d ? (a.next = d.next, a.prev = d, d.next.prev = a, d.next = a) : (a.prev = a, a.next = a);
            return a
        }

        function A(a) {
            a.next.prev = a.prev;
            a.prev.next = a.next;
            a.prevZ && (a.prevZ.nextZ = a.nextZ);
            a.nextZ && (a.nextZ.prevZ =
                a.prevZ)
        }

        function B(a, b, c) {
            this.i = a;
            this.x = b;
            this.y = c;
            this.nextZ = this.prevZ = this.z = this.next = this.prev = null;
            this.steiner = !1
        }

        function E(a, b, c, d) {
            for (var g = 0, l = c - d; b < c; b += d) g += (a[l] - a[b]) * (a[b + 1] + a[l + 1]), l = b;
            return g
        }
        cc.Graphics.earcut = q.exports = f;
        f.deviation = function(a, b, c, d) {
            var g = b && b.length,
                l = Math.abs(E(a, 0, g ? b[0] * c : a.length, c));
            if (g) {
                g = 0;
                for (var e = b.length; g < e; g++) l -= Math.abs(E(a, b[g] * c, g < e - 1 ? b[g + 1] * c : a.length, c))
            }
            for (g = b = 0; g < d.length; g += 3) {
                e = d[g] * c;
                var k = d[g + 1] * c,
                    n = d[g + 2] * c;
                b += Math.abs((a[e] -
                    a[n]) * (a[k + 1] - a[e + 1]) - (a[e] - a[k]) * (a[n + 1] - a[e + 1]))
            }
            return 0 === l && 0 === b ? 0 : Math.abs((b - l) / l)
        };
        f.flatten = function(a) {
            for (var b = a[0][0].length, c = {
                    vertices: [],
                    holes: [],
                    dimensions: b
                }, d = 0, g = 0; g < a.length; g++) {
                for (var l = 0; l < a[g].length; l++)
                    for (var e = 0; e < b; e++) c.vertices.push(a[g][l][e]);
                0 < g && (d += a[g - 1].length, c.holes.push(d))
            }
            return c
        }
    }, {}],
    244: [function(h, q, m) {
        function f() {
            this.reset()
        }

        function e(a) {
            this._tessTol = .25;
            this._distTol = .01;
            this._updatePathOffset = !1;
            this._paths = null;
            this._pathOffset = this._pathLength =
                0;
            this._points = null;
            this._commandy = this._commandx = this._pointsOffset = 0;
            this._paths = [];
            this._points = []
        }
        var b = h("../../../../graphics/helper"),
            k = h("../../../../graphics/types").PointFlags,
            c = cc.Graphics.Point = cc.Class({
                name: "cc.GraphicsPoint",
                extends: cc.Vec2,
                ctor: function(a, b) {
                    this.reset()
                },
                reset: function() {
                    this.len = this.flags = this.dmy = this.dmx = this.dy = this.dx = 0
                }
            });
        cc.js.mixin(f.prototype, {
            reset: function() {
                this.closed = !1;
                this.nbevel = 0;
                this.complex = !0;
                this.points ? this.points.length = 0 : this.points = []
            }
        });
        cc.js.mixin(e.prototype, {
            moveTo: function(a, b) {
                this._updatePathOffset && (this._pathOffset = this._pathLength, this._updatePathOffset = !1);
                this._addPath();
                this._addPoint(a, b, k.PT_CORNER);
                this._commandx = a;
                this._commandy = b
            },
            lineTo: function(a, b) {
                this._addPoint(a, b, k.PT_CORNER);
                this._commandx = a;
                this._commandy = b
            },
            bezierCurveTo: function(a, c, l, g, e, f) {
                var d = this._curPath;
                d = d.points[d.points.length - 1];
                d.x === a && d.y === c && l === e && g === f ? this.lineTo(e, f) : (b.tesselateBezier(this, d.x, d.y, a, c, l, g, e, f, 0, k.PT_CORNER), this._commandx =
                    e, this._commandy = f)
            },
            quadraticCurveTo: function(a, b, c, g) {
                var d = this._commandx,
                    l = this._commandy;
                this.bezierCurveTo(d + 2 / 3 * (a - d), l + 2 / 3 * (b - l), c + 2 / 3 * (a - c), g + 2 / 3 * (b - g), c, g)
            },
            arc: function(a, c, l, g, e, k) {
                b.arc(this, a, c, l, g, e, k)
            },
            ellipse: function(a, c, l, g) {
                b.ellipse(this, a, c, l, g);
                this._curPath.complex = !1
            },
            circle: function(a, c, l) {
                b.ellipse(this, a, c, l, l);
                this._curPath.complex = !1
            },
            rect: function(a, b, c, g) {
                this.moveTo(a, b);
                this.lineTo(a, b + g);
                this.lineTo(a + c, b + g);
                this.lineTo(a + c, b);
                this.close();
                this._curPath.complex = !1
            },
            roundRect: function(a, c, l, g, e) {
                b.roundRect(this, a, c, l, g, e);
                this._curPath.complex = !1
            },
            clear: function(a) {
                this._pointsOffset = this._pathOffset = this._pathLength = 0;
                this._curPath = null;
                a && (this._paths.length = 0, this._points.length = 0)
            },
            close: function() {
                this._curPath.closed = !0
            },
            _addPath: function() {
                var a = this._paths[this._pathLength];
                a ? a.reset() : (a = new f, this._paths.push(a));
                this._pathLength++;
                return this._curPath = a
            },
            _addPoint: function(a, b, l) {
                var d = this._curPath;
                if (d) {
                    var e = this._points;
                    d = d.points;
                    var k = this._pointsOffset++;
                    (k = e[k]) ? (k.x = a, k.y = b) : (k = new c(a, b), e.push(k));
                    k.flags = l;
                    d.push(k)
                }
            }
        });
        cc.Graphics._Impl = e;
        q.exports = e
    }, {
        "../../../../graphics/helper": 168,
        "../../../../graphics/types": 170
    }],
    245: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var b = f(h("../../../assembler")),
            k = f(h("../../../../../renderer/core/input-assembler")),
            c = h("../../mesh-buffer"),
            a = h("../../../index"),
            d = h("../../../../graphics/graphics"),
            l = h("../../../../graphics/types").PointFlags,
            g = d.LineJoin,
            n = d.LineCap,
            w = h("./earcut");
        h("./impl");
        var t = Math.PI,
            p = Math.min,
            u = Math.max,
            v = Math.ceil,
            A = Math.acos,
            B = Math.cos,
            E = Math.sin,
            y = Math.atan2;
        h = cc.gfx;
        var z = new h.VertexFormat([{
            name: h.ATTR_POSITION,
            type: h.ATTR_TYPE_FLOAT32,
            num: 2
        }, {
            name: h.ATTR_COLOR,
            type: h.ATTR_TYPE_UINT8,
            num: 4,
            normalize: !0
        }, {
            name: "a_dist",
            type: h.ATTR_TYPE_FLOAT32,
            num: 1
        }]);
        z.name = "vfmtPosColorSdf";
        h = function(b) {
            function d(a) {
                a = b.call(this, a) ||
                    this;
                a._buffer = null;
                a._buffers = [];
                a._bufferOffset = 0;
                return a
            }
            e(d, b);
            var f = d.prototype;
            f.getVfmt = function() {
                return z
            };
            f.getVfmtFloatCount = function() {
                return 4
            };
            f.requestBuffer = function() {
                var b = {
                        indiceStart: 0,
                        vertexStart: 0
                    },
                    d = new c(a._handle, this.getVfmt());
                b.meshbuffer = d;
                d = new k["default"](d._vb, d._ib);
                b.ia = d;
                this._buffers.push(b);
                return b
            };
            f.getBuffers = function() {
                0 === this._buffers.length && this.requestBuffer();
                return this._buffers
            };
            f.clear = function(a) {
                this._bufferOffset = 0;
                var b = this._buffers;
                if (a) {
                    a =
                        0;
                    for (var c = b.length; a < c; a++) {
                        var d = b[a];
                        d.meshbuffer.destroy();
                        d.meshbuffer = null
                    }
                    b.length = 0
                } else
                    for (a = 0, c = b.length; a < c; a++) d = b[a], d.indiceStart = 0, d.vertexStart = 0, d.meshbuffer.reset()
            };
            f.fillBuffers = function(a, b) {
                b._flush();
                b.node = a.node;
                b.material = a._materials[0];
                a = this.getBuffers();
                for (var c = 0, d = a.length; c < d; c++) {
                    var g = a[c],
                        l = g.meshbuffer;
                    g.ia._count = g.indiceStart;
                    b._flushIA(g.ia);
                    l.uploadData()
                }
            };
            f.genBuffer = function(a, b) {
                var c = this.getBuffers(),
                    d = c[this._bufferOffset],
                    g = d.meshbuffer,
                    l = d.vertexStart +
                    b;
                if (65535 < l || 131070 < 3 * l) ++this._bufferOffset, l = b, this._bufferOffset < c.length ? d = c[this._bufferOffset] : (d = this.requestBuffer(a), c[this._bufferOffset] = d), g = d.meshbuffer;
                l > g.vertexOffset && g.requestStatic(b, 3 * b);
                return this._buffer = d
            };
            f.stroke = function(a) {
                this._curColor = a._strokeColor._val;
                this._flattenPaths(a._impl);
                this._expandStroke(a);
                a._impl._updatePathOffset = !0
            };
            f.fill = function(a) {
                this._curColor = a._fillColor._val;
                this._expandFill(a);
                a._impl._updatePathOffset = !0
            };
            f._expandStroke = function(a) {
                var b =
                    .5 * a.lineWidth,
                    c = a.lineCap,
                    d = a.lineJoin,
                    e = a.miterLimit,
                    k = a._impl;
                var f = 2 * A(b / (b + k._tessTol));
                f = u(2, v(t / f));
                this._calculateJoins(k, b, d, e);
                e = k._paths;
                for (var h = 0, p = k._pathOffset, w = k._pathLength; p < w; p++) {
                    var B = e[p],
                        y = B.points.length;
                    d === g.ROUND ? h += 2 * (y + B.nbevel * (f + 2) + 1) : h += 2 * (y + 5 * B.nbevel + 1);
                    B.closed || (c === n.ROUND ? h += 2 * (2 * f + 2) : h += 12)
                }
                a = this.genBuffer(a, h);
                p = a.meshbuffer;
                h = p._vData;
                p = p._iData;
                w = k._pathOffset;
                for (k = k._pathLength; w < k; w++) {
                    y = e[w];
                    var E = y.points,
                        m = E.length;
                    B = a.vertexStart;
                    var x;
                    if (x = y.closed) {
                        var z =
                            E[m - 1];
                        y = E[0];
                        var q = 0
                    } else z = E[0], y = E[1], q = 1, --m;
                    y = y || z;
                    if (!x) {
                        var C = y.sub(z);
                        C.normalizeSelf();
                        var G = C.x;
                        C = C.y;
                        c === n.BUTT ? this._buttCapStart(z, G, C, b, 0) : c === n.SQUARE ? this._buttCapStart(z, G, C, b, b) : c === n.ROUND && this._roundCapStart(z, G, C, b, f)
                    }
                    for (; q < m; ++q) d === g.ROUND ? this._roundJoin(z, y, b, b, f) : 0 !== (y.flags & (l.PT_BEVEL | l.PT_INNERBEVEL)) ? this._bevelJoin(z, y, b, b) : (this._vset(y.x + y.dmx * b, y.y + y.dmy * b, 1), this._vset(y.x - y.dmx * b, y.y - y.dmy * b, -1)), z = y, y = E[q + 1];
                    x ? (y = this.getVfmtFloatCount(), E = B * y, this._vset(h[E],
                        h[E + 1], 1), this._vset(h[E + y], h[E + y + 1], -1)) : (z = y.sub(z), z.normalizeSelf(), E = z.x, z = z.y, c === n.BUTT ? this._buttCapEnd(y, E, z, b, 0) : c === n.SQUARE ? this._buttCapEnd(y, E, z, b, b) : c === n.ROUND && this._roundCapEnd(y, E, z, b, f));
                    y = a.indiceStart;
                    B += 2;
                    for (E = a.vertexStart; B < E; B++) p[y++] = B - 2, p[y++] = B - 1, p[y++] = B;
                    a.indiceStart = y
                }
            };
            f._expandFill = function(a) {
                for (var b = a._impl, c = b._paths, d = 0, g = b._pathOffset, l = b._pathLength; g < l; g++) d += c[g].points.length;
                a = this.genBuffer(a, d);
                g = a.meshbuffer;
                d = g._vData;
                g = g._iData;
                l = b._pathOffset;
                for (b = b._pathLength; l < b; l++) {
                    var e = c[l],
                        k = e.points,
                        n = k.length;
                    if (0 !== n) {
                        for (var f = a.vertexStart, h = 0; h < n; ++h) this._vset(k[h].x, k[h].y);
                        k = a.indiceStart;
                        if (e.complex) {
                            e = [];
                            n = this.getVfmtFloatCount();
                            h = f;
                            for (var p = a.vertexStart; h < p; h++) {
                                var t = h * n;
                                e.push(d[t]);
                                e.push(d[t + 1])
                            }
                            e = w(e, null, 2);
                            if (!e || 0 === e.length) continue;
                            n = 0;
                            for (h = e.length; n < h; n++) g[k++] = e[n] + f
                        } else
                            for (e = f, f += 2, n = a.vertexStart; f < n; f++) g[k++] = e, g[k++] = f - 1, g[k++] = f;
                        a.indiceStart = k
                    }
                }
            };
            f._calculateJoins = function(a, b, c, d) {
                var e = 0;
                0 < b && (e = 1 / b);
                b = a._paths;
                var k = a._pathOffset;
                for (a = a._pathLength; k < a; k++)
                    for (var n = b[k], f = n.points, h = f.length, t = f[h - 1], v = f[0], w = 0, A = n.nbevel = 0; A < h; A++) {
                        var B = -t.dx;
                        var y = -v.dx;
                        v.dmx = .5 * (t.dy + v.dy);
                        v.dmy = .5 * (B + y);
                        B = v.dmx * v.dmx + v.dmy * v.dmy;
                        1E-6 < B && (y = 1 / B, 600 < y && (y = 600), v.dmx *= y, v.dmy *= y);
                        0 < v.dx * t.dy - t.dx * v.dy && (w++, v.flags |= l.PT_LEFT);
                        t = u(11, p(t.len, v.len) * e);
                        1 > B * t * t && (v.flags |= l.PT_INNERBEVEL);
                        v.flags & l.PT_CORNER && (1 > B * d * d || c === g.BEVEL || c === g.ROUND) && (v.flags |= l.PT_BEVEL);
                        0 !== (v.flags & (l.PT_BEVEL | l.PT_INNERBEVEL)) &&
                            n.nbevel++;
                        t = v;
                        v = f[A + 1]
                    }
            };
            f._flattenPaths = function(a) {
                var b = a._paths,
                    c = a._pathOffset;
                for (a = a._pathLength; c < a; c++) {
                    var d = b[c],
                        g = d.points,
                        l = g[g.length - 1],
                        e = g[0];
                    2 < g.length && l.equals(e) && (d.closed = !0, g.pop(), l = g[g.length - 1]);
                    d = 0;
                    for (var k = g.length; d < k; d++) {
                        var n = e.sub(l);
                        l.len = n.mag();
                        (n.x || n.y) && n.normalizeSelf();
                        l.dx = n.x;
                        l.dy = n.y;
                        l = e;
                        e = g[d + 1]
                    }
                }
            };
            f._chooseBevel = function(a, b, c, d) {
                var g = c.x,
                    l = c.y;
                0 !== a ? (a = g + b.dy * d, b = l - b.dx * d, g += c.dy * d, c = l - c.dx * d) : (a = g += c.dmx * d, b = c = l + c.dmy * d);
                return [a, b, g, c]
            };
            f._buttCapStart =
                function(a, b, c, d, g) {
                    var l = a.x - b * g;
                    a = a.y - c * g;
                    b = -b;
                    this._vset(l + c * d, a + b * d, 1);
                    this._vset(l - c * d, a - b * d, -1)
                };
            f._buttCapEnd = function(a, b, c, d, g) {
                var l = a.x + b * g;
                a = a.y + c * g;
                b = -b;
                this._vset(l + c * d, a + b * d, 1);
                this._vset(l - c * d, a - b * d, -1)
            };
            f._roundCapStart = function(a, b, c, d, g) {
                var l = a.x;
                a = a.y;
                for (var e = -b, k = 0; k < g; k++) {
                    var n = k / (g - 1) * t,
                        f = B(n) * d;
                    n = E(n) * d;
                    this._vset(l - c * f - b * n, a - e * f - c * n, 1);
                    this._vset(l, a, 0)
                }
                this._vset(l + c * d, a + e * d, 1);
                this._vset(l - c * d, a - e * d, -1)
            };
            f._roundCapEnd = function(a, b, c, d, g) {
                var l = a.x;
                a = a.y;
                var e = -b;
                this._vset(l +
                    c * d, a + e * d, 1);
                this._vset(l - c * d, a - e * d, -1);
                for (var k = 0; k < g; k++) {
                    var n = k / (g - 1) * t,
                        f = B(n) * d;
                    n = E(n) * d;
                    this._vset(l, a, 0);
                    this._vset(l - c * f + b * n, a - e * f + c * n, 1)
                }
            };
            f._roundJoin = function(a, b, c, d, g) {
                var e = a.dy,
                    k = -a.dx,
                    n = b.dy,
                    f = -b.dx,
                    h = b.x,
                    p = b.y;
                if (0 !== (b.flags & l.PT_LEFT)) {
                    a = this._chooseBevel(b.flags & l.PT_INNERBEVEL, a, b, c);
                    var u = a[0],
                        w = a[1];
                    c = a[2];
                    a = a[3];
                    var A = y(-k, -e),
                        m = y(-f, -n);
                    m > A && (m -= 2 * t);
                    this._vset(u, w, 1);
                    this._vset(h - e * d, b.y - k * d, -1);
                    e = v((A - m) / t) * g;
                    g = 2 > e ? 2 : e > g ? g : e;
                    for (e = 0; e < g; e++) b = A + e / (g - 1) * (m - A), k = h + B(b) * d,
                        b = p + E(b) * d, this._vset(h, p, 0), this._vset(k, b, -1);
                    this._vset(c, a, 1);
                    this._vset(h - n * d, p - f * d, -1)
                } else {
                    A = this._chooseBevel(b.flags & l.PT_INNERBEVEL, a, b, -d);
                    u = A[0];
                    w = A[1];
                    a = A[2];
                    A = A[3];
                    m = y(k, e);
                    b = y(f, n);
                    b < m && (b += 2 * t);
                    this._vset(h + e * d, p + k * d, 1);
                    this._vset(u, w, -1);
                    e = v((b - m) / t) * g;
                    g = 2 > e ? 2 : e > g ? g : e;
                    for (e = 0; e < g; e++) u = m + e / (g - 1) * (b - m), k = h + B(u) * c, u = p + E(u) * c, this._vset(k, u, 1), this._vset(h, p, 0);
                    this._vset(h + n * d, p + f * d, 1);
                    this._vset(a, A, -1)
                }
            };
            f._bevelJoin = function(a, b, c, d) {
                var g = a.dy,
                    e = -a.dx,
                    k = b.dy,
                    n = -b.dx;
                if (b.flags &
                    l.PT_LEFT) {
                    var f = this._chooseBevel(b.flags & l.PT_INNERBEVEL, a, b, c);
                    c = f[0];
                    a = f[1];
                    var h = f[2];
                    f = f[3];
                    this._vset(c, a, 1);
                    this._vset(b.x - g * d, b.y - e * d, -1);
                    this._vset(h, f, 1);
                    this._vset(b.x - k * d, b.y - n * d, -1)
                } else f = this._chooseBevel(b.flags & l.PT_INNERBEVEL, a, b, -d), d = f[0], a = f[1], h = f[2], f = f[3], this._vset(b.x + g * c, b.y + e * c, 1), this._vset(d, a, -1), this._vset(b.x + k * c, b.y + n * c, 1), this._vset(h, f, -1)
            };
            f._vset = function(a, b, c) {
                void 0 === c && (c = 0);
                var d = this._buffer,
                    g = d.meshbuffer,
                    l = d.vertexStart * this.getVfmtFloatCount(),
                    e = g._vData,
                    k = g._uintVData;
                e[l] = a;
                e[l + 1] = b;
                k[l + 2] = this._curColor;
                e[l + 3] = c;
                d.vertexStart++;
                g._dirty = !0
            };
            return d
        }(b["default"]);
        m["default"] = h;
        b["default"].register(cc.Graphics, h);
        q.exports = m["default"]
    }, {
        "../../../../../renderer/core/input-assembler": 324,
        "../../../../graphics/graphics": 167,
        "../../../../graphics/types": 170,
        "../../../assembler": 233,
        "../../../index": 236,
        "../../mesh-buffer": 270,
        "./earcut": 243,
        "./impl": 244
    }],
    246: [function(h, q, m) {
        cc.assemblers = {};
        h("./sprite");
        h("./mask-assembler");
        h("./graphics");
        h("./label");
        h("./motion-streak")
    }, {
        "./graphics": 245,
        "./label": 254,
        "./mask-assembler": 255,
        "./motion-streak": void 0,
        "./sprite": 268
    }],
    247: [function(h, q, m) {
            function f(b, e) {
                b.prototype = Object.create(e.prototype);
                b.prototype.constructor = b;
                b.__proto__ = e
            }
            m.__esModule = !0;
            m["default"] = void 0;
            var e = 0;
            h = function(b) {
                function k() {
                    return b.apply(this, arguments) || this
                }
                f(k, b);
                var c = k.prototype;
                c.initData = function() {
                    this._renderData.createFlexData(0, 4, 6, this.getVfmt())
                };
                c._reserveQuads = function(a, b) {
                    a = 4 * b;
                    b *= 6;
                    var c =
                        this._renderData._flexBuffer;
                    c.reserve(a, b);
                    c.used(a, b);
                    a = this._renderData.iDatas[0];
                    for (var d = c = 0; c < b; c += 6, d += 4) a[c] = d, a[c + 1] = d + 1, a[c + 2] = d + 2, a[c + 3] = d + 1, a[c + 4] = d + 3, a[c + 5] = d + 2;
                    e = 0
                };
                c._quadsUpdated = function(a) {
                    e = 0;
                    this._renderData._flexBuffer.used(this.verticesCount, this.indicesCount)
                };
                c._getColor = function(a) {
                    return a.node._color._val
                };
                c.appendQuad = function(a, b, c, g, k, f, h) {
                    var d = this._renderData,
                        l = d.vDatas[0];
                    d = d.uintVDatas[0];
                    this.verticesCount += 4;
                    this.indicesCount = this.verticesCount / 2 * 3;
                    var n = b.width,
                        t = b.height,
                        w = c.width,
                        E = c.height;
                    b = this._getColor(a);
                    var y = this.floatsPerVert,
                        m = e + this.uvOffset;
                    if (g) {
                        g = c.x / n;
                        var x = (c.x + E) / n;
                        n = (c.y + w) / t;
                        c = c.y / t;
                        l[m] = g;
                        l[m + 1] = c;
                        m += y;
                        l[m] = g;
                        l[m + 1] = n;
                        m += y;
                        l[m] = x;
                        l[m + 1] = c;
                        m += y;
                        l[m] = x;
                        l[m + 1] = n
                    } else g = c.x / n, x = (c.x + w) / n, n = (c.y + E) / t, c = c.y / t, l[m] = g, l[m + 1] = n, m += y, l[m] = x, l[m + 1] = n, m += y, l[m] = g, l[m + 1] = c, m += y, l[m] = x, l[m + 1] = c;
                    this.appendVerts(a, e, k, k + w * h, f - E * h, f);
                    a = e + this.colorOffset;
                    for (k = 0; 4 > k; k++) d[a] = b, a += y;
                    e += 4 * this.floatsPerVert
                };
                c.appendVerts = function(a, b, c, g, e, k) {
                    a = this._local;
                    var d = this.floatsPerVert;
                    a[b] = c;
                    a[b + 1] = e;
                    b += d;
                    a[b] = g;
                    a[b + 1] = e;
                    b += d;
                    a[b] = c;
                    a[b + 1] = k;
                    b += d;
                    a[b] = g;
                    a[b + 1] = k
                };
                c.updateWorldVerts = function(a) {
                    var b = a.node._worldMatrix.m;
                    a = b[0];
                    var c = b[1],
                        g = b[4],
                        e = b[5],
                        k = b[12];
                    b = b[13];
                    for (var f = this._local, h = this._renderData.vDatas[0], u = this.floatsPerVert, v = 0; v < f.length; v += u) {
                        var A = f[v],
                            B = f[v + 1];
                        h[v] = A * a + B * g + k;
                        h[v + 1] = A * c + B * e + b
                    }
                };
                return k
            }(function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("../../../../utils/label/bmfont"))["default"]);
            m["default"] = h;
            q.exports = m["default"]
        },
        {
            "../../../../utils/label/bmfont": 238
        }
    ],
    248: [function(h, q, m) {
        function f(b, e) {
            b.prototype = Object.create(e.prototype);
            b.prototype.constructor = b;
            b.__proto__ = e
        }
        m.__esModule = !0;
        m["default"] = void 0;
        h("../../../../../platform/js");
        h("./bmfont");
        h = h("../../../../utils/label/letter-font");
        var e = cc.color(255, 255, 255, 255);
        h = function(b) {
            function k() {
                return b.apply(this, arguments) || this
            }
            f(k, b);
            var c = k.prototype;
            c.createData = function(a) {
                return a.requestRenderData()
            };
            c._getColor = function(a) {
                e._fastSetA(a.node._color.a);
                return e._val
            };
            c.updateColor = function(a) {
                var c = this._getColor(a);
                b.prototype.updateColor.call(this, a, c)
            };
            return k
        }(h);
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../../../../../platform/js": 225,
        "../../../../utils/label/letter-font": 240,
        "./bmfont": 247
    }],
    249: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        var f = function(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }(h("../../../../../assets/material/material-variant"));
        h("../../../../../components/CCLabel");
        h("../../../../../components/CCLabelShadow");
        h("../../../../../components/CCLabelOutline");
        h("../../../../../assets/material/CCMaterial");
        h = function() {
            function e() {}
            var b = e.prototype;
            b.init = function(b) {
                this.labelMaterial = null;
                this._label = this._renderComp = b;
                renderer.CustomAssembler.prototype.ctor.call(this);
                b.node._proxy.setAssembler(this);
                this._layout = new jsb.LabelRenderer;
                this._layout.init();
                this._cfg = new DataView(this._layout._cfg);
                this._layoutInfo = new DataView(this._layout._layout);
                this._cfgFields = jsb.LabelRenderer._cfgFields;
                this._layoutFields =
                    jsb.LabelRenderer._layoutFields;
                this._layout.bindNodeProxy(b.node._proxy);
                this._bindMaterial(b)
            };
            b._setBufferFlag = function(b, c, a, d, l) {
                "int8" == d && 1 == a ? (a = b.getInt8(c), b.setInt8(c, l | a)) : "int32" == d && 4 == a ? (a = b.getInt32(c, jsb.__isLittleEndian__), b.setInt32(c, l | a, jsb.__isLittleEndian__)) : cc.warn("flag storage type should be int8/int32 only, type/size -> " + d + "/" + a + ".")
            };
            b._updateCfgFlag = function(b) {
                var c = this._cfgFields.updateFlags;
                this._setBufferFlag(this._cfg, c.offset, c.size, c.type, b)
            };
            b._setBufferValue =
                function(b, c, a, d, l) {
                    "float" == d && 4 == a ? b.setFloat32(c, l, jsb.__isLittleEndian__) : "int32" == d && 4 == a ? b.setInt32(c, l, jsb.__isLittleEndian__) : "bool" == d && 1 == a ? b.setInt8(c, l ? 1 : 0, jsb.__isLittleEndian__) : "Color4B" == d && 4 == a ? (b.setUint8(c, l.r), b.setUint8(c + 1, l.g), b.setUint8(c + 2, l.b), b.setUint8(c + 3, l.a)) : "int8" == d && 1 == a ? b.setUint8(c, l) : cc.warn("dont know how to set value to buffer, type/size -> " + d + "/" + a + ".")
                };
            b._setFieldValue = function(b, c, a, d) {
                c = c[a];
                this._setBufferValue(b, c.offset, c.size, c.type, d)
            };
            b._getBufferValue =
                function(b, c, a, d) {
                    if ("float" == d && 4 == a) return b.getFloat32(c, jsb.__isLittleEndian__);
                    if ("int32" == d && 4 == a) return b.getInt32(c, jsb.__isLittleEndian__);
                    if ("bool" == d && 1 == a) return 0 != b.getInt8(c, jsb.__isLittleEndian__);
                    if ("Color4B" == d && 4 == a) {
                        a = b.getUint8(c);
                        d = b.getUint8(c + 1);
                        var l = b.getUint8(c + 2);
                        b = b.getUint8(c + 3);
                        return {
                            r: a,
                            g: d,
                            b: l,
                            a: b
                        }
                    }
                    if ("int8" == d && 1 == a) return b.getUint8(c);
                    cc.warn("dont know how to get value from buffer, type/size -> " + d + "/" + a + ".")
                };
            b._getFieldValue = function(b, c, a) {
                c = c[a];
                return this._getBufferValue(b,
                    c.offset, c.size, c.type)
            };
            b._getLayoutValue = function(b) {
                return this._getFieldValue(this._layoutInfo, this._layoutFields, b)
            };
            b._setLayoutValue = function(b, c) {
                return this._setFieldValue(this._layoutInfo, this._layoutFields, b, c)
            };
            b._updateCfgFlag_Content = function() {
                this._updateCfgFlag(1)
            };
            b._updateCfgFlag_Font = function() {
                this._updateCfgFlag(2)
            };
            b._colorEqual = function(b, c) {
                return b.r == c.r && b.g == c.g && b.b == c.b && b.a == c.a
            };
            b._colorToObj = function(b, c, a, d) {
                return {
                    r: b,
                    g: c,
                    b: a,
                    a: d
                }
            };
            b.setString = function(b) {
                b != this._layout.string &&
                    (this._layout.string = b, this._updateCfgFlag_Content())
            };
            b.setFontPath = function(b) {
                b != this._layout.fontPath && (this._layout.fontPath = b, this._updateCfgFlag_Font())
            };
            b.setFontSize = function(b, c) {
                this._getFieldValue(this._cfg, this._cfgFields, "fontSize") != b && (this._setFieldValue(this._cfg, this._cfgFields, "fontSize", b), this._setFieldValue(this._cfg, this._cfgFields, "fontSizeRetina", c), this._updateCfgFlag_Font())
            };
            b.setOutline = function(b) {
                var c = this._getLayoutValue("outlineSize");
                0 < c != 0 < b && this._updateCfgFlag_Font();
                c != b && (this._updateCfgFlag_Content(), this._setLayoutValue("outlineSize", b))
            };
            b.setOutlineColor = function(b) {
                var c = this._getLayoutValue("outlineColor");
                this._colorEqual(c, b) || (this._setLayoutValue("outlineColor", b), this._updateCfgFlag_Content())
            };
            b.setLineHeight = function(b) {
                this._getLayoutValue("lineHeight") != b && (this._setLayoutValue("lineHeight", b), this._updateCfgFlag_Content())
            };
            b.setOverFlow = function(b) {
                this._getLayoutValue("overflow") != b && (this._setLayoutValue("overflow", b), this._updateCfgFlag_Content())
            };
            b.setEnableWrap = function(b) {
                this._getLayoutValue("wrap") != b && (this._setLayoutValue("wrap", b), this._updateCfgFlag_Content())
            };
            b.setVerticalAlign = function(b) {
                this._getLayoutValue("valign") != b && (this._setLayoutValue("valign", b), this._updateCfgFlag_Content())
            };
            b.setHorizontalAlign = function(b) {
                this._getLayoutValue("halign") != b && (this._setLayoutValue("halign", b), this._updateCfgFlag_Content())
            };
            b.setContentSize = function(b, c) {
                var a = this._getLayoutValue("width"),
                    d = this._getLayoutValue("height");
                if (a != b || d !=
                    c) this._setLayoutValue("height", c), this._setLayoutValue("width", b), this._updateCfgFlag_Content()
            };
            b.setAnchorPoint = function(b, c) {
                var a = this._getLayoutValue("anchorX"),
                    d = this._getLayoutValue("anchorY");
                if (a != b || d != c) this._setLayoutValue("anchorX", b), this._setLayoutValue("anchorY", c), this._updateCfgFlag_Content()
            };
            b.setColor = function(b) {
                var c = this._getLayoutValue("color");
                this._colorEqual(c, b) || (this._setLayoutValue("color", b), this._updateCfgFlag_Content())
            };
            b.setShadow = function(b, c, a) {
                var d = this._getLayoutValue("shadowBlur"),
                    l = this._getLayoutValue("shadowX"),
                    g = this._getLayoutValue("shadowY");
                0 < d != 0 < a && this._updateCfgFlag_Font();
                var e = !1;
                d != a && (this._setLayoutValue("shadowBlur", a), e = !0);
                l != b && (this._setLayoutValue("shadowX", b), e = !0);
                g != c && (this._setLayoutValue("shadowY", c), e = !0);
                e && this._updateCfgFlag_Content()
            };
            b.setShadowColor = function(b) {
                var c = this._getLayoutValue("shadowColor");
                this._colorEqual(c, b) || (this._setLayoutValue("shadowColor", b), this._updateCfgFlag_Content())
            };
            b.setItalic = function(b) {
                this._getLayoutValue("italic") !=
                    b && (this._setLayoutValue("italic", b), this._updateCfgFlag_Content())
            };
            b.setBold = function(b) {
                this._getLayoutValue("bold") != b && (this._setLayoutValue("bold", b), this._updateCfgFlag_Content(), this._updateCfgFlag_Font())
            };
            b.setUnderline = function(b) {
                this._getLayoutValue("underline") != b && (this._setLayoutValue("underline", b), this._updateCfgFlag_Content())
            };
            b.setSpacingX = function(b) {
                this._getLayoutValue("spaceX") == b || "number" != typeof b || isNaN(b) || (this._setLayoutValue("spaceX", b), this._updateCfgFlag_Content())
            };
            b.updateRenderData = function(b) {
                if (b._vertsDirty) {
                    b.font && b.font.nativeUrl && this.setFontPath(cc.assetManager.cacheManager.getCache(b.font.nativeUrl) || b.font.nativeUrl);
                    var c = this._layout,
                        a = b.node.color,
                        d = b.node,
                        l = b.fontSize;
                    this.setString(b.string);
                    this.setFontSize(b.fontSize, l / 72 * b.fontSize);
                    this.setLineHeight(b.lineHeight);
                    this.setEnableWrap(b.enableWrapText);
                    this.setItalic(b.enableItalic);
                    this.setUnderline(b.enableUnderline);
                    this.setBold(b.enableBold);
                    this.setOverFlow(b.overflow);
                    this.setVerticalAlign(b.verticalAlign);
                    this.setHorizontalAlign(b.horizontalAlign);
                    this.setSpacingX(b.spacingX);
                    this.setContentSize(d.getContentSize().width, d.getContentSize().height);
                    this.setAnchorPoint(d.anchorX, d.anchorY);
                    this.setColor(this._colorToObj(a.getR(), a.getG(), a.getB(), Math.ceil(a.getA() * d.opacity / 255)));
                    (a = d.getComponent(cc.LabelShadow)) && a.enabled ? (l = a.color, this.setShadow(a.offset.x, a.offset.y, a.blur), this.setShadowColor(this._colorToObj(l.getR(), l.getG(), l.getB(), Math.ceil(l.getA() * d.opacity / 255)))) : this.setShadow(0, 0, -1);
                    this._updateTTFMaterial(b);
                    c.render()
                }
            };
            b._bindMaterial = function(b) {
                var c = this.labelMaterial;
                c || (this.labelMaterial = c = f["default"].createWithBuiltin("2d-label", b));
                return c
            };
            b._updateTTFMaterial = function(b) {
                var c = this._bindMaterial(b),
                    a = this._label.node,
                    d = this._layout,
                    l = a.getComponent(cc.LabelOutline),
                    g = 0;
                l && l.enabled && 0 < l.width && (g = Math.max(Math.min(l.width / 10, .4), .1), l = l.color, this.setOutlineColor(this._colorToObj(l.getR(), l.getG(), l.getB(), Math.ceil(l.getA() * a.opacity / 255))));
                this.setOutline(g);
                c.define("CC_USE_MODEL", !0);
                c.define("USE_TEXTURE_ALPHAONLY", !0);
                c.define("USE_SDF", 0 < g || b.enableBold);
                c.define("USE_SDF_EXTEND", b.enableBold ? 1 : 0);
                void 0 !== c.getDefine("CC_SUPPORT_standard_derivatives") && cc.sys.glExtension("OES_standard_derivatives") && c.define("CC_SUPPORT_standard_derivatives", !0);
                d.setEffect(c.effect._nativeObj)
            };
            b.fillBuffers = function(b, c) {
                this._layout.render()
            };
            b.getVfmt = function() {};
            return e
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../../../../../assets/material/CCMaterial": 91,
        "../../../../../assets/material/material-variant": 98,
        "../../../../../components/CCLabel": 118,
        "../../../../../components/CCLabelOutline": 119,
        "../../../../../components/CCLabelShadow": 120
    }],
    250: [function(h, q, m) {
        function f(b, a) {
            b.prototype = Object.create(a.prototype);
            b.prototype.constructor = b;
            b.__proto__ = a
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("../../../../utils/label/ttf")),
            b = h("../../../../../components/CCLabelShadow"),
            k = cc.color(255, 255, 255, 255);
        h = function(c) {
            function a() {
                return c.apply(this, arguments) || this
            }
            f(a, c);
            var d = a.prototype;
            d.updateUVs = function(a) {
                var b = this._renderData.vDatas[0];
                a = a._frame.uv;
                for (var c = this.uvOffset, d = this.floatsPerVert, l = 0; 4 > l; l++) {
                    var e = 2 * l,
                        k = d * l + c;
                    b[k] = a[e];
                    b[k + 1] = a[e + 1]
                }
            };
            d.updateColor = function(a) {
                k._fastSetA(a.node._color.a);
                c.prototype.updateColor.call(this, a, k._val)
            };
            d.updateVerts = function(a) {
                var c = a.node,
                    d = a._ttfTexture.width,
                    l = a._ttfTexture.height,
                    e = c.anchorX * c.width,
                    k = c.anchorY * c.height,
                    f = b && a.getComponent(b);
                if (f && f._enabled) {
                    var h = (d - c.width) / 2,
                        A = (l - c.height) / 2;
                    f = f.offset; - f.x > h ? e += d - c.width : h > f.x && (e += h - f.x); - f.y > A ? k += l - c.height : A > f.y && (k += A - f.y)
                }
                c = this._local;
                c[0] = -e;
                c[1] = -k;
                c[2] = d - e;
                c[3] = l - k;
                this.updateUVs(a);
                this.updateWorldVerts(a)
            };
            return a
        }(e["default"]);
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../../../../../components/CCLabelShadow": 120,
        "../../../../utils/label/ttf": 241
    }],
    251: [function(h, q, m) {
        function f(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = function(a) {
                return a && a.__esModule ? a : {
                    default: a
                }
            }(h("../../../../../value-types/vec3")),
            b = h("../../../../assembler-3d");
        h = h("../2d/bmfont");
        var k = new e["default"],
            c = new e["default"];
        h = function(a) {
            function b() {
                return a.apply(this, arguments) || this
            }
            f(b, a);
            return b
        }(h);
        m["default"] = h;
        cc.js.mixin(h.prototype, b, {
            updateWorldVerts: function(a) {
                a = a.node._worldMatrix;
                for (var b = this._local, l = this._renderData.vDatas[0], g = this.floatsPerVert, n = 0; n < l.length; n += g) e["default"].set(k, b[n],
                    b[n + 1], 0), e["default"].transformMat4(c, k, a), l[n] = c.x, l[n + 1] = c.y, l[n + 2] = c.z
            }
        });
        q.exports = m["default"]
    }, {
        "../../../../../value-types/vec3": 311,
        "../../../../assembler-3d": 231,
        "../2d/bmfont": 247
    }],
    252: [function(h, q, m) {
        function f(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = function(a) {
                return a && a.__esModule ? a : {
                    default: a
                }
            }(h("../../../../../value-types/vec3")),
            b = h("../../../../assembler-3d");
        h = h("../2d/letter");
        var k = new e["default"],
            c = new e["default"];
        h = function(a) {
            function b() {
                return a.apply(this, arguments) || this
            }
            f(b, a);
            return b
        }(h);
        m["default"] = h;
        cc.js.mixin(h.prototype, b, {
            updateWorldVerts: function(a) {
                a = a.node._worldMatrix;
                for (var b = this._local, l = this._renderData.vDatas[0], g = this.floatsPerVert, n = 0; n < l.length; n += g) e["default"].set(k, b[n], b[n + 1], 0), e["default"].transformMat4(c, k, a), l[n] = c.x, l[n + 1] = c.y, l[n + 2] = c.z
            }
        });
        q.exports = m["default"]
    }, {
        "../../../../../value-types/vec3": 311,
        "../../../../assembler-3d": 231,
        "../2d/letter": 248
    }],
    253: [function(h, q, m) {
        function f(b, e) {
            b.prototype = Object.create(e.prototype);
            b.prototype.constructor = b;
            b.__proto__ = e
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = h("../../../../assembler-3d");
        h = function(b) {
            function e() {
                return b.apply(this, arguments) || this
            }
            f(e, b);
            return e
        }(h("../2d/ttf"));
        m["default"] = h;
        cc.js.mixin(h.prototype, e);
        q.exports = m["default"]
    }, {
        "../../../../assembler-3d": 231,
        "../2d/ttf": 250
    }],
    254: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }
        q = f(h("../../../assembler"));
        var e = f(h("../../../../components/CCLabel")),
            b = f(h("./2d/ttf")),
            k = f(h("./2d/bmfont")),
            c = f(h("./2d/letter")),
            a = f(h("./3d/ttf")),
            d = f(h("./3d/bmfont")),
            l = f(h("./3d/letter"));
        !1;
        e["default"]._canvasPool = {
            pool: [],
            get: function() {
                var a = this.pool.pop();
                if (!a) {
                    a = document.createElement("canvas");
                    var b = a.getContext("2d");
                    a = {
                        canvas: a,
                        context: b
                    };
                    b.textBaseline = "alphabetic"
                }
                return a
            },
            put: function(a) {
                32 <= this.pool.length || this.pool.push(a)
            }
        };
        q["default"].register(cc.Label, {
            getConstructor: function(g) {
                var n = g.node.is3DNode,
                    f = n ? a["default"] : b["default"];
                g.font instanceof cc.BitmapFont ? f = n ? d["default"] : k["default"] : g.cacheMode === e["default"].CacheMode.CHAR && (!1, cc.sys.platform === cc.sys.WECHAT_GAME_SUB ? cc.warn("sorry, subdomain does not support CHAR mode currently!") : f = n ? l["default"] : c["default"]);
                return f
            },
            TTF: b["default"],
            Bmfont: k["default"],
            Letter: c["default"],
            TTF3D: a["default"],
            Bmfont3D: d["default"],
            Letter3D: l["default"],
            NativeTTF: void 0
        })
    }, {
        "../../../../components/CCLabel": 118,
        "../../../assembler": 233,
        "./2d/bmfont": 247,
        "./2d/letter": 248,
        "./2d/nativeTTF": 249,
        "./2d/ttf": 250,
        "./3d/bmfont": 251,
        "./3d/letter": 252,
        "./3d/ttf": 253
    }],
    255: [function(h, q, m) {
        function f(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }

        function e(a) {
            for (var b = d.DS_FUNC_EQUAL, c = d.STENCIL_OP_KEEP, l, e = l = 0; e < g.length; ++e) l += 1 << e;
            e = g[g.length - 1];
            e._enableMaterial.effect.setStencil(d.STENCIL_ENABLE, b, l, l, c, d.STENCIL_OP_KEEP, d.STENCIL_OP_KEEP, 1 << g.length - 1);
            a._flushMaterial(e._enableMaterial)
        }
        m.__esModule = !0;
        m.MaskAssembler =
            void 0;
        q = function(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }(h("../../assembler"));
        var b = h("../../../components/CCMask"),
            k = h("../../render-flow"),
            c = h("./sprite/2d/simple"),
            a = h("./graphics"),
            d = h("../../../../renderer/gfx"),
            l = h("../vertex-format").vfmtPos,
            g = [];
        h = function(n) {
            function h() {
                return n.apply(this, arguments) || this
            }
            f(h, n);
            var t = h.prototype;
            t.updateRenderData = function(d) {
                d._type === b.Type.IMAGE_STENCIL ? d.spriteFrame ? c.prototype.updateRenderData.call(this, d) : d.setMaterial(0, null) : (d._graphics.setMaterial(0,
                    d._materials[0]), a.prototype.updateRenderData.call(d._graphics._assembler, d._graphics, d._graphics))
            };
            t.fillBuffers = function(n, f) {
                if (n._type !== b.Type.IMAGE_STENCIL || n.spriteFrame) {
                    8 < g.length + 1 && cc.errorID(9E3, 8);
                    g.push(n);
                    var h = 1 << g.length - 1;
                    n._clearMaterial.effect.setStencil(d.STENCIL_ENABLE, d.DS_FUNC_NEVER, h, h, n.inverted ? d.STENCIL_OP_REPLACE : d.STENCIL_OP_ZERO, d.STENCIL_OP_KEEP, d.STENCIL_OP_KEEP, h);
                    var p = f.getBuffer("mesh", l),
                        t = p.request(4, 6);
                    h = t.indiceOffset;
                    var u = t.byteOffset >> 2;
                    t = t.vertexOffset;
                    var w = p._vData;
                    p = p._iData;
                    w[u++] = -1;
                    w[u++] = -1;
                    w[u++] = -1;
                    w[u++] = 1;
                    w[u++] = 1;
                    w[u++] = 1;
                    w[u++] = 1;
                    w[u++] = -1;
                    p[h++] = t;
                    p[h++] = t + 3;
                    p[h++] = t + 1;
                    p[h++] = t + 1;
                    p[h++] = t + 3;
                    p[h++] = t + 2;
                    f.node = f._dummyNode;
                    f.material = n._clearMaterial;
                    f._flush();
                    h = 1 << g.length - 1;
                    n._materials[0].effect.setStencil(d.STENCIL_ENABLE, d.DS_FUNC_NEVER, h, h, n.inverted ? d.STENCIL_OP_ZERO : d.STENCIL_OP_REPLACE, d.STENCIL_OP_KEEP, d.STENCIL_OP_KEEP, h);
                    f.material = n._materials[0];
                    n._type === b.Type.IMAGE_STENCIL ? (f.node = f._dummyNode, c.prototype.fillBuffers.call(n._assembler,
                        n, f), f._flush()) : (f.node = n.node, a.prototype.fillBuffers.call(n._graphics._assembler, n._graphics, f));
                    e(f)
                }
                n.node._renderFlag |= k.FLAG_UPDATE_RENDER_DATA
            };
            t.postFillBuffers = function(a, c) {
                if (a._type !== b.Type.IMAGE_STENCIL || a.spriteFrame) 0 === g.length && cc.errorID(9001), g.pop(), 0 === g.length ? c._flushMaterial(a._exitMaterial) : e(c);
                a.node._renderFlag |= k.FLAG_UPDATE_RENDER_DATA
            };
            return h
        }(c);
        m.MaskAssembler = h;
        q["default"].register(b, h)
    }, {
        "../../../../renderer/gfx": 334,
        "../../../components/CCMask": 122,
        "../../assembler": 233,
        "../../render-flow": 237,
        "../vertex-format": 275,
        "./graphics": 245,
        "./sprite/2d/simple": 259
    }],
    256: [function(h, q, m) {
        function f(b, c) {
            b.prototype = Object.create(c.prototype);
            b.prototype.constructor = b;
            b.__proto__ = c
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("../../../../assembler-2d")),
            b = h("../../../../../components/CCSprite").FillType;
        h = function(e) {
            function c() {
                return e.apply(this, arguments) || this
            }
            f(c, e);
            var a = c.prototype;
            a.updateRenderData = function(a) {
                this.packToDynamicAtlas(a,
                    a._spriteFrame);
                if (a._vertsDirty) {
                    var b = a._fillStart,
                        c = a._fillRange;
                    0 > c && (b += c, c = -c);
                    c = b + c;
                    b = 1 < b ? 1 : b;
                    b = 0 > b ? 0 : b;
                    c = 1 < c ? 1 : c;
                    c = (0 > c ? 0 : c) - b;
                    c = b + (0 > c ? 0 : c);
                    c = 1 < c ? 1 : c;
                    this.updateUVs(a, b, c);
                    this.updateVerts(a, b, c);
                    a._vertsDirty = !1
                }
            };
            a.updateUVs = function(a, c, g) {
                var d = a._spriteFrame,
                    l = d._texture.width,
                    e = d._texture.height,
                    k = d._rect,
                    f;
                if (d._rotated) {
                    d = k.x / l;
                    var h = (k.y + k.width) / e;
                    l = (k.x + k.height) / l;
                    var A = k.y / e;
                    e = k = d;
                    d = l;
                    var B = f = h;
                    h = A
                } else d = k.x / l, h = (k.y + k.height) / e, l = (k.x + k.width) / l, A = k.y / e, e = d, k = l, h = B = h, A = f = A;
                var m = this._renderData.vDatas[0],
                    y = this.uvOffset,
                    z = this.floatsPerVert;
                switch (a._fillType) {
                    case b.HORIZONTAL:
                        m[y] = e + (k - e) * c;
                        m[y + 1] = h + (B - h) * c;
                        m[y + z] = e + (k - e) * g;
                        m[y + z + 1] = h + (B - h) * g;
                        m[y + 2 * z] = d + (l - d) * c;
                        m[y + 2 * z + 1] = A + (f - A) * c;
                        m[y + 3 * z] = d + (l - d) * g;
                        m[y + 3 * z + 1] = A + (f - A) * g;
                        break;
                    case b.VERTICAL:
                        m[y] = e + (d - e) * c;
                        m[y + 1] = h + (A - h) * c;
                        m[y + z] = k + (l - k) * c;
                        m[y + z + 1] = B + (f - B) * c;
                        m[y + 2 * z] = e + (d - e) * g;
                        m[y + 2 * z + 1] = h + (A - h) * g;
                        m[y + 3 * z] = k + (l - k) * g;
                        m[y + 3 * z + 1] = B + (f - B) * g;
                        break;
                    default:
                        cc.errorID(2626)
                }
            };
            a.updateVerts = function(a, c, g) {
                var d = a.node,
                    l = d.width,
                    e = d.height,
                    k = d.anchorX * l,
                    f = d.anchorY * e;
                d = -k;
                var h = -f;
                l -= k;
                e -= f;
                switch (a._fillType) {
                    case b.HORIZONTAL:
                        g = d + (l - d) * g;
                        d += (l - d) * c;
                        l = g;
                        break;
                    case b.VERTICAL:
                        g = h + (e - h) * g;
                        h += (e - h) * c;
                        e = g;
                        break;
                    default:
                        cc.errorID(2626)
                }
                c = this._local;
                c[0] = d;
                c[1] = h;
                c[2] = l;
                c[3] = e;
                this.updateWorldVerts(a)
            };
            return c
        }(e["default"]);
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../../../../../components/CCSprite": 132,
        "../../../../assembler-2d": 230
    }],
    257: [function(h, q, m) {
        function f(e, b) {
            e.prototype = Object.create(b.prototype);
            e.prototype.constructor =
                e;
            e.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        h = function(e) {
            function b() {
                return e.apply(this, arguments) || this
            }
            f(b, e);
            var k = b.prototype;
            k.initData = function(b) {
                this._renderData.createFlexData(0, 4, 6, this.getVfmt())
            };
            k.updateRenderData = function(b) {
                this.packToDynamicAtlas(b, b._spriteFrame);
                var a = b.spriteFrame;
                if (a && (a = a.vertices)) {
                    this.verticesCount = a.x.length;
                    this.indicesCount = a.triangles.length;
                    var c = this._renderData._flexBuffer;
                    c.reserve(this.verticesCount, this.indicesCount) && (this.updateColor(b),
                        b._vertsDirty = !0);
                    c.used(this.verticesCount, this.indicesCount);
                    this.updateIndices(a.triangles);
                    b._vertsDirty && (this.updateUVs(b), this.updateVerts(b), this.updateWorldVerts(b), b._vertsDirty = !1)
                }
            };
            k.updateIndices = function(b) {
                this._renderData.iDatas[0].set(b)
            };
            k.updateUVs = function(b) {
                var a = b.spriteFrame.vertices;
                b = a.nu;
                a = a.nv;
                for (var c = this.uvOffset, l = this.floatsPerVert, g = this._renderData.vDatas[0], e = 0; e < b.length; e++) {
                    var k = l * e + c;
                    g[k] = b[e];
                    g[k + 1] = a[e]
                }
            };
            k.updateVerts = function(b) {
                var a = b.node,
                    c = Math.abs(a.width),
                    l = Math.abs(a.height),
                    g = a.anchorX * c;
                a = a.anchorY * l;
                var e = b.spriteFrame,
                    k = e.vertices,
                    f = k.x;
                k = k.y;
                var h = e._originalSize.width,
                    u = e._originalSize.height,
                    v = e._rect.width,
                    A = e._rect.height,
                    B = e._offset.x + (h - v) / 2;
                e = e._offset.y + (u - A) / 2;
                c /= b.trim ? v : h;
                l /= b.trim ? A : u;
                A = this._local;
                if (b.trim)
                    for (b = 0, h = f.length; b < h; b++) v = 2 * b, A[v] = (f[b] - B) * c - g, A[v + 1] = (u - k[b] - e) * l - a;
                else
                    for (B = 0, b = f.length; B < b; B++) e = 2 * B, A[e] = f[B] * c - g, A[e + 1] = (u - k[B]) * l - a
            };
            k.updateWorldVerts = function(b) {
                var a = b.node._worldMatrix.m;
                b = a[0];
                var c = a[1],
                    e =
                    a[4],
                    g = a[5],
                    k = a[12];
                a = a[13];
                for (var f = this._local, h = this._renderData.vDatas[0], p = this.floatsPerVert, u = 0, v = this.verticesCount; u < v; u++) {
                    var A = f[2 * u],
                        B = f[2 * u + 1];
                    h[p * u] = A * b + B * e + k;
                    h[p * u + 1] = A * c + B * g + a
                }
            };
            return b
        }(function(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }(h("../../../../assembler-2d"))["default"]);
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../../../../assembler-2d": 230
    }],
    258: [function(h, q, m) {
        function f(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }

        function e(a,
            b, c, d, g, e, l) {
            var k = Math.sin(e),
                n = Math.cos(e);
            if (0 !== Math.cos(e)) {
                var f = k / n;
                if (0 < (a - g.x) * n) {
                    var h = g.y + f * (a - g.x);
                    l[0].x = a;
                    l[0].y = h
                }
                0 < (b - g.x) * n && (a = g.y + f * (b - g.x), l[2].x = b, l[2].y = a)
            }
            0 !== Math.sin(e) && (b = n / k, 0 < (d - g.y) * k && (l[3].x = g.x + b * (d - g.y), l[3].y = d), 0 < (c - g.y) * k && (l[1].x = g.x + b * (c - g.y), l[1].y = c))
        }

        function b(a, b) {
            var c = b.x - a.x;
            a = b.y - a.y;
            if (0 !== c || 0 !== a) {
                if (0 === c) return 0 < a ? .5 * Math.PI : 1.5 * Math.PI;
                a = Math.atan(a / c);
                0 > c && (a += Math.PI);
                return a
            }
        }
        m.__esModule = !0;
        m["default"] = void 0;
        h = function(a) {
            return a && a.__esModule ?
                a : {
                    default: a
                }
        }(h("../../../../assembler-2d"));
        var k = 2 * Math.PI,
            c = [cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0)],
            a = [0, 0, 0, 0],
            d = [0, 0, 0, 0, 0, 0, 0, 0],
            l = [cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0)],
            g = [cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0)],
            n = cc.v2(0, 0),
            w = [];
        h = function(h) {
            function p() {
                return h.apply(this, arguments) || this
            }
            f(p, h);
            var t = p.prototype;
            t.initData = function(a) {
                this._renderData.createFlexData(0, 4, 6, this.getVfmt());
                this.updateIndices()
            };
            t.updateRenderData = function(b) {
                h.prototype.updateRenderData.call(this,
                    b);
                var f = b.spriteFrame;
                this.packToDynamicAtlas(b, f);
                if (b._vertsDirty) {
                    var p = b._fillStart,
                        t = b._fillRange;
                    0 > t && (p += t, t = -t);
                    for (; 1 <= p;) --p;
                    for (; 0 > p;) p += 1;
                    p *= k;
                    t *= k;
                    var v = b.node,
                        u = v.width,
                        m = v.height,
                        q = v.anchorX * u,
                        G = v.anchorY * m;
                    v = -q;
                    var F = -G;
                    u -= q;
                    m -= G;
                    a[0] = v;
                    a[1] = F;
                    a[2] = u;
                    a[3] = m;
                    G = b._fillCenter;
                    q = n.x = Math.min(Math.max(0, G.x), 1) * (u - v) + v;
                    G = n.y = Math.min(Math.max(0, G.y), 1) * (m - F) + F;
                    c[0].x = c[3].x = v;
                    c[1].x = c[2].x = u;
                    c[0].y = c[1].y = F;
                    c[2].y = c[3].y = m;
                    w.length = 0;
                    q !== a[0] && (w[0] = [3, 0]);
                    q !== a[2] && (w[2] = [1, 2]);
                    G !== a[1] &&
                        (w[1] = [0, 1]);
                    G !== a[3] && (w[3] = [2, 3]);
                    u = f._texture.width;
                    v = f._texture.height;
                    F = f._rect;
                    f._rotated ? (f = F.x / u, u = (F.x + F.height) / u, m = F.y / v, v = (F.y + F.width) / v, d[0] = d[2] = f, d[4] = d[6] = u, d[3] = d[7] = v, d[1] = d[5] = m) : (f = F.x / u, u = (F.x + F.width) / u, m = F.y / v, v = (F.y + F.height) / v, d[0] = d[4] = f, d[2] = d[6] = u, d[1] = d[3] = v, d[5] = d[7] = m);
                    e(a[0], a[2], a[1], a[3], n, p, l);
                    e(a[0], a[2], a[1], a[3], n, p + t, g);
                    this.updateVerts(b, p, t);
                    b._vertsDirty = !1
                }
            };
            t.updateVerts = function(a, d, e) {
                for (var f = d + e, h = this._local, p = h.length = 0, t = 3 * this.floatsPerVert, v =
                        0; 4 > v; ++v) {
                    var u = w[v];
                    if (u)
                        if (e >= k) h.length = p + t, this._generateTriangle(h, p, n, c[u[0]], c[u[1]]), p += t;
                        else {
                            var A = b(n, c[u[0]]),
                                B = b(n, c[u[1]]);
                            B < A && (B += k);
                            A -= k;
                            B -= k;
                            for (var m = 0; 3 > m; ++m) A >= f || (A >= d ? (h.length = p + t, B >= f ? this._generateTriangle(h, p, n, c[u[0]], g[v]) : this._generateTriangle(h, p, n, c[u[0]], c[u[1]]), p += t) : B <= d || (B <= f ? (h.length = p + t, this._generateTriangle(h, p, n, l[v], c[u[1]])) : (h.length = p + t, this._generateTriangle(h, p, n, l[v], g[v])), p += t)), A += k, B += k
                        }
                }
                this.allocWorldVerts(a);
                this.updateWorldVerts(a)
            };
            t.allocWorldVerts =
                function(a) {
                    a = a.node._color._val;
                    var b = this._renderData,
                        c = this.floatsPerVert,
                        d = this._local,
                        g = d.length / c;
                    this.verticesCount = this.indicesCount = g;
                    var e = b._flexBuffer;
                    e.reserve(g, g) && this.updateIndices();
                    e.used(this.verticesCount, this.indicesCount);
                    g = b.vDatas[0];
                    b = b.uintVDatas[0];
                    e = this.uvOffset;
                    for (var l = 0; l < d.length; l += c) {
                        var k = l + e;
                        g[k] = d[k];
                        g[k + 1] = d[k + 1];
                        b[k + 2] = a
                    }
                };
            t.updateIndices = function() {
                for (var a = this._renderData.iDatas[0], b = 0; b < a.length; b++) a[b] = b
            };
            t.updateWorldVerts = function(a) {
                var b = a.node._worldMatrix.m;
                a = b[0];
                var c = b[1],
                    d = b[4],
                    g = b[5],
                    e = b[12];
                b = b[13];
                for (var l = this._local, k = this._renderData.vDatas[0], n = this.floatsPerVert, f = 0; f < l.length; f += n) {
                    var h = l[f],
                        p = l[f + 1];
                    k[f] = h * a + p * d + e;
                    k[f + 1] = h * c + p * g + b
                }
            };
            t._generateTriangle = function(b, c, d, g, e) {
                var l = a[0],
                    k = a[1],
                    n = a[2],
                    f = a[3],
                    h = this.floatsPerVert;
                b[c] = d.x;
                b[c + 1] = d.y;
                b[c + h] = g.x;
                b[c + h + 1] = g.y;
                b[c + 2 * h] = e.x;
                b[c + 2 * h + 1] = e.y;
                var p = this.uvOffset;
                var t = (d.x - l) / (n - l);
                d = (d.y - k) / (f - k);
                this._generateUV(t, d, b, c + p);
                t = (g.x - l) / (n - l);
                d = (g.y - k) / (f - k);
                this._generateUV(t, d, b, c +
                    h + p);
                t = (e.x - l) / (n - l);
                d = (e.y - k) / (f - k);
                this._generateUV(t, d, b, c + 2 * h + p)
            };
            t._generateUV = function(a, b, c, g) {
                var e = d[0] + (d[2] - d[0]) * a,
                    l = d[1] + (d[3] - d[1]) * a,
                    k = d[5] + (d[7] - d[5]) * a;
                c[g] = e + (d[4] + (d[6] - d[4]) * a - e) * b;
                c[g + 1] = l + (k - l) * b
            };
            return p
        }(h["default"]);
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../../../../assembler-2d": 230
    }],
    259: [function(h, q, m) {
        function f(e, b) {
            e.prototype = Object.create(b.prototype);
            e.prototype.constructor = e;
            e.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        h = function(e) {
            function b() {
                return e.apply(this,
                    arguments) || this
            }
            f(b, e);
            var k = b.prototype;
            k.updateRenderData = function(b) {
                this.packToDynamicAtlas(b, b._spriteFrame);
                b._vertsDirty && (this.updateUVs(b), this.updateVerts(b), b._vertsDirty = !1)
            };
            k.updateUVs = function(b) {
                b = b._spriteFrame.uv;
                for (var a = this.uvOffset, c = this.floatsPerVert, e = this._renderData.vDatas[0], g = 0; 4 > g; g++) {
                    var k = 2 * g,
                        f = c * g + a;
                    e[f] = b[k];
                    e[f + 1] = b[k + 1]
                }
            };
            k.updateVerts = function(b) {
                var a = b.node,
                    c = a.width,
                    e = a.height,
                    g = a.anchorX * c;
                a = a.anchorY * e;
                if (b.trim) {
                    var k = -g;
                    var f = -a;
                    c -= g;
                    e -= a
                } else {
                    var h =
                        b.spriteFrame;
                    k = h._originalSize.width;
                    var p = h._originalSize.height;
                    f = h._rect.width;
                    var u = h._rect.height,
                        v = h._offset,
                        A = c / k;
                    h = e / p;
                    var B = v.x - (k - f) / 2,
                        m = v.y + (p - u) / 2;
                    p = v.y - (p - u) / 2;
                    k = (v.x + (k - f) / 2) * A - g;
                    f = m * h - a;
                    c = c + B * A - g;
                    e = e + p * h - a
                }
                g = this._local;
                g[0] = k;
                g[1] = f;
                g[2] = c;
                g[3] = e;
                this.updateWorldVerts(b)
            };
            return b
        }(function(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }(h("../../../../assembler-2d"))["default"]);
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../../../../assembler-2d": 230
    }],
    260: [function(h, q, m) {
        function f(e, b) {
            e.prototype =
                Object.create(b.prototype);
            e.prototype.constructor = e;
            e.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        h = function(e) {
            function b() {
                return e.apply(this, arguments) || this
            }
            f(b, e);
            var k = b.prototype;
            k.initData = function(b) {
                if (!(0 < this._renderData.meshCount)) {
                    this._renderData.createData(0, this.verticesFloats, this.indicesCount);
                    b = this._renderData.iDatas[0];
                    for (var a = 0, c = 0; 3 > c; ++c)
                        for (var e = 0; 3 > e; ++e) {
                            var g = 4 * c + e;
                            b[a++] = g;
                            b[a++] = g + 1;
                            b[a++] = g + 4;
                            b[a++] = g + 1;
                            b[a++] = g + 5;
                            b[a++] = g + 4
                        }
                }
            };
            k.initLocal = function() {
                this._local = [];
                this._local.length = 8
            };
            k.updateRenderData = function(b) {
                this.packToDynamicAtlas(b, b._spriteFrame);
                b._vertsDirty && (this.updateUVs(b), this.updateVerts(b), b._vertsDirty = !1)
            };
            k.updateVerts = function(b) {
                var a = b.node,
                    c = a.width,
                    e = a.height,
                    g = a.anchorX * c;
                a = a.anchorY * e;
                var k = b.spriteFrame,
                    f = k.insetLeft,
                    h = k.insetRight,
                    p = k.insetTop;
                k = k.insetBottom;
                var u = c - f - h,
                    v = e - p - k;
                h = c / (f + h);
                p = e / (p + k);
                h = isNaN(h) || 1 < h ? 1 : h;
                p = isNaN(p) || 1 < p ? 1 : p;
                var A = this._local;
                A[0] = -g;
                A[1] = -a;
                A[2] = f * h - g;
                A[3] = k * p - a;
                A[4] = A[2] + (0 > u ? 0 : u);
                A[5] = A[3] +
                    (0 > v ? 0 : v);
                A[6] = c - g;
                A[7] = e - a;
                this.updateWorldVerts(b)
            };
            k.updateUVs = function(b) {
                var a = this._renderData.vDatas[0];
                b = b.spriteFrame.uvSliced;
                for (var c = this.uvOffset, e = this.floatsPerVert, g = 0; 4 > g; ++g)
                    for (var k = 0; 4 > k; ++k) {
                        var f = 4 * g + k,
                            h = b[f];
                        f *= e;
                        a[f + c] = h.u;
                        a[f + c + 1] = h.v
                    }
            };
            k.updateWorldVerts = function(b) {
                var a = b.node._worldMatrix.m;
                b = a[0];
                var c = a[1],
                    e = a[4],
                    g = a[5],
                    k = a[12];
                a = a[13];
                for (var f = this._local, h = this._renderData.vDatas[0], p = this.floatsPerVert, u = 0; 4 > u; ++u)
                    for (var v = f[2 * u + 1], A = 0; 4 > A; ++A) {
                        var B = f[2 * A],
                            m =
                            (4 * u + A) * p;
                        h[m] = B * b + v * e + k;
                        h[m + 1] = B * c + v * g + a
                    }
            };
            return b
        }(function(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }(h("../../../../assembler-2d"))["default"]);
        m["default"] = h;
        Object.assign(h.prototype, {
            verticesCount: 16,
            indicesCount: 54
        });
        q.exports = m["default"]
    }, {
        "../../../../assembler-2d": 230
    }],
    261: [function(h, q, m) {
        function f(e, b) {
            e.prototype = Object.create(b.prototype);
            e.prototype.constructor = e;
            e.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        h = function(e) {
            function b() {
                return e.apply(this, arguments) || this
            }
            f(b,
                e);
            var k = b.prototype;
            k.initData = function(b) {
                this.col = this.row = this.vRepeat = this.hRepeat = this.rectHeight = this.rectWidth = this.contentHeight = this.contentWidth = this.verticesCount = 0;
                this._renderData.createFlexData(0, 4, 6, this.getVfmt());
                this._updateIndices()
            };
            k.initLocal = function() {
                this._local = {
                    x: [],
                    y: []
                }
            };
            k._updateIndices = function() {
                for (var b = this._renderData.iDatas[0], a = 0, d = 0, e = b.length; a < e; a += 6, d += 4) b[a] = d, b[a + 1] = d + 1, b[a + 2] = d + 2, b[a + 3] = d + 1, b[a + 4] = d + 3, b[a + 5] = d + 2
            };
            k.updateRenderData = function(b) {
                var a = b._spriteFrame;
                this.packToDynamicAtlas(b, a);
                var c = b.node,
                    e = this.contentWidth = Math.abs(c.width);
                c = this.contentHeight = Math.abs(c.height);
                var g = a._rect,
                    k = a.insetLeft,
                    f = a.insetRight,
                    h = g.width - k - f,
                    p = a.insetTop;
                a = a.insetBottom;
                g = g.height - p - a;
                this.sizableWidth = e - k - f;
                this.sizableHeight = c - p - a;
                this.sizableWidth = 0 < this.sizableWidth ? this.sizableWidth : 0;
                this.sizableHeight = 0 < this.sizableHeight ? this.sizableHeight : 0;
                e = this.hRepeat = 0 === h ? this.sizableWidth : this.sizableWidth / h;
                c = this.vRepeat = 0 === g ? this.sizableHeight : this.sizableHeight /
                    g;
                c = this.row = Math.ceil(c + 2);
                e = this.col = Math.ceil(e + 2);
                e *= c;
                this.verticesCount = 4 * e;
                this.indicesCount = 6 * e;
                e = this._renderData._flexBuffer;
                e.reserve(this.verticesCount, this.indicesCount) && (this._updateIndices(), this.updateColor(b));
                e.used(this.verticesCount, this.indicesCount);
                b._vertsDirty && (this.updateUVs(b), this.updateVerts(b), b._vertsDirty = !1)
            };
            k.updateVerts = function(b) {
                var a = b._spriteFrame,
                    c = a._rect,
                    e = b.node,
                    g = e.anchorX * e.width,
                    k = e.anchorY * e.height,
                    f = this.row,
                    h = this.col,
                    p = this.contentWidth,
                    u = this.contentHeight,
                    v = this._local,
                    A = v.x;
                v = v.y;
                A.length = v.length = 0;
                var B = a.insetLeft,
                    m = a.insetRight,
                    y = c.width - B - m,
                    z = a.insetTop;
                a = a.insetBottom;
                c = c.height - z - a;
                var x = 1 < e.width / (B + m) ? 1 : e.width / (B + m);
                e = 1 < e.height / (z + a) ? 1 : e.height / (z + a);
                var q = 0 < y ? 0 === Math.floor(1E3 * this.sizableWidth) / 1E3 % y ? y : this.sizableWidth % y : this.sizableWidth;
                var G = 0 < c ? 0 === Math.floor(1E3 * this.sizableHeight) / 1E3 % c ? c : this.sizableHeight % c : this.sizableHeight;
                for (var F = 0; F <= h; F++) 0 === F ? A[F] = -g : 0 < F && F < h ? A[F] = 1 === F ? B * x + Math.min(y, this.sizableWidth) - g : 0 < y ? F ===
                    h - 1 ? B + q + y * (F - 2) - g : B + Math.min(y, this.sizableWidth) + y * (F - 2) - g : B + this.sizableWidth - g : F === h && (A[F] = Math.min(B + this.sizableWidth + m, p) - g);
                for (g = 0; g <= f; g++) 0 === g ? v[g] = -k : 0 < g && g < f ? v[g] = 1 === g ? a * e + Math.min(c, this.sizableHeight) - k : 0 < c ? g === f - 1 ? a + G + (g - 2) * c - k : a + Math.min(c, this.sizableHeight) + (g - 2) * c - k : a + this.sizableHeight - k : g === f && (v[g] = Math.min(a + this.sizableHeight + z, u) - k);
                this.updateWorldVerts(b)
            };
            k.updateWorldVerts = function(b) {
                var a = this._local,
                    c = a.x;
                a = a.y;
                var e = this._renderData.vDatas[0],
                    g = this.col,
                    k = b.node._worldMatrix.m;
                b = k[0];
                var f = k[1],
                    h = k[4],
                    p = k[5],
                    u = k[12];
                k = k[13];
                for (var v, A, B, m, y = this.floatsPerVert, z = 0, x = 0, q = this.row; x < q; ++x) {
                    B = a[x];
                    m = a[x + 1];
                    for (var G = 0, F = g; G < F; ++G) v = c[G], A = c[G + 1], e[z] = v * b + B * h + u, e[z + 1] = v * f + B * p + k, z += y, e[z] = A * b + B * h + u, e[z + 1] = A * f + B * p + k, z += y, e[z] = v * b + m * h + u, e[z + 1] = v * f + m * p + k, z += y, e[z] = A * b + m * h + u, e[z + 1] = A * f + m * p + k, z += y
                }
            };
            k.updateUVs = function(b) {
                var a = this._renderData.vDatas[0];
                if (a) {
                    var c = b._spriteFrame,
                        e = c._rect,
                        g = e.width - c.insetLeft - c.insetRight;
                    c = e.height - c.insetTop - c.insetBottom;
                    e = this.row;
                    for (var k =
                            this.col, f = this.hRepeat, h = this.vRepeat, p, u = b.spriteFrame.uv, v = b.spriteFrame.uvSliced, A = b.spriteFrame._rotated, B = this.floatsPerVert, m = this.uvOffset, y = 0; y < e; ++y) {
                        p = this.sizableHeight > c ? this.sizableHeight >= y * c ? 1 : h % 1 : h;
                        for (var z = 0, x = k; z < x; ++z) b = this.sizableWidth > g ? this.sizableWidth >= z * g ? 1 : f % 1 : f, A ? (a[m] = u[0], a[m + 1] = u[1], m += B, a[m] = u[0], a[m + 1] = u[1] + (u[7] - u[1]) * b, m += B, a[m] = u[0] + (u[6] - u[0]) * p, a[m + 1] = u[1], m += B, a[m] = a[m - B], a[m + 1] = a[m + 1 - 2 * B]) : (0 === z ? a[m] = u[0] : 0 < z && z < k - 1 ? a[m] = v[1].u : z === k - 1 && (a[m] = v[2].u), 0 ===
                            y ? a[m + 1] = v[0].v : 0 < y && y < e - 1 ? a[m + 1] = v[4].v : y === e - 1 && (a[m + 1] = v[8].v), m += B, 0 === z ? a[m] = v[1].u + (v[2].u - v[1].u) * b : 0 < z && z < k - 1 ? a[m] = v[1].u + (v[2].u - v[1].u) * b : z === k - 1 && (a[m] = v[3].u), 0 === y ? a[m + 1] = v[0].v : 0 < y && y < e - 1 ? a[m + 1] = v[4].v : y === e - 1 && (a[m + 1] = v[8].v), m += B, 0 === z ? a[m] = u[0] : 0 < z && z < k - 1 ? a[m] = v[1].u : z === k - 1 && (a[m] = v[2].u), 0 === y ? a[m + 1] = v[4].v + (v[8].v - v[4].v) * p : 0 < y && y < e - 1 ? a[m + 1] = v[4].v + (v[8].v - v[4].v) * p : y === e - 1 && (a[m + 1] = v[12].v), m += B, a[m] = a[m - 2 * B], a[m + 1] = a[m + 1 - B]), m += B
                    }
                }
            };
            return b
        }(function(e) {
            return e && e.__esModule ?
                e : {
                    default: e
                }
        }(h("../../../../assembler-2d"))["default"]);
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../../../../assembler-2d": 230
    }],
    262: [function(h, q, m) {
        function f(b, e) {
            b.prototype = Object.create(e.prototype);
            b.prototype.constructor = b;
            b.__proto__ = e
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = h("../../../../assembler-3d");
        h = function(b) {
            function e() {
                return b.apply(this, arguments) || this
            }
            f(e, b);
            return e
        }(h("../2d/bar-filled"));
        m["default"] = h;
        cc.js.mixin(h.prototype, e);
        q.exports = m["default"]
    }, {
        "../../../../assembler-3d": 231,
        "../2d/bar-filled": 256
    }],
    263: [function(h, q, m) {
        function f(b, a) {
            b.prototype = Object.create(a.prototype);
            b.prototype.constructor = b;
            b.__proto__ = a
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("../../../../../value-types/vec3")),
            b = h("../../../../assembler-3d");
        h = h("../2d/mesh");
        var k = new e["default"];
        h = function(b) {
            function a() {
                return b.apply(this, arguments) || this
            }
            f(a, b);
            return a
        }(h);
        m["default"] = h;
        cc.js.mixin(h.prototype, b, {
            updateWorldVerts: function(b) {
                b =
                    b.node._worldMatrix;
                for (var a = this._local, c = this._renderData.vDatas[0], l = this.floatsPerVert, g = 0, f = a.length / 2; g < f; g++) {
                    e["default"].set(k, a[2 * g], a[2 * g + 1], 0);
                    e["default"].transformMat4(k, k, b);
                    var h = l * g;
                    c[h] = k.x;
                    c[h + 1] = k.y;
                    c[h + 2] = k.z
                }
            }
        });
        q.exports = m["default"]
    }, {
        "../../../../../value-types/vec3": 311,
        "../../../../assembler-3d": 231,
        "../2d/mesh": 257
    }],
    264: [function(h, q, m) {
        function f(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e =
            function(a) {
                return a && a.__esModule ? a : {
                    default: a
                }
            }(h("../../../../../value-types/vec3")),
            b = h("../../../../assembler-3d");
        h = h("../2d/radial-filled");
        var k = new e["default"],
            c = new e["default"];
        h = function(a) {
            function b() {
                return a.apply(this, arguments) || this
            }
            f(b, a);
            return b
        }(h);
        m["default"] = h;
        cc.js.mixin(h.prototype, b, {
            updateWorldVerts: function(a) {
                a = a.node._worldMatrix;
                for (var b = this._local, l = this._renderData.vDatas[0], g = this.floatsPerVert, f = 0; f < l.length; f += g) e["default"].set(k, b[f], b[f + 1], 0), e["default"].transformMat4(c,
                    k, a), l[f] = c.x, l[f + 1] = c.y, l[f + 2] = c.z
            }
        });
        q.exports = m["default"]
    }, {
        "../../../../../value-types/vec3": 311,
        "../../../../assembler-3d": 231,
        "../2d/radial-filled": 258
    }],
    265: [function(h, q, m) {
        function f(b, e) {
            b.prototype = Object.create(e.prototype);
            b.prototype.constructor = b;
            b.__proto__ = e
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = h("../../../../assembler-3d");
        h = function(b) {
            function e() {
                return b.apply(this, arguments) || this
            }
            f(e, b);
            return e
        }(h("../2d/simple"));
        m["default"] = h;
        cc.js.mixin(h.prototype, e);
        q.exports =
            m["default"]
    }, {
        "../../../../assembler-3d": 231,
        "../2d/simple": 259
    }],
    266: [function(h, q, m) {
        function f(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = function(a) {
                return a && a.__esModule ? a : {
                    default: a
                }
            }(h("../../../../../value-types/vec3")),
            b = h("../../../../assembler-3d");
        h = h("../2d/sliced");
        var k = new e["default"],
            c = new e["default"];
        h = function(a) {
            function b() {
                return a.apply(this, arguments) || this
            }
            f(b, a);
            return b
        }(h);
        m["default"] =
            h;
        cc.js.mixin(h.prototype, b, {
            updateWorldVerts: function(a) {
                a = a.node._worldMatrix;
                for (var b = this._local, l = this._renderData.vDatas[0], g = this.floatsPerVert, f = 0; 4 > f; ++f)
                    for (var h = b[2 * f + 1], t = 0; 4 > t; ++t) {
                        e["default"].set(k, b[2 * t], h, 0);
                        e["default"].transformMat4(c, k, a);
                        var p = (4 * f + t) * g;
                        l[p] = c.x;
                        l[p + 1] = c.y;
                        l[p + 2] = c.z
                    }
            }
        });
        q.exports = m["default"]
    }, {
        "../../../../../value-types/vec3": 311,
        "../../../../assembler-3d": 231,
        "../2d/sliced": 260
    }],
    267: [function(h, q, m) {
        function f(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = function(a) {
                return a && a.__esModule ? a : {
                    default: a
                }
            }(h("../../../../../value-types/vec3")),
            b = h("../../../../assembler-3d");
        h = h("../2d/tiled");
        for (var k = [], c = 0; 4 > c; c++) k.push(new e["default"]);
        h = function(a) {
            function b() {
                return a.apply(this, arguments) || this
            }
            f(b, a);
            return b
        }(h);
        m["default"] = h;
        cc.js.mixin(h.prototype, b, {
            updateWorldVerts: function(a) {
                var b = this._local,
                    c = b.x;
                b = b.y;
                var g = this._renderData.vDatas[0],
                    f = this.col;
                a =
                    a.node._worldMatrix;
                for (var h, t, p, u, v = 0, A = 0, B = this.row; A < B; ++A) {
                    p = b[A];
                    u = b[A + 1];
                    for (var m = 0, y = f; m < y; ++m) {
                        h = c[m];
                        t = c[m + 1];
                        e["default"].set(k[0], h, p, 0);
                        e["default"].set(k[1], t, p, 0);
                        e["default"].set(k[2], h, u, 0);
                        e["default"].set(k[3], t, u, 0);
                        for (h = 0; 4 > h; h++) {
                            t = k[h];
                            e["default"].transformMat4(t, t, a);
                            var z = 6 * h;
                            g[v + z] = t.x;
                            g[v + z + 1] = t.y;
                            g[v + z + 2] = t.z
                        }
                        v += 24
                    }
                }
            }
        });
        q.exports = m["default"]
    }, {
        "../../../../../value-types/vec3": 311,
        "../../../../assembler-3d": 231,
        "../2d/tiled": 261
    }],
    268: [function(h, q, m) {
        function f(a) {
            return a &&
                a.__esModule ? a : {
                    default: a
                }
        }
        q = f(h("../../../assembler"));
        var e = h("../../../../components/CCSprite"),
            b = f(h("./2d/simple")),
            k = f(h("./2d/sliced")),
            c = f(h("./2d/tiled")),
            a = f(h("./2d/radial-filled")),
            d = f(h("./2d/bar-filled")),
            l = f(h("./2d/mesh")),
            g = f(h("./3d/simple")),
            n = f(h("./3d/sliced")),
            w = f(h("./3d/tiled")),
            t = f(h("./3d/radial-filled")),
            p = f(h("./3d/bar-filled")),
            u = f(h("./3d/mesh"));
        q["default"].register(cc.Sprite, {
            getConstructor: function(f) {
                var h = f.node.is3DNode,
                    v = h ? g["default"] : b["default"];
                switch (f.type) {
                    case e.Type.SLICED:
                        v =
                            h ? n["default"] : k["default"];
                        break;
                    case e.Type.TILED:
                        v = h ? w["default"] : c["default"];
                        break;
                    case e.Type.FILLED:
                        v = f._fillType === e.FillType.RADIAL ? h ? t["default"] : a["default"] : h ? p["default"] : d["default"];
                        break;
                    case e.Type.MESH:
                        v = h ? u["default"] : l["default"]
                }
                return v
            },
            Simple: b["default"],
            Sliced: k["default"],
            Tiled: c["default"],
            RadialFilled: a["default"],
            BarFilled: d["default"],
            Mesh: l["default"],
            Simple3D: g["default"],
            Sliced3D: n["default"],
            Tiled3D: w["default"],
            RadialFilled3D: t["default"],
            BarFilled3D: p["default"],
            Mesh3D: u["default"]
        })
    }, {
        "../../../../components/CCSprite": 132,
        "../../../assembler": 233,
        "./2d/bar-filled": 256,
        "./2d/mesh": 257,
        "./2d/radial-filled": 258,
        "./2d/simple": 259,
        "./2d/sliced": 260,
        "./2d/tiled": 261,
        "./3d/bar-filled": 262,
        "./3d/mesh": 263,
        "./3d/radial-filled": 264,
        "./3d/simple": 265,
        "./3d/sliced": 266,
        "./3d/tiled": 267
    }],
    269: [function(h, q, m) {
            m.__esModule = !0;
            m["default"] = void 0;
            h = function() {
                function f(b, e, c, a, d) {
                    this._handler = b;
                    this._index = e;
                    this._vfmt = d;
                    this._verticesBytes = d._bytes;
                    this._initVerticesCount =
                        c;
                    this._initIndicesCount = a;
                    this.reset()
                }
                var e = f.prototype;
                e._reallocVData = function(b, e) {
                    this.vData = new Float32Array(b);
                    this.uintVData = new Uint32Array(this.vData.buffer);
                    e && this.vData.set(e);
                    this._handler.updateMesh(this._index, this.vData, this.iData)
                };
                e._reallocIData = function(b, e) {
                    this.iData = new Uint16Array(b);
                    e && this.iData.set(e);
                    this._handler.updateMesh(this._index, this.vData, this.iData)
                };
                e.reserve = function(b, e) {
                    var c = b * this._verticesBytes >> 2,
                        a = this.vData.length;
                    b = !1;
                    if (c > a) {
                        for (; a < c;) a *= 2;
                        this._reallocVData(a,
                            this.vData);
                        b = !0
                    }
                    c = this.iData.length;
                    if (e > c) {
                        for (; c < e;) c *= 2;
                        this._reallocIData(e, this.iData);
                        b = !0
                    }
                    return b
                };
                e.used = function(b, e) {
                    this.usedVertices = b;
                    this.usedIndices = e;
                    this.usedVerticesFloats = b * this._verticesBytes >> 2;
                    this._handler.updateMeshRange(b, e)
                };
                e.reset = function() {
                    this._reallocVData(this._initVerticesCount * this._verticesBytes >> 2);
                    this._reallocIData(this._initIndicesCount);
                    this.usedIndices = this.usedVerticesFloats = this.usedVertices = 0
                };
                return f
            }();
            m["default"] = h;
            cc.FlexBuffer = h;
            q.exports = m["default"]
        },
        {}
    ],
    270: [function(h, q, m) {
        var f = function(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }(h("../../../renderer/gfx"));
        h = cc.sys.os === cc.sys.OS_IOS && cc.sys.isBrowser && cc.sys.isMobile && 14 <= cc.sys.osMainVersion;
        h = isIpad() ? !0 : h;
        m = cc.Class({
            name: "cc.MeshBuffer",
            ctor: function(e, b) {
                this.init(e, b)
            },
            init: function(e, b) {
                this.indiceStart = this.vertexOffset = this.indiceOffset = this.byteOffset = 0;
                this._dirty = !1;
                this._vertexFormat = b;
                this._vertexBytes = this._vertexFormat._bytes;
                this._arrOffset = 0;
                this._vbArr = [];
                this._vb = new f["default"].VertexBuffer(e._device,
                    b, f["default"].USAGE_DYNAMIC, new ArrayBuffer, 0);
                this._vbArr[0] = this._vb;
                this._ibArr = [];
                this._ib = new f["default"].IndexBuffer(e._device, f["default"].INDEX_FMT_UINT16, f["default"].USAGE_STATIC, new ArrayBuffer, 0);
                this._ibArr[0] = this._ib;
                this._iData = this._uintVData = this._vData = null;
                this._batcher = e;
                this._initVDataCount = 256 * b._bytes;
                this._initIDataCount = 1536;
                this._offsetInfo = {
                    byteOffset: 0,
                    vertexOffset: 0,
                    indiceOffset: 0
                };
                this._reallocBuffer()
            },
            uploadData: function() {
                if (0 !== this.byteOffset && this._dirty) {
                    var e =
                        new Float32Array(this._vData.buffer, 0, this.byteOffset >> 2),
                        b = new Uint16Array(this._iData.buffer, 0, this.indiceOffset);
                    this._vb.update(0, e);
                    this._ib.update(0, b);
                    this._dirty = !1
                }
            },
            switchBuffer: function() {
                var e = ++this._arrOffset;
                this.indiceStart = this.indiceOffset = this.vertexOffset = this.byteOffset = 0;
                e < this._vbArr.length ? (this._vb = this._vbArr[e], this._ib = this._ibArr[e]) : (this._vb = new f["default"].VertexBuffer(this._batcher._device, this._vertexFormat, f["default"].USAGE_DYNAMIC, new ArrayBuffer, 0), this._vbArr[e] =
                    this._vb, this._ib = new f["default"].IndexBuffer(this._batcher._device, f["default"].INDEX_FMT_UINT16, f["default"].USAGE_STATIC, new ArrayBuffer, 0), this._ibArr[e] = this._ib)
            },
            checkAndSwitchBuffer: function(e) {
                65535 < this.vertexOffset + e && (this.uploadData(), this._batcher._flush(), this.switchBuffer())
            },
            requestStatic: function(e, b) {
                this.checkAndSwitchBuffer(e);
                var k = this.byteOffset + e * this._vertexBytes,
                    c = this.indiceOffset + b,
                    a = this._vData.byteLength,
                    d = this._iData.length;
                if (k > a || c > d) {
                    for (; a < k || d < c;) this._initVDataCount *=
                        2, this._initIDataCount *= 2, a = 4 * this._initVDataCount, d = this._initIDataCount;
                    this._reallocBuffer()
                }
                this._updateOffset(e, b, k)
            },
            _updateOffset: function(e, b, k) {
                var c = this._offsetInfo;
                c.vertexOffset = this.vertexOffset;
                this.vertexOffset += e;
                c.indiceOffset = this.indiceOffset;
                this.indiceOffset += b;
                c.byteOffset = this.byteOffset;
                this.byteOffset = k;
                this._dirty = !0
            },
            request: function(e, b) {
                this._batcher._buffer !== this && (this._batcher._flush(), this._batcher._buffer = this);
                this.requestStatic(e, b);
                return this._offsetInfo
            },
            _reallocBuffer: function() {
                this._reallocVData(!0);
                this._reallocIData(!0)
            },
            _reallocVData: function(e) {
                var b;
                this._vData && (b = new Uint8Array(this._vData.buffer));
                this._vData = new Float32Array(this._initVDataCount);
                this._uintVData = new Uint32Array(this._vData.buffer);
                var k = new Uint8Array(this._uintVData.buffer);
                if (b && e) {
                    e = 0;
                    for (var c = b.length; e < c; e++) k[e] = b[e]
                }
            },
            _reallocIData: function(e) {
                var b = this._iData;
                this._iData = new Uint16Array(this._initIDataCount);
                if (b && e) {
                    e = this._iData;
                    for (var k = 0, c = b.length; k < c; k++) e[k] = b[k]
                }
            },
            reset: function() {
                this._arrOffset =
                    0;
                this._vb = this._vbArr[0];
                this._ib = this._ibArr[0];
                this.indiceStart = this.vertexOffset = this.indiceOffset = this.byteOffset = 0;
                this._dirty = !1
            },
            destroy: function() {
                this.reset();
                for (var e = 0; e < this._vbArr.length; e++) this._vbArr[e].destroy();
                this._vbArr = null;
                for (e = 0; e < this._ibArr.length; e++) this._ibArr[e].destroy();
                this._vb = this._ib = this._ibArr = null
            },
            forwardIndiceStartToOffset: function() {
                this.indiceStart = this.indiceOffset
            }
        });
        h && (m.prototype.checkAndSwitchBuffer = function(e) {
            65535 < this.vertexOffset + e && (this.uploadData(),
                this._batcher._flush())
        }, m.prototype.forwardIndiceStartToOffset = function() {
            this.uploadData();
            this.switchBuffer()
        });
        cc.MeshBuffer = q.exports = m
    }, {
        "../../../renderer/gfx": 334
    }],
    271: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }
        var e = f(h("../../../renderer/core/input-assembler")),
            b = f(h("../../../renderer/memop/recycle-pool")),
            k = f(h("../../../renderer/scene/model"));
        m = h("./vertex-format");
        var c = m.vfmtPosUvColor,
            a = m.vfmt3D,
            d = h("./quad-buffer"),
            l = h("./mesh-buffer"),
            g = h("./spine-buffer");
        m = h("../../assets/material/CCMaterial");
        new(h("../../platform/id-generater"))("VertextFormat");
        var n = {},
            w = new m,
            t = new e["default"];
        t._count = 0;
        h = function(d, g) {
            this._renderScene = g;
            this._device = d;
            this.walking = !1;
            this.material = w;
            this.cullingMask = 1;
            this._iaPool = new b["default"](function() {
                return new e["default"]
            }, 16);
            this._modelPool = new b["default"](function() {
                return new k["default"]
            }, 16);
            this._quadBuffer = this.getBuffer("quad", c);
            this._meshBuffer = this.getBuffer("mesh", c);
            this._quadBuffer3D = this.getBuffer("quad",
                a);
            this._meshBuffer3D = this.getBuffer("mesh", a);
            this._buffer = this._meshBuffer;
            this._batchedModels = [];
            this._dummyNode = new cc.Node;
            this._sortKey = 0;
            this.node = this._dummyNode;
            this.parentOpacity = 1;
            this.worldMatDirty = this.parentOpacityDirty = 0
        };
        h.prototype = {
            constructor: h,
            reset: function() {
                this._iaPool.reset();
                for (var a = this._renderScene, b = this._batchedModels, c = 0; c < b.length; ++c) b[c].setInputAssembler(null), b[c].setEffect(null), a.removeModel(b[c]);
                this._modelPool.reset();
                this._sortKey = b.length = 0;
                for (var d in n) n[d].reset();
                this._buffer = this._meshBuffer;
                this.node = this._dummyNode;
                this.material = w;
                this.parentOpacity = this.cullingMask = 1;
                this.worldMatDirty = this.parentOpacityDirty = 0
            },
            _flushMaterial: function(a) {
                if (a && (this.material = a, a = a.effect)) {
                    var b = this._modelPool.add();
                    this._batchedModels.push(b);
                    b.sortKey = this._sortKey++;
                    b._cullingMask = this.cullingMask;
                    b.setNode(this.node);
                    b.setEffect(a, null);
                    b.setInputAssembler(t);
                    this._renderScene.addModel(b)
                }
            },
            _flush: function() {
                var a = this.material,
                    b = this._buffer,
                    c = b.indiceOffset - b.indiceStart;
                if (this.walking && a && !(0 >= c) && (a = a.effect)) {
                    var d = this._iaPool.add();
                    d._vertexBuffer = b._vb;
                    d._indexBuffer = b._ib;
                    d._start = b.indiceStart;
                    d._count = c;
                    c = this._modelPool.add();
                    this._batchedModels.push(c);
                    c.sortKey = this._sortKey++;
                    c._cullingMask = this.cullingMask;
                    c.setNode(this.node);
                    c.setEffect(a);
                    c.setInputAssembler(d);
                    this._renderScene.addModel(c);
                    b.forwardIndiceStartToOffset()
                }
            },
            _flushIA: function(a) {
                if (a) {
                    var b = this.material.effect;
                    if (b) {
                        var c = this._modelPool.add();
                        this._batchedModels.push(c);
                        c.sortKey =
                            this._sortKey++;
                        c._cullingMask = this.cullingMask;
                        c.setNode(this.node);
                        c.setEffect(b);
                        c.setInputAssembler(a);
                        this._renderScene.addModel(c)
                    }
                }
            },
            terminate: function() {
                cc.dynamicAtlasManager && cc.dynamicAtlasManager.enabled && cc.dynamicAtlasManager.update();
                this._flush();
                for (var a in n) n[a].uploadData();
                this.walking = !1
            },
            getBuffer: function(a, b) {
                var c = a + b.getHash(),
                    e = n[c];
                if (!e) {
                    if ("mesh" === a) e = new l(this, b);
                    else if ("quad" === a) e = new d(this, b);
                    else {
                        if ("spine" !== a) return cc.error("Not support buffer type [" + a +
                            "]"), null;
                        e = new g(this, b)
                    }
                    n[c] = e
                }
                return e
            }
        };
        q.exports = h
    }, {
        "../../../renderer/core/input-assembler": 324,
        "../../../renderer/memop/recycle-pool": 349,
        "../../../renderer/scene/model": 356,
        "../../assets/material/CCMaterial": 91,
        "../../platform/id-generater": 221,
        "./mesh-buffer": 270,
        "./quad-buffer": 272,
        "./spine-buffer": 274,
        "./vertex-format": 275
    }],
    272: [function(h, q, m) {
        h = h("./mesh-buffer");
        h = cc.Class({
            name: "cc.QuadBuffer",
            extends: h,
            _fillQuadBuffer: function() {
                for (var f = this._initIDataCount / 6, e = this._iData, b = 0,
                        k = 0; b < f; b++) {
                    var c = 4 * b;
                    e[k++] = c;
                    e[k++] = c + 1;
                    e[k++] = c + 2;
                    e[k++] = c + 1;
                    e[k++] = c + 3;
                    e[k++] = c + 2
                }
                f = new Uint16Array(this._iData.buffer, 0, 6 * f);
                this._ib.update(0, f)
            },
            uploadData: function() {
                if (0 !== this.byteOffset && this._dirty) {
                    var f = new Float32Array(this._vData.buffer, 0, this.byteOffset >> 2);
                    this._vb.update(0, f);
                    this._dirty = !1
                }
            },
            switchBuffer: function() {
                this._super();
                var f = new Uint16Array(this._iData.buffer, 0, this._initIDataCount);
                this._ib.update(0, f)
            },
            _reallocBuffer: function() {
                this._reallocVData(!0);
                this._reallocIData();
                this._fillQuadBuffer()
            }
        });
        cc.QuadBuffer = q.exports = h
    }, {
        "./mesh-buffer": 270
    }],
    273: [function(h, q, m) {
        function f() {
            this.vDatas = [];
            this.uintVDatas = [];
            this.iDatas = [];
            this.meshCount = 0;
            this._flexBuffer = this._infos = null
        }
        m.__esModule = !0;
        m["default"] = f;
        var e = function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("./flex-buffer")),
            b = h("./vertex-format");
        cc.js.mixin(f.prototype, {
            init: function(b) {},
            clear: function() {
                this.vDatas.length = 0;
                this.iDatas.length = 0;
                this.meshCount = this.uintVDatas.length = 0;
                this._infos = null;
                this._flexBuffer &&
                    this._flexBuffer.reset()
            },
            updateMesh: function(b, c, a) {
                this.vDatas[b] = c;
                this.uintVDatas[b] = new Uint32Array(c.buffer, 0, c.length);
                this.iDatas[b] = a;
                this.meshCount = this.vDatas.length
            },
            updateMeshRange: function(b, c) {},
            createData: function(b, c, a) {
                c = new Float32Array(c);
                a = new Uint16Array(a);
                this.updateMesh(b, c, a)
            },
            createQuadData: function(b, c, a) {
                this.createData(b, c, a);
                this.initQuadIndices(this.iDatas[b])
            },
            createFlexData: function(k, c, a, d) {
                d = d || b.vfmtPosUvColor;
                this._flexBuffer = new e["default"](this, k, c, a, d)
            },
            initQuadIndices: function(b) {
                for (var c =
                        b.length / 6, a = 0, d = 0; a < c; a++) {
                    var e = 4 * a;
                    b[d++] = e;
                    b[d++] = e + 1;
                    b[d++] = e + 2;
                    b[d++] = e + 1;
                    b[d++] = e + 3;
                    b[d++] = e + 2
                }
            }
        });
        cc.RenderData = f;
        q.exports = m["default"]
    }, {
        "./flex-buffer": 269,
        "./vertex-format": 275
    }],
    274: [function(h, q, m) {
        h = cc.Class({
            name: "cc.SpineBuffer",
            extends: h("./mesh-buffer"),
            requestStatic: function(f, e) {
                this.checkAndSwitchBuffer(f);
                f = this.byteOffset + f * this._vertexBytes;
                e = this.indiceOffset + e;
                var b = this._vData.byteLength,
                    k = this._iData.length;
                if (f > b || e > k) {
                    for (; b < f || k < e;) this._initVDataCount *= 2, this._initIDataCount *=
                        2, b = 4 * this._initVDataCount, k = this._initIDataCount;
                    this._reallocBuffer()
                }
                f = this._offsetInfo;
                f.vertexOffset = this.vertexOffset;
                f.indiceOffset = this.indiceOffset;
                f.byteOffset = this.byteOffset
            },
            adjust: function(f, e) {
                this.vertexOffset += f;
                this.indiceOffset += e;
                this.byteOffset += f * this._vertexBytes;
                this._dirty = !0
            }
        });
        cc.SpineBuffer = q.exports = h
    }, {
        "./mesh-buffer": 270
    }],
    275: [function(h, q, m) {
        h = (h = h("../../../renderer/gfx")) && h.__esModule ? h : {
            default: h
        };
        m = new h["default"].VertexFormat([{
            name: h["default"].ATTR_POSITION,
            type: h["default"].ATTR_TYPE_FLOAT32,
            num: 3
        }, {
            name: h["default"].ATTR_UV0,
            type: h["default"].ATTR_TYPE_FLOAT32,
            num: 2
        }, {
            name: h["default"].ATTR_COLOR,
            type: h["default"].ATTR_TYPE_UINT8,
            num: 4,
            normalize: !0
        }]);
        m.name = "vfmt3D";
        h["default"].VertexFormat.XYZ_UV_Color = m;
        var f = new h["default"].VertexFormat([{
            name: h["default"].ATTR_POSITION,
            type: h["default"].ATTR_TYPE_FLOAT32,
            num: 2
        }, {
            name: h["default"].ATTR_UV0,
            type: h["default"].ATTR_TYPE_FLOAT32,
            num: 2
        }, {
            name: h["default"].ATTR_COLOR,
            type: h["default"].ATTR_TYPE_UINT8,
            num: 4,
            normalize: !0
        }]);
        f.name = "vfmtPosUvColor";
        h["default"].VertexFormat.XY_UV_Color = f;
        var e = new h["default"].VertexFormat([{
            name: h["default"].ATTR_POSITION,
            type: h["default"].ATTR_TYPE_FLOAT32,
            num: 2
        }, {
            name: h["default"].ATTR_UV0,
            type: h["default"].ATTR_TYPE_FLOAT32,
            num: 2
        }, {
            name: h["default"].ATTR_COLOR,
            type: h["default"].ATTR_TYPE_UINT8,
            num: 4,
            normalize: !0
        }, {
            name: h["default"].ATTR_COLOR0,
            type: h["default"].ATTR_TYPE_UINT8,
            num: 4,
            normalize: !0
        }]);
        e.name = "vfmtPosUvTwoColor";
        h["default"].VertexFormat.XY_UV_Two_Color =
            e;
        var b = new h["default"].VertexFormat([{
            name: h["default"].ATTR_POSITION,
            type: h["default"].ATTR_TYPE_FLOAT32,
            num: 2
        }, {
            name: h["default"].ATTR_UV0,
            type: h["default"].ATTR_TYPE_FLOAT32,
            num: 2
        }]);
        b.name = "vfmtPosUv";
        h["default"].VertexFormat.XY_UV = b;
        var k = new h["default"].VertexFormat([{
            name: h["default"].ATTR_POSITION,
            type: h["default"].ATTR_TYPE_FLOAT32,
            num: 2
        }, {
            name: h["default"].ATTR_COLOR,
            type: h["default"].ATTR_TYPE_UINT8,
            num: 4,
            normalize: !0
        }]);
        k.name = "vfmtPosColor";
        h["default"].VertexFormat.XY_Color = k;
        var c =
            new h["default"].VertexFormat([{
                name: h["default"].ATTR_POSITION,
                type: h["default"].ATTR_TYPE_FLOAT32,
                num: 2
            }]);
        c.name = "vfmtPos";
        h["default"].VertexFormat.XY = c;
        q.exports = {
            vfmt3D: m,
            vfmtPosUvColor: f,
            vfmtPosUvTwoColor: e,
            vfmtPosUv: b,
            vfmtPosColor: k,
            vfmtPos: c
        }
    }, {
        "../../../renderer/gfx": 334
    }],
    276: [function(h, q, m) {
        h("../platform/CCSys");
        var f = /(\.[^\.\/\?\\]*)(\?.*)?$/,
            e = /((.*)(\/|\\|\\\\))?(.*?\..*$)?/,
            b = /[^\.\/]+\/\.\.\//;
        cc.path = {
            join: function() {
                for (var b = arguments.length, c = "", a = 0; a < b; a++) c = (c + ("" === c ? "" :
                    "/") + arguments[a]).replace(/(\/|\\\\)$/, "");
                return c
            },
            extname: function(b) {
                return (b = f.exec(b)) ? b[1] : ""
            },
            mainFileName: function(b) {
                if (b) {
                    var c = b.lastIndexOf(".");
                    if (-1 !== c) return b.substring(0, c)
                }
                return b
            },
            basename: function(b, c) {
                var a = b.indexOf("?");
                0 < a && (b = b.substring(0, a));
                a = /(\/|\\)([^\/\\]+)$/g.exec(b.replace(/(\/|\\)$/, ""));
                if (!a) return b;
                a = a[2];
                return c && b.substring(b.length - c.length).toLowerCase() === c.toLowerCase() ? a.substring(0, a.length - c.length) : a
            },
            dirname: function(b) {
                return (b = e.exec(b)) ? b[2] :
                    ""
            },
            changeExtname: function(b, c) {
                c = c || "";
                var a = b.indexOf("?"),
                    d = "";
                0 < a && (d = b.substring(a), b = b.substring(0, a));
                a = b.lastIndexOf(".");
                return 0 > a ? b + c + d : b.substring(0, a) + c + d
            },
            changeBasename: function(b, c, a) {
                if (0 === c.indexOf(".")) return this.changeExtname(b, c);
                var d = b.indexOf("?"),
                    e = "";
                a = a ? this.extname(b) : "";
                0 < d && (e = b.substring(d), b = b.substring(0, d));
                d = b.lastIndexOf("/");
                return b.substring(0, 0 >= d ? 0 : d + 1) + c + a + e
            },
            _normalize: function(e) {
                e = String(e);
                do {
                    var c = e;
                    e = e.replace(b, "")
                } while (c.length !== e.length);
                return e
            },
            sep: cc.sys.os === cc.sys.OS_WINDOWS ? "\\" : "/",
            stripSep: function(b) {
                return b.replace(/[\/\\]$/, "")
            }
        };
        q.exports = cc.path
    }, {
        "../platform/CCSys": 213
    }],
    277: [function(h, q, m) {
        h = function(f, e, b, k, c, a) {
            this.a = f;
            this.b = e;
            this.c = b;
            this.d = k;
            this.tx = c;
            this.ty = a
        };
        h.create = function(f, e, b, k, c, a) {
            return {
                a: f,
                b: e,
                c: b,
                d: k,
                tx: c,
                ty: a
            }
        };
        h.identity = function() {
            return {
                a: 1,
                b: 0,
                c: 0,
                d: 1,
                tx: 0,
                ty: 0
            }
        };
        h.clone = function(f) {
            return {
                a: f.a,
                b: f.b,
                c: f.c,
                d: f.d,
                tx: f.tx,
                ty: f.ty
            }
        };
        h.concat = function(f, e, b) {
            var k = e.a,
                c = e.b,
                a = e.c,
                d = e.d,
                l = e.tx;
            e = e.ty;
            f.a = k * b.a + c * b.c;
            f.b = k * b.b + c * b.d;
            f.c = a * b.a + d * b.c;
            f.d = a * b.b + d * b.d;
            f.tx = l * b.a + e * b.c + b.tx;
            f.ty = l * b.b + e * b.d + b.ty;
            return f
        };
        h.invert = function(f, e) {
            var b = e.a,
                k = e.b,
                c = e.c,
                a = e.d,
                d = 1 / (b * a - k * c),
                l = e.tx;
            e = e.ty;
            f.a = d * a;
            f.b = -d * k;
            f.c = -d * c;
            f.d = d * b;
            f.tx = d * (c * e - a * l);
            f.ty = d * (k * l - b * e);
            return f
        };
        h.fromMat4 = function(f, e) {
            e = e.m;
            f.a = e[0];
            f.b = e[1];
            f.c = e[4];
            f.d = e[5];
            f.tx = e[12];
            f.ty = e[13];
            return f
        };
        h.transformVec2 = function(f, e, b, k) {
            if (void 0 === k) {
                k = b;
                var c = e.x;
                e = e.y
            } else c = e, e = b;
            f.x = k.a * c + k.c * e + k.tx;
            f.y = k.b * c + k.d * e + k.ty;
            return f
        };
        h.transformSize = function(f, e, b) {
            f.width = b.a * e.width + b.c * e.height;
            f.height = b.b * e.width + b.d * e.height;
            return f
        };
        h.transformRect = function(f, e, b) {
            var k = e.x,
                c = e.y,
                a = k + e.width,
                d = c + e.height,
                l = b.a * k + b.c * c + b.tx;
            e = b.b * k + b.d * c + b.ty;
            var g = b.a * a + b.c * c + b.tx;
            c = b.b * a + b.d * c + b.ty;
            var n = b.a * k + b.c * d + b.tx;
            k = b.b * k + b.d * d + b.ty;
            var h = b.a * a + b.c * d + b.tx;
            a = b.b * a + b.d * d + b.ty;
            b = Math.min(l, g, n, h);
            l = Math.max(l, g, n, h);
            g = Math.min(e, c, k, a);
            e = Math.max(e, c, k, a);
            f.x = b;
            f.y = g;
            f.width = l - b;
            f.height = e - g;
            return f
        };
        h.transformObb = function(f, e,
            b, k, c, a) {
            var d = c.x,
                l = c.y,
                g = c.width,
                n = c.height;
            c = a.a * d + a.c * l + a.tx;
            d = a.b * d + a.d * l + a.ty;
            l = a.a * g;
            g *= a.b;
            var h = a.c * n;
            a = a.d * n;
            e.x = c;
            e.y = d;
            b.x = l + c;
            b.y = g + d;
            f.x = h + c;
            f.y = a + d;
            k.x = l + h + c;
            k.y = g + a + d
        };
        cc.AffineTransform = q.exports = h
    }, {}],
    278: [function(h, q, m) {
        function f(a) {
            return a ? "string" === typeof a ? d.getClassByName(a) : a : (cc.errorID(3804), null)
        }

        function e(a, b) {
            if (b._sealed)
                for (var c = 0; c < a._components.length; ++c) {
                    var d = a._components[c];
                    if (d.constructor === b) return d
                } else
                    for (c = 0; c < a._components.length; ++c)
                        if (d = a._components[c],
                            d instanceof b) return d;
            return null
        }

        function b(a, b, c) {
            if (b._sealed)
                for (var d = 0; d < a._components.length; ++d) {
                    var g = a._components[d];
                    g.constructor === b && c.push(g)
                } else
                    for (d = 0; d < a._components.length; ++d) g = a._components[d], g instanceof b && c.push(g)
        }

        function k(a, b) {
            for (var c = 0; c < a.length; ++c) {
                var d = a[c],
                    g = e(d, b);
                if (g || 0 < d._children.length && (g = k(d._children, b))) return g
            }
            return null
        }

        function c(a, d, g) {
            for (var e = 0; e < a.length; ++e) {
                var l = a[e];
                b(l, d, g);
                0 < l._children.length && c(l._children, d, g)
            }
        }
        var a = h("../platform/CCObject").Flags;
        m = h("./misc");
        var d = h("../platform/js"),
            l = h("../platform/id-generater"),
            g = h("../event-manager"),
            n = h("../renderer/render-flow"),
            w = a.Destroying,
            t = a.DontDestroy,
            p = a.Deactivating,
            u = new l("Node");
        h = cc.Class({
            name: "cc._BaseNode",
            extends: cc.Object,
            properties: {
                _parent: null,
                _children: [],
                _active: !0,
                _components: [],
                _prefab: null,
                _persistNode: {
                    get: function() {
                        return 0 < (this._objFlags & t)
                    },
                    set: function(a) {
                        a ? this._objFlags |= t : this._objFlags &= ~t
                    }
                },
                name: {
                    get: function() {
                        return this._name
                    },
                    set: function(a) {
                        !1;
                        this._name =
                            a;
                        !1
                    }
                },
                uuid: {
                    get: function() {
                        return this._id
                    }
                },
                children: {
                    get: function() {
                        return this._children
                    }
                },
                childrenCount: {
                    get: function() {
                        return this._children.length
                    }
                },
                active: {
                    get: function() {
                        return this._active
                    },
                    set: function(a) {
                        a = !!a;
                        if (this._active !== a) {
                            this._active = a;
                            var b = this._parent;
                            b && b._activeInHierarchy && cc.director._nodeActivator.activateNode(this, a)
                        }
                    }
                },
                activeInHierarchy: {
                    get: function() {
                        return this._activeInHierarchy
                    }
                }
            },
            ctor: function(a) {
                this._name = void 0 !== a ? a : "New Node";
                this._activeInHierarchy = !1;
                this._id =
                    u.getNewId();
                cc.director._scheduler && cc.director._scheduler.enableForTarget(this);
                this.__eventTargets = []
            },
            getParent: function() {
                return this._parent
            },
            setParent: function(a) {
                if (this._parent !== a) {
                    !1;
                    var b = this._parent;
                    (!0, b) && b._objFlags & p && cc.errorID(3821);
                    this._parent = a || null;
                    this._onSetParent(a);
                    a && ((!0, a._objFlags & p) && cc.errorID(3821), g._setDirtyForNode(this), a._children.push(this), a.emit && a.emit("child-added", this), a._renderFlag |= n.FLAG_CHILDREN);
                    b ? b._objFlags & w || (a = b._children.indexOf(this), !1, b._children.splice(a,
                        1), b.emit && b.emit("child-removed", this), this._onHierarchyChanged(b), 0 === b._children.length && (b._renderFlag &= ~n.FLAG_CHILDREN)) : a && this._onHierarchyChanged(null)
                }
            },
            attr: function(a) {
                d.mixin(this, a)
            },
            getChildByUuid: function(a) {
                if (!a) return cc.log("Invalid uuid"), null;
                for (var b = this._children, c = 0, d = b.length; c < d; c++)
                    if (b[c]._id === a) return b[c];
                return null
            },
            getChildByName: function(a) {
                if (!a) return cc.log("Invalid name"), null;
                for (var b = this._children, c = 0, d = b.length; c < d; c++)
                    if (b[c]._name === a) return b[c];
                return null
            },
            addChild: function(a) {
                !1;
                cc.assertID(a, 1606);
                cc.assertID(null === a._parent, 1605);
                a.setParent(this)
            },
            insertChild: function(a, b) {
                a.parent = this;
                a.setSiblingIndex(b)
            },
            getSiblingIndex: function() {
                return this._parent ? this._parent._children.indexOf(this) : 0
            },
            setSiblingIndex: function(a) {
                if (this._parent)
                    if (this._parent._objFlags & p) cc.errorID(3821);
                    else {
                        var b = this._parent._children;
                        a = -1 !== a ? a : b.length - 1;
                        var c = b.indexOf(this);
                        a !== c && (b.splice(c, 1), a < b.length ? b.splice(a, 0, this) : b.push(this), this._onSiblingIndexChanged &&
                            this._onSiblingIndexChanged(a))
                    }
            },
            walk: function(a, b) {
                var c = cc._BaseNode,
                    d = 1,
                    g, e, l = c._stacks[c._stackId];
                l || (l = [], c._stacks.push(l));
                c._stackId++;
                l.length = 0;
                l[0] = this;
                var k = null;
                for (e = !1; d;)
                    if (d--, g = l[d])
                        if (!e && a ? a(g) : e && b && b(g), l[d] = null, e) {
                            if (k === this._parent) break;
                            e = !1;
                            if (f)
                                if (n++, f[n]) l[d] = f[n], d++;
                                else if (k) {
                                l[d] = k;
                                d++;
                                e = !0;
                                if (k._parent) {
                                    var f = k._parent._children;
                                    var n = f.indexOf(k);
                                    k = k._parent
                                } else f = k = null;
                                if (0 > n) break
                            }
                        } else 0 < g._children.length ? (k = g, f = g._children, n = 0, l[d] = f[n], d++) : (l[d] = g,
                            d++, e = !0);
                l.length = 0;
                c._stackId--
            },
            cleanup: function() {},
            removeFromParent: function(a) {
                this._parent && (void 0 === a && (a = !0), this._parent.removeChild(this, a))
            },
            removeChild: function(a, b) {
                -1 < this._children.indexOf(a) && ((b || void 0 === b) && a.cleanup(), a.parent = null)
            },
            removeAllChildren: function(a) {
                var b = this._children;
                void 0 === a && (a = !0);
                for (var c = b.length - 1; 0 <= c; c--) {
                    var d = b[c];
                    d && (a && d.cleanup(), d.parent = null)
                }
                this._children.length = 0
            },
            isChildOf: function(a) {
                var b = this;
                do {
                    if (b === a) return !0;
                    b = b._parent
                } while (b);
                return !1
            },
            getComponent: function(a) {
                return (a = f(a)) ? e(this, a) : null
            },
            getComponents: function(a) {
                a = f(a);
                var c = [];
                a && b(this, a, c);
                return c
            },
            getComponentInChildren: function(a) {
                return (a = f(a)) ? k(this._children, a) : null
            },
            getComponentsInChildren: function(a) {
                a = f(a);
                var d = [];
                a && (b(this, a, d), c(this._children, a, d));
                return d
            },
            _checkMultipleComp: (!1, !1),
            addComponent: function(a) {
                !1;
                if ("string" === typeof a) {
                    var b = d.getClassByName(a);
                    if (!b) return cc.errorID(3807, a), cc._RFpeek() && cc.errorID(3808, a), null
                } else {
                    if (!a) return cc.errorID(3804),
                        null;
                    b = a
                }
                if ("function" !== typeof b) return cc.errorID(3809), null;
                if (!d.isChildClassOf(b, cc.Component)) return cc.errorID(3810), null;
                !1;
                if ((a = b._requireComponent) && !this.getComponent(a) && !this.addComponent(a)) return null;
                b = new b;
                b.node = this;
                this._components.push(b);
                !1;
                this._activeInHierarchy && cc.director._nodeActivator.activateComp(b);
                return b
            },
            _addComponentAt: !1,
            removeComponent: function(a) {
                a ? (a instanceof cc.Component || (a = this.getComponent(a)), a && a.destroy()) : cc.errorID(3813)
            },
            _getDependComponent: !1,
            _removeComponent: function(a) {
                if (!a) cc.errorID(3814);
                else if (!(this._objFlags & w)) {
                    var b = this._components.indexOf(a); - 1 !== b ? (this._components.splice(b, 1), !1) : a.node !== this && cc.errorID(3815)
                }
            },
            destroy: function() {
                cc.Object.prototype.destroy.call(this) && (this.active = !1)
            },
            destroyAllChildren: function() {
                for (var a = this._children, b = 0; b < a.length; ++b) a[b].destroy()
            },
            _onSetParent: function(a) {},
            _onPostActivated: function() {},
            _onBatchCreated: function(a) {},
            _onHierarchyChanged: function(a) {
                a = this._parent;
                !this._persistNode ||
                    a instanceof cc.Scene || (cc.game.removePersistRootNode(this), !1);
                !1;
                !1;
                a = this._active && !(!a || !a._activeInHierarchy);
                this._activeInHierarchy !== a && cc.director._nodeActivator.activateNode(this, a)
            },
            _instantiate: function(a, b) {
                a || (a = cc.instantiate._clone(this, this));
                !1;
                !1;
                a._parent = null;
                a._onBatchCreated(b);
                return a
            },
            _registerIfAttached: (!1, !1),
            _onPreDestroy: function() {
                var a;
                this._objFlags |= w;
                var b = this._parent,
                    c = b && b._objFlags & w;
                !c && !1;
                var d = this._children;
                var g = 0;
                for (a = d.length; g < a; ++g) d[g]._destroyImmediate();
                g = 0;
                for (a = this._components.length; g < a; ++g) this._components[g] ? this._components[g]._destroyImmediate() : console.error("[_onPreDestroy] parent = ", b);
                d = this.__eventTargets;
                g = 0;
                for (a = d.length; g < a; ++g) {
                    var e = d[g];
                    e && e.targetOff(this)
                }
                d.length = 0;
                this._persistNode && cc.game.removePersistRootNode(this);
                !c && b && (g = b._children.indexOf(this), b._children.splice(g, 1), b.emit && b.emit("child-removed", this));
                return c
            },
            onRestore: !1
        });
        h.idGenerater = u;
        h._stacks = [
            []
        ];
        h._stackId = 0;
        h.prototype._onPreDestroyBase = h.prototype._onPreDestroy;
        !1;
        h.prototype._onHierarchyChangedBase = h.prototype._onHierarchyChanged;
        !1;
        m.propertyDefine(h, ["parent", "name", "children", "childrenCount"], {});
        !1;
        cc._BaseNode = q.exports = h
    }, {
        "../event-manager": 149,
        "../platform/CCObject": 210,
        "../platform/id-generater": 221,
        "../platform/js": 225,
        "../renderer/render-flow": 237,
        "./misc": 286
    }],
    279: [function(h, q, m) {
            q.exports = {
                binarySearchEpsilon: function(f, e) {
                    for (var b = 0, k = f.length - 1, c = k >>> 1; b <= k; c = b + k >>> 1) {
                        var a = f[c];
                        if (a > e + 1E-6) k = c - 1;
                        else {
                            if (!(a < e - 1E-6)) return c;
                            b = c + 1
                        }
                    }
                    return ~b
                }
            }
        },
        {}
    ],
    280: [function(h, q, m) {
        var f = h("../components/CCRenderComponent"),
            e = h("../platform/CCMacro").BlendFactor,
            b = h("../../renderer/gfx");
        h = cc.Class({
            properties: {
                _srcBlendFactor: e.SRC_ALPHA,
                _dstBlendFactor: e.ONE_MINUS_SRC_ALPHA,
                srcBlendFactor: {
                    get: function() {
                        return this._srcBlendFactor
                    },
                    set: function(b) {
                        this._srcBlendFactor !== b && (this._srcBlendFactor = b, this._updateBlendFunc(!0), this._onBlendChanged && this._onBlendChanged())
                    },
                    animatable: !1,
                    type: e,
                    tooltip: !1,
                    visible: !0
                },
                dstBlendFactor: {
                    get: function() {
                        return this._dstBlendFactor
                    },
                    set: function(b) {
                        this._dstBlendFactor !== b && (this._dstBlendFactor = b, this._updateBlendFunc(!0))
                    },
                    animatable: !1,
                    type: e,
                    tooltip: !1,
                    visible: !0
                }
            },
            setMaterial: function(b, c) {
                b = f.prototype.setMaterial.call(this, b, c);
                this._srcBlendFactor === e.SRC_ALPHA && this._dstBlendFactor === e.ONE_MINUS_SRC_ALPHA || this._updateMaterialBlendFunc(b);
                return b
            },
            _updateMaterial: function() {
                this._updateBlendFunc()
            },
            _updateBlendFunc: function(b) {
                if (b || this._srcBlendFactor !== e.SRC_ALPHA || this._dstBlendFactor !== e.ONE_MINUS_SRC_ALPHA) {
                    b =
                        this.getMaterials();
                    for (var c = 0; c < b.length; c++) this._updateMaterialBlendFunc(b[c])
                }
            },
            _updateMaterialBlendFunc: function(e) {
                e.setBlend(!0, b.BLEND_FUNC_ADD, this._srcBlendFactor, this._dstBlendFactor, b.BLEND_FUNC_ADD, this._srcBlendFactor, this._dstBlendFactor)
            }
        });
        q.exports = cc.BlendFunc = h
    }, {
        "../../renderer/gfx": 334,
        "../components/CCRenderComponent": 126,
        "../platform/CCMacro": 209
    }],
    281: [function(h, q, m) {
        var f = h("./misc").BASE64_VALUES,
            e = "0123456789abcdef".split("");
        h = ["", "", "", ""];
        var b = h.concat(h, "-", h, "-",
                h, "-", h, "-", h, h, h),
            k = b.map(function(b, a) {
                return "-" === b ? NaN : a
            }).filter(isFinite);
        q.exports = function(c) {
            if (22 !== c.length) return c;
            b[0] = c[0];
            b[1] = c[1];
            for (var a = 2, d = 2; 22 > a; a += 2) {
                var l = f[c.charCodeAt(a)],
                    g = f[c.charCodeAt(a + 1)];
                b[k[d++]] = e[l >> 2];
                b[k[d++]] = e[(3 & l) << 2 | g >> 4];
                b[k[d++]] = e[15 & g]
            }
            return b.join("")
        };
        !1
    }, {
        "./misc": 286
    }],
    282: [function(h, q, m) {
        cc.find = q.exports = function(f, e) {
            if (null == f) return cc.errorID(3814), null;
            if (!e && (e = cc.director.getScene(), !e)) return !1, null;
            !1;
            var b = "/" !== f[0] ? 0 : 1;
            for (f = f.split("/"); b <
                f.length; b++) {
                var k = f[b],
                    c = e._children;
                e = null;
                for (var a = 0, d = c.length; a < d; ++a) {
                    var l = c[a];
                    if (l.name === k) {
                        e = l;
                        break
                    }
                }
                if (!e) return null
            }
            return e
        }
    }, {}],
    283: [function(h, q, m) {
        var f = function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("../assets/material/material-variant")),
            e = h("../assets/material/CCMaterial");
        h = cc.Class({
            properties: {
                _normalMaterial: null,
                normalMaterial: {
                    get: function() {
                        return this._normalMaterial
                    },
                    set: function(b) {
                        this._normalMaterial = b;
                        this._updateDisabledState && this._updateDisabledState()
                    },
                    type: e,
                    tooltip: !1,
                    animatable: !1
                },
                _grayMaterial: null,
                grayMaterial: {
                    get: function() {
                        return this._grayMaterial
                    },
                    set: function(b) {
                        this._grayMaterial = b;
                        this._updateDisabledState && this._updateDisabledState()
                    },
                    type: e,
                    tooltip: !1,
                    animatable: !1
                }
            },
            _switchGrayMaterial: function(b, k) {
                b ? ((b = this._grayMaterial) || (b = e.getBuiltinMaterial("2d-gray-sprite")), b = this._grayMaterial = f["default"].create(b, k)) : ((b = this._normalMaterial) || (b = e.getBuiltinMaterial("2d-sprite", k)), b = this._normalMaterial = f["default"].create(b, k));
                k.setMaterial(0, b)
            }
        });
        q.exports = h
    }, {
        "../assets/material/CCMaterial": 91,
        "../assets/material/material-variant": 98
    }],
    284: [function(h, q, m) {
        var f = /^(click)(\s)*=|(param)(\s)*=/,
            e = /(\s)*src(\s)*=|(\s)*height(\s)*=|(\s)*width(\s)*=|(\s)*align(\s)*=|(\s)*offset(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/;
        h = function() {
            this._parsedObject = {};
            this._specialSymbolArray = [];
            this._specialSymbolArray.push([/&lt;/g, "<"]);
            this._specialSymbolArray.push([/&gt;/g, ">"]);
            this._specialSymbolArray.push([/&amp;/g, "&"]);
            this._specialSymbolArray.push([/&quot;/g,
                '"'
            ]);
            this._specialSymbolArray.push([/&apos;/g, "'"]);
            this._specialSymbolArray.push([/&nbsp;/g, " "])
        };
        h.prototype = {
            constructor: h,
            parse: function(b) {
                this._resultObjectArray = [];
                this._stack = [];
                for (var e = 0, c = b.length; e < c;) {
                    var a = b.indexOf(">", e),
                        d = -1;
                    0 <= a && (d = b.lastIndexOf("<", a), d < e - 1 && (d = b.indexOf("<", a + 1), a = b.indexOf(">", d + 1)));
                    if (0 > d) this._stack.pop(), this._processResult(b.substring(e)), e = c;
                    else {
                        var l = b.substring(e, d),
                            g = b.substring(d + 1, a);
                        "" === g && (l = b.substring(e, a + 1));
                        this._processResult(l); - 1 === a ?
                            a = d : "/" === b.charAt(d + 1) ? this._stack.pop() : this._addToStack(g);
                        e = a + 1
                    }
                }
                return this._resultObjectArray
            },
            _attributeToObject: function(b) {
                b = b.trim();
                var k = {};
                var c = b.match(/^(color|size)(\s)*=/);
                if (c) {
                    var a = c[0];
                    b = b.substring(a.length).trim();
                    if ("" === b) return k;
                    var d = b.indexOf(" ");
                    switch (a[0]) {
                        case "c":
                            k.color = -1 < d ? b.substring(0, d).trim() : b;
                            break;
                        case "s":
                            k.size = parseInt(b)
                    } - 1 < d && (b = b.substring(d + 1).trim(), b = this._processEventHandler(b), k.event = b);
                    return k
                }
                if ((c = b.match(/^(br(\s)*\/)/)) && 0 < c[0].length &&
                    (a = c[0].trim(), a.startsWith("br") && "/" === a[a.length - 1])) return k.isNewLine = !0, this._resultObjectArray.push({
                    text: "",
                    style: {
                        newline: !0
                    }
                }), k;
                if ((c = b.match(/^(img(\s)*src(\s)*=[^>]+\/)/)) && 0 < c[0].length && (a = c[0].trim(), a.startsWith("img") && "/" === a[a.length - 1])) {
                    c = b.match(e);
                    for (var l = !1; c;) {
                        b = b.substring(b.indexOf(c[0]));
                        a = b.substr(0, c[0].length);
                        b = b.substring(a.length).trim();
                        d = b.indexOf(" ");
                        c = -1 < d ? b.substr(0, d) : b;
                        a = a.replace(/[^a-zA-Z]/g, "").trim();
                        a = a.toLocaleLowerCase();
                        b = b.substring(d).trim();
                        c.endsWith("/") && (c = c.slice(0, -1));
                        if ("src" === a) {
                            switch (c.charCodeAt(0)) {
                                case 34:
                                case 39:
                                    l = !0, c = c.slice(1, -1)
                            }
                            k.isImage = !0;
                            k.src = c
                        } else if ("height" === a) k.imageHeight = parseInt(c);
                        else if ("width" === a) k.imageWidth = parseInt(c);
                        else if ("align" === a) {
                            switch (c.charCodeAt(0)) {
                                case 34:
                                case 39:
                                    c = c.slice(1, -1)
                            }
                            k.imageAlign = c.toLocaleLowerCase()
                        } else "offset" === a ? k.imageOffset = c : "click" === a && (k.event = this._processEventHandler(a + "=" + c));
                        k.event && "param" === a && (k.event.param = c.replace(/^\"|\"$/g, ""));
                        c = b.match(e)
                    }
                    l &&
                        k.isImage && this._resultObjectArray.push({
                            text: "",
                            style: k
                        });
                    return {}
                }
                if (c = b.match(/^(outline(\s)*[^>]*)/)) {
                    b = c[0].substring(7).trim();
                    l = {
                        color: "#ffffff",
                        width: 1
                    };
                    if (b) {
                        var g = /(\s)*color(\s)*=|(\s)*width(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/;
                        for (c = b.match(g); c;) b = b.substring(b.indexOf(c[0])), a = b.substr(0, c[0].length), b = b.substring(a.length).trim(), d = b.indexOf(" "), c = -1 < d ? b.substr(0, d) : b, a = a.replace(/[^a-zA-Z]/g, "").trim(), a = a.toLocaleLowerCase(), b = b.substring(d).trim(), "click" === a ? k.event = this._processEventHandler(a +
                            "=" + c) : "color" === a ? l.color = c : "width" === a && (l.width = parseInt(c)), k.event && "param" === a && (k.event.param = c.replace(/^\"|\"$/g, "")), c = b.match(g)
                    }
                    k.outline = l
                }
                if ((c = b.match(/^(on|u|b|i)(\s)*/)) && 0 < c[0].length) {
                    a = c[0];
                    b = b.substring(a.length).trim();
                    switch (a[0]) {
                        case "u":
                            k.underline = !0;
                            break;
                        case "i":
                            k.italic = !0;
                            break;
                        case "b":
                            k.bold = !0
                    }
                    if ("" === b) return k;
                    b = this._processEventHandler(b);
                    k.event = b
                }
                return k
            },
            _processEventHandler: function(b) {
                for (var e, c = {}, a = b.match(f); a;) {
                    var d = a[0],
                        l = "";
                    a = !1;
                    b = b.substring(d.length).trim();
                    '"' === b.charAt(0) ? (e = b.indexOf('"', 1), -1 < e && (l = b.substring(1, e).trim(), a = !0), e++) : "'" === b.charAt(0) ? (e = b.indexOf("'", 1), -1 < e && (l = b.substring(1, e).trim(), a = !0), e++) : (l = (e = b.match(/(\S)+/)) ? e[0] : "", e = l.length);
                    a && (d = d.substring(0, d.length - 1).trim(), c[d] = l);
                    b = b.substring(e).trim();
                    a = b.match(f)
                }
                return c
            },
            _addToStack: function(b) {
                b = this._attributeToObject(b);
                if (0 !== this._stack.length) {
                    if (b.isNewLine || b.isImage) return;
                    var e = this._stack[this._stack.length - 1],
                        c;
                    for (c in e) b[c] || (b[c] = e[c])
                }
                this._stack.push(b)
            },
            _processResult: function(b) {
                "" !== b && (b = this._escapeSpecialSymbol(b), 0 < this._stack.length ? this._resultObjectArray.push({
                    text: b,
                    style: this._stack[this._stack.length - 1]
                }) : this._resultObjectArray.push({
                    text: b
                }))
            },
            _escapeSpecialSymbol: function(b) {
                for (var e = 0; e < this._specialSymbolArray.length; ++e) b = b.replace(this._specialSymbolArray[e][0], this._specialSymbolArray[e][1]);
                return b
            }
        };
        !1;
        q.exports = h
    }, {}],
    285: [function(h, q, m) {
            h("./CCPath");
            !0;
            h("./profiler/CCProfiler");
            h("./find");
            h("./mutable-forward-iterator")
        },
        {
            "./CCPath": 276,
            "./find": 282,
            "./mutable-forward-iterator": 287,
            "./profiler/CCProfiler": 290
        }
    ],
    286: [function(h, q, m) {
        var f = h("../platform/js");
        h = {
            propertyDefine: function(b, e, c) {
                function a(a, b, c, d) {
                    var g = Object.getOwnPropertyDescriptor(a, b);
                    g ? (g.get && (a[c] = g.get), g.set && d && (a[d] = g.set)) : (c = a[c], !1, f.getset(a, b, c, a[d]))
                }
                b = b.prototype;
                for (var d = 0; d < e.length; d++) {
                    var l = e[d];
                    var g = l[0].toUpperCase() + l.slice(1);
                    a(b, l, "get" + g, "set" + g)
                }
                for (l in c) e = c[l], a(b, l, e[0], e[1])
            },
            NextPOT: function(b) {
                --b;
                b |= b >> 1;
                b |= b >>
                    2;
                b |= b >> 4;
                b |= b >> 8;
                return (b | b >> 16) + 1
            }
        };
        !1;
        h.BUILTIN_CLASSID_RE = /^(?:cc|dragonBones|sp|ccsg)\..+/;
        m = Array(123);
        for (var e = 0; 123 > e; ++e) m[e] = 64;
        for (e = 0; 64 > e; ++e) m["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charCodeAt(e)] = e;
        h.BASE64_VALUES = m;
        h.pushToMap = function(b, e, c, a) {
            var d = b[e];
            d ? Array.isArray(d) ? a ? (d.push(d[0]), d[0] = c) : d.push(c) : b[e] = a ? [c, d] : [d, c] : b[e] = c
        };
        h.clampf = function(b, e, c) {
            if (e > c) {
                var a = e;
                e = c;
                c = a
            }
            return b < e ? e : b < c ? b : c
        };
        h.clamp01 = function(b) {
            return 0 > b ? 0 : 1 > b ? b : 1
        };
        h.lerp =
            function(b, e, c) {
                return b + (e - b) * c
            };
        h.degreesToRadians = function(b) {
            return b * cc.macro.RAD
        };
        h.radiansToDegrees = function(b) {
            return b * cc.macro.DEG
        };
        cc.misc = q.exports = h
    }, {
        "../platform/js": 225
    }],
    287: [function(h, q, m) {
        function f(e) {
            this.i = 0;
            this.array = e
        }
        h = f.prototype;
        h.remove = function(e) {
            e = this.array.indexOf(e);
            0 <= e && this.removeAt(e)
        };
        h.removeAt = function(e) {
            this.array.splice(e, 1);
            e <= this.i && --this.i
        };
        h.fastRemove = function(e) {
            e = this.array.indexOf(e);
            0 <= e && this.fastRemoveAt(e)
        };
        h.fastRemoveAt = function(e) {
            var b =
                this.array;
            b[e] = b[b.length - 1];
            --b.length;
            e <= this.i && --this.i
        };
        h.push = function(e) {
            this.array.push(e)
        };
        q.exports = f
    }, {}],
    288: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        h = function() {
            function f() {
                this.enabled = !1;
                this.count = 0;
                this.maxSize = 1024
            }
            var e = f.prototype;
            e.get = function() {};
            e.put = function() {};
            e.clear = function() {};
            return f
        }();
        m["default"] = h;
        cc.pool = {};
        h.register = function(f, e) {
            cc.pool[f] = e
        };
        q.exports = m["default"]
    }, {}],
    289: [function(h, q, m) {
        cc._PrefabInfo = cc.Class({
            name: "cc.PrefabInfo",
            properties: {
                root: null,
                asset: null,
                fileId: "",
                sync: !1
            }
        });
        q.exports = {
            syncWithPrefab: function(f) {
                var e = f._prefab;
                if (e.asset) {
                    var b = f._objFlags,
                        k = f._parent,
                        c = f._id,
                        a = f._name,
                        d = f._active,
                        l = f._eulerAngles.x,
                        g = f._eulerAngles.y,
                        n = f._eulerAngles.z,
                        h = f._localZOrder,
                        t = f._trs,
                        p = t[0],
                        u = t[1],
                        v = t[2];
                    cc.game._isCloning = !0;
                    !0;
                    e.asset._doInstantiate(f);
                    cc.game._isCloning = !1;
                    f._objFlags = b;
                    f._parent = k;
                    f._id = c;
                    f._prefab = e;
                    f._name = a;
                    f._active = d;
                    f._localZOrder = h;
                    t = f._trs;
                    t[0] = p;
                    t[1] = u;
                    t[2] = v;
                    f._eulerAngles.x = l;
                    f._eulerAngles.y = g;
                    f._eulerAngles.z =
                        n
                } else !1, cc.errorID(3701, f.name), f._prefab = null
            }
        }
    }, {}],
    290: [function(h, q, m) {
        function f() {
            if (!l || !l.isValid) {
                l = new cc.Node("PROFILER-NODE");
                l.x = l.y = 10;
                l.groupIndex = cc.Node.BuiltinGroupIndex.DEBUG;
                cc.Camera._setupDebugCamera();
                l.zIndex = k.MAX_ZINDEX;
                cc.game.addPersistRootNode(l);
                var a = new cc.Node("LEFT-PANEL");
                a.anchorX = a.anchorY = 0;
                var b = a.addComponent(cc.Label);
                b.fontSize = 15;
                b.lineHeight = 15;
                a.parent = l;
                a = new cc.Node("RIGHT-PANEL");
                a.anchorX = 1;
                a.anchorY = 0;
                a.x = 300;
                var c = a.addComponent(cc.Label);
                c.horizontalAlign =
                    cc.Label.HorizontalAlign.RIGHT;
                c.fontSize = 15;
                c.lineHeight = 15;
                a.parent = l;
                cc.sys.platform !== cc.sys.BAIDU_GAME_SUB && cc.sys.platform !== cc.sys.WECHAT_GAME_SUB && (b.cacheMode = cc.Label.CacheMode.CHAR, c.cacheMode = cc.Label.CacheMode.CHAR);
                g = {
                    left: b,
                    right: c
                }
            }
            b = cc.director._lastUpdate;
            d.frame._counter.start(b);
            d.logic._counter.start(b)
        }

        function e() {
            var a = performance.now();
            cc.director.isPaused() ? d.frame._counter.start(a) : d.logic._counter.end(a);
            d.render._counter.start(a)
        }

        function b() {
            var a = performance.now();
            d.render._counter.end(a);
            d.draws._counter.value = cc.renderer.drawCalls;
            d.frame._counter.end(a);
            d.fps._counter.frame(a);
            var b = "",
                c = "",
                e;
            for (e in d) {
                var l = d[e];
                l._counter.sample(a);
                b += l.desc + "\n";
                c += l._counter.human() + "\n"
            }
            g && (g.left.string = b, g.right.string = c)
        }
        var k = h("../../platform/CCMacro"),
            c = h("./perf-counter"),
            a = !1,
            d = null,
            l = null,
            g = null;
        cc.profiler = q.exports = {
            isShowingStats: function() {
                return a
            },
            hideStats: function() {
                a && (l && (l.active = !1), cc.director.off(cc.Director.EVENT_BEFORE_UPDATE, f), cc.director.off(cc.Director.EVENT_AFTER_UPDATE,
                    e), cc.director.off(cc.Director.EVENT_AFTER_DRAW, b), a = !1)
            },
            showStats: function() {
                if (!a) {
                    if (!d) {
                        d = {
                            frame: {
                                desc: "Frame time (ms)",
                                min: 0,
                                max: 50,
                                average: 500
                            },
                            fps: {
                                desc: "Framerate (FPS)",
                                below: 30,
                                average: 500
                            },
                            draws: {
                                desc: "Draw call"
                            },
                            logic: {
                                desc: "Game Logic (ms)",
                                min: 0,
                                max: 50,
                                average: 500,
                                color: "#080"
                            },
                            render: {
                                desc: "Renderer (ms)",
                                min: 0,
                                max: 50,
                                average: 500,
                                color: "#f90"
                            },
                            mode: {
                                desc: cc.game.renderType === cc.game.RENDER_TYPE_WEBGL ? "WebGL" : "Canvas",
                                min: 1
                            }
                        };
                        var g = performance.now(),
                            k;
                        for (k in d) d[k]._counter = new c(k,
                            d[k], g)
                    }
                    l && (l.active = !0);
                    cc.director.on(cc.Director.EVENT_BEFORE_UPDATE, f);
                    cc.director.on(cc.Director.EVENT_AFTER_UPDATE, e);
                    cc.director.on(cc.Director.EVENT_AFTER_DRAW, b);
                    a = !0
                }
            }
        }
    }, {
        "../../platform/CCMacro": 209,
        "./perf-counter": 292
    }],
    291: [function(h, q, m) {
        h = cc.Class({
            name: "cc.Counter",
            ctor: function(f, e, b) {
                this._id = f;
                this._opts = e || {};
                this._accumSamples = this._accumValue = this._averageValue = this._total = this._value = 0;
                this._accumStart = b
            },
            properties: {
                value: {
                    get: function() {
                        return this._value
                    },
                    set: function(f) {
                        this._value =
                            f
                    }
                }
            },
            _average: function(f, e) {
                this._opts.average && (this._accumValue += f, ++this._accumSamples, e - this._accumStart >= this._opts.average && (this._averageValue = this._accumValue / this._accumSamples, this._accumValue = 0, this._accumStart = e, this._accumSamples = 0))
            },
            sample: function(f) {
                this._average(this._value, f)
            },
            human: function() {
                return Math.round(100 * (this._opts.average ? this._averageValue : this._value)) / 100
            },
            alarm: function() {
                return this._opts.below && this._value < this._opts.below || this._opts.over && this._value > this._opts.over
            }
        });
        q.exports = h
    }, {}],
    292: [function(h, q, m) {
        h = h("./counter");
        h = cc.Class({
            name: "cc.PerfCounter",
            extends: h,
            ctor: function(f, e, b) {
                this._time = b
            },
            start: function(f) {
                this._time = f
            },
            end: function(f) {
                this._value = f - this._time;
                this._average(this._value)
            },
            tick: function() {
                this.end();
                this.start()
            },
            frame: function(f) {
                var e = f - this._time;
                this._total++;
                e > (this._opts.average || 1E3) && (this._value = 1E3 * this._total / e, this._total = 0, this._time = f, this._average(this._value))
            }
        });
        q.exports = h
    }, {
        "./counter": 291
    }],
    293: [function(h, q, m) {
        function f(b) {
            this.count =
                0;
            this.limit = b;
            this.datas = {};
            this.tail = this.head = null
        }
        h = function(b) {
            return b && b.__esModule ? b : {
                default: b
            }
        }(h("../platform/js"));
        !1;
        var e = new h["default"].Pool(2);
        e.get = function() {
            return this._get() || {
                key: null,
                value: null,
                prev: null,
                next: null
            }
        };
        f.prototype.moveToHead = function(b) {
            b.next = this.head;
            b.prev = null;
            null !== this.head && (this.head.prev = b);
            this.head = b;
            null === this.tail && (this.tail = b);
            this.count++;
            this.datas[b.key] = b
        };
        f.prototype.put = function(b, c) {
            var a = e.get();
            a.key = b;
            a.value = c;
            this.count >= this.limit &&
                (b = this.tail, delete this.datas[b.key], this.count--, this.tail = b.prev, this.tail.next = null, b.prev = null, b.next = null, e.put(b));
            this.moveToHead(a)
        };
        f.prototype.remove = function(b) {
            null !== b.prev ? b.prev.next = b.next : this.head = b.next;
            null !== b.next ? b.next.prev = b.prev : this.tail = b.prev;
            delete this.datas[b.key];
            this.count--
        };
        f.prototype.get = function(b) {
            return (b = this.datas[b]) ? (this.remove(b), this.moveToHead(b), b.value) : null
        };
        f.prototype.clear = function() {
            this.count = 0;
            this.datas = {};
            this.tail = this.head = null
        };
        f.prototype.has =
            function(b) {
                return !!this.datas[b]
            };
        f.prototype["delete"] = function(b) {
            this.remove(this.datas[b])
        };
        var b = new f(100);
        cc.textUtils = q.exports = {
            BASELINE_RATIO: .26,
            MIDDLE_RATIO: .37,
            BASELINE_OFFSET: 0,
            label_wordRex: /([a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430-\u044f\u0410-\u042f\u0401\u0451]+|\S)/,
            label_symbolRex: /^[!,.:;'}\]%\?>\u3001\u2018\u201c\u300b\uff1f\u3002\uff0c\uff01]/,
            label_lastWordRex: /([a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430\xed\xec\xcd\xcc\xef\xc1\xc0\xe1\xe0\xc9\xc8\xd2\xd3\xf2\xf3\u0150\u0151\xd9\xda\u0170\xfa\u0171\xf1\xd1\xe6\xc6\u0153\u0152\xc3\xc2\xe3\xd4\xf5\u011b\u0161\u010d\u0159\u017e\xfd\xe1\xed\xe9\xf3\xfa\u016f\u0165\u010f\u0148\u011a\u0160\u010c\u0158\u017d\xc1\xcd\xc9\xd3\xda\u0164\u017c\u017a\u015b\xf3\u0144\u0142\u0119\u0107\u0105\u017b\u0179\u015a\xd3\u0143\u0141\u0118\u0106\u0104-\u044f\u0410-\u042f\u0401\u0451]+|\S)$/,
            label_lastEnglish: /[a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430\xed\xec\xcd\xcc\xef\xc1\xc0\xe1\xe0\xc9\xc8\xd2\xd3\xf2\xf3\u0150\u0151\xd9\xda\u0170\xfa\u0171\xf1\xd1\xe6\xc6\u0153\u0152\xc3\xc2\xe3\xd4\xf5\u011b\u0161\u010d\u0159\u017e\xfd\xe1\xed\xe9\xf3\xfa\u016f\u0165\u010f\u0148\u011a\u0160\u010c\u0158\u017d\xc1\xcd\xc9\xd3\xda\u0164\u017c\u017a\u015b\xf3\u0144\u0142\u0119\u0107\u0105\u017b\u0179\u015a\xd3\u0143\u0141\u0118\u0106\u0104-\u044f\u0410-\u042f\u0401\u0451]+$/,
            label_firstEnglish: /^[a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430\xed\xec\xcd\xcc\xef\xc1\xc0\xe1\xe0\xc9\xc8\xd2\xd3\xf2\xf3\u0150\u0151\xd9\xda\u0170\xfa\u0171\xf1\xd1\xe6\xc6\u0153\u0152\xc3\xc2\xe3\xd4\xf5\u011b\u0161\u010d\u0159\u017e\xfd\xe1\xed\xe9\xf3\xfa\u016f\u0165\u010f\u0148\u011a\u0160\u010c\u0158\u017d\xc1\xcd\xc9\xd3\xda\u0164\u017c\u017a\u015b\xf3\u0144\u0142\u0119\u0107\u0105\u017b\u0179\u015a\xd3\u0143\u0141\u0118\u0106\u0104-\u044f\u0410-\u042f\u0401\u0451]/,
            highSurrogateRex: /[\uD800-\uDBFF]/,
            lowSurrogateRex: /[\uDC00-\uDFFF]/,
            label_wrapinspection: !0,
            __CHINESE_REG: /^[\u4E00-\u9FFF\u3400-\u4DFF]+$/,
            __JAPANESE_REG: /[\u3000-\u303F]|[\u3040-\u309F]|[\u30A0-\u30FF]|[\uFF00-\uFFEF]|[\u4E00-\u9FAF]|[\u2605-\u2606]|[\u2190-\u2195]|\u203B/g,
            __KOREAN_REG: /^[\u1100-\u11FF]|[\u3130-\u318F]|[\uA960-\uA97F]|[\uAC00-\uD7AF]|[\uD7B0-\uD7FF]+$/,
            isUnicodeCJK: function(b) {
                return this.__CHINESE_REG.test(b) || this.__JAPANESE_REG.test(b) || this.__KOREAN_REG.test(b)
            },
            isUnicodeSpace: function(b) {
                b =
                    b.charCodeAt(0);
                return 9 <= b && 13 >= b || 32 === b || 133 === b || 160 === b || 5760 === b || 8192 <= b && 8202 >= b || 8232 === b || 8233 === b || 8239 === b || 8287 === b || 12288 === b
            },
            safeMeasureText: function(e, c, a) {
                a = (a || e.font) + "\ud83c\udfae" + c;
                var d = b.get(a);
                if (null !== d) return d;
                e = (e = e.measureText(c)) && e.width || 0;
                b.put(a, e);
                return e
            },
            _safeSubstring: function(b, c, a) {
                var d = c,
                    e = a,
                    g = b[c];
                this.lowSurrogateRex.test(g) && d--;
                void 0 !== a && (a - 1 !== c ? this.highSurrogateRex.test(b[a - 1]) && e-- : this.highSurrogateRex.test(g) && e++);
                return b.substring(d, e)
            },
            fragmentText: function(b, c, a, d) {
                var e = [];
                if (0 === b.length || 0 > a) return e.push(""), e;
                for (; c > a && 1 < b.length;) {
                    for (var g = a / c * b.length | 0, k = this._safeSubstring(b, g), f = c - d(k), h = k, p = 0, u = 0; f > a && 10 > u++;) g *= a / f, g |= 0, k = this._safeSubstring(b, g), f = c - d(k);
                    for (u = 0; f <= a && 10 > u++;) k && (p = (h = this.label_wordRex.exec(k)) ? h[0].length : 1, h = k), g += p, k = this._safeSubstring(b, g), f = c - d(k);
                    g -= p;
                    0 === g ? (g = 1, h = this._safeSubstring(b, 1)) : 1 === g && this.highSurrogateRex.test(b[0]) && (g = 2, h = this._safeSubstring(b, 2));
                    c = this._safeSubstring(b, 0,
                        g);
                    this.label_wrapinspection && this.label_symbolRex.test(h || k) && (u = this.label_lastWordRex.exec(c), g -= u ? u[0].length : 0, 0 === g && (g = 1), h = this._safeSubstring(b, g), c = this._safeSubstring(b, 0, g));
                    this.label_firstEnglish.test(h) && (u = this.label_lastEnglish.exec(c)) && c !== u[0] && (g -= u[0].length, h = this._safeSubstring(b, g), c = this._safeSubstring(b, 0, g));
                    0 === e.length ? e.push(c) : (c = c.trimLeft(), 0 < c.length && e.push(c));
                    b = h || k;
                    c = d(b)
                }
                0 === e.length ? e.push(b) : (b = b.trimLeft(), 0 < b.length && e.push(b));
                return e
            }
        }
    }, {
        "../platform/js": 225
    }],
    294: [function(h, q, m) {
        var f = h("../assets/CCTexture2D");
        q.exports = {
            loadImage: function(e, b, k) {
                cc.assertID(e, 3103);
                var c = cc.assetManager.assets.get(e);
                if (c) {
                    if (c.loaded) return b && b.call(k, null, c), c;
                    c.once("load", function() {
                        b && b.call(k, null, c)
                    }, k);
                    return c
                }
                cc.assetManager.loadRemote(e, function(a, c) {
                    b && b.call(k, a, c)
                })
            },
            cacheImage: function(e, b) {
                if (e && b) {
                    var k = new f;
                    k.initWithElement(b);
                    cc.assetManager.assets.add(e, k);
                    return k
                }
            },
            postLoadTexture: function(e, b) {
                e.loaded ? b && b() : e.nativeUrl ? cc.assetManager.loadNativeFile(e,
                    function(k, c) {
                        k || (e._nativeAsset = c);
                        b && b(k)
                    }) : b && b()
            }
        }
    }, {
        "../assets/CCTexture2D": 88
    }],
    295: [function(h, q, m) {
        m = h("./node-unit");
        h = h("./node-mem-pool");
        q.exports = {
            NodeMemPool: new h(m)
        }
    }, {
        "./node-mem-pool": 297,
        "./node-unit": 298
    }],
    296: [function(h, q, m) {
        h = function(f) {
            this._unitClass = f;
            this._pool = [];
            this._findOrder = [];
            !1
        };
        m = h.prototype;
        m._initNative = function() {
            this._nativeMemPool = new renderer.MemPool
        };
        m._buildUnit = function(f) {
            f = new this._unitClass(f, this);
            !1;
            return f
        };
        m._destroyUnit = function(f) {
            this._pool[f] =
                null;
            for (var e = 0, b = this._findOrder.length; e < b; e++) {
                var k = this._findOrder[e];
                if (k && k.unitID == f) {
                    this._findOrder.splice(e, 1);
                    break
                }
            }!1
        };
        m._findUnitID = function() {
            for (var f = 0, e = this._pool; e[f];) f++;
            return f
        };
        m.pop = function() {
            for (var f = null, e = 0, b = this._findOrder, k = this._pool, c = b.length; e < c; e++) {
                var a = b[e];
                if (a && a.hasSpace()) {
                    f = a;
                    break
                }
            }
            f || (e = this._findUnitID(), f = this._buildUnit(e), k[e] = f, b.push(f), e = b.length - 1);
            k = b[0];
            k !== f && (b[0] = f, b[e] = k);
            return f.pop()
        };
        m.push = function(f) {
            var e = this._pool[f.unitID];
            e.push(f.index);
            1 < this._findOrder.length && e.isAllFree() && this._destroyUnit(f.unitID);
            return e
        };
        q.exports = h
    }, {}],
    297: [function(h, q, m) {
        var f = h("./mem-pool"),
            e = function(b) {
                f.call(this, b)
            };
        (function() {
            var b = function() {};
            b.prototype = f.prototype;
            e.prototype = new b
        })();
        h = e.prototype;
        h._initNative = function() {
            this._nativeMemPool = new renderer.NodeMemPool
        };
        h._destroyUnit = function(b) {
            f.prototype._destroyUnit.call(this, b);
            !1
        };
        q.exports = e
    }, {
        "./mem-pool": 296
    }],
    298: [function(h, q, m) {
        var f = h("../../value-types/utils"),
            e = 10 * f.FLOAT_BYTES,
            b = 16 * f.FLOAT_BYTES,
            k = 16 * f.FLOAT_BYTES,
            c = h("./unit-base"),
            a = function(a, l) {
                c.call(this, a, l);
                a = this._contentNum;
                this.trsList = new f.FLOAT_ARRAY_TYPE(10 * a);
                this.localMatList = new f.FLOAT_ARRAY_TYPE(16 * a);
                this.worldMatList = new f.FLOAT_ARRAY_TYPE(16 * a);
                !1;
                for (l = 0; l < a; l++) {
                    var d = this._spacesData[l];
                    d.trs = new f.FLOAT_ARRAY_TYPE(this.trsList.buffer, l * e, 10);
                    d.localMat = new f.FLOAT_ARRAY_TYPE(this.localMatList.buffer, l * b, 16);
                    d.worldMat = new f.FLOAT_ARRAY_TYPE(this.worldMatList.buffer, l * k, 16);
                    !1
                }
            };
        (function() {
            var b = function() {};
            b.prototype = c.prototype;
            a.prototype = new b
        })();
        q.exports = a
    }, {
        "../../value-types/utils": 308,
        "./unit-base": 299
    }],
    299: [function(h, q, m) {
        h = function(f, e, b) {
            b = b || 128;
            this.unitID = f;
            this._memPool = e;
            this._data = new Uint16Array(2);
            this._data[0] = 0;
            this._data[1] = 0;
            this._contentNum = b;
            this._signData = new Uint16Array(2 * this._contentNum);
            this._spacesData = [];
            for (e = 0; e < b; e++) {
                var k = 2 * e;
                this._signData[k + 0] = e + 1;
                this._signData[k + 1] = 0;
                this._spacesData[e] = {
                    index: e,
                    unitID: f
                }
            }
            this._signData[2 *
                (b - 1)] = 65535
        };
        m = h.prototype;
        m.hasSpace = function() {
            return 65535 !== this._data[0]
        };
        m.isAllFree = function() {
            return 0 == this._data[1]
        };
        m.pop = function() {
            var f = this._data[0];
            if (65535 === f) return null;
            var e = 2 * f;
            f = this._spacesData[f];
            this._signData[e + 1] = 1;
            this._data[0] = this._signData[e + 0];
            this._data[1]++;
            return f
        };
        m.push = function(f) {
            var e = 2 * f;
            this._signData[e + 1] = 0;
            this._signData[e + 0] = this._data[0];
            this._data[0] = f;
            this._data[1]--
        };
        m.dump = function() {
            for (var f = 0, e = this._data[0], b = ""; 65535 != e;) f++, b += e + "->", e = this._signData[2 *
                e + 0];
            e = 0;
            for (var k = "", c = this._contentNum, a = 0; a < c; a++) 1 == this._signData[2 * a + 1] && (e++, k += a + "->");
            c = f + e;
            console.log("unitID:", this.unitID, "spaceNum:", f, "calc using num:", e, "store using num:", this._data[1], "calc total num:", c, "actually total num:", this._contentNum);
            console.log("free info:", b);
            console.log("using info:", k);
            e != this._data[1] && cc.error("using num error", "calc using num:", e, "store using num:", this._data[1]);
            f + e != this._contentNum && cc.error("total num error", "calc total num:", c, "actually total num:",
                this._contentNum)
        };
        q.exports = h
    }, {}],
    300: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, b) {
            for (var c = 0; c < b.length; c++) {
                var d = b[c];
                d.enumerable = d.enumerable || !1;
                d.configurable = !0;
                "value" in d && (d.writable = !0);
                Object.defineProperty(a, d.key, d)
            }
        }

        function b(a, b, c) {
            b && e(a.prototype, b);
            c && e(a, c);
            return a
        }

        function k(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var c = f(h("./value-type")),
            a = f(h("../platform/CCClass")),
            d = f(h("../utils/misc")),
            l = function(a) {
                function c(b, c, d, g) {
                    void 0 === b && (b = 0);
                    void 0 === c && (c = 0);
                    void 0 === d && (d = 0);
                    void 0 === g && (g = 255);
                    var e = a.call(this) || this;
                    e._val = 0;
                    "object" === typeof b && (c = b.g, d = b.b, g = b.a, b = b.r);
                    e._val = (g << 24 >>> 0) + (d << 16) + (c << 8) + (0 | b);
                    return e
                }
                k(c, a);
                c.copy = function(a, b) {
                    a.r = b.r;
                    a.g = b.g;
                    a.b = b.b;
                    a.a = b.a;
                    return a
                };
                c.clone = function(a) {
                    return new c(a.r, a.g, a.b, a.a)
                };
                c.set = function(a, b, c, d, g) {
                    void 0 === b && (b = 255);
                    void 0 === c && (c = 255);
                    void 0 === d && (d = 255);
                    void 0 === g && (g = 255);
                    a.r = b;
                    a.g = c;
                    a.b = d;
                    a.a = g;
                    return a
                };
                c.fromHex = function(a, b) {
                    a.r = (b >> 24) / 255;
                    a.g = (b >> 16 & 255) / 255;
                    a.b = (b >> 8 & 255) / 255;
                    a.a = (255 & b) / 255;
                    return a
                };
                c.fromHEX = function(a, b) {
                    b = 0 === b.indexOf("#") ? b.substring(1) : b;
                    a.r = parseInt(b.substr(0, 2), 16) || 0;
                    a.g = parseInt(b.substr(2, 2), 16) || 0;
                    a.b = parseInt(b.substr(4, 2), 16) || 0;
                    a.a = parseInt(b.substr(6, 2), 16) || 255;
                    a._val = (a.a << 24 >>> 0) + (a.b << 16) + (a.g << 8) + a.r;
                    return a
                };
                c.add = function(a, b, c) {
                    a.r = b.r + c.r;
                    a.g = b.g + c.g;
                    a.b = b.b + c.b;
                    a.a = b.a + c.a;
                    return a
                };
                c.subtract = function(a, b, c) {
                    a.r = b.r - c.r;
                    a.g =
                        b.g - c.g;
                    a.b = b.b - c.b;
                    a.a = b.a - c.a;
                    return a
                };
                c.multiply = function(a, b, c) {
                    a.r = b.r * c.r;
                    a.g = b.g * c.g;
                    a.b = b.b * c.b;
                    a.a = b.a * c.a;
                    return a
                };
                c.divide = function(a, b, c) {
                    a.r = b.r / c.r;
                    a.g = b.g / c.g;
                    a.b = b.b / c.b;
                    a.a = b.a / c.a;
                    return a
                };
                c.scale = function(a, b, c) {
                    a.r = b.r * c;
                    a.g = b.g * c;
                    a.b = b.b * c;
                    a.a = b.a * c;
                    return a
                };
                c.lerp = function(a, b, c, d) {
                    var g = b.r,
                        e = b.g,
                        l = b.b;
                    b = b.a;
                    a.r = g + d * (c.r - g);
                    a.g = e + d * (c.g - e);
                    a.b = l + d * (c.b - l);
                    a.a = b + d * (c.a - b);
                    return a
                };
                c.toArray = function(a, b, d) {
                    void 0 === d && (d = 0);
                    var g = b instanceof c || 1 < b.a ? 1 / 255 : 1;
                    a[d + 0] = b.r *
                        g;
                    a[d + 1] = b.g * g;
                    a[d + 2] = b.b * g;
                    a[d + 3] = b.a * g;
                    return a
                };
                c.fromArray = function(a, b, c) {
                    void 0 === c && (c = 0);
                    b.r = 255 * a[c + 0];
                    b.g = 255 * a[c + 1];
                    b.b = 255 * a[c + 2];
                    b.a = 255 * a[c + 3];
                    return b
                };
                c.premultiplyAlpha = function(a, b) {
                    var c = b.a / 255;
                    a.r = b.r * c;
                    a.g = b.g * c;
                    a.b = b.b * c;
                    a._fastSetA(b.a);
                    return a
                };
                b(c, null, [{
                    key: "WHITE",
                    get: function() {
                        return new c(255, 255, 255, 255)
                    }
                }, {
                    key: "BLACK",
                    get: function() {
                        return new c(0, 0, 0, 255)
                    }
                }, {
                    key: "TRANSPARENT",
                    get: function() {
                        return new c(0, 0, 0, 0)
                    }
                }, {
                    key: "GRAY",
                    get: function() {
                        return new c(127.5, 127.5,
                            127.5)
                    }
                }, {
                    key: "RED",
                    get: function() {
                        return new c(255, 0, 0)
                    }
                }, {
                    key: "GREEN",
                    get: function() {
                        return new c(0, 255, 0)
                    }
                }, {
                    key: "BLUE",
                    get: function() {
                        return new c(0, 0, 255)
                    }
                }, {
                    key: "YELLOW",
                    get: function() {
                        return new c(255, 235, 4)
                    }
                }, {
                    key: "ORANGE",
                    get: function() {
                        return new c(255, 127, 0)
                    }
                }, {
                    key: "CYAN",
                    get: function() {
                        return new c(0, 255, 255)
                    }
                }, {
                    key: "MAGENTA",
                    get: function() {
                        return new c(255, 0, 255)
                    }
                }]);
                var g = c.prototype;
                g.clone = function() {
                    var a = new c;
                    a._val = this._val;
                    return a
                };
                g.equals = function(a) {
                    return a && this._val ===
                        a._val
                };
                g.lerp = function(a, b, d) {
                    d = d || new c;
                    var g = this.r,
                        e = this.g,
                        l = this.b,
                        k = this.a;
                    d.r = g + (a.r - g) * b;
                    d.g = e + (a.g - e) * b;
                    d.b = l + (a.b - l) * b;
                    d.a = k + (a.a - k) * b;
                    return d
                };
                g.toString = function() {
                    return "rgba(" + this.r.toFixed() + ", " + this.g.toFixed() + ", " + this.b.toFixed() + ", " + this.a.toFixed() + ")"
                };
                g.getR = function() {
                    return 255 & this._val
                };
                g.setR = function(a) {
                    a = ~~d["default"].clampf(a, 0, 255);
                    this._val = (4294967040 & this._val | a) >>> 0;
                    return this
                };
                g.getG = function() {
                    return (65280 & this._val) >> 8
                };
                g.setG = function(a) {
                    a = ~~d["default"].clampf(a,
                        0, 255);
                    this._val = (4294902015 & this._val | a << 8) >>> 0;
                    return this
                };
                g.getB = function() {
                    return (16711680 & this._val) >> 16
                };
                g.setB = function(a) {
                    a = ~~d["default"].clampf(a, 0, 255);
                    this._val = (4278255615 & this._val | a << 16) >>> 0;
                    return this
                };
                g.getA = function() {
                    return (4278190080 & this._val) >>> 24
                };
                g.setA = function(a) {
                    a = ~~d["default"].clampf(a, 0, 255);
                    this._val = (16777215 & this._val | a << 24) >>> 0;
                    return this
                };
                g.toCSS = function(a) {
                    return a && "rgba" !== a ? "rgb" === a ? "rgb(" + this.r + "," + this.g + "," + this.b + ")" : "#" + this.toHEX(a) : "rgba(" + this.r +
                        "," + this.g + "," + this.b + "," + (this.a / 255).toFixed(2) + ")"
                };
                g.fromHEX = function(a) {
                    a = 0 === a.indexOf("#") ? a.substring(1) : a;
                    var b = parseInt(a.substr(0, 2), 16) || 0,
                        c = parseInt(a.substr(2, 2), 16) || 0,
                        d = parseInt(a.substr(4, 2), 16) || 0;
                    this._val = ((parseInt(a.substr(6, 2), 16) || 255) << 24 >>> 0) + (d << 16) + (c << 8) + b;
                    return this
                };
                g.toHEX = function(a) {
                    var b = [(16 > this.r ? "0" : "") + this.r.toString(16), (16 > this.g ? "0" : "") + this.g.toString(16), (16 > this.b ? "0" : "") + this.b.toString(16)];
                    "#rgb" === a ? (b[0] = b[0][0], b[1] = b[1][0], b[2] = b[2][0]) : "#rrggbbaa" ===
                        a && b.push((16 > this.a ? "0" : "") + this.a.toString(16));
                    return b.join("")
                };
                g.toRGBValue = function() {
                    return 16777215 & this._val
                };
                g.fromHSV = function(a, b, c) {
                    var d, g;
                    if (0 === b) var e = d = g = c;
                    else if (0 === c) e = d = g = 0;
                    else {
                        1 === a && (a = 0);
                        a *= 6;
                        var l = Math.floor(a),
                            k = a - l;
                        a = c * (1 - b);
                        var f = c * (1 - b * k);
                        b = c * (1 - b * (1 - k));
                        switch (l) {
                            case 0:
                                e = c;
                                d = b;
                                g = a;
                                break;
                            case 1:
                                e = f;
                                d = c;
                                g = a;
                                break;
                            case 2:
                                e = a;
                                d = c;
                                g = b;
                                break;
                            case 3:
                                e = a;
                                d = f;
                                g = c;
                                break;
                            case 4:
                                e = b;
                                d = a;
                                g = c;
                                break;
                            case 5:
                                e = c, d = a, g = f
                        }
                    }
                    this._val = (this.a << 24 >>> 0) + (255 * g << 16) + (255 * d << 8) + (0 | 255 * e);
                    return this
                };
                g.toHSV = function() {
                    var a = this.r / 255,
                        b = this.g / 255,
                        c = this.b / 255,
                        d = {
                            h: 0,
                            s: 0,
                            v: 0
                        },
                        g = Math.max(a, b, c),
                        e = Math.min(a, b, c);
                    d.v = g;
                    d.s = g ? (g - e) / g : 0;
                    d.s ? (e = g - e, d.h = a === g ? (b - c) / e : b === g ? 2 + (c - a) / e : 4 + (a - b) / e, d.h /= 6, 0 > d.h && (d.h += 1)) : d.h = 0;
                    return d
                };
                g.set = function(a) {
                    a._val ? this._val = a._val : (this.r = a.r, this.g = a.g, this.b = a.b, this.a = a.a);
                    return this
                };
                g._fastSetA = function(a) {
                    this._val = (16777215 & this._val | a << 24) >>> 0
                };
                g.multiply = function(a) {
                    this._val = 4278190080 & ((4278190080 & this._val) >>> 8) * a.a | 16711680 & (16711680 &
                        this._val) * a.b >> 8 | 65280 & (65280 & this._val) * a.g >> 8 | 255 & (255 & this._val) * a.r >> 8;
                    return this
                };
                b(c, [{
                    key: "r",
                    get: function() {
                        return this.getR()
                    },
                    set: function(a) {
                        this.setR(a)
                    }
                }, {
                    key: "g",
                    get: function() {
                        return this.getG()
                    },
                    set: function(a) {
                        this.setG(a)
                    }
                }, {
                    key: "b",
                    get: function() {
                        return this.getB()
                    },
                    set: function(a) {
                        this.setB(a)
                    }
                }, {
                    key: "a",
                    get: function() {
                        return this.getA()
                    },
                    set: function(a) {
                        this.setA(a)
                    }
                }]);
                return c
            }(c["default"]);
        m["default"] = l;
        l.div = l.divide;
        l.sub = l.subtract;
        l.mul = l.multiply;
        l.WHITE_R = l.WHITE;
        l.BLACK_R = l.BLACK;
        l.TRANSPARENT_R = l.TRANSPARENT;
        l.GRAY_R = l.GRAY;
        l.RED_R = l.RED;
        l.GREEN_R = l.GREEN;
        l.BLUE_R = l.BLUE;
        l.YELLOW_R = l.YELLOW;
        l.ORANGE_R = l.ORANGE;
        l.CYAN_R = l.CYAN;
        l.MAGENTA_R = l.MAGENTA;
        a["default"].fastDefine("cc.Color", l, {
            r: 0,
            g: 0,
            b: 0,
            a: 255
        });
        cc.Color = l;
        cc.color = function(a, b, c, d) {
            return "string" === typeof a ? (new l).fromHEX(a) : "object" === typeof a ? new l(a.r, a.g, a.b, a.a) : new l(a, b, c, d)
        };
        q.exports = m["default"]
    }, {
        "../platform/CCClass": 204,
        "../utils/misc": 286,
        "./value-type": 309
    }],
    301: [function(h, q, m) {
        function f(b) {
            return b &&
                b.__esModule ? b : {
                    default: b
                }
        }
        m.__esModule = !0;
        var e = {
            Vec2: !0,
            Vec3: !0,
            Vec4: !0,
            Mat4: !0,
            Mat3: !0,
            Rect: !0,
            Size: !0,
            Color: !0,
            Quat: !0,
            Trs: !0
        };
        m.Trs = m.Quat = m.Color = m.Size = m.Rect = m.Mat3 = m.Mat4 = m.Vec4 = m.Vec3 = m.Vec2 = void 0;
        var b = f(h("./vec2"));
        m.Vec2 = b["default"];
        b = f(h("./vec3"));
        m.Vec3 = b["default"];
        b = f(h("./vec4"));
        m.Vec4 = b["default"];
        b = f(h("./mat4"));
        m.Mat4 = b["default"];
        b = f(h("./mat3"));
        m.Mat3 = b["default"];
        b = f(h("./rect"));
        m.Rect = b["default"];
        b = f(h("./size"));
        m.Size = b["default"];
        b = f(h("./color"));
        m.Color = b["default"];
        b = f(h("./quat"));
        m.Quat = b["default"];
        b = f(h("./trs"));
        m.Trs = b["default"];
        var k = h("./utils");
        Object.keys(k).forEach(function(b) {
            "default" !== b && "__esModule" !== b && (Object.prototype.hasOwnProperty.call(e, b) || (m[b] = k[b]))
        });
        cc.math = q.exports
    }, {
        "./color": 300,
        "./mat3": 302,
        "./mat4": 303,
        "./quat": 304,
        "./rect": 305,
        "./size": 306,
        "./trs": 307,
        "./utils": 308,
        "./vec2": 310,
        "./vec3": 311,
        "./vec4": 312
    }],
    302: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        var f = h("../value-types/utils"),
            e = function(b) {
                return b && b.__esModule ?
                    b : {
                        default: b
                    }
            }(h("./vec3"));
        h = function() {
            function b(b, c, a, d, e, g, n, h, t) {
                void 0 === b && (b = 1);
                void 0 === c && (c = 0);
                void 0 === a && (a = 0);
                void 0 === d && (d = 0);
                void 0 === e && (e = 1);
                void 0 === g && (g = 0);
                void 0 === n && (n = 0);
                void 0 === h && (h = 0);
                void 0 === t && (t = 1);
                this.m = void 0;
                if (b instanceof f.FLOAT_ARRAY_TYPE) this.m = b;
                else {
                    var l = this.m = new f.FLOAT_ARRAY_TYPE(9);
                    l[0] = b;
                    l[1] = c;
                    l[2] = a;
                    l[3] = d;
                    l[4] = e;
                    l[5] = g;
                    l[6] = n;
                    l[7] = h;
                    l[8] = t
                }
            }
            b.create = function(e, c, a, d, l, g, f, h, t) {
                void 0 === e && (e = 1);
                void 0 === c && (c = 0);
                void 0 === a && (a = 0);
                void 0 === d &&
                    (d = 0);
                void 0 === l && (l = 1);
                void 0 === g && (g = 0);
                void 0 === f && (f = 0);
                void 0 === h && (h = 0);
                void 0 === t && (t = 1);
                return new b(e, c, a, d, l, g, f, h, t)
            };
            b.clone = function(e) {
                e = e.m;
                return new b(e[0], e[1], e[2], e[3], e[4], e[5], e[6], e[7], e[8])
            };
            b.copy = function(b, c) {
                b.m.set(c.m);
                return b
            };
            b.set = function(b, c, a, d, e, g, f, h, t, p) {
                var l = b.m;
                l[0] = c;
                l[1] = a;
                l[2] = d;
                l[3] = e;
                l[4] = g;
                l[5] = f;
                l[6] = h;
                l[7] = t;
                l[8] = p;
                return b
            };
            b.identity = function(b) {
                var c = b.m;
                c[0] = 1;
                c[1] = 0;
                c[2] = 0;
                c[3] = 0;
                c[4] = 1;
                c[5] = 0;
                c[6] = 0;
                c[7] = 0;
                c[8] = 1;
                return b
            };
            b.transpose = function(b,
                c) {
                var a = c.m,
                    d = b.m;
                if (b === c) {
                    c = a[1];
                    var e = a[2],
                        g = a[5];
                    d[1] = a[3];
                    d[2] = a[6];
                    d[3] = c;
                    d[5] = a[7];
                    d[6] = e;
                    d[7] = g
                } else d[0] = a[0], d[1] = a[3], d[2] = a[6], d[3] = a[1], d[4] = a[4], d[5] = a[7], d[6] = a[2], d[7] = a[5], d[8] = a[8];
                return b
            };
            b.invert = function(b, c) {
                var a = c.m;
                c = b.m;
                var d = a[0],
                    e = a[1],
                    g = a[2],
                    k = a[3],
                    f = a[4],
                    h = a[5],
                    p = a[6],
                    u = a[7];
                a = a[8];
                var v = a * f - h * u,
                    A = -a * k + h * p,
                    B = u * k - f * p,
                    m = d * v + e * A + g * B;
                if (!m) return b;
                m = 1 / m;
                c[0] = v * m;
                c[1] = (-a * e + g * u) * m;
                c[2] = (h * e - g * f) * m;
                c[3] = A * m;
                c[4] = (a * d - g * p) * m;
                c[5] = (-h * d + g * k) * m;
                c[6] = B * m;
                c[7] = (-u * d + e * p) * m;
                c[8] = (f * d - e * k) * m;
                return b
            };
            b.adjoint = function(b, c) {
                var a = c.m;
                c = b.m;
                var d = a[0],
                    e = a[1],
                    g = a[2],
                    k = a[3],
                    f = a[4],
                    h = a[5],
                    p = a[6],
                    u = a[7];
                a = a[8];
                c[0] = f * a - h * u;
                c[1] = g * u - e * a;
                c[2] = e * h - g * f;
                c[3] = h * p - k * a;
                c[4] = d * a - g * p;
                c[5] = g * k - d * h;
                c[6] = k * u - f * p;
                c[7] = e * p - d * u;
                c[8] = d * f - e * k;
                return b
            };
            b.determinant = function(b) {
                b = b.m;
                var c = b[3],
                    a = b[4],
                    d = b[5],
                    e = b[6],
                    g = b[7],
                    f = b[8];
                return b[0] * (f * a - d * g) + b[1] * (-f * c + d * e) + b[2] * (g * c - a * e)
            };
            b.multiply = function(b, c, a) {
                var d = c.m,
                    e = a.m;
                a = b.m;
                c = d[0];
                var g = d[1],
                    f = d[2],
                    k = d[3],
                    h = d[4],
                    p = d[5],
                    u = d[6],
                    v = d[7];
                d = d[8];
                var A = e[0],
                    B = e[1],
                    m = e[2],
                    y = e[3],
                    z = e[4],
                    x = e[5],
                    q = e[6],
                    G = e[7];
                e = e[8];
                a[0] = A * c + B * k + m * u;
                a[1] = A * g + B * h + m * v;
                a[2] = A * f + B * p + m * d;
                a[3] = y * c + z * k + x * u;
                a[4] = y * g + z * h + x * v;
                a[5] = y * f + z * p + x * d;
                a[6] = q * c + G * k + e * u;
                a[7] = q * g + G * h + e * v;
                a[8] = q * f + G * p + e * d;
                return b
            };
            b.multiplyMat4 = function(b, c, a) {
                var d = c.m,
                    e = a.m;
                a = b.m;
                c = d[0];
                var g = d[1],
                    f = d[2],
                    k = d[3],
                    h = d[4],
                    p = d[5],
                    u = d[6],
                    v = d[7];
                d = d[8];
                var A = e[0],
                    B = e[1],
                    m = e[2],
                    y = e[4],
                    z = e[5],
                    x = e[6],
                    q = e[8],
                    G = e[9];
                e = e[10];
                a[0] = A * c + B * k + m * u;
                a[1] = A * g + B * h + m * v;
                a[2] = A * f + B * p + m * d;
                a[3] = y * c + z * k + x * u;
                a[4] = y * g +
                    z * h + x * v;
                a[5] = y * f + z * p + x * d;
                a[6] = q * c + G * k + e * u;
                a[7] = q * g + G * h + e * v;
                a[8] = q * f + G * p + e * d;
                return b
            };
            b.translate = function(b, c, a) {
                var d = c.m;
                c = b.m;
                var e = d[0],
                    g = d[1],
                    f = d[2],
                    k = d[3],
                    h = d[4],
                    p = d[5],
                    u = d[6],
                    v = d[7];
                d = d[8];
                var A = a.x;
                a = a.y;
                c[0] = e;
                c[1] = g;
                c[2] = f;
                c[3] = k;
                c[4] = h;
                c[5] = p;
                c[6] = A * e + a * k + u;
                c[7] = A * g + a * h + v;
                c[8] = A * f + a * p + d;
                return b
            };
            b.rotate = function(b, c, a) {
                var d = c.m;
                c = b.m;
                var e = d[0],
                    g = d[1],
                    f = d[2],
                    k = d[3],
                    h = d[4],
                    p = d[5],
                    u = d[6],
                    v = d[7];
                d = d[8];
                var A = Math.sin(a);
                a = Math.cos(a);
                c[0] = a * e + A * k;
                c[1] = a * g + A * h;
                c[2] = a * f + A * p;
                c[3] = a * k - A * e;
                c[4] = a * h - A * g;
                c[5] = a * p - A * f;
                c[6] = u;
                c[7] = v;
                c[8] = d;
                return b
            };
            b.scale = function(b, c, a) {
                var d = a.x;
                a = a.y;
                c = c.m;
                var e = b.m;
                e[0] = d * c[0];
                e[1] = d * c[1];
                e[2] = d * c[2];
                e[3] = a * c[3];
                e[4] = a * c[4];
                e[5] = a * c[5];
                e[6] = c[6];
                e[7] = c[7];
                e[8] = c[8];
                return b
            };
            b.fromMat4 = function(b, c) {
                c = c.m;
                var a = b.m;
                a[0] = c[0];
                a[1] = c[1];
                a[2] = c[2];
                a[3] = c[4];
                a[4] = c[5];
                a[5] = c[6];
                a[6] = c[8];
                a[7] = c[9];
                a[8] = c[10];
                return b
            };
            b.fromTranslation = function(b, c) {
                var a = b.m;
                a[0] = 1;
                a[1] = 0;
                a[2] = 0;
                a[3] = 0;
                a[4] = 1;
                a[5] = 0;
                a[6] = c.x;
                a[7] = c.y;
                a[8] = 1;
                return b
            };
            b.fromRotation =
                function(b, c) {
                    var a = Math.sin(c);
                    c = Math.cos(c);
                    var d = b.m;
                    d[0] = c;
                    d[1] = a;
                    d[2] = 0;
                    d[3] = -a;
                    d[4] = c;
                    d[5] = 0;
                    d[6] = 0;
                    d[7] = 0;
                    d[8] = 1;
                    return b
                };
            b.fromScaling = function(b, c) {
                var a = b.m;
                a[0] = c.x;
                a[1] = 0;
                a[2] = 0;
                a[3] = 0;
                a[4] = c.y;
                a[5] = 0;
                a[6] = 0;
                a[7] = 0;
                a[8] = 1;
                return b
            };
            b.fromQuat = function(b, c) {
                var a = b.m,
                    d = c.x,
                    e = c.y,
                    g = c.z;
                c = c.w;
                var f = d + d,
                    k = e + e,
                    h = g + g;
                d *= f;
                var p = e * f;
                e *= k;
                var u = g * f,
                    v = g * k;
                g *= h;
                f *= c;
                k *= c;
                c *= h;
                a[0] = 1 - e - g;
                a[3] = p - c;
                a[6] = u + k;
                a[1] = p + c;
                a[4] = 1 - d - g;
                a[7] = v - f;
                a[2] = u - k;
                a[5] = v + f;
                a[8] = 1 - d - e;
                return b
            };
            b.fromViewUp = function(k,
                c, a) {
                return function() {
                    var a = new e["default"](0, 1, 0),
                        c = new e["default"],
                        g = new e["default"];
                    return function(d, l, k) {
                        if (e["default"].lengthSqr(l) < f.EPSILON * f.EPSILON) return b.identity(d), d;
                        k = k || a;
                        e["default"].normalize(c, e["default"].cross(c, k, l));
                        if (e["default"].lengthSqr(c) < f.EPSILON * f.EPSILON) return b.identity(d), d;
                        e["default"].cross(g, l, c);
                        b.set(d, c.x, c.y, c.z, g.x, g.y, g.z, l.x, l.y, l.z);
                        return d
                    }
                }()(k, c, a)
            };
            b.normalFromMat4 = function(b, c) {
                var a = c.m;
                c = b.m;
                var d = a[0],
                    e = a[1],
                    g = a[2],
                    f = a[3],
                    k = a[4],
                    h = a[5],
                    p = a[6],
                    u = a[7],
                    v = a[8],
                    A = a[9],
                    B = a[10],
                    m = a[11],
                    y = a[12],
                    z = a[13],
                    x = a[14];
                a = a[15];
                var q = d * h - e * k,
                    G = d * p - g * k,
                    F = d * u - f * k,
                    H = e * p - g * h,
                    I = e * u - f * h,
                    K = g * u - f * p,
                    P = v * z - A * y,
                    S = v * x - B * y;
                v = v * a - m * y;
                var M = A * x - B * z;
                A = A * a - m * z;
                B = B * a - m * x;
                m = q * B - G * A + F * M + H * v - I * S + K * P;
                if (!m) return b;
                m = 1 / m;
                c[0] = (h * B - p * A + u * M) * m;
                c[1] = (p * v - k * B - u * S) * m;
                c[2] = (k * A - h * v + u * P) * m;
                c[3] = (g * A - e * B - f * M) * m;
                c[4] = (d * B - g * v + f * S) * m;
                c[5] = (e * v - d * A - f * P) * m;
                c[6] = (z * K - x * I + a * H) * m;
                c[7] = (x * F - y * K - a * G) * m;
                c[8] = (y * I - z * F + a * q) * m;
                return b
            };
            b.frob = function(b) {
                b = b.m;
                return Math.sqrt(Math.pow(b[0],
                    2) + Math.pow(b[1], 2) + Math.pow(b[2], 2) + Math.pow(b[3], 2) + Math.pow(b[4], 2) + Math.pow(b[5], 2) + Math.pow(b[6], 2) + Math.pow(b[7], 2) + Math.pow(b[8], 2))
            };
            b.add = function(b, c, a) {
                c = c.m;
                a = a.m;
                var d = b.m;
                d[0] = c[0] + a[0];
                d[1] = c[1] + a[1];
                d[2] = c[2] + a[2];
                d[3] = c[3] + a[3];
                d[4] = c[4] + a[4];
                d[5] = c[5] + a[5];
                d[6] = c[6] + a[6];
                d[7] = c[7] + a[7];
                d[8] = c[8] + a[8];
                return b
            };
            b.subtract = function(b, c, a) {
                c = c.m;
                a = a.m;
                var d = b.m;
                d[0] = c[0] - a[0];
                d[1] = c[1] - a[1];
                d[2] = c[2] - a[2];
                d[3] = c[3] - a[3];
                d[4] = c[4] - a[4];
                d[5] = c[5] - a[5];
                d[6] = c[6] - a[6];
                d[7] = c[7] - a[7];
                d[8] =
                    c[8] - a[8];
                return b
            };
            b.multiplyScalar = function(b, c, a) {
                c = c.m;
                var d = b.m;
                d[0] = c[0] * a;
                d[1] = c[1] * a;
                d[2] = c[2] * a;
                d[3] = c[3] * a;
                d[4] = c[4] * a;
                d[5] = c[5] * a;
                d[6] = c[6] * a;
                d[7] = c[7] * a;
                d[8] = c[8] * a;
                return b
            };
            b.multiplyScalarAndAdd = function(b, c, a, d) {
                c = c.m;
                a = a.m;
                var e = b.m;
                e[0] = c[0] + a[0] * d;
                e[1] = c[1] + a[1] * d;
                e[2] = c[2] + a[2] * d;
                e[3] = c[3] + a[3] * d;
                e[4] = c[4] + a[4] * d;
                e[5] = c[5] + a[5] * d;
                e[6] = c[6] + a[6] * d;
                e[7] = c[7] + a[7] * d;
                e[8] = c[8] + a[8] * d;
                return b
            };
            b.exactEquals = function(b, c) {
                b = b.m;
                c = c.m;
                return b[0] === c[0] && b[1] === c[1] && b[2] === c[2] && b[3] ===
                    c[3] && b[4] === c[4] && b[5] === c[5] && b[6] === c[6] && b[7] === c[7] && b[8] === c[8]
            };
            b.equals = function(b, c) {
                var a = b.m,
                    d = c.m;
                c = a[0];
                b = a[1];
                var e = a[2],
                    g = a[3],
                    k = a[4],
                    h = a[5],
                    t = a[6],
                    p = a[7];
                a = a[8];
                var u = d[0],
                    v = d[1],
                    A = d[2],
                    B = d[3],
                    m = d[4],
                    y = d[5],
                    z = d[6],
                    x = d[7];
                d = d[8];
                return Math.abs(c - u) <= f.EPSILON * Math.max(1, Math.abs(c), Math.abs(u)) && Math.abs(b - v) <= f.EPSILON * Math.max(1, Math.abs(b), Math.abs(v)) && Math.abs(e - A) <= f.EPSILON * Math.max(1, Math.abs(e), Math.abs(A)) && Math.abs(g - B) <= f.EPSILON * Math.max(1, Math.abs(g), Math.abs(B)) && Math.abs(k -
                    m) <= f.EPSILON * Math.max(1, Math.abs(k), Math.abs(m)) && Math.abs(h - y) <= f.EPSILON * Math.max(1, Math.abs(h), Math.abs(y)) && Math.abs(t - z) <= f.EPSILON * Math.max(1, Math.abs(t), Math.abs(z)) && Math.abs(p - x) <= f.EPSILON * Math.max(1, Math.abs(p), Math.abs(x)) && Math.abs(a - d) <= f.EPSILON * Math.max(1, Math.abs(a), Math.abs(d))
            };
            b.toArray = function(b, c, a) {
                void 0 === a && (a = 0);
                c = c.m;
                for (var d = 0; 9 > d; d++) b[a + d] = c[d];
                return b
            };
            b.fromArray = function(b, c, a) {
                void 0 === a && (a = 0);
                for (var d = b.m, e = 0; 9 > e; e++) d[e] = c[a + e];
                return b
            };
            b.prototype.toString =
                function() {
                    var b = this.m;
                    return "mat3(" + b[0] + ", " + b[1] + ", " + b[2] + ", " + b[3] + ", " + b[4] + ", " + b[5] + ", " + b[6] + ", " + b[7] + ", " + b[8] + ")"
                };
            return b
        }();
        m["default"] = h;
        h.sub = h.subtract;
        h.mul = h.multiply;
        h.IDENTITY = Object.freeze(new h);
        cc.Mat3 = h;
        q.exports = m["default"]
    }, {
        "../value-types/utils": 308,
        "./vec3": 311
    }],
    303: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var b = f(h("./value-type")),
            k = f(h("../platform/CCClass")),
            c = f(h("./vec3")),
            a = f(h("./quat")),
            d = h("./utils"),
            l = f(h("./mat3")),
            g = 0,
            n = 0,
            w = 0,
            t = 0,
            p = 0,
            u = 0,
            v = 0,
            A = 0,
            B = 0,
            E = 0,
            y = 0,
            z = 0,
            x = 0,
            C = 0,
            G = 0,
            F = 0,
            H = function(b) {
                function f(a, c, g, e, l, f, k, h, n, p, t, u, v, B, w, A) {
                    void 0 === a && (a = 1);
                    void 0 === c && (c = 0);
                    void 0 === g && (g = 0);
                    void 0 === e && (e = 0);
                    void 0 === l && (l = 0);
                    void 0 === f && (f = 1);
                    void 0 === k && (k = 0);
                    void 0 === h && (h = 0);
                    void 0 === n && (n = 0);
                    void 0 === p && (p = 0);
                    void 0 === t && (t = 1);
                    void 0 === u && (u = 0);
                    void 0 === v && (v = 0);
                    void 0 === B && (B = 0);
                    void 0 ===
                        w && (w = 0);
                    void 0 === A && (A = 1);
                    var m = b.call(this) || this;
                    m.m = void 0;
                    if (a instanceof d.FLOAT_ARRAY_TYPE) m.m = a;
                    else {
                        m.m = new d.FLOAT_ARRAY_TYPE(16);
                        var y = m.m;
                        y[0] = a;
                        y[1] = c;
                        y[2] = g;
                        y[3] = e;
                        y[4] = l;
                        y[5] = f;
                        y[6] = k;
                        y[7] = h;
                        y[8] = n;
                        y[9] = p;
                        y[10] = t;
                        y[11] = u;
                        y[12] = v;
                        y[13] = B;
                        y[14] = w;
                        y[15] = A
                    }
                    return m
                }
                e(f, b);
                var k = f.prototype;
                k.mul = function(a, b) {
                    return f.multiply(b || new f, this, a)
                };
                k.mulScalar = function(a, b) {
                    f.multiplyScalar(b || new f, this, a)
                };
                k.sub = function(a, b) {
                    f.subtract(b || new f, this, a)
                };
                f.clone = function(a) {
                    a = a.m;
                    return new f(a[0],
                        a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15])
                };
                f.copy = function(a, b) {
                    var c = a.m;
                    b = b.m;
                    c[0] = b[0];
                    c[1] = b[1];
                    c[2] = b[2];
                    c[3] = b[3];
                    c[4] = b[4];
                    c[5] = b[5];
                    c[6] = b[6];
                    c[7] = b[7];
                    c[8] = b[8];
                    c[9] = b[9];
                    c[10] = b[10];
                    c[11] = b[11];
                    c[12] = b[12];
                    c[13] = b[13];
                    c[14] = b[14];
                    c[15] = b[15];
                    return a
                };
                f.set = function(a, b, c, d, g, e, l, f, k, h, n, p, t, u, v, B, w) {
                    var A = a.m;
                    A[0] = b;
                    A[1] = c;
                    A[2] = d;
                    A[3] = g;
                    A[4] = e;
                    A[5] = l;
                    A[6] = f;
                    A[7] = k;
                    A[8] = h;
                    A[9] = n;
                    A[10] = p;
                    A[11] = t;
                    A[12] = u;
                    A[13] = v;
                    A[14] = B;
                    A[15] = w;
                    return a
                };
                f.identity =
                    function(a) {
                        var b = a.m;
                        b[0] = 1;
                        b[1] = 0;
                        b[2] = 0;
                        b[3] = 0;
                        b[4] = 0;
                        b[5] = 1;
                        b[6] = 0;
                        b[7] = 0;
                        b[8] = 0;
                        b[9] = 0;
                        b[10] = 1;
                        b[11] = 0;
                        b[12] = 0;
                        b[13] = 0;
                        b[14] = 0;
                        b[15] = 1;
                        return a
                    };
                f.transpose = function(a, b) {
                    var c = a.m,
                        d = b.m;
                    if (a === b) {
                        b = d[1];
                        var g = d[2],
                            e = d[3],
                            l = d[6],
                            f = d[7],
                            k = d[11];
                        c[1] = d[4];
                        c[2] = d[8];
                        c[3] = d[12];
                        c[4] = b;
                        c[6] = d[9];
                        c[7] = d[13];
                        c[8] = g;
                        c[9] = l;
                        c[11] = d[14];
                        c[12] = e;
                        c[13] = f;
                        c[14] = k
                    } else c[0] = d[0], c[1] = d[4], c[2] = d[8], c[3] = d[12], c[4] = d[1], c[5] = d[5], c[6] = d[9], c[7] = d[13], c[8] = d[2], c[9] = d[6], c[10] = d[10], c[11] = d[14], c[12] = d[3], c[13] =
                        d[7], c[14] = d[11], c[15] = d[15];
                    return a
                };
                f.invert = function(a, b) {
                    b = b.m;
                    g = b[0];
                    n = b[1];
                    w = b[2];
                    t = b[3];
                    p = b[4];
                    u = b[5];
                    v = b[6];
                    A = b[7];
                    B = b[8];
                    E = b[9];
                    y = b[10];
                    z = b[11];
                    x = b[12];
                    C = b[13];
                    G = b[14];
                    F = b[15];
                    b = g * u - n * p;
                    var c = g * v - w * p,
                        d = g * A - t * p,
                        e = n * v - w * u,
                        l = n * A - t * u,
                        f = w * A - t * v,
                        k = B * C - E * x,
                        h = B * G - y * x,
                        m = B * F - z * x,
                        q = E * G - y * C,
                        L = E * F - z * C,
                        ca = y * F - z * G,
                        O = b * ca - c * L + d * q + e * m - l * h + f * k;
                    if (0 === O) return null;
                    O = 1 / O;
                    var H = a.m;
                    H[0] = (u * ca - v * L + A * q) * O;
                    H[1] = (w * L - n * ca - t * q) * O;
                    H[2] = (C * f - G * l + F * e) * O;
                    H[3] = (y * l - E * f - z * e) * O;
                    H[4] = (v * m - p * ca - A * h) * O;
                    H[5] = (g * ca - w * m + t * h) *
                        O;
                    H[6] = (G * d - x * f - F * c) * O;
                    H[7] = (B * f - y * d + z * c) * O;
                    H[8] = (p * L - u * m + A * k) * O;
                    H[9] = (n * m - g * L - t * k) * O;
                    H[10] = (x * l - C * d + F * b) * O;
                    H[11] = (E * d - B * l - z * b) * O;
                    H[12] = (u * h - p * q - v * k) * O;
                    H[13] = (g * q - n * h + w * k) * O;
                    H[14] = (C * c - x * e - G * b) * O;
                    H[15] = (B * e - E * c + y * b) * O;
                    return a
                };
                f.determinant = function(a) {
                    a = a.m;
                    g = a[0];
                    n = a[1];
                    w = a[2];
                    t = a[3];
                    p = a[4];
                    u = a[5];
                    v = a[6];
                    A = a[7];
                    B = a[8];
                    E = a[9];
                    y = a[10];
                    z = a[11];
                    x = a[12];
                    C = a[13];
                    G = a[14];
                    F = a[15];
                    return (g * u - n * p) * (y * F - z * G) - (g * v - w * p) * (E * F - z * C) + (g * A - t * p) * (E * G - y * C) + (n * v - w * u) * (B * F - z * x) - (n * A - t * u) * (B * G - y * x) + (w * A - t * v) * (B * C - E *
                        x)
                };
                f.multiply = function(a, b, c) {
                    var d = a.m;
                    b = b.m;
                    c = c.m;
                    g = b[0];
                    n = b[1];
                    w = b[2];
                    t = b[3];
                    p = b[4];
                    u = b[5];
                    v = b[6];
                    A = b[7];
                    B = b[8];
                    E = b[9];
                    y = b[10];
                    z = b[11];
                    x = b[12];
                    C = b[13];
                    G = b[14];
                    F = b[15];
                    b = c[0];
                    var e = c[1],
                        l = c[2],
                        f = c[3];
                    d[0] = b * g + e * p + l * B + f * x;
                    d[1] = b * n + e * u + l * E + f * C;
                    d[2] = b * w + e * v + l * y + f * G;
                    d[3] = b * t + e * A + l * z + f * F;
                    b = c[4];
                    e = c[5];
                    l = c[6];
                    f = c[7];
                    d[4] = b * g + e * p + l * B + f * x;
                    d[5] = b * n + e * u + l * E + f * C;
                    d[6] = b * w + e * v + l * y + f * G;
                    d[7] = b * t + e * A + l * z + f * F;
                    b = c[8];
                    e = c[9];
                    l = c[10];
                    f = c[11];
                    d[8] = b * g + e * p + l * B + f * x;
                    d[9] = b * n + e * u + l * E + f * C;
                    d[10] = b * w + e * v + l * y + f * G;
                    d[11] = b *
                        t + e * A + l * z + f * F;
                    b = c[12];
                    e = c[13];
                    l = c[14];
                    f = c[15];
                    d[12] = b * g + e * p + l * B + f * x;
                    d[13] = b * n + e * u + l * E + f * C;
                    d[14] = b * w + e * v + l * y + f * G;
                    d[15] = b * t + e * A + l * z + f * F;
                    return a
                };
                f.transform = function(a, b, c) {
                    var d = c.x,
                        e = c.y;
                    c = c.z;
                    var l = a.m,
                        f = b.m;
                    b === a ? (l[12] = f[0] * d + f[4] * e + f[8] * c + f[12], l[13] = f[1] * d + f[5] * e + f[9] * c + f[13], l[14] = f[2] * d + f[6] * e + f[10] * c + f[14], l[15] = f[3] * d + f[7] * e + f[11] * c + f[15]) : (g = f[0], n = f[1], w = f[2], t = f[3], p = f[4], u = f[5], v = f[6], A = f[7], B = f[8], E = f[9], y = f[10], z = f[11], x = f[12], C = f[13], G = f[14], F = f[15], l[0] = g, l[1] = n, l[2] = w, l[3] = t, l[4] =
                        p, l[5] = u, l[6] = v, l[7] = A, l[8] = B, l[9] = E, l[10] = y, l[11] = z, l[12] = g * d + p * e + B * c + f[12], l[13] = n * d + u * e + E * c + f[13], l[14] = w * d + v * e + y * c + f[14], l[15] = t * d + A * e + z * c + f[15]);
                    return a
                };
                f.translate = function(a, b, c) {
                    var d = a.m,
                        g = b.m;
                    b === a ? (d[12] += c.x, d[13] += c.y, d[14] += c.z) : (d[0] = g[0], d[1] = g[1], d[2] = g[2], d[3] = g[3], d[4] = g[4], d[5] = g[5], d[6] = g[6], d[7] = g[7], d[8] = g[8], d[9] = g[9], d[10] = g[10], d[11] = g[11], d[12] += c.x, d[13] += c.y, d[14] += c.z, d[15] = g[15]);
                    return a
                };
                f.scale = function(a, b, c) {
                    var d = c.x,
                        g = c.y;
                    c = c.z;
                    var e = a.m;
                    b = b.m;
                    e[0] = b[0] * d;
                    e[1] =
                        b[1] * d;
                    e[2] = b[2] * d;
                    e[3] = b[3] * d;
                    e[4] = b[4] * g;
                    e[5] = b[5] * g;
                    e[6] = b[6] * g;
                    e[7] = b[7] * g;
                    e[8] = b[8] * c;
                    e[9] = b[9] * c;
                    e[10] = b[10] * c;
                    e[11] = b[11] * c;
                    e[12] = b[12];
                    e[13] = b[13];
                    e[14] = b[14];
                    e[15] = b[15];
                    return a
                };
                f.rotate = function(a, b, c, e) {
                    var l = e.x,
                        f = e.y;
                    e = e.z;
                    var k = Math.sqrt(l * l + f * f + e * e);
                    if (Math.abs(k) < d.EPSILON) return null;
                    k = 1 / k;
                    l *= k;
                    f *= k;
                    e *= k;
                    var h = Math.sin(c),
                        m = Math.cos(c),
                        x = 1 - m;
                    c = b.m;
                    g = c[0];
                    n = c[1];
                    w = c[2];
                    t = c[3];
                    p = c[4];
                    u = c[5];
                    v = c[6];
                    A = c[7];
                    B = c[8];
                    E = c[9];
                    y = c[10];
                    z = c[11];
                    k = l * l * x + m;
                    var q = f * l * x + e * h,
                        C = e * l * x - f * h,
                        ca = l * f * x -
                        e * h,
                        G = f * f * x + m,
                        F = e * f * x + l * h,
                        L = l * e * x + f * h;
                    l = f * e * x - l * h;
                    f = e * e * x + m;
                    e = a.m;
                    e[0] = g * k + p * q + B * C;
                    e[1] = n * k + u * q + E * C;
                    e[2] = w * k + v * q + y * C;
                    e[3] = t * k + A * q + z * C;
                    e[4] = g * ca + p * G + B * F;
                    e[5] = n * ca + u * G + E * F;
                    e[6] = w * ca + v * G + y * F;
                    e[7] = t * ca + A * G + z * F;
                    e[8] = g * L + p * l + B * f;
                    e[9] = n * L + u * l + E * f;
                    e[10] = w * L + v * l + y * f;
                    e[11] = t * L + A * l + z * f;
                    b !== a && (e[12] = c[12], e[13] = c[13], e[14] = c[14], e[15] = c[15]);
                    return a
                };
                f.rotateX = function(a, b, c) {
                    var d = a.m,
                        g = b.m,
                        e = Math.sin(c);
                    c = Math.cos(c);
                    var l = g[4],
                        f = g[5],
                        k = g[6],
                        h = g[7],
                        n = g[8],
                        p = g[9],
                        t = g[10],
                        u = g[11];
                    b !== a && (d[0] = g[0], d[1] = g[1],
                        d[2] = g[2], d[3] = g[3], d[12] = g[12], d[13] = g[13], d[14] = g[14], d[15] = g[15]);
                    d[4] = l * c + n * e;
                    d[5] = f * c + p * e;
                    d[6] = k * c + t * e;
                    d[7] = h * c + u * e;
                    d[8] = n * c - l * e;
                    d[9] = p * c - f * e;
                    d[10] = t * c - k * e;
                    d[11] = u * c - h * e;
                    return a
                };
                f.rotateY = function(a, b, c) {
                    var d = a.m,
                        g = b.m,
                        e = Math.sin(c);
                    c = Math.cos(c);
                    var l = g[0],
                        f = g[1],
                        k = g[2],
                        h = g[3],
                        n = g[8],
                        p = g[9],
                        t = g[10],
                        u = g[11];
                    b !== a && (d[4] = g[4], d[5] = g[5], d[6] = g[6], d[7] = g[7], d[12] = g[12], d[13] = g[13], d[14] = g[14], d[15] = g[15]);
                    d[0] = l * c - n * e;
                    d[1] = f * c - p * e;
                    d[2] = k * c - t * e;
                    d[3] = h * c - u * e;
                    d[8] = l * e + n * c;
                    d[9] = f * e + p * c;
                    d[10] = k * e +
                        t * c;
                    d[11] = h * e + u * c;
                    return a
                };
                f.rotateZ = function(a, b, c) {
                    var d = b.m,
                        g = a.m,
                        e = Math.sin(c);
                    c = Math.cos(c);
                    var l = b.m[0],
                        f = b.m[1],
                        k = b.m[2],
                        h = b.m[3],
                        n = b.m[4],
                        p = b.m[5],
                        t = b.m[6],
                        u = b.m[7];
                    b !== a && (g[8] = d[8], g[9] = d[9], g[10] = d[10], g[11] = d[11], g[12] = d[12], g[13] = d[13], g[14] = d[14], g[15] = d[15]);
                    g[0] = l * c + n * e;
                    g[1] = f * c + p * e;
                    g[2] = k * c + t * e;
                    g[3] = h * c + u * e;
                    g[4] = n * c - l * e;
                    g[5] = p * c - f * e;
                    g[6] = t * c - k * e;
                    g[7] = u * c - h * e;
                    return a
                };
                f.fromTranslation = function(a, b) {
                    var c = a.m;
                    c[0] = 1;
                    c[1] = 0;
                    c[2] = 0;
                    c[3] = 0;
                    c[4] = 0;
                    c[5] = 1;
                    c[6] = 0;
                    c[7] = 0;
                    c[8] = 0;
                    c[9] = 0;
                    c[10] = 1;
                    c[11] = 0;
                    c[12] = b.x;
                    c[13] = b.y;
                    c[14] = b.z;
                    c[15] = 1;
                    return a
                };
                f.fromScaling = function(a, b) {
                    var c = a.m;
                    c[0] = b.x;
                    c[1] = 0;
                    c[2] = 0;
                    c[3] = 0;
                    c[4] = 0;
                    c[5] = b.y;
                    c[6] = 0;
                    c[7] = 0;
                    c[8] = 0;
                    c[9] = 0;
                    c[10] = b.z;
                    c[11] = 0;
                    c[12] = 0;
                    c[13] = 0;
                    c[14] = 0;
                    c[15] = 1;
                    return a
                };
                f.fromRotation = function(a, b, c) {
                    var g = c.x,
                        e = c.y;
                    c = c.z;
                    var l = Math.sqrt(g * g + e * e + c * c);
                    if (Math.abs(l) < d.EPSILON) return null;
                    l = 1 / l;
                    g *= l;
                    e *= l;
                    c *= l;
                    l = Math.sin(b);
                    b = Math.cos(b);
                    var f = 1 - b,
                        k = a.m;
                    k[0] = g * g * f + b;
                    k[1] = e * g * f + c * l;
                    k[2] = c * g * f - e * l;
                    k[3] = 0;
                    k[4] = g * e * f - c * l;
                    k[5] = e * e * f + b;
                    k[6] =
                        c * e * f + g * l;
                    k[7] = 0;
                    k[8] = g * c * f + e * l;
                    k[9] = e * c * f - g * l;
                    k[10] = c * c * f + b;
                    k[11] = 0;
                    k[12] = 0;
                    k[13] = 0;
                    k[14] = 0;
                    k[15] = 1;
                    return a
                };
                f.fromXRotation = function(a, b) {
                    var c = Math.sin(b);
                    b = Math.cos(b);
                    var d = a.m;
                    d[0] = 1;
                    d[1] = 0;
                    d[2] = 0;
                    d[3] = 0;
                    d[4] = 0;
                    d[5] = b;
                    d[6] = c;
                    d[7] = 0;
                    d[8] = 0;
                    d[9] = -c;
                    d[10] = b;
                    d[11] = 0;
                    d[12] = 0;
                    d[13] = 0;
                    d[14] = 0;
                    d[15] = 1;
                    return a
                };
                f.fromYRotation = function(a, b) {
                    var c = Math.sin(b);
                    b = Math.cos(b);
                    var d = a.m;
                    d[0] = b;
                    d[1] = 0;
                    d[2] = -c;
                    d[3] = 0;
                    d[4] = 0;
                    d[5] = 1;
                    d[6] = 0;
                    d[7] = 0;
                    d[8] = c;
                    d[9] = 0;
                    d[10] = b;
                    d[11] = 0;
                    d[12] = 0;
                    d[13] = 0;
                    d[14] = 0;
                    d[15] =
                        1;
                    return a
                };
                f.fromZRotation = function(a, b) {
                    var c = Math.sin(b);
                    b = Math.cos(b);
                    var d = a.m;
                    d[0] = b;
                    d[1] = c;
                    d[2] = 0;
                    d[3] = 0;
                    d[4] = -c;
                    d[5] = b;
                    d[6] = 0;
                    d[7] = 0;
                    d[8] = 0;
                    d[9] = 0;
                    d[10] = 1;
                    d[11] = 0;
                    d[12] = 0;
                    d[13] = 0;
                    d[14] = 0;
                    d[15] = 1;
                    return a
                };
                f.fromRT = function(a, b, c) {
                    var d = b.x,
                        g = b.y,
                        e = b.z,
                        l = b.w,
                        f = d + d,
                        k = g + g,
                        h = e + e;
                    b = d * f;
                    var n = d * k;
                    d *= h;
                    var p = g * k;
                    g *= h;
                    e *= h;
                    f *= l;
                    k *= l;
                    l *= h;
                    h = a.m;
                    h[0] = 1 - (p + e);
                    h[1] = n + l;
                    h[2] = d - k;
                    h[3] = 0;
                    h[4] = n - l;
                    h[5] = 1 - (b + e);
                    h[6] = g + f;
                    h[7] = 0;
                    h[8] = d + k;
                    h[9] = g - f;
                    h[10] = 1 - (b + p);
                    h[11] = 0;
                    h[12] = c.x;
                    h[13] = c.y;
                    h[14] = c.z;
                    h[15] = 1;
                    return a
                };
                f.getTranslation = function(a, b) {
                    b = b.m;
                    a.x = b[12];
                    a.y = b[13];
                    a.z = b[14];
                    return a
                };
                f.getScaling = function(a, b) {
                    var c = b.m,
                        d = K.m;
                    b = d[0] = c[0];
                    var g = d[1] = c[1],
                        e = d[2] = c[2],
                        f = d[3] = c[4],
                        k = d[4] = c[5],
                        h = d[5] = c[6],
                        n = d[6] = c[8],
                        p = d[7] = c[9];
                    c = d[8] = c[10];
                    a.x = Math.sqrt(b * b + g * g + e * e);
                    a.y = Math.sqrt(f * f + k * k + h * h);
                    a.z = Math.sqrt(n * n + p * p + c * c);
                    0 > l["default"].determinant(K) && (a.x *= -1);
                    return a
                };
                f.getRotation = function(a, b) {
                    b = b.m;
                    var c = b[0] + b[5] + b[10];
                    0 < c ? (c = 2 * Math.sqrt(c + 1), a.w = .25 * c, a.x = (b[6] - b[9]) / c, a.y = (b[8] - b[2]) / c, a.z = (b[1] -
                        b[4]) / c) : b[0] > b[5] && b[0] > b[10] ? (c = 2 * Math.sqrt(1 + b[0] - b[5] - b[10]), a.w = (b[6] - b[9]) / c, a.x = .25 * c, a.y = (b[1] + b[4]) / c, a.z = (b[8] + b[2]) / c) : b[5] > b[10] ? (c = 2 * Math.sqrt(1 + b[5] - b[0] - b[10]), a.w = (b[8] - b[2]) / c, a.x = (b[1] + b[4]) / c, a.y = .25 * c, a.z = (b[6] + b[9]) / c) : (c = 2 * Math.sqrt(1 + b[10] - b[0] - b[5]), a.w = (b[1] - b[4]) / c, a.x = (b[8] + b[2]) / c, a.y = (b[6] + b[9]) / c, a.z = .25 * c);
                    return a
                };
                f.toRTS = function(b, d, g, e) {
                    b = b.m;
                    var f = K.m;
                    e.x = c["default"].set(I, b[0], b[1], b[2]).mag();
                    f[0] = b[0] / e.x;
                    f[1] = b[1] / e.x;
                    f[2] = b[2] / e.x;
                    e.y = c["default"].set(I,
                        b[4], b[5], b[6]).mag();
                    f[3] = b[4] / e.y;
                    f[4] = b[5] / e.y;
                    f[5] = b[6] / e.y;
                    e.z = c["default"].set(I, b[8], b[9], b[10]).mag();
                    f[6] = b[8] / e.z;
                    f[7] = b[9] / e.z;
                    f[8] = b[10] / e.z;
                    0 > l["default"].determinant(K) && (e.x *= -1, f[0] *= -1, f[1] *= -1, f[2] *= -1);
                    a["default"].fromMat3(d, K);
                    c["default"].set(g, b[12], b[13], b[14])
                };
                f.fromRTS = function(a, b, c, d) {
                    var g = b.x,
                        e = b.y,
                        l = b.z,
                        f = b.w,
                        k = g + g,
                        h = e + e,
                        n = l + l;
                    b = g * k;
                    var p = g * h;
                    g *= n;
                    var t = e * h;
                    e *= n;
                    l *= n;
                    k *= f;
                    h *= f;
                    f *= n;
                    n = d.x;
                    var u = d.y;
                    d = d.z;
                    var v = a.m;
                    v[0] = (1 - (t + l)) * n;
                    v[1] = (p + f) * n;
                    v[2] = (g - h) * n;
                    v[3] = 0;
                    v[4] =
                        (p - f) * u;
                    v[5] = (1 - (b + l)) * u;
                    v[6] = (e + k) * u;
                    v[7] = 0;
                    v[8] = (g + h) * d;
                    v[9] = (e - k) * d;
                    v[10] = (1 - (b + t)) * d;
                    v[11] = 0;
                    v[12] = c.x;
                    v[13] = c.y;
                    v[14] = c.z;
                    v[15] = 1;
                    return a
                };
                f.fromRTSOrigin = function(a, b, c, d, g) {
                    var e = b.x,
                        l = b.y,
                        f = b.z,
                        k = b.w,
                        h = e + e,
                        n = l + l,
                        p = f + f;
                    b = e * h;
                    var t = e * n;
                    e *= p;
                    var u = l * n;
                    l *= p;
                    f *= p;
                    h *= k;
                    n *= k;
                    k *= p;
                    p = d.x;
                    var v = d.y;
                    d = d.z;
                    var B = g.x,
                        A = g.y;
                    g = g.z;
                    var w = a.m;
                    w[0] = (1 - (u + f)) * p;
                    w[1] = (t + k) * p;
                    w[2] = (e - n) * p;
                    w[3] = 0;
                    w[4] = (t - k) * v;
                    w[5] = (1 - (b + f)) * v;
                    w[6] = (l + h) * v;
                    w[7] = 0;
                    w[8] = (e + n) * d;
                    w[9] = (l - h) * d;
                    w[10] = (1 - (b + u)) * d;
                    w[11] = 0;
                    w[12] = c.x + B -
                        (w[0] * B + w[4] * A + w[8] * g);
                    w[13] = c.y + A - (w[1] * B + w[5] * A + w[9] * g);
                    w[14] = c.z + g - (w[2] * B + w[6] * A + w[10] * g);
                    w[15] = 1;
                    return a
                };
                f.fromQuat = function(a, b) {
                    var c = b.x,
                        d = b.y,
                        g = b.z,
                        e = b.w,
                        l = c + c,
                        f = d + d,
                        k = g + g;
                    c *= l;
                    b = d * l;
                    d *= f;
                    var h = g * l,
                        n = g * f;
                    g *= k;
                    l *= e;
                    f *= e;
                    e *= k;
                    k = a.m;
                    k[0] = 1 - d - g;
                    k[1] = b + e;
                    k[2] = h - f;
                    k[3] = 0;
                    k[4] = b - e;
                    k[5] = 1 - c - g;
                    k[6] = n + l;
                    k[7] = 0;
                    k[8] = h + f;
                    k[9] = n - l;
                    k[10] = 1 - c - d;
                    k[11] = 0;
                    k[12] = 0;
                    k[13] = 0;
                    k[14] = 0;
                    k[15] = 1;
                    return a
                };
                f.frustum = function(a, b, c, d, g, e, l) {
                    var f = 1 / (c - b),
                        k = 1 / (g - d),
                        h = 1 / (e - l),
                        n = a.m;
                    n[0] = 2 * e * f;
                    n[1] = 0;
                    n[2] = 0;
                    n[3] = 0;
                    n[4] =
                        0;
                    n[5] = 2 * e * k;
                    n[6] = 0;
                    n[7] = 0;
                    n[8] = (c + b) * f;
                    n[9] = (g + d) * k;
                    n[10] = (l + e) * h;
                    n[11] = -1;
                    n[12] = 0;
                    n[13] = 0;
                    n[14] = l * e * 2 * h;
                    n[15] = 0;
                    return a
                };
                f.perspective = function(a, b, c, d, g) {
                    b = 1 / Math.tan(b / 2);
                    var e = 1 / (d - g),
                        l = a.m;
                    l[0] = b / c;
                    l[1] = 0;
                    l[2] = 0;
                    l[3] = 0;
                    l[4] = 0;
                    l[5] = b;
                    l[6] = 0;
                    l[7] = 0;
                    l[8] = 0;
                    l[9] = 0;
                    l[10] = (g + d) * e;
                    l[11] = -1;
                    l[12] = 0;
                    l[13] = 0;
                    l[14] = 2 * g * d * e;
                    l[15] = 0;
                    return a
                };
                f.ortho = function(a, b, c, d, g, e, l) {
                    var f = 1 / (b - c),
                        k = 1 / (d - g),
                        h = 1 / (e - l),
                        n = a.m;
                    n[0] = -2 * f;
                    n[1] = 0;
                    n[2] = 0;
                    n[3] = 0;
                    n[4] = 0;
                    n[5] = -2 * k;
                    n[6] = 0;
                    n[7] = 0;
                    n[8] = 0;
                    n[9] = 0;
                    n[10] = 2 * h;
                    n[11] =
                        0;
                    n[12] = (b + c) * f;
                    n[13] = (g + d) * k;
                    n[14] = (l + e) * h;
                    n[15] = 1;
                    return a
                };
                f.lookAt = function(a, b, c, d) {
                    var g = b.x,
                        e = b.y;
                    b = b.z;
                    var l = d.x,
                        f = d.y,
                        k = d.z;
                    d = g - c.x;
                    var h = e - c.y;
                    c = b - c.z;
                    var n = 1 / Math.sqrt(d * d + h * h + c * c);
                    d *= n;
                    h *= n;
                    c *= n;
                    var p = f * c - k * h;
                    k = k * d - l * c;
                    l = l * h - f * d;
                    n = 1 / Math.sqrt(p * p + k * k + l * l);
                    p *= n;
                    k *= n;
                    l *= n;
                    f = h * l - c * k;
                    n = c * p - d * l;
                    var t = d * k - h * p,
                        u = a.m;
                    u[0] = p;
                    u[1] = f;
                    u[2] = d;
                    u[3] = 0;
                    u[4] = k;
                    u[5] = n;
                    u[6] = h;
                    u[7] = 0;
                    u[8] = l;
                    u[9] = t;
                    u[10] = c;
                    u[11] = 0;
                    u[12] = -(p * g + k * e + l * b);
                    u[13] = -(f * g + n * e + t * b);
                    u[14] = -(d * g + h * e + c * b);
                    u[15] = 1;
                    return a
                };
                f.inverseTranspose =
                    function(a, b) {
                        b = b.m;
                        g = b[0];
                        n = b[1];
                        w = b[2];
                        t = b[3];
                        p = b[4];
                        u = b[5];
                        v = b[6];
                        A = b[7];
                        B = b[8];
                        E = b[9];
                        y = b[10];
                        z = b[11];
                        x = b[12];
                        C = b[13];
                        G = b[14];
                        F = b[15];
                        var c = g * u - n * p,
                            d = g * v - w * p,
                            e = g * A - t * p,
                            l = n * v - w * u,
                            f = n * A - t * u,
                            k = w * A - t * v,
                            h = B * C - E * x,
                            m = B * G - y * x,
                            q = B * F - z * x,
                            H = E * G - y * C,
                            ca = E * F - z * C,
                            L = y * F - z * G,
                            O = c * L - d * ca + e * H + l * q - f * m + k * h;
                        if (!O) return null;
                        O = 1 / O;
                        b = a.m;
                        b[0] = (u * L - v * ca + A * H) * O;
                        b[1] = (v * q - p * L - A * m) * O;
                        b[2] = (p * ca - u * q + A * h) * O;
                        b[3] = 0;
                        b[4] = (w * ca - n * L - t * H) * O;
                        b[5] = (g * L - w * q + t * m) * O;
                        b[6] = (n * q - g * ca - t * h) * O;
                        b[7] = 0;
                        b[8] = (C * k - G * f + F * l) * O;
                        b[9] = (G * e - x * k - F *
                            d) * O;
                        b[10] = (x * f - C * e + F * c) * O;
                        b[11] = 0;
                        b[12] = 0;
                        b[13] = 0;
                        b[14] = 0;
                        b[15] = 1;
                        return a
                    };
                f.add = function(a, b, c) {
                    var d = a.m;
                    b = b.m;
                    c = c.m;
                    d[0] = b[0] + c[0];
                    d[1] = b[1] + c[1];
                    d[2] = b[2] + c[2];
                    d[3] = b[3] + c[3];
                    d[4] = b[4] + c[4];
                    d[5] = b[5] + c[5];
                    d[6] = b[6] + c[6];
                    d[7] = b[7] + c[7];
                    d[8] = b[8] + c[8];
                    d[9] = b[9] + c[9];
                    d[10] = b[10] + c[10];
                    d[11] = b[11] + c[11];
                    d[12] = b[12] + c[12];
                    d[13] = b[13] + c[13];
                    d[14] = b[14] + c[14];
                    d[15] = b[15] + c[15];
                    return a
                };
                f.subtract = function(a, b, c) {
                    var d = a.m;
                    b = b.m;
                    c = c.m;
                    d[0] = b[0] - c[0];
                    d[1] = b[1] - c[1];
                    d[2] = b[2] - c[2];
                    d[3] = b[3] - c[3];
                    d[4] =
                        b[4] - c[4];
                    d[5] = b[5] - c[5];
                    d[6] = b[6] - c[6];
                    d[7] = b[7] - c[7];
                    d[8] = b[8] - c[8];
                    d[9] = b[9] - c[9];
                    d[10] = b[10] - c[10];
                    d[11] = b[11] - c[11];
                    d[12] = b[12] - c[12];
                    d[13] = b[13] - c[13];
                    d[14] = b[14] - c[14];
                    d[15] = b[15] - c[15];
                    return a
                };
                f.multiplyScalar = function(a, b, c) {
                    var d = a.m;
                    b = b.m;
                    d[0] = b[0] * c;
                    d[1] = b[1] * c;
                    d[2] = b[2] * c;
                    d[3] = b[3] * c;
                    d[4] = b[4] * c;
                    d[5] = b[5] * c;
                    d[6] = b[6] * c;
                    d[7] = b[7] * c;
                    d[8] = b[8] * c;
                    d[9] = b[9] * c;
                    d[10] = b[10] * c;
                    d[11] = b[11] * c;
                    d[12] = b[12] * c;
                    d[13] = b[13] * c;
                    d[14] = b[14] * c;
                    d[15] = b[15] * c;
                    return a
                };
                f.multiplyScalarAndAdd = function(a, b,
                    c, d) {
                    var g = a.m;
                    b = b.m;
                    c = c.m;
                    g[0] = b[0] + c[0] * d;
                    g[1] = b[1] + c[1] * d;
                    g[2] = b[2] + c[2] * d;
                    g[3] = b[3] + c[3] * d;
                    g[4] = b[4] + c[4] * d;
                    g[5] = b[5] + c[5] * d;
                    g[6] = b[6] + c[6] * d;
                    g[7] = b[7] + c[7] * d;
                    g[8] = b[8] + c[8] * d;
                    g[9] = b[9] + c[9] * d;
                    g[10] = b[10] + c[10] * d;
                    g[11] = b[11] + c[11] * d;
                    g[12] = b[12] + c[12] * d;
                    g[13] = b[13] + c[13] * d;
                    g[14] = b[14] + c[14] * d;
                    g[15] = b[15] + c[15] * d;
                    return a
                };
                f.strictEquals = function(a, b) {
                    a = a.m;
                    b = b.m;
                    return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] &&
                        a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15]
                };
                f.equals = function(a, b, c) {
                    void 0 === c && (c = d.EPSILON);
                    a = a.m;
                    b = b.m;
                    return Math.abs(a[0] - b[0]) <= c * Math.max(1, Math.abs(a[0]), Math.abs(b[0])) && Math.abs(a[1] - b[1]) <= c * Math.max(1, Math.abs(a[1]), Math.abs(b[1])) && Math.abs(a[2] - b[2]) <= c * Math.max(1, Math.abs(a[2]), Math.abs(b[2])) && Math.abs(a[3] - b[3]) <= c * Math.max(1, Math.abs(a[3]), Math.abs(b[3])) && Math.abs(a[4] - b[4]) <= c * Math.max(1, Math.abs(a[4]), Math.abs(b[4])) && Math.abs(a[5] -
                        b[5]) <= c * Math.max(1, Math.abs(a[5]), Math.abs(b[5])) && Math.abs(a[6] - b[6]) <= c * Math.max(1, Math.abs(a[6]), Math.abs(b[6])) && Math.abs(a[7] - b[7]) <= c * Math.max(1, Math.abs(a[7]), Math.abs(b[7])) && Math.abs(a[8] - b[8]) <= c * Math.max(1, Math.abs(a[8]), Math.abs(b[8])) && Math.abs(a[9] - b[9]) <= c * Math.max(1, Math.abs(a[9]), Math.abs(b[9])) && Math.abs(a[10] - b[10]) <= c * Math.max(1, Math.abs(a[10]), Math.abs(b[10])) && Math.abs(a[11] - b[11]) <= c * Math.max(1, Math.abs(a[11]), Math.abs(b[11])) && Math.abs(a[12] - b[12]) <= c * Math.max(1, Math.abs(a[12]),
                        Math.abs(b[12])) && Math.abs(a[13] - b[13]) <= c * Math.max(1, Math.abs(a[13]), Math.abs(b[13])) && Math.abs(a[14] - b[14]) <= c * Math.max(1, Math.abs(a[14]), Math.abs(b[14])) && Math.abs(a[15] - b[15]) <= c * Math.max(1, Math.abs(a[15]), Math.abs(b[15]))
                };
                f.adjoint = function(a, b) {
                    var c = b.m;
                    b = a.m;
                    var d = c[0],
                        g = c[1],
                        e = c[2],
                        l = c[3],
                        f = c[4],
                        k = c[5],
                        h = c[6],
                        n = c[7],
                        p = c[8],
                        u = c[9],
                        t = c[10],
                        v = c[11],
                        B = c[12],
                        w = c[13],
                        A = c[14];
                    c = c[15];
                    b[0] = k * (t * c - v * A) - u * (h * c - n * A) + w * (h * v - n * t);
                    b[1] = -(g * (t * c - v * A) - u * (e * c - l * A) + w * (e * v - l * t));
                    b[2] = g * (h * c - n * A) - k * (e * c - l *
                        A) + w * (e * n - l * h);
                    b[3] = -(g * (h * v - n * t) - k * (e * v - l * t) + u * (e * n - l * h));
                    b[4] = -(f * (t * c - v * A) - p * (h * c - n * A) + B * (h * v - n * t));
                    b[5] = d * (t * c - v * A) - p * (e * c - l * A) + B * (e * v - l * t);
                    b[6] = -(d * (h * c - n * A) - f * (e * c - l * A) + B * (e * n - l * h));
                    b[7] = d * (h * v - n * t) - f * (e * v - l * t) + p * (e * n - l * h);
                    b[8] = f * (u * c - v * w) - p * (k * c - n * w) + B * (k * v - n * u);
                    b[9] = -(d * (u * c - v * w) - p * (g * c - l * w) + B * (g * v - l * u));
                    b[10] = d * (k * c - n * w) - f * (g * c - l * w) + B * (g * n - l * k);
                    b[11] = -(d * (k * v - n * u) - f * (g * v - l * u) + p * (g * n - l * k));
                    b[12] = -(f * (u * A - t * w) - p * (k * A - h * w) + B * (k * t - h * u));
                    b[13] = d * (u * A - t * w) - p * (g * A - e * w) + B * (g * t - e * u);
                    b[14] = -(d * (k *
                        A - h * w) - f * (g * A - e * w) + B * (g * h - e * k));
                    b[15] = d * (k * t - h * u) - f * (g * t - e * u) + p * (g * h - e * k);
                    return a
                };
                f.toArray = function(a, b, c) {
                    void 0 === c && (c = 0);
                    b = b.m;
                    for (var d = 0; 16 > d; d++) a[c + d] = b[d];
                    return a
                };
                f.fromArray = function(a, b, c) {
                    void 0 === c && (c = 0);
                    for (var d = a.m, g = 0; 16 > g; g++) d[g] = b[c + g];
                    return a
                };
                k.clone = function() {
                    var a = this.m;
                    return new f(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15])
                };
                k.set = function(a) {
                    var b = this.m;
                    a = a.m;
                    b[0] = a[0];
                    b[1] = a[1];
                    b[2] = a[2];
                    b[3] = a[3];
                    b[4] = a[4];
                    b[5] = a[5];
                    b[6] = a[6];
                    b[7] = a[7];
                    b[8] = a[8];
                    b[9] = a[9];
                    b[10] = a[10];
                    b[11] = a[11];
                    b[12] = a[12];
                    b[13] = a[13];
                    b[14] = a[14];
                    b[15] = a[15];
                    return this
                };
                k.equals = function(a) {
                    return f.strictEquals(this, a)
                };
                k.fuzzyEquals = function(a) {
                    return f.equals(this, a)
                };
                k.toString = function() {
                    var a = this.m;
                    return a ? "[\n" + a[0] + ", " + a[1] + ", " + a[2] + ", " + a[3] + ",\n" + a[4] + ", " + a[5] + ", " + a[6] + ", " + a[7] + ",\n" + a[8] + ", " + a[9] + ", " + a[10] + ", " + a[11] + ",\n" + a[12] + ", " + a[13] + ", " + a[14] + ", " + a[15] + "\n]" : "[\n1, 0, 0, 0\n0, 1, 0, 0\n0, 0, 1, 0\n0, 0, 0, 1\n]"
                };
                k.identity = function() {
                    return f.identity(this)
                };
                k.transpose = function(a) {
                    a = a || new f;
                    return f.transpose(a, this)
                };
                k.invert = function(a) {
                    a = a || new f;
                    return f.invert(a, this)
                };
                k.adjoint = function(a) {
                    a = a || new f;
                    return f.adjoint(a, this)
                };
                k.determinant = function() {
                    return f.determinant(this)
                };
                k.add = function(a, b) {
                    b = b || new f;
                    return f.add(b, this, a)
                };
                k.subtract = function(a) {
                    return f.subtract(this, this, a)
                };
                k.multiply = function(a) {
                    return f.multiply(this, this, a)
                };
                k.multiplyScalar = function(a) {
                    return f.multiplyScalar(this,
                        this, a)
                };
                k.translate = function(a, b) {
                    b = b || new f;
                    return f.translate(b, this, a)
                };
                k.scale = function(a, b) {
                    b = b || new f;
                    return f.scale(b, this, a)
                };
                k.rotate = function(a, b, c) {
                    c = c || new f;
                    return f.rotate(c, this, a, b)
                };
                k.getTranslation = function(a) {
                    a = a || new c["default"];
                    return f.getTranslation(a, this)
                };
                k.getScale = function(a) {
                    a = a || new c["default"];
                    return f.getScaling(a, this)
                };
                k.getRotation = function(b) {
                    b = b || new a["default"];
                    return f.getRotation(b, this)
                };
                k.fromRTS = function(a, b, c) {
                    return f.fromRTS(this, a, b, c)
                };
                k.fromQuat =
                    function(a) {
                        return f.fromQuat(this, a)
                    };
                return f
            }(b["default"]);
        m["default"] = H;
        H.mul = H.multiply;
        H.sub = H.subtract;
        H.IDENTITY = Object.freeze(new H);
        var I = new c["default"],
            K = new l["default"];
        k["default"].fastDefine("cc.Mat4", H, {
            m00: 1,
            m01: 0,
            m02: 0,
            m03: 0,
            m04: 0,
            m05: 1,
            m06: 0,
            m07: 0,
            m08: 0,
            m09: 0,
            m10: 1,
            m11: 0,
            m12: 0,
            m13: 0,
            m14: 0,
            m15: 1
        });
        h = function(a) {
            Object.defineProperty(H.prototype, "m" + a, {
                get: function() {
                    return this.m[a]
                },
                set: function(b) {
                    this.m[a] = b
                }
            })
        };
        for (b = 0; 16 > b; b++) h(b);
        cc.mat4 = function(a, b, c, d, g, e, l, f, k, h, n,
            p, u, t, v, B) {
            b = new H(a, b, c, d, g, e, l, f, k, h, n, p, u, t, v, B);
            void 0 === a && H.identity(b);
            return b
        };
        cc.Mat4 = H;
        q.exports = m["default"]
    }, {
        "../platform/CCClass": 204,
        "./mat3": 302,
        "./quat": 304,
        "./utils": 308,
        "./value-type": 309,
        "./vec3": 311
    }],
    304: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var b = f(h("./value-type")),
            k = f(h("../platform/CCClass")),
            c = f(h("./vec3")),
            a =
            f(h("./mat3")),
            d = h("./utils"),
            l = 0,
            g = 0,
            n = 0,
            w = 0,
            t = function(b) {
                function f(a, c, d, g) {
                    void 0 === a && (a = 0);
                    void 0 === c && (c = 0);
                    void 0 === d && (d = 0);
                    void 0 === g && (g = 1);
                    var e = b.call(this) || this;
                    e.x = void 0;
                    e.y = void 0;
                    e.z = void 0;
                    e.w = void 0;
                    a && "object" === typeof a ? (e.x = a.x, e.y = a.y, e.z = a.z, e.w = a.w) : (e.x = a, e.y = c, e.z = d, e.w = g);
                    return e
                }
                e(f, b);
                var k = f.prototype;
                k.mul = function(a, b) {
                    return f.multiply(b || new f, this, a)
                };
                f.clone = function(a) {
                    return new f(a.x, a.y, a.z, a.w)
                };
                f.copy = function(a, b) {
                    a.x = b.x;
                    a.y = b.y;
                    a.z = b.z;
                    a.w = b.w;
                    return a
                };
                f.set = function(a, b, c, d, g) {
                    a.x = b;
                    a.y = c;
                    a.z = d;
                    a.w = g;
                    return a
                };
                f.identity = function(a) {
                    a.x = 0;
                    a.y = 0;
                    a.z = 0;
                    a.w = 1;
                    return a
                };
                f.rotationTo = function(a, b, d) {
                    var g = c["default"].dot(b, d);
                    if (-.999999 > g) return c["default"].cross(v, c["default"].RIGHT, b), 1E-6 > v.mag() && c["default"].cross(v, c["default"].UP, b), c["default"].normalize(v, v), f.fromAxisAngle(a, v, Math.PI), a;
                    if (.999999 < g) return a.x = 0, a.y = 0, a.z = 0, a.w = 1, a;
                    c["default"].cross(v, b, d);
                    a.x = v.x;
                    a.y = v.y;
                    a.z = v.z;
                    a.w = 1 + g;
                    return f.normalize(a, a)
                };
                f.getAxisAngle = function(a,
                    b) {
                    var c = 2 * Math.acos(b.w),
                        d = Math.sin(c / 2);
                    0 !== d ? (a.x = b.x / d, a.y = b.y / d, a.z = b.z / d) : (a.x = 1, a.y = 0, a.z = 0);
                    return c
                };
                f.multiply = function(a, b, c) {
                    l = b.x * c.w + b.w * c.x + b.y * c.z - b.z * c.y;
                    g = b.y * c.w + b.w * c.y + b.z * c.x - b.x * c.z;
                    n = b.z * c.w + b.w * c.z + b.x * c.y - b.y * c.x;
                    w = b.w * c.w - b.x * c.x - b.y * c.y - b.z * c.z;
                    a.x = l;
                    a.y = g;
                    a.z = n;
                    a.w = w;
                    return a
                };
                f.multiplyScalar = function(a, b, c) {
                    a.x = b.x * c;
                    a.y = b.y * c;
                    a.z = b.z * c;
                    a.w = b.w * c;
                    return a
                };
                f.scaleAndAdd = function(a, b, c, d) {
                    a.x = b.x + c.x * d;
                    a.y = b.y + c.y * d;
                    a.z = b.z + c.z * d;
                    a.w = b.w + c.w * d;
                    return a
                };
                f.rotateX = function(a,
                    b, c) {
                    c *= .5;
                    var d = Math.sin(c);
                    c = Math.cos(c);
                    l = b.x * c + b.w * d;
                    g = b.y * c + b.z * d;
                    n = b.z * c - b.y * d;
                    w = b.w * c - b.x * d;
                    a.x = l;
                    a.y = g;
                    a.z = n;
                    a.w = w;
                    return a
                };
                f.rotateY = function(a, b, c) {
                    c *= .5;
                    var d = Math.sin(c);
                    c = Math.cos(c);
                    l = b.x * c - b.z * d;
                    g = b.y * c + b.w * d;
                    n = b.z * c + b.x * d;
                    w = b.w * c - b.y * d;
                    a.x = l;
                    a.y = g;
                    a.z = n;
                    a.w = w;
                    return a
                };
                f.rotateZ = function(a, b, c) {
                    c *= .5;
                    var d = Math.sin(c);
                    c = Math.cos(c);
                    l = b.x * c + b.y * d;
                    g = b.y * c - b.x * d;
                    n = b.z * c + b.w * d;
                    w = b.w * c - b.z * d;
                    a.x = l;
                    a.y = g;
                    a.z = n;
                    a.w = w;
                    return a
                };
                f.rotateAround = function(a, b, d, g) {
                    f.invert(p, b);
                    c["default"].transformQuat(v,
                        d, p);
                    f.fromAxisAngle(p, v, g);
                    f.multiply(a, b, p);
                    return a
                };
                f.rotateAroundLocal = function(a, b, c, d) {
                    f.fromAxisAngle(p, c, d);
                    f.multiply(a, b, p);
                    return a
                };
                f.calculateW = function(a, b) {
                    a.x = b.x;
                    a.y = b.y;
                    a.z = b.z;
                    a.w = Math.sqrt(Math.abs(1 - b.x * b.x - b.y * b.y - b.z * b.z));
                    return a
                };
                f.dot = function(a, b) {
                    return a.x * b.x + a.y * b.y + a.z * b.z + a.w * b.w
                };
                f.lerp = function(a, b, c, d) {
                    a.x = b.x + d * (c.x - b.x);
                    a.y = b.y + d * (c.y - b.y);
                    a.z = b.z + d * (c.z - b.z);
                    a.w = b.w + d * (c.w - b.w);
                    return a
                };
                f.slerp = function(a, b, c, d) {
                    var g = b.x * c.x + b.y * c.y + b.z * c.z + b.w * c.w;
                    0 > g &&
                        (g = -g, c.x = -c.x, c.y = -c.y, c.z = -c.z, c.w = -c.w);
                    if (1E-6 < 1 - g) {
                        var e = Math.acos(g),
                            l = Math.sin(e);
                        g = Math.sin((1 - d) * e) / l;
                        d = Math.sin(d * e) / l
                    } else g = 1 - d;
                    a.x = g * b.x + d * c.x;
                    a.y = g * b.y + d * c.y;
                    a.z = g * b.z + d * c.z;
                    a.w = g * b.w + d * c.w;
                    return a
                };
                f.sqlerp = function(a, b, c, d, g, e) {
                    f.slerp(p, b, g, e);
                    f.slerp(u, c, d, e);
                    f.slerp(a, p, u, 2 * e * (1 - e));
                    return a
                };
                f.invert = function(a, b) {
                    var c = b.x * b.x + b.y * b.y + b.z * b.z + b.w * b.w;
                    c = c ? 1 / c : 0;
                    a.x = -b.x * c;
                    a.y = -b.y * c;
                    a.z = -b.z * c;
                    a.w = b.w * c;
                    return a
                };
                f.conjugate = function(a, b) {
                    a.x = -b.x;
                    a.y = -b.y;
                    a.z = -b.z;
                    a.w = b.w;
                    return a
                };
                f.len = function(a) {
                    return Math.sqrt(a.x * a.x + a.y * a.y + a.z * a.z + a.w * a.w)
                };
                f.lengthSqr = function(a) {
                    return a.x * a.x + a.y * a.y + a.z * a.z + a.w * a.w
                };
                f.normalize = function(a, b) {
                    var c = b.x * b.x + b.y * b.y + b.z * b.z + b.w * b.w;
                    0 < c && (c = 1 / Math.sqrt(c), a.x = b.x * c, a.y = b.y * c, a.z = b.z * c, a.w = b.w * c);
                    return a
                };
                f.fromAxes = function(b, c, d, g) {
                    a["default"].set(A, c.x, c.y, c.z, d.x, d.y, d.z, g.x, g.y, g.z);
                    return f.normalize(b, f.fromMat3(b, A))
                };
                f.fromViewUp = function(b, c, d) {
                    a["default"].fromViewUp(A, c, d);
                    return f.normalize(b, f.fromMat3(b, A))
                };
                f.fromAxisAngle =
                    function(a, b, c) {
                        c *= .5;
                        var d = Math.sin(c);
                        a.x = d * b.x;
                        a.y = d * b.y;
                        a.z = d * b.z;
                        a.w = Math.cos(c);
                        return a
                    };
                f.fromAngleZ = function(a, b) {
                    b *= B;
                    a.x = a.y = 0;
                    a.z = Math.sin(b);
                    a.w = Math.cos(b);
                    return a
                };
                f.fromMat3 = function(a, b) {
                    var c = b.m,
                        d = c[0];
                    b = c[1];
                    var g = c[2],
                        e = c[3],
                        l = c[4],
                        f = c[5],
                        k = c[6],
                        h = c[7];
                    c = c[8];
                    var n = d + l + c;
                    0 < n ? (d = .5 / Math.sqrt(n + 1), a.w = .25 / d, a.x = (f - h) * d, a.y = (k - g) * d, a.z = (b - e) * d) : d > l && d > c ? (d = 2 * Math.sqrt(1 + d - l - c), a.w = (f - h) / d, a.x = .25 * d, a.y = (e + b) / d, a.z = (k + g) / d) : l > c ? (d = 2 * Math.sqrt(1 + l - d - c), a.w = (k - g) / d, a.x = (e + b) / d, a.y =
                        .25 * d, a.z = (h + f) / d) : (d = 2 * Math.sqrt(1 + c - d - l), a.w = (b - e) / d, a.x = (k + g) / d, a.y = (h + f) / d, a.z = .25 * d);
                    return a
                };
                f.fromEuler = function(a, b, c, d) {
                    b *= B;
                    c *= B;
                    d *= B;
                    var g = Math.sin(b);
                    b = Math.cos(b);
                    var e = Math.sin(c);
                    c = Math.cos(c);
                    var l = Math.sin(d);
                    d = Math.cos(d);
                    a.x = g * c * d + b * e * l;
                    a.y = b * e * d + g * c * l;
                    a.z = b * c * l - g * e * d;
                    a.w = b * c * d - g * e * l;
                    return a
                };
                f.toAxisX = function(a, b) {
                    var c = 2 * b.y,
                        d = 2 * b.z;
                    a.x = 1 - c * b.y - d * b.z;
                    a.y = c * b.x + d * b.w;
                    a.z = d * b.x + c * b.w;
                    return a
                };
                f.toAxisY = function(a, b) {
                    var c = 2 * b.x,
                        d = 2 * b.z;
                    a.x = 2 * b.y * b.x - d * b.w;
                    a.y = 1 - c * b.x - d * b.z;
                    a.z = d * b.y + c * b.w;
                    return a
                };
                f.toAxisZ = function(a, b) {
                    var c = 2 * b.x,
                        d = 2 * b.y,
                        g = 2 * b.z;
                    a.x = g * b.x - d * b.w;
                    a.y = g * b.y - c * b.w;
                    a.z = 1 - c * b.x - d * b.y;
                    return a
                };
                f.toEuler = function(a, b, c) {
                    var g = b.x,
                        e = b.y,
                        l = b.z,
                        f = b.w,
                        k = g * e + l * f;
                    if (.499999 < k) b = 0, g = (0, d.toDegree)(2 * Math.atan2(g, f)), e = 90;
                    else if (-.499999 > k) b = 0, g = -(0, d.toDegree)(2 * Math.atan2(g, f)), e = -90;
                    else {
                        b = g * g;
                        var h = e * e,
                            n = l * l;
                        b = (0, d.toDegree)(Math.atan2(2 * g * f - 2 * e * l, 1 - 2 * b - 2 * n));
                        g = (0, d.toDegree)(Math.atan2(2 * e * f - 2 * g * l, 1 - 2 * h - 2 * n));
                        e = (0, d.toDegree)(Math.asin(2 * k));
                        c && (b = -180 *
                            Math.sign(b + 1E-6) + b, g = -180 * Math.sign(g + 1E-6) + g, e = 180 * Math.sign(e + 1E-6) - e)
                    }
                    a.x = b;
                    a.y = g;
                    a.z = e;
                    return a
                };
                f.strictEquals = function(a, b) {
                    return a.x === b.x && a.y === b.y && a.z === b.z && a.w === b.w
                };
                f.equals = function(a, b, c) {
                    void 0 === c && (c = d.EPSILON);
                    return Math.abs(a.x - b.x) <= c * Math.max(1, Math.abs(a.x), Math.abs(b.x)) && Math.abs(a.y - b.y) <= c * Math.max(1, Math.abs(a.y), Math.abs(b.y)) && Math.abs(a.z - b.z) <= c * Math.max(1, Math.abs(a.z), Math.abs(b.z)) && Math.abs(a.w - b.w) <= c * Math.max(1, Math.abs(a.w), Math.abs(b.w))
                };
                f.toArray = function(a,
                    b, c) {
                    void 0 === c && (c = 0);
                    a[c + 0] = b.x;
                    a[c + 1] = b.y;
                    a[c + 2] = b.z;
                    a[c + 3] = b.w;
                    return a
                };
                f.fromArray = function(a, b, c) {
                    void 0 === c && (c = 0);
                    a.x = b[c + 0];
                    a.y = b[c + 1];
                    a.z = b[c + 2];
                    a.w = b[c + 3];
                    return a
                };
                k.clone = function() {
                    return new f(this.x, this.y, this.z, this.w)
                };
                k.set = function(a) {
                    this.x = a.x;
                    this.y = a.y;
                    this.z = a.z;
                    this.w = a.w;
                    return this
                };
                k.equals = function(a) {
                    return a && this.x === a.x && this.y === a.y && this.z === a.z && this.w === a.w
                };
                k.toEuler = function(a) {
                    return f.toEuler(a, this)
                };
                k.fromEuler = function(a) {
                    return f.fromEuler(this, a.x,
                        a.y, a.z)
                };
                k.lerp = function(a, b, c) {
                    c = c || new f;
                    f.slerp(c, this, a, b);
                    return c
                };
                k.multiply = function(a) {
                    return f.multiply(this, this, a)
                };
                k.rotateAround = function(a, b, c, d) {
                    d = d || new f;
                    return f.rotateAround(d, a, b, c)
                };
                return f
            }(b["default"]);
        m["default"] = t;
        t.mul = t.multiply;
        t.scale = t.multiplyScalar;
        t.mag = t.len;
        t.IDENTITY = Object.freeze(new t);
        var p = new t,
            u = new t,
            v = new c["default"],
            A = new a["default"],
            B = .5 * Math.PI / 180;
        k["default"].fastDefine("cc.Quat", t, {
            x: 0,
            y: 0,
            z: 0,
            w: 1
        });
        cc.quat = function(a, b, c, d) {
            return new t(a,
                b, c, d)
        };
        cc.Quat = t;
        q.exports = m["default"]
    }, {
        "../platform/CCClass": 204,
        "./mat3": 302,
        "./utils": 308,
        "./value-type": 309,
        "./vec3": 311
    }],
    305: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, b) {
            for (var c = 0; c < b.length; c++) {
                var d = b[c];
                d.enumerable = d.enumerable || !1;
                d.configurable = !0;
                "value" in d && (d.writable = !0);
                Object.defineProperty(a, d.key, d)
            }
        }

        function b(a, b, c) {
            b && e(a.prototype, b);
            c && e(a, c);
            return a
        }

        function k(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor =
                a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var c = f(h("./value-type")),
            a = f(h("../platform/CCClass")),
            d = f(h("./vec2")),
            l = f(h("./size")),
            g = function(a) {
                function c(b, c, d, g) {
                    void 0 === b && (b = 0);
                    void 0 === c && (c = 0);
                    void 0 === d && (d = 0);
                    void 0 === g && (g = 0);
                    var e = a.call(this) || this;
                    e.x = void 0;
                    e.y = void 0;
                    e.width = void 0;
                    e.height = void 0;
                    b && "object" === typeof b && (c = b.y, d = b.width, g = b.height, b = b.x);
                    e.x = b || 0;
                    e.y = c || 0;
                    e.width = d || 0;
                    e.height = g || 0;
                    return e
                }
                k(c, a);
                c.fromMinMax = function(a, b) {
                    var d = Math.min(a.x, b.x),
                        g = Math.min(a.y,
                            b.y);
                    return new c(d, g, Math.max(a.x, b.x) - d, Math.max(a.y, b.y) - g)
                };
                var g = c.prototype;
                g.clone = function() {
                    return new c(this.x, this.y, this.width, this.height)
                };
                g.equals = function(a) {
                    return a && this.x === a.x && this.y === a.y && this.width === a.width && this.height === a.height
                };
                g.lerp = function(a, b, d) {
                    d = d || new c;
                    var g = this.x,
                        e = this.y,
                        l = this.width,
                        f = this.height;
                    d.x = g + (a.x - g) * b;
                    d.y = e + (a.y - e) * b;
                    d.width = l + (a.width - l) * b;
                    d.height = f + (a.height - f) * b;
                    return d
                };
                g.set = function(a) {
                    this.x = a.x;
                    this.y = a.y;
                    this.width = a.width;
                    this.height =
                        a.height;
                    return this
                };
                g.intersects = function(a) {
                    var b = this.y + this.height,
                        c = a.x + a.width,
                        d = a.y + a.height;
                    return !(this.x + this.width < a.x || c < this.x || b < a.y || d < this.y)
                };
                g.intersection = function(a, b) {
                    var c = this.y,
                        d = this.x + this.width,
                        g = this.y + this.height,
                        e = b.y,
                        l = b.x + b.width,
                        f = b.y + b.height;
                    a.x = Math.max(this.x, b.x);
                    a.y = Math.max(c, e);
                    a.width = Math.min(d, l) - a.x;
                    a.height = Math.min(g, f) - a.y;
                    return a
                };
                g.contains = function(a) {
                    return this.x <= a.x && this.x + this.width >= a.x && this.y <= a.y && this.y + this.height >= a.y
                };
                g.containsRect =
                    function(a) {
                        return this.x <= a.x && this.x + this.width >= a.x + a.width && this.y <= a.y && this.y + this.height >= a.y + a.height
                    };
                g.union = function(a, b) {
                    var c = this.x,
                        d = this.y,
                        g = this.width,
                        e = this.height,
                        l = b.x,
                        f = b.y,
                        k = b.width;
                    b = b.height;
                    a.x = Math.min(c, l);
                    a.y = Math.min(d, f);
                    a.width = Math.max(c + g, l + k) - a.x;
                    a.height = Math.max(d + e, f + b) - a.y;
                    return a
                };
                g.transformMat4 = function(a, b) {
                    var c = this.x,
                        d = this.y,
                        g = c + this.width,
                        e = d + this.height,
                        l = b.m,
                        f = l[0] * c + l[4] * d + l[12];
                    b = l[1] * c + l[5] * d + l[13];
                    var k = l[0] * g + l[4] * d + l[12];
                    d = l[1] * g + l[5] * d + l[13];
                    var h = l[0] * c + l[4] * e + l[12];
                    c = l[1] * c + l[5] * e + l[13];
                    var n = l[0] * g + l[4] * e + l[12];
                    e = l[1] * g + l[5] * e + l[13];
                    g = Math.min(f, k, h, n);
                    f = Math.max(f, k, h, n);
                    k = Math.min(b, d, c, e);
                    b = Math.max(b, d, c, e);
                    a.x = g;
                    a.y = k;
                    a.width = f - g;
                    a.height = b - k;
                    return a
                };
                g.toString = function() {
                    return "(" + this.x.toFixed(2) + ", " + this.y.toFixed(2) + ", " + this.width.toFixed(2) + ", " + this.height.toFixed(2) + ")"
                };
                b(c, [{
                    key: "xMin",
                    get: function() {
                        return this.x
                    },
                    set: function(a) {
                        this.width += this.x - a;
                        this.x = a
                    }
                }, {
                    key: "yMin",
                    get: function() {
                        return this.y
                    },
                    set: function(a) {
                        this.height +=
                            this.y - a;
                        this.y = a
                    }
                }, {
                    key: "xMax",
                    get: function() {
                        return this.x + this.width
                    },
                    set: function(a) {
                        this.width = a - this.x
                    }
                }, {
                    key: "yMax",
                    get: function() {
                        return this.y + this.height
                    },
                    set: function(a) {
                        this.height = a - this.y
                    }
                }, {
                    key: "center",
                    get: function() {
                        return new d["default"](this.x + .5 * this.width, this.y + .5 * this.height)
                    },
                    set: function(a) {
                        this.x = a.x - .5 * this.width;
                        this.y = a.y - .5 * this.height
                    }
                }, {
                    key: "origin",
                    get: function() {
                        return new d["default"](this.x, this.y)
                    },
                    set: function(a) {
                        this.x = a.x;
                        this.y = a.y
                    }
                }, {
                    key: "size",
                    get: function() {
                        return new l["default"](this.width,
                            this.height)
                    },
                    set: function(a) {
                        this.width = a.width;
                        this.height = a.height
                    }
                }]);
                return c
            }(c["default"]);
        m["default"] = g;
        a["default"].fastDefine("cc.Rect", g, {
            x: 0,
            y: 0,
            width: 0,
            height: 0
        });
        cc.Rect = g;
        cc.rect = function(a, b, c, d) {
            return new g(a, b, c, d)
        };
        q.exports = m["default"]
    }, {
        "../platform/CCClass": 204,
        "./size": 306,
        "./value-type": 309,
        "./vec2": 310
    }],
    306: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, b) {
            for (var c = 0; c < b.length; c++) {
                var d = b[c];
                d.enumerable = d.enumerable || !1;
                d.configurable = !0;
                "value" in d && (d.writable = !0);
                Object.defineProperty(a, d.key, d)
            }
        }

        function b(a, b, c) {
            b && e(a.prototype, b);
            c && e(a, c);
            return a
        }

        function k(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var c = f(h("./value-type"));
        h = f(h("../platform/CCClass"));
        var a = function(a) {
            function c(b, c) {
                void 0 === b && (b = 0);
                void 0 === c && (c = 0);
                var d = a.call(this) || this;
                d.width = void 0;
                d.height = void 0;
                b && "object" === typeof b ? (d.width = b.width, d.height = b.height) : (d.width =
                    b || 0, d.height = c || 0);
                return d
            }
            k(c, a);
            b(c, null, [{
                key: "ZERO",
                get: function() {
                    return new c
                }
            }]);
            var d = c.prototype;
            d.clone = function() {
                return new c(this.width, this.height)
            };
            d.equals = function(a) {
                return a && this.width === a.width && this.height === a.height
            };
            d.lerp = function(a, b, d) {
                d = d || new c;
                var g = this.width,
                    e = this.height;
                d.width = g + (a.width - g) * b;
                d.height = e + (a.height - e) * b;
                return d
            };
            d.set = function(a) {
                this.width = a.width;
                this.height = a.height;
                return this
            };
            d.toString = function() {
                return "(" + this.width.toFixed(2) + ", " + this.height.toFixed(2) +
                    ")"
            };
            return c
        }(c["default"]);
        m["default"] = a;
        a.ZERO_R = a.ZERO;
        h["default"].fastDefine("cc.Size", a, {
            width: 0,
            height: 0
        });
        cc.size = function(b, c) {
            return new a(b, c)
        };
        cc.Size = a;
        q.exports = m["default"]
    }, {
        "../platform/CCClass": 204,
        "./value-type": 309
    }],
    307: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        var f = function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("./quat")),
            e = new f["default"];
        h = function() {
            function b() {}
            b.toRotation = function(b, c) {
                b.x = c[3];
                b.y = c[4];
                b.z = c[5];
                b.w = c[6];
                return b
            };
            b.fromRotation = function(b,
                c) {
                b[3] = c.x;
                b[4] = c.y;
                b[5] = c.z;
                b[6] = c.w;
                return b
            };
            b.toEuler = function(k, c) {
                b.toRotation(e, c);
                f["default"].toEuler(k, e);
                return k
            };
            b.fromEuler = function(k, c) {
                f["default"].fromEuler(e, c.x, c.y, c.z);
                b.fromRotation(k, e);
                return k
            };
            b.fromEulerNumber = function(k, c, a, d) {
                f["default"].fromEuler(e, c, a, d);
                b.fromRotation(k, e);
                return k
            };
            b.toScale = function(b, c) {
                b.x = c[7];
                b.y = c[8];
                b.z = c[9];
                return b
            };
            b.fromScale = function(b, c) {
                b[7] = c.x;
                b[8] = c.y;
                b[9] = c.z;
                return b
            };
            b.toPosition = function(b, c) {
                b.x = c[0];
                b.y = c[1];
                b.z = c[2];
                return b
            };
            b.fromPosition = function(b, c) {
                b[0] = c.x;
                b[1] = c.y;
                b[2] = c.z;
                return b
            };
            b.fromAngleZ = function(k, c) {
                f["default"].fromAngleZ(e, c);
                b.fromRotation(k, e);
                return k
            };
            b.toMat4 = function(b, c) {
                var a = c[3],
                    d = c[4],
                    e = c[5],
                    g = c[6],
                    f = a + a,
                    k = d + d,
                    h = e + e,
                    p = a * f,
                    u = a * k;
                a *= h;
                var v = d * k;
                d *= h;
                e *= h;
                f *= g;
                k *= g;
                g *= h;
                h = c[7];
                var A = c[8],
                    B = c[9],
                    m = b.m;
                m[0] = (1 - (v + e)) * h;
                m[1] = (u + g) * h;
                m[2] = (a - k) * h;
                m[3] = 0;
                m[4] = (u - g) * A;
                m[5] = (1 - (p + e)) * A;
                m[6] = (d + f) * A;
                m[7] = 0;
                m[8] = (a + k) * B;
                m[9] = (d - f) * B;
                m[10] = (1 - (p + v)) * B;
                m[11] = 0;
                m[12] = c[0];
                m[13] = c[1];
                m[14] = c[2];
                m[15] = 1;
                return b
            };
            return b
        }();
        m["default"] = h;
        cc.Trs = h;
        q.exports = m["default"]
    }, {
        "./quat": 304
    }],
    308: [function(h, q, m) {
        function f(a, b) {
            return Math.random() * (b - a) + a
        }

        function e(a) {
            return (9301 * a + 49297) % 233280 / 233280
        }

        function b(a, b, c) {
            return e(a) * (c - b) + b
        }

        function k(a, b) {
            return a - Math.floor(a / b) * b
        }
        m.__esModule = !0;
        m.equals = function(a, b) {
            return Math.abs(a - b) <= d * Math.max(1, Math.abs(a), Math.abs(b))
        };
        m.approx = function(a, b, c) {
            c = c || d;
            return Math.abs(a - b) <= c
        };
        m.clamp = function(a, b, c) {
            return a < b ? b : a > c ? c : a
        };
        m.clamp01 = function(a) {
            return 0 >
                a ? 0 : 1 < a ? 1 : a
        };
        m.lerp = function(a, b, c) {
            return a + (b - a) * c
        };
        m.toRadian = function(a) {
            return a * c
        };
        m.toDegree = function(b) {
            return b * a
        };
        m.randomRange = f;
        m.randomRangeInt = function(a, b) {
            return Math.floor(f(a, b))
        };
        m.pseudoRandom = e;
        m.pseudoRandomRange = b;
        m.pseudoRandomRangeInt = function(a, c, d) {
            return Math.floor(b(a, c, d))
        };
        m.nextPow2 = function(a) {
            --a;
            a |= a >> 1;
            a |= a >> 2;
            a |= a >> 4;
            a |= a >> 8;
            a |= a >> 16;
            ++a;
            return a
        };
        m.repeat = k;
        m.pingPong = function(a, b) {
            a = k(a, 2 * b);
            return a = b - Math.abs(a - b)
        };
        m.inverseLerp = function(a, b, c) {
            return (c - a) /
                (b - a)
        };
        m.sign = function(a) {
            return (0 < a) - (0 > a)
        };
        m.random = m.FLOAT_BYTES = m.FLOAT_ARRAY_TYPE = m.INT_MIN = m.INT_MAX = m.INT_BITS = m.EPSILON = void 0;
        var c = Math.PI / 180,
            a = 180 / Math.PI,
            d = 1E-6;
        m.EPSILON = d;
        m.INT_BITS = 32;
        m.INT_MAX = 2147483647;
        m.INT_MIN = -2147483648;
        m.FLOAT_ARRAY_TYPE = Float64Array;
        m.FLOAT_BYTES = 8;
        m.random = Math.random
    }, {}],
    309: [function(h, q, m) {
            m.__esModule = !0;
            m["default"] = void 0;
            var f = function(e) {
                return e && e.__esModule ? e : {
                    default: e
                }
            }(h("../platform/js"));
            h = function() {
                function e() {}
                var b = e.prototype;
                b.clone =
                    function() {
                        cc.errorID("0100", f["default"].getClassName(this) + ".clone");
                        return null
                    };
                b.equals = function(b) {
                    cc.errorID("0100", f["default"].getClassName(this) + ".equals");
                    return !1
                };
                b.lerp = function(b, c) {
                    cc.errorID("0100", f["default"].getClassName(this) + ".lerp");
                    return this.clone()
                };
                b.set = function(b) {
                    cc.errorID("0100", f["default"].getClassName(this) + ".set")
                };
                b.toString = function() {
                    return "[object Object]"
                };
                return e
            }();
            m["default"] = h;
            f["default"].setClassName("cc.ValueType", h);
            cc.ValueType = h;
            q.exports = m["default"]
        },
        {
            "../platform/js": 225
        }
    ],
    310: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, b) {
            for (var c = 0; c < b.length; c++) {
                var d = b[c];
                d.enumerable = d.enumerable || !1;
                d.configurable = !0;
                "value" in d && (d.writable = !0);
                Object.defineProperty(a, d.key, d)
            }
        }

        function b(a, b, c) {
            b && e(a.prototype, b);
            c && e(a, c);
            return a
        }

        function k(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var c = f(h("./value-type")),
            a = f(h("../platform/CCClass")),
            d = f(h("../utils/misc")),
            l = h("./utils"),
            g = 0,
            n = 0,
            w = function(a) {
                function c(b, d) {
                    void 0 === b && (b = 0);
                    void 0 === d && (d = 0);
                    var g = a.call(this) || this;
                    g.mag = c.prototype.len;
                    g.magSqr = c.prototype.lengthSqr;
                    g.subSelf = c.prototype.subtract;
                    g.mulSelf = c.prototype.multiplyScalar;
                    g.divSelf = c.prototype.divide;
                    g.scaleSelf = c.prototype.multiply;
                    g.negSelf = c.prototype.negate;
                    g.x = void 0;
                    g.y = void 0;
                    g.z = 0;
                    b && "object" === typeof b ? (g.x = b.x || 0, g.y = b.y || 0) : (g.x = b || 0, g.y = d || 0);
                    return g
                }
                k(c, a);
                var e = c.prototype;
                e.sub = function(a, b) {
                    return c.subtract(b ||
                        new c, this, a)
                };
                e.mul = function(a, b) {
                    return c.multiplyScalar(b || new c, this, a)
                };
                e.div = function(a, b) {
                    return c.multiplyScalar(b || new c, this, 1 / a)
                };
                e.scale = function(a, b) {
                    return c.multiply(b || new c, this, a)
                };
                e.neg = function(a) {
                    return c.negate(a || new c, this)
                };
                c.clone = function(a) {
                    return new c(a.x, a.y)
                };
                c.copy = function(a, b) {
                    a.x = b.x;
                    a.y = b.y;
                    return a
                };
                c.set = function(a, b, c) {
                    a.x = b;
                    a.y = c;
                    return a
                };
                c.add = function(a, b, c) {
                    a.x = b.x + c.x;
                    a.y = b.y + c.y;
                    return a
                };
                c.subtract = function(a, b, c) {
                    a.x = b.x - c.x;
                    a.y = b.y - c.y;
                    return a
                };
                c.multiply =
                    function(a, b, c) {
                        a.x = b.x * c.x;
                        a.y = b.y * c.y;
                        return a
                    };
                c.divide = function(a, b, c) {
                    a.x = b.x / c.x;
                    a.y = b.y / c.y;
                    return a
                };
                c.ceil = function(a, b) {
                    a.x = Math.ceil(b.x);
                    a.y = Math.ceil(b.y);
                    return a
                };
                c.floor = function(a, b) {
                    a.x = Math.floor(b.x);
                    a.y = Math.floor(b.y);
                    return a
                };
                c.min = function(a, b, c) {
                    a.x = Math.min(b.x, c.x);
                    a.y = Math.min(b.y, c.y);
                    return a
                };
                c.max = function(a, b, c) {
                    a.x = Math.max(b.x, c.x);
                    a.y = Math.max(b.y, c.y);
                    return a
                };
                c.round = function(a, b) {
                    a.x = Math.round(b.x);
                    a.y = Math.round(b.y);
                    return a
                };
                c.multiplyScalar = function(a,
                    b, c) {
                    a.x = b.x * c;
                    a.y = b.y * c;
                    return a
                };
                c.scaleAndAdd = function(a, b, c, d) {
                    a.x = b.x + c.x * d;
                    a.y = b.y + c.y * d;
                    return a
                };
                c.distance = function(a, b) {
                    g = b.x - a.x;
                    n = b.y - a.y;
                    return Math.sqrt(g * g + n * n)
                };
                c.squaredDistance = function(a, b) {
                    g = b.x - a.x;
                    n = b.y - a.y;
                    return g * g + n * n
                };
                c.len = function(a) {
                    g = a.x;
                    n = a.y;
                    return Math.sqrt(g * g + n * n)
                };
                c.lengthSqr = function(a) {
                    g = a.x;
                    n = a.y;
                    return g * g + n * n
                };
                c.negate = function(a, b) {
                    a.x = -b.x;
                    a.y = -b.y;
                    return a
                };
                c.inverse = function(a, b) {
                    a.x = 1 / b.x;
                    a.y = 1 / b.y;
                    return a
                };
                c.inverseSafe = function(a, b) {
                    g = b.x;
                    n = b.y;
                    Math.abs(g) <
                        l.EPSILON ? a.x = 0 : a.x = 1 / g;
                    Math.abs(n) < l.EPSILON ? a.y = 0 : a.y = 1 / n;
                    return a
                };
                c.normalize = function(a, b) {
                    g = b.x;
                    n = b.y;
                    b = g * g + n * n;
                    0 < b && (b = 1 / Math.sqrt(b), a.x = g * b, a.y = n * b);
                    return a
                };
                c.dot = function(a, b) {
                    return a.x * b.x + a.y * b.y
                };
                c.cross = function(a, b, c) {
                    a.x = a.y = 0;
                    a.z = b.x * c.y - b.y * c.x;
                    return a
                };
                c.lerp = function(a, b, c, d) {
                    g = b.x;
                    n = b.y;
                    a.x = g + d * (c.x - g);
                    a.y = n + d * (c.y - n);
                    return a
                };
                c.random = function(a, b) {
                    b = b || 1;
                    var c = 2 * (0, l.random)() * Math.PI;
                    a.x = Math.cos(c) * b;
                    a.y = Math.sin(c) * b;
                    return a
                };
                c.transformMat3 = function(a, b, c) {
                    g = b.x;
                    n =
                        b.y;
                    b = c.m;
                    a.x = b[0] * g + b[3] * n + b[6];
                    a.y = b[1] * g + b[4] * n + b[7];
                    return a
                };
                c.transformMat4 = function(a, b, c) {
                    g = b.x;
                    n = b.y;
                    b = c.m;
                    a.x = b[0] * g + b[4] * n + b[12];
                    a.y = b[1] * g + b[5] * n + b[13];
                    return a
                };
                c.strictEquals = function(a, b) {
                    return a.x === b.x && a.y === b.y
                };
                c.equals = function(a, b, c) {
                    void 0 === c && (c = l.EPSILON);
                    return Math.abs(a.x - b.x) <= c * Math.max(1, Math.abs(a.x), Math.abs(b.x)) && Math.abs(a.y - b.y) <= c * Math.max(1, Math.abs(a.y), Math.abs(b.y))
                };
                c.angle = function(a, b) {
                    c.normalize(t, a);
                    c.normalize(p, b);
                    a = c.dot(t, p);
                    return 1 < a ? 0 : -1 > a ?
                        Math.PI : Math.acos(a)
                };
                c.toArray = function(a, b, c) {
                    void 0 === c && (c = 0);
                    a[c + 0] = b.x;
                    a[c + 1] = b.y;
                    return a
                };
                c.fromArray = function(a, b, c) {
                    void 0 === c && (c = 0);
                    a.x = b[c + 0];
                    a.y = b[c + 1];
                    return a
                };
                b(c, null, [{
                    key: "ONE",
                    get: function() {
                        return new c(1, 1)
                    }
                }, {
                    key: "ZERO",
                    get: function() {
                        return new c(0, 0)
                    }
                }, {
                    key: "UP",
                    get: function() {
                        return new c(0, 1)
                    }
                }, {
                    key: "RIGHT",
                    get: function() {
                        return new c(1, 0)
                    }
                }]);
                e.clone = function() {
                    return new c(this.x, this.y)
                };
                e.set = function(a) {
                    this.x = a.x;
                    this.y = a.y;
                    return this
                };
                e.equals = function(a) {
                    return a &&
                        this.x === a.x && this.y === a.y
                };
                e.fuzzyEquals = function(a, b) {
                    return this.x - b <= a.x && a.x <= this.x + b && this.y - b <= a.y && a.y <= this.y + b ? !0 : !1
                };
                e.toString = function() {
                    return "(" + this.x.toFixed(2) + ", " + this.y.toFixed(2) + ")"
                };
                e.lerp = function(a, b, d) {
                    d = d || new c;
                    var g = this.x,
                        e = this.y;
                    d.x = g + (a.x - g) * b;
                    d.y = e + (a.y - e) * b;
                    return d
                };
                e.clampf = function(a, b) {
                    this.x = d["default"].clampf(this.x, a.x, b.x);
                    this.y = d["default"].clampf(this.y, a.y, b.y);
                    return this
                };
                e.add = function(a, b) {
                    b = b || new c;
                    b.x = this.x + a.x;
                    b.y = this.y + a.y;
                    return b
                };
                e.addSelf =
                    function(a) {
                        this.x += a.x;
                        this.y += a.y;
                        return this
                    };
                e.subtract = function(a) {
                    this.x -= a.x;
                    this.y -= a.y;
                    return this
                };
                e.multiplyScalar = function(a) {
                    this.x *= a;
                    this.y *= a;
                    return this
                };
                e.multiply = function(a) {
                    this.x *= a.x;
                    this.y *= a.y;
                    return this
                };
                e.divide = function(a) {
                    this.x /= a;
                    this.y /= a;
                    return this
                };
                e.negate = function() {
                    this.x = -this.x;
                    this.y = -this.y;
                    return this
                };
                e.dot = function(a) {
                    return this.x * a.x + this.y * a.y
                };
                e.cross = function(a) {
                    return this.x * a.y - this.y * a.x
                };
                e.len = function() {
                    return Math.sqrt(this.x * this.x + this.y *
                        this.y)
                };
                e.lengthSqr = function() {
                    return this.x * this.x + this.y * this.y
                };
                e.normalizeSelf = function() {
                    var a = this.x * this.x + this.y * this.y;
                    if (1 === a || 0 === a) return this;
                    a = 1 / Math.sqrt(a);
                    this.x *= a;
                    this.y *= a;
                    return this
                };
                e.normalize = function(a) {
                    a = a || new c;
                    a.x = this.x;
                    a.y = this.y;
                    a.normalizeSelf();
                    return a
                };
                e.angle = function(a) {
                    var b = this.magSqr(),
                        c = a.magSqr();
                    if (0 === b || 0 === c) return console.warn("Can't get angle between zero vector"), 0;
                    a = this.dot(a) / Math.sqrt(b * c);
                    a = d["default"].clampf(a, -1, 1);
                    return Math.acos(a)
                };
                e.signAngle = function(a) {
                    var b = this.angle(a);
                    return 0 > this.cross(a) ? -b : b
                };
                e.rotate = function(a, b) {
                    b = b || new c;
                    b.x = this.x;
                    b.y = this.y;
                    return b.rotateSelf(a)
                };
                e.rotateSelf = function(a) {
                    var b = Math.sin(a);
                    a = Math.cos(a);
                    var c = this.x;
                    this.x = a * c - b * this.y;
                    this.y = b * c + a * this.y;
                    return this
                };
                e.project = function(a) {
                    return a.multiplyScalar(this.dot(a) / a.dot(a))
                };
                e.transformMat4 = function(a, b) {
                    b = b || new c;
                    c.transformMat4(b, this, a);
                    return b
                };
                e.maxAxis = function() {
                    return Math.max(this.x, this.y)
                };
                return c
            }(c["default"]);
        m["default"] =
            w;
        w.sub = w.subtract;
        w.mul = w.multiply;
        w.scale = w.multiplyScalar;
        w.mag = w.len;
        w.squaredMagnitude = w.lengthSqr;
        w.div = w.divide;
        w.ONE_R = w.ONE;
        w.ZERO_R = w.ZERO;
        w.UP_R = w.UP;
        w.RIGHT_R = w.RIGHT;
        var t = new w,
            p = new w;
        a["default"].fastDefine("cc.Vec2", w, {
            x: 0,
            y: 0
        });
        cc.v2 = function(a, b) {
            return new w(a, b)
        };
        cc.Vec2 = w;
        q.exports = m["default"]
    }, {
        "../platform/CCClass": 204,
        "../utils/misc": 286,
        "./utils": 308,
        "./value-type": 309
    }],
    311: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, b) {
            for (var c = 0; c <
                b.length; c++) {
                var d = b[c];
                d.enumerable = d.enumerable || !1;
                d.configurable = !0;
                "value" in d && (d.writable = !0);
                Object.defineProperty(a, d.key, d)
            }
        }

        function b(a, b, c) {
            b && e(a.prototype, b);
            c && e(a, c);
            return a
        }

        function k(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var c = f(h("./value-type")),
            a = f(h("../platform/CCClass")),
            d = f(h("../utils/misc")),
            l = f(h("./vec2")),
            g = h("./utils"),
            n = 0,
            w = 0,
            t = 0,
            p = function(a) {
                function c(b, d, g) {
                    void 0 === b && (b = 0);
                    void 0 ===
                        d && (d = 0);
                    void 0 === g && (g = 0);
                    var e = a.call(this) || this;
                    e.mag = c.prototype.len;
                    e.magSqr = c.prototype.lengthSqr;
                    e.subSelf = c.prototype.subtract;
                    e.mulSelf = c.prototype.multiplyScalar;
                    e.divSelf = c.prototype.divide;
                    e.scaleSelf = c.prototype.multiply;
                    e.negSelf = c.prototype.negate;
                    e.x = void 0;
                    e.y = void 0;
                    e.z = void 0;
                    e.angle = l["default"].prototype.angle;
                    e.project = l["default"].prototype.project;
                    b && "object" === typeof b ? (e.x = b.x, e.y = b.y, e.z = b.z) : (e.x = b, e.y = d, e.z = g);
                    return e
                }
                k(c, a);
                var e = c.prototype;
                e.sub = function(a, b) {
                    return c.subtract(b ||
                        new c, this, a)
                };
                e.mul = function(a, b) {
                    return c.multiplyScalar(b || new c, this, a)
                };
                e.div = function(a, b) {
                    return c.multiplyScalar(b || new c, this, 1 / a)
                };
                e.scale = function(a, b) {
                    return c.multiply(b || new c, this, a)
                };
                e.neg = function(a) {
                    return c.negate(a || new c, this)
                };
                c.zero = function(a) {
                    a.x = 0;
                    a.y = 0;
                    a.z = 0;
                    return a
                };
                c.clone = function(a) {
                    return new c(a.x, a.y, a.z)
                };
                c.copy = function(a, b) {
                    a.x = b.x;
                    a.y = b.y;
                    a.z = b.z;
                    return a
                };
                c.set = function(a, b, c, d) {
                    a.x = b;
                    a.y = c;
                    a.z = d;
                    return a
                };
                c.add = function(a, b, c) {
                    a.x = b.x + c.x;
                    a.y = b.y + c.y;
                    a.z = b.z +
                        c.z;
                    return a
                };
                c.subtract = function(a, b, c) {
                    a.x = b.x - c.x;
                    a.y = b.y - c.y;
                    a.z = b.z - c.z;
                    return a
                };
                c.multiply = function(a, b, c) {
                    a.x = b.x * c.x;
                    a.y = b.y * c.y;
                    a.z = b.z * c.z;
                    return a
                };
                c.divide = function(a, b, c) {
                    a.x = b.x / c.x;
                    a.y = b.y / c.y;
                    a.z = b.z / c.z;
                    return a
                };
                c.ceil = function(a, b) {
                    a.x = Math.ceil(b.x);
                    a.y = Math.ceil(b.y);
                    a.z = Math.ceil(b.z);
                    return a
                };
                c.floor = function(a, b) {
                    a.x = Math.floor(b.x);
                    a.y = Math.floor(b.y);
                    a.z = Math.floor(b.z);
                    return a
                };
                c.min = function(a, b, c) {
                    a.x = Math.min(b.x, c.x);
                    a.y = Math.min(b.y, c.y);
                    a.z = Math.min(b.z, c.z);
                    return a
                };
                c.max = function(a, b, c) {
                    a.x = Math.max(b.x, c.x);
                    a.y = Math.max(b.y, c.y);
                    a.z = Math.max(b.z, c.z);
                    return a
                };
                c.round = function(a, b) {
                    a.x = Math.round(b.x);
                    a.y = Math.round(b.y);
                    a.z = Math.round(b.z);
                    return a
                };
                c.multiplyScalar = function(a, b, c) {
                    a.x = b.x * c;
                    a.y = b.y * c;
                    a.z = b.z * c;
                    return a
                };
                c.scaleAndAdd = function(a, b, c, d) {
                    a.x = b.x + c.x * d;
                    a.y = b.y + c.y * d;
                    a.z = b.z + c.z * d;
                    return a
                };
                c.distance = function(a, b) {
                    n = b.x - a.x;
                    w = b.y - a.y;
                    t = b.z - a.z;
                    return Math.sqrt(n * n + w * w + t * t)
                };
                c.squaredDistance = function(a, b) {
                    n = b.x - a.x;
                    w = b.y - a.y;
                    t = b.z - a.z;
                    return n *
                        n + w * w + t * t
                };
                c.len = function(a) {
                    n = a.x;
                    w = a.y;
                    t = a.z;
                    return Math.sqrt(n * n + w * w + t * t)
                };
                c.lengthSqr = function(a) {
                    n = a.x;
                    w = a.y;
                    t = a.z;
                    return n * n + w * w + t * t
                };
                c.negate = function(a, b) {
                    a.x = -b.x;
                    a.y = -b.y;
                    a.z = -b.z;
                    return a
                };
                c.inverse = function(a, b) {
                    a.x = 1 / b.x;
                    a.y = 1 / b.y;
                    a.z = 1 / b.z;
                    return a
                };
                c.inverseSafe = function(a, b) {
                    n = b.x;
                    w = b.y;
                    t = b.z;
                    Math.abs(n) < g.EPSILON ? a.x = 0 : a.x = 1 / n;
                    Math.abs(w) < g.EPSILON ? a.y = 0 : a.y = 1 / w;
                    Math.abs(t) < g.EPSILON ? a.z = 0 : a.z = 1 / t;
                    return a
                };
                c.normalize = function(a, b) {
                    n = b.x;
                    w = b.y;
                    t = b.z;
                    b = n * n + w * w + t * t;
                    0 < b && (b = 1 / Math.sqrt(b),
                        a.x = n * b, a.y = w * b, a.z = t * b);
                    return a
                };
                c.dot = function(a, b) {
                    return a.x * b.x + a.y * b.y + a.z * b.z
                };
                c.cross = function(a, b, c) {
                    var d = b.x,
                        g = b.y;
                    b = b.z;
                    var e = c.x,
                        l = c.y;
                    c = c.z;
                    a.x = g * c - b * l;
                    a.y = b * e - d * c;
                    a.z = d * l - g * e;
                    return a
                };
                c.lerp = function(a, b, c, d) {
                    a.x = b.x + d * (c.x - b.x);
                    a.y = b.y + d * (c.y - b.y);
                    a.z = b.z + d * (c.z - b.z);
                    return a
                };
                c.random = function(a, b) {
                    b = b || 1;
                    var c = 2 * (0, g.random)() * Math.PI,
                        d = 2 * (0, g.random)() - 1,
                        e = Math.sqrt(1 - d * d);
                    a.x = e * Math.cos(c) * b;
                    a.y = e * Math.sin(c) * b;
                    a.z = d * b;
                    return a
                };
                c.transformMat4 = function(a, b, c) {
                    n = b.x;
                    w = b.y;
                    t =
                        b.z;
                    b = c.m;
                    c = (c = b[3] * n + b[7] * w + b[11] * t + b[15]) ? 1 / c : 1;
                    a.x = (b[0] * n + b[4] * w + b[8] * t + b[12]) * c;
                    a.y = (b[1] * n + b[5] * w + b[9] * t + b[13]) * c;
                    a.z = (b[2] * n + b[6] * w + b[10] * t + b[14]) * c;
                    return a
                };
                c.transformMat4Normal = function(a, b, c) {
                    n = b.x;
                    w = b.y;
                    t = b.z;
                    b = c.m;
                    c = (c = b[3] * n + b[7] * w + b[11] * t) ? 1 / c : 1;
                    a.x = (b[0] * n + b[4] * w + b[8] * t) * c;
                    a.y = (b[1] * n + b[5] * w + b[9] * t) * c;
                    a.z = (b[2] * n + b[6] * w + b[10] * t) * c;
                    return a
                };
                c.transformMat3 = function(a, b, c) {
                    n = b.x;
                    w = b.y;
                    t = b.z;
                    b = c.m;
                    a.x = n * b[0] + w * b[3] + t * b[6];
                    a.y = n * b[1] + w * b[4] + t * b[7];
                    a.z = n * b[2] + w * b[5] + t * b[8];
                    return a
                };
                c.transformAffine = function(a, b, c) {
                    n = b.x;
                    w = b.y;
                    t = b.z;
                    b = c.m;
                    a.x = b[0] * n + b[1] * w + b[2] * t + b[3];
                    a.y = b[4] * n + b[5] * w + b[6] * t + b[7];
                    a.x = b[8] * n + b[9] * w + b[10] * t + b[11];
                    return a
                };
                c.transformQuat = function(a, b, c) {
                    var d = c.w * b.x + c.y * b.z - c.z * b.y,
                        g = c.w * b.y + c.z * b.x - c.x * b.z,
                        e = c.w * b.z + c.x * b.y - c.y * b.x;
                    b = -c.x * b.x - c.y * b.y - c.z * b.z;
                    a.x = d * c.w + b * -c.x + g * -c.z - e * -c.y;
                    a.y = g * c.w + b * -c.y + e * -c.x - d * -c.z;
                    a.z = e * c.w + b * -c.z + d * -c.y - g * -c.x;
                    return a
                };
                c.transformRTS = function(a, b, c, d, g) {
                    var e = b.x * g.x,
                        l = b.y * g.y,
                        f = b.z * g.z;
                    b = c.w * e + c.y * f - c.z * l;
                    g = c.w * l +
                        c.z * e - c.x * f;
                    var k = c.w * f + c.x * l - c.y * e;
                    e = -c.x * e - c.y * l - c.z * f;
                    a.x = b * c.w + e * -c.x + g * -c.z - k * -c.y + d.x;
                    a.y = g * c.w + e * -c.y + k * -c.x - b * -c.z + d.y;
                    a.z = k * c.w + e * -c.z + b * -c.y - g * -c.x + d.z;
                    return a
                };
                c.transformInverseRTS = function(a, b, c, d, g) {
                    var e = b.x - d.x,
                        l = b.y - d.y,
                        f = b.z - d.z;
                    b = c.w * e - c.y * f + c.z * l;
                    d = c.w * l - c.z * e + c.x * f;
                    var k = c.w * f - c.x * l + c.y * e;
                    e = c.x * e + c.y * l + c.z * f;
                    a.x = (b * c.w + e * c.x + d * c.z - k * c.y) / g.x;
                    a.y = (d * c.w + e * c.y + k * c.x - b * c.z) / g.y;
                    a.z = (k * c.w + e * c.z + b * c.y - d * c.x) / g.z;
                    return a
                };
                c.rotateX = function(a, b, c, d) {
                    n = b.x - c.x;
                    w = b.y - c.y;
                    t = b.z - c.z;
                    b = Math.cos(d);
                    var g = Math.sin(d);
                    d = w * b - t * g;
                    b = w * g + t * b;
                    a.x = n + c.x;
                    a.y = d + c.y;
                    a.z = b + c.z;
                    return a
                };
                c.rotateY = function(a, b, c, d) {
                    n = b.x - c.x;
                    w = b.y - c.y;
                    t = b.z - c.z;
                    b = Math.cos(d);
                    d = Math.sin(d);
                    var g = w,
                        e = t * b - n * d;
                    a.x = t * d + n * b + c.x;
                    a.y = g + c.y;
                    a.z = e + c.z;
                    return a
                };
                c.rotateZ = function(a, b, c, d) {
                    n = b.x - c.x;
                    w = b.y - c.y;
                    t = b.z - c.z;
                    b = Math.cos(d);
                    d = Math.sin(d);
                    var g = n * d + w * b,
                        e = t;
                    a.x = n * b - w * d + c.x;
                    a.y = g + c.y;
                    a.z = e + c.z;
                    return a
                };
                c.strictEquals = function(a, b) {
                    return a.x === b.x && a.y === b.y && a.z === b.z
                };
                c.equals = function(a, b, c) {
                    void 0 === c && (c =
                        g.EPSILON);
                    var d = a.x,
                        e = a.y;
                    a = a.z;
                    var l = b.x,
                        f = b.y;
                    b = b.z;
                    return Math.abs(d - l) <= c * Math.max(1, Math.abs(d), Math.abs(l)) && Math.abs(e - f) <= c * Math.max(1, Math.abs(e), Math.abs(f)) && Math.abs(a - b) <= c * Math.max(1, Math.abs(a), Math.abs(b))
                };
                c.angle = function(a, b) {
                    c.normalize(u, a);
                    c.normalize(v, b);
                    a = c.dot(u, v);
                    return 1 < a ? 0 : -1 > a ? Math.PI : Math.acos(a)
                };
                c.projectOnPlane = function(a, b, d) {
                    return c.subtract(a, b, c.project(a, b, d))
                };
                c.project = function(a, b, d) {
                    var g = c.lengthSqr(d);
                    return 1E-6 > g ? c.set(a, 0, 0, 0) : c.multiplyScalar(a,
                        d, c.dot(b, d) / g)
                };
                c.toArray = function(a, b, c) {
                    void 0 === c && (c = 0);
                    a[c + 0] = b.x;
                    a[c + 1] = b.y;
                    a[c + 2] = b.z;
                    return a
                };
                c.fromArray = function(a, b, c) {
                    void 0 === c && (c = 0);
                    a.x = b[c + 0];
                    a.y = b[c + 1];
                    a.z = b[c + 2];
                    return a
                };
                b(c, null, [{
                    key: "ONE",
                    get: function() {
                        return new c(1, 1, 1)
                    }
                }, {
                    key: "ZERO",
                    get: function() {
                        return new c
                    }
                }, {
                    key: "UP",
                    get: function() {
                        return new c(0, 1, 0)
                    }
                }, {
                    key: "RIGHT",
                    get: function() {
                        return new c(1, 0, 0)
                    }
                }, {
                    key: "FORWARD",
                    get: function() {
                        return new c(0, 0, 1)
                    }
                }]);
                e.clone = function() {
                    return new c(this.x, this.y, this.z)
                };
                e.set =
                    function(a) {
                        this.x = a.x;
                        this.y = a.y;
                        this.z = a.z;
                        return this
                    };
                e.equals = function(a) {
                    return a && this.x === a.x && this.y === a.y && this.z === a.z
                };
                e.fuzzyEquals = function(a, b) {
                    return this.x - b <= a.x && a.x <= this.x + b && this.y - b <= a.y && a.y <= this.y + b && this.z - b <= a.z && a.z <= this.z + b ? !0 : !1
                };
                e.toString = function() {
                    return "(" + this.x.toFixed(2) + ", " + this.y.toFixed(2) + ", " + this.z.toFixed(2) + ")"
                };
                e.lerp = function(a, b, d) {
                    d = d || new c;
                    c.lerp(d, this, a, b);
                    return d
                };
                e.clampf = function(a, b) {
                    this.x = d["default"].clampf(this.x, a.x, b.x);
                    this.y = d["default"].clampf(this.y,
                        a.y, b.y);
                    this.z = d["default"].clampf(this.z, a.z, b.z);
                    return this
                };
                e.addSelf = function(a) {
                    this.x += a.x;
                    this.y += a.y;
                    this.z += a.z;
                    return this
                };
                e.add = function(a, b) {
                    b = b || new c;
                    b.x = this.x + a.x;
                    b.y = this.y + a.y;
                    b.z = this.z + a.z;
                    return b
                };
                e.subtract = function(a) {
                    this.x -= a.x;
                    this.y -= a.y;
                    this.z -= a.z;
                    return this
                };
                e.multiplyScalar = function(a) {
                    this.x *= a;
                    this.y *= a;
                    this.z *= a;
                    return this
                };
                e.multiply = function(a) {
                    this.x *= a.x;
                    this.y *= a.y;
                    this.z *= a.z;
                    return this
                };
                e.divide = function(a) {
                    this.x /= a;
                    this.y /= a;
                    this.z /= a;
                    return this
                };
                e.negate = function() {
                    this.x = -this.x;
                    this.y = -this.y;
                    this.z = -this.z;
                    return this
                };
                e.dot = function(a) {
                    return this.x * a.x + this.y * a.y + this.z * a.z
                };
                e.cross = function(a, b) {
                    b = b || new c;
                    c.cross(b, this, a);
                    return b
                };
                e.len = function() {
                    return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z)
                };
                e.lengthSqr = function() {
                    return this.x * this.x + this.y * this.y + this.z * this.z
                };
                e.normalizeSelf = function() {
                    c.normalize(this, this);
                    return this
                };
                e.normalize = function(a) {
                    a = a || new c;
                    c.normalize(a, this);
                    return a
                };
                e.transformMat4 = function(a,
                    b) {
                    b = b || new c;
                    c.transformMat4(b, this, a);
                    return b
                };
                e.maxAxis = function() {
                    return Math.max(this.x, this.y, this.z)
                };
                e.signAngle = function(a) {
                    cc.warnID(1408, "vec3.signAngle", "v2.1", "cc.v2(selfVector).signAngle(vector)");
                    var b = new l["default"](this.x, this.y);
                    a = new l["default"](a.x, a.y);
                    return b.signAngle(a)
                };
                e.rotate = function(a, b) {
                    cc.warnID(1408, "vec3.rotate", "v2.1", "cc.v2(selfVector).rotate(radians, out)");
                    return l["default"].prototype.rotate.call(this, a, b)
                };
                e.rotateSelf = function(a) {
                    cc.warnID(1408, "vec3.rotateSelf",
                        "v2.1", "cc.v2(selfVector).rotateSelf(radians)");
                    return l["default"].prototype.rotateSelf.call(this, a)
                };
                return c
            }(c["default"]);
        m["default"] = p;
        p.sub = p.subtract;
        p.mul = p.multiply;
        p.scale = p.multiplyScalar;
        p.mag = p.len;
        p.squaredMagnitude = p.lengthSqr;
        p.div = p.divide;
        p.ONE_R = p.ONE;
        p.ZERO_R = p.ZERO;
        p.UP_R = p.UP;
        p.RIGHT_R = p.RIGHT;
        p.FRONT_R = p.FORWARD;
        var u = new p,
            v = new p;
        a["default"].fastDefine("cc.Vec3", p, {
            x: 0,
            y: 0,
            z: 0
        });
        cc.v3 = function(a, b, c) {
            return new p(a, b, c)
        };
        cc.Vec3 = p;
        q.exports = m["default"]
    }, {
        "../platform/CCClass": 204,
        "../utils/misc": 286,
        "./utils": 308,
        "./value-type": 309,
        "./vec2": 310
    }],
    312: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, b) {
            for (var c = 0; c < b.length; c++) {
                var d = b[c];
                d.enumerable = d.enumerable || !1;
                d.configurable = !0;
                "value" in d && (d.writable = !0);
                Object.defineProperty(a, d.key, d)
            }
        }

        function b(a, b, c) {
            b && e(a.prototype, b);
            c && e(a, c);
            return a
        }

        function k(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }

        function c(a, b, c, d) {
            return new t(a, b, c, d)
        }
        m.__esModule = !0;
        m.v4 = c;
        m["default"] = void 0;
        q = f(h("../platform/CCClass"));
        var a = f(h("./value-type")),
            d = h("./utils"),
            l = 0,
            g = 0,
            n = 0,
            w = 0,
            t = function(a) {
                function c(b, d, g, e) {
                    void 0 === b && (b = 0);
                    void 0 === d && (d = 0);
                    void 0 === g && (g = 0);
                    void 0 === e && (e = 0);
                    var l = a.call(this) || this;
                    l.mag = c.prototype.len;
                    l.magSqr = c.prototype.lengthSqr;
                    l.subSelf = c.prototype.subtract;
                    l.mulSelf = c.prototype.multiplyScalar;
                    l.divSelf = c.prototype.divide;
                    l.scaleSelf = c.prototype.multiply;
                    l.negSelf = c.prototype.negate;
                    l.x = void 0;
                    l.y = void 0;
                    l.z = void 0;
                    l.w = void 0;
                    b && "object" === typeof b ? (l.x = b.x, l.y = b.y, l.z = b.z, l.w = b.w) : (l.x = b, l.y = d, l.z = g, l.w = e);
                    return l
                }
                k(c, a);
                var e = c.prototype;
                e.sub = function(a, b) {
                    return c.subtract(b || new c, this, a)
                };
                e.mul = function(a, b) {
                    return c.multiplyScalar(b || new c, this, a)
                };
                e.div = function(a, b) {
                    return c.multiplyScalar(b || new c, this, 1 / a)
                };
                e.scale = function(a, b) {
                    return c.multiply(b || new c, this, a)
                };
                e.neg = function(a) {
                    return c.negate(a || new c, this)
                };
                c.clone = function(a) {
                    return new c(a.x, a.y, a.z, a.w)
                };
                c.copy = function(a, b) {
                    a.x = b.x;
                    a.y = b.y;
                    a.z = b.z;
                    a.w = b.w;
                    return a
                };
                c.set = function(a, b, c, d, g) {
                    a.x = b;
                    a.y = c;
                    a.z = d;
                    a.w = g;
                    return a
                };
                c.add = function(a, b, c) {
                    a.x = b.x + c.x;
                    a.y = b.y + c.y;
                    a.z = b.z + c.z;
                    a.w = b.w + c.w;
                    return a
                };
                c.subtract = function(a, b, c) {
                    a.x = b.x - c.x;
                    a.y = b.y - c.y;
                    a.z = b.z - c.z;
                    a.w = b.w - c.w;
                    return a
                };
                c.multiply = function(a, b, c) {
                    a.x = b.x * c.x;
                    a.y = b.y * c.y;
                    a.z = b.z * c.z;
                    a.w = b.w * c.w;
                    return a
                };
                c.divide = function(a, b, c) {
                    a.x = b.x / c.x;
                    a.y = b.y / c.y;
                    a.z = b.z / c.z;
                    a.w = b.w / c.w;
                    return a
                };
                c.ceil = function(a, b) {
                    a.x = Math.ceil(b.x);
                    a.y = Math.ceil(b.y);
                    a.z = Math.ceil(b.z);
                    a.w = Math.ceil(b.w);
                    return a
                };
                c.floor = function(a, b) {
                    a.x = Math.floor(b.x);
                    a.y = Math.floor(b.y);
                    a.z = Math.floor(b.z);
                    a.w = Math.floor(b.w);
                    return a
                };
                c.min = function(a, b, c) {
                    a.x = Math.min(b.x, c.x);
                    a.y = Math.min(b.y, c.y);
                    a.z = Math.min(b.z, c.z);
                    a.w = Math.min(b.w, c.w);
                    return a
                };
                c.max = function(a, b, c) {
                    a.x = Math.max(b.x, c.x);
                    a.y = Math.max(b.y, c.y);
                    a.z = Math.max(b.z, c.z);
                    a.w = Math.max(b.w, c.w);
                    return a
                };
                c.round = function(a, b) {
                    a.x = Math.round(b.x);
                    a.y = Math.round(b.y);
                    a.z = Math.round(b.z);
                    a.w = Math.round(b.w);
                    return a
                };
                c.multiplyScalar = function(a,
                    b, c) {
                    a.x = b.x * c;
                    a.y = b.y * c;
                    a.z = b.z * c;
                    a.w = b.w * c;
                    return a
                };
                c.scaleAndAdd = function(a, b, c, d) {
                    a.x = b.x + c.x * d;
                    a.y = b.y + c.y * d;
                    a.z = b.z + c.z * d;
                    a.w = b.w + c.w * d;
                    return a
                };
                c.distance = function(a, b) {
                    var c = b.x - a.x,
                        d = b.y - a.y,
                        g = b.z - a.z;
                    a = b.w - a.w;
                    return Math.sqrt(c * c + d * d + g * g + a * a)
                };
                c.squaredDistance = function(a, b) {
                    var c = b.x - a.x,
                        d = b.y - a.y,
                        g = b.z - a.z;
                    a = b.w - a.w;
                    return c * c + d * d + g * g + a * a
                };
                c.len = function(a) {
                    l = a.x;
                    g = a.y;
                    n = a.z;
                    w = a.w;
                    return Math.sqrt(l * l + g * g + n * n + w * w)
                };
                c.lengthSqr = function(a) {
                    l = a.x;
                    g = a.y;
                    n = a.z;
                    w = a.w;
                    return l * l + g * g + n * n +
                        w * w
                };
                c.negate = function(a, b) {
                    a.x = -b.x;
                    a.y = -b.y;
                    a.z = -b.z;
                    a.w = -b.w;
                    return a
                };
                c.inverse = function(a, b) {
                    a.x = 1 / b.x;
                    a.y = 1 / b.y;
                    a.z = 1 / b.z;
                    a.w = 1 / b.w;
                    return a
                };
                c.inverseSafe = function(a, b) {
                    l = b.x;
                    g = b.y;
                    n = b.z;
                    w = b.w;
                    Math.abs(l) < d.EPSILON ? a.x = 0 : a.x = 1 / l;
                    Math.abs(g) < d.EPSILON ? a.y = 0 : a.y = 1 / g;
                    Math.abs(n) < d.EPSILON ? a.z = 0 : a.z = 1 / n;
                    Math.abs(w) < d.EPSILON ? a.w = 0 : a.w = 1 / w;
                    return a
                };
                c.normalize = function(a, b) {
                    l = b.x;
                    g = b.y;
                    n = b.z;
                    w = b.w;
                    b = l * l + g * g + n * n + w * w;
                    0 < b && (b = 1 / Math.sqrt(b), a.x = l * b, a.y = g * b, a.z = n * b, a.w = w * b);
                    return a
                };
                c.dot = function(a,
                    b) {
                    return a.x * b.x + a.y * b.y + a.z * b.z + a.w * b.w
                };
                c.lerp = function(a, b, c, d) {
                    a.x = b.x + d * (c.x - b.x);
                    a.y = b.y + d * (c.y - b.y);
                    a.z = b.z + d * (c.z - b.z);
                    a.w = b.w + d * (c.w - b.w);
                    return a
                };
                c.random = function(a, b) {
                    b = b || 1;
                    var c = 2 * (0, d.random)() * Math.PI,
                        g = 2 * (0, d.random)() - 1,
                        e = Math.sqrt(1 - g * g);
                    a.x = e * Math.cos(c) * b;
                    a.y = e * Math.sin(c) * b;
                    a.z = g * b;
                    a.w = 0;
                    return a
                };
                c.transformMat4 = function(a, b, c) {
                    l = b.x;
                    g = b.y;
                    n = b.z;
                    w = b.w;
                    b = c.m;
                    a.x = b[0] * l + b[4] * g + b[8] * n + b[12] * w;
                    a.y = b[1] * l + b[5] * g + b[9] * n + b[13] * w;
                    a.z = b[2] * l + b[6] * g + b[10] * n + b[14] * w;
                    a.w = b[3] * l + b[7] *
                        g + b[11] * n + b[15] * w;
                    return a
                };
                c.transformAffine = function(a, b, c) {
                    l = b.x;
                    g = b.y;
                    n = b.z;
                    w = b.w;
                    c = c.m;
                    a.x = c[0] * l + c[1] * g + c[2] * n + c[3] * w;
                    a.y = c[4] * l + c[5] * g + c[6] * n + c[7] * w;
                    a.x = c[8] * l + c[9] * g + c[10] * n + c[11] * w;
                    a.w = b.w;
                    return a
                };
                c.transformQuat = function(a, b, c) {
                    var d = b.x,
                        e = b.y,
                        f = b.z;
                    l = c.x;
                    g = c.y;
                    n = c.z;
                    w = c.w;
                    c = w * d + g * f - n * e;
                    var k = w * e + n * d - l * f,
                        h = w * f + l * e - g * d;
                    d = -l * d - g * e - n * f;
                    a.x = c * w + d * -l + k * -n - h * -g;
                    a.y = k * w + d * -g + h * -l - c * -n;
                    a.z = h * w + d * -n + c * -g - k * -l;
                    a.w = b.w;
                    return a
                };
                c.strictEquals = function(a, b) {
                    return a.x === b.x && a.y === b.y && a.z === b.z &&
                        a.w === b.w
                };
                c.equals = function(a, b, c) {
                    void 0 === c && (c = d.EPSILON);
                    return Math.abs(a.x - b.x) <= c * Math.max(1, Math.abs(a.x), Math.abs(b.x)) && Math.abs(a.y - b.y) <= c * Math.max(1, Math.abs(a.y), Math.abs(b.y)) && Math.abs(a.z - b.z) <= c * Math.max(1, Math.abs(a.z), Math.abs(b.z)) && Math.abs(a.w - b.w) <= c * Math.max(1, Math.abs(a.w), Math.abs(b.w))
                };
                c.toArray = function(a, b, c) {
                    void 0 === c && (c = 0);
                    a[c + 0] = b.x;
                    a[c + 1] = b.y;
                    a[c + 2] = b.z;
                    a[c + 3] = b.w;
                    return a
                };
                c.fromArray = function(a, b, c) {
                    void 0 === c && (c = 0);
                    a.x = b[c + 0];
                    a.y = b[c + 1];
                    a.z = b[c + 2];
                    a.w = b[c +
                        3];
                    return a
                };
                b(c, null, [{
                    key: "ZERO",
                    get: function() {
                        return new c(0, 0, 0, 0)
                    }
                }, {
                    key: "ONE",
                    get: function() {
                        return new c(1, 1, 1, 1)
                    }
                }, {
                    key: "NEG_ONE",
                    get: function() {
                        return new c(-1, -1, -1, -1)
                    }
                }]);
                e.clone = function() {
                    return new c(this.x, this.y, this.z, this.w)
                };
                e.set = function(a, b, c, d) {
                    a && "object" === typeof a ? (this.x = a.x, this.y = a.y, this.z = a.z, this.w = a.w) : (this.x = a || 0, this.y = b || 0, this.z = c || 0, this.w = d || 0);
                    return this
                };
                e.equals = function(a, b) {
                    void 0 === b && (b = d.EPSILON);
                    return Math.abs(this.x - a.x) <= b * Math.max(1, Math.abs(this.x),
                        Math.abs(a.x)) && Math.abs(this.y - a.y) <= b * Math.max(1, Math.abs(this.y), Math.abs(a.y)) && Math.abs(this.z - a.z) <= b * Math.max(1, Math.abs(this.z), Math.abs(a.z)) && Math.abs(this.w - a.w) <= b * Math.max(1, Math.abs(this.w), Math.abs(a.w))
                };
                e.equals4f = function(a, b, c, g, e) {
                    void 0 === e && (e = d.EPSILON);
                    return Math.abs(this.x - a) <= e * Math.max(1, Math.abs(this.x), Math.abs(a)) && Math.abs(this.y - b) <= e * Math.max(1, Math.abs(this.y), Math.abs(b)) && Math.abs(this.z - c) <= e * Math.max(1, Math.abs(this.z), Math.abs(c)) && Math.abs(this.w - g) <= e * Math.max(1,
                        Math.abs(this.w), Math.abs(g))
                };
                e.strictEquals = function(a) {
                    return this.x === a.x && this.y === a.y && this.z === a.z && this.w === a.w
                };
                e.strictEquals4f = function(a, b, c, d) {
                    return this.x === a && this.y === b && this.z === c && this.w === d
                };
                e.lerp = function(a, b) {
                    l = this.x;
                    g = this.y;
                    n = this.z;
                    w = this.w;
                    this.x = l + b * (a.x - l);
                    this.y = g + b * (a.y - g);
                    this.z = n + b * (a.z - n);
                    this.w = w + b * (a.w - w);
                    return this
                };
                e.toString = function() {
                    return "(" + this.x.toFixed(2) + ", " + this.y.toFixed(2) + ", " + this.z.toFixed(2) + ", " + this.w.toFixed(2) + ")"
                };
                e.clampf = function(a,
                    b) {
                    this.x = (0, d.clamp)(this.x, a.x, b.x);
                    this.y = (0, d.clamp)(this.y, a.y, b.y);
                    this.z = (0, d.clamp)(this.z, a.z, b.z);
                    this.w = (0, d.clamp)(this.w, a.w, b.w);
                    return this
                };
                e.addSelf = function(a) {
                    this.x += a.x;
                    this.y += a.y;
                    this.z += a.z;
                    this.w += a.w;
                    return this
                };
                e.add = function(a, b) {
                    b = b || new c;
                    b.x = this.x + a.x;
                    b.y = this.y + a.y;
                    b.z = this.z + a.z;
                    b.w = this.w + a.w;
                    return b
                };
                e.subtract = function(a, b) {
                    b = b || new c;
                    b.x = this.x - a.x;
                    b.y = this.y - a.y;
                    b.z = this.z - a.z;
                    b.w = this.w - a.w;
                    return b
                };
                e.multiplyScalar = function(a) {
                    this.x *= a;
                    this.y *= a;
                    this.z *=
                        a;
                    this.w *= a;
                    return this
                };
                e.multiply = function(a) {
                    this.x *= a.x;
                    this.y *= a.y;
                    this.z *= a.z;
                    this.w *= a.w;
                    return this
                };
                e.divide = function(a) {
                    this.x /= a;
                    this.y /= a;
                    this.z /= a;
                    this.w /= a;
                    return this
                };
                e.negate = function() {
                    this.x = -this.x;
                    this.y = -this.y;
                    this.z = -this.z;
                    this.w = -this.w;
                    return this
                };
                e.dot = function(a) {
                    return this.x * a.x + this.y * a.y + this.z * a.z + this.w * a.w
                };
                e.cross = function(a, b) {
                    b = b || new c;
                    var d = this.x,
                        g = this.y,
                        e = this.z,
                        l = a.x,
                        f = a.y;
                    a = a.z;
                    b.x = g * a - e * f;
                    b.y = e * l - d * a;
                    b.z = d * f - g * l;
                    return b
                };
                e.len = function() {
                    var a = this.x,
                        b = this.y,
                        c = this.z,
                        d = this.w;
                    return Math.sqrt(a * a + b * b + c * c + d * d)
                };
                e.lengthSqr = function() {
                    var a = this.x,
                        b = this.y,
                        c = this.z,
                        d = this.w;
                    return a * a + b * b + c * c + d * d
                };
                e.normalizeSelf = function() {
                    this.normalize(this);
                    return this
                };
                e.normalize = function(a) {
                    a = a || new c;
                    l = this.x;
                    g = this.y;
                    n = this.z;
                    w = this.w;
                    var b = l * l + g * g + n * n + w * w;
                    0 < b && (b = 1 / Math.sqrt(b), a.x = l * b, a.y = g * b, a.z = n * b, a.w = w * b);
                    return a
                };
                e.transformMat4 = function(a, b) {
                    b = b || new c;
                    l = this.x;
                    g = this.y;
                    n = this.z;
                    w = this.w;
                    a = a.m;
                    b.x = a[0] * l + a[4] * g + a[8] * n + a[12] * w;
                    b.y = a[1] * l + a[5] *
                        g + a[9] * n + a[13] * w;
                    b.z = a[2] * l + a[6] * g + a[10] * n + a[14] * w;
                    b.w = a[3] * l + a[7] * g + a[11] * n + a[15] * w;
                    return b
                };
                e.maxAxis = function() {
                    return Math.max(this.x, this.y, this.z, this.w)
                };
                return c
            }(a["default"]);
        m["default"] = t;
        t.sub = t.subtract;
        t.mul = t.multiply;
        t.div = t.divide;
        t.scale = t.multiplyScalar;
        t.mag = t.len;
        t.squaredMagnitude = t.lengthSqr;
        t.ZERO_R = t.ZERO;
        t.ONE_R = t.ONE;
        t.NEG_ONE_R = t.NEG_ONE;
        q["default"].fastDefine("cc.Vec4", t, {
            x: 0,
            y: 0,
            z: 0,
            w: 0
        });
        cc.v4 = c;
        cc.Vec4 = t
    }, {
        "../platform/CCClass": 204,
        "./utils": 308,
        "./value-type": 309
    }],
    313: [function(h, q, m) {
        var f = cc.js;
        !0;
        h = function(b, c, a) {
            b && (a = a || f.getClassName(b), c.forEach(function(c) {
                function d() {
                    cc.errorID(1406, a, c)
                }
                f.getset(b.prototype, c, d, d)
            }))
        };
        q = function(b, c, a) {
            b && c.forEach(function(c) {
                f.getset(b, c, function() {
                    cc.errorID(1406, a, c)
                })
            })
        };
        m = function(b, c, a) {
            var d, e;
            if (b) {
                var g = "Sorry, " + (a || cc.js.getClassName(b)) + ".%s is removed, please use %s instead.";
                a = function() {
                    function a(a, c) {
                        function d(b) {
                            cc.error(g, a, b)
                        }
                        Array.isArray(c) || (c = c.split(",").map(function(a) {
                            return a.trim()
                        }));
                        try {
                            f.getset(b, a, d.bind(null, c[0]), c[1] && d.bind(null, c[1]))
                        } catch (v) {}
                    }
                    e = c[k];
                    "*" === k[0] ? (d = k.slice(1), a("g" + d, e), a("s" + d, e)) : k.split(",").map(function(a) {
                        return a.trim()
                    }).forEach(function(b) {
                        a(b, e)
                    })
                };
                for (var k in c) a()
            }
        };
        var e = function(b, c, a) {
            if (b) {
                a = a || f.getClassName(b);
                for (var d in c)(function() {
                    var e = d,
                        g = b[e];
                    g && (b[e] = function() {
                        cc.warn("Sorry, %s.%s is deprecated. Please use %s instead", a, e, c[e]);
                        return g.apply(this, arguments)
                    })
                })()
            }
        };
        f.get(cc, "info", function() {
            cc.errorID(1400, "cc.info", "cc.log");
            return cc.log
        });
        f.get(cc, "spriteFrameCache", function() {
            cc.errorID(1404)
        });
        f.get(cc, "vmath", function() {
            cc.warnID(1400, "cc.vmath", "cc.math");
            return cc.math
        });
        f.get(cc.math, "vec2", function() {
            cc.warnID(1400, "cc.vmath.vec2", "cc.Vec2");
            return cc.Vec2
        });
        f.get(cc.math, "vec3", function() {
            cc.warnID(1400, "cc.vmath.vec3", "cc.Vec3");
            return cc.Vec3
        });
        f.get(cc.math, "vec4", function() {
            cc.warnID(1400, "cc.vmath.vec4", "cc.Vec4");
            return cc.Vec4
        });
        f.get(cc.math, "mat4", function() {
            cc.warnID(1400, "cc.vmath.mat4", "cc.Mat4");
            return cc.Mat4
        });
        f.get(cc.math, "mat3", function() {
            cc.warnID(1400, "cc.vmath.mat3", "cc.Mat3");
            return cc.Mat3
        });
        f.get(cc.math, "quat", function() {
            cc.warnID(1400, "cc.vmath.quat", "cc.Quat");
            return cc.Quat
        });
        f.get(cc.SpriteFrame.prototype, "_textureLoaded", function() {
            cc.errorID(1400, "spriteFrame._textureLoaded", "spriteFrame.textureLoaded()");
            return this.textureLoaded()
        });
        h(cc.SpriteFrame, ["addLoadedEventListener"]);
        e(cc.Sprite.prototype, {
            setState: "cc.Sprite.setMaterial",
            getState: "cc.Sprite.getMaterial"
        }, "cc.Sprite");
        f.get(cc.SpriteFrame.prototype, "clearTexture", function() {
            cc.errorID(1406, "cc.SpriteFrame", "clearTexture");
            return function() {}
        });
        f.get(cc, "textureCache", function() {
            cc.errorID(1406, "cc", "textureCache")
        });
        var b = cc.Texture2D;
        f.get(b.prototype, "releaseTexture", function() {
            cc.errorID(1400, "texture.releaseTexture()", "texture.destroy()");
            return this.destroy
        });
        f.get(b.prototype, "getName", function() {
            cc.errorID(1400, "texture.getName()", "texture._glID");
            return function() {
                return this._glID || null
            }
        });
        f.get(b.prototype,
            "isLoaded",
            function() {
                cc.errorID(1400, "texture.isLoaded function", "texture.loaded property");
                return function() {
                    return this.loaded
                }
            });
        f.get(b.prototype, "setAntiAliasTexParameters", function() {
            cc.errorID(1400, "texture.setAntiAliasTexParameters()", "texture.setFilters(cc.Texture2D.Filter.LINEAR, cc.Texture2D.Filter.LINEAR)");
            return function() {
                this.setFilters(b.Filter.LINEAR, b.Filter.LINEAR)
            }
        });
        f.get(b.prototype, "setAliasTexParameters", function() {
            cc.errorID(1400, "texture.setAntiAliasTexParameters()", "texture.setFilters(cc.Texture2D.Filter.NEAREST, cc.Texture2D.Filter.NEAREST)");
            return function() {
                this.setFilters(b.Filter.NEAREST, b.Filter.NEAREST)
            }
        });
        q(cc.macro, ["ENABLE_GL_STATE_CACHE", "FIX_ARTIFACTS_BY_STRECHING_TEXEL"], "cc.macro");
        m(cc.macro, {
            PI: "Math.PI",
            PI2: "Math.PI * 2",
            FLT_MAX: "Number.MAX_VALUE",
            FLT_MIN: "Number.MIN_VALUE",
            UINT_MAX: "Number.MAX_SAFE_INTEGER"
        }, "cc.macro");
        q(cc.game, ["CONFIG_KEY"], "cc.game");
        q(cc.sys, "dumpRoot cleanScript BROWSER_TYPE_WECHAT_GAME BROWSER_TYPE_WECHAT_GAME_SUB BROWSER_TYPE_BAIDU_GAME BROWSER_TYPE_BAIDU_GAME_SUB BROWSER_TYPE_XIAOMI_GAME BROWSER_TYPE_ALIPAY_GAME".split(" "),
            "cc.sys");
        m(cc.Director, {
            EVENT_PROJECTION_CHANGED: "",
            EVENT_BEFORE_VISIT: "EVENT_AFTER_UPDATE",
            EVENT_AFTER_VISIT: "EVENT_BEFORE_DRAW"
        }, "cc.Director");
        e(cc.Director.prototype, {
            convertToGL: "cc.view.convertToLocationInView",
            convertToUI: "",
            getWinSize: "cc.winSize",
            getWinSizeInPixels: "cc.winSize",
            getVisibleSize: "cc.view.getVisibleSize",
            getVisibleOrigin: "cc.view.getVisibleOrigin",
            purgeCachedData: "cc.assetManager.releaseAll",
            setDepthTest: "cc.Camera.main.depth",
            setClearColor: "cc.Camera.main.backgroundColor",
            getRunningScene: "cc.director.getScene",
            getAnimationInterval: "cc.game.getFrameRate",
            setAnimationInterval: "cc.game.setFrameRate",
            isDisplayStats: "cc.debug.isDisplayStats",
            setDisplayStats: "cc.debug.setDisplayStats",
            stopAnimation: "cc.game.pause",
            startAnimation: "cc.game.resume"
        }, "cc.Director");
        h(cc.Director, "pushScene popScene popToRootScene popToSceneStackLevel setProjection getProjection".split(" "), "cc.Director");
        m(cc.Scheduler, {
            scheduleCallbackForTarget: "schedule",
            scheduleUpdateForTarget: "scheduleUpdate",
            unscheduleCallbackForTarget: "unschedule",
            unscheduleUpdateForTarget: "unscheduleUpdate",
            unscheduleAllCallbacksForTarget: "unscheduleAllForTarget",
            unscheduleAllCallbacks: "unscheduleAll",
            unscheduleAllCallbacksWithMinPriority: "unscheduleAllWithMinPriority"
        }, "cc.Scheduler");
        m(cc.view, {
            adjustViewPort: "adjustViewportMeta",
            setViewPortInPoints: "setViewportInPoints",
            getViewPortRect: "getViewportRect"
        }, "cc.view");
        q(cc.view, "isViewReady setTargetDensityDPI getTargetDensityDPI setFrameZoomFactor canSetContentScaleFactor setContentTranslateLeftTop getContentTranslateLeftTop setViewName getViewName".split(" "),
            "cc.view");
        h(cc.PhysicsManager, ["attachDebugDrawToCamera", "detachDebugDrawFromCamera"]);
        h(cc.CollisionManager, ["attachDebugDrawToCamera", "detachDebugDrawFromCamera"]);
        m(cc._BaseNode.prototype, {
            tag: "name",
            getTag: "name",
            setTag: "name",
            getChildByTag: "getChildByName",
            removeChildByTag: "getChildByName(name).destroy()"
        });
        h(cc.Node, "_cascadeColorEnabled cascadeColor isCascadeColorEnabled setCascadeColorEnabled _cascadeOpacityEnabled cascadeOpacity isCascadeOpacityEnabled setCascadeOpacityEnabled opacityModifyRGB isOpacityModifyRGB setOpacityModifyRGB ignoreAnchor isIgnoreAnchorPointForPosition ignoreAnchorPointForPosition isRunning _sgNode".split(" "));
        e(cc.Node.prototype, {
            getNodeToParentTransform: "getLocalMatrix",
            getNodeToParentTransformAR: "getLocalMatrix",
            getNodeToWorldTransform: "getWorldMatrix",
            getNodeToWorldTransformAR: "getWorldMatrix",
            getParentToNodeTransform: "getLocalMatrix",
            getWorldToNodeTransform: "getWorldMatrix",
            convertTouchToNodeSpace: "convertToNodeSpaceAR",
            convertTouchToNodeSpaceAR: "convertToNodeSpaceAR",
            convertToWorldSpace: "convertToWorldSpaceAR",
            convertToNodeSpace: "convertToNodeSpaceAR"
        });
        m(cc.Node.prototype, {
            getRotationX: "rotationX",
            setRotationX: "rotationX",
            getRotationY: "rotationY",
            setRotationY: "rotationY",
            getPositionX: "x",
            setPositionX: "x",
            getPositionY: "y",
            setPositionY: "y",
            getSkewX: "skewX",
            setSkewX: "skewX",
            getSkewY: "skewY",
            setSkewY: "skewY",
            getScaleX: "scaleX",
            setScaleX: "scaleX",
            getScaleY: "scaleY",
            setScaleY: "scaleY",
            getOpacity: "opacity",
            setOpacity: "opacity",
            getColor: "color",
            setColor: "color",
            getLocalZOrder: "zIndex",
            setLocalZOrder: "zIndex"
        });
        m(cc.Sprite.prototype, {
            setInsetLeft: "cc.SpriteFrame insetLeft",
            setInsetRight: "cc.SpriteFrame insetRight",
            setInsetTop: "cc.SpriteFrame insetTop",
            setInsetBottom: "cc.SpriteFrame insetBottom"
        });
        cc.Material.getInstantiatedBuiltinMaterial = cc.MaterialVariant.createWithBuiltin;
        cc.Material.getInstantiatedMaterial = cc.MaterialVariant.create;
        e(cc.Material, {
            getInstantiatedBuiltinMaterial: "cc.MaterialVariant.createWithBuiltin",
            getInstantiatedMaterial: "cc.MaterialVariant.create"
        });
        cc.js.getset(cc.RenderComponent.prototype, "sharedMaterials", function() {
                cc.warnID(1400, "sharedMaterials", "getMaterials");
                return this.materials
            },
            function(b) {
                cc.warnID(1400, "sharedMaterials", "setMaterial");
                this.materials = b
            });
        e(cc.Camera.prototype, {
            getNodeToCameraTransform: "getWorldToScreenMatrix2D",
            getCameraToWorldPoint: "getScreenToWorldPoint",
            getWorldToCameraPoint: "getWorldToScreenPoint",
            getCameraToWorldMatrix: "getScreenToWorldMatrix2D",
            getWorldToCameraMatrix: "getWorldToScreenMatrix2D"
        });
        h(cc.Camera, ["addTarget", "removeTarget", "getTargets"]);
        !1;
        Object.defineProperties(cc.Scene.prototype, {
            active: {
                get: function() {
                    cc.error('"%s" is not defined in the Scene, it is only defined in normal nodes.',
                        "active");
                    return !0
                },
                set: function() {
                    cc.error('"%s" is not defined in the Scene, it is only defined in normal nodes.', "active")
                }
            },
            activeInHierarchy: {
                get: function() {
                    cc.error('"%s" is not defined in the Scene, it is only defined in normal nodes.', "activeInHierarchy");
                    return !0
                }
            },
            getComponent: {
                get: function() {
                    cc.error('"%s" is not defined in the Scene, it is only defined in normal nodes.', "getComponent");
                    return function() {
                        return null
                    }
                }
            },
            addComponent: {
                get: function() {
                    cc.error('"%s" is not defined in the Scene, it is only defined in normal nodes.',
                        "addComponent");
                    return function() {
                        return null
                    }
                }
            }
        });
        q(cc.dynamicAtlasManager, ["minFrameSize"], "cc.dynamicAtlasManager");
        cc.Light && q(cc.Light.prototype, ["shadowDepthScale"], "cc.Light.prototype");
        m(cc, {
            affineTransformMake: "cc.AffineTransform.create",
            affineTransformMakeIdentity: "cc.AffineTransform.identity",
            affineTransformClone: "cc.AffineTransform.clone",
            affineTransformConcat: "cc.AffineTransform.concat",
            affineTransformConcatIn: "cc.AffineTransform.concat",
            affineTransformInvert: "cc.AffineTransform.invert",
            affineTransformInvertIn: "cc.AffineTransform.invert",
            affineTransformInvertOut: "cc.AffineTransform.invert",
            affineTransformEqualToTransform: "cc.AffineTransform.equal",
            pointApplyAffineTransform: "cc.AffineTransform.transformVec2",
            sizeApplyAffineTransform: "cc.AffineTransform.transformSize",
            rectApplyAffineTransform: "cc.AffineTransform.transformRect",
            obbApplyAffineTransform: "cc.AffineTransform.transformObb",
            pointEqualToPoint: "cc.Vec2 equals",
            sizeEqualToSize: "cc.Size equals",
            rectEqualToRect: "rectA.equals(rectB)",
            rectContainsRect: "rectA.containsRect(rectB)",
            rectContainsPoint: "rect.contains(vec2)",
            rectOverlapsRect: "rectA.intersects(rectB)",
            rectIntersectsRect: "rectA.intersects(rectB)",
            rectIntersection: "rectA.intersection(intersection, rectB)",
            rectUnion: "rectA.union(union, rectB)",
            rectGetMaxX: "rect.xMax",
            rectGetMidX: "rect.center.x",
            rectGetMinX: "rect.xMin",
            rectGetMaxY: "rect.yMax",
            rectGetMidY: "rect.center.y",
            rectGetMinY: "rect.yMin",
            colorEqual: "colorA.equals(colorB)",
            hexToColor: "color.fromHEX(hexColor)",
            colorToHex: "color.toHEX()",
            TextAlignment: "cc.macro.TextAlignment",
            VerticalTextAlignment: "cc.macro.VerticalTextAlignment",
            pNeg: "p.neg()",
            pAdd: "p1.add(p2)",
            pSub: "p1.sub(p2)",
            pMult: "p.mul(factor)",
            pMidpoint: "p1.add(p2).mul(0.5)",
            pDot: "p1.dot(p2)",
            pCross: "p1.cross(p2)",
            pPerp: "p.rotate(-90 * Math.PI / 180)",
            pRPerp: "p.rotate(90 * Math.PI / 180)",
            pProject: "p1.project(p2)",
            pLengthSQ: "p.magSqr()",
            pDistanceSQ: "p1.sub(p2).magSqr()",
            pLength: "p.mag()",
            pDistance: "p1.sub(p2).mag()",
            pNormalize: "p.normalize()",
            pForAngle: "cc.v2(Math.cos(a), Math.sin(a))",
            pToAngle: "Math.atan2(v.y, v.x)",
            pZeroIn: "p.x = p.y = 0",
            pIn: "p1.set(p2)",
            pMultIn: "p.mulSelf(factor)",
            pSubIn: "p1.subSelf(p2)",
            pAddIn: "p1.addSelf(p2)",
            pNormalizeIn: "p.normalizeSelf()",
            pSameAs: "p1.equals(p2)",
            pAngle: "v1.angle(v2)",
            pAngleSigned: "v1.signAngle(v2)",
            pRotateByAngle: "p.rotate(radians)",
            pCompMult: "v1.multiply(v2)",
            pFuzzyEqual: "v1.fuzzyEquals(v2, tolerance)",
            pLerp: "p.lerp(endPoint, ratio)",
            pClamp: "p.clampf(min_inclusive, max_inclusive)",
            rand: "Math.random() * 0xffffff",
            randomMinus1To1: "(Math.random() - 0.5) * 2",
            container: "cc.game.container",
            _canvas: "cc.game.canvas",
            _renderType: "cc.game.renderType",
            _getError: "cc.debug.getError",
            _initDebugSetting: "cc.debug._resetDebugSetting",
            DebugMode: "cc.debug.DebugMode"
        }, "cc");
        q(cc, "blendFuncDisable pFromSize pCompOp pIntersectPoint pSegmentIntersect pLineIntersect obbApplyMatrix getImageFormatByData initEngine".split(" "), "cc");
        e(cc, {
            p: "cc.v2"
        }, "cc");
        m(cc.Rect, {
            contain: "rectA.contains(rectB)",
            transformMat4: "rect.transformMat4(out, mat4)"
        });
        m(cc.Color, {
            rgb2hsv: "color.toHSV()",
            hsv2rgb: "color.fromHSV(h, s, v)"
        });
        e(cc.Color, {
            fromHex: "cc.Color.fromHEX"
        });
        f.get(cc, "lerp", function() {
            cc.errorID(1400, "cc.lerp", "cc.misc.lerp");
            return cc.misc.lerp
        });
        f.get(cc, "random0To1", function() {
            cc.errorID(1400, "cc.random0To1", "Math.random");
            return Math.random
        });
        f.get(cc, "degreesToRadians", function() {
            cc.errorID(1400, "cc.degreesToRadians", "cc.misc.degreesToRadians");
            return cc.misc.degreesToRadians
        });
        f.get(cc, "radiansToDegrees", function() {
            cc.errorID(1400, "cc.radiansToDegrees", "cc.misc.radiansToDegrees");
            return cc.misc.radiansToDegrees
        });
        f.get(cc, "clampf", function() {
            cc.errorID(1400, "cc.clampf", "cc.misc.clampf");
            return cc.misc.clampf
        });
        f.get(cc, "clamp01", function() {
            cc.errorID(1400, "cc.clamp01", "cc.misc.clamp01");
            return cc.misc.clamp01
        });
        f.get(cc, "ImageFormat", function() {
            cc.errorID(1400, "cc.ImageFormat", "cc.macro.ImageFormat");
            return cc.macro.ImageFormat
        });
        f.get(cc, "KEY", function() {
            cc.errorID(1400, "cc.KEY", "cc.macro.KEY");
            return cc.macro.KEY
        });
        f.get(cc, "Easing", function() {
            cc.errorID(1400, "cc.Easing",
                "cc.easing");
            return cc.easing
        });
        f.get(cc, "isChildClassOf", function() {
            cc.errorID(1400, "cc.isChildClassOf", "cc.js.isChildClassOf");
            return cc.js.isChildClassOf
        });
        "undefined" !== typeof dragonBones && f.get(dragonBones.CCFactory, "getFactory", function() {
            cc.errorID(1400, "dragonBones.CCFactory.getFactory", "dragonBones.CCFactory.getInstance");
            return dragonBones.CCFactory.getInstance
        });
        cc.renderer.renderEngine = {
            get gfx() {
                cc.warnID(1400, "cc.renderer.renderEngine.gfx", "cc.gfx");
                return cc.gfx
            },
            get math() {
                cc.warnID(1400,
                    "cc.renderer.renderEngine.math", "cc.math");
                return cc.vmath
            },
            get InputAssembler() {
                cc.warnID(1400, "cc.renderer.renderEngine.InputAssembler", "cc.renderer.InputAssembler");
                return cc.renderer.InputAssembler
            }
        };
        q(cc.audioEngine, ["getProfile", "preload", "setMaxWebAudioSize"], "cc.audioEngine")
    }, {}],
    314: [function(h, q, m) {
        h("./core/CCGame");
        h("./actions")
    }, {
        "./actions": 8,
        "./core/CCGame": 39
    }],
    315: [function(h, q, m) {
        var f = h("../compression/zlib.min"),
            e = h("../core/CCDebug");
        h = function(b) {
            var f, c, a;
            this.data = b;
            this.pos =
                8;
            this.palette = [];
            this.imgData = [];
            this.transparency = {};
            this.animation = null;
            this.text = {};
            for (c = null;;) {
                var d = this.readUInt32();
                b = [];
                for (a = 0; 4 > a; ++a) b.push(String.fromCharCode(this.data[this.pos++]));
                b = b.join("");
                switch (b) {
                    case "IHDR":
                        this.width = this.readUInt32();
                        this.height = this.readUInt32();
                        this.bits = this.data[this.pos++];
                        this.colorType = this.data[this.pos++];
                        this.compressionMethod = this.data[this.pos++];
                        this.filterMethod = this.data[this.pos++];
                        this.interlaceMethod = this.data[this.pos++];
                        break;
                    case "acTL":
                        this.animation = {
                            numFrames: this.readUInt32(),
                            numPlays: this.readUInt32() || Infinity,
                            frames: []
                        };
                        break;
                    case "PLTE":
                        this.palette = this.read(d);
                        break;
                    case "fcTL":
                        c && this.animation.frames.push(c);
                        this.pos += 4;
                        c = {
                            width: this.readUInt32(),
                            height: this.readUInt32(),
                            xOffset: this.readUInt32(),
                            yOffset: this.readUInt32()
                        };
                        b = this.readUInt16();
                        d = this.readUInt16() || 100;
                        c.delay = 1E3 * b / d;
                        c.disposeOp = this.data[this.pos++];
                        c.blendOp = this.data[this.pos++];
                        c.data = [];
                        break;
                    case "IDAT":
                    case "fdAT":
                        "fdAT" === b && (this.pos += 4, d -= 4);
                        b = (null != c ? c.data :
                            void 0) || this.imgData;
                        for (a = 0; 0 <= d ? a < d : a > d; 0 <= d ? ++a : --a) b.push(this.data[this.pos++]);
                        break;
                    case "tRNS":
                        this.transparency = {};
                        switch (this.colorType) {
                            case 3:
                                this.transparency.indexed = this.read(d);
                                d = 255 - this.transparency.indexed.length;
                                if (0 < d)
                                    for (b = 0; 0 <= d ? b < d : b > d; 0 <= d ? ++b : --b) this.transparency.indexed.push(255);
                                break;
                            case 0:
                                this.transparency.grayscale = this.read(d)[0];
                                break;
                            case 2:
                                this.transparency.rgb = this.read(d)
                        }
                        break;
                    case "tEXt":
                        a = this.read(d);
                        d = a.indexOf(0);
                        b = String.fromCharCode.apply(String, a.slice(0,
                            d));
                        this.text[b] = String.fromCharCode.apply(String, a.slice(d + 1));
                        break;
                    case "IEND":
                        c && this.animation.frames.push(c);
                        a: {
                            switch (this.colorType) {
                                case 0:
                                case 3:
                                case 4:
                                    c = 1;
                                    break a;
                                case 2:
                                case 6:
                                    c = 3;
                                    break a
                            }
                            c = void 0
                        }
                        this.colors = c;
                        this.hasAlphaChannel = 4 === (f = this.colorType) || 6 === f;
                        f = this.colors + (this.hasAlphaChannel ? 1 : 0);
                        this.pixelBitlength = this.bits * f;
                        a: {
                            switch (this.colors) {
                                case 1:
                                    f = "DeviceGray";
                                    break a;
                                case 3:
                                    f = "DeviceRGB";
                                    break a
                            }
                            f = void 0
                        }
                        this.colorSpace = f;
                        Uint8Array != Array && (this.imgData = new Uint8Array(this.imgData));
                        return;
                    default:
                        this.pos += d
                }
                this.pos += 4;
                if (this.pos > this.data.length) throw Error(e.getError(6017));
            }
        };
        h.prototype = {
            constructor: h,
            read: function(b) {
                var e;
                var c = [];
                for (e = 0; 0 <= b ? e < b : e > b; 0 <= b ? ++e : --e) c.push(this.data[this.pos++]);
                return c
            },
            readUInt32: function() {
                var b = this.data[this.pos++] << 24;
                var e = this.data[this.pos++] << 16;
                var c = this.data[this.pos++] << 8;
                var a = this.data[this.pos++];
                return b | e | c | a
            },
            readUInt16: function() {
                var b = this.data[this.pos++] << 8;
                var e = this.data[this.pos++];
                return b | e
            },
            decodePixels: function(b) {
                var k,
                    c, a, d, l, g, h, w;
                null == b && (b = this.imgData);
                if (0 === b.length) return new Uint8Array(0);
                b = (new f.Inflate(b, {
                    index: 0,
                    verify: !1
                })).decompress();
                var t = this.pixelBitlength / 8;
                var p = t * this.width;
                var u = new Uint8Array(p * this.height);
                var v = b.length;
                for (c = d = l = 0; d < v;) {
                    switch (b[d++]) {
                        case 0:
                            for (k = 0; k < p; k += 1) u[c++] = b[d++];
                            break;
                        case 1:
                            for (a = g = 0; g < p; a = g += 1) {
                                k = b[d++];
                                var m = a < t ? 0 : u[c - t];
                                u[c++] = (k + m) % 256
                            }
                            break;
                        case 2:
                            for (a = m = 0; m < p; a = m += 1) {
                                k = b[d++];
                                var B = (a - a % t) / t;
                                g = l && u[(l - 1) * p + B * t + a % t];
                                u[c++] = (g + k) % 256
                            }
                            break;
                        case 3:
                            for (a =
                                w = 0; w < p; a = w += 1) k = b[d++], B = (a - a % t) / t, m = a < t ? 0 : u[c - t], g = l && u[(l - 1) * p + B * t + a % t], u[c++] = (k + Math.floor((m + g) / 2)) % 256;
                            break;
                        case 4:
                            for (a = w = 0; w < p; a = w += 1) {
                                k = b[d++];
                                B = (a - a % t) / t;
                                m = a < t ? 0 : u[c - t];
                                0 === l ? g = h = 0 : (g = u[(l - 1) * p + B * t + a % t], h = B && u[(l - 1) * p + (B - 1) * t + a % t]);
                                var q = m + g - h;
                                a = Math.abs(q - m);
                                B = Math.abs(q - g);
                                q = Math.abs(q - h);
                                m = a <= B && a <= q ? m : B <= q ? g : h;
                                u[c++] = (k + m) % 256
                            }
                            break;
                        default:
                            throw Error(e.getError(6018, b[d - 1]));
                    }
                    l++
                }
                return u
            },
            copyToImageData: function(b, e) {
                var c, a;
                var d = this.colors;
                var l = null;
                var g = this.hasAlphaChannel;
                this.palette.length && (l = null != (c = this._decodedPalette) ? c : this._decodedPalette = this.decodePalette(), d = 4, g = !0);
                b = b.data || b;
                var f = b.length;
                var k = l || e;
                c = a = 0;
                if (1 === d)
                    for (; c < f;) d = l ? 4 * e[c / 4] : a, a = k[d++], b[c++] = a, b[c++] = a, b[c++] = a, b[c++] = g ? k[d++] : 255, a = d;
                else
                    for (; c < f;) d = l ? 4 * e[c / 4] : a, b[c++] = k[d++], b[c++] = k[d++], b[c++] = k[d++], b[c++] = g ? k[d++] : 255, a = d
            },
            decodePalette: function() {
                var b, e, c, a, d;
                var l = this.palette;
                var g = this.transparency.indexed || [];
                var f = new Uint8Array((g.length || 0) + l.length);
                var h = c = b = e = 0;
                for (a =
                    l.length; c < a; h = c += 3) f[e++] = l[h], f[e++] = l[h + 1], f[e++] = l[h + 2], f[e++] = null != (d = g[b++]) ? d : 255;
                return f
            },
            render: function(b) {
                b.width = this.width;
                b.height = this.height;
                b = b.getContext("2d");
                var e = b.createImageData(this.width, this.height);
                this.copyToImageData(e, this.decodePixels());
                return b.putImageData(e, 0, 0)
            }
        };
        q.exports = h
    }, {
        "../compression/zlib.min": 26,
        "../core/CCDebug": 37
    }],
    316: [function(h, q, m) {
        m = h("../core/assets/CCAsset");
        h = h("../core/assets/CCSpriteFrame");
        h = cc.Class({
            name: "cc.ParticleAsset",
            extends: m,
            properties: {
                spriteFrame: {
                    default: null,
                    type: h
                }
            }
        });
        cc.ParticleAsset = q.exports = h
    }, {
        "../core/assets/CCAsset": 73,
        "../core/assets/CCSpriteFrame": 85
    }],
    317: [function(h, q, m) {
        var f = h("../core/platform/CCMacro");
        m = h("./CCParticleAsset");
        var e = h("../core/components/CCRenderComponent"),
            b = h("../compression/ZipUtils"),
            k = h("./CCPNGReader"),
            c = h("./CCTIFFReader"),
            a = h("../core/utils/texture-util");
        h("../core/renderer/render-flow");
        var d = h("./particle-simulator");
        h("../core/assets/material/CCMaterial");
        var l = h("../core/utils/blend-func"),
            g = cc.Enum({
                GRAVITY: 0,
                RADIUS: 1
            }),
            n = cc.Enum({
                FREE: 0,
                RELATIVE: 1,
                GROUPED: 2
            });
        h = cc.Class({
            name: "cc.ParticleSystem",
            extends: e,
            mixins: [l],
            editor: !1,
            ctor: function() {
                this.initProperties()
            },
            initProperties: function() {
                this._previewTimer = null;
                this._focused = !1;
                this._aspectRatio = 1;
                this._simulator = new d(this);
                this._startColor = cc.color(255, 255, 255, 255);
                this._startColorVar = cc.color(0, 0, 0, 0);
                this._endColor = cc.color(255, 255, 255, 0);
                this._endColorVar = cc.color(0, 0, 0, 0);
                this._renderSpriteFrame = null
            },
            properties: {
                preview: {
                    default: !0,
                    editorOnly: !0,
                    notify: !1,
                    animatable: !1,
                    tooltip: !1
                },
                _custom: !1,
                custom: {
                    get: function() {
                        return this._custom
                    },
                    set: function(a) {
                        !1;
                        this._custom !== a && (this._custom = a, this._applyFile(), !1)
                    },
                    animatable: !1,
                    tooltip: !1
                },
                _file: {
                    default: null,
                    type: m
                },
                file: {
                    get: function() {
                        return this._file
                    },
                    set: function(a, b) {
                        this._file !== a && ((this._file = a) ? (this._applyFile(), !1) : this.custom = !0)
                    },
                    animatable: !1,
                    type: m,
                    tooltip: !1
                },
                _spriteFrame: {
                    default: null,
                    type: cc.SpriteFrame
                },
                spriteFrame: {
                    get: function() {
                        return this._spriteFrame
                    },
                    set: function(a,
                        b) {
                        b = this._renderSpriteFrame;
                        !1;
                        b !== a && ((this._renderSpriteFrame = a) && !a._uuid || (this._spriteFrame = a), this._applySpriteFrame(b), !1)
                    },
                    type: cc.SpriteFrame,
                    tooltip: !1
                },
                _texture: {
                    default: null,
                    type: cc.Texture2D,
                    editorOnly: !0
                },
                texture: {
                    get: function() {
                        return this._getTexture()
                    },
                    set: function(a) {
                        a && cc.warnID(6017)
                    },
                    type: cc.Texture2D,
                    tooltip: !1,
                    readonly: !0,
                    visible: !1,
                    animatable: !1
                },
                particleCount: {
                    visible: !1,
                    get: function() {
                        return this._simulator.particles.length
                    },
                    readonly: !0
                },
                _stopped: !0,
                stopped: {
                    get: function() {
                        return this._stopped
                    },
                    animatable: !1,
                    visible: !1
                },
                playOnLoad: !0,
                autoRemoveOnFinish: {
                    default: !1,
                    animatable: !1,
                    tooltip: !1
                },
                active: {
                    get: function() {
                        return this._simulator.active
                    },
                    visible: !1
                },
                totalParticles: 150,
                duration: -1,
                emissionRate: 10,
                life: 1,
                lifeVar: 0,
                _startColor: null,
                startColor: {
                    type: cc.Color,
                    get: function() {
                        return this._startColor
                    },
                    set: function(a) {
                        this._startColor.r = a.r;
                        this._startColor.g = a.g;
                        this._startColor.b = a.b;
                        this._startColor.a = a.a
                    }
                },
                _startColorVar: null,
                startColorVar: {
                    type: cc.Color,
                    get: function() {
                        return this._startColorVar
                    },
                    set: function(a) {
                        this._startColorVar.r = a.r;
                        this._startColorVar.g = a.g;
                        this._startColorVar.b = a.b;
                        this._startColorVar.a = a.a
                    }
                },
                _endColor: null,
                endColor: {
                    type: cc.Color,
                    get: function() {
                        return this._endColor
                    },
                    set: function(a) {
                        this._endColor.r = a.r;
                        this._endColor.g = a.g;
                        this._endColor.b = a.b;
                        this._endColor.a = a.a
                    }
                },
                _endColorVar: null,
                endColorVar: {
                    type: cc.Color,
                    get: function() {
                        return this._endColorVar
                    },
                    set: function(a) {
                        this._endColorVar.r = a.r;
                        this._endColorVar.g = a.g;
                        this._endColorVar.b = a.b;
                        this._endColorVar.a = a.a
                    }
                },
                angle: 90,
                angleVar: 20,
                startSize: 50,
                startSizeVar: 0,
                endSize: 0,
                endSizeVar: 0,
                startSpin: 0,
                startSpinVar: 0,
                endSpin: 0,
                endSpinVar: 0,
                sourcePos: cc.Vec2.ZERO,
                posVar: cc.Vec2.ZERO,
                _positionType: {
                    default: n.FREE,
                    formerlySerializedAs: "positionType"
                },
                positionType: {
                    type: n,
                    get: function() {
                        return this._positionType
                    },
                    set: function(a) {
                        this._positionType = a;
                        this._updateMaterial()
                    }
                },
                emitterMode: {
                    default: g.GRAVITY,
                    type: g
                },
                gravity: cc.Vec2.ZERO,
                speed: 180,
                speedVar: 50,
                tangentialAccel: 80,
                tangentialAccelVar: 0,
                radialAccel: 0,
                radialAccelVar: 0,
                rotationIsDir: !1,
                startRadius: 0,
                startRadiusVar: 0,
                endRadius: 0,
                endRadiusVar: 0,
                rotatePerS: 0,
                rotatePerSVar: 0
            },
            statics: {
                DURATION_INFINITY: -1,
                START_SIZE_EQUAL_TO_END_SIZE: -1,
                START_RADIUS_EQUAL_TO_END_RADIUS: -1,
                EmitterMode: g,
                PositionType: n,
                _PNGReader: k,
                _TIFFReader: c
            },
            onFocusInEditor: !1,
            onLostFocusInEditor: !1,
            _startPreview: !1,
            _stopPreview: !1,
            _convertTextureToSpriteFrame: !1,
            __preload: function() {
                this._super();
                !1;
                this._custom && this.spriteFrame && !this._renderSpriteFrame ? this._applySpriteFrame(this.spriteFrame) :
                    this._file && (this._custom ? !this._getTexture() && this._applyFile() : this._applyFile());
                !0;
                this.playOnLoad && this.resetSystem();
                !1
            },
            onDestroy: function() {
                this.autoRemoveOnFinish && (this.autoRemoveOnFinish = !1);
                this._buffer && (this._buffer.destroy(), this._buffer = null);
                this._simulator._uvFilled = 0;
                this._super()
            },
            lateUpdate: function(a) {
                this._simulator.finished || this._simulator.step(a)
            },
            addParticle: function() {},
            stopSystem: function() {
                this._stopped = !0;
                this._simulator.stop()
            },
            resetSystem: function() {
                this._stopped = !1;
                this._simulator.reset();
                this.markForRender(!0)
            },
            isFull: function() {
                return this.particleCount >= this.totalParticles
            },
            setTextureWithRect: function(a, b) {
                a instanceof cc.Texture2D && (this.spriteFrame = new cc.SpriteFrame(a, b))
            },
            _applyFile: function() {
                var a = this._file;
                if (a) {
                    var b = this;
                    cc.assetManager.postLoadNative(a, function(c) {
                        c || !a._nativeAsset ? cc.errorID(6029) : b.isValid && (b._plistFile = a.nativeUrl, b._custom || b._initWithDictionary(a._nativeAsset), b._spriteFrame ? !b._renderSpriteFrame && b._spriteFrame && b._applySpriteFrame(b.spriteFrame) :
                            a.spriteFrame ? b.spriteFrame = a.spriteFrame : b._custom && b._initTextureWithDictionary(a._nativeAsset))
                    })
                }
            },
            _initTextureWithDictionary: function(d) {
                var g = cc.path.changeBasename(this._plistFile, d.textureFileName || "");
                if (d.textureFileName) a.loadImage(g, function(a, b) {
                    a ? (d.textureFileName = void 0, this._initTextureWithDictionary(d)) : (cc.assetManager.assets.add(g, b), this.spriteFrame = new cc.SpriteFrame(b))
                }, this);
                else if (d.textureImageData) {
                    var e = d.textureImageData;
                    if (!(e && 0 < e.length)) return !1;
                    var l = cc.assetManager.assets.get(g);
                    if (!l) {
                        e = b.unzipBase64AsArray(e, 1);
                        if (!e) return cc.warnID(6030, this._file.name), !1;
                        l = 8 < e.length && 137 === e[0] && 80 === e[1] && 78 === e[2] && 71 === e[3] && 13 === e[4] && 10 === e[5] && 26 === e[6] && 10 === e[7] ? f.ImageFormat.PNG : 2 < e.length && (73 === e[0] && 73 === e[1] || 77 === e[0] && 77 === e[1] || 255 === e[0] && 216 === e[1]) ? f.ImageFormat.TIFF : f.ImageFormat.UNKNOWN;
                        if (l !== f.ImageFormat.TIFF && l !== f.ImageFormat.PNG) return cc.warnID(6031, this._file.name), !1;
                        var h = document.createElement("canvas");
                        l === f.ImageFormat.PNG ? (new k(e)).render(h) : c.parseTIFF(e,
                            h);
                        l = a.cacheImage(g, h)
                    }
                    l || cc.warnID(6032, this._file.name);
                    this.spriteFrame = new cc.SpriteFrame(l)
                }
                return !0
            },
            _initWithDictionary: function(a) {
                this.totalParticles = parseInt(a.maxParticles || 0);
                this.life = parseFloat(a.particleLifespan || 0);
                this.lifeVar = parseFloat(a.particleLifespanVariance || 0);
                this.emissionRate = a.emissionRate || Math.min(this.totalParticles / this.life, Number.MAX_VALUE);
                this.duration = parseFloat(a.duration || 0);
                this.srcBlendFactor = parseInt(a.blendFuncSource || f.SRC_ALPHA);
                this.dstBlendFactor = parseInt(a.blendFuncDestination ||
                    f.ONE_MINUS_SRC_ALPHA);
                var b = this._startColor;
                b.r = 255 * parseFloat(a.startColorRed || 0);
                b.g = 255 * parseFloat(a.startColorGreen || 0);
                b.b = 255 * parseFloat(a.startColorBlue || 0);
                b.a = 255 * parseFloat(a.startColorAlpha || 0);
                b = this._startColorVar;
                b.r = 255 * parseFloat(a.startColorVarianceRed || 0);
                b.g = 255 * parseFloat(a.startColorVarianceGreen || 0);
                b.b = 255 * parseFloat(a.startColorVarianceBlue || 0);
                b.a = 255 * parseFloat(a.startColorVarianceAlpha || 0);
                b = this._endColor;
                b.r = 255 * parseFloat(a.finishColorRed || 0);
                b.g = 255 * parseFloat(a.finishColorGreen ||
                    0);
                b.b = 255 * parseFloat(a.finishColorBlue || 0);
                b.a = 255 * parseFloat(a.finishColorAlpha || 0);
                b = this._endColorVar;
                b.r = 255 * parseFloat(a.finishColorVarianceRed || 0);
                b.g = 255 * parseFloat(a.finishColorVarianceGreen || 0);
                b.b = 255 * parseFloat(a.finishColorVarianceBlue || 0);
                b.a = 255 * parseFloat(a.finishColorVarianceAlpha || 0);
                this.startSize = parseFloat(a.startParticleSize || 0);
                this.startSizeVar = parseFloat(a.startParticleSizeVariance || 0);
                this.endSize = parseFloat(a.finishParticleSize || 0);
                this.endSizeVar = parseFloat(a.finishParticleSizeVariance ||
                    0);
                this.positionType = parseFloat(void 0 !== a.positionType ? a.positionType : n.RELATIVE);
                this.sourcePos.x = 0;
                this.sourcePos.y = 0;
                this.posVar.x = parseFloat(a.sourcePositionVariancex || 0);
                this.posVar.y = parseFloat(a.sourcePositionVariancey || 0);
                this.angle = parseFloat(a.angle || 0);
                this.angleVar = parseFloat(a.angleVariance || 0);
                this.startSpin = parseFloat(a.rotationStart || 0);
                this.startSpinVar = parseFloat(a.rotationStartVariance || 0);
                this.endSpin = parseFloat(a.rotationEnd || 0);
                this.endSpinVar = parseFloat(a.rotationEndVariance ||
                    0);
                this.emitterMode = parseInt(a.emitterType || g.GRAVITY);
                if (this.emitterMode === g.GRAVITY) this.gravity.x = parseFloat(a.gravityx || 0), this.gravity.y = parseFloat(a.gravityy || 0), this.speed = parseFloat(a.speed || 0), this.speedVar = parseFloat(a.speedVariance || 0), this.radialAccel = parseFloat(a.radialAcceleration || 0), this.radialAccelVar = parseFloat(a.radialAccelVariance || 0), this.tangentialAccel = parseFloat(a.tangentialAcceleration || 0), this.tangentialAccelVar = parseFloat(a.tangentialAccelVariance || 0), b = a.rotationIsDir ||
                    "", null !== b ? (b = b.toString().toLowerCase(), this.rotationIsDir = "true" === b || "1" === b) : this.rotationIsDir = !1;
                else {
                    if (this.emitterMode !== g.RADIUS) return cc.warnID(6009), !1;
                    this.startRadius = parseFloat(a.maxRadius || 0);
                    this.startRadiusVar = parseFloat(a.maxRadiusVariance || 0);
                    this.endRadius = parseFloat(a.minRadius || 0);
                    this.endRadiusVar = parseFloat(a.minRadiusVariance || 0);
                    this.rotatePerS = parseFloat(a.rotatePerSecond || 0);
                    this.rotatePerSVar = parseFloat(a.rotatePerSecondVariance || 0)
                }
                this._initTextureWithDictionary(a);
                return !0
            },
            _validateRender: function() {
                var a = this._getTexture();
                a && a.loaded ? this._super() : this.disableRender()
            },
            _onTextureLoaded: function() {
                this._simulator.updateUVs(!0);
                this._syncAspect();
                this._updateMaterial();
                this.markForRender(!0)
            },
            _syncAspect: function() {
                var a = this._renderSpriteFrame._rect;
                this._aspectRatio = a.width / a.height
            },
            _applySpriteFrame: function() {
                (this._renderSpriteFrame = this._renderSpriteFrame || this._spriteFrame) && (this._renderSpriteFrame.textureLoaded() ? this._onTextureLoaded() : this._renderSpriteFrame.onTextureLoaded(this._onTextureLoaded,
                    this))
            },
            _getTexture: function() {
                return this._renderSpriteFrame && this._renderSpriteFrame.getTexture() || this._texture
            },
            _updateMaterial: function() {
                var a = this.getMaterial(0);
                a && (a.define("CC_USE_MODEL", this._positionType !== n.FREE), a.setProperty("texture", this._getTexture()), l.prototype._updateMaterial.call(this))
            },
            _finishedSimulation: function() {
                !1;
                this.resetSystem();
                this.stopSystem();
                this.disableRender();
                this.autoRemoveOnFinish && this._stopped && this.node.destroy()
            }
        });
        cc.ParticleSystem = q.exports = h
    }, {
        "../compression/ZipUtils": 23,
        "../core/assets/material/CCMaterial": 91,
        "../core/components/CCRenderComponent": 126,
        "../core/platform/CCMacro": 209,
        "../core/renderer/render-flow": 237,
        "../core/utils/blend-func": 280,
        "../core/utils/texture-util": 294,
        "./CCPNGReader": 315,
        "./CCParticleAsset": 316,
        "./CCTIFFReader": 318,
        "./particle-simulator": 320,
        "fire-url": void 0
    }],
    318: [function(h, q, m) {
        var f = h("../core/CCDebug");
        q.exports = {
            _littleEndian: !1,
            _tiffData: null,
            _fileDirectories: [],
            getUint8: function(e) {
                return this._tiffData[e]
            },
            getUint16: function(e) {
                return this._littleEndian ?
                    this._tiffData[e + 1] << 8 | this._tiffData[e] : this._tiffData[e] << 8 | this._tiffData[e + 1]
            },
            getUint32: function(e) {
                var b = this._tiffData;
                return this._littleEndian ? b[e + 3] << 24 | b[e + 2] << 16 | b[e + 1] << 8 | b[e] : b[e] << 24 | b[e + 1] << 16 | b[e + 2] << 8 | b[e + 3]
            },
            checkLittleEndian: function() {
                var e = this.getUint16(0);
                if (18761 === e) this.littleEndian = !0;
                else {
                    if (19789 !== e) throw console.log(e), TypeError(f.getError(6019));
                    this.littleEndian = !1
                }
                return this.littleEndian
            },
            hasTowel: function() {
                if (42 !== this.getUint16(2)) throw RangeError(f.getError(6020));
                return !0
            },
            getFieldTypeName: function(e) {
                var b = this.fieldTypeNames;
                return e in b ? b[e] : null
            },
            getFieldTagName: function(e) {
                var b = this.fieldTagNames;
                if (e in b) return b[e];
                cc.logID(6021, e);
                return "Tag" + e
            },
            getFieldTypeLength: function(e) {
                return -1 !== ["BYTE", "ASCII", "SBYTE", "UNDEFINED"].indexOf(e) ? 1 : -1 !== ["SHORT", "SSHORT"].indexOf(e) ? 2 : -1 !== ["LONG", "SLONG", "FLOAT"].indexOf(e) ? 4 : -1 !== ["RATIONAL", "SRATIONAL", "DOUBLE"].indexOf(e) ? 8 : null
            },
            getFieldValues: function(e, b, f, c) {
                e = [];
                var a = this.getFieldTypeLength(b);
                if (4 >=
                    a * f) !1 === this.littleEndian ? e.push(c >>> 8 * (4 - a)) : e.push(c);
                else
                    for (var d = 0; d < f; d++) {
                        var l = a * d;
                        8 <= a ? -1 !== ["RATIONAL", "SRATIONAL"].indexOf(b) ? (e.push(this.getUint32(c + l)), e.push(this.getUint32(c + l + 4))) : cc.logID(8E3) : e.push(this.getBytes(a, c + l))
                    }
                "ASCII" === b && e.forEach(function(a, b, c) {
                    c[b] = String.fromCharCode(a)
                });
                return e
            },
            getBytes: function(e, b) {
                if (0 >= e) cc.logID(8001);
                else {
                    if (1 >= e) return this.getUint8(b);
                    if (2 >= e) return this.getUint16(b);
                    if (3 >= e) return this.getUint32(b) >>> 8;
                    if (4 >= e) return this.getUint32(b);
                    cc.logID(8002)
                }
            },
            getBits: function(e, b, f) {
                f = f || 0;
                b += Math.floor(f / 8);
                var c = f + e;
                e = 32 - e;
                if (0 >= c) cc.logID(6023);
                else if (8 >= c) {
                    var a = 24 + f;
                    var d = this.getUint8(b)
                } else 16 >= c ? (a = 16 + f, d = this.getUint16(b)) : 32 >= c ? (a = f, d = this.getUint32(b)) : cc.logID(6022);
                return {
                    bits: d << a >>> e,
                    byteOffset: b + Math.floor(c / 8),
                    bitOffset: c % 8
                }
            },
            parseFileDirectory: function(e) {
                var b = this.getUint16(e),
                    f = [];
                e += 2;
                for (var c = 0; c < b; e += 12, c++) {
                    var a = this.getUint16(e),
                        d = this.getUint16(e + 2),
                        l = this.getUint32(e + 4),
                        g = this.getUint32(e + 8);
                    a = this.getFieldTagName(a);
                    d = this.getFieldTypeName(d);
                    l = this.getFieldValues(a, d, l, g);
                    f[a] = {
                        type: d,
                        values: l
                    }
                }
                this._fileDirectories.push(f);
                b = this.getUint32(e);
                0 !== b && this.parseFileDirectory(b)
            },
            clampColorSample: function(e, b) {
                b = Math.pow(2, 8 - b);
                return Math.floor(e * b + (b - 1))
            },
            parseTIFF: function(e, b) {
                var k, c;
                b = b || document.createElement("canvas");
                this._tiffData = e;
                this.canvas = b;
                this.checkLittleEndian();
                if (this.hasTowel()) {
                    e = this.getUint32(4);
                    this._fileDirectories.length = 0;
                    this.parseFileDirectory(e);
                    var a = this._fileDirectories[0];
                    e =
                        a.ImageWidth.values[0];
                    var d = a.ImageLength.values[0];
                    this.canvas.width = e;
                    this.canvas.height = d;
                    var l = [],
                        g = a.Compression ? a.Compression.values[0] : 1,
                        h = a.SamplesPerPixel.values[0],
                        m = [],
                        t = 0,
                        p = !1;
                    a.BitsPerSample.values.forEach(function(a, b, c) {
                        m[b] = {
                            bitsPerSample: a,
                            hasBytesPerSample: !1,
                            bytesPerSample: void 0
                        };
                        0 === a % 8 && (m[b].hasBytesPerSample = !0, m[b].bytesPerSample = a / 8);
                        t += a
                    }, this);
                    if (0 === t % 8) {
                        p = !0;
                        var u = t / 8
                    }
                    var v = a.StripOffsets.values,
                        A = v.length;
                    if (a.StripByteCounts) var B = a.StripByteCounts.values;
                    else {
                        cc.logID(8003);
                        if (1 !== A) throw Error(f.getError(6024));
                        B = [Math.ceil(e * d * t / 8)]
                    }
                    for (var q = 0; q < A; q++) {
                        var y = v[q];
                        l[q] = [];
                        for (var z = B[q], x = 0, C = 0, G = 1, F = !0, H = [], I = 0, K = 0, P = 0; x < z; x += G) switch (g) {
                            case 1:
                                G = 0;
                                for (H = []; G < h; G++) {
                                    if (!m[G].hasBytesPerSample) {
                                        var S = this.getBits(m[G].bitsPerSample, y + x, C);
                                        H.push(S.bits);
                                        x = S.byteOffset - y;
                                        C = S.bitOffset;
                                        throw RangeError(f.getError(6025));
                                    }
                                    H.push(this.getBytes(m[G].bytesPerSample, y + x + m[G].bytesPerSample * G))
                                }
                                l[q].push(H);
                                if (!p) throw G = 0, RangeError(f.getError(6026));
                                G = u;
                                break;
                            case 32773:
                                if (F) {
                                    F = !1;
                                    var M = c = 1;
                                    G = this.getInt8(y + x);
                                    0 <= G && 127 >= G ? c = G + 1 : -127 <= G && -1 >= G ? M = 1 - G : F = !0
                                } else {
                                    var O = this.getUint8(y + x);
                                    for (G = 0; G < M; G++) {
                                        if (!m[K].hasBytesPerSample) throw RangeError(f.getError(6025));
                                        P = P << 8 * I | O;
                                        I++;
                                        I === m[K].bytesPerSample && (H.push(P), P = I = 0, K++);
                                        K === h && (l[q].push(H), H = [], K = 0)
                                    }
                                    c--;
                                    0 === c && (F = !0)
                                }
                                G = 1
                        }
                    }
                    if (b.getContext) {
                        b = this.canvas.getContext("2d");
                        b.fillStyle = "rgba(255, 255, 255, 0)";
                        q = a.RowsPerStrip ? a.RowsPerStrip.values[0] : d;
                        M = l.length;
                        d %= q;
                        d = 0 === d ? q : d;
                        c = q;
                        H = 0;
                        u = a.PhotometricInterpretation.values[0];
                        y = [];
                        x = 0;
                        a.ExtraSamples && (y = a.ExtraSamples.values, x = y.length);
                        if (a.ColorMap) {
                            var L = a.ColorMap.values;
                            S = Math.pow(2, m[0].bitsPerSample)
                        }
                        for (q = 0; q < M; q++) {
                            q + 1 === M && (c = d);
                            a = l[q].length;
                            H *= q;
                            for (g = B = 0; B < c, g < a; B++)
                                for (h = 0; h < e; h++, g++) {
                                    v = l[q][g];
                                    C = z = A = 0;
                                    p = 1;
                                    if (0 < x)
                                        for (A = 0; A < x; A++)
                                            if (1 === y[A] || 2 === y[A]) {
                                                p = v[3 + A] / 256;
                                                break
                                            }
                                    switch (u) {
                                        case 0:
                                            m[0].hasBytesPerSample && (k = Math.pow(16, 2 * m[0].bytesPerSample)), v.forEach(function(a, b, c) {
                                                c[b] = k - a
                                            });
                                        case 1:
                                            A = z = C = this.clampColorSample(v[0], m[0].bitsPerSample);
                                            break;
                                        case 2:
                                            A =
                                                this.clampColorSample(v[0], m[0].bitsPerSample);
                                            z = this.clampColorSample(v[1], m[1].bitsPerSample);
                                            C = this.clampColorSample(v[2], m[2].bitsPerSample);
                                            break;
                                        case 3:
                                            if (void 0 === L) throw Error(f.getError(6027));
                                            v = v[0];
                                            A = this.clampColorSample(L[v], 16);
                                            z = this.clampColorSample(L[S + v], 16);
                                            C = this.clampColorSample(L[2 * S + v], 16);
                                            break;
                                        default:
                                            throw RangeError(f.getError(6028, u));
                                    }
                                    b.fillStyle = "rgba(" + A + ", " + z + ", " + C + ", " + p + ")";
                                    b.fillRect(h, H + B, 1, 1)
                                }
                            H = c
                        }
                    }
                    return this.canvas
                }
            },
            fieldTagNames: {
                315: "Artist",
                258: "BitsPerSample",
                265: "CellLength",
                264: "CellWidth",
                320: "ColorMap",
                259: "Compression",
                33432: "Copyright",
                306: "DateTime",
                338: "ExtraSamples",
                266: "FillOrder",
                289: "FreeByteCounts",
                288: "FreeOffsets",
                291: "GrayResponseCurve",
                290: "GrayResponseUnit",
                316: "HostComputer",
                270: "ImageDescription",
                257: "ImageLength",
                256: "ImageWidth",
                271: "Make",
                281: "MaxSampleValue",
                280: "MinSampleValue",
                272: "Model",
                254: "NewSubfileType",
                274: "Orientation",
                262: "PhotometricInterpretation",
                284: "PlanarConfiguration",
                296: "ResolutionUnit",
                278: "RowsPerStrip",
                277: "SamplesPerPixel",
                305: "Software",
                279: "StripByteCounts",
                273: "StripOffsets",
                255: "SubfileType",
                263: "Threshholding",
                282: "XResolution",
                283: "YResolution",
                326: "BadFaxLines",
                327: "CleanFaxData",
                343: "ClipPath",
                328: "ConsecutiveBadFaxLines",
                433: "Decode",
                434: "DefaultImageColor",
                269: "DocumentName",
                336: "DotRange",
                321: "HalftoneHints",
                346: "Indexed",
                347: "JPEGTables",
                285: "PageName",
                297: "PageNumber",
                317: "Predictor",
                319: "PrimaryChromaticities",
                532: "ReferenceBlackWhite",
                339: "SampleFormat",
                559: "StripRowCounts",
                330: "SubIFDs",
                292: "T4Options",
                293: "T6Options",
                325: "TileByteCounts",
                323: "TileLength",
                324: "TileOffsets",
                322: "TileWidth",
                301: "TransferFunction",
                318: "WhitePoint",
                344: "XClipPathUnits",
                286: "XPosition",
                529: "YCbCrCoefficients",
                531: "YCbCrPositioning",
                530: "YCbCrSubSampling",
                345: "YClipPathUnits",
                287: "YPosition",
                37378: "ApertureValue",
                40961: "ColorSpace",
                36868: "DateTimeDigitized",
                36867: "DateTimeOriginal",
                34665: "Exif IFD",
                36864: "ExifVersion",
                33434: "ExposureTime",
                41728: "FileSource",
                37385: "Flash",
                40960: "FlashpixVersion",
                33437: "FNumber",
                42016: "ImageUniqueID",
                37384: "LightSource",
                37500: "MakerNote",
                37377: "ShutterSpeedValue",
                37510: "UserComment",
                33723: "IPTC",
                34675: "ICC Profile",
                700: "XMP",
                42112: "GDAL_METADATA",
                42113: "GDAL_NODATA",
                34377: "Photoshop"
            },
            fieldTypeNames: {
                1: "BYTE",
                2: "ASCII",
                3: "SHORT",
                4: "LONG",
                5: "RATIONAL",
                6: "SBYTE",
                7: "UNDEFINED",
                8: "SSHORT",
                9: "SLONG",
                10: "SRATIONAL",
                11: "FLOAT",
                12: "DOUBLE"
            }
        }
    }, {
        "../core/CCDebug": 37
    }],
    319: [function(h, q, m) {
        h("./CCParticleAsset");
        h("./CCParticleSystem");
        h("./particle-simulator");
        h("./particle-system-assembler")
    }, {
        "./CCParticleAsset": 316,
        "./CCParticleSystem": 317,
        "./particle-simulator": 320,
        "./particle-system-assembler": 321
    }],
    320: [function(h, q, m) {
        m = h("../core/platform/js");
        var f = h("../core/utils/misc"),
            e = cc.v2(0, 0),
            b = cc.v2(),
            k = cc.v2(),
            c = cc.v2(),
            a = cc.v2(),
            d = function() {
                this.pos = cc.v2(0, 0);
                this.startPos = cc.v2(0, 0);
                this.color = cc.color(0, 0, 0, 255);
                this.deltaColor = {
                    r: 0,
                    g: 0,
                    b: 0,
                    a: 255
                };
                this.timeToLive = this.deltaRotation = this.rotation = this.deltaSize = this.size = 0;
                this.drawPos = cc.v2(0, 0);
                this.aspectRatio = 1;
                this.dir = cc.v2(0, 0);
                this.deltaRadius = this.radius =
                    this.degreesPerSecond = this.angle = this.tangentialAccel = this.radialAccel = 0
            },
            l = new m.Pool(function(a) {
                a.pos.set(e);
                a.startPos.set(e);
                a.color._val = 4278190080;
                a.deltaColor.r = a.deltaColor.g = a.deltaColor.b = 0;
                a.deltaColor.a = 255;
                a.size = 0;
                a.deltaSize = 0;
                a.rotation = 0;
                a.deltaRotation = 0;
                a.timeToLive = 0;
                a.drawPos.set(e);
                a.aspectRatio = 1;
                a.dir.set(e);
                a.radialAccel = 0;
                a.tangentialAccel = 0;
                a.angle = 0;
                a.degreesPerSecond = 0;
                a.radius = 0;
                a.deltaRadius = 0
            }, 1024);
        l.get = function() {
            return this._get() || new d
        };
        h = function(a) {
            this.sys =
                a;
            this.particles = [];
            this.active = !1;
            this.readyToPlay = !0;
            this.finished = !1;
            this._worldRotation = this._uvFilled = this.emitCounter = this.elapsed = 0
        };
        h.prototype.stop = function() {
            this.readyToPlay = this.active = !1;
            this.elapsed = this.sys.duration;
            this.emitCounter = 0
        };
        h.prototype.reset = function() {
            this.readyToPlay = this.active = !0;
            this.emitCounter = this.elapsed = 0;
            this.finished = !1;
            for (var a = this.particles, b = 0; b < a.length; ++b) l.put(a[b]);
            a.length = 0
        };
        h.prototype.emitParticle = function(a) {
            var b = this.sys,
                c = f.clampf,
                d = l.get();
            this.particles.push(d);
            d.timeToLive = b.life + b.lifeVar * (Math.random() - .5) * 2;
            var g = d.timeToLive = Math.max(0, d.timeToLive);
            d.pos.x = b.sourcePos.x + b.posVar.x * (Math.random() - .5) * 2;
            d.pos.y = b.sourcePos.y + b.posVar.y * (Math.random() - .5) * 2;
            var e, k, h;
            var m = b._startColor;
            var q = b._startColorVar,
                y = b._endColor,
                z = b._endColorVar;
            d.color.r = e = c(m.r + q.r * (Math.random() - .5) * 2, 0, 255);
            d.color.g = k = c(m.g + q.g * (Math.random() - .5) * 2, 0, 255);
            d.color.b = h = c(m.b + q.b * (Math.random() - .5) * 2, 0, 255);
            d.color.a = m = c(m.a + q.a * (Math.random() - .5) *
                2, 0, 255);
            d.deltaColor.r = (c(y.r + z.r * (Math.random() - .5) * 2, 0, 255) - e) / g;
            d.deltaColor.g = (c(y.g + z.g * (Math.random() - .5) * 2, 0, 255) - k) / g;
            d.deltaColor.b = (c(y.b + z.b * (Math.random() - .5) * 2, 0, 255) - h) / g;
            d.deltaColor.a = (c(y.a + z.a * (Math.random() - .5) * 2, 0, 255) - m) / g;
            c = b.startSize + b.startSizeVar * (Math.random() - .5) * 2;
            c = Math.max(0, c);
            d.size = c;
            b.endSize === cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE ? d.deltaSize = 0 : (e = b.endSize + b.endSizeVar * (Math.random() - .5) * 2, e = Math.max(0, e), d.deltaSize = (e - c) / g);
            c = b.startSpin + b.startSpinVar *
                (Math.random() - .5) * 2;
            e = b.endSpin + b.endSpinVar * (Math.random() - .5) * 2;
            d.rotation = c;
            d.deltaRotation = (e - c) / g;
            d.startPos.x = a.x;
            d.startPos.y = a.y;
            d.aspectRatio = b._aspectRatio || 1;
            a = f.degreesToRadians(b.angle + this._worldRotation + b.angleVar * (Math.random() - .5) * 2);
            b.emitterMode === cc.ParticleSystem.EmitterMode.GRAVITY ? (g = b.speed + b.speedVar * (Math.random() - .5) * 2, d.dir.x = Math.cos(a), d.dir.y = Math.sin(a), d.dir.mulSelf(g), d.radialAccel = b.radialAccel + b.radialAccelVar * (Math.random() - .5) * 2, d.tangentialAccel = b.tangentialAccel +
                b.tangentialAccelVar * (Math.random() - .5) * 2, b.rotationIsDir && (d.rotation = -f.radiansToDegrees(Math.atan2(d.dir.y, d.dir.x)))) : (c = b.startRadius + b.startRadiusVar * (Math.random() - .5) * 2, e = b.endRadius + b.endRadiusVar * (Math.random() - .5) * 2, d.radius = c, d.deltaRadius = b.endRadius === cc.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS ? 0 : (e - c) / g, d.angle = a, d.degreesPerSecond = f.degreesToRadians(b.rotatePerS + b.rotatePerSVar * (Math.random() - .5) * 2))
        };
        h.prototype.updateUVs = function(a) {
            var b = this.sys._assembler;
            if (b) {
                var c = b.getBuffer();
                if (c && this.sys._renderSpriteFrame) {
                    b = 4 * b._vfmt._bytes / 4;
                    c = c._vData;
                    var d = this.sys._renderSpriteFrame.uv,
                        g = this.particles.length;
                    for (a = a ? 0 : this._uvFilled; a < g; a++) {
                        var e = a * b;
                        c[e + 2] = d[0];
                        c[e + 3] = d[1];
                        c[e + 7] = d[2];
                        c[e + 8] = d[3];
                        c[e + 12] = d[4];
                        c[e + 13] = d[5];
                        c[e + 17] = d[6];
                        c[e + 18] = d[7]
                    }
                    this._uvFilled = g
                }
            }
        };
        h.prototype.updateParticleBuffer = function(a, b, c, d) {
            var g = c._vData;
            c = c._uintVData;
            var e = b.x;
            b = b.y;
            var l = a.size,
                k = l,
                h = a.aspectRatio;
            1 < h ? k = l / h : l = k * h;
            l /= 2;
            k /= 2;
            if (a.rotation) {
                h = -l;
                var n = -k,
                    t = -f.degreesToRadians(a.rotation),
                    m = Math.cos(t);
                t = Math.sin(t);
                g[d] = h * m - n * t + e;
                g[d + 1] = h * t + n * m + b;
                g[d + 5] = l * m - n * t + e;
                g[d + 6] = l * t + n * m + b;
                g[d + 10] = h * m - k * t + e;
                g[d + 11] = h * t + k * m + b;
                g[d + 15] = l * m - k * t + e;
                g[d + 16] = l * t + k * m + b
            } else g[d] = e - l, g[d + 1] = b - k, g[d + 5] = e + l, g[d + 6] = b - k, g[d + 10] = e - l, g[d + 11] = b + k, g[d + 15] = e + l, g[d + 16] = b + k;
            c[d + 4] = a.color._val;
            c[d + 9] = a.color._val;
            c[d + 14] = a.color._val;
            c[d + 19] = a.color._val
        };
        h.prototype.step = function(d) {
            d = d > cc.director._maxParticleDeltaTime ? cc.director._maxParticleDeltaTime : d;
            var g = this.sys,
                e = g.node,
                f = this.particles,
                h = 4 * this.sys._assembler._vfmt._bytes /
                4,
                u = cc.ParticleSystem.PositionType;
            e._updateWorldMatrix();
            if (g.positionType === u.FREE) {
                for (var v = 0, m = e; m;) v += m.angle, m = m.parent;
                this._worldRotation = v;
                e = e._worldMatrix.m;
                b.x = e[12];
                b.y = e[13]
            } else g.positionType === u.RELATIVE ? (this._worldRotation = e.angle, b.x = e.x, b.y = e.y) : this._worldRotation = 0;
            if (this.active && g.emissionRate) {
                e = 1 / g.emissionRate;
                for (f.length < g.totalParticles && (this.emitCounter += d); f.length < g.totalParticles && this.emitCounter > e;) this.emitParticle(b), this.emitCounter -= e;
                this.elapsed += d; - 1 !==
                    g.duration && g.duration < this.elapsed && g.stopSystem()
            }
            e = g._assembler.getBuffer();
            v = f.length;
            e.reset();
            e.request(4 * v, 6 * v);
            v > this._uvFilled && this.updateUVs();
            for (v = 0; v < f.length;)
                if (k.x = k.y = c.x = c.y = a.x = a.y = 0, m = f[v], m.timeToLive -= d, 0 < m.timeToLive) {
                    if (g.emitterMode === cc.ParticleSystem.EmitterMode.GRAVITY) {
                        var B = a,
                            q = k,
                            y = c;
                        if (m.pos.x || m.pos.y) q.set(m.pos), q.normalizeSelf();
                        y.set(q);
                        q.mulSelf(m.radialAccel);
                        var z = y.x;
                        y.x = -y.y;
                        y.y = z;
                        y.mulSelf(m.tangentialAccel);
                        B.set(q);
                        B.addSelf(y);
                        B.addSelf(g.gravity);
                        B.mulSelf(d);
                        m.dir.addSelf(B);
                        B.set(m.dir);
                        B.mulSelf(d);
                        m.pos.addSelf(B)
                    } else m.angle += m.degreesPerSecond * d, m.radius += m.deltaRadius * d, m.pos.x = -Math.cos(m.angle) * m.radius, m.pos.y = -Math.sin(m.angle) * m.radius;
                    m.color.r += m.deltaColor.r * d;
                    m.color.g += m.deltaColor.g * d;
                    m.color.b += m.deltaColor.b * d;
                    m.color.a += m.deltaColor.a * d;
                    m.size += m.deltaSize * d;
                    0 > m.size && (m.size = 0);
                    m.rotation += m.deltaRotation * d;
                    B = k;
                    B.set(m.pos);
                    g.positionType !== u.GROUPED && B.addSelf(m.startPos);
                    this.updateParticleBuffer(m, B, e, h * v);
                    ++v
                } else m = f[v], v !==
                    f.length - 1 && (f[v] = f[f.length - 1]), l.put(m), f.length--;
            g._assembler._ia._count = 6 * f.length;
            0 < f.length ? e.uploadData() : this.active || this.readyToPlay || (this.finished = !0, g._finishedSimulation())
        };
        q.exports = h
    }, {
        "../core/platform/js": 225,
        "../core/utils/misc": 286
    }],
    321: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }
        m = f(h("../core/renderer/assembler"));
        var b = f(h("../renderer/core/input-assembler")),
            k = h("./CCParticleSystem"),
            c = h("../core/renderer/"),
            a = h("../core/renderer/webgl/quad-buffer"),
            d = h("../core/renderer/webgl/vertex-format").vfmtPosUvColor;
        h = function(l) {
            function g(a) {
                a = l.call(this, a) || this;
                a._buffer = null;
                a._ia = null;
                a._vfmt = d;
                return a
            }
            e(g, l);
            var f = g.prototype;
            f.getBuffer = function() {
                this._buffer || (this._buffer = new a(c._handle, d), this._ia = new b["default"], this._ia._vertexBuffer = this._buffer._vb, this._ia._indexBuffer = this._buffer._ib, this._ia._start = 0, this._ia._count = 0);
                return this._buffer
            };
            f.fillBuffers = function(a, b) {
                this._ia && (a.positionType === cc.ParticleSystem.PositionType.RELATIVE ? b.node = a.node.parent : b.node = a.node, b.material = a._materials[0], b._flushIA(this._ia))
            };
            return g
        }(m["default"]);
        m["default"].register(k, h);
        q.exports = h
    }, {
        "../core/renderer/": 236,
        "../core/renderer/assembler": 233,
        "../core/renderer/webgl/quad-buffer": 272,
        "../core/renderer/webgl/vertex-format": 275,
        "../renderer/core/input-assembler": 324,
        "./CCParticleSystem": 317
    }],
    322: [function(h, q, m) {
        var f;
        (function(a) {
            a[a.COMPRESSED_RGB_S3TC_DXT1_EXT =
                33776] = "COMPRESSED_RGB_S3TC_DXT1_EXT";
            a[a.COMPRESSED_RGBA_S3TC_DXT1_EXT = 33777] = "COMPRESSED_RGBA_S3TC_DXT1_EXT";
            a[a.COMPRESSED_RGBA_S3TC_DXT3_EXT = 33778] = "COMPRESSED_RGBA_S3TC_DXT3_EXT";
            a[a.COMPRESSED_RGBA_S3TC_DXT5_EXT = 33779] = "COMPRESSED_RGBA_S3TC_DXT5_EXT";
            a[a.COMPRESSED_SRGB_S3TC_DXT1_EXT = 35916] = "COMPRESSED_SRGB_S3TC_DXT1_EXT";
            a[a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT = 35917] = "COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT";
            a[a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT = 35918] = "COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT";
            a[a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT =
                35919] = "COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT";
            a[a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG = 35840] = "COMPRESSED_RGB_PVRTC_4BPPV1_IMG";
            a[a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG = 35841] = "COMPRESSED_RGB_PVRTC_2BPPV1_IMG";
            a[a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG = 35842] = "COMPRESSED_RGBA_PVRTC_4BPPV1_IMG";
            a[a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG = 35843] = "COMPRESSED_RGBA_PVRTC_2BPPV1_IMG";
            a[a.COMPRESSED_RGB_ETC1_WEBGL = 36196] = "COMPRESSED_RGB_ETC1_WEBGL"
        })(f || (f = {}));
        var e;
        (function(a) {
            a[a.UNKNOWN = 0] = "UNKNOWN";
            a[a.BUFFER = 1] = "BUFFER";
            a[a.TEXTURE = 2] = "TEXTURE";
            a[a.TEXTURE_VIEW = 3] = "TEXTURE_VIEW";
            a[a.RENDER_PASS = 4] = "RENDER_PASS";
            a[a.FRAMEBUFFER = 5] = "FRAMEBUFFER";
            a[a.SAMPLER = 6] = "SAMPLER";
            a[a.SHADER = 7] = "SHADER";
            a[a.PIPELINE_LAYOUT = 8] = "PIPELINE_LAYOUT";
            a[a.PIPELINE_STATE = 9] = "PIPELINE_STATE";
            a[a.BINDING_LAYOUT = 10] = "BINDING_LAYOUT";
            a[a.INPUT_ASSEMBLER = 11] = "INPUT_ASSEMBLER";
            a[a.COMMAND_ALLOCATOR = 12] = "COMMAND_ALLOCATOR";
            a[a.COMMAND_BUFFER = 13] = "COMMAND_BUFFER";
            a[a.QUEUE = 14] = "QUEUE";
            a[a.WINDOW = 15] = "WINDOW"
        })(e || (e = {}));
        var b;
        (function(a) {
            a[a.UNREADY =
                0] = "UNREADY";
            a[a.FAILED = 1] = "FAILED";
            a[a.SUCCESS = 2] = "SUCCESS"
        })(b || (b = {}));
        (function() {
            function a(a) {
                this._gfxType = e.UNKNOWN;
                this._status = b.UNREADY;
                this._gfxType = a
            }
            Object.defineProperty(a.prototype, "gfxType", {
                get: function() {
                    return this._gfxType
                },
                enumerable: !0,
                configurable: !0
            });
            Object.defineProperty(a.prototype, "status", {
                get: function() {
                    return this._status
                },
                enumerable: !0,
                configurable: !0
            });
            return a
        })();
        var k;
        (function(a) {
            a.ATTR_POSITION = "a_position";
            a.ATTR_NORMAL = "a_normal";
            a.ATTR_TANGENT = "a_tangent";
            a.ATTR_BITANGENT = "a_bitangent";
            a.ATTR_WEIGHTS = "a_weights";
            a.ATTR_JOINTS = "a_joints";
            a.ATTR_COLOR = "a_color";
            a.ATTR_COLOR1 = "a_color1";
            a.ATTR_COLOR2 = "a_color2";
            a.ATTR_TEX_COORD = "a_texCoord";
            a.ATTR_TEX_COORD1 = "a_texCoord1";
            a.ATTR_TEX_COORD2 = "a_texCoord2";
            a.ATTR_TEX_COORD3 = "a_texCoord3";
            a.ATTR_TEX_COORD4 = "a_texCoord4";
            a.ATTR_TEX_COORD5 = "a_texCoord5";
            a.ATTR_TEX_COORD6 = "a_texCoord6";
            a.ATTR_TEX_COORD7 = "a_texCoord7";
            a.ATTR_TEX_COORD8 = "a_texCoord8"
        })(k || (k = {}));
        var c;
        (function(a) {
            a[a.UNKNOWN = 0] = "UNKNOWN";
            a[a.BOOL =
                1] = "BOOL";
            a[a.BOOL2 = 2] = "BOOL2";
            a[a.BOOL3 = 3] = "BOOL3";
            a[a.BOOL4 = 4] = "BOOL4";
            a[a.INT = 5] = "INT";
            a[a.INT2 = 6] = "INT2";
            a[a.INT3 = 7] = "INT3";
            a[a.INT4 = 8] = "INT4";
            a[a.UINT = 9] = "UINT";
            a[a.UINT2 = 10] = "UINT2";
            a[a.UINT3 = 11] = "UINT3";
            a[a.UINT4 = 12] = "UINT4";
            a[a.FLOAT = 13] = "FLOAT";
            a[a.FLOAT2 = 14] = "FLOAT2";
            a[a.FLOAT3 = 15] = "FLOAT3";
            a[a.FLOAT4 = 16] = "FLOAT4";
            a[a.COLOR4 = 17] = "COLOR4";
            a[a.MAT2 = 18] = "MAT2";
            a[a.MAT2X3 = 19] = "MAT2X3";
            a[a.MAT2X4 = 20] = "MAT2X4";
            a[a.MAT3X2 = 21] = "MAT3X2";
            a[a.MAT3 = 22] = "MAT3";
            a[a.MAT3X4 = 23] = "MAT3X4";
            a[a.MAT4X2 = 24] =
                "MAT4X2";
            a[a.MAT4X3 = 25] = "MAT4X3";
            a[a.MAT4 = 26] = "MAT4";
            a[a.SAMPLER1D = 27] = "SAMPLER1D";
            a[a.SAMPLER1D_ARRAY = 28] = "SAMPLER1D_ARRAY";
            a[a.SAMPLER2D = 29] = "SAMPLER2D";
            a[a.SAMPLER2D_ARRAY = 30] = "SAMPLER2D_ARRAY";
            a[a.SAMPLER3D = 31] = "SAMPLER3D";
            a[a.SAMPLER_CUBE = 32] = "SAMPLER_CUBE";
            a[a.COUNT = 33] = "COUNT"
        })(c || (c = {}));
        var a;
        (function(a) {
            a[a.UNKNOWN = 0] = "UNKNOWN";
            a[a.A8 = 1] = "A8";
            a[a.L8 = 2] = "L8";
            a[a.LA8 = 3] = "LA8";
            a[a.R8 = 4] = "R8";
            a[a.R8SN = 5] = "R8SN";
            a[a.R8UI = 6] = "R8UI";
            a[a.R8I = 7] = "R8I";
            a[a.R16F = 8] = "R16F";
            a[a.R16UI = 9] = "R16UI";
            a[a.R16I =
                10] = "R16I";
            a[a.R32F = 11] = "R32F";
            a[a.R32UI = 12] = "R32UI";
            a[a.R32I = 13] = "R32I";
            a[a.RG8 = 14] = "RG8";
            a[a.RG8SN = 15] = "RG8SN";
            a[a.RG8UI = 16] = "RG8UI";
            a[a.RG8I = 17] = "RG8I";
            a[a.RG16F = 18] = "RG16F";
            a[a.RG16UI = 19] = "RG16UI";
            a[a.RG16I = 20] = "RG16I";
            a[a.RG32F = 21] = "RG32F";
            a[a.RG32UI = 22] = "RG32UI";
            a[a.RG32I = 23] = "RG32I";
            a[a.RGB8 = 24] = "RGB8";
            a[a.SRGB8 = 25] = "SRGB8";
            a[a.RGB8SN = 26] = "RGB8SN";
            a[a.RGB8UI = 27] = "RGB8UI";
            a[a.RGB8I = 28] = "RGB8I";
            a[a.RGB16F = 29] = "RGB16F";
            a[a.RGB16UI = 30] = "RGB16UI";
            a[a.RGB16I = 31] = "RGB16I";
            a[a.RGB32F = 32] = "RGB32F";
            a[a.RGB32UI = 33] = "RGB32UI";
            a[a.RGB32I = 34] = "RGB32I";
            a[a.RGBA8 = 35] = "RGBA8";
            a[a.SRGB8_A8 = 36] = "SRGB8_A8";
            a[a.RGBA8SN = 37] = "RGBA8SN";
            a[a.RGBA8UI = 38] = "RGBA8UI";
            a[a.RGBA8I = 39] = "RGBA8I";
            a[a.RGBA16F = 40] = "RGBA16F";
            a[a.RGBA16UI = 41] = "RGBA16UI";
            a[a.RGBA16I = 42] = "RGBA16I";
            a[a.RGBA32F = 43] = "RGBA32F";
            a[a.RGBA32UI = 44] = "RGBA32UI";
            a[a.RGBA32I = 45] = "RGBA32I";
            a[a.R5G6B5 = 46] = "R5G6B5";
            a[a.R11G11B10F = 47] = "R11G11B10F";
            a[a.RGB5A1 = 48] = "RGB5A1";
            a[a.RGBA4 = 49] = "RGBA4";
            a[a.RGB10A2 = 50] = "RGB10A2";
            a[a.RGB10A2UI = 51] = "RGB10A2UI";
            a[a.RGB9E5 =
                52] = "RGB9E5";
            a[a.D16 = 53] = "D16";
            a[a.D16S8 = 54] = "D16S8";
            a[a.D24 = 55] = "D24";
            a[a.D24S8 = 56] = "D24S8";
            a[a.D32F = 57] = "D32F";
            a[a.D32F_S8 = 58] = "D32F_S8";
            a[a.BC1 = 59] = "BC1";
            a[a.BC1_ALPHA = 60] = "BC1_ALPHA";
            a[a.BC1_SRGB = 61] = "BC1_SRGB";
            a[a.BC1_SRGB_ALPHA = 62] = "BC1_SRGB_ALPHA";
            a[a.BC2 = 63] = "BC2";
            a[a.BC2_SRGB = 64] = "BC2_SRGB";
            a[a.BC3 = 65] = "BC3";
            a[a.BC3_SRGB = 66] = "BC3_SRGB";
            a[a.BC4 = 67] = "BC4";
            a[a.BC4_SNORM = 68] = "BC4_SNORM";
            a[a.BC5 = 69] = "BC5";
            a[a.BC5_SNORM = 70] = "BC5_SNORM";
            a[a.BC6H_UF16 = 71] = "BC6H_UF16";
            a[a.BC6H_SF16 = 72] = "BC6H_SF16";
            a[a.BC7 = 73] = "BC7";
            a[a.BC7_SRGB = 74] = "BC7_SRGB";
            a[a.ETC_RGB8 = 75] = "ETC_RGB8";
            a[a.ETC2_RGB8 = 76] = "ETC2_RGB8";
            a[a.ETC2_SRGB8 = 77] = "ETC2_SRGB8";
            a[a.ETC2_RGB8_A1 = 78] = "ETC2_RGB8_A1";
            a[a.ETC2_SRGB8_A1 = 79] = "ETC2_SRGB8_A1";
            a[a.ETC2_RGBA8 = 80] = "ETC2_RGBA8";
            a[a.ETC2_SRGB8_A8 = 81] = "ETC2_SRGB8_A8";
            a[a.EAC_R11 = 82] = "EAC_R11";
            a[a.EAC_R11SN = 83] = "EAC_R11SN";
            a[a.EAC_RG11 = 84] = "EAC_RG11";
            a[a.EAC_RG11SN = 85] = "EAC_RG11SN";
            a[a.PVRTC_RGB2 = 86] = "PVRTC_RGB2";
            a[a.PVRTC_RGBA2 = 87] = "PVRTC_RGBA2";
            a[a.PVRTC_RGB4 = 88] = "PVRTC_RGB4";
            a[a.PVRTC_RGBA4 =
                89] = "PVRTC_RGBA4";
            a[a.PVRTC2_2BPP = 90] = "PVRTC2_2BPP";
            a[a.PVRTC2_4BPP = 91] = "PVRTC2_4BPP"
        })(a || (a = {}));
        var d;
        (function(a) {
            a[a.NONE = 0] = "NONE";
            a[a.TRANSFER_SRC = 1] = "TRANSFER_SRC";
            a[a.TRANSFER_DST = 2] = "TRANSFER_DST";
            a[a.INDEX = 4] = "INDEX";
            a[a.VERTEX = 8] = "VERTEX";
            a[a.UNIFORM = 16] = "UNIFORM";
            a[a.STORAGE = 32] = "STORAGE";
            a[a.INDIRECT = 64] = "INDIRECT"
        })(d || (d = {}));
        var l;
        (function(a) {
            a[a.NONE = 0] = "NONE";
            a[a.DEVICE = 1] = "DEVICE";
            a[a.HOST = 2] = "HOST"
        })(l || (l = {}));
        var g;
        (function(a) {
            a[a.NONE = 0] = "NONE";
            a[a.READ = 1] = "READ";
            a[a.WRITE =
                2] = "WRITE"
        })(g || (g = {}));
        var n;
        (function(a) {
            a[a.POINT_LIST = 0] = "POINT_LIST";
            a[a.LINE_LIST = 1] = "LINE_LIST";
            a[a.LINE_STRIP = 2] = "LINE_STRIP";
            a[a.LINE_LOOP = 3] = "LINE_LOOP";
            a[a.LINE_LIST_ADJACENCY = 4] = "LINE_LIST_ADJACENCY";
            a[a.LINE_STRIP_ADJACENCY = 5] = "LINE_STRIP_ADJACENCY";
            a[a.ISO_LINE_LIST = 6] = "ISO_LINE_LIST";
            a[a.TRIANGLE_LIST = 7] = "TRIANGLE_LIST";
            a[a.TRIANGLE_STRIP = 8] = "TRIANGLE_STRIP";
            a[a.TRIANGLE_FAN = 9] = "TRIANGLE_FAN";
            a[a.TRIANGLE_LIST_ADJACENCY = 10] = "TRIANGLE_LIST_ADJACENCY";
            a[a.TRIANGLE_STRIP_ADJACENCY = 11] =
                "TRIANGLE_STRIP_ADJACENCY";
            a[a.TRIANGLE_PATCH_ADJACENCY = 12] = "TRIANGLE_PATCH_ADJACENCY";
            a[a.QUAD_PATCH_LIST = 13] = "QUAD_PATCH_LIST"
        })(n || (n = {}));
        var w;
        (function(a) {
            a[a.FILL = 0] = "FILL";
            a[a.POINT = 1] = "POINT";
            a[a.LINE = 2] = "LINE"
        })(w || (w = {}));
        var t;
        (function(a) {
            a[a.GOURAND = 0] = "GOURAND";
            a[a.FLAT = 1] = "FLAT"
        })(t || (t = {}));
        var p;
        (function(a) {
            a[a.NONE = 0] = "NONE";
            a[a.FRONT = 1] = "FRONT";
            a[a.BACK = 2] = "BACK"
        })(p || (p = {}));
        var u;
        (function(a) {
            a[a.NEVER = 0] = "NEVER";
            a[a.LESS = 1] = "LESS";
            a[a.EQUAL = 2] = "EQUAL";
            a[a.LESS_EQUAL = 3] = "LESS_EQUAL";
            a[a.GREATER = 4] = "GREATER";
            a[a.NOT_EQUAL = 5] = "NOT_EQUAL";
            a[a.GREATER_EQUAL = 6] = "GREATER_EQUAL";
            a[a.ALWAYS = 7] = "ALWAYS"
        })(u || (u = {}));
        var v;
        (function(a) {
            a[a.ZERO = 0] = "ZERO";
            a[a.KEEP = 1] = "KEEP";
            a[a.REPLACE = 2] = "REPLACE";
            a[a.INCR = 3] = "INCR";
            a[a.DECR = 4] = "DECR";
            a[a.INVERT = 5] = "INVERT";
            a[a.INCR_WRAP = 6] = "INCR_WRAP";
            a[a.DECR_WRAP = 7] = "DECR_WRAP"
        })(v || (v = {}));
        var A;
        (function(a) {
            a[a.ADD = 0] = "ADD";
            a[a.SUB = 1] = "SUB";
            a[a.REV_SUB = 2] = "REV_SUB";
            a[a.MIN = 3] = "MIN";
            a[a.MAX = 4] = "MAX"
        })(A || (A = {}));
        var B;
        (function(a) {
            a[a.ZERO = 0] = "ZERO";
            a[a.ONE = 1] = "ONE";
            a[a.SRC_ALPHA = 2] = "SRC_ALPHA";
            a[a.DST_ALPHA = 3] = "DST_ALPHA";
            a[a.ONE_MINUS_SRC_ALPHA = 4] = "ONE_MINUS_SRC_ALPHA";
            a[a.ONE_MINUS_DST_ALPHA = 5] = "ONE_MINUS_DST_ALPHA";
            a[a.SRC_COLOR = 6] = "SRC_COLOR";
            a[a.DST_COLOR = 7] = "DST_COLOR";
            a[a.ONE_MINUS_SRC_COLOR = 8] = "ONE_MINUS_SRC_COLOR";
            a[a.ONE_MINUS_DST_COLOR = 9] = "ONE_MINUS_DST_COLOR";
            a[a.SRC_ALPHA_SATURATE = 10] = "SRC_ALPHA_SATURATE";
            a[a.CONSTANT_COLOR = 11] = "CONSTANT_COLOR";
            a[a.ONE_MINUS_CONSTANT_COLOR = 12] = "ONE_MINUS_CONSTANT_COLOR";
            a[a.CONSTANT_ALPHA = 13] = "CONSTANT_ALPHA";
            a[a.ONE_MINUS_CONSTANT_ALPHA = 14] = "ONE_MINUS_CONSTANT_ALPHA"
        })(B || (B = {}));
        var E;
        (function(a) {
            a[a.NONE = 0] = "NONE";
            a[a.R = 1] = "R";
            a[a.G = 2] = "G";
            a[a.B = 4] = "B";
            a[a.A = 8] = "A";
            a[a.ALL = 15] = "ALL"
        })(E || (E = {}));
        var y;
        (function(a) {
            a[a.NONE = 0] = "NONE";
            a[a.POINT = 1] = "POINT";
            a[a.LINEAR = 2] = "LINEAR";
            a[a.ANISOTROPIC = 3] = "ANISOTROPIC"
        })(y || (y = {}));
        var z;
        (function(a) {
            a[a.WRAP = 0] = "WRAP";
            a[a.MIRROR = 1] = "MIRROR";
            a[a.CLAMP = 2] = "CLAMP";
            a[a.BORDER = 3] = "BORDER"
        })(z || (z = {}));
        var x;
        (function(a) {
            a[a.TEX1D = 0] = "TEX1D";
            a[a.TEX2D = 1] = "TEX2D";
            a[a.TEX3D = 2] = "TEX3D"
        })(x || (x = {}));
        var C;
        (function(a) {
            a[a.NONE = 0] = "NONE";
            a[a.TRANSFER_SRC = 1] = "TRANSFER_SRC";
            a[a.TRANSFER_DST = 2] = "TRANSFER_DST";
            a[a.SAMPLED = 4] = "SAMPLED";
            a[a.STORAGE = 8] = "STORAGE";
            a[a.COLOR_ATTACHMENT = 16] = "COLOR_ATTACHMENT";
            a[a.DEPTH_STENCIL_ATTACHMENT = 32] = "DEPTH_STENCIL_ATTACHMENT";
            a[a.TRANSIENT_ATTACHMENT = 64] = "TRANSIENT_ATTACHMENT";
            a[a.INPUT_ATTACHMENT = 128] = "INPUT_ATTACHMENT"
        })(C || (C = {}));
        var G;
        (function(a) {
            a[a.X1 = 0] = "X1";
            a[a.X2 = 1] = "X2";
            a[a.X4 = 2] = "X4";
            a[a.X8 = 3] = "X8";
            a[a.X16 = 4] = "X16";
            a[a.X32 = 5] = "X32";
            a[a.X64 = 6] = "X64"
        })(G || (G = {}));
        var F;
        (function(a) {
            a[a.NONE = 0] = "NONE";
            a[a.GEN_MIPMAP = 1] = "GEN_MIPMAP";
            a[a.CUBEMAP = 2] = "CUBEMAP";
            a[a.BAKUP_BUFFER = 4] = "BAKUP_BUFFER"
        })(F || (F = {}));
        var H;
        (function(a) {
            a[a.TV1D = 0] = "TV1D";
            a[a.TV2D = 1] = "TV2D";
            a[a.TV3D = 2] = "TV3D";
            a[a.CUBE = 3] = "CUBE";
            a[a.TV1D_ARRAY = 4] = "TV1D_ARRAY";
            a[a.TV2D_ARRAY = 5] = "TV2D_ARRAY"
        })(H || (H = {}));
        var I;
        (function(a) {
            a[a.VERTEX = 0] = "VERTEX";
            a[a.HULL = 1] = "HULL";
            a[a.DOMAIN = 2] = "DOMAIN";
            a[a.GEOMETRY = 3] = "GEOMETRY";
            a[a.FRAGMENT = 4] = "FRAGMENT";
            a[a.COMPUTE =
                5] = "COMPUTE";
            a[a.COUNT = 6] = "COUNT"
        })(I || (I = {}));
        var K;
        (function(a) {
            a[a.UNKNOWN = 0] = "UNKNOWN";
            a[a.UNIFORM_BUFFER = 1] = "UNIFORM_BUFFER";
            a[a.SAMPLER = 2] = "SAMPLER";
            a[a.STORAGE_BUFFER = 3] = "STORAGE_BUFFER"
        })(K || (K = {}));
        var P;
        (function(a) {
            a[a.PRIMARY = 0] = "PRIMARY";
            a[a.SECONDARY = 1] = "SECONDARY"
        })(P || (P = {}));
        var S;
        (function(a) {
            a[a.LOAD = 0] = "LOAD";
            a[a.CLEAR = 1] = "CLEAR";
            a[a.DISCARD = 2] = "DISCARD"
        })(S || (S = {}));
        var M;
        (function(a) {
            a[a.STORE = 0] = "STORE";
            a[a.DISCARD = 1] = "DISCARD"
        })(M || (M = {}));
        var O;
        (function(a) {
            a[a.UNDEFINED =
                0] = "UNDEFINED";
            a[a.GENERAL = 1] = "GENERAL";
            a[a.COLOR_ATTACHMENT_OPTIMAL = 2] = "COLOR_ATTACHMENT_OPTIMAL";
            a[a.DEPTH_STENCIL_ATTACHMENT_OPTIMAL = 3] = "DEPTH_STENCIL_ATTACHMENT_OPTIMAL";
            a[a.DEPTH_STENCIL_READONLY_OPTIMAL = 4] = "DEPTH_STENCIL_READONLY_OPTIMAL";
            a[a.SHADER_READONLY_OPTIMAL = 5] = "SHADER_READONLY_OPTIMAL";
            a[a.TRANSFER_SRC_OPTIMAL = 6] = "TRANSFER_SRC_OPTIMAL";
            a[a.TRANSFER_DST_OPTIMAL = 7] = "TRANSFER_DST_OPTIMAL";
            a[a.PREINITIALIZED = 8] = "PREINITIALIZED";
            a[a.PRESENT_SRC = 9] = "PRESENT_SRC"
        })(O || (O = {}));
        var L;
        (function(a) {
            a[a.GRAPHICS =
                0] = "GRAPHICS";
            a[a.COMPUTE = 1] = "COMPUTE";
            a[a.RAY_TRACING = 2] = "RAY_TRACING"
        })(L || (L = {}));
        var U;
        (function(a) {
            a[a.VIEWPORT = 0] = "VIEWPORT";
            a[a.SCISSOR = 1] = "SCISSOR";
            a[a.LINE_WIDTH = 2] = "LINE_WIDTH";
            a[a.DEPTH_BIAS = 3] = "DEPTH_BIAS";
            a[a.BLEND_CONSTANTS = 4] = "BLEND_CONSTANTS";
            a[a.DEPTH_BOUNDS = 5] = "DEPTH_BOUNDS";
            a[a.STENCIL_WRITE_MASK = 6] = "STENCIL_WRITE_MASK";
            a[a.STENCIL_COMPARE_MASK = 7] = "STENCIL_COMPARE_MASK"
        })(U || (U = {}));
        var V;
        (function(a) {
            a[a.FRONT = 0] = "FRONT";
            a[a.BACK = 1] = "BACK";
            a[a.ALL = 2] = "ALL"
        })(V || (V = {}));
        var Z;
        (function(a) {
            a[a.GRAPHICS =
                0] = "GRAPHICS";
            a[a.COMPUTE = 1] = "COMPUTE";
            a[a.TRANSFER = 2] = "TRANSFER"
        })(Z || (Z = {}));
        var da;
        (function(a) {
            a[a.NONE = 0] = "NONE";
            a[a.COLOR = 1] = "COLOR";
            a[a.DEPTH = 2] = "DEPTH";
            a[a.STENCIL = 4] = "STENCIL";
            a[a.DEPTH_STENCIL = 6] = "DEPTH_STENCIL";
            a[a.ALL = 7] = "ALL"
        })(da || (da = {}));
        var Q;
        (function(a) {
            a[a.DEFAULT = 100] = "DEFAULT"
        })(Q || (Q = {}));
        var R;
        (function(a) {
            a[a.MIN = 0] = "MIN";
            a[a.MAX = 255] = "MAX";
            a[a.DEFAULT = 128] = "DEFAULT"
        })(R || (R = {}));
        var fa;
        (function(a) {
            a[a.UBO_GLOBAL = 23] = "UBO_GLOBAL";
            a[a.UBO_SHADOW = 22] = "UBO_SHADOW";
            a[a.UBO_LOCAL =
                21] = "UBO_LOCAL";
            a[a.UBO_FORWARD_LIGHTS = 20] = "UBO_FORWARD_LIGHTS";
            a[a.UBO_SKINNING = 19] = "UBO_SKINNING";
            a[a.UBO_SKINNING_TEXTURE = 18] = "UBO_SKINNING_TEXTURE";
            a[a.UBO_UI = 17] = "UBO_UI";
            a[a.SAMPLER_JOINTS = 25] = "SAMPLER_JOINTS";
            a[a.SAMPLER_ENVIRONMENT = 26] = "SAMPLER_ENVIRONMENT";
            a[a.CUSTUM_UBO_BINDING_END_POINT = 17] = "CUSTUM_UBO_BINDING_END_POINT";
            a[a.CUSTOM_SAMPLER_BINDING_START_POINT = 30] = "CUSTOM_SAMPLER_BINDING_START_POINT"
        })(fa || (fa = {}));
        var ba, W, aa;
        (function(a) {
            a[a.minFilter = 0] = "minFilter";
            a[a.magFilter = 1] = "magFilter";
            a[a.mipFilter = 2] = "mipFilter";
            a[a.addressU = 3] = "addressU";
            a[a.addressV = 4] = "addressV";
            a[a.addressW = 5] = "addressW";
            a[a.maxAnisotropy = 6] = "maxAnisotropy";
            a[a.cmpFunc = 7] = "cmpFunc";
            a[a.minLOD = 8] = "minLOD";
            a[a.maxLOD = 9] = "maxLOD";
            a[a.mipLODBias = 10] = "mipLODBias";
            a[a.borderColor = 11] = "borderColor";
            a[a.total = 15] = "total"
        })(aa || (aa = {}));
        h = {};
        h[h.bool = c.BOOL] = "bool";
        h[h["int"] = c.INT] = "int";
        h[h.ivec2 = c.INT2] = "ivec2invTypeParams";
        h[h.ivec3 = c.INT3] = "ivec3";
        h[h.ivec4 = c.INT4] = "ivec4";
        h[h["float"] = c.FLOAT] = "float";
        h[h.vec2 =
            c.FLOAT2] = "vec2";
        h[h.vec3 = c.FLOAT3] = "vec3";
        h[h.vec4 = c.FLOAT4] = "vec4";
        h[h.mat2 = c.MAT2] = "mat2";
        h[h.mat3 = c.MAT3] = "mat3";
        h[h.mat4 = c.MAT4] = "mat4";
        h[h.sampler2D = c.SAMPLER2D] = "sampler2D";
        h[h.samplerCube = c.SAMPLER_CUBE] = "samplerCube";
        m = (ba = {}, ba[c.BOOL] = 4, ba[c.INT] = 4, ba[c.INT2] = 8, ba[c.INT3] = 12, ba[c.INT4] = 16, ba[c.FLOAT] = 4, ba[c.FLOAT2] = 8, ba[c.FLOAT3] = 12, ba[c.FLOAT4] = 16, ba[c.MAT2] = 16, ba[c.MAT3] = 36, ba[c.MAT4] = 64, ba[c.SAMPLER2D] = 4, ba[c.SAMPLER_CUBE] = 4, ba);
        a = (W = {}, W[c.BOOL] = a.R32I, W[c.INT] = a.R32I, W[c.INT2] = a.RG32I,
            W[c.INT3] = a.RGB32I, W[c.INT4] = a.RGBA32I, W[c.FLOAT] = a.R32F, W[c.FLOAT2] = a.RG32F, W[c.FLOAT3] = a.RGB32F, W[c.FLOAT4] = a.RGBA32F, W);
        W = {
            BACK: 1029,
            FRONT: 1028,
            NONE: 0,
            ADD: 32774,
            SUB: 32778,
            REV_SUB: 32779,
            ZERO: 0,
            ONE: 1,
            SRC_COLOR: 768,
            ONE_MINUS_SRC_COLOR: 769,
            DST_COLOR: 774,
            ONE_MINUS_DST_COLOR: 775,
            SRC_ALPHA: 770,
            ONE_MINUS_SRC_ALPHA: 771,
            DST_ALPHA: 772,
            ONE_MINUS_DST_ALPHA: 773,
            CONSTANT_COLOR: 32769,
            ONE_MINUS_CONSTANT_COLOR: 32770,
            CONSTANT_ALPHA: 32771,
            ONE_MINUS_CONSTANT_ALPHA: 32772,
            SRC_ALPHA_SATURATE: 776,
            NEVER: 512,
            LESS: 513,
            EQUAL: 514,
            LEQUAL: 515,
            GREATER: 516,
            NOTEQUAL: 517,
            GEQUAL: 518,
            ALWAYS: 519,
            KEEP: 7680,
            REPLACE: 7681,
            INCR: 7682,
            INCR_WRAP: 34055,
            DECR: 7683,
            DECR_WRAP: 34056,
            INVERT: 5386
        };
        Object.assign(W, Q);
        q.exports = {
            murmurhash2_32_gc: function(a, b) {
                var c = a.length;
                b ^= c;
                for (var d = 0, g; 4 <= c;) g = 255 & a.charCodeAt(d) | (255 & a.charCodeAt(++d)) << 8 | (255 & a.charCodeAt(++d)) << 16 | (255 & a.charCodeAt(++d)) << 24, g = 1540483477 * (65535 & g) + ((1540483477 * (g >>> 16) & 65535) << 16), g ^= g >>> 24, g = 1540483477 * (65535 & g) + ((1540483477 * (g >>> 16) & 65535) << 16), b = 1540483477 * (65535 & b) + ((1540483477 *
                    (b >>> 16) & 65535) << 16) ^ g, c -= 4, ++d;
                switch (c) {
                    case 3:
                        b ^= (255 & a.charCodeAt(d + 2)) << 16;
                    case 2:
                        b ^= (255 & a.charCodeAt(d + 1)) << 8;
                    case 1:
                        b ^= 255 & a.charCodeAt(d), b = 1540483477 * (65535 & b) + ((1540483477 * (b >>> 16) & 65535) << 16)
                }
                b ^= b >>> 13;
                b = 1540483477 * (65535 & b) + ((1540483477 * (b >>> 16) & 65535) << 16);
                return (b ^ b >>> 15) >>> 0
            },
            SamplerInfoIndex: aa,
            effectStructure: {
                $techniques: [{
                    $passes: [{
                        depthStencilState: {},
                        rasterizerState: {},
                        blendState: {
                            targets: [{}]
                        },
                        properties: {
                            any: {
                                sampler: {},
                                inspector: {}
                            }
                        }
                    }]
                }]
            },
            typeMap: h,
            sizeMap: m,
            formatMap: a,
            passParams: W,
            RenderQueue: {
                OPAQUE: 0,
                TRANSPARENT: 1,
                OVERLAY: 2
            },
            RenderPriority: R,
            GFXGetTypeSize: function(a) {
                switch (a) {
                    case c.BOOL:
                    case c.INT:
                    case c.UINT:
                    case c.FLOAT:
                        return 4;
                    case c.BOOL2:
                    case c.INT2:
                    case c.UINT2:
                    case c.FLOAT2:
                        return 8;
                    case c.BOOL3:
                    case c.INT3:
                    case c.UINT3:
                    case c.FLOAT3:
                        return 12;
                    case c.BOOL4:
                    case c.INT4:
                    case c.UINT4:
                    case c.FLOAT4:
                    case c.MAT2:
                        return 16;
                    case c.MAT2X3:
                        return 24;
                    case c.MAT2X4:
                        return 32;
                    case c.MAT3X2:
                        return 24;
                    case c.MAT3:
                        return 36;
                    case c.MAT3X4:
                        return 48;
                    case c.MAT4X2:
                    case c.MAT4X2:
                        return 32;
                    case c.MAT4:
                        return 64;
                    case c.SAMPLER1D:
                    case c.SAMPLER1D_ARRAY:
                    case c.SAMPLER2D:
                    case c.SAMPLER2D_ARRAY:
                    case c.SAMPLER3D:
                    case c.SAMPLER_CUBE:
                        return 4;
                    default:
                        return 0
                }
            },
            UniformBinding: fa
        }
    }, {}],
    323: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = h("../memop"),
            b = f(h("../enums")),
            k = h("../../core/value-types"),
            c = f(h("./program-lib")),
            a = f(h("./view")),
            d = f(h("../gfx")),
            l = new k.Mat4,
            g = new e.RecyclePool(function() {
                    return {
                        stage: null,
                        items: null
                    }
                },
                8),
            n = new e.RecyclePool(function() {
                return new Float32Array(2)
            }, 8),
            w = new e.RecyclePool(function() {
                return new Float32Array(3)
            }, 8),
            t = new e.RecyclePool(function() {
                return new Float32Array(4)
            }, 8),
            p = new e.RecyclePool(function() {
                return new Float32Array(9)
            }, 8),
            u = new e.RecyclePool(function() {
                return new Float32Array(16)
            }, 8),
            v = new e.RecyclePool(function() {
                return new Float32Array(64)
            }, 8),
            A = new e.RecyclePool(function() {
                return new Int32Array(2)
            }, 8),
            B = new e.RecyclePool(function() {
                return new Int32Array(3)
            }, 8),
            E = new e.RecyclePool(function() {
                    return new Int32Array(4)
                },
                8),
            y = new e.RecyclePool(function() {
                return new Int32Array(64)
            }, 8);
        h = function() {
            function f(d, g) {
                var l;
                this._device = d;
                this._programLib = new c["default"](d);
                this._opts = g;
                this._type2defaultValue = (l = {}, l[b["default"].PARAM_INT] = 0, l[b["default"].PARAM_INT2] = new k.Vec2(0, 0), l[b["default"].PARAM_INT3] = new k.Vec3(0, 0, 0), l[b["default"].PARAM_INT4] = new k.Vec4(0, 0, 0, 0), l[b["default"].PARAM_FLOAT] = 0, l[b["default"].PARAM_FLOAT2] = new k.Vec2(0, 0), l[b["default"].PARAM_FLOAT3] = new k.Vec3(0, 0, 0), l[b["default"].PARAM_FLOAT4] =
                    new k.Vec4(0, 0, 0, 0), l[b["default"].PARAM_COLOR4] = new k.Color(0, 0, 0, 1), l[b["default"].PARAM_MAT3] = new k.Mat3, l[b["default"].PARAM_MAT4] = new k.Mat4, l[b["default"].PARAM_TEXTURE_2D] = g.defaultTexture, l[b["default"].PARAM_TEXTURE_CUBE] = g.defaultTextureCube, l);
                this._stage2fn = {};
                this._usedTextureUnits = 0;
                this._viewPools = new e.RecyclePool(function() {
                    return new a["default"]
                }, 8);
                this._drawItemsPools = new e.RecyclePool(function() {
                    return {
                        model: null,
                        node: null,
                        ia: null,
                        effect: null,
                        defines: null,
                        uniforms: null
                    }
                }, 100);
                this._stageItemsPools = new e.RecyclePool(function() {
                    return new e.RecyclePool(function() {
                        return {
                            model: null,
                            node: null,
                            ia: null,
                            effect: null,
                            defines: null,
                            passes: [],
                            sortKey: -1,
                            uniforms: null
                        }
                    }, 100)
                }, 16)
            }
            var h = f.prototype;
            h._resetTextuerUnit = function() {
                this._usedTextureUnits = 0
            };
            h._allocTextureUnit = function() {
                var a = this._device,
                    b = this._usedTextureUnits;
                b >= a._caps.maxTextureUnits && console.warn("Trying to use " + b + " texture units while this GPU supports only " + a._caps.maxTextureUnits);
                this._usedTextureUnits +=
                    1;
                return b
            };
            h._registerStage = function(a, b) {
                this._stage2fn[a] = b
            };
            h.clear = function() {
                this._programLib.clear();
                this.reset()
            };
            h.reset = function() {
                this._viewPools.reset();
                this._stageItemsPools.reset()
            };
            h._requestView = function() {
                return this._viewPools.add()
            };
            h._render = function(a, c) {
                var d = this._device;
                d.setFrameBuffer(a._framebuffer);
                d.setViewport(a._rect.x, a._rect.y, a._rect.w, a._rect.h);
                var e = {};
                a._clearFlags & b["default"].CLEAR_COLOR && (e.color = k.Vec4.toArray([], a._color));
                a._clearFlags & b["default"].CLEAR_DEPTH &&
                    (e.depth = a._depth);
                a._clearFlags & b["default"].CLEAR_STENCIL && (e.stencil = a._stencil);
                d.clear(e);
                this._drawItemsPools.reset();
                for (d = 0; d < c._models.length; ++d)
                    if (e = c._models.data[d], 0 !== (e._cullingMask & a._cullingMask)) {
                        var l = this._drawItemsPools.add();
                        e.extractDrawItem(l)
                    }
                g.reset();
                for (c = 0; c < a._stages.length; ++c) {
                    d = a._stages[c];
                    e = this._stageItemsPools.add();
                    e.reset();
                    for (l = 0; l < this._drawItemsPools.length; ++l) {
                        var f = this._drawItemsPools.data[l],
                            h = f.effect.stagePasses[d];
                        if (h && 0 !== h.length) {
                            var n = e.add();
                            n.passes = h;
                            n.model = f.model;
                            n.node = f.node;
                            n.ia = f.ia;
                            n.effect = f.effect;
                            n.defines = f.defines;
                            n.sortKey = -1;
                            n.uniforms = f.uniforms
                        }
                    }
                    l = g.add();
                    l.stage = d;
                    l.items = e
                }
                for (c = 0; c < g.length; ++c) d = g.data[c], (0, this._stage2fn[d.stage])(a, d.items)
            };
            h._setProperty = function(a) {
                var c = this._device,
                    d = a.value;
                void 0 === d && (d = a.val);
                void 0 === d && (d = this._type2defaultValue[a.type]);
                if (void 0 === d) console.warn("Failed to set technique property " + a.name + ", value not found.");
                else if (a.type === b["default"].PARAM_TEXTURE_2D || a.type ===
                    b["default"].PARAM_TEXTURE_CUBE)
                    if (Array.isArray(d))
                        if (d.length > a.count) console.error("Failed to set property [" + a.name + "] : The length of texture array [" + d.length + "] is bigger than [" + a.count + "].");
                        else {
                            for (var g = y.add(), e = 0; e < d.length; ++e) g[e] = this._allocTextureUnit();
                            c.setTextureArray(a.name, d, g)
                        }
                else c.setTexture(a.name, d, this._allocTextureUnit());
                else a.directly ? c.setUniformDirectly(a.name, d) : c.setUniform(a.name, d)
            };
            h._draw = function(a) {
                var b = this._device,
                    c = this._programLib,
                    g = a.node,
                    e = a.ia,
                    f =
                    a.passes;
                a = a.effect;
                n.reset();
                w.reset();
                t.reset();
                p.reset();
                u.reset();
                v.reset();
                A.reset();
                B.reset();
                E.reset();
                y.reset();
                g.getWorldMatrix(l);
                b.setUniform("cc_matWorld", k.Mat4.toArray(u.add(), l));
                k.Mat4.invert(l, l);
                k.Mat4.transpose(l, l);
                b.setUniform("cc_matWorldIT", k.Mat4.toArray(u.add(), l));
                g = this._defines;
                for (var h = 0; h < f.length; ++h) {
                    var m = f[h],
                        q = e.count;
                    e._vertexBuffer && b.setVertexBuffer(0, e._vertexBuffer);
                    e._indexBuffer && b.setIndexBuffer(e._indexBuffer);
                    b.setPrimitiveType(e._primitiveType);
                    Object.setPrototypeOf(g,
                        m._defines);
                    var z = c.getProgram(m._programName, g, a.name);
                    b.setProgram(z);
                    z = z._uniforms;
                    for (var x = m._properties, C = 0; C < z.length; C++) {
                        var V = x[z[C].name];
                        void 0 !== V && this._setProperty(V)
                    }
                    b.setCullMode(m._cullMode);
                    m._blend && (b.enableBlend(), b.setBlendFuncSep(m._blendSrc, m._blendDst, m._blendSrcAlpha, m._blendDstAlpha), b.setBlendEqSep(m._blendEq, m._blendAlphaEq), b.setBlendColor32(m._blendColor));
                    m._depthTest && (b.enableDepthTest(), b.setDepthFunc(m._depthFunc));
                    m._depthWrite && b.enableDepthWrite();
                    b.setStencilTest(m._stencilTest);
                    m._stencilTest === d["default"].STENCIL_ENABLE && (b.setStencilFuncFront(m._stencilFuncFront, m._stencilRefFront, m._stencilMaskFront), b.setStencilOpFront(m._stencilFailOpFront, m._stencilZFailOpFront, m._stencilZPassOpFront, m._stencilWriteMaskFront), b.setStencilFuncBack(m._stencilFuncBack, m._stencilRefBack, m._stencilMaskBack), b.setStencilOpBack(m._stencilFailOpBack, m._stencilZFailOpBack, m._stencilZPassOpBack, m._stencilWriteMaskBack));
                    b.draw(e._start, q);
                    this._resetTextuerUnit()
                }
            };
            return f
        }();
        m["default"] =
            h;
        q.exports = m["default"]
    }, {
        "../../core/value-types": 301,
        "../enums": 329,
        "../gfx": 334,
        "../memop": 346,
        "./program-lib": 326,
        "./view": 328
    }],
    324: [function(h, q, m) {
        function f(b, c) {
            for (var a = 0; a < c.length; a++) {
                var d = c[a];
                d.enumerable = d.enumerable || !1;
                d.configurable = !0;
                "value" in d && (d.writable = !0);
                Object.defineProperty(b, d.key, d)
            }
        }

        function e(b, c, a) {
            c && f(b.prototype, c);
            a && f(b, a);
            return b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var b = function(b) {
            return b && b.__esModule ? b : {
                default: b
            }
        }(h("../gfx"));
        h = function() {
            function f(c,
                a, d) {
                void 0 === d && (d = b["default"].PT_TRIANGLES);
                this._vertexBuffer = c;
                this._indexBuffer = a;
                this._primitiveType = d;
                this._start = 0;
                this._count = -1
            }
            e(f, [{
                key: "count",
                get: function() {
                    return -1 !== this._count ? this._count : this._indexBuffer ? this._indexBuffer.count : this._vertexBuffer ? this._vertexBuffer.count : 0
                }
            }]);
            return f
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../gfx": 334
    }],
    325: [function(h, q, m) {
        function f(b) {
            return b && b.__esModule ? b : {
                default: b
            }
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = f(h("../gfx")),
            b = f(h("../enums")),
            k = f(h("../../core/value-types/value-type"));
        h = function() {
            function c(a, b, c, f, k, h) {
                void 0 === k && (k = {});
                void 0 === h && (h = {});
                this._name = a;
                this._detailName = b;
                this._programName = c;
                this._stage = f;
                this._properties = k;
                this._defines = h;
                this._cullMode = e["default"].CULL_BACK;
                this._blend = !1;
                this._blendEq = e["default"].BLEND_FUNC_ADD;
                this._blendAlphaEq = e["default"].BLEND_FUNC_ADD;
                this._blendSrc = e["default"].BLEND_SRC_ALPHA;
                this._blendDst = e["default"].BLEND_ONE_MINUS_SRC_ALPHA;
                this._blendSrcAlpha = e["default"].BLEND_SRC_ALPHA;
                this._blendDstAlpha = e["default"].BLEND_ONE_MINUS_SRC_ALPHA;
                this._blendColor = 4294967295;
                this._depthWrite = this._depthTest = !1;
                this._depthFunc = e["default"].DS_FUNC_LESS;
                this._stencilTest = e["default"].STENCIL_INHERIT;
                this._stencilFuncFront = e["default"].DS_FUNC_ALWAYS;
                this._stencilRefFront = 0;
                this._stencilMaskFront = 255;
                this._stencilFailOpFront = e["default"].STENCIL_OP_KEEP;
                this._stencilZFailOpFront = e["default"].STENCIL_OP_KEEP;
                this._stencilZPassOpFront = e["default"].STENCIL_OP_KEEP;
                this._stencilWriteMaskFront =
                    255;
                this._stencilFuncBack = e["default"].DS_FUNC_ALWAYS;
                this._stencilRefBack = 0;
                this._stencilMaskBack = 255;
                this._stencilFailOpBack = e["default"].STENCIL_OP_KEEP;
                this._stencilZFailOpBack = e["default"].STENCIL_OP_KEEP;
                this._stencilZPassOpBack = e["default"].STENCIL_OP_KEEP;
                this._stencilWriteMaskBack = 255
            }
            var a = c.prototype;
            a.setCullMode = function(a) {
                void 0 === a && (a = e["default"].CULL_BACK);
                this._cullMode = a
            };
            a.setBlend = function(a, b, c, f, k, h, p, u) {
                void 0 === a && (a = !1);
                void 0 === b && (b = e["default"].BLEND_FUNC_ADD);
                void 0 ===
                    c && (c = e["default"].BLEND_SRC_ALPHA);
                void 0 === f && (f = e["default"].BLEND_ONE_MINUS_SRC_ALPHA);
                void 0 === k && (k = e["default"].BLEND_FUNC_ADD);
                void 0 === h && (h = e["default"].BLEND_SRC_ALPHA);
                void 0 === p && (p = e["default"].BLEND_ONE_MINUS_SRC_ALPHA);
                void 0 === u && (u = 4294967295);
                this._blend = a;
                this._blendEq = b;
                this._blendSrc = c;
                this._blendDst = f;
                this._blendAlphaEq = k;
                this._blendSrcAlpha = h;
                this._blendDstAlpha = p;
                this._blendColor = u
            };
            a.setDepth = function(a, b, c) {
                void 0 === a && (a = !1);
                void 0 === b && (b = !1);
                void 0 === c && (c = e["default"].DS_FUNC_LESS);
                this._depthTest = a;
                this._depthWrite = b;
                this._depthFunc = c
            };
            a.setStencilFront = function(a, b, c, f, k, h, p, u) {
                void 0 === a && (a = e["default"].STENCIL_INHERIT);
                void 0 === b && (b = e["default"].DS_FUNC_ALWAYS);
                void 0 === c && (c = 0);
                void 0 === f && (f = 255);
                void 0 === k && (k = e["default"].STENCIL_OP_KEEP);
                void 0 === h && (h = e["default"].STENCIL_OP_KEEP);
                void 0 === p && (p = e["default"].STENCIL_OP_KEEP);
                void 0 === u && (u = 255);
                this._stencilTest = a;
                this._stencilFuncFront = b;
                this._stencilRefFront = c;
                this._stencilMaskFront = f;
                this._stencilFailOpFront =
                    k;
                this._stencilZFailOpFront = h;
                this._stencilZPassOpFront = p;
                this._stencilWriteMaskFront = u
            };
            a.setStencilEnabled = function(a) {
                void 0 === a && (a = e["default"].STENCIL_INHERIT);
                this._stencilTest = a
            };
            a.setStencilBack = function(a, b, c, f, k, h, p, u) {
                void 0 === a && (a = e["default"].STENCIL_INHERIT);
                void 0 === b && (b = e["default"].DS_FUNC_ALWAYS);
                void 0 === c && (c = 0);
                void 0 === f && (f = 255);
                void 0 === k && (k = e["default"].STENCIL_OP_KEEP);
                void 0 === h && (h = e["default"].STENCIL_OP_KEEP);
                void 0 === p && (p = e["default"].STENCIL_OP_KEEP);
                void 0 ===
                    u && (u = 255);
                this._stencilTest = a;
                this._stencilFuncBack = b;
                this._stencilRefBack = c;
                this._stencilMaskBack = f;
                this._stencilFailOpBack = k;
                this._stencilZFailOpBack = h;
                this._stencilZPassOpBack = p;
                this._stencilWriteMaskBack = u
            };
            a.setStage = function(a) {
                this._stage = a
            };
            a.setProperties = function(a) {
                this._properties = a
            };
            a.getProperty = function(a) {
                if (this._properties[a]) return this._properties[a].value
            };
            a.setProperty = function(a, c, g) {
                var d = this._properties[a];
                if (!d) return !1;
                d.directly = g;
                if (Array.isArray(c)) {
                    g = d.value;
                    if (g.length !==
                        c.length) {
                        cc.warnID(9105, this._name, a);
                        return
                    }
                    for (a = 0; a < c.length; a++) g[a] = c[a]
                } else c && !ArrayBuffer.isView(c) ? d.type === b["default"].PARAM_TEXTURE_2D ? d.value = c.getImpl() : c instanceof k["default"] ? c.constructor.toArray(d.value, c) : ("object" === typeof c && cc.warnID(9106, this._name, a), d.value = c) : d.value = c;
                return !0
            };
            a.getDefine = function(a) {
                return this._defines[a]
            };
            a.define = function(a, b, c) {
                if (!c && void 0 === this._defines[a]) return !1;
                this._defines[a] = b;
                return !0
            };
            a.clone = function() {
                var a = new c(this._programName);
                Object.assign(a, this);
                var b = {},
                    g = this._properties,
                    e;
                for (e in g) {
                    var f = g[e],
                        k = b[e] = {},
                        h = f.value;
                    Array.isArray(h) ? k.value = h.concat() : ArrayBuffer.isView(h) ? k.value = new h.__proto__.constructor(h) : k.value = h;
                    for (var u in f) "value" !== u && (k[u] = f[u])
                }
                a._properties = b;
                a._defines = Object.assign({}, this._defines);
                return a
            };
            return c
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../../core/value-types/value-type": 309,
        "../enums": 329,
        "../gfx": 334
    }],
    326: [function(h, q, m) {
        function f(a, b) {
            for (var c = [], d = 0; d < a.length; d++) {
                var e =
                    a[d].name,
                    f = b[e];
                "number" !== typeof f && (f = f ? 1 : 0);
                c.push("#define " + e + " " + f)
            }
            return c.join("\n") + "\n"
        }

        function e(a, b, c) {
            for (var d = 0; d < b.length; d++) {
                var e = b[d].name,
                    l = c[e];
                Number.isInteger(l) && (a = a.replace(new RegExp(e, "g"), l))
            }
            return a
        }

        function b(a) {
            return a.replace(/#pragma for (\w+) in range\(\s*(\d+)\s*,\s*(\d+)\s*\)([\s\S]+?)#pragma endFor/g, function(a, b, c, e, f) {
                a = "";
                c = parseInt(c);
                e = parseInt(e);
                for ((c.isNaN || e.isNaN) && console.error("Unroll For Loops Error: begin and end of range must be an int num."); c <
                    e; ++c) a += f.replace(new RegExp("{" + b + "}", "g"), c);
                return a
            })
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var k = function(a) {
                return a && a.__esModule ? a : {
                    default: a
                }
            }(h("../gfx")),
            c = 0;
        h = function() {
            function a(a) {
                this._device = a;
                this._templates = {};
                this._cache = {};
                this._checkPrecision()
            }
            var d = a.prototype;
            d.clear = function() {
                this._templates = {};
                this._cache = {}
            };
            d.define = function(a) {
                var b = a.name,
                    d = a.defines,
                    e = a.glsl1 || a,
                    l = e.vert;
                e = e.frag;
                if (!this._templates[b]) {
                    for (var f = ++c, k = 0, h = 0; h < d.length; ++h) {
                        var m = d[h],
                            B = 1;
                        "number" ===
                        m.type ? (B = m.range || [], m.min = B[0] || 0, m.max = B[1] || 4, B = Math.ceil(Math.log2(m.max - m.min)), m._map = function(a) {
                            return a - this.min << this._offset
                        }.bind(m)) : m._map = function(a) {
                            return a ? 1 << this._offset : 0
                        }.bind(m);
                        m._offset = k;
                        k += B
                    }
                    k = a.uniforms || [];
                    if (a.samplers)
                        for (h = 0; h < a.samplers.length; h++) k.push(a.samplers[h]);
                    if (a.blocks)
                        for (h = 0; h < a.blocks.length; h++) {
                            m = a.blocks[h].defines;
                            B = a.blocks[h].members;
                            for (var q = 0; q < B.length; q++) k.push({
                                defines: m,
                                name: B[q].name,
                                type: B[q].type
                            })
                        }
                    this._templates[b] = {
                        id: f,
                        name: b,
                        vert: l,
                        frag: e,
                        defines: d,
                        attributes: a.attributes,
                        uniforms: k,
                        extensions: a.extensions
                    }
                }
            };
            d.getTemplate = function(a) {
                return this._templates[a]
            };
            d.hasProgram = function(a) {
                return void 0 !== this._templates[a]
            };
            d.getKey = function(a, b) {
                a = this._templates[a];
                for (var c = 0, d = 0; d < a.defines.length; ++d) {
                    var g = a.defines[d],
                        e = b[g.name];
                    void 0 !== e && (c |= g._map(e))
                }
                return a.id + ":" + c
            };
            d.getProgram = function(a, c, d) {
                var g = this.getKey(a, c),
                    l = this._cache[g];
                if (l) return l;
                a = this._templates[a];
                l = f(a.defines, c);
                var h = e(a.vert, a.defines, c);
                h = l + b(h);
                this._highpSupported || (h = h.replace(/\bhighp\b/g, "mediump"));
                c = e(a.frag, a.defines, c);
                c = l + b(c);
                this._highpSupported || (c = c.replace(/\bhighp\b/g, "mediump"));
                l = new k["default"].Program(this._device, {
                    vert: h,
                    frag: c
                });
                var n = l.link();
                if (n) {
                    var m = h.split("\n"),
                        A = c.split("\n"),
                        B = a.defines.length;
                    n.forEach(function(a) {
                        var b = a.line - B,
                            c = ("vs" === a.type ? m : A)[a.line - 1];
                        cc.error(d + " : " + (a.info || "Failed to compile " + a.type + " " + a.fileID + " (ln " + b + "): \n " + a.message + ": \n  " + c))
                    })
                }
                return this._cache[g] = l
            };
            d._checkPrecision =
                function() {
                    var a = this._device._gl,
                        b = !1;
                    a.getShaderPrecisionFormat && (b = a.getShaderPrecisionFormat(a.VERTEX_SHADER, a.HIGH_FLOAT), a = a.getShaderPrecisionFormat(a.FRAGMENT_SHADER, a.HIGH_FLOAT), b = b && 0 < b.precision && a && 0 < a.precision);
                    b || cc.warnID(9102);
                    this._highpSupported = b
                };
            return a
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../gfx": 334
    }],
    327: [function(h, q, m) {
        function f(b, e) {
            for (var c = 0; c < e.length; c++) {
                var a = e[c];
                a.enumerable = a.enumerable || !1;
                a.configurable = !0;
                "value" in a && (a.writable = !0);
                Object.defineProperty(b,
                    a.key, a)
            }
        }

        function e(b, e, c) {
            e && f(b.prototype, e);
            c && f(b, c);
            return b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        h = function() {
            function b(b, c) {
                this._name = b;
                this._passes = c
            }
            b.prototype.clone = function() {
                for (var e = [], c = 0; c < this._passes.length; c++) e.push(this._passes[c].clone());
                return new b(this._name, e)
            };
            e(b, [{
                key: "name",
                get: function() {
                    return this._name
                }
            }, {
                key: "passes",
                get: function() {
                    return this._passes
                }
            }]);
            return b
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {}],
    328: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] =
            void 0;
        var f = h("../../core/value-types"),
            e = function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("../enums")),
            b = new f.Mat4,
            k = 0;
        h = function() {
            function c() {
                this._id = k++;
                this._priority = 0;
                this._rect = {
                    x: 0,
                    y: 0,
                    w: 1,
                    h: 1
                };
                this._color = new f.Vec4(.3, .3, .3, 1);
                this._depth = 1;
                this._stencil = 0;
                this._clearFlags = e["default"].CLEAR_COLOR | e["default"].CLEAR_DEPTH;
                this._clearModel = null;
                this._matView = cc.mat4();
                this._matViewInv = cc.mat4();
                this._matProj = cc.mat4();
                this._matViewProj = cc.mat4();
                this._matInvViewProj = cc.mat4();
                this._stages = [];
                this._cullingByID = !1;
                this._shadowLight = this._framebuffer = null;
                this._cullingMask = 4294967295
            }
            var a = c.prototype;
            a.getForward = function(a) {
                var b = this._matView.m;
                return f.Vec3.set(a, -b[2], -b[6], -b[10])
            };
            a.getPosition = function(a) {
                f.Mat4.invert(b, this._matView);
                return f.Mat4.getTranslation(a, b)
            };
            return c
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../../core/value-types": 301,
        "../enums": 329
    }],
    329: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        h = h("./build/mappings");
        m["default"] = {
            PROJ_PERSPECTIVE: 0,
            PROJ_ORTHO: 1,
            LIGHT_DIRECTIONAL: 0,
            LIGHT_POINT: 1,
            LIGHT_SPOT: 2,
            LIGHT_AMBIENT: 3,
            SHADOW_NONE: 0,
            SHADOW_HARD: 1,
            SHADOW_SOFT: 2,
            PARAM_INT: h.typeMap["int"],
            PARAM_INT2: h.typeMap.ivec2,
            PARAM_INT3: h.typeMap.ivec3,
            PARAM_INT4: h.typeMap.ivec4,
            PARAM_FLOAT: h.typeMap["float"],
            PARAM_FLOAT2: h.typeMap.vec2,
            PARAM_FLOAT3: h.typeMap.vec3,
            PARAM_FLOAT4: h.typeMap.vec4,
            PARAM_MAT2: h.typeMap.mat2,
            PARAM_MAT3: h.typeMap.mat3,
            PARAM_MAT4: h.typeMap.mat4,
            PARAM_TEXTURE_2D: h.typeMap.sampler2D,
            PARAM_TEXTURE_CUBE: h.typeMap.samplerCube,
            CLEAR_COLOR: 1,
            CLEAR_DEPTH: 2,
            CLEAR_STENCIL: 4,
            CLEAR_SKYBOX: 8,
            BUFFER_VIEW_INT8: 0,
            BUFFER_VIEW_UINT8: 1,
            BUFFER_VIEW_INT16: 2,
            BUFFER_VIEW_UINT16: 3,
            BUFFER_VIEW_INT32: 4,
            BUFFER_VIEW_UINT32: 5,
            BUFFER_VIEW_FLOAT32: 6
        };
        q.exports = m["default"]
    }, {
        "./build/mappings": 322
    }],
    330: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, b) {
            for (var c = 0; c < b.length; c++) {
                var d = b[c];
                d.enumerable = d.enumerable || !1;
                d.configurable = !0;
                "value" in d && (d.writable = !0);
                Object.defineProperty(a, d.key, d)
            }
        }

        function b(a, b, c) {
            b && e(a.prototype,
                b);
            c && e(a, c);
            return a
        }

        function k(a, b, c, e) {
            void 0 === e && (e = 0);
            c instanceof d["default"] ? a.framebufferTexture2D(a.FRAMEBUFFER, b, a.TEXTURE_2D, c._glID, 0) : c instanceof l["default"] ? a.framebufferTexture2D(a.FRAMEBUFFER, b, a.TEXTURE_CUBE_MAP_POSITIVE_X + e, c._glID, 0) : a.framebufferRenderbuffer(a.FRAMEBUFFER, b, a.RENDERBUFFER, c._glID)
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var c = f(h("./state")),
            a = h("./enums"),
            d = f(h("./texture-2d")),
            l = f(h("./texture-cube")),
            g, n, w = (g = {}, g[5124] = function(a, b, c) {
                    a.uniform1i(b, c)
                }, g[5126] =
                function(a, b, c) {
                    a.uniform1f(b, c)
                }, g[35664] = function(a, b, c) {
                    a.uniform2fv(b, c)
                }, g[35665] = function(a, b, c) {
                    a.uniform3fv(b, c)
                }, g[35666] = function(a, b, c) {
                    a.uniform4fv(b, c)
                }, g[35667] = function(a, b, c) {
                    a.uniform2iv(b, c)
                }, g[35668] = function(a, b, c) {
                    a.uniform3iv(b, c)
                }, g[35669] = function(a, b, c) {
                    a.uniform4iv(b, c)
                }, g[35670] = function(a, b, c) {
                    a.uniform1i(b, c)
                }, g[35671] = function(a, b, c) {
                    a.uniform2iv(b, c)
                }, g[35672] = function(a, b, c) {
                    a.uniform3iv(b, c)
                }, g[35673] = function(a, b, c) {
                    a.uniform4iv(b, c)
                }, g[35674] = function(a, b, c) {
                    a.uniformMatrix2fv(b, !1, c)
                }, g[35675] = function(a, b, c) {
                    a.uniformMatrix3fv(b, !1, c)
                }, g[35676] = function(a, b, c) {
                    a.uniformMatrix4fv(b, !1, c)
                }, g[35678] = function(a, b, c) {
                    a.uniform1i(b, c)
                }, g[35680] = function(a, b, c) {
                    a.uniform1i(b, c)
                }, g),
            t = (n = {}, n[5124] = function(a, b, c) {
                a.uniform1iv(b, c)
            }, n[5126] = function(a, b, c) {
                a.uniform1fv(b, c)
            }, n[35664] = function(a, b, c) {
                a.uniform2fv(b, c)
            }, n[35665] = function(a, b, c) {
                a.uniform3fv(b, c)
            }, n[35666] = function(a, b, c) {
                a.uniform4fv(b, c)
            }, n[35667] = function(a, b, c) {
                a.uniform2iv(b, c)
            }, n[35668] = function(a, b, c) {
                a.uniform3iv(b,
                    c)
            }, n[35669] = function(a, b, c) {
                a.uniform4iv(b, c)
            }, n[35670] = function(a, b, c) {
                a.uniform1iv(b, c)
            }, n[35671] = function(a, b, c) {
                a.uniform2iv(b, c)
            }, n[35672] = function(a, b, c) {
                a.uniform3iv(b, c)
            }, n[35673] = function(a, b, c) {
                a.uniform4iv(b, c)
            }, n[35674] = function(a, b, c) {
                a.uniformMatrix2fv(b, !1, c)
            }, n[35675] = function(a, b, c) {
                a.uniformMatrix3fv(b, !1, c)
            }, n[35676] = function(a, b, c) {
                a.uniformMatrix4fv(b, !1, c)
            }, n[35678] = function(a, b, c) {
                a.uniform1iv(b, c)
            }, n[35680] = function(a, b, c) {
                a.uniform1iv(b, c)
            }, n);
        h = function() {
            function d(a, b) {
                b =
                    b || {};
                void 0 === b.alpha && (b.alpha = !1);
                void 0 === b.stencil && (b.stencil = !0);
                void 0 === b.depth && (b.depth = !0);
                void 0 === b.antialias && (b.antialias = !1);
                void 0 === b.preserveDrawingBuffer && (b.preserveDrawingBuffer = !1);
                try {
                    var d = a.getContext("webgl", b) || a.getContext("experimental-webgl", b) || a.getContext("webkit-3d", b) || a.getContext("moz-webgl", b)
                } catch (E) {
                    console.error(E);
                    return
                }
                d || console.error("This device does not support webgl");
                this._gl = d;
                this._extensions = {};
                this._caps = {};
                this._stats = {
                    texture: 0,
                    vb: 0,
                    ib: 0,
                    drawcalls: 0
                };
                this._initExtensions("EXT_texture_filter_anisotropic EXT_shader_texture_lod OES_standard_derivatives OES_texture_float OES_texture_float_linear OES_texture_half_float OES_texture_half_float_linear OES_vertex_array_object WEBGL_compressed_texture_atc WEBGL_compressed_texture_etc WEBGL_compressed_texture_etc1 WEBGL_compressed_texture_pvrtc WEBGL_compressed_texture_s3tc WEBGL_depth_texture WEBGL_draw_buffers".split(" "));
                this._initCaps();
                this._initStates();
                c["default"].initDefault(this);
                this._current = new c["default"](this);
                this._next = new c["default"](this);
                this._uniforms = {};
                this._sx = this._sy = this._sw = this._sh = this._vx = this._vy = this._vw = this._vh = 0;
                this._framebuffer = null;
                this._enabledAttributes = Array(this._caps.maxVertexAttribs);
                this._newAttributes = Array(this._caps.maxVertexAttribs);
                for (a = 0; a < this._caps.maxVertexAttribs; ++a) this._enabledAttributes[a] = 0, this._newAttributes[a] = 0
            }
            b(d, [{
                key: "caps",
                get: function() {
                    return this._caps
                }
            }]);
            var e = d.prototype;
            e._initExtensions = function(a) {
                for (var b =
                        this._gl, c = 0; c < a.length; ++c)
                    for (var d = a[c], e = ["", "WEBKIT_", "MOZ_"], g = 0; g < e.length; g++) try {
                        var l = b.getExtension(e[g] + d);
                        if (l) {
                            this._extensions[d] = l;
                            break
                        }
                    } catch (C) {
                        console.error(C)
                    }
            };
            e._initCaps = function() {
                var a = this._gl,
                    b = this.ext("WEBGL_draw_buffers");
                this._caps.maxVertexStreams = 4;
                this._caps.maxVertexTextures = a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS);
                this._caps.maxFragUniforms = a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS);
                this._caps.maxTextureUnits = a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);
                this._caps.maxVertexAttribs = a.getParameter(a.MAX_VERTEX_ATTRIBS);
                this._caps.maxTextureSize = a.getParameter(a.MAX_TEXTURE_SIZE);
                this._caps.maxDrawBuffers = b ? a.getParameter(b.MAX_DRAW_BUFFERS_WEBGL) : 1;
                this._caps.maxColorAttachments = b ? a.getParameter(b.MAX_COLOR_ATTACHMENTS_WEBGL) : 1
            };
            e._initStates = function() {
                var a = this._gl;
                a.disable(a.BLEND);
                a.blendFunc(a.ONE, a.ZERO);
                a.blendEquation(a.FUNC_ADD);
                a.blendColor(1, 1, 1, 1);
                a.colorMask(!0, !0, !0, !0);
                a.enable(a.CULL_FACE);
                a.cullFace(a.BACK);
                a.disable(a.DEPTH_TEST);
                a.depthFunc(a.LESS);
                a.depthMask(!1);
                a.disable(a.POLYGON_OFFSET_FILL);
                a.depthRange(0, 1);
                a.disable(a.STENCIL_TEST);
                a.stencilFunc(a.ALWAYS, 0, 255);
                a.stencilMask(255);
                a.stencilOp(a.KEEP, a.KEEP, a.KEEP);
                a.clearDepth(1);
                a.clearColor(0, 0, 0, 0);
                a.clearStencil(0);
                a.disable(a.SCISSOR_TEST)
            };
            e._restoreTexture = function(a) {
                var b = this._gl;
                (a = this._current.textureUnits[a]) && -1 !== a._glID ? b.bindTexture(a._target, a._glID) : b.bindTexture(b.TEXTURE_2D, null)
            };
            e._restoreIndexBuffer = function() {
                var a = this._gl,
                    b = this._current.indexBuffer;
                b && -1 !== b._glID ? a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, b._glID) : a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, null)
            };
            e.ext = function(a) {
                return this._extensions[a]
            };
            e.allowFloatTexture = function() {
                return null != this.ext("OES_texture_float")
            };
            e.setFrameBuffer = function(a) {
                if (this._framebuffer !== a) {
                    this._framebuffer = a;
                    var b = this._gl;
                    if (a) {
                        b.bindFramebuffer(b.FRAMEBUFFER, a._glID);
                        for (var c = a._colors.length, d = 0; d < c; ++d) k(b, b.COLOR_ATTACHMENT0 + d, a._colors[d]);
                        for (; c < this._caps.maxColorAttachments; ++c) b.framebufferTexture2D(b.FRAMEBUFFER,
                            b.COLOR_ATTACHMENT0 + c, b.TEXTURE_2D, null, 0);
                        a._depth && k(b, b.DEPTH_ATTACHMENT, a._depth);
                        a._stencil && k(b, b.STENCIL_ATTACHMENT, a._stencil);
                        a._depthStencil && k(b, b.DEPTH_STENCIL_ATTACHMENT, a._depthStencil)
                    } else b.bindFramebuffer(b.FRAMEBUFFER, null)
                }
            };
            e.setViewport = function(a, b, c, d) {
                if (this._vx !== a || this._vy !== b || this._vw !== c || this._vh !== d) this._gl.viewport(a, b, c, d), this._vx = a, this._vy = b, this._vw = c, this._vh = d
            };
            e.setScissor = function(a, b, c, d) {
                if (this._sx !== a || this._sy !== b || this._sw !== c || this._sh !== d) this._gl.scissor(a,
                    b, c, d), this._sx = a, this._sy = b, this._sw = c, this._sh = d
            };
            e.clear = function(b) {
                if (void 0 !== b.color || void 0 !== b.depth || void 0 !== b.stencil) {
                    var c = this._gl,
                        d = 0;
                    void 0 !== b.color && (d |= c.COLOR_BUFFER_BIT, c.clearColor(b.color[0], b.color[1], b.color[2], b.color[3]));
                    void 0 !== b.depth && (d |= c.DEPTH_BUFFER_BIT, c.clearDepth(b.depth), c.enable(c.DEPTH_TEST), c.depthMask(!0), c.depthFunc(c.ALWAYS));
                    void 0 !== b.stencil && (d |= c.STENCIL_BUFFER_BIT, c.clearStencil(b.stencil));
                    c.clear(d);
                    void 0 !== b.depth && (!1 === this._current.depthTest ?
                        c.disable(c.DEPTH_TEST) : (!1 === this._current.depthWrite && c.depthMask(!1), this._current.depthFunc !== a.enums.DS_FUNC_ALWAYS && c.depthFunc(this._current.depthFunc)))
                }
            };
            e.enableBlend = function() {
                this._next.blend = !0
            };
            e.enableDepthTest = function() {
                this._next.depthTest = !0
            };
            e.enableDepthWrite = function() {
                this._next.depthWrite = !0
            };
            e.setStencilTest = function(a) {
                this._next.stencilTest = a
            };
            e.setStencilFunc = function(a, b, c) {
                this._next.stencilSep = !1;
                this._next.stencilFuncFront = this._next.stencilFuncBack = a;
                this._next.stencilRefFront =
                    this._next.stencilRefBack = b;
                this._next.stencilMaskFront = this._next.stencilMaskBack = c
            };
            e.setStencilFuncFront = function(a, b, c) {
                this._next.stencilSep = !0;
                this._next.stencilFuncFront = a;
                this._next.stencilRefFront = b;
                this._next.stencilMaskFront = c
            };
            e.setStencilFuncBack = function(a, b, c) {
                this._next.stencilSep = !0;
                this._next.stencilFuncBack = a;
                this._next.stencilRefBack = b;
                this._next.stencilMaskBack = c
            };
            e.setStencilOp = function(a, b, c, d) {
                this._next.stencilFailOpFront = this._next.stencilFailOpBack = a;
                this._next.stencilZFailOpFront =
                    this._next.stencilZFailOpBack = b;
                this._next.stencilZPassOpFront = this._next.stencilZPassOpBack = c;
                this._next.stencilWriteMaskFront = this._next.stencilWriteMaskBack = d
            };
            e.setStencilOpFront = function(a, b, c, d) {
                this._next.stencilSep = !0;
                this._next.stencilFailOpFront = a;
                this._next.stencilZFailOpFront = b;
                this._next.stencilZPassOpFront = c;
                this._next.stencilWriteMaskFront = d
            };
            e.setStencilOpBack = function(a, b, c, d) {
                this._next.stencilSep = !0;
                this._next.stencilFailOpBack = a;
                this._next.stencilZFailOpBack = b;
                this._next.stencilZPassOpBack =
                    c;
                this._next.stencilWriteMaskBack = d
            };
            e.setDepthFunc = function(a) {
                this._next.depthFunc = a
            };
            e.setBlendColor32 = function(a) {
                this._next.blendColor = a
            };
            e.setBlendColor = function(a, b, c, d) {
                this._next.blendColor = (255 * a << 24 | 255 * b << 16 | 255 * c << 8 | 255 * d) >>> 0
            };
            e.setBlendFunc = function(a, b) {
                this._next.blendSep = !1;
                this._next.blendSrc = a;
                this._next.blendDst = b
            };
            e.setBlendFuncSep = function(a, b, c, d) {
                this._next.blendSep = !0;
                this._next.blendSrc = a;
                this._next.blendDst = b;
                this._next.blendSrcAlpha = c;
                this._next.blendDstAlpha = d
            };
            e.setBlendEq =
                function(a) {
                    this._next.blendSep = !1;
                    this._next.blendEq = a
                };
            e.setBlendEqSep = function(a, b) {
                this._next.blendSep = !0;
                this._next.blendEq = a;
                this._next.blendAlphaEq = b
            };
            e.setCullMode = function(a) {
                this._next.cullMode = a
            };
            e.setVertexBuffer = function(a, b, c) {
                void 0 === c && (c = 0);
                this._next.vertexBuffers[a] = b;
                this._next.vertexBufferOffsets[a] = c;
                this._next.maxStream < a && (this._next.maxStream = a)
            };
            e.setIndexBuffer = function(a) {
                this._next.indexBuffer = a
            };
            e.setProgram = function(a) {
                this._next.program = a
            };
            e.setTexture = function(a,
                b, c) {
                c >= this._caps.maxTextureUnits ? console.warn("Can not set texture " + a + " at stage " + c + ", max texture exceed: " + this._caps.maxTextureUnits) : (this._next.textureUnits[c] = b, this.setUniform(a, c), this._next.maxTextureSlot < c && (this._next.maxTextureSlot = c))
            };
            e.setTextureArray = function(a, b, c) {
                var d = b.length;
                if (d >= this._caps.maxTextureUnits) console.warn("Can not set " + d + " textures for " + a + ", max texture exceed: " + this._caps.maxTextureUnits);
                else {
                    for (var e = 0; e < d; ++e) {
                        var g = c[e];
                        this._next.textureUnits[g] =
                            b[e];
                        this._next.maxTextureSlot < g && (this._next.maxTextureSlot = g)
                    }
                    this.setUniform(a, c)
                }
            };
            e.setUniform = function(a, b) {
                var c = this._uniforms[a],
                    d = !1,
                    e = !1,
                    g = !1,
                    l = !1;
                c && (g = Array.isArray(b) || b instanceof Float32Array, l = b instanceof Int32Array, e = g || l, c.isArray === e && (c.isArray && c.value.length !== b.length || (d = !0)));
                if (d) {
                    e = c.value;
                    g = !1;
                    if (c.isArray)
                        for (l = 0, d = e.length; l < d; l++) e[l] !== b[l] && (g = !0, e[l] = b[l]);
                    else e !== b && (g = !0, c.value = b);
                    g && (c.dirty = !0)
                } else c = b, g ? c = new Float32Array(b) : l && (c = new Int32Array(b)), c = {
                    dirty: !0,
                    value: c,
                    isArray: e
                };
                this._uniforms[a] = c
            };
            e.setUniformDirectly = function(a, b) {
                var c = this._uniforms[a];
                c || (this._uniforms[a] = c = {});
                c.dirty = !0;
                c.value = b
            };
            e.setPrimitiveType = function(a) {
                this._next.primitiveType = a
            };
            e.resetDrawCalls = function() {
                this._stats.drawcalls = 0
            };
            e.getDrawCalls = function() {
                return this._stats.drawcalls
            };
            e.draw = function(b, c) {
                var d = this._gl,
                    e = this._current,
                    g = this._next;
                e.blend !== g.blend ? g.blend ? (d.enable(d.BLEND), g.blendSrc !== a.enums.BLEND_CONSTANT_COLOR && g.blendSrc !== a.enums.BLEND_ONE_MINUS_CONSTANT_COLOR &&
                    g.blendDst !== a.enums.BLEND_CONSTANT_COLOR && g.blendDst !== a.enums.BLEND_ONE_MINUS_CONSTANT_COLOR || d.blendColor((g.blendColor >> 24) / 255, (g.blendColor >> 16 & 255) / 255, (g.blendColor >> 8 & 255) / 255, (255 & g.blendColor) / 255), g.blendSep ? (d.blendFuncSeparate(g.blendSrc, g.blendDst, g.blendSrcAlpha, g.blendDstAlpha), d.blendEquationSeparate(g.blendEq, g.blendAlphaEq)) : (d.blendFunc(g.blendSrc, g.blendDst), d.blendEquation(g.blendEq))) : d.disable(d.BLEND) : !1 !== g.blend && (e.blendColor !== g.blendColor && d.blendColor((g.blendColor >>
                    24) / 255, (g.blendColor >> 16 & 255) / 255, (g.blendColor >> 8 & 255) / 255, (255 & g.blendColor) / 255), e.blendSep !== g.blendSep ? g.blendSep ? (d.blendFuncSeparate(g.blendSrc, g.blendDst, g.blendSrcAlpha, g.blendDstAlpha), d.blendEquationSeparate(g.blendEq, g.blendAlphaEq)) : (d.blendFunc(g.blendSrc, g.blendDst), d.blendEquation(g.blendEq)) : g.blendSep ? (e.blendSrc === g.blendSrc && e.blendDst === g.blendDst && e.blendSrcAlpha === g.blendSrcAlpha && e.blendDstAlpha === g.blendDstAlpha || d.blendFuncSeparate(g.blendSrc, g.blendDst, g.blendSrcAlpha,
                    g.blendDstAlpha), e.blendEq === g.blendEq && e.blendAlphaEq === g.blendAlphaEq || d.blendEquationSeparate(g.blendEq, g.blendAlphaEq)) : (e.blendSrc === g.blendSrc && e.blendDst === g.blendDst || d.blendFunc(g.blendSrc, g.blendDst), e.blendEq !== g.blendEq && d.blendEquation(g.blendEq)));
                e.depthTest !== g.depthTest ? g.depthTest ? (d.enable(d.DEPTH_TEST), d.depthFunc(g.depthFunc), d.depthMask(g.depthWrite)) : d.disable(d.DEPTH_TEST) : (e.depthWrite !== g.depthWrite && d.depthMask(g.depthWrite), !1 === g.depthTest ? g.depthWrite && (g.depthTest = !0,
                    g.depthFunc = a.enums.DS_FUNC_ALWAYS, d.enable(d.DEPTH_TEST), d.depthFunc(g.depthFunc)) : e.depthFunc !== g.depthFunc && d.depthFunc(g.depthFunc));
                g.stencilTest !== a.enums.STENCIL_INHERIT && (g.stencilTest !== e.stencilTest ? g.stencilTest === a.enums.STENCIL_DISABLE ? d.disable(d.STENCIL_TEST) : (d.enable(d.STENCIL_TEST), g.stencilSep ? (d.stencilFuncSeparate(d.FRONT, g.stencilFuncFront, g.stencilRefFront, g.stencilMaskFront), d.stencilMaskSeparate(d.FRONT, g.stencilWriteMaskFront), d.stencilOpSeparate(d.FRONT, g.stencilFailOpFront,
                        g.stencilZFailOpFront, g.stencilZPassOpFront), d.stencilFuncSeparate(d.BACK, g.stencilFuncBack, g.stencilRefBack, g.stencilMaskBack), d.stencilMaskSeparate(d.BACK, g.stencilWriteMaskBack), d.stencilOpSeparate(d.BACK, g.stencilFailOpBack, g.stencilZFailOpBack, g.stencilZPassOpBack)) : (d.stencilFunc(g.stencilFuncFront, g.stencilRefFront, g.stencilMaskFront), d.stencilMask(g.stencilWriteMaskFront), d.stencilOp(g.stencilFailOpFront, g.stencilZFailOpFront, g.stencilZPassOpFront))) : g.stencilTest !== a.enums.STENCIL_DISABLE &&
                    (e.stencilSep !== g.stencilSep ? g.stencilSep ? (d.stencilFuncSeparate(d.FRONT, g.stencilFuncFront, g.stencilRefFront, g.stencilMaskFront), d.stencilMaskSeparate(d.FRONT, g.stencilWriteMaskFront), d.stencilOpSeparate(d.FRONT, g.stencilFailOpFront, g.stencilZFailOpFront, g.stencilZPassOpFront), d.stencilFuncSeparate(d.BACK, g.stencilFuncBack, g.stencilRefBack, g.stencilMaskBack), d.stencilMaskSeparate(d.BACK, g.stencilWriteMaskBack), d.stencilOpSeparate(d.BACK, g.stencilFailOpBack, g.stencilZFailOpBack, g.stencilZPassOpBack)) :
                        (d.stencilFunc(g.stencilFuncFront, g.stencilRefFront, g.stencilMaskFront), d.stencilMask(g.stencilWriteMaskFront), d.stencilOp(g.stencilFailOpFront, g.stencilZFailOpFront, g.stencilZPassOpFront)) : g.stencilSep ? (e.stencilFuncFront === g.stencilFuncFront && e.stencilRefFront === g.stencilRefFront && e.stencilMaskFront === g.stencilMaskFront || d.stencilFuncSeparate(d.FRONT, g.stencilFuncFront, g.stencilRefFront, g.stencilMaskFront), e.stencilWriteMaskFront !== g.stencilWriteMaskFront && d.stencilMaskSeparate(d.FRONT, g.stencilWriteMaskFront),
                            e.stencilFailOpFront === g.stencilFailOpFront && e.stencilZFailOpFront === g.stencilZFailOpFront && e.stencilZPassOpFront === g.stencilZPassOpFront || d.stencilOpSeparate(d.FRONT, g.stencilFailOpFront, g.stencilZFailOpFront, g.stencilZPassOpFront), e.stencilFuncBack === g.stencilFuncBack && e.stencilRefBack === g.stencilRefBack && e.stencilMaskBack === g.stencilMaskBack || d.stencilFuncSeparate(d.BACK, g.stencilFuncBack, g.stencilRefBack, g.stencilMaskBack), e.stencilWriteMaskBack !== g.stencilWriteMaskBack && d.stencilMaskSeparate(d.BACK,
                                g.stencilWriteMaskBack), e.stencilFailOpBack === g.stencilFailOpBack && e.stencilZFailOpBack === g.stencilZFailOpBack && e.stencilZPassOpBack === g.stencilZPassOpBack || d.stencilOpSeparate(d.BACK, g.stencilFailOpBack, g.stencilZFailOpBack, g.stencilZPassOpBack)) : (e.stencilFuncFront === g.stencilFuncFront && e.stencilRefFront === g.stencilRefFront && e.stencilMaskFront === g.stencilMaskFront || d.stencilFunc(g.stencilFuncFront, g.stencilRefFront, g.stencilMaskFront), e.stencilWriteMaskFront !== g.stencilWriteMaskFront && d.stencilMask(g.stencilWriteMaskFront),
                            e.stencilFailOpFront === g.stencilFailOpFront && e.stencilZFailOpFront === g.stencilZFailOpFront && e.stencilZPassOpFront === g.stencilZPassOpFront || d.stencilOp(g.stencilFailOpFront, g.stencilZFailOpFront, g.stencilZPassOpFront))));
                e.cullMode !== g.cullMode && (g.cullMode === a.enums.CULL_NONE ? d.disable(d.CULL_FACE) : (d.enable(d.CULL_FACE), d.cullFace(g.cullMode)));
                var l = !1;
                if (-1 !== g.maxStream) {
                    if (e.maxStream !== g.maxStream) l = !0;
                    else if (e.program !== g.program) l = !0;
                    else
                        for (var f = 0; f < g.maxStream + 1; ++f)
                            if (e.vertexBuffers[f] !==
                                g.vertexBuffers[f] || e.vertexBufferOffsets[f] !== g.vertexBufferOffsets[f]) {
                                l = !0;
                                break
                            } if (l) {
                        for (l = 0; l < this._caps.maxVertexAttribs; ++l) this._newAttributes[l] = 0;
                        for (l = 0; l < g.maxStream + 1; ++l) {
                            f = g.vertexBuffers[l];
                            var k = g.vertexBufferOffsets[l];
                            if (f && -1 !== f._glID) {
                                d.bindBuffer(d.ARRAY_BUFFER, f._glID);
                                for (var h = 0; h < g.program._attributes.length; ++h) {
                                    var n = g.program._attributes[h],
                                        p = f._format.element(n.name);
                                    p ? (0 === this._enabledAttributes[n.location] && (d.enableVertexAttribArray(n.location), this._enabledAttributes[n.location] =
                                        1), this._newAttributes[n.location] = 1, d.vertexAttribPointer(n.location, p.num, p.type, p.normalize, p.stride, p.offset + k * p.stride)) : console.warn("Can not find vertex attribute: " + n.name)
                                }
                            }
                        }
                        for (l = 0; l < this._caps.maxVertexAttribs; ++l) this._enabledAttributes[l] !== this._newAttributes[l] && (d.disableVertexAttribArray(l), this._enabledAttributes[l] = 0)
                    }
                }
                e.indexBuffer !== g.indexBuffer && d.bindBuffer(d.ELEMENT_ARRAY_BUFFER, g.indexBuffer && -1 !== g.indexBuffer._glID ? g.indexBuffer._glID : null);
                l = !1;
                e.program !== g.program &&
                    (g.program._linked ? d.useProgram(g.program._glID) : console.warn("Failed to use program: has not linked yet."), l = !0);
                for (f = 0; f < g.maxTextureSlot + 1; ++f) e.textureUnits[f] !== g.textureUnits[f] && (k = g.textureUnits[f]) && -1 !== k._glID && (d.activeTexture(d.TEXTURE0 + f), d.bindTexture(k._target, k._glID));
                for (f = 0; f < g.program._uniforms.length; ++f) k = g.program._uniforms[f], (h = this._uniforms[k.name]) && (l || h.dirty) && (h.dirty = !1, (n = void 0 === k.size ? w[k.type] : t[k.type]) ? n(d, k.location, h.value) : console.warn("Can not find commit function for uniform " +
                    k.name));
                c && (g.indexBuffer ? d.drawElements(this._next.primitiveType, c, g.indexBuffer._format, b * g.indexBuffer._bytesPerIndex) : d.drawArrays(this._next.primitiveType, b, c), this._stats.drawcalls++);
                e.set(g);
                g.reset()
            };
            return d
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "./enums": 331,
        "./state": 338,
        "./texture-2d": 339,
        "./texture-cube": 340
    }],
    331: [function(h, q, m) {
        m.__esModule = !0;
        m.attrTypeBytes = function(e) {
            if (e === b.ATTR_TYPE_INT8 || e === b.ATTR_TYPE_UINT8) return 1;
            if (e === b.ATTR_TYPE_INT16 || e === b.ATTR_TYPE_UINT16) return 2;
            if (e === b.ATTR_TYPE_INT32 || e === b.ATTR_TYPE_UINT32 || e === b.ATTR_TYPE_FLOAT32) return 4;
            console.warn("Unknown ATTR_TYPE: " + e);
            return 0
        };
        m.glFilter = function(b, c, a) {
            void 0 === a && (a = -1);
            var d = f[c][a + 1];
            return void 0 === d ? (console.warn("Unknown FILTER: " + c), -1 === a ? b.LINEAR : b.LINEAR_MIPMAP_LINEAR) : d
        };
        m.glTextureFmt = function(f) {
            var c = e[f];
            return void 0 === c ? (console.warn("Unknown TEXTURE_FMT: " + f), e[b.TEXTURE_FMT_RGBA8]) : c
        };
        m.enums = void 0;
        var f = [
                [9728, 9984, 9986],
                [9729, 9985, 9987]
            ],
            e = [{
                    format: 6407,
                    internalFormat: 33776,
                    pixelType: null
                }, {
                    format: 6408,
                    internalFormat: 33777,
                    pixelType: null
                }, {
                    format: 6408,
                    internalFormat: 33778,
                    pixelType: null
                }, {
                    format: 6408,
                    internalFormat: 33779,
                    pixelType: null
                }, {
                    format: 6407,
                    internalFormat: 36196,
                    pixelType: null
                }, {
                    format: 6407,
                    internalFormat: 35841,
                    pixelType: null
                }, {
                    format: 6408,
                    internalFormat: 35843,
                    pixelType: null
                }, {
                    format: 6407,
                    internalFormat: 35840,
                    pixelType: null
                }, {
                    format: 6408,
                    internalFormat: 35842,
                    pixelType: null
                }, {
                    format: 6406,
                    internalFormat: 6406,
                    pixelType: 5121
                }, {
                    format: 6409,
                    internalFormat: 6409,
                    pixelType: 5121
                },
                {
                    format: 6410,
                    internalFormat: 6410,
                    pixelType: 5121
                }, {
                    format: 6407,
                    internalFormat: 6407,
                    pixelType: 33635
                }, {
                    format: 6408,
                    internalFormat: 6408,
                    pixelType: 32820
                }, {
                    format: 6408,
                    internalFormat: 6408,
                    pixelType: 32819
                }, {
                    format: 6407,
                    internalFormat: 6407,
                    pixelType: 5121
                }, {
                    format: 6408,
                    internalFormat: 6408,
                    pixelType: 5121
                }, {
                    format: 6407,
                    internalFormat: 6407,
                    pixelType: 36193
                }, {
                    format: 6408,
                    internalFormat: 6408,
                    pixelType: 36193
                }, {
                    format: 6407,
                    internalFormat: 6407,
                    pixelType: 5126
                }, {
                    format: 6408,
                    internalFormat: 6408,
                    pixelType: 5126
                }, {
                    format: null,
                    internalFormat: null,
                    pixelType: null
                }, {
                    format: null,
                    internalFormat: null,
                    pixelType: null
                }, {
                    format: null,
                    internalFormat: null,
                    pixelType: null
                }, {
                    format: null,
                    internalFormat: null,
                    pixelType: null
                }, {
                    format: 6402,
                    internalFormat: 6402,
                    pixelType: 5123
                }, {
                    format: 6402,
                    internalFormat: 6402,
                    pixelType: 5125
                }, {
                    format: 6402,
                    internalFormat: 6402,
                    pixelType: 5125
                }, {
                    format: 6407,
                    internalFormat: 37492,
                    pixelType: null
                }, {
                    format: 6408,
                    internalFormat: 37496,
                    pixelType: null
                }
            ],
            b = {
                USAGE_STATIC: 35044,
                USAGE_DYNAMIC: 35048,
                USAGE_STREAM: 35040,
                INDEX_FMT_UINT8: 5121,
                INDEX_FMT_UINT16: 5123,
                INDEX_FMT_UINT32: 5125,
                ATTR_POSITION: "a_position",
                ATTR_NORMAL: "a_normal",
                ATTR_TANGENT: "a_tangent",
                ATTR_BITANGENT: "a_bitangent",
                ATTR_WEIGHTS: "a_weights",
                ATTR_JOINTS: "a_joints",
                ATTR_COLOR: "a_color",
                ATTR_COLOR0: "a_color0",
                ATTR_COLOR1: "a_color1",
                ATTR_UV: "a_uv",
                ATTR_UV0: "a_uv0",
                ATTR_UV1: "a_uv1",
                ATTR_UV2: "a_uv2",
                ATTR_UV3: "a_uv3",
                ATTR_UV4: "a_uv4",
                ATTR_UV5: "a_uv5",
                ATTR_UV6: "a_uv6",
                ATTR_UV7: "a_uv7",
                ATTR_TEX_COORD: "a_texCoord",
                ATTR_TEX_COORD1: "a_texCoord1",
                ATTR_TEX_COORD2: "a_texCoord2",
                ATTR_TEX_COORD3: "a_texCoord3",
                ATTR_TEX_COORD4: "a_texCoord4",
                ATTR_TEX_COORD5: "a_texCoord5",
                ATTR_TEX_COORD6: "a_texCoord6",
                ATTR_TEX_COORD7: "a_texCoord7",
                ATTR_TEX_COORD8: "a_texCoord8",
                ATTR_TYPE_INT8: 5120,
                ATTR_TYPE_UINT8: 5121,
                ATTR_TYPE_INT16: 5122,
                ATTR_TYPE_UINT16: 5123,
                ATTR_TYPE_INT32: 5124,
                ATTR_TYPE_UINT32: 5125,
                ATTR_TYPE_FLOAT32: 5126,
                FILTER_NEAREST: 0,
                FILTER_LINEAR: 1,
                WRAP_REPEAT: 10497,
                WRAP_CLAMP: 33071,
                WRAP_MIRROR: 33648,
                TEXTURE_FMT_RGB_DXT1: 0,
                TEXTURE_FMT_RGBA_DXT1: 1,
                TEXTURE_FMT_RGBA_DXT3: 2,
                TEXTURE_FMT_RGBA_DXT5: 3,
                TEXTURE_FMT_RGB_ETC1: 4,
                TEXTURE_FMT_RGB_PVRTC_2BPPV1: 5,
                TEXTURE_FMT_RGBA_PVRTC_2BPPV1: 6,
                TEXTURE_FMT_RGB_PVRTC_4BPPV1: 7,
                TEXTURE_FMT_RGBA_PVRTC_4BPPV1: 8,
                TEXTURE_FMT_A8: 9,
                TEXTURE_FMT_L8: 10,
                TEXTURE_FMT_L8_A8: 11,
                TEXTURE_FMT_R5_G6_B5: 12,
                TEXTURE_FMT_R5_G5_B5_A1: 13,
                TEXTURE_FMT_R4_G4_B4_A4: 14,
                TEXTURE_FMT_RGB8: 15,
                TEXTURE_FMT_RGBA8: 16,
                TEXTURE_FMT_RGB16F: 17,
                TEXTURE_FMT_RGBA16F: 18,
                TEXTURE_FMT_RGB32F: 19,
                TEXTURE_FMT_RGBA32F: 20,
                TEXTURE_FMT_R32F: 21,
                TEXTURE_FMT_111110F: 22,
                TEXTURE_FMT_SRGB: 23,
                TEXTURE_FMT_SRGBA: 24,
                TEXTURE_FMT_D16: 25,
                TEXTURE_FMT_D32: 26,
                TEXTURE_FMT_D24S8: 27,
                TEXTURE_FMT_RGB_ETC2: 28,
                TEXTURE_FMT_RGBA_ETC2: 29,
                DS_FUNC_NEVER: 512,
                DS_FUNC_LESS: 513,
                DS_FUNC_EQUAL: 514,
                DS_FUNC_LEQUAL: 515,
                DS_FUNC_GREATER: 516,
                DS_FUNC_NOTEQUAL: 517,
                DS_FUNC_GEQUAL: 518,
                DS_FUNC_ALWAYS: 519,
                RB_FMT_RGBA4: 32854,
                RB_FMT_RGB5_A1: 32855,
                RB_FMT_RGB565: 36194,
                RB_FMT_D16: 33189,
                RB_FMT_S8: 36168,
                RB_FMT_D24S8: 34041,
                BLEND_FUNC_ADD: 32774,
                BLEND_FUNC_SUBTRACT: 32778,
                BLEND_FUNC_REVERSE_SUBTRACT: 32779,
                BLEND_ZERO: 0,
                BLEND_ONE: 1,
                BLEND_SRC_COLOR: 768,
                BLEND_ONE_MINUS_SRC_COLOR: 769,
                BLEND_DST_COLOR: 774,
                BLEND_ONE_MINUS_DST_COLOR: 775,
                BLEND_SRC_ALPHA: 770,
                BLEND_ONE_MINUS_SRC_ALPHA: 771,
                BLEND_DST_ALPHA: 772,
                BLEND_ONE_MINUS_DST_ALPHA: 773,
                BLEND_CONSTANT_COLOR: 32769,
                BLEND_ONE_MINUS_CONSTANT_COLOR: 32770,
                BLEND_CONSTANT_ALPHA: 32771,
                BLEND_ONE_MINUS_CONSTANT_ALPHA: 32772,
                BLEND_SRC_ALPHA_SATURATE: 776,
                STENCIL_DISABLE: 0,
                STENCIL_ENABLE: 1,
                STENCIL_INHERIT: 2,
                STENCIL_OP_KEEP: 7680,
                STENCIL_OP_ZERO: 0,
                STENCIL_OP_REPLACE: 7681,
                STENCIL_OP_INCR: 7682,
                STENCIL_OP_INCR_WRAP: 34055,
                STENCIL_OP_DECR: 7683,
                STENCIL_OP_DECR_WRAP: 34056,
                STENCIL_OP_INVERT: 5386,
                CULL_NONE: 0,
                CULL_FRONT: 1028,
                CULL_BACK: 1029,
                CULL_FRONT_AND_BACK: 1032,
                PT_POINTS: 0,
                PT_LINES: 1,
                PT_LINE_LOOP: 2,
                PT_LINE_STRIP: 3,
                PT_TRIANGLES: 4,
                PT_TRIANGLE_STRIP: 5,
                PT_TRIANGLE_FAN: 6
            };
        m.enums = b
    }, {}],
    332: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        h = function() {
            function f(b, e, c, a) {
                this._device = b;
                this._width = e;
                this._height = c;
                this._colors = a.colors || [];
                this._depth = a.depth || null;
                this._stencil = a.stencil || null;
                this._depthStencil = a.depthStencil || null;
                this._glID = b._gl.createFramebuffer()
            }
            var e = f.prototype;
            e.destroy = function() {
                null === this._glID ? console.error("The frame-buffer already destroyed") : (this._device._gl.deleteFramebuffer(this._glID), this._glID = null)
            };
            e.getHandle = function() {
                return this._glID
            };
            return f
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {}],
    333: [function(h, q, m) {
        function f(b, a) {
            for (var c = 0; c < a.length; c++) {
                var e = a[c];
                e.enumerable = e.enumerable || !1;
                e.configurable = !0;
                "value" in e && (e.writable = !0);
                Object.defineProperty(b, e.key, e)
            }
        }

        function e(b, a, d) {
            a && f(b.prototype, a);
            d && f(b,
                d);
            return b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        h = h("./enums");
        var b, k = (b = {}, b[h.enums.INDEX_FMT_UINT8] = 1, b[h.enums.INDEX_FMT_UINT16] = 2, b[h.enums.INDEX_FMT_UINT32] = 4, b);
        b = function() {
            function b(a, b, c, e) {
                this._device = a;
                this._format = b;
                this._usage = c;
                this._bytesPerIndex = k[b];
                this._bytes = e.byteLength;
                this._numIndices = this._bytes / this._bytesPerIndex;
                this._needExpandDataStore = !0;
                this._glID = a._gl.createBuffer();
                this.update(0, e);
                a._stats.ib += this._bytes
            }
            var a = b.prototype;
            a.destroy = function() {
                -1 === this._glID ?
                    console.error("The buffer already destroyed") : (this._device._gl.deleteBuffer(this._glID), this._device._stats.ib -= this.bytes, this._glID = -1)
            };
            a.update = function(a, b) {
                if (-1 === this._glID) console.error("The buffer is destroyed");
                else if (0 !== b.byteLength) {
                    if (a + b.byteLength > this._bytes) {
                        if (a) {
                            console.error("Failed to update data, bytes exceed.");
                            return
                        }
                        this._needExpandDataStore = !0;
                        this._bytes = a + b.byteLength;
                        this._numIndices = this._bytes / this._bytesPerIndex
                    }
                    var c = this._device._gl,
                        d = this._usage;
                    c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,
                        this._glID);
                    this._needExpandDataStore ? (c.bufferData(c.ELEMENT_ARRAY_BUFFER, b, d), this._needExpandDataStore = !1) : c.bufferSubData(c.ELEMENT_ARRAY_BUFFER, a, b);
                    this._device._restoreIndexBuffer()
                }
            };
            a.setUsage = function(a) {
                this._usage = a
            };
            e(b, [{
                key: "count",
                get: function() {
                    return this._numIndices
                }
            }]);
            return b
        }();
        b.BYTES_PER_INDEX = k;
        m["default"] = b;
        q.exports = m["default"]
    }, {
        "./enums": 331
    }],
    334: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        var f = h("./enums");
        !1;
        var e = h("./vertex-format");
        var b = h("./index-buffer"),
            k = h("./vertex-buffer"),
            c = h("./program"),
            a = h("./texture"),
            d = h("./texture-2d"),
            l = h("./texture-cube"),
            g = h("./render-buffer"),
            n = h("./frame-buffer");
        h = h("./device");
        e = {
            VertexFormat: e,
            IndexBuffer: b,
            VertexBuffer: k,
            Program: c,
            Texture: a,
            Texture2D: d,
            TextureCube: l,
            RenderBuffer: g,
            FrameBuffer: n,
            Device: h,
            attrTypeBytes: f.attrTypeBytes,
            glFilter: f.glFilter,
            glTextureFmt: f.glTextureFmt
        };
        Object.assign(e, f.enums);
        m["default"] = e;
        cc.gfx = e;
        q.exports = m["default"]
    }, {
        "./device": 330,
        "./enums": 331,
        "./frame-buffer": 332,
        "./index-buffer": 333,
        "./program": 336,
        "./render-buffer": 337,
        "./texture": 341,
        "./texture-2d": 339,
        "./texture-cube": 340,
        "./vertex-buffer": 342,
        "./vertex-format": 343
    }],
    335: [function(h, q, m) {
        m.__esModule = !0;
        m.isPow2 = function(f) {
            return !(f & f - 1) && !!f
        }
    }, {}],
    336: [function(h, q, m) {
        function f(a, b) {
            for (var c = 0; c < b.length; c++) {
                var d = b[c];
                d.enumerable = d.enumerable || !1;
                d.configurable = !0;
                "value" in d && (d.writable = !0);
                Object.defineProperty(a, d.key, d)
            }
        }

        function e(a, b, c) {
            b && f(a.prototype, b);
            c && f(a, c);
            return a
        }

        function b(a, b, c) {
            c.split("\n").forEach(function(c) {
                if (!(5 >
                        c.length)) {
                    var d = /^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(c);
                    d ? a.push({
                        type: b,
                        fileID: 0 | d[1],
                        line: 0 | d[2],
                        message: d[3].trim()
                    }) : 0 < c.length && a.push({
                        type: b,
                        fileID: -1,
                        line: 0,
                        message: c
                    })
                }
            })
        }

        function k(a, b, c) {
            b = a.createShader(b);
            a.shaderSource(b, c);
            a.compileShader(b);
            return b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var c = 0;
        h = function() {
            function a(a, b) {
                this._device = a;
                this._attributes = [];
                this._uniforms = [];
                this._samplers = [];
                this._errors = [];
                this._linked = !1;
                this._vertSource = b.vert;
                this._fragSource = b.frag;
                this._glID =
                    null;
                this._id = c++
            }
            var d = a.prototype;
            d.link = function() {
                if (!this._linked) {
                    var a = this._device._gl,
                        c = k(a, a.VERTEX_SHADER, this._vertSource),
                        d = k(a, a.FRAGMENT_SHADER, this._fragSource),
                        e = a.createProgram();
                    a.attachShader(e, c);
                    a.attachShader(e, d);
                    a.linkProgram(e);
                    var f = !1,
                        h = this._errors;
                    a.getShaderParameter(c, a.COMPILE_STATUS) || (b(h, "vs", a.getShaderInfoLog(c)), f = !0);
                    a.getShaderParameter(d, a.COMPILE_STATUS) || (b(h, "fs", a.getShaderInfoLog(d)), f = !0);
                    a.deleteShader(c);
                    a.deleteShader(d);
                    if (f) return h;
                    if (!a.getProgramParameter(e,
                            a.LINK_STATUS)) return h.push({
                        info: "Failed to link shader program: " + a.getProgramInfoLog(e)
                    }), h;
                    this._glID = e;
                    c = a.getProgramParameter(e, a.ACTIVE_ATTRIBUTES);
                    for (d = 0; d < c; ++d) f = a.getActiveAttrib(e, d), h = a.getAttribLocation(e, f.name), this._attributes.push({
                        name: f.name,
                        location: h,
                        type: f.type
                    });
                    c = a.getProgramParameter(e, a.ACTIVE_UNIFORMS);
                    for (d = 0; d < c; ++d) {
                        f = a.getActiveUniform(e, d);
                        h = f.name;
                        var m = a.getUniformLocation(e, h),
                            v = "[0]" === h.substr(h.length - 3);
                        v && (h = h.substr(0, h.length - 3));
                        this._uniforms.push({
                            name: h,
                            location: m,
                            type: f.type,
                            size: v ? f.size : void 0
                        })
                    }
                    this._linked = !0
                }
            };
            d.destroy = function() {
                this._device._gl.deleteProgram(this._glID);
                this._linked = !1;
                this._glID = null;
                this._attributes = [];
                this._uniforms = [];
                this._samplers = []
            };
            e(a, [{
                key: "id",
                get: function() {
                    return this._id
                }
            }]);
            return a
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {}],
    337: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        h = function() {
            function f(b, e, c, a) {
                this._device = b;
                this._format = e;
                this._glID = b._gl.createRenderbuffer();
                this.update(c, a)
            }
            var e =
                f.prototype;
            e.update = function(b, e) {
                this._width = b;
                this._height = e;
                var c = this._device._gl;
                c.bindRenderbuffer(c.RENDERBUFFER, this._glID);
                c.renderbufferStorage(c.RENDERBUFFER, this._format, b, e);
                c.bindRenderbuffer(c.RENDERBUFFER, null)
            };
            e.destroy = function() {
                if (null === this._glID) console.error("The render-buffer already destroyed");
                else {
                    var b = this._device._gl;
                    b.bindRenderbuffer(b.RENDERBUFFER, null);
                    b.deleteRenderbuffer(this._glID);
                    this._glID = null
                }
            };
            return f
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {}],
    338: [function(h,
        q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        h = h("./enums");
        var f = {
            blend: !1,
            blendSep: !1,
            blendColor: 4294967295,
            blendEq: h.enums.BLEND_FUNC_ADD,
            blendAlphaEq: h.enums.BLEND_FUNC_ADD,
            blendSrc: h.enums.BLEND_ONE,
            blendDst: h.enums.BLEND_ZERO,
            blendSrcAlpha: h.enums.BLEND_ONE,
            blendDstAlpha: h.enums.BLEND_ZERO,
            depthTest: !1,
            depthWrite: !1,
            depthFunc: h.enums.DS_FUNC_LESS,
            stencilTest: !1,
            stencilSep: !1,
            stencilFuncFront: h.enums.DS_FUNC_ALWAYS,
            stencilRefFront: 0,
            stencilMaskFront: 255,
            stencilFailOpFront: h.enums.STENCIL_OP_KEEP,
            stencilZFailOpFront: h.enums.STENCIL_OP_KEEP,
            stencilZPassOpFront: h.enums.STENCIL_OP_KEEP,
            stencilWriteMaskFront: 255,
            stencilFuncBack: h.enums.DS_FUNC_ALWAYS,
            stencilRefBack: 0,
            stencilMaskBack: 255,
            stencilFailOpBack: h.enums.STENCIL_OP_KEEP,
            stencilZFailOpBack: h.enums.STENCIL_OP_KEEP,
            stencilZPassOpBack: h.enums.STENCIL_OP_KEEP,
            stencilWriteMaskBack: 255,
            cullMode: h.enums.CULL_BACK,
            primitiveType: h.enums.PT_TRIANGLES,
            maxStream: -1,
            vertexBuffers: [],
            vertexBufferOffsets: [],
            indexBuffer: null,
            maxTextureSlot: -1,
            textureUnits: [],
            program: null
        };
        h = function() {
            function e(b) {
                this.vertexBuffers = Array(b._caps.maxVertexStreams);
                this.vertexBufferOffsets = Array(b._caps.maxVertexStreams);
                this.textureUnits = Array(b._caps.maxTextureUnits);
                this.set(f)
            }
            e.initDefault = function(b) {
                f.vertexBuffers = Array(b._caps.maxVertexStreams);
                f.vertexBufferOffsets = Array(b._caps.maxVertexStreams);
                f.textureUnits = Array(b._caps.maxTextureUnits)
            };
            var b = e.prototype;
            b.reset = function() {
                this.set(f)
            };
            b.set = function(b) {
                this.blend = b.blend;
                this.blendSep = b.blendSep;
                this.blendColor =
                    b.blendColor;
                this.blendEq = b.blendEq;
                this.blendAlphaEq = b.blendAlphaEq;
                this.blendSrc = b.blendSrc;
                this.blendDst = b.blendDst;
                this.blendSrcAlpha = b.blendSrcAlpha;
                this.blendDstAlpha = b.blendDstAlpha;
                this.depthTest = b.depthTest;
                this.depthWrite = b.depthWrite;
                this.depthFunc = b.depthFunc;
                this.stencilTest = b.stencilTest;
                this.stencilSep = b.stencilSep;
                this.stencilFuncFront = b.stencilFuncFront;
                this.stencilRefFront = b.stencilRefFront;
                this.stencilMaskFront = b.stencilMaskFront;
                this.stencilFailOpFront = b.stencilFailOpFront;
                this.stencilZFailOpFront =
                    b.stencilZFailOpFront;
                this.stencilZPassOpFront = b.stencilZPassOpFront;
                this.stencilWriteMaskFront = b.stencilWriteMaskFront;
                this.stencilFuncBack = b.stencilFuncBack;
                this.stencilRefBack = b.stencilRefBack;
                this.stencilMaskBack = b.stencilMaskBack;
                this.stencilFailOpBack = b.stencilFailOpBack;
                this.stencilZFailOpBack = b.stencilZFailOpBack;
                this.stencilZPassOpBack = b.stencilZPassOpBack;
                this.stencilWriteMaskBack = b.stencilWriteMaskBack;
                this.cullMode = b.cullMode;
                this.primitiveType = b.primitiveType;
                this.maxStream = b.maxStream;
                for (var c = 0; c < b.vertexBuffers.length; ++c) this.vertexBuffers[c] = b.vertexBuffers[c];
                for (c = 0; c < b.vertexBufferOffsets.length; ++c) this.vertexBufferOffsets[c] = b.vertexBufferOffsets[c];
                this.indexBuffer = b.indexBuffer;
                this.maxTextureSlot = b.maxTextureSlot;
                for (c = 0; c < b.textureUnits.length; ++c) this.textureUnits[c] = b.textureUnits[c];
                this.program = b.program
            };
            return e
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "./enums": 331
    }],
    339: [function(h, q, m) {
        function f(b, a) {
            b.prototype = Object.create(a.prototype);
            b.prototype.constructor =
                b;
            b.__proto__ = a
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("./texture")),
            b = h("./enums"),
            k = h("./misc");
        h = function(c) {
            function a(a, b) {
                a = c.call(this, a) || this;
                var d = a._device._gl;
                a._target = d.TEXTURE_2D;
                a._glID = d.createTexture();
                b.images = b.images || [null];
                a.update(b);
                return a
            }
            f(a, c);
            var d = a.prototype;
            d.update = function(a) {
                var c = this._device._gl,
                    d = this._genMipmap;
                if (a) {
                    void 0 !== a.width && (this._width = a.width);
                    void 0 !== a.height && (this._height = a.height);
                    void 0 !==
                        a.anisotropy && (this._anisotropy = a.anisotropy);
                    void 0 !== a.minFilter && (this._minFilter = a.minFilter);
                    void 0 !== a.magFilter && (this._magFilter = a.magFilter);
                    void 0 !== a.mipFilter && (this._mipFilter = a.mipFilter);
                    void 0 !== a.wrapS && (this._wrapS = a.wrapS);
                    void 0 !== a.wrapT && (this._wrapT = a.wrapT);
                    void 0 !== a.format && (this._format = a.format, this._compressed = this._format >= b.enums.TEXTURE_FMT_RGB_DXT1 && this._format <= b.enums.TEXTURE_FMT_RGBA_PVRTC_4BPPV1 || this._format >= b.enums.TEXTURE_FMT_RGB_ETC2 && this._format <= b.enums.TEXTURE_FMT_RGBA_ETC2);
                    void 0 !== a.genMipmaps && (d = this._genMipmap = a.genMipmaps);
                    var e = this._device.caps.maxTextureSize || Number.MAX_VALUE,
                        l = Math.max(a.width || 0, a.height || 0);
                    e < l && console.warn("The current texture size " + l + " exceeds the maximum size [" + e + "] supported on the device.");
                    void 0 !== a.images && 1 < a.images.length && (d = !1, 1 !== (a.width > a.height ? a.width : a.height) >> a.images.length - 1 && console.error("texture-2d mipmap is invalid, should have a 1x1 mipmap."))
                }(0, k.isPow2)(this._width) && (0, k.isPow2)(this._height) || (d = !1);
                c.activeTexture(c.TEXTURE0);
                c.bindTexture(c.TEXTURE_2D, this._glID);
                void 0 !== a.images && 0 < a.images.length && (this._setMipmap(a.images, a.flipY, a.premultiplyAlpha), 1 < a.images.length && (this._genMipmap = !0));
                d && (c.hint(c.GENERATE_MIPMAP_HINT, c.NICEST), c.generateMipmap(c.TEXTURE_2D), this._genMipmap = !0);
                this._setTexInfo();
                this._device._restoreTexture(0)
            };
            d.updateSubImage = function(a) {
                var c = this._device._gl,
                    d = (0, b.glTextureFmt)(this._format);
                c.activeTexture(c.TEXTURE0);
                c.bindTexture(c.TEXTURE_2D, this._glID);
                this._setSubImage(d, a);
                this._device._restoreTexture(0)
            };
            d.updateImage = function(a) {
                var c = this._device._gl,
                    d = (0, b.glTextureFmt)(this._format);
                c.activeTexture(c.TEXTURE0);
                c.bindTexture(c.TEXTURE_2D, this._glID);
                this._setImage(d, a);
                this._device._restoreTexture(0)
            };
            d._setSubImage = function(a, b) {
                var c = this._device._gl,
                    d = b.flipY,
                    e = b.premultiplyAlpha,
                    g = b.image;
                !g || ArrayBuffer.isView(g) || g instanceof ArrayBuffer ? (void 0 === d ? c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL, !1) : c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL, d), void 0 === e ? c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1) :
                    c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL, e), this._compressed ? c.compressedTexSubImage2D(c.TEXTURE_2D, b.level, b.x, b.y, b.width, b.height, a.format, g) : c.texSubImage2D(c.TEXTURE_2D, b.level, b.x, b.y, b.width, b.height, a.format, a.pixelType, g)) : (void 0 === d ? c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL, !0) : c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL, d), void 0 === e ? c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1) : c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL, e), c.texSubImage2D(c.TEXTURE_2D, b.level, b.x, b.y, a.format, a.pixelType,
                    g))
            };
            d._setImage = function(a, b) {
                var c = this._device._gl,
                    d = b.flipY,
                    e = b.premultiplyAlpha,
                    g = b.image;
                !g || ArrayBuffer.isView(g) || g instanceof ArrayBuffer ? (void 0 === d ? c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL, !1) : c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL, d), void 0 === e ? c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1) : c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL, e), this._compressed ? c.compressedTexImage2D(c.TEXTURE_2D, b.level, a.internalFormat, b.width, b.height, 0, g) : c.texImage2D(c.TEXTURE_2D, b.level, a.internalFormat,
                    b.width, b.height, 0, a.format, a.pixelType, g)) : (void 0 === d ? c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL, !0) : c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL, d), void 0 === e ? c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1) : c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL, e), c.texImage2D(c.TEXTURE_2D, b.level, a.internalFormat, a.format, a.pixelType, g))
            };
            d._setMipmap = function(a, c, d) {
                var e = (0, b.glTextureFmt)(this._format);
                c = {
                    width: this._width,
                    height: this._height,
                    flipY: c,
                    premultiplyAlpha: d,
                    level: 0,
                    image: null
                };
                for (d = 0; d < a.length; ++d) c.level =
                    d, c.width = this._width >> d, c.height = this._height >> d, c.image = a[d], this._setImage(e, c)
            };
            d._setTexInfo = function() {
                var a = this._device._gl,
                    c = (0, k.isPow2)(this._width) && (0, k.isPow2)(this._height);
                c || this._wrapS === b.enums.WRAP_CLAMP && this._wrapT === b.enums.WRAP_CLAMP || (console.warn("WebGL1 doesn't support all wrap modes with NPOT textures"), this._wrapT = this._wrapS = b.enums.WRAP_CLAMP);
                var d = this._genMipmap ? this._mipFilter : -1;
                c || -1 === d || (console.warn("NPOT textures do not support mipmap filter"), d = -1);
                a.texParameteri(a.TEXTURE_2D,
                    a.TEXTURE_MIN_FILTER, (0, b.glFilter)(a, this._minFilter, d));
                a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MAG_FILTER, (0, b.glFilter)(a, this._magFilter, -1));
                a.texParameteri(a.TEXTURE_2D, a.TEXTURE_WRAP_S, this._wrapS);
                a.texParameteri(a.TEXTURE_2D, a.TEXTURE_WRAP_T, this._wrapT);
                (c = this._device.ext("EXT_texture_filter_anisotropic")) && a.texParameteri(a.TEXTURE_2D, c.TEXTURE_MAX_ANISOTROPY_EXT, this._anisotropy)
            };
            return a
        }(e["default"]);
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "./enums": 331,
        "./misc": 335,
        "./texture": 341
    }],
    340: [function(h, q, m) {
        function f(b, a) {
            b.prototype = Object.create(a.prototype);
            b.prototype.constructor = b;
            b.__proto__ = a
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var e = function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("./texture")),
            b = h("./enums"),
            k = h("./misc");
        h = function(c) {
            function a(a, b) {
                a = c.call(this, a) || this;
                var d = a._device._gl;
                a._target = d.TEXTURE_CUBE_MAP;
                a._glID = d.createTexture();
                a.update(b);
                return a
            }
            f(a, c);
            var d = a.prototype;
            d.update = function(a) {
                var c = this._device._gl,
                    d = this._genMipmaps;
                a && (void 0 !==
                    a.width && (this._width = a.width), void 0 !== a.height && (this._height = a.height), void 0 !== a.anisotropy && (this._anisotropy = a.anisotropy), void 0 !== a.minFilter && (this._minFilter = a.minFilter), void 0 !== a.magFilter && (this._magFilter = a.magFilter), void 0 !== a.mipFilter && (this._mipFilter = a.mipFilter), void 0 !== a.wrapS && (this._wrapS = a.wrapS), void 0 !== a.wrapT && (this._wrapT = a.wrapT), void 0 !== a.format && (this._format = a.format, this._compressed = this._format >= b.enums.TEXTURE_FMT_RGB_DXT1 && this._format <= b.enums.TEXTURE_FMT_RGBA_PVRTC_4BPPV1 ||
                        this._format >= b.enums.TEXTURE_FMT_RGB_ETC2 && this._format <= b.enums.TEXTURE_FMT_RGBA_ETC2), void 0 !== a.genMipmaps && (d = this._genMipmaps = a.genMipmaps), void 0 !== a.images && 1 < a.images.length && (d = !1, a.width !== a.height && console.warn("texture-cube width and height should be identical."), 1 !== a.width >> a.images.length - 1 && console.error("texture-cube mipmap is invalid. please set mipmap as 1x1, 2x2, 4x4 ... nxn")));
                (0, k.isPow2)(this._width) && (0, k.isPow2)(this._height) || (d = !1);
                c.activeTexture(c.TEXTURE0);
                c.bindTexture(c.TEXTURE_CUBE_MAP,
                    this._glID);
                void 0 !== a.images && 0 < a.images.length && (this._setMipmap(a.images, a.flipY, a.premultiplyAlpha), 1 < a.images.length && (this._genMipmaps = !0));
                d && (c.hint(c.GENERATE_MIPMAP_HINT, c.NICEST), c.generateMipmap(c.TEXTURE_CUBE_MAP), this._genMipmaps = !0);
                this._setTexInfo();
                this._device._restoreTexture(0)
            };
            d.updateSubImage = function(a) {
                var c = this._device._gl,
                    d = (0, b.glTextureFmt)(this._format);
                c.activeTexture(c.TEXTURE0);
                c.bindTexture(c.TEXTURE_CUBE_MAP, this._glID);
                this._setSubImage(d, a);
                this._device._restoreTexture(0)
            };
            d.updateImage = function(a) {
                var c = this._device._gl,
                    d = (0, b.glTextureFmt)(this._format);
                c.activeTexture(c.TEXTURE0);
                c.bindTexture(c.TEXTURE_CUBE_MAP, this._glID);
                this._setImage(d, a);
                this._device._restoreTexture(0)
            };
            d._setSubImage = function(a, b) {
                var c = this._device._gl,
                    d = b.flipY,
                    e = b.premultiplyAlpha,
                    g = b.faceIndex,
                    f = b.image;
                void 0 === d ? c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL, !1) : c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL, d);
                void 0 === e ? c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1) : c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
                    e);
                !f || ArrayBuffer.isView(f) || f instanceof ArrayBuffer ? this._compressed ? c.compressedTexSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X + g, b.level, b.x, b.y, b.width, b.height, a.format, f) : c.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X + g, b.level, b.x, b.y, b.width, b.height, a.format, a.pixelType, f) : c.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X + g, b.level, b.x, b.y, a.format, a.pixelType, f)
            };
            d._setImage = function(a, b) {
                var c = this._device._gl,
                    d = b.flipY,
                    e = b.premultiplyAlpha,
                    g = b.faceIndex,
                    f = b.image;
                void 0 === d ? c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL, !1) : c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL, d);
                void 0 === e ? c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1) : c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL, e);
                !f || ArrayBuffer.isView(f) || f instanceof ArrayBuffer ? this._compressed ? c.compressedTexImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X + g, b.level, a.internalFormat, b.width, b.height, 0, f) : c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X + g, b.level, a.internalFormat, b.width, b.height, 0, a.format, a.pixelType, f) : c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X + g, b.level, a.internalFormat,
                    a.format, a.pixelType, f)
            };
            d._setMipmap = function(a, c, d) {
                var e = (0, b.glTextureFmt)(this._format);
                c = {
                    width: this._width,
                    height: this._height,
                    faceIndex: 0,
                    flipY: c,
                    premultiplyAlpha: d,
                    level: 0,
                    image: null
                };
                for (d = 0; d < a.length; ++d) {
                    var g = a[d];
                    c.level = d;
                    c.width = this._width >> d;
                    c.height = this._height >> d;
                    for (var f = 0; 6 > f; ++f) c.faceIndex = f, c.image = g[f], this._setImage(e, c)
                }
            };
            d._setTexInfo = function() {
                var a = this._device._gl,
                    c = (0, k.isPow2)(this._width) && (0, k.isPow2)(this._height);
                c || this._wrapS === b.enums.WRAP_CLAMP && this._wrapT ===
                    b.enums.WRAP_CLAMP || (console.warn("WebGL1 doesn't support all wrap modes with NPOT textures"), this._wrapT = this._wrapS = b.enums.WRAP_CLAMP);
                var d = this._genMipmaps ? this._mipFilter : -1;
                c || -1 === d || (console.warn("NPOT textures do not support mipmap filter"), d = -1);
                a.texParameteri(a.TEXTURE_CUBE_MAP, a.TEXTURE_MIN_FILTER, (0, b.glFilter)(a, this._minFilter, d));
                a.texParameteri(a.TEXTURE_CUBE_MAP, a.TEXTURE_MAG_FILTER, (0, b.glFilter)(a, this._magFilter, -1));
                a.texParameteri(a.TEXTURE_CUBE_MAP, a.TEXTURE_WRAP_S, this._wrapS);
                a.texParameteri(a.TEXTURE_CUBE_MAP, a.TEXTURE_WRAP_T, this._wrapT);
                (c = this._device.ext("EXT_texture_filter_anisotropic")) && a.texParameteri(a.TEXTURE_CUBE_MAP, c.TEXTURE_MAX_ANISOTROPY_EXT, this._anisotropy)
            };
            return a
        }(e["default"]);
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "./enums": 331,
        "./misc": 335,
        "./texture": 341
    }],
    341: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        var f = h("./enums"),
            e = 0;
        h = function() {
            function b(b) {
                this._device = b;
                this._height = this._width = 4;
                this._compressed = this._genMipmaps = !1;
                this._anisotropy =
                    1;
                this._mipFilter = this._magFilter = this._minFilter = f.enums.FILTER_LINEAR;
                this._wrapT = this._wrapS = f.enums.WRAP_REPEAT;
                this._format = f.enums.TEXTURE_FMT_RGBA8;
                this._target = -1;
                this._id = e++
            }
            b.prototype.destroy = function() {
                null === this._glID ? console.error("The texture already destroyed") : (this._device._gl.deleteTexture(this._glID), this._device._stats.tex -= this.bytes, this._glID = null)
            };
            return b
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "./enums": 331
    }],
    342: [function(h, q, m) {
        function f(b, e) {
            for (var c = 0; c < e.length; c++) {
                var a =
                    e[c];
                a.enumerable = a.enumerable || !1;
                a.configurable = !0;
                "value" in a && (a.writable = !0);
                Object.defineProperty(b, a.key, a)
            }
        }

        function e(b, e, c) {
            e && f(b.prototype, e);
            c && f(b, c);
            return b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        h("./enums");
        h = function() {
            function b(b, a, d, e) {
                this._device = b;
                this._format = a;
                this._usage = d;
                this._bytesPerVertex = this._format._bytes;
                this._bytes = e.byteLength;
                this._numVertices = this._bytes / this._bytesPerVertex;
                this._needExpandDataStore = !0;
                this._glID = b._gl.createBuffer();
                this.update(0, e);
                b._stats.vb +=
                    this._bytes
            }
            var f = b.prototype;
            f.destroy = function() {
                -1 === this._glID ? console.error("The buffer already destroyed") : (this._device._gl.deleteBuffer(this._glID), this._device._stats.vb -= this.bytes, this._glID = -1)
            };
            f.update = function(b, a) {
                if (-1 === this._glID) console.error("The buffer is destroyed");
                else if (0 !== a.byteLength) {
                    if (b + a.byteLength > this._bytes) {
                        if (b) {
                            console.error("Failed to update data, bytes exceed.");
                            return
                        }
                        this._needExpandDataStore = !0;
                        this._bytes = b + a.byteLength;
                        this._numVertices = this._bytes / this._bytesPerVertex
                    }
                    var c =
                        this._device._gl,
                        e = this._usage;
                    c.bindBuffer(c.ARRAY_BUFFER, this._glID);
                    this._needExpandDataStore ? (c.bufferData(c.ARRAY_BUFFER, a, e), this._needExpandDataStore = !1) : c.bufferSubData(c.ARRAY_BUFFER, b, a);
                    c.bindBuffer(c.ARRAY_BUFFER, null)
                }
            };
            f.getFormat = function(b) {
                return this._format.element(b)
            };
            f.setUsage = function(b) {
                this._usage = b
            };
            e(b, [{
                key: "count",
                get: function() {
                    return this._numVertices
                }
            }]);
            return b
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "./enums": 331
    }],
    343: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] =
            void 0;
        var f = h("./enums"),
            e = function(b) {
                return b && b.__esModule ? b : {
                    default: b
                }
            }(h("../murmurhash2_gc"));
        h = function() {
            function b(b) {
                this._attr2el = {};
                this._elements = [];
                this._bytes = 0;
                for (var a = "", c = 0, l = b.length; c < l; ++c) {
                    var g = b[c];
                    g = {
                        name: g.name,
                        offset: this._bytes,
                        stride: 0,
                        stream: -1,
                        type: g.type,
                        num: g.num,
                        normalize: void 0 !== g.normalize && g.normalize,
                        bytes: g.num * (0, f.attrTypeBytes)(g.type)
                    };
                    this._attr2el[g.name] = g;
                    this._elements.push(g);
                    this._bytes += g.bytes;
                    a += g.name + ":" + g.num + ":" + g.type + ":" + g.normalize
                }
                b =
                    0;
                for (c = this._elements.length; b < c; ++b) this._elements[b].stride = this._bytes;
                this._hash = (0, e["default"])(a, 666)
            }
            var h = b.prototype;
            h.element = function(b) {
                return this._attr2el[b]
            };
            h.getHash = function() {
                return this._hash
            };
            return b
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../murmurhash2_gc": 352,
        "./enums": 331
    }],
    344: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        h = function() {
            function f(e, b) {
                this._cursor = 0;
                this._data = Array(b);
                for (var f = 0; f < b; ++f) this._data[f] = e()
            }
            f.prototype.request = function() {
                var e =
                    this._data[this._cursor];
                this._cursor = (this._cursor + 1) % this._data.length;
                return e
            };
            return f
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {}],
    345: [function(h, q, m) {
        function f(b, c) {
            for (var a = 0; a < c.length; a++) {
                var d = c[a];
                d.enumerable = d.enumerable || !1;
                d.configurable = !0;
                "value" in d && (d.writable = !0);
                Object.defineProperty(b, d.key, d)
            }
        }

        function e(b, c, a) {
            c && f(b.prototype, c);
            a && f(b, a);
            return b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var b = function(b) {
            return b && b.__esModule ? b : {
                default: b
            }
        }(h("./timsort"));
        h = function() {
            function f(a) {
                this._count =
                    0;
                this._data = Array(a)
            }
            var c = f.prototype;
            c._resize = function(a) {
                if (a > this._data.length)
                    for (var b = this._data.length; b < a; ++b) this._data[b] = void 0
            };
            c.reset = function() {
                for (var a = 0; a < this._count; ++a) this._data[a] = void 0;
                this._count = 0
            };
            c.push = function(a) {
                this._count >= this._data.length && this._resize(2 * this._data.length);
                this._data[this._count] = a;
                ++this._count
            };
            c.pop = function() {
                --this._count;
                0 > this._count && (this._count = 0);
                var a = this._data[this._count];
                this._data[this._count] = void 0;
                return a
            };
            c.fastRemove = function(a) {
                if (!(a >=
                        this._count || 0 > a)) {
                    var b = this._count - 1;
                    this._data[a] = this._data[b];
                    this._data[b] = void 0;
                    --this._count
                }
            };
            c.indexOf = function(a) {
                return this._data.indexOf(a)
            };
            c.sort = function(a) {
                return (0, b["default"])(this._data, 0, this._count, a)
            };
            e(f, [{
                key: "length",
                get: function() {
                    return this._count
                }
            }, {
                key: "data",
                get: function() {
                    return this._data
                }
            }]);
            return f
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "./timsort": 350
    }],
    346: [function(h, q, m) {
        function f(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }
        m.__esModule = !0;
        m.TypedArrayPool =
            m.RecyclePool = m.Pool = m.LinkedArray = m.FixedArray = m.CircularPool = void 0;
        q = f(h("./circular-pool"));
        m.CircularPool = q["default"];
        q = f(h("./fixed-array"));
        m.FixedArray = q["default"];
        q = f(h("./linked-array"));
        m.LinkedArray = q["default"];
        q = f(h("./pool"));
        m.Pool = q["default"];
        q = f(h("./recycle-pool"));
        m.RecyclePool = q["default"];
        h = f(h("./typed-array-pool"));
        m.TypedArrayPool = h["default"]
    }, {
        "./circular-pool": 344,
        "./fixed-array": 345,
        "./linked-array": 347,
        "./pool": 348,
        "./recycle-pool": 349,
        "./typed-array-pool": 351
    }],
    347: [function(h,
        q, m) {
        function f(b, c) {
            for (var a = 0; a < c.length; a++) {
                var d = c[a];
                d.enumerable = d.enumerable || !1;
                d.configurable = !0;
                "value" in d && (d.writable = !0);
                Object.defineProperty(b, d.key, d)
            }
        }

        function e(b, c, a) {
            c && f(b.prototype, c);
            a && f(b, a);
            return b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var b = function(b) {
            return b && b.__esModule ? b : {
                default: b
            }
        }(h("./pool"));
        h = function() {
            function f(a, c) {
                this._fn = a;
                this._count = 0;
                this._tail = this._head = null;
                this._pool = new b["default"](a, c)
            }
            var c = f.prototype;
            c.add = function() {
                var a = this._pool.alloc();
                this._tail ? (this._tail._next = a, a._prev = this._tail) : this._head = a;
                this._tail = a;
                this._count += 1;
                return a
            };
            c.remove = function(a) {
                a._prev ? a._prev._next = a._next : this._head = a._next;
                a._next ? a._next._prev = a._prev : this._tail = a._prev;
                a._next = null;
                a._prev = null;
                this._pool.free(a);
                --this._count
            };
            c.forEach = function(a, b) {
                var c = this._head;
                if (c) {
                    b && (a = a.bind(b));
                    b = 0;
                    for (var d; c;) d = c._next, a(c, b, this), c = d, ++b
                }
            };
            e(f, [{
                key: "head",
                get: function() {
                    return this._head
                }
            }, {
                key: "tail",
                get: function() {
                    return this._tail
                }
            }, {
                key: "length",
                get: function() {
                    return this._count
                }
            }]);
            return f
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "./pool": 348
    }],
    348: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        h = function() {
            function f(b, e) {
                this._fn = b;
                this._idx = e - 1;
                this._frees = Array(e);
                for (var c = 0; c < e; ++c) this._frees[c] = b()
            }
            var e = f.prototype;
            e._expand = function(b) {
                var e = this._frees;
                this._frees = Array(b);
                for (var c = b - e.length, a = 0; a < c; ++a) this._frees[a] = this._fn();
                a = c;
                for (var d = 0; a < b; ++a, ++d) this._frees[a] = e[d];
                this._idx += c
            };
            e.alloc = function() {
                0 > this._idx &&
                    this._expand(Math.round(1.2 * this._frees.length) + 1);
                var b = this._frees[this._idx];
                this._frees[this._idx] = null;
                --this._idx;
                return b
            };
            e.free = function(b) {
                ++this._idx;
                this._frees[this._idx] = b
            };
            e.clear = function(b) {
                for (var e = 0; e <= this._idx; e++) b && b(this._frees[e]);
                this._frees.length = 0;
                this._idx = -1
            };
            return f
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {}],
    349: [function(h, q, m) {
        function f(b, c) {
            for (var a = 0; a < c.length; a++) {
                var d = c[a];
                d.enumerable = d.enumerable || !1;
                d.configurable = !0;
                "value" in d && (d.writable = !0);
                Object.defineProperty(b,
                    d.key, d)
            }
        }

        function e(b, c, a) {
            c && f(b.prototype, c);
            a && f(b, a);
            return b
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var b = function(b) {
            return b && b.__esModule ? b : {
                default: b
            }
        }(h("./timsort"));
        h = function() {
            function f(a, b) {
                this._fn = a;
                this._count = 0;
                this._data = Array(b);
                for (var c = 0; c < b; ++c) this._data[c] = a()
            }
            var c = f.prototype;
            c.reset = function() {
                this._count = 0
            };
            c.resize = function(a) {
                if (a > this._data.length)
                    for (var b = this._data.length; b < a; ++b) this._data[b] = this._fn()
            };
            c.add = function() {
                this._count >= this._data.length && this.resize(2 *
                    this._data.length);
                return this._data[this._count++]
            };
            c.remove = function(a) {
                if (!(a >= this._count)) {
                    var b = this._count - 1,
                        c = this._data[a];
                    this._data[a] = this._data[b];
                    this._data[b] = c;
                    --this._count
                }
            };
            c.sort = function(a) {
                return (0, b["default"])(this._data, 0, this._count, a)
            };
            e(f, [{
                key: "length",
                get: function() {
                    return this._count
                }
            }, {
                key: "data",
                get: function() {
                    return this._data
                }
            }]);
            return f
        }();
        m["default"] = h;
        cc.RecyclePool = h;
        q.exports = m["default"]
    }, {
        "./timsort": 350
    }],
    350: [function(h, q, m) {
        function f(a) {
            return 1E5 > a ?
                100 > a ? 10 > a ? 0 : 1 : 1E4 > a ? 1E3 > a ? 2 : 3 : 4 : 1E7 > a ? 1E6 > a ? 5 : 6 : 1E9 > a ? 1E8 > a ? 7 : 8 : 9
        }

        function e(a, b) {
            if (a === b) return 0;
            if (~~a === a && ~~b === b) {
                if (0 === a || 0 === b) return a < b ? -1 : 1;
                if (0 > a || 0 > b) {
                    if (0 <= b) return -1;
                    if (0 <= a) return 1;
                    a = -a;
                    b = -b
                }
                var c = f(a),
                    d = f(b),
                    e = 0;
                c < d ? (a *= l[d - c - 1], b /= 10, e = -1) : c > d && (b *= l[c - d - 1], a /= 10, e = 1);
                return a === b ? e : a < b ? -1 : 1
            }
            a = String(a);
            b = String(b);
            return a === b ? 0 : a < b ? -1 : 1
        }

        function b(a, b, c, d) {
            var e = b + 1;
            if (e === c) return 1;
            if (0 > d(a[e++], a[b])) {
                for (; e < c && 0 > d(a[e], a[e - 1]);) e++;
                c = b;
                d = e;
                for (d--; c < d;) {
                    var g = a[c];
                    a[c++] =
                        a[d];
                    a[d--] = g
                }
            } else
                for (; e < c && 0 <= d(a[e], a[e - 1]);) e++;
            return e - b
        }

        function k(a, b, c, d, e) {
            for (d === b && d++; d < c; d++) {
                for (var g = a[d], f = b, l = d; f < l;) {
                    var h = f + l >>> 1;
                    0 > e(g, a[h]) ? l = h : f = h + 1
                }
                l = d - f;
                switch (l) {
                    case 3:
                        a[f + 3] = a[f + 2];
                    case 2:
                        a[f + 2] = a[f + 1];
                    case 1:
                        a[f + 1] = a[f];
                        break;
                    default:
                        for (; 0 < l;) a[f + l] = a[f + l - 1], l--
                }
                a[f] = g
            }
        }

        function c(a, b, c, d, e, g) {
            var f = 0,
                l = 1;
            if (0 < g(a, b[c + e])) {
                for (d -= e; l < d && 0 < g(a, b[c + e + l]);) f = l, l = 1 + (l << 1), 0 >= l && (l = d);
                l > d && (l = d);
                f += e;
                l += e
            } else {
                for (d = e + 1; l < d && 0 >= g(a, b[c + e - l]);) f = l, l = 1 + (l << 1), 0 >= l && (l = d);
                l > d && (l = d);
                d = f;
                f = e - l;
                l = e - d
            }
            for (f++; f < l;) e = f + (l - f >>> 1), 0 < g(a, b[c + e]) ? f = e + 1 : l = e;
            return l
        }

        function a(a, b, c, d, e, g) {
            var f = 0,
                l = 1;
            if (0 > g(a, b[c + e])) {
                for (d = e + 1; l < d && 0 > g(a, b[c + e - l]);) f = l, l = 1 + (l << 1), 0 >= l && (l = d);
                l > d && (l = d);
                d = f;
                f = e - l;
                l = e - d
            } else {
                for (d -= e; l < d && 0 <= g(a, b[c + e + l]);) f = l, l = 1 + (l << 1), 0 >= l && (l = d);
                l > d && (l = d);
                f += e;
                l += e
            }
            for (f++; f < l;) e = f + (l - f >>> 1), 0 > g(a, b[c + e]) ? l = e : f = e + 1;
            return l
        }
        m.__esModule = !0;
        m["default"] = function(a, c, f, l) {
            if (!Array.isArray(a)) throw new TypeError("Can only sort arrays");
            void 0 === c && (c = 0);
            void 0 === f && (f = a.length);
            void 0 === l && (l = e);
            var h = f - c;
            if (!(2 > h))
                if (h < d) {
                    var n = b(a, c, f, l);
                    k(a, c, f, c + n, l)
                } else {
                    var p = new g(a, l),
                        m;
                    n = h;
                    for (m = 0; n >= d;) m |= 1 & n, n >>= 1;
                    m = n + m;
                    do {
                        n = b(a, c, f, l);
                        if (n < m) {
                            var t = h;
                            t > m && (t = m);
                            k(a, c, c + t, c + n, l);
                            n = t
                        }
                        p.pushRun(c, n);
                        p.mergeRuns();
                        h -= n;
                        c += n
                    } while (0 !== h);
                    p.forceMergeRuns()
                }
        };
        var d = 32,
            l = [1, 10, 100, 1E3, 1E4, 1E5, 1E6, 1E7, 1E8, 1E9],
            g = function() {
                function b(a, b) {
                    this.array = a;
                    this.compare = b;
                    this.minGallop = 7;
                    this.length = a.length;
                    this.tmpStorageLength = 256;
                    512 > this.length && (this.tmpStorageLength =
                        this.length >>> 1);
                    this.tmp = Array(this.tmpStorageLength);
                    this.stackLength = 120 > this.length ? 5 : 1542 > this.length ? 10 : 119151 > this.length ? 19 : 40;
                    this.runStart = Array(this.stackLength);
                    this.runLength = Array(this.stackLength);
                    this.stackSize = 0
                }
                var d = b.prototype;
                d.pushRun = function(a, b) {
                    this.runStart[this.stackSize] = a;
                    this.runLength[this.stackSize] = b;
                    this.stackSize += 1
                };
                d.mergeRuns = function() {
                    for (; 1 < this.stackSize;) {
                        var a = this.stackSize - 2;
                        if (1 <= a && this.runLength[a - 1] <= this.runLength[a] + this.runLength[a + 1] || 2 <= a && this.runLength[a -
                                2] <= this.runLength[a] + this.runLength[a - 1]) this.runLength[a - 1] < this.runLength[a + 1] && a--;
                        else if (this.runLength[a] > this.runLength[a + 1]) break;
                        this.mergeAt(a)
                    }
                };
                d.forceMergeRuns = function() {
                    for (; 1 < this.stackSize;) {
                        var a = this.stackSize - 2;
                        0 < a && this.runLength[a - 1] < this.runLength[a + 1] && a--;
                        this.mergeAt(a)
                    }
                };
                d.mergeAt = function(b) {
                    var d = this.compare,
                        e = this.array,
                        g = this.runStart[b],
                        f = this.runLength[b],
                        l = this.runStart[b + 1],
                        h = this.runLength[b + 1];
                    this.runLength[b] = f + h;
                    b === this.stackSize - 3 && (this.runStart[b + 1] = this.runStart[b +
                        2], this.runLength[b + 1] = this.runLength[b + 2]);
                    this.stackSize--;
                    b = a(e[l], e, g, f, 0, d);
                    g += b;
                    f -= b;
                    0 !== f && (h = c(e[g + f - 1], e, l, h, h - 1, d), 0 !== h && (f <= h ? this.mergeLow(g, f, l, h) : this.mergeHigh(g, f, l, h)))
                };
                d.mergeLow = function(b, d, e, g) {
                    var f = this.compare,
                        l = this.array,
                        h = this.tmp,
                        k;
                    for (k = 0; k < d; k++) h[k] = l[b + k];
                    var n = 0;
                    l[b++] = l[e++];
                    if (0 === --g)
                        for (k = 0; k < d; k++) l[b + k] = h[n + k];
                    else if (1 === d) {
                        for (k = 0; k < g; k++) l[b + k] = l[e + k];
                        l[b + g] = h[n]
                    } else {
                        for (var p = this.minGallop;;) {
                            var m = 0,
                                t = 0,
                                u = !1;
                            do
                                if (0 > f(l[e], h[n])) {
                                    if (l[b++] = l[e++], t++,
                                        m = 0, 0 === --g) {
                                        u = !0;
                                        break
                                    }
                                } else if (l[b++] = h[n++], m++, t = 0, 1 === --d) {
                                u = !0;
                                break
                            } while ((m | t) < p);
                            if (u) break;
                            do {
                                m = a(l[e], h, n, d, 0, f);
                                if (0 !== m) {
                                    for (k = 0; k < m; k++) l[b + k] = h[n + k];
                                    b += m;
                                    n += m;
                                    d -= m;
                                    if (1 >= d) {
                                        u = !0;
                                        break
                                    }
                                }
                                l[b++] = l[e++];
                                if (0 === --g) {
                                    u = !0;
                                    break
                                }
                                t = c(h[n], l, e, g, 0, f);
                                if (0 !== t) {
                                    for (k = 0; k < t; k++) l[b + k] = l[e + k];
                                    b += t;
                                    e += t;
                                    g -= t;
                                    if (0 === g) {
                                        u = !0;
                                        break
                                    }
                                }
                                l[b++] = h[n++];
                                if (1 === --d) {
                                    u = !0;
                                    break
                                }
                                p--
                            } while (7 <= m || 7 <= t);
                            if (u) break;
                            0 > p && (p = 0);
                            p += 2
                        }
                        this.minGallop = p;
                        1 > p && (this.minGallop = 1);
                        if (1 === d) {
                            for (k = 0; k < g; k++) l[b + k] = l[e + k];
                            l[b + g] = h[n]
                        } else {
                            if (0 === d) throw Error("mergeLow preconditions were not respected");
                            for (k = 0; k < d; k++) l[b + k] = h[n + k]
                        }
                    }
                };
                d.mergeHigh = function(b, d, e, g) {
                    var f = this.compare,
                        l = this.array,
                        h = this.tmp,
                        k;
                    for (k = 0; k < g; k++) h[k] = l[e + k];
                    var n = b + d - 1,
                        p = g - 1;
                    e = e + g - 1;
                    l[e--] = l[n--];
                    if (0 === --d) {
                        var m = e - (g - 1);
                        for (k = 0; k < g; k++) l[m + k] = h[k]
                    } else if (1 === g) {
                        e -= d;
                        var t = e + 1;
                        m = n - d + 1;
                        for (k = d - 1; 0 <= k; k--) l[t + k] = l[m + k];
                        l[e] = h[p]
                    } else {
                        for (var u = this.minGallop;;) {
                            var v = 0,
                                w = 0,
                                q = !1;
                            do
                                if (0 > f(h[p], l[n])) {
                                    if (l[e--] = l[n--], v++, w = 0, 0 === --d) {
                                        q = !0;
                                        break
                                    }
                                } else if (l[e--] = h[p--], w++, v = 0, 1 === --g) {
                                q = !0;
                                break
                            } while ((v | w) < u);
                            if (q) break;
                            do {
                                v = d - a(h[p], l, b, d, d - 1, f);
                                if (0 !== v) {
                                    e -= v;
                                    n -= v;
                                    d -= v;
                                    t = e + 1;
                                    m = n + 1;
                                    for (k = v - 1; 0 <= k; k--) l[t + k] = l[m + k];
                                    if (0 === d) {
                                        q = !0;
                                        break
                                    }
                                }
                                l[e--] = h[p--];
                                if (1 === --g) {
                                    q = !0;
                                    break
                                }
                                w = g - c(l[n], h, 0, g, g - 1, f);
                                if (0 !== w) {
                                    e -= w;
                                    p -= w;
                                    g -= w;
                                    t = e + 1;
                                    m = p + 1;
                                    for (k = 0; k < w; k++) l[t + k] = h[m + k];
                                    if (1 >= g) {
                                        q = !0;
                                        break
                                    }
                                }
                                l[e--] = l[n--];
                                if (0 === --d) {
                                    q = !0;
                                    break
                                }
                                u--
                            } while (7 <= v || 7 <= w);
                            if (q) break;
                            0 > u && (u = 0);
                            u += 2
                        }
                        this.minGallop = u;
                        1 > u && (this.minGallop = 1);
                        if (1 === g) {
                            e -= d;
                            t = e + 1;
                            m = n - d + 1;
                            for (k = d - 1; 0 <= k; k--) l[t + k] = l[m + k];
                            l[e] = h[p]
                        } else {
                            if (0 === g) throw Error("mergeHigh preconditions were not respected");
                            m = e - (g - 1);
                            for (k = 0; k < g; k++) l[m + k] = h[k]
                        }
                    }
                };
                return b
            }();
        q.exports = m["default"]
    }, {}],
    351: [function(h, q, m) {
        function f(b) {
            var c = (65535 < b) << 4;
            b >>>= c;
            var a = (255 < b) << 3;
            b >>>= a;
            c |= a;
            a = (15 < b) << 2;
            b >>>= a;
            c |= a;
            a = (3 < b) << 1;
            return c | a | b >>> a >> 1
        }

        function e(e) {
            a: {
                for (var c = 16; 268435456 >= c; c *= 16)
                    if (e <= c) {
                        e = c;
                        break a
                    }
                e = 0
            }
            c = b[f(e) >> 2];
            return 0 < c.length ? c.pop() : new ArrayBuffer(e)
        }
        m.__esModule = !0;
        m["default"] =
            void 0;
        var b = Array(8);
        for (h = 0; 8 > h; ++h) b[h] = [];
        m["default"] = {
            alloc_int8: function(b) {
                var c = new Int8Array(e(b), 0, b);
                return c.length !== b ? c.subarray(0, b) : c
            },
            alloc_uint8: function(b) {
                var c = new Uint8Array(e(b), 0, b);
                return c.length !== b ? c.subarray(0, b) : c
            },
            alloc_int16: function(b) {
                var c = new Int16Array(e(2 * b), 0, b);
                return c.length !== b ? c.subarray(0, b) : c
            },
            alloc_uint16: function(b) {
                var c = new Uint16Array(e(2 * b), 0, b);
                return c.length !== b ? c.subarray(0, b) : c
            },
            alloc_int32: function(b) {
                var c = new Int32Array(e(4 * b), 0, b);
                return c.length !==
                    b ? c.subarray(0, b) : c
            },
            alloc_uint32: function(b) {
                var c = new Uint32Array(e(4 * b), 0, b);
                return c.length !== b ? c.subarray(0, b) : c
            },
            alloc_float32: function(b) {
                var c = new Float32Array(e(4 * b), 0, b);
                return c.length !== b ? c.subarray(0, b) : c
            },
            alloc_float64: function(b) {
                var c = new Float64Array(e(8 * b), 0, b);
                return c.length !== b ? c.subarray(0, b) : c
            },
            alloc_dataview: function(b) {
                var c = new DataView(e(b), 0, b);
                return c.length !== b ? c.subarray(0, b) : c
            },
            free: function(e) {
                e = e.buffer;
                b[f(e.byteLength) >> 2].push(e)
            },
            reset: function() {
                for (var b = Array(8),
                        c = 0; 8 > c; ++c) b[c] = []
            }
        };
        q.exports = m["default"]
    }, {}],
    352: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = function(f, e) {
            var b = f.length;
            e ^= b;
            for (var h = 0, c; 4 <= b;) c = 255 & f.charCodeAt(h) | (255 & f.charCodeAt(++h)) << 8 | (255 & f.charCodeAt(++h)) << 16 | (255 & f.charCodeAt(++h)) << 24, c = 1540483477 * (65535 & c) + ((1540483477 * (c >>> 16) & 65535) << 16), c ^= c >>> 24, c = 1540483477 * (65535 & c) + ((1540483477 * (c >>> 16) & 65535) << 16), e = 1540483477 * (65535 & e) + ((1540483477 * (e >>> 16) & 65535) << 16) ^ c, b -= 4, ++h;
            switch (b) {
                case 3:
                    e ^= (255 & f.charCodeAt(h + 2)) << 16;
                case 2:
                    e ^=
                        (255 & f.charCodeAt(h + 1)) << 8;
                case 1:
                    e ^= 255 & f.charCodeAt(h), e = 1540483477 * (65535 & e) + ((1540483477 * (e >>> 16) & 65535) << 16)
            }
            e ^= e >>> 13;
            e = 1540483477 * (65535 & e) + ((1540483477 * (e >>> 16) & 65535) << 16);
            return (e ^ e >>> 15) >>> 0
        };
        q.exports = m["default"]
    }, {}],
    353: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a) {
            if (void 0 === a) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
            return a
        }

        function b(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor =
                a;
            a.__proto__ = b
        }

        function k(a, b) {
            return a._priority - b._priority
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var c = h("../../core/value-types"),
            a = f(h("../core/base-renderer")),
            d = f(h("../enums"));
        h = h("../memop");
        var l = new Float32Array(16),
            g = new Float32Array(16),
            n = new Float32Array(16),
            w = new Float32Array(16),
            t = new Float32Array(4),
            p = new Float32Array(64),
            u = [],
            v = new Float32Array(4),
            A = new c.Vec4(0, 0, 0, 0),
            B = new c.Vec3(0, 0, 0),
            E = new c.Vec3(0, 0, 0),
            y = new h.RecyclePool(function() {
                return new Float32Array(16)
            }, 8);
        a = function(a) {
            function f(b,
                c) {
                b = a.call(this, b, c) || this;
                b._time = new Float32Array(4);
                b._lights = [];
                b._shadowLights = [];
                b._numLights = 0;
                b._defines = {};
                b._registerStage("shadowcast", b._shadowStage.bind(e(b)));
                b._registerStage("opaque", b._opaqueStage.bind(e(b)));
                b._registerStage("transparent", b._transparentStage.bind(e(b)));
                return b
            }
            b(f, a);
            var h = f.prototype;
            h.reset = function() {
                y.reset();
                a.prototype.reset.call(this)
            };
            h.render = function(a, b) {
                this.reset();
                !0;
                b && (this._time[0] += b, this._time[1] = b, this._time[2]++);
                this._device.setUniform("cc_time",
                    this._time);
                this._updateLights(a);
                b = this._device._gl.canvas;
                for (var c = 0; c < a._cameras.length; ++c) {
                    var d = this._requestView();
                    a._cameras.data[c].extractView(d, b.width, b.height)
                }
                this._viewPools.sort(k);
                for (b = 0; b < this._viewPools.length; ++b) this._render(this._viewPools.data[b], a)
            };
            h.renderCamera = function(a, b) {
                this.reset();
                this._updateLights(b);
                var c = this._device._gl.canvas,
                    d = c.width;
                c = c.height;
                var e = this._requestView();
                a.extractView(e, d, c);
                this._viewPools.sort(k);
                for (a = 0; a < this._viewPools.length; ++a) this._render(this._viewPools.data[a],
                    b)
            };
            h._updateLights = function(a) {
                this._lights.length = 0;
                this._shadowLights.length = 0;
                a = a._lights;
                for (var b = 0; b < a.length; ++b) {
                    var c = a.data[b];
                    c.update(this._device);
                    if (c.shadowType !== d["default"].SHADOW_NONE) {
                        2 > this._shadowLights.length && this._shadowLights.splice(0, 0, c);
                        var e = this._requestView();
                        c.extractView(e, ["shadowcast"]);
                        this._lights.splice(0, 0, c)
                    } else this._lights.push(c)
                }
                this._updateLightDefines();
                this._numLights = a._count
            };
            h._updateLightDefines = function() {
                for (var a = this._defines, b = 0; b < this._lights.length; ++b) {
                    var c =
                        this._lights[b];
                    a["CC_LIGHT_" + b + "_TYPE"] = c._type;
                    a["CC_SHADOW_" + b + "_TYPE"] = c._shadowType
                }
                a.CC_NUM_LIGHTS = Math.min(4, this._lights.length);
                a.CC_NUM_SHADOW_LIGHTS = Math.min(4, this._shadowLights.length)
            };
            h._submitLightsUniforms = function() {
                var a = this._device;
                if (0 < this._lights.length) {
                    for (var b = y.add(), c = y.add(), e = y.add(), g = Math.min(4, this._lights.length), f = 0; f < g; ++f) {
                        var l = this._lights[f],
                            h = 4 * f;
                        e.set(l._colorUniform, h);
                        c.set(l._directionUniform, h);
                        b.set(l._positionUniform, h);
                        b[h + 3] = l._range;
                        l._type === d["default"].LIGHT_SPOT ?
                            (c[h + 3] = l._spotUniform[0], e[h + 3] = l._spotUniform[1]) : (c[h + 3] = 0, e[h + 3] = 0)
                    }
                    a.setUniform("cc_lightDirection", c);
                    a.setUniform("cc_lightColor", e);
                    a.setUniform("cc_lightPositionAndRange", b)
                }
            };
            h._submitShadowStageUniforms = function(a) {
                var b = a._shadowLight;
                v[0] = b.shadowMinDepth;
                v[1] = b.shadowMaxDepth;
                v[2] = b.shadowDepthScale;
                v[3] = b.shadowDarkness;
                this._device.setUniform("cc_shadow_map_lightViewProjMatrix", c.Mat4.toArray(w, a._matViewProj));
                this._device.setUniform("cc_shadow_map_info", v);
                this._device.setUniform("cc_shadow_map_bias",
                    b.shadowBias);
                this._defines.CC_SHADOW_TYPE = b._shadowType
            };
            h._submitOtherStagesUniforms = function() {
                for (var a = y.add(), b = 0; b < this._shadowLights.length; ++b) {
                    var d = this._shadowLights[b],
                        e = u[b];
                    e || (e = u[b] = new Float32Array(p.buffer, 64 * b, 16));
                    c.Mat4.toArray(e, d.viewProjMatrix);
                    e = 4 * b;
                    a[e] = d.shadowMinDepth;
                    a[e + 1] = d.shadowMaxDepth;
                    a[e + 2] = d._shadowResolution;
                    a[e + 3] = d.shadowDarkness
                }
                this._device.setUniform("cc_shadow_lightViewProjMatrix", p);
                this._device.setUniform("cc_shadow_info", a)
            };
            h._sortItems = function(a) {
                a.sort(function(a,
                    b) {
                    return a.passes.length !== b.passes.length ? a.passes.length - b.passes.length : a.sortKey - b.sortKey
                })
            };
            h._shadowStage = function(a, b) {
                this._submitShadowStageUniforms(a);
                for (a = 0; a < b.length; ++a) {
                    var c = b.data[a];
                    c.effect.getDefine("CC_CASTING_SHADOW") && this._draw(c)
                }
            };
            h._drawItems = function(a, b) {
                a = this._shadowLights;
                if (0 === a.length && 0 === this._numLights)
                    for (a = 0; a < b.length; ++a) this._draw(b.data[a]);
                else
                    for (var c = 0; c < b.length; ++c) {
                        for (var d = b.data[c], e = 0; e < a.length; ++e) this._device.setTexture("cc_shadow_map_" +
                            e, a[e].shadowMap, this._allocTextureUnit());
                        this._draw(d)
                    }
            };
            h._opaqueStage = function(a, b) {
                a.getPosition(A);
                this._device.setUniform("cc_matView", c.Mat4.toArray(l, a._matView));
                this._device.setUniform("cc_matViewInv", c.Mat4.toArray(g, a._matViewInv));
                this._device.setUniform("cc_matProj", c.Mat4.toArray(n, a._matProj));
                this._device.setUniform("cc_matViewProj", c.Mat4.toArray(w, a._matViewProj));
                this._device.setUniform("cc_cameraPos", c.Vec4.toArray(t, A));
                this._submitLightsUniforms();
                this._submitOtherStagesUniforms();
                this._drawItems(a, b)
            };
            h._transparentStage = function(a, b) {
                a.getPosition(A);
                a.getForward(B);
                this._device.setUniform("cc_matView", c.Mat4.toArray(l, a._matView));
                this._device.setUniform("cc_matViewInv", c.Mat4.toArray(g, a._matViewInv));
                this._device.setUniform("cc_matProj", c.Mat4.toArray(n, a._matProj));
                this._device.setUniform("cc_matViewProj", c.Mat4.toArray(w, a._matViewProj));
                this._device.setUniform("cc_cameraPos", c.Vec4.toArray(t, A));
                this._submitLightsUniforms();
                this._submitOtherStagesUniforms();
                for (var d =
                        0; d < b.length; ++d) {
                    var e = b.data[d];
                    e.node.getWorldPosition(E);
                    c.Vec3.sub(E, E, A);
                    e.sortKey = -c.Vec3.dot(E, B)
                }
                this._sortItems(b);
                this._drawItems(a, b)
            };
            return f
        }(a["default"]);
        m["default"] = a;
        q.exports = m["default"]
    }, {
        "../../core/value-types": 301,
        "../core/base-renderer": 323,
        "../enums": 329,
        "../memop": 346
    }],
    354: [function(h, q, m) {
        function f(a, b) {
            for (var c = 0; c < b.length; c++) {
                var d = b[c];
                d.enumerable = d.enumerable || !1;
                d.configurable = !0;
                "value" in d && (d.writable = !0);
                Object.defineProperty(a, d.key, d)
            }
        }

        function e(a, b,
            c) {
            b && f(a.prototype, b);
            c && f(a, c);
            return a
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var b = h("../../core/value-types"),
            k = h("../../core/geom-utils"),
            c = function(a) {
                return a && a.__esModule ? a : {
                    default: a
                }
            }(h("../enums")),
            a = new b.Mat4,
            d = new b.Mat4,
            l = new b.Mat4,
            g = new b.Mat4,
            n = new b.Mat4,
            w = new b.Mat4,
            t = new b.Vec3,
            p = new b.Vec3;
        h = function() {
            function f() {
                this._poolID = -1;
                this._node = null;
                this._projection = c["default"].PROJ_PERSPECTIVE;
                this._priority = 0;
                this._color = new b.Vec4(.2, .3, .47, 1);
                this._depth = 1;
                this._stencil = 0;
                this._clearFlags =
                    c["default"].CLEAR_COLOR | c["default"].CLEAR_DEPTH;
                this._clearModel = null;
                this._stages = [];
                this._framebuffer = null;
                this._near = .01;
                this._far = 1E3;
                this._fov = Math.PI / 4;
                this._rect = {
                    x: 0,
                    y: 0,
                    w: 1,
                    h: 1
                };
                this._orthoHeight = 10;
                this._cullingMask = 4294967295
            }
            var h = f.prototype;
            h.setCullingMask = function(a) {
                this._cullingMask = a
            };
            h.getNode = function() {
                return this._node
            };
            h.setNode = function(a) {
                this._node = a
            };
            h.getType = function() {
                return this._projection
            };
            h.setType = function(a) {
                this._projection = a
            };
            h.getPriority = function() {
                return this._priority
            };
            h.setPriority = function(a) {
                this._priority = a
            };
            h.getOrthoHeight = function() {
                return this._orthoHeight
            };
            h.setOrthoHeight = function(a) {
                this._orthoHeight = a
            };
            h.getFov = function() {
                return this._fov
            };
            h.setFov = function(a) {
                this._fov = a
            };
            h.getNear = function() {
                return this._near
            };
            h.setNear = function(a) {
                this._near = a
            };
            h.getFar = function() {
                return this._far
            };
            h.setFar = function(a) {
                this._far = a
            };
            h.getColor = function(a) {
                return b.Vec4.copy(a, this._color)
            };
            h.setColor = function(a, c, d, e) {
                b.Vec4.set(this._color, a, c, d, e)
            };
            h.getDepth = function() {
                return this._depth
            };
            h.setDepth = function(a) {
                this._depth = a
            };
            h.getStencil = function() {
                return this._stencil
            };
            h.setStencil = function(a) {
                this._stencil = a
            };
            h.getClearFlags = function() {
                return this._clearFlags
            };
            h.setClearFlags = function(a) {
                this._clearFlags = a
            };
            h.getRect = function(a) {
                a.x = this._rect.x;
                a.y = this._rect.y;
                a.w = this._rect.w;
                a.h = this._rect.h;
                return a
            };
            h.setRect = function(a, b, c, d) {
                this._rect.x = a;
                this._rect.y = b;
                this._rect.w = c;
                this._rect.h = d
            };
            h.getStages = function() {
                return this._stages
            };
            h.setStages = function(a) {
                this._stages = a
            };
            h.getFramebuffer =
                function() {
                    return this._framebuffer
                };
            h.setFrameBuffer = function(a) {
                this._framebuffer = a
            };
            h._calcMatrices = function(a, e) {
                this._node.getWorldRT(l);
                b.Mat4.invert(d, l);
                a /= e;
                this._projection === c["default"].PROJ_PERSPECTIVE ? b.Mat4.perspective(g, this._fov, a, this._near, this._far) : (a *= this._orthoHeight, e = this._orthoHeight, b.Mat4.ortho(g, -a, a, -e, e, this._near, this._far));
                b.Mat4.mul(n, g, d);
                b.Mat4.invert(w, n)
            };
            h.extractView = function(a, c, e) {
                this._framebuffer && (c = this._framebuffer._width, e = this._framebuffer._height);
                a._priority = this._priority;
                a._rect.x = this._rect.x * c;
                a._rect.y = this._rect.y * e;
                a._rect.w = this._rect.w * c;
                a._rect.h = this._rect.h * e;
                this.getColor(a._color);
                a._depth = this._depth;
                a._stencil = this._stencil;
                a._clearFlags = this._clearFlags;
                a._clearModel = this._clearModel;
                a._stages = this._stages;
                a._framebuffer = this._framebuffer;
                this._calcMatrices(c, e);
                b.Mat4.copy(a._matView, d);
                b.Mat4.copy(a._matViewInv, l);
                b.Mat4.copy(a._matProj, g);
                b.Mat4.copy(a._matViewProj, n);
                b.Mat4.copy(a._matInvViewProj, w);
                a._cullingMask = this._cullingMask
            };
            h.screenPointToRay = function(a, d, e, g, f) {
                if (!cc.geomUtils) return f;
                f = f || new k.Ray;
                this._calcMatrices(e, g);
                var l = this._rect.x * e,
                    h = this._rect.y * g;
                e *= this._rect.w;
                g *= this._rect.h;
                b.Vec3.set(p, (a - l) / e * 2 - 1, (d - h) / g * 2 - 1, 1);
                b.Vec3.transformMat4(p, p, w);
                this._projection === c["default"].PROJ_PERSPECTIVE ? this._node.getWorldPosition(t) : (b.Vec3.set(t, (a - l) / e * 2 - 1, (d - h) / g * 2 - 1, -1), b.Vec3.transformMat4(t, t, w));
                return k.Ray.fromPoints(f, t, p)
            };
            h.screenToWorld = function(a, d, e, g) {
                this._calcMatrices(e, g);
                var f = this._rect.x *
                    e,
                    l = this._rect.y * g;
                e *= this._rect.w;
                g *= this._rect.h;
                this._projection === c["default"].PROJ_PERSPECTIVE ? (b.Vec3.set(a, (d.x - f) / e * 2 - 1, (d.y - l) / g * 2 - 1, .9999), b.Vec3.transformMat4(a, a, w), this._node.getWorldPosition(t), b.Vec3.lerp(a, t, a, (0, b.lerp)(this._near / this._far, 1, d.z))) : (b.Vec3.set(a, (d.x - f) / e * 2 - 1, (d.y - l) / g * 2 - 1, 2 * d.z - 1), b.Vec3.transformMat4(a, a, w));
                return a
            };
            h.worldToScreen = function(a, c, d, e) {
                this._calcMatrices(d, e);
                var g = this._rect.x * d,
                    f = this._rect.y * e;
                d *= this._rect.w;
                e *= this._rect.h;
                b.Vec3.transformMat4(a,
                    c, n);
                a.x = g + .5 * (a.x + 1) * d;
                a.y = f + .5 * (a.y + 1) * e;
                a.z = .5 * a.z + .5;
                return a
            };
            h.worldMatrixToScreen = function(c, d, e, g) {
                this._calcMatrices(e, g);
                b.Mat4.mul(c, n, d);
                d = e / 2;
                g /= 2;
                b.Mat4.identity(a);
                b.Mat4.transform(a, a, b.Vec3.set(t, d, g, 0));
                b.Mat4.scale(a, a, b.Vec3.set(t, d, g, 1));
                b.Mat4.mul(c, a, c);
                return c
            };
            e(f, [{
                key: "cullingMask",
                get: function() {
                    return this._cullingMask
                },
                set: function(a) {
                    this._cullingMask = a
                }
            }]);
            return f
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../../core/geom-utils": 159,
        "../../core/value-types": 301,
        "../enums": 329
    }],
    355: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }

        function e(a, b) {
            for (var c = 0; c < b.length; c++) {
                var d = b[c];
                d.enumerable = d.enumerable || !1;
                d.configurable = !0;
                "value" in d && (d.writable = !0);
                Object.defineProperty(a, d.key, d)
            }
        }

        function b(a, b, c) {
            b && e(a.prototype, b);
            c && e(a, c);
            return a
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var k = h("../../core/value-types"),
            c = f(h("../gfx")),
            a = f(h("../enums")),
            d = cc.v3(0, 0, -1),
            l = cc.mat4(),
            g = k.Mat3.create(),
            n = cc.v3(0, 0, 0);
        h = function() {
            function e() {
                this._poolID = -1;
                this._node = null;
                this._type = a["default"].LIGHT_DIRECTIONAL;
                this._color = new k.Vec3(1, 1, 1);
                this._range = this._intensity = 1;
                this._spotAngle = (0, k.toRadian)(60);
                this._spotExp = 1;
                this._directionUniform = new Float32Array(3);
                this._positionUniform = new Float32Array(3);
                this._colorUniform = new Float32Array([this._color.x * this._intensity, this._color.y * this._intensity, this._color.z * this._intensity]);
                this._spotUniform = new Float32Array([Math.cos(.5 * this._spotAngle), this._spotExp]);
                this._shadowType = a["default"].SHADOW_NONE;
                this._shadowMap = this._shadowFrameBuffer = null;
                this._shadowMapDirty = !1;
                this._shadowDepthBuffer = null;
                this._shadowResolution = 1024;
                this._shadowBias = 5E-4;
                this._shadowMinDepth = this._shadowDarkness = 1;
                this._shadowMaxDepth = 1E3;
                this._frustumEdgeFalloff = 0;
                this._viewProjMatrix = cc.mat4();
                this._spotAngleScale = 1;
                this._shadowFrustumSize = 50
            }
            var f = e.prototype;
            f.getNode = function() {
                return this._node
            };
            f.setNode = function(a) {
                this._node = a
            };
            f.setColor = function(a, b, c) {
                k.Vec3.set(this._color, a, b, c);
                this._colorUniform[0] = a * this._intensity;
                this._colorUniform[1] = b * this._intensity;
                this._colorUniform[2] = c * this._intensity
            };
            f.setIntensity = function(a) {
                this._intensity = a;
                this._colorUniform[0] = a * this._color.x;
                this._colorUniform[1] = a * this._color.y;
                this._colorUniform[2] = a * this._color.z
            };
            f.setType = function(a) {
                this._type = a
            };
            f.setSpotAngle = function(a) {
                this._spotAngle = a;
                this._spotUniform[0] = Math.cos(.5 * this._spotAngle)
            };
            f.setSpotExp = function(a) {
                this._spotExp = a;
                this._spotUniform[1] = a
            };
            f.setRange = function(a) {
                this._range = a
            };
            f.setShadowType = function(b) {
                this._shadowType ===
                    a["default"].SHADOW_NONE && b !== a["default"].SHADOW_NONE && (this._shadowMapDirty = !0);
                this._shadowType = b
            };
            f.setShadowResolution = function(a) {
                this._shadowResolution !== a && (this._shadowMapDirty = !0);
                this._shadowResolution = a
            };
            f.setShadowBias = function(a) {
                this._shadowBias = a
            };
            f.setShadowDarkness = function(a) {
                this._shadowDarkness = a
            };
            f.setShadowMinDepth = function(a) {
                this._shadowMinDepth = a
            };
            f.setShadowMaxDepth = function(a) {
                this._shadowMaxDepth = a
            };
            f.setFrustumEdgeFalloff = function(a) {
                this._frustumEdgeFalloff = a
            };
            f.setShadowFrustumSize =
                function(a) {
                    this._shadowFrustumSize = a
                };
            f.extractView = function(b, c) {
                b._shadowLight = this;
                b._priority = -1;
                b._rect.x = 0;
                b._rect.y = 0;
                b._rect.w = this._shadowResolution;
                b._rect.h = this._shadowResolution;
                k.Vec3.set(b._color, 1, 1, 1);
                b._depth = 1;
                b._stencil = 1;
                b._clearFlags = a["default"].CLEAR_COLOR | a["default"].CLEAR_DEPTH;
                b._stages = c;
                b._framebuffer = this._shadowFrameBuffer;
                switch (this._type) {
                    case a["default"].LIGHT_SPOT:
                        c = b._matView;
                        var d = b._matProj;
                        this._node.getWorldRT(c);
                        k.Mat4.invert(c, c);
                        k.Mat4.perspective(d,
                            this._spotAngle * this._spotAngleScale, 1, this._shadowMinDepth, this._shadowMaxDepth);
                        break;
                    case a["default"].LIGHT_DIRECTIONAL:
                        d = b._matView;
                        c = b._matProj;
                        this._node.getWorldRT(d);
                        k.Mat4.invert(d, d);
                        d = this._shadowFrustumSize / 2;
                        k.Mat4.ortho(c, -d, d, -d, d, this._shadowMinDepth, this._shadowMaxDepth);
                        break;
                    case a["default"].LIGHT_POINT:
                        c = b._matView;
                        d = b._matProj;
                        this._node.getWorldRT(c);
                        k.Mat4.invert(c, c);
                        k.Mat4.perspective(d, (0, k.toRadian)(179), 1, this._shadowMinDepth, this._shadowMaxDepth);
                        break;
                    case a["default"].LIGHT_AMBIENT:
                        break;
                    default:
                        console.warn("shadow of this light type is not supported")
                }
                k.Mat4.mul(b._matViewProj, b._matProj, b._matView);
                this._viewProjMatrix = b._matViewProj;
                k.Mat4.invert(b._matInvViewProj, b._matViewProj);
                b._cullingMask = 4294967295
            };
            f._updateLightPositionAndDirection = function() {
                this._node.getWorldMatrix(l);
                k.Mat3.fromMat4(g, l);
                k.Vec3.transformMat3(n, d, g);
                k.Vec3.toArray(this._directionUniform, n);
                var a = this._positionUniform,
                    b = l.m;
                a[0] = b[12];
                a[1] = b[13];
                a[2] = b[14]
            };
            f._generateShadowMap = function(a) {
                this._shadowMap =
                    new c["default"].Texture2D(a, {
                        width: this._shadowResolution,
                        height: this._shadowResolution,
                        format: c["default"].TEXTURE_FMT_RGBA8,
                        wrapS: c["default"].WRAP_CLAMP,
                        wrapT: c["default"].WRAP_CLAMP
                    });
                this._shadowDepthBuffer = new c["default"].RenderBuffer(a, c["default"].RB_FMT_D16, this._shadowResolution, this._shadowResolution);
                this._shadowFrameBuffer = new c["default"].FrameBuffer(a, this._shadowResolution, this._shadowResolution, {
                    colors: [this._shadowMap],
                    depth: this._shadowDepthBuffer
                })
            };
            f._destroyShadowMap = function() {
                this._shadowMap &&
                    (this._shadowMap.destroy(), this._shadowDepthBuffer.destroy(), this._shadowFrameBuffer.destroy(), this._shadowFrameBuffer = this._shadowDepthBuffer = this._shadowMap = null)
            };
            f.update = function(b) {
                this._updateLightPositionAndDirection();
                this._shadowType === a["default"].SHADOW_NONE ? this._destroyShadowMap() : this._shadowMapDirty && (this._destroyShadowMap(), this._generateShadowMap(b), this._shadowMapDirty = !1)
            };
            b(e, [{
                    key: "color",
                    get: function() {
                        return this._color
                    }
                }, {
                    key: "intensity",
                    get: function() {
                        return this._intensity
                    }
                },
                {
                    key: "type",
                    get: function() {
                        return this._type
                    }
                }, {
                    key: "spotAngle",
                    get: function() {
                        return this._spotAngle
                    }
                }, {
                    key: "spotExp",
                    get: function() {
                        return this._spotExp
                    }
                }, {
                    key: "range",
                    get: function() {
                        return this._range
                    }
                }, {
                    key: "shadowType",
                    get: function() {
                        return this._shadowType
                    }
                }, {
                    key: "shadowMap",
                    get: function() {
                        return this._shadowMap
                    }
                }, {
                    key: "viewProjMatrix",
                    get: function() {
                        return this._viewProjMatrix
                    }
                }, {
                    key: "shadowResolution",
                    get: function() {
                        return this._shadowResolution
                    }
                }, {
                    key: "shadowBias",
                    get: function() {
                        return this._shadowBias
                    }
                },
                {
                    key: "shadowDarkness",
                    get: function() {
                        return this._shadowDarkness
                    }
                }, {
                    key: "shadowMinDepth",
                    get: function() {
                        return this._type === a["default"].LIGHT_DIRECTIONAL ? 1 : this._shadowMinDepth
                    }
                }, {
                    key: "shadowMaxDepth",
                    get: function() {
                        return this._type === a["default"].LIGHT_DIRECTIONAL ? 1 : this._shadowMaxDepth
                    }
                }, {
                    key: "frustumEdgeFalloff",
                    get: function() {
                        return this._frustumEdgeFalloff
                    }
                }, {
                    key: "shadowFrustumSize",
                    get: function() {
                        return this._shadowFrustumSize
                    }
                }
            ]);
            return e
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../../core/value-types": 301,
        "../enums": 329,
        "../gfx": 334
    }],
    356: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        h = function() {
            function f() {
                this._type = "default";
                this._poolID = -1;
                this._effect = this._inputAssembler = this._node = null;
                this._userKey = this._cameraID = this._viewID = -1;
                this._castShadow = !1;
                this._boundingShape = null
            }
            var e = f.prototype;
            e.setNode = function(b) {
                this._node = b
            };
            e.setInputAssembler = function(b) {
                this._inputAssembler = b
            };
            e.setEffect = function(b) {
                this._effect = b
            };
            e.setUserKey = function(b) {
                this._userKey = b
            };
            e.extractDrawItem = function(b) {
                b.model =
                    this;
                b.node = this._node;
                b.ia = this._inputAssembler;
                b.effect = this._effect
            };
            return f
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {}],
    357: [function(h, q, m) {
        m.__esModule = !0;
        m["default"] = void 0;
        var f = h("../memop");
        h = function() {
            function e(b) {
                this._lights = new f.FixedArray(16);
                this._models = new f.FixedArray(16);
                this._cameras = new f.FixedArray(16);
                this._debugCamera = null;
                this._app = b;
                this._views = []
            }
            var b = e.prototype;
            b._add = function(b, c) {
                -1 === c._poolID && (b.push(c), c._poolID = b.length - 1)
            };
            b._remove = function(b, c) {
                -1 !==
                    c._poolID && (b.data[b.length - 1]._poolID = c._poolID, b.fastRemove(c._poolID), c._poolID = -1)
            };
            b.reset = function() {
                for (var b = 0; b < this._models.length; ++b) this._models.data[b]._viewID = -1
            };
            b.setDebugCamera = function(b) {
                this._debugCamera = b
            };
            b.getCameraCount = function() {
                return this._cameras.length
            };
            b.getCamera = function(b) {
                return this._cameras.data[b]
            };
            b.addCamera = function(b) {
                this._add(this._cameras, b)
            };
            b.removeCamera = function(b) {
                this._remove(this._cameras, b)
            };
            b.getModelCount = function() {
                return this._models.length
            };
            b.getModel = function(b) {
                return this._models.data[b]
            };
            b.addModel = function(b) {
                this._add(this._models, b)
            };
            b.removeModel = function(b) {
                this._remove(this._models, b)
            };
            b.getLightCount = function() {
                return this._lights.length
            };
            b.getLight = function(b) {
                return this._lights.data[b]
            };
            b.addLight = function(b) {
                this._add(this._lights, b)
            };
            b.removeLight = function(b) {
                this._remove(this._lights, b)
            };
            b.addView = function(b) {
                -1 === this._views.indexOf(b) && this._views.push(b)
            };
            b.removeView = function(b) {
                b = this._views.indexOf(b); - 1 !== b &&
                    this._views.splice(b, 1)
            };
            return e
        }();
        m["default"] = h;
        q.exports = m["default"]
    }, {
        "../memop": 346
    }],
    358: [function(h, q, m) {
        function f(a) {
            return a && a.__esModule ? a : {
                default: a
            }
        }
        m.__esModule = !0;
        m.getInspectorProps = function(a) {
            var b = {
                type: a.type
            };
            Object.assign(b, a.editor || a.inspector);
            b.defines = a.defines;
            b.value = t(b.type)(a.value);
            a.range && (b.range = a.range);
            a = p(b.type);
            b.typeName = u[a] || a;
            b.valueCtor = n[b.type];
            "cc.Texture2D" == b.typeName && (b.typeName = "cc.Asset", b.assetType = "cc.Texture2D");
            return b
        };
        m.getClassName =
            m.getInstanceCtor = m.getInstanceType = m.enums2default = m.ctor2enums = void 0;
        q = f(h("./enums"));
        var e = h("../core/value-types"),
            b = f(h("../core/assets/CCTexture2D")),
            k, c, a, d, l = null;
        !1;
        l = h("./gfx/texture-2d");
        h = cc.Object;
        var g = (k = {}, k[Boolean] = function(a) {
                return a || !1
            }, k[Number] = function(a) {
                return a ? ArrayBuffer.isView(a) ? a[0] : a : 0
            }, k[e.Vec2] = function(a) {
                return a ? cc.v2(a[0], a[1]) : cc.v2()
            }, k[e.Vec3] = function(a) {
                return a ? cc.v3(a[0], a[1], a[2]) : cc.v3()
            }, k[e.Vec4] = function(a) {
                return a ? cc.v4(a[0], a[1], a[2], a[3]) :
                    cc.v4()
            }, k[e.Color] = function(a) {
                return a ? cc.color(255 * a[0], 255 * a[1], 255 * a[2], 255 * (a[3] || 1)) : cc.color()
            }, k[e.Mat4] = function(a) {
                return a ? cc.mat4(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]) : cc.mat4()
            }, k[b["default"]] = function() {
                return null
            }, k[h] = function() {
                return null
            }, k),
            n = (c = {}, c[q["default"].PARAM_INT] = Number, c[q["default"].PARAM_INT2] = e.Vec2, c[q["default"].PARAM_INT3] = e.Vec3, c[q["default"].PARAM_INT4] = e.Vec4, c[q["default"].PARAM_FLOAT] = Number, c[q["default"].PARAM_FLOAT2] =
                e.Vec2, c[q["default"].PARAM_FLOAT3] = e.Vec3, c[q["default"].PARAM_FLOAT4] = e.Vec4, c[q["default"].PARAM_MAT4] = e.Mat4, c[q["default"].PARAM_TEXTURE_2D] = b["default"], c.color = e.Color, c.number = Number, c["boolean"] = Boolean, c["default"] = h, c);
        k = (a = {}, a[Number] = q["default"].PARAM_FLOAT, a[e.Vec2] = q["default"].PARAM_FLOAT2, a[e.Vec3] = q["default"].PARAM_FLOAT3, a[e.Vec4] = q["default"].PARAM_FLOAT4, a[e.Color] = q["default"].PARAM_COLOR3, a[e.Color] = q["default"].PARAM_COLOR4, a[e.Mat4] = q["default"].PARAM_MAT4, a[b["default"]] =
            q["default"].PARAM_TEXTURE_2D, a[l] = q["default"].PARAM_TEXTURE_2D, a);
        m.ctor2enums = k;
        a = (d = {}, d[q["default"].PARAM_INT] = new Uint32Array([0]), d[q["default"].PARAM_INT2] = new Uint32Array([0, 0]), d[q["default"].PARAM_INT3] = new Uint32Array([0, 0, 0]), d[q["default"].PARAM_INT4] = new Uint32Array([0, 0, 0, 0]), d[q["default"].PARAM_FLOAT] = new Float32Array([0]), d[q["default"].PARAM_FLOAT2] = new Float32Array([0, 0]), d[q["default"].PARAM_FLOAT3] = new Float32Array([0, 0, 0]), d[q["default"].PARAM_FLOAT4] = new Float32Array([0,
            0, 0, 0
        ]), d[q["default"].PARAM_MAT4] = cc.mat4().m, d[q["default"].PARAM_TEXTURE_2D] = null, d.number = 0, d["boolean"] = !1, d);
        m.enums2default = a;
        var w = function(a) {
            return n[a] || n["default"]
        };
        m.getInstanceType = w;
        var t = function(a) {
            return g[w(a)]
        };
        m.getInstanceCtor = t;
        var p = function(a) {
            return cc.js.getClassName(w(a))
        };
        m.getClassName = p;
        var u = {
            Number: "number",
            Boolean: "boolean"
        }
    }, {
        "../core/assets/CCTexture2D": 88,
        "../core/value-types": 301,
        "./enums": 329,
        "./gfx/texture-2d": 339
    }],
    359: [function(h, q, m) {
        h = cc.Class({
            name: "cc.TiledMapAsset",
            extends: cc.Asset,
            properties: {
                tmxXmlStr: "",
                textures: {
                    default: [],
                    type: [cc.Texture2D]
                },
                textureNames: [cc.String],
                textureSizes: {
                    default: [],
                    type: [cc.Size]
                },
                imageLayerTextures: {
                    default: [],
                    type: [cc.Texture2D]
                },
                imageLayerTextureNames: [cc.String],
                tsxFiles: [cc.TextAsset],
                tsxFileNames: [cc.String]
            },
            statics: {
                preventDeferredLoadDependents: !0
            },
            createNode: !1
        });
        cc.TiledMapAsset = h;
        q.exports = h
    }, {}],
    360: [function(h, q, m) {
        function f() {}
        h = h("./webview-impl");
        var e = h.EventType,
            b = cc.Class({
                name: "cc.WebView",
                extends: cc.Component,
                editor: !1,
                properties: {
                    _url: "",
                    url: {
                        type: cc.String,
                        tooltip: !1,
                        get: function() {
                            return this._url
                        },
                        set: function(b) {
                            this._url = b;
                            var c = this._impl;
                            c && c.loadURL(b)
                        }
                    },
                    webviewEvents: {
                        default: [],
                        type: cc.Component.EventHandler
                    }
                },
                statics: {
                    EventType: e,
                    Impl: h
                },
                ctor: function() {
                    this._impl = new b.Impl
                },
                onRestore: function() {
                    this._impl || (this._impl = new b.Impl)
                },
                onEnable: function() {
                    var b = this._impl;
                    b.createDomElementIfNeeded(this.node.width, this.node.height);
                    !0;
                    b.setEventListener(e.LOADED, this._onWebViewLoaded.bind(this));
                    b.setEventListener(e.LOADING, this._onWebViewLoading.bind(this));
                    b.setEventListener(e.ERROR, this._onWebViewLoadError.bind(this));
                    b.loadURL(this._url);
                    b.setVisible(!0)
                },
                onDisable: function() {
                    var b = this._impl;
                    b.setVisible(!1);
                    !0;
                    b.setEventListener(e.LOADED, f);
                    b.setEventListener(e.LOADING, f);
                    b.setEventListener(e.ERROR, f)
                },
                onDestroy: function() {
                    this._impl && (this._impl.destroy(), this._impl = null)
                },
                update: function(b) {
                    this._impl && this._impl.updateMatrix(this.node)
                },
                _onWebViewLoaded: function() {
                    cc.Component.EventHandler.emitEvents(this.webviewEvents,
                        this, e.LOADED);
                    this.node.emit("loaded", this)
                },
                _onWebViewLoading: function() {
                    cc.Component.EventHandler.emitEvents(this.webviewEvents, this, e.LOADING);
                    this.node.emit("loading", this);
                    return !0
                },
                _onWebViewLoadError: function() {
                    cc.Component.EventHandler.emitEvents(this.webviewEvents, this, e.ERROR);
                    this.node.emit("error", this)
                },
                setJavascriptInterfaceScheme: function(b) {
                    this._impl && this._impl.setJavascriptInterfaceScheme(b)
                },
                setOnJSCallback: function(b) {
                    this._impl && this._impl.setOnJSCallback(b)
                },
                evaluateJS: function(b) {
                    this._impl &&
                        this._impl.evaluateJS(b)
                }
            });
        cc.WebView = q.exports = b
    }, {
        "./webview-impl": 361
    }],
    361: [function(h, q, m) {
        var f = h("../core/platform/utils");
        h = h("../core/platform/CCSys");
        var e = cc.mat4(),
            b = cc.Class({
                name: "WebViewImpl",
                ctor: function() {
                    this._EventList = {};
                    this._visible = !1;
                    this._listener = this._iframe = this._div = this._parent = null;
                    this._forceUpdate = !1;
                    this._h = this._w = this._m13 = this._m12 = this._m05 = this._m04 = this._m01 = this._m00 = 0;
                    this.__eventListeners = {}
                },
                _updateVisibility: function() {
                    if (this._div) {
                        var b = this._div;
                        this._visible ?
                            b.style.visibility = "visible" : b.style.visibility = "hidden"
                    }
                },
                _updateSize: function(b, c) {
                    var a = this._div;
                    a && (a.style.width = b + "px", a.style.height = c + "px")
                },
                _initEvent: function() {
                    var e = this._iframe;
                    if (e) {
                        var c = this.__eventListeners,
                            a = this;
                        c.load = function() {
                            a._forceUpdate = !0;
                            a._dispatchEvent(b.EventType.LOADED)
                        };
                        c.error = function() {
                            a._dispatchEvent(b.EventType.ERROR)
                        };
                        e.addEventListener("load", c.load);
                        e.addEventListener("error", c.error)
                    }
                },
                _initStyle: function() {
                    if (this._div) {
                        var b = this._div;
                        b.style.position =
                            "absolute";
                        b.style.bottom = "0px";
                        b.style.left = "0px"
                    }
                },
                _setOpacity: function(b) {
                    var c = this._iframe;
                    c && c.style && (c.style.opacity = b / 255)
                },
                _createDom: function(e, c) {
                    b._polyfill.enableDiv ? (this._div = document.createElement("div"), this._div.style["-webkit-overflow"] = "auto", this._div.style["-webkit-overflow-scrolling"] = "touch", this._iframe = document.createElement("iframe"), this._div.appendChild(this._iframe), this._iframe.style.width = "100%", this._iframe.style.height = "100%") : this._div = this._iframe = document.createElement("iframe");
                    b._polyfill.enableBG && (this._div.style.background = "rgba(0, 0, 0, 0.5)");
                    this._div.style.background = "rgba(0, 0, 0, 0.5)";
                    this._div.style.height = c + "px";
                    this._div.style.width = e + "px";
                    this._div.style.overflow = "scroll";
                    this._iframe.style.border = "0";
                    cc.game.container.appendChild(this._div);
                    this._updateVisibility()
                },
                _createNativeControl: function(b, c) {
                    this._createDom(b, c);
                    this._initStyle();
                    this._initEvent()
                },
                createDomElementIfNeeded: function(b, c) {
                    this._div ? this._updateSize(b, c) : this._createNativeControl(b,
                        c)
                },
                removeDom: function() {
                    var b = this._div;
                    b && (f.contains(cc.game.container, b) && cc.game.container.removeChild(b), this._div = null);
                    if (b = this._iframe) {
                        var c = this.__eventListeners;
                        b.removeEventListener("load", c.load);
                        b.removeEventListener("error", c.error);
                        c.load = null;
                        this._iframe = c.error = null
                    }
                },
                setOnJSCallback: function(b) {},
                setJavascriptInterfaceScheme: function(b) {},
                loadData: function(b, c, a, d) {},
                loadHTMLString: function(b, c) {},
                loadURL: function(e) {
                    var c = this._iframe;
                    if (c) {
                        c.src = e;
                        var a = this;
                        c.addEventListener("load",
                            function l() {
                                a._loaded = !0;
                                a._updateVisibility();
                                c.removeEventListener("load", l)
                            });
                        this._dispatchEvent(b.EventType.LOADING)
                    }
                },
                stopLoading: function() {
                    cc.logID(7800)
                },
                reload: function() {
                    var b = this._iframe;
                    b && (b = b.contentWindow) && b.location && b.location.reload()
                },
                canGoBack: function() {
                    cc.logID(7801);
                    return !0
                },
                canGoForward: function() {
                    cc.logID(7802);
                    return !0
                },
                goBack: function() {
                    try {
                        if (b._polyfill.closeHistory) return cc.logID(7803);
                        var e = this._iframe;
                        if (e) {
                            var c = e.contentWindow;
                            c && c.location && c.history.back.call(c)
                        }
                    } catch (a) {
                        cc.log(a)
                    }
                },
                goForward: function() {
                    try {
                        if (b._polyfill.closeHistory) return cc.logID(7804);
                        var e = this._iframe;
                        if (e) {
                            var c = e.contentWindow;
                            c && c.location && c.history.forward.call(c)
                        }
                    } catch (a) {
                        cc.log(a)
                    }
                },
                evaluateJS: function(e) {
                    var c = this._iframe;
                    if (c) {
                        c = c.contentWindow;
                        try {
                            c.eval(e), this._dispatchEvent(b.EventType.JS_EVALUATED)
                        } catch (a) {
                            console.error(a)
                        }
                    }
                },
                setScalesPageToFit: function() {
                    cc.logID(7805)
                },
                setEventListener: function(b, c) {
                    this._EventList[b] = c
                },
                removeEventListener: function(b) {
                    this._EventList[b] = null
                },
                _dispatchEvent: function(b) {
                    (b =
                        this._EventList[b]) && b.call(this, this, this._iframe.src)
                },
                _createRenderCmd: function() {
                    return new b.RenderCmd(this)
                },
                destroy: function() {
                    this.removeDom()
                },
                setVisible: function(b) {
                    this._visible !== b && (this._visible = !!b, this._updateVisibility())
                },
                updateMatrix: function(b) {
                    if (this._div && this._visible) {
                        b.getWorldMatrix(e);
                        var c = cc.Camera._findRendererCamera(b);
                        c && c.worldMatrixToScreen(e, e, cc.game.canvas.width, cc.game.canvas.height);
                        c = e.m;
                        if (this._forceUpdate || this._m00 !== c[0] || this._m01 !== c[1] || this._m04 !==
                            c[4] || this._m05 !== c[5] || this._m12 !== c[12] || this._m13 !== c[13] || this._w !== b._contentSize.width || this._h !== b._contentSize.height) {
                            this._m00 = c[0];
                            this._m01 = c[1];
                            this._m04 = c[4];
                            this._m05 = c[5];
                            this._m12 = c[12];
                            this._m13 = c[13];
                            this._w = b._contentSize.width;
                            this._h = b._contentSize.height;
                            var a = cc.view._devicePixelRatio,
                                d = 1 / a;
                            a = 1 / a;
                            var f = cc.game.container,
                                g = c[0] * d,
                                h = c[1],
                                k = c[4],
                                m = c[5] * a,
                                p = f && f.style.paddingLeft ? parseInt(f.style.paddingLeft) : 0;
                            f = f && f.style.paddingBottom ? parseInt(f.style.paddingBottom) : 0;
                            this._updateSize(this._w,
                                this._h);
                            c = "matrix(" + g + "," + -h + "," + -k + "," + m + "," + (c[12] * d - this._w * d * c[0] * b._anchorPoint.x + p) + "," + -(c[13] * a - this._h * a * c[5] * b._anchorPoint.y + f) + ")";
                            this._div.style.transform = c;
                            this._div.style["-webkit-transform"] = c;
                            this._div.style["transform-origin"] = "0px 100% 0px";
                            this._div.style["-webkit-transform-origin"] = "0px 100% 0px";
                            this._setOpacity(b.opacity);
                            this._forceUpdate = !1
                        }
                    }
                }
            });
        b.EventType = {
            LOADING: 0,
            LOADED: 1,
            ERROR: 2,
            JS_EVALUATED: 3
        };
        m = b._polyfill = {
            devicePixelRatio: !1,
            enableDiv: !1
        };
        h.os === h.OS_IOS && (m.enableDiv = !0);
        h.isMobile ? h.browserType === h.BROWSER_TYPE_FIREFOX && (m.enableBG = !0) : h.browserType === h.BROWSER_TYPE_IE && (m.closeHistory = !0);
        q.exports = b
    }, {
        "../core/platform/CCSys": 213,
        "../core/platform/utils": 228
    }],
    362: [function(h, q, m) {
        h("./cocos2d/core");
        h("./cocos2d/animation");
        !1;
        h("./cocos2d/particle");
        h("./cocos2d/tilemap");
        h("./cocos2d/videoplayer/CCVideoPlayer");
        h("./cocos2d/webview/CCWebView");
        h("./cocos2d/core/components/CCStudioComponent");
        h("./extensions/ccpool/CCNodePool");
        h("./cocos2d/actions");
        h("./extensions/spine");
        h("./extensions/dragonbones");
        !0;
        h("./cocos2d/deprecated")
    }, {
        "./cocos2d/actions": 8,
        "./cocos2d/animation": 17,
        "./cocos2d/core": 171,
        "./cocos2d/core/components/CCStudioComponent": void 0,
        "./cocos2d/deprecated": 313,
        "./cocos2d/particle": 319,
        "./cocos2d/particle/CCParticleAsset": 316,
        "./cocos2d/tilemap": void 0,
        "./cocos2d/tilemap/CCTiledMapAsset": 359,
        "./cocos2d/videoplayer/CCVideoPlayer": void 0,
        "./cocos2d/webview/CCWebView": 360,
        "./extensions/ccpool/CCNodePool": 363,
        "./extensions/dragonbones": void 0,
        "./extensions/spine": 366
    }],
    363: [function(h, q, m) {
        cc.NodePool = function(f) {
            this.poolHandlerComp = f;
            this._pool = []
        };
        cc.NodePool.prototype = {
            constructor: cc.NodePool,
            size: function() {
                return this._pool.length
            },
            clear: function() {
                for (var f = this._pool.length, e = 0; e < f; ++e) this._pool[e].destroy();
                this._pool.length = 0
            },
            put: function(f) {
                if (f && -1 === this._pool.indexOf(f)) {
                    f.removeFromParent(!1);
                    var e = this.poolHandlerComp ? f.getComponent(this.poolHandlerComp) : null;
                    e && e.unuse && e.unuse();
                    this._pool.push(f)
                }
            },
            get: function() {
                var f = this._pool.length - 1;
                if (0 >
                    f) return null;
                var e = this._pool[f];
                this._pool.length = f;
                (f = this.poolHandlerComp ? e.getComponent(this.poolHandlerComp) : null) && f.reuse && f.reuse.apply(f, arguments);
                return e
            }
        };
        q.exports = cc.NodePool
    }, {}],
    364: [function(h, q, m) {
        var f = function(a) {
                return a && a.__esModule ? a : {
                    default: a
                }
            }(h("../../cocos2d/core/value-types/mat4")),
            e = h("../../cocos2d/core/renderer/render-flow").FLAG_TRANSFORM,
            b = function() {},
            k = function(a) {
                Object.defineProperty(a, "_worldMatDirty", {
                    get: function() {
                        return !0
                    },
                    set: function(a) {}
                });
                a._calculWorldMatrix =
                    b;
                a._mulMat = b
            },
            c = new f["default"];
        h = cc.Class({
            name: "sp.AttachUtil",
            ctor: function() {
                this._inited = !1;
                this._attachedRootNode = this._skeletonComp = this._skeletonNode = this._skeleton = null;
                this._attachedNodeArray = [];
                this._boneIndexToNode = {}
            },
            init: function(a) {
                this._inited = !0;
                this._skeleton = a._skeleton;
                this._skeletonNode = a.node;
                this._skeletonComp = a
            },
            reset: function() {
                this._inited = !1;
                this._skeletonComp = this._skeletonNode = this._skeleton = null
            },
            _prepareAttachNode: function() {
                if (this._skeleton) {
                    var a = this._skeletonNode.getChildByName("ATTACHED_NODE_TREE");
                    a && a.isValid || (a = new cc.Node("ATTACHED_NODE_TREE"), k(a), this._skeletonNode.addChild(a));
                    this._skeletonComp.isAnimationCached() && this._skeletonComp._frameCache && this._skeletonComp._frameCache.enableCacheAttachedInfo();
                    return this._attachedRootNode = a
                }
            },
            _buildBoneAttachedNode: function(a, b) {
                var c = new cc.Node("ATTACHED_NODE:" + a.data.name);
                this._buildBoneRelation(c, a, b);
                return c
            },
            _buildBoneRelation: function(a, b, c) {
                k(a);
                a._bone = b;
                a._boneIndex = c;
                this._attachedNodeArray.push(a);
                this._boneIndexToNode[c] = a
            },
            getAttachedRootNode: function() {
                return this._attachedRootNode
            },
            getAttachedNodes: function(a) {
                var b = this._attachedNodeArray,
                    c = [];
                if (!this._inited) return c;
                for (var e = 0, f = b.length; e < f; e++) {
                    var h = b[e];
                    h && h.isValid && h.name === "ATTACHED_NODE:" + a && c.push(h)
                }
                return c
            },
            _rebuildNodeArray: function() {
                for (var a = this._boneIndexToNode = {}, b = this._attachedNodeArray, c = this._attachedNodeArray = [], e = 0, f = b.length; e < f; e++) {
                    var h = b[e];
                    h && h.isValid && !h._toRemove && (c.push(h), a[h._boneIndex] = h)
                }
            },
            _sortNodeArray: function() {
                this._attachedNodeArray.sort(function(a,
                    b) {
                    return a._boneIndex < b._boneIndex ? -1 : 1
                })
            },
            _getNodeByBoneIndex: function(a) {
                return (a = this._boneIndexToNode[a]) && a.isValid ? a : null
            },
            destroyAttachedNodes: function(a) {
                if (this._inited) {
                    for (var b = this._attachedNodeArray, c = function p(a) {
                            for (var b = a.children, c = 0, d = b.length; c < d; c++) {
                                var e = b[c];
                                e && p(e)
                            }
                            a._toRemove = !0
                        }, e = 0, f = b.length; e < f; e++) {
                        var h = b[e];
                        h && h.isValid && h.name.split("ATTACHED_NODE:")[1] === a && (c(h), h.removeFromParent(!0), h.destroy(), b[e] = null)
                    }
                    this._rebuildNodeArray()
                }
            },
            generateAttachedNodes: function(a) {
                var b = [];
                if (!this._inited) return b;
                var c = this._prepareAttachNode();
                if (!c) return b;
                for (var e = [], f = this._skeleton.bones, h = 0, k = f.length; h < k; h++) {
                    var p = f[h];
                    p.data.name == a && e.push(p)
                }
                var m = function(a) {
                    if (a) {
                        var b = a.data,
                            d = this._getNodeByBoneIndex(b.index);
                        if (d) return d;
                        d = this._buildBoneAttachedNode(a, b.index);
                        a = m(a.parent) || c;
                        d.parent = a;
                        return d
                    }
                }.bind(this);
                a = 0;
                for (f = e.length; a < f; a++) h = m(e[a]), b.push(h);
                this._sortNodeArray();
                return b
            },
            destroyAllAttachedNodes: function() {
                this._attachedRootNode = null;
                this._attachedNodeArray.length =
                    0;
                this._boneIndexToNode = {};
                if (this._inited) {
                    var a = this._skeletonNode.getChildByName("ATTACHED_NODE_TREE");
                    a && (a.removeFromParent(!0), a.destroy())
                }
            },
            generateAllAttachedNodes: function() {
                if (this._inited) {
                    this._boneIndexToNode = {};
                    this._attachedNodeArray.length = 0;
                    var a = this._prepareAttachNode();
                    if (a) {
                        for (var b = this._skeleton.bones, c = 0, e = b.length; c < e; c++) {
                            var f = b[c],
                                h = f.data,
                                k;
                            if (k = f.parent ? this._boneIndexToNode[f.parent.data.index] : a) {
                                var p = k.getChildByName("ATTACHED_NODE:" + h.name);
                                p && p.isValid ? this._buildBoneRelation(p,
                                    f, h.index) : (p = this._buildBoneAttachedNode(f, h.index), k.addChild(p))
                            }
                        }
                        return a
                    }
                }
            },
            _hasAttachedNode: function() {
                return this._inited ? !!this._skeletonNode.getChildByName("ATTACHED_NODE_TREE") : !1
            },
            _associateAttachedNode: function() {
                if (this._inited) {
                    var a = this._skeletonNode.getChildByName("ATTACHED_NODE_TREE");
                    if (a && a.isValid) {
                        this._attachedRootNode = a;
                        this._boneIndexToNode = {};
                        this._attachedNodeArray.length = 0;
                        k(a);
                        !0;
                        this._skeletonComp.isAnimationCached() && this._skeletonComp._frameCache && this._skeletonComp._frameCache.enableCacheAttachedInfo();
                        for (var b = this._skeleton.bones, c = 0, e = b.length; c < e; c++) {
                            var f = b[c],
                                h = f.data,
                                m;
                            (m = f.parent ? this._boneIndexToNode[f.parent.data.index] : a) && (m = m.getChildByName("ATTACHED_NODE:" + h.name)) && m.isValid && this._buildBoneRelation(m, f, h.index)
                        }
                    }
                }
            },
            _syncAttachedNode: function() {
                if (this._inited) {
                    var a = this._attachedRootNode,
                        b = this._attachedNodeArray;
                    if (a && a.isValid) {
                        f["default"].copy(a._worldMatrix, this._skeletonNode._worldMatrix);
                        a._renderFlag &= ~e;
                        var l;
                        if (l = this._skeletonComp.isAnimationCached() ? this._skeletonComp._curFrame &&
                            this._skeletonComp._curFrame.boneInfos : this._skeleton.bones) {
                            for (var g = this._skeletonNode._mulMat, h = !1, k = 0, m = b.length; k < m; k++) {
                                var p = b[k];
                                if (p && p.isValid) {
                                    var u = l[p._boneIndex];
                                    if (u) {
                                        var v = p._worldMatrix,
                                            q = a._worldMatrix,
                                            B = c.m;
                                        B[0] = u.a;
                                        B[1] = u.c;
                                        B[4] = u.b;
                                        B[5] = u.d;
                                        B[12] = u.worldX;
                                        B[13] = u.worldY;
                                        g(v, q, c);
                                        p._renderFlag &= ~e
                                    } else p.removeFromParent(!0), p.destroy(), b[k] = null, h = !0
                                } else b[k] = null, h = !0
                            }
                            h && this._rebuildNodeArray()
                        }
                    } else this._attachedRootNode = null, b.length = 0
                }
            }
        });
        q.exports = sp.AttachUtil = h
    }, {
        "../../cocos2d/core/renderer/render-flow": 237,
        "../../cocos2d/core/value-types/mat4": 303
    }],
    365: [function(h, q, m) {
            var f = h("./track-entry-listeners");
            m = h("../../cocos2d/core/components/CCRenderComponent");
            var e = h("./lib/spine"),
                b = h("../../cocos2d/core/graphics/graphics"),
                k = h("../../cocos2d/core/renderer/render-flow").FLAG_POST_RENDER,
                c = h("./skeleton-cache"),
                a = h("./AttachUtil");
            h = cc.Enum({
                default: -1
            });
            var d = cc.Enum({
                    "<None>": 0
                }),
                l = cc.Enum({
                    REALTIME: 0,
                    SHARED_CACHE: 1,
                    PRIVATE_CACHE: 2
                });
            sp.Skeleton = cc.Class({
                name: "sp.Skeleton",
                extends: m,
                editor: !1,
                statics: {
                    AnimationCacheMode: l
                },
                properties: {
                    paused: {
                        default: !1,
                        visible: !1
                    },
                    skeletonData: {
                        default: null,
                        type: sp.SkeletonData,
                        notify: function() {
                            this.defaultAnimation = this.defaultSkin = "";
                            !1;
                            this._updateSkeletonData()
                        },
                        tooltip: !1
                    },
                    defaultSkin: {
                        default: "",
                        visible: !1
                    },
                    defaultAnimation: {
                        default: "",
                        visible: !1
                    },
                    animation: {
                        get: function() {
                            if (this.isAnimationCached()) return this._animationName;
                            var a = this.getCurrent(0);
                            return a && a.animation.name || ""
                        },
                        set: function(a) {
                            (this.defaultAnimation = a) ? this.setAnimation(0, a, this.loop): this.isAnimationCached() ||
                                (this.clearTrack(0), this.setToSetupPose())
                        },
                        visible: !1
                    },
                    _defaultSkinIndex: {
                        get: function() {
                            if (this.skeletonData) {
                                var a = this.skeletonData.getSkinsEnum();
                                if (a)
                                    if ("" === this.defaultSkin) a.hasOwnProperty(0) && (this._defaultSkinIndex = 0);
                                    else if (a = a[this.defaultSkin], void 0 !== a) return a
                            }
                            return 0
                        },
                        set: function(a) {
                            var b;
                            this.skeletonData && (b = this.skeletonData.getSkinsEnum());
                            if (!b) return cc.errorID("", this.name);
                            a = b[a];
                            void 0 !== a ? (this.defaultSkin = a, this.setSkin(this.defaultSkin), !1) : cc.errorID(7501, this.name)
                        },
                        type: h,
                        visible: !0,
                        animatable: !1,
                        displayName: "Default Skin",
                        tooltip: !1
                    },
                    _animationIndex: {
                        get: function() {
                            var a = this.animation;
                            if (this.skeletonData && a) {
                                var b = this.skeletonData.getAnimsEnum();
                                if (b && (a = b[a], void 0 !== a)) return a
                            }
                            return 0
                        },
                        set: function(a) {
                            if (0 === a) this.animation = "";
                            else {
                                var b;
                                this.skeletonData && (b = this.skeletonData.getAnimsEnum());
                                if (!b) return cc.errorID(7502, this.name);
                                a = b[a];
                                void 0 !== a ? this.animation = a : cc.errorID(7503, this.name)
                            }
                        },
                        type: d,
                        visible: !0,
                        animatable: !1,
                        displayName: "Animation",
                        tooltip: !1
                    },
                    _preCacheMode: -1,
                    _cacheMode: l.REALTIME,
                    _defaultCacheMode: {
                        default: 0,
                        type: l,
                        notify: function() {
                            this.setAnimationCacheMode(this._defaultCacheMode)
                        },
                        editorOnly: !0,
                        visible: !0,
                        animatable: !1,
                        displayName: "Animation Cache Mode",
                        tooltip: !1
                    },
                    loop: {
                        default: !0,
                        tooltip: !1
                    },
                    premultipliedAlpha: {
                        default: !0,
                        tooltip: !1
                    },
                    timeScale: {
                        default: 1,
                        tooltip: !1
                    },
                    debugSlots: {
                        default: !1,
                        editorOnly: !0,
                        tooltip: !1,
                        notify: function() {
                            this._updateDebugDraw()
                        }
                    },
                    debugBones: {
                        default: !1,
                        editorOnly: !0,
                        tooltip: !1,
                        notify: function() {
                            this._updateDebugDraw()
                        }
                    },
                    debugMesh: {
                        default: !1,
                        editorOnly: !0,
                        tooltip: !1,
                        notify: function() {
                            this._updateDebugDraw()
                        }
                    },
                    useTint: {
                        default: !1,
                        tooltip: !1,
                        notify: function() {
                            this._updateUseTint()
                        }
                    },
                    enableBatch: {
                        default: !1,
                        notify: function() {
                            this._updateBatch()
                        },
                        tooltip: !1
                    },
                    _accTime: 0,
                    _playCount: 0,
                    _frameCache: null,
                    _curFrame: null,
                    _skeletonCache: null,
                    _animationName: "",
                    _animationQueue: [],
                    _headAniInfo: null,
                    _playTimes: 0,
                    _isAniComplete: !0
                },
                ctor: function() {
                    this._listener = this._rootBone = this._skeleton = this._effectDelegate = null;
                    this._materialCache = {};
                    this._debugRenderer = null;
                    this._endSlotIndex = this._startSlotIndex = -1;
                    this._startEntry = {
                        animation: {
                            name: ""
                        },
                        trackIndex: 0
                    };
                    this._endEntry = {
                        animation: {
                            name: ""
                        },
                        trackIndex: 0
                    };
                    this.attachUtil = new a
                },
                _getDefaultMaterial: function() {
                    return cc.Material.getBuiltinMaterial("2d-spine")
                },
                _updateMaterial: function() {
                    var a = this.useTint || this.isAnimationCached() && !0,
                        b = this.getMaterial(0);
                    if (b) {
                        b.define("USE_TINT", a);
                        b.define("CC_USE_MODEL", !this.enableBatch);
                        a = this.premultipliedAlpha ? cc.gfx.BLEND_ONE : cc.gfx.BLEND_SRC_ALPHA;
                        var c = cc.gfx.BLEND_ONE_MINUS_SRC_ALPHA;
                        b.setBlend(!0, cc.gfx.BLEND_FUNC_ADD, a, a, cc.gfx.BLEND_FUNC_ADD, c, c)
                    }
                    this._materialCache = {}
                },
                disableRender: function() {
                    this._super();
                    this.node._renderFlag &= ~k
                },
                markForRender: function(a) {
                    this._super(a);
                    a ? this.node._renderFlag |= k : this.node._renderFlag &= ~k
                },
                _updateUseTint: function() {
                    var a = this.getMaterial(0);
                    if (a) {
                        var b = this.useTint || this.isAnimationCached() && !0;
                        a.define("USE_TINT", b)
                    }
                    this._materialCache = {}
                },
                _updateBatch: function() {
                    var a = this.getMaterial(0);
                    a && a.define("CC_USE_MODEL", !this.enableBatch);
                    this._materialCache = {}
                },
                _validateRender: function() {
                    var a = this.skeletonData;
                    a && a.isTexturesLoaded() ? this._super() : this.disableRender()
                },
                setSkeletonData: function(a) {
                    null != a.width && null != a.height && this.node.setContentSize(a.width, a.height);
                    !0;
                    this._cacheMode === l.SHARED_CACHE ? this._skeletonCache = c.sharedCache : this._cacheMode === l.PRIVATE_CACHE && (this._skeletonCache = new c, this._skeletonCache.enablePrivateMode());
                    this.isAnimationCached() ? ((this.debugBones || this.debugSlots) && cc.warn("Debug bones or slots is invalid in cached mode"),
                        a = this._skeletonCache.getSkeletonCache(this.skeletonData._uuid, a), this._skeleton = a.skeleton, this._clipper = a.clipper) : (this._skeleton = new e.Skeleton(a), this._clipper = new e.SkeletonClipping);
                    this._rootBone = this._skeleton.getRootBone();
                    this.markForRender(!0)
                },
                setSlotsRange: function(a, b) {
                    this.isAnimationCached() ? cc.warn("Slots visible range can not be modified in cached mode.") : (this._startSlotIndex = a, this._endSlotIndex = b)
                },
                setAnimationStateData: function(a) {
                    this.isAnimationCached() ? cc.warn("'setAnimationStateData' interface can not be invoked in cached mode.") :
                        (a = new e.AnimationState(a), this._listener && (this._state && this._state.removeListener(this._listener), a.addListener(this._listener)), this._state = a)
                },
                __preload: function() {
                    this._super();
                    !1;
                    for (var a = this.node.children, b = 0, c = a.length; b < c; b++) {
                        var d = a[b];
                        d && "DEBUG_DRAW_NODE" === d._name && d.destroy()
                    }
                    this._updateSkeletonData();
                    this._updateDebugDraw();
                    this._updateUseTint();
                    this._updateBatch()
                },
                setAnimationCacheMode: function(a) {
                    this._preCacheMode !== a && (this._cacheMode = a, this._updateSkeletonData(), this._updateUseTint())
                },
                isAnimationCached: function() {
                    !1;
                    return this._cacheMode !== l.REALTIME
                },
                update: function(a) {
                    !1;
                    this.paused || (a *= this.timeScale * sp.timeScale, this.isAnimationCached() ? this._isAniComplete ? 0 !== this._animationQueue.length || this._headAniInfo ? (this._headAniInfo || (this._headAniInfo = this._animationQueue.shift()), this._accTime += a, this._accTime > this._headAniInfo.delay && (a = this._headAniInfo, this._headAniInfo = null, this.setAnimation(0, a.animationName, a.loop))) : (a = this._frameCache) && a.isInvalid() && (a.updateToFrame(),
                        a = a.frames, this._curFrame = a[a.length - 1]) : this._updateCache(a) : this._updateRealtime(a))
                },
                _emitCacheCompleteEvent: function() {
                    this._listener && (this._endEntry.animation.name = this._animationName, this._listener.complete && this._listener.complete(this._endEntry), this._listener.end && this._listener.end(this._endEntry))
                },
                _updateCache: function(a) {
                    var b = this._frameCache;
                    if (b.isInited()) {
                        var d = b.frames,
                            e = c.FrameTime;
                        0 == this._accTime && 0 == this._playCount && (this._startEntry.animation.name = this._animationName, this._listener &&
                            this._listener.start && this._listener.start(this._startEntry));
                        this._accTime += a;
                        a = Math.floor(this._accTime / e);
                        b.isCompleted || b.updateToFrame(a);
                        if (b.isCompleted && a >= d.length) {
                            this._playCount++;
                            if (0 < this._playTimes && this._playCount >= this._playTimes) {
                                this._curFrame = d[d.length - 1];
                                this._playCount = this._accTime = 0;
                                this._isAniComplete = !0;
                                this._emitCacheCompleteEvent();
                                return
                            }
                            a = this._accTime = 0;
                            this._emitCacheCompleteEvent()
                        }
                        this._curFrame = d[a]
                    }
                },
                _updateRealtime: function(a) {
                    var b = this._skeleton,
                        c = this._state;
                    b && (b.update(a), c && (c.update(a), c.apply(b)))
                },
                setVertexEffectDelegate: function(a) {
                    this._effectDelegate = a
                },
                updateWorldTransform: function() {
                    this.isAnimationCached() && this._skeleton && this._skeleton.updateWorldTransform()
                },
                setToSetupPose: function() {
                    this._skeleton && this._skeleton.setToSetupPose()
                },
                setBonesToSetupPose: function() {
                    this._skeleton && this._skeleton.setBonesToSetupPose()
                },
                setSlotsToSetupPose: function() {
                    this._skeleton && this._skeleton.setSlotsToSetupPose()
                },
                updateAnimationCache: function(a) {
                    if (this.isAnimationCached()) {
                        var b =
                            this.skeletonData._uuid;
                        this._skeletonCache && this._skeletonCache.updateAnimationCache(b, a)
                    }
                },
                invalidAnimationCache: function() {
                    this.isAnimationCached() && this._skeletonCache && this._skeletonCache.invalidAnimationCache(this.skeletonData._uuid)
                },
                findBone: function(a) {
                    return this._skeleton ? this._skeleton.findBone(a) : null
                },
                findSlot: function(a) {
                    return this._skeleton ? this._skeleton.findSlot(a) : null
                },
                setSkin: function(a) {
                    this._skeleton && (this._skeleton.setSkinByName(a), this._skeleton.setSlotsToSetupPose());
                    this.invalidAnimationCache()
                },
                getAttachment: function(a, b) {
                    return this._skeleton ? this._skeleton.getAttachmentByName(a, b) : null
                },
                setAttachment: function(a, b) {
                    this._skeleton && this._skeleton.setAttachment(a, b);
                    this.invalidAnimationCache()
                },
                getTextureAtlas: function(a) {
                    return a.region
                },
                setMix: function(a, b, c) {
                    this._state && this._state.data.setMix(a, b, c)
                },
                setAnimation: function(a, b, c) {
                    this._playTimes = c ? 0 : 1;
                    this._animationName = b;
                    if (this.isAnimationCached()) {
                        0 !== a && cc.warn("Track index can not greater than 0 in cached mode.");
                        if (!this._skeletonCache) return null;
                        (a = this._skeletonCache.getAnimationCache(this.skeletonData._uuid, b)) || (a = this._skeletonCache.initAnimationCache(this.skeletonData._uuid, b));
                        a && (this._isAniComplete = !1, this._playCount = this._accTime = 0, this._frameCache = a, this.attachUtil._hasAttachedNode() && this._frameCache.enableCacheAttachedInfo(), this._frameCache.updateToFrame(0), this._curFrame = this._frameCache.frames[0])
                    } else if (this._skeleton) {
                        var d = this._skeleton.data.findAnimation(b);
                        if (!d) return cc.logID(7509, b), null;
                        b = this._state.setAnimationWith(a,
                            d, c);
                        this._state.apply(this._skeleton);
                        return b
                    }
                    return null
                },
                addAnimation: function(a, b, c, d) {
                    d = d || 0;
                    if (this.isAnimationCached()) 0 !== a && cc.warn("Track index can not greater than 0 in cached mode."), this._animationQueue.push({
                        animationName: b,
                        loop: c,
                        delay: d
                    });
                    else if (this._skeleton) {
                        var e = this._skeleton.data.findAnimation(b);
                        return e ? this._state.addAnimationWith(a, e, c, d) : (cc.logID(7510, b), null)
                    }
                    return null
                },
                findAnimation: function(a) {
                    return this._skeleton ? this._skeleton.data.findAnimation(a) : null
                },
                getCurrent: function(a) {
                    if (this.isAnimationCached()) cc.warn("'getCurrent' interface can not be invoked in cached mode.");
                    else if (this._state) return this._state.getCurrent(a);
                    return null
                },
                clearTracks: function() {
                    this.isAnimationCached() ? cc.warn("'clearTracks' interface can not be invoked in cached mode.") : this._state && this._state.clearTracks()
                },
                clearTrack: function(a) {
                    this.isAnimationCached() ? cc.warn("'clearTrack' interface can not be invoked in cached mode.") : this._state && (this._state.clearTrack(a), !1)
                },
                setStartListener: function(a) {
                    this._ensureListener();
                    this._listener.start = a
                },
                setInterruptListener: function(a) {
                    this._ensureListener();
                    this._listener.interrupt = a
                },
                setEndListener: function(a) {
                    this._ensureListener();
                    this._listener.end = a
                },
                setDisposeListener: function(a) {
                    this._ensureListener();
                    this._listener.dispose = a
                },
                setCompleteListener: function(a) {
                    this._ensureListener();
                    this._listener.complete = a
                },
                setEventListener: function(a) {
                    this._ensureListener();
                    this._listener.event = a
                },
                setTrackStartListener: function(a, b) {
                    f.getListeners(a).start = b
                },
                setTrackInterruptListener: function(a, b) {
                    f.getListeners(a).interrupt = b
                },
                setTrackEndListener: function(a,
                    b) {
                    f.getListeners(a).end = b
                },
                setTrackDisposeListener: function(a, b) {
                    f.getListeners(a).dispose = b
                },
                setTrackCompleteListener: function(a, b) {
                    f.getListeners(a).complete = function(a) {
                        b(a, Math.floor(a.trackTime / a.animationEnd))
                    }
                },
                setTrackEventListener: function(a, b) {
                    f.getListeners(a).event = b
                },
                getState: function() {
                    return this._state
                },
                _updateAnimEnum: !1,
                _updateSkinEnum: !1,
                _ensureListener: function() {
                    this._listener || (this._listener = new f, this._state && this._state.addListener(this._listener))
                },
                _updateSkeletonData: function() {
                    if (this.skeletonData) {
                        var a =
                            this.skeletonData.getRuntimeData();
                        if (a) {
                            try {
                                this.setSkeletonData(a), this.isAnimationCached() || this.setAnimationStateData(new e.AnimationStateData(this._skeleton.data)), this.defaultSkin && this.setSkin(this.defaultSkin)
                            } catch (n) {
                                cc.warn(n)
                            }
                            this.attachUtil.init(this);
                            this.attachUtil._associateAttachedNode();
                            this._preCacheMode = this._cacheMode;
                            this.animation = this.defaultAnimation
                        } else this.disableRender()
                    } else this.disableRender()
                },
                _refreshInspector: function() {
                    this._updateAnimEnum();
                    this._updateSkinEnum();
                    Editor.Utils.refreshSelectedInspector("node", this.node.uuid)
                },
                _updateDebugDraw: function() {
                    if (this.debugBones || this.debugSlots) {
                        if (!this._debugRenderer) {
                            var a = new cc.PrivateNode;
                            a.name = "DEBUG_DRAW_NODE";
                            a = a.addComponent(b);
                            a.lineWidth = 1;
                            a.strokeColor = cc.color(255, 0, 0, 255);
                            this._debugRenderer = a
                        }
                        this._debugRenderer.node.parent = this.node;
                        this.isAnimationCached() && cc.warn("Debug bones or slots is invalid in cached mode")
                    } else this._debugRenderer && (this._debugRenderer.node.parent = null)
                }
            });
            q.exports = sp.Skeleton
        },
        {
            "../../cocos2d/core/components/CCRenderComponent": 126,
            "../../cocos2d/core/graphics/graphics": 167,
            "../../cocos2d/core/renderer/render-flow": 237,
            "./AttachUtil": 364,
            "./lib/spine": 367,
            "./skeleton-cache": 368,
            "./track-entry-listeners": 372
        }
    ],
    366: [function(h, q, m) {
        q = "undefined" === typeof window ? global : window;
        !0;
        q.spine = h("./lib/spine");
        q.sp = {};
        sp._timeScale = 1;
        Object.defineProperty(sp, "timeScale", {
            get: function() {
                return this._timeScale
            },
            set: function(f) {
                this._timeScale = f
            },
            configurable: !0
        });
        sp.ATTACHMENT_TYPE = {
            REGION: 0,
            BOUNDING_BOX: 1,
            MESH: 2,
            SKINNED_MESH: 3
        };
        sp.AnimationEventType = cc.Enum({
            START: 0,
            INTERRUPT: 1,
            END: 2,
            DISPOSE: 3,
            COMPLETE: 4,
            EVENT: 5
        });
        !0;
        sp.spine = q.spine;
        !0;
        h("./skeleton-texture");
        h("./skeleton-data");
        h("./vertex-effect-delegate");
        h("./Skeleton");
        h("./spine-assembler")
    }, {
        "./Skeleton": 365,
        "./lib/spine": 367,
        "./skeleton-data": 369,
        "./skeleton-texture": 370,
        "./spine-assembler": 371,
        "./vertex-effect-delegate": 373
    }],
    367: [function(h, q, m) {
        var f = (void 0, function() {
                var b = function(e, c) {
                    b = Object.setPrototypeOf || {
                        __proto__: []
                    }
                    instanceof Array && function(a, b) {
                        a.__proto__ = b
                    } || function(a, b) {
                        for (var c in b) b.hasOwnProperty(c) && (a[c] = b[c])
                    };
                    return b(e, c)
                };
                return function(e, c) {
                    function a() {
                        this.constructor = e
                    }
                    b(e, c);
                    e.prototype = null === c ? Object.create(c) : (a.prototype = c.prototype, new a)
                }
            }()),
            e;
        (function(b) {
            var e = function() {
                function a(a, b, c) {
                    if (null == a) throw Error("name cannot be null.");
                    if (null == b) throw Error("timelines cannot be null.");
                    this.name = a;
                    this.timelines = b;
                    this.timelineIds = [];
                    for (a = 0; a < b.length; a++) this.timelineIds[b[a].getPropertyId()] = !0;
                    this.duration = c
                }
                a.prototype.hasTimeline = function(a) {
                    return 1 == this.timelineIds[a]
                };
                a.prototype.apply = function(a, b, c, d, e, g, f, l) {
                    if (null == a) throw Error("skeleton cannot be null.");
                    d && 0 != this.duration && (c %= this.duration, 0 < b && (b %= this.duration));
                    d = this.timelines;
                    for (var h = 0, k = d.length; h < k; h++) d[h].apply(a, b, c, e, g, f, l)
                };
                a.binarySearch = function(a, b, c) {
                    void 0 === c && (c = 1);
                    var d = 0,
                        e = a.length / c - 2;
                    if (0 == e) return c;
                    for (var g = e >>> 1;;) {
                        a[(g + 1) * c] <= b ? d = g + 1 : e = g;
                        if (d == e) return (d + 1) * c;
                        g = d + e >>> 1
                    }
                };
                a.linearSearch =
                    function(a, b, c) {
                        for (var d = 0, e = a.length - c; d <= e; d += c)
                            if (a[d] > b) return d;
                        return -1
                    };
                return a
            }();
            b.Animation = e;
            var c;
            (function(a) {
                a[a.setup = 0] = "setup";
                a[a.first = 1] = "first";
                a[a.replace = 2] = "replace";
                a[a.add = 3] = "add"
            })(c = b.MixBlend || (b.MixBlend = {}));
            var a;
            (function(a) {
                a[a.mixIn = 0] = "mixIn";
                a[a.mixOut = 1] = "mixOut"
            })(a = b.MixDirection || (b.MixDirection = {}));
            var d;
            (function(a) {
                a[a.rotate = 0] = "rotate";
                a[a.translate = 1] = "translate";
                a[a.scale = 2] = "scale";
                a[a.shear = 3] = "shear";
                a[a.attachment = 4] = "attachment";
                a[a.color = 5] =
                    "color";
                a[a.deform = 6] = "deform";
                a[a.event = 7] = "event";
                a[a.drawOrder = 8] = "drawOrder";
                a[a.ikConstraint = 9] = "ikConstraint";
                a[a.transformConstraint = 10] = "transformConstraint";
                a[a.pathConstraintPosition = 11] = "pathConstraintPosition";
                a[a.pathConstraintSpacing = 12] = "pathConstraintSpacing";
                a[a.pathConstraintMix = 13] = "pathConstraintMix";
                a[a.twoColor = 14] = "twoColor"
            })(d = b.TimelineType || (b.TimelineType = {}));
            var l = function() {
                function a(c) {
                    if (0 >= c) throw Error("frameCount must be > 0: " + c);
                    this.curves = b.Utils.newFloatArray((c -
                        1) * a.BEZIER_SIZE)
                }
                a.prototype.getFrameCount = function() {
                    return this.curves.length / a.BEZIER_SIZE + 1
                };
                a.prototype.setLinear = function(b) {
                    this.curves[b * a.BEZIER_SIZE] = a.LINEAR
                };
                a.prototype.setStepped = function(b) {
                    this.curves[b * a.BEZIER_SIZE] = a.STEPPED
                };
                a.prototype.getCurveType = function(b) {
                    b *= a.BEZIER_SIZE;
                    if (b == this.curves.length) return a.LINEAR;
                    b = this.curves[b];
                    return b == a.LINEAR ? a.LINEAR : b == a.STEPPED ? a.STEPPED : a.BEZIER
                };
                a.prototype.setCurve = function(b, c, d, e, g) {
                    var f = .03 * (2 * -c + e),
                        l = .03 * (2 * -d + g);
                    e = .006 *
                        (3 * (c - e) + 1);
                    g = .006 * (3 * (d - g) + 1);
                    var h = 2 * f + e,
                        k = 2 * l + g;
                    c = .3 * c + f + .16666667 * e;
                    d = .3 * d + l + .16666667 * g;
                    b *= a.BEZIER_SIZE;
                    l = this.curves;
                    l[b++] = a.BEZIER;
                    f = c;
                    for (var n = d, p = b + a.BEZIER_SIZE - 1; b < p; b += 2) l[b] = f, l[b + 1] = n, c += h, d += k, h += e, k += g, f += c, n += d
                };
                a.prototype.getCurvePercent = function(c, d) {
                    d = b.MathUtils.clamp(d, 0, 1);
                    var e = this.curves;
                    c *= a.BEZIER_SIZE;
                    var g = e[c];
                    if (g == a.LINEAR) return d;
                    if (g == a.STEPPED) return 0;
                    c++;
                    g = 0;
                    for (var f = c, l = c + a.BEZIER_SIZE - 1; c < l; c += 2)
                        if (g = e[c], g >= d) return c == f ? l = f = 0 : (f = e[c - 2], l = e[c - 1]), l + (e[c +
                            1] - l) * (d - f) / (g - f);
                    e = e[c - 1];
                    return e + (1 - e) * (d - g) / (1 - g)
                };
                a.LINEAR = 0;
                a.STEPPED = 1;
                a.BEZIER = 2;
                a.BEZIER_SIZE = 19;
                return a
            }();
            b.CurveTimeline = l;
            var g = function(a) {
                function g(c) {
                    var d = a.call(this, c) || this;
                    d.frames = b.Utils.newFloatArray(c << 1);
                    return d
                }
                f(g, a);
                g.prototype.getPropertyId = function() {
                    return (d.rotate << 24) + this.boneIndex
                };
                g.prototype.setFrame = function(a, b, c) {
                    a <<= 1;
                    this.frames[a] = b;
                    this.frames[a + g.ROTATION] = c
                };
                g.prototype.apply = function(a, b, d, f, l, h, k) {
                    b = this.frames;
                    a = a.bones[this.boneIndex];
                    if (a.active)
                        if (d <
                            b[0]) switch (h) {
                            case c.setup:
                                a.rotation = a.data.rotation;
                                break;
                            case c.first:
                                h = a.data.rotation - a.rotation, a.rotation += (h - 360 * (16384 - (16384.499999999996 - h / 360 | 0))) * l
                        } else if (d >= b[b.length - g.ENTRIES]) switch (d = b[b.length + g.PREV_ROTATION], h) {
                            case c.setup:
                                a.rotation = a.data.rotation + d * l;
                                break;
                            case c.first:
                            case c.replace:
                                d += a.data.rotation - a.rotation, d -= 360 * (16384 - (16384.499999999996 - d / 360 | 0));
                            case c.add:
                                a.rotation += d * l
                        } else {
                            k = e.binarySearch(b, d, g.ENTRIES);
                            f = b[k + g.PREV_ROTATION];
                            var n = b[k];
                            d = this.getCurvePercent((k >>
                                1) - 1, 1 - (d - n) / (b[k + g.PREV_TIME] - n));
                            b = b[k + g.ROTATION] - f;
                            b = f + (b - 360 * (16384 - (16384.499999999996 - b / 360 | 0))) * d;
                            switch (h) {
                                case c.setup:
                                    a.rotation = a.data.rotation + (b - 360 * (16384 - (16384.499999999996 - b / 360 | 0))) * l;
                                    break;
                                case c.first:
                                case c.replace:
                                    b += a.data.rotation - a.rotation;
                                case c.add:
                                    a.rotation += (b - 360 * (16384 - (16384.499999999996 - b / 360 | 0))) * l
                            }
                        }
                };
                g.ENTRIES = 2;
                g.PREV_TIME = -2;
                g.PREV_ROTATION = -1;
                g.ROTATION = 1;
                return g
            }(l);
            b.RotateTimeline = g;
            g = function(a) {
                function g(c) {
                    var d = a.call(this, c) || this;
                    d.frames = b.Utils.newFloatArray(c *
                        g.ENTRIES);
                    return d
                }
                f(g, a);
                g.prototype.getPropertyId = function() {
                    return (d.translate << 24) + this.boneIndex
                };
                g.prototype.setFrame = function(a, b, c, d) {
                    a *= g.ENTRIES;
                    this.frames[a] = b;
                    this.frames[a + g.X] = c;
                    this.frames[a + g.Y] = d
                };
                g.prototype.apply = function(a, b, d, f, l, h, k) {
                    b = this.frames;
                    a = a.bones[this.boneIndex];
                    if (a.active)
                        if (d < b[0]) switch (h) {
                            case c.setup:
                                a.x = a.data.x;
                                a.y = a.data.y;
                                break;
                            case c.first:
                                a.x += (a.data.x - a.x) * l, a.y += (a.data.y - a.y) * l
                        } else {
                            if (d >= b[b.length - g.ENTRIES]) f = b[b.length + g.PREV_X], k = b[b.length +
                                g.PREV_Y];
                            else {
                                var n = e.binarySearch(b, d, g.ENTRIES);
                                f = b[n + g.PREV_X];
                                k = b[n + g.PREV_Y];
                                var p = b[n];
                                d = this.getCurvePercent(n / g.ENTRIES - 1, 1 - (d - p) / (b[n + g.PREV_TIME] - p));
                                f += (b[n + g.X] - f) * d;
                                k += (b[n + g.Y] - k) * d
                            }
                            switch (h) {
                                case c.setup:
                                    a.x = a.data.x + f * l;
                                    a.y = a.data.y + k * l;
                                    break;
                                case c.first:
                                case c.replace:
                                    a.x += (a.data.x + f - a.x) * l;
                                    a.y += (a.data.y + k - a.y) * l;
                                    break;
                                case c.add:
                                    a.x += f * l, a.y += k * l
                            }
                        }
                };
                g.ENTRIES = 3;
                g.PREV_TIME = -3;
                g.PREV_X = -2;
                g.PREV_Y = -1;
                g.X = 1;
                g.Y = 2;
                return g
            }(l);
            b.TranslateTimeline = g;
            var h = function(g) {
                function l(a) {
                    return g.call(this,
                        a) || this
                }
                f(l, g);
                l.prototype.getPropertyId = function() {
                    return (d.scale << 24) + this.boneIndex
                };
                l.prototype.apply = function(d, g, f, h, k, n, p) {
                    var m = this.frames;
                    d = d.bones[this.boneIndex];
                    if (d.active)
                        if (f < m[0]) switch (n) {
                            case c.setup:
                                d.scaleX = d.data.scaleX;
                                d.scaleY = d.data.scaleY;
                                break;
                            case c.first:
                                d.scaleX += (d.data.scaleX - d.scaleX) * k, d.scaleY += (d.data.scaleY - d.scaleY) * k
                        } else {
                            if (f >= m[m.length - l.ENTRIES]) g = m[m.length + l.PREV_X] * d.data.scaleX, h = m[m.length + l.PREV_Y] * d.data.scaleY;
                            else {
                                var t = e.binarySearch(m, f, l.ENTRIES);
                                g = m[t + l.PREV_X];
                                h = m[t + l.PREV_Y];
                                var u = m[t];
                                f = this.getCurvePercent(t / l.ENTRIES - 1, 1 - (f - u) / (m[t + l.PREV_TIME] - u));
                                g = (g + (m[t + l.X] - g) * f) * d.data.scaleX;
                                h = (h + (m[t + l.Y] - h) * f) * d.data.scaleY
                            }
                            if (1 == k) n == c.add ? (d.scaleX += g - d.data.scaleX, d.scaleY += h - d.data.scaleY) : (d.scaleX = g, d.scaleY = h);
                            else if (p == a.mixOut) switch (n) {
                                case c.setup:
                                    n = d.data.scaleX;
                                    p = d.data.scaleY;
                                    d.scaleX = n + (Math.abs(g) * b.MathUtils.signum(n) - n) * k;
                                    d.scaleY = p + (Math.abs(h) * b.MathUtils.signum(p) - p) * k;
                                    break;
                                case c.first:
                                case c.replace:
                                    n = d.scaleX;
                                    p = d.scaleY;
                                    d.scaleX = n + (Math.abs(g) * b.MathUtils.signum(n) - n) * k;
                                    d.scaleY = p + (Math.abs(h) * b.MathUtils.signum(p) - p) * k;
                                    break;
                                case c.add:
                                    n = d.scaleX, p = d.scaleY, d.scaleX = n + (Math.abs(g) * b.MathUtils.signum(n) - d.data.scaleX) * k, d.scaleY = p + (Math.abs(h) * b.MathUtils.signum(p) - d.data.scaleY) * k
                            } else switch (n) {
                                case c.setup:
                                    n = Math.abs(d.data.scaleX) * b.MathUtils.signum(g);
                                    p = Math.abs(d.data.scaleY) * b.MathUtils.signum(h);
                                    d.scaleX = n + (g - n) * k;
                                    d.scaleY = p + (h - p) * k;
                                    break;
                                case c.first:
                                case c.replace:
                                    n = Math.abs(d.scaleX) * b.MathUtils.signum(g);
                                    p = Math.abs(d.scaleY) * b.MathUtils.signum(h);
                                    d.scaleX = n + (g - n) * k;
                                    d.scaleY = p + (h - p) * k;
                                    break;
                                case c.add:
                                    n = b.MathUtils.signum(g), p = b.MathUtils.signum(h), d.scaleX = Math.abs(d.scaleX) * n + (g - Math.abs(d.data.scaleX) * n) * k, d.scaleY = Math.abs(d.scaleY) * p + (h - Math.abs(d.data.scaleY) * p) * k
                            }
                        }
                };
                return l
            }(g);
            b.ScaleTimeline = h;
            g = function(a) {
                function b(b) {
                    return a.call(this, b) || this
                }
                f(b, a);
                b.prototype.getPropertyId = function() {
                    return (d.shear << 24) + this.boneIndex
                };
                b.prototype.apply = function(a, d, g, f, l, h, k) {
                    d = this.frames;
                    a = a.bones[this.boneIndex];
                    if (a.active)
                        if (g < d[0]) switch (h) {
                            case c.setup:
                                a.shearX = a.data.shearX;
                                a.shearY = a.data.shearY;
                                break;
                            case c.first:
                                a.shearX += (a.data.shearX - a.shearX) * l, a.shearY += (a.data.shearY - a.shearY) * l
                        } else {
                            if (g >= d[d.length - b.ENTRIES]) f = d[d.length + b.PREV_X], k = d[d.length + b.PREV_Y];
                            else {
                                var n = e.binarySearch(d, g, b.ENTRIES);
                                f = d[n + b.PREV_X];
                                k = d[n + b.PREV_Y];
                                var p = d[n];
                                g = this.getCurvePercent(n / b.ENTRIES - 1, 1 - (g - p) / (d[n + b.PREV_TIME] - p));
                                f += (d[n + b.X] - f) * g;
                                k += (d[n + b.Y] - k) * g
                            }
                            switch (h) {
                                case c.setup:
                                    a.shearX = a.data.shearX + f * l;
                                    a.shearY =
                                        a.data.shearY + k * l;
                                    break;
                                case c.first:
                                case c.replace:
                                    a.shearX += (a.data.shearX + f - a.shearX) * l;
                                    a.shearY += (a.data.shearY + k - a.shearY) * l;
                                    break;
                                case c.add:
                                    a.shearX += f * l, a.shearY += k * l
                            }
                        }
                };
                return b
            }(g);
            b.ShearTimeline = g;
            g = function(a) {
                function g(c) {
                    var d = a.call(this, c) || this;
                    d.frames = b.Utils.newFloatArray(c * g.ENTRIES);
                    return d
                }
                f(g, a);
                g.prototype.getPropertyId = function() {
                    return (d.color << 24) + this.slotIndex
                };
                g.prototype.setFrame = function(a, b, c, d, e, f) {
                    a *= g.ENTRIES;
                    this.frames[a] = b;
                    this.frames[a + g.R] = c;
                    this.frames[a +
                        g.G] = d;
                    this.frames[a + g.B] = e;
                    this.frames[a + g.A] = f
                };
                g.prototype.apply = function(a, b, d, f, l, h, k) {
                    a = a.slots[this.slotIndex];
                    if (a.bone.active) {
                        var n = this.frames;
                        if (d < n[0]) switch (h) {
                            case c.setup:
                                a.color.setFromColor(a.data.color);
                                break;
                            case c.first:
                                d = a.color, h = a.data.color, d.add((h.r - d.r) * l, (h.g - d.g) * l, (h.b - d.b) * l, (h.a - d.a) * l)
                        } else {
                            if (d >= n[n.length - g.ENTRIES]) {
                                d = n.length;
                                b = n[d + g.PREV_R];
                                f = n[d + g.PREV_G];
                                k = n[d + g.PREV_B];
                                var p = n[d + g.PREV_A]
                            } else {
                                var m = e.binarySearch(n, d, g.ENTRIES);
                                b = n[m + g.PREV_R];
                                f = n[m + g.PREV_G];
                                k = n[m + g.PREV_B];
                                p = n[m + g.PREV_A];
                                var t = n[m];
                                d = this.getCurvePercent(m / g.ENTRIES - 1, 1 - (d - t) / (n[m + g.PREV_TIME] - t));
                                b += (n[m + g.R] - b) * d;
                                f += (n[m + g.G] - f) * d;
                                k += (n[m + g.B] - k) * d;
                                p += (n[m + g.A] - p) * d
                            }
                            1 == l ? a.color.set(b, f, k, p) : (d = a.color, h == c.setup && d.setFromColor(a.data.color), d.add((b - d.r) * l, (f - d.g) * l, (k - d.b) * l, (p - d.a) * l))
                        }
                    }
                };
                g.ENTRIES = 5;
                g.PREV_TIME = -5;
                g.PREV_R = -4;
                g.PREV_G = -3;
                g.PREV_B = -2;
                g.PREV_A = -1;
                g.R = 1;
                g.G = 2;
                g.B = 3;
                g.A = 4;
                return g
            }(l);
            b.ColorTimeline = g;
            g = function(a) {
                function g(c) {
                    var d = a.call(this, c) || this;
                    d.frames =
                        b.Utils.newFloatArray(c * g.ENTRIES);
                    return d
                }
                f(g, a);
                g.prototype.getPropertyId = function() {
                    return (d.twoColor << 24) + this.slotIndex
                };
                g.prototype.setFrame = function(a, b, c, d, e, f, l, h, k) {
                    a *= g.ENTRIES;
                    this.frames[a] = b;
                    this.frames[a + g.R] = c;
                    this.frames[a + g.G] = d;
                    this.frames[a + g.B] = e;
                    this.frames[a + g.A] = f;
                    this.frames[a + g.R2] = l;
                    this.frames[a + g.G2] = h;
                    this.frames[a + g.B2] = k
                };
                g.prototype.apply = function(a, b, d, f, l, h, k) {
                    a = a.slots[this.slotIndex];
                    if (a.bone.active) {
                        var n = this.frames;
                        if (d < n[0]) switch (h) {
                            case c.setup:
                                a.color.setFromColor(a.data.color);
                                a.darkColor.setFromColor(a.data.darkColor);
                                break;
                            case c.first:
                                n = a.color, d = a.darkColor, h = a.data.color, a = a.data.darkColor, n.add((h.r - n.r) * l, (h.g - n.g) * l, (h.b - n.b) * l, (h.a - n.a) * l), d.add((a.r - d.r) * l, (a.g - d.g) * l, (a.b - d.b) * l, 0)
                        } else {
                            if (d >= n[n.length - g.ENTRIES]) {
                                d = n.length;
                                b = n[d + g.PREV_R];
                                f = n[d + g.PREV_G];
                                k = n[d + g.PREV_B];
                                var p = n[d + g.PREV_A];
                                var m = n[d + g.PREV_R2];
                                var t = n[d + g.PREV_G2];
                                var u = n[d + g.PREV_B2]
                            } else {
                                var w = e.binarySearch(n, d, g.ENTRIES);
                                b = n[w + g.PREV_R];
                                f = n[w + g.PREV_G];
                                k = n[w + g.PREV_B];
                                p = n[w + g.PREV_A];
                                m = n[w + g.PREV_R2];
                                t = n[w + g.PREV_G2];
                                u = n[w + g.PREV_B2];
                                var v = n[w];
                                d = this.getCurvePercent(w / g.ENTRIES - 1, 1 - (d - v) / (n[w + g.PREV_TIME] - v));
                                b += (n[w + g.R] - b) * d;
                                f += (n[w + g.G] - f) * d;
                                k += (n[w + g.B] - k) * d;
                                p += (n[w + g.A] - p) * d;
                                m += (n[w + g.R2] - m) * d;
                                t += (n[w + g.G2] - t) * d;
                                u += (n[w + g.B2] - u) * d
                            }
                            1 == l ? (a.color.set(b, f, k, p), a.darkColor.set(m, t, u, 1)) : (n = a.color, d = a.darkColor, h == c.setup && (n.setFromColor(a.data.color), d.setFromColor(a.data.darkColor)), n.add((b - n.r) * l, (f - n.g) * l, (k - n.b) * l, (p - n.a) * l), d.add((m - d.r) * l, (t - d.g) * l, (u - d.b) * l, 0))
                        }
                    }
                };
                g.ENTRIES = 8;
                g.PREV_TIME = -8;
                g.PREV_R = -7;
                g.PREV_G = -6;
                g.PREV_B = -5;
                g.PREV_A = -4;
                g.PREV_R2 = -3;
                g.PREV_G2 = -2;
                g.PREV_B2 = -1;
                g.R = 1;
                g.G = 2;
                g.B = 3;
                g.A = 4;
                g.R2 = 5;
                g.G2 = 6;
                g.B2 = 7;
                return g
            }(l);
            b.TwoColorTimeline = g;
            g = function() {
                function g(a) {
                    this.frames = b.Utils.newFloatArray(a);
                    this.attachmentNames = Array(a)
                }
                g.prototype.getPropertyId = function() {
                    return (d.attachment << 24) + this.slotIndex
                };
                g.prototype.getFrameCount = function() {
                    return this.frames.length
                };
                g.prototype.setFrame = function(a, b, c) {
                    this.frames[a] = b;
                    this.attachmentNames[a] =
                        c
                };
                g.prototype.apply = function(b, d, g, f, l, h, k) {
                    d = b.slots[this.slotIndex];
                    if (d.bone.active)
                        if (k == a.mixOut && h == c.setup) g = d.data.attachmentName, d.setAttachment(null == g ? null : b.getAttachment(this.slotIndex, g));
                        else if (k = this.frames, g < k[0]) {
                        if (h == c.setup || h == c.first) g = d.data.attachmentName, d.setAttachment(null == g ? null : b.getAttachment(this.slotIndex, g))
                    } else g = g >= k[k.length - 1] ? k.length - 1 : e.binarySearch(k, g, 1) - 1, g = this.attachmentNames[g], b.slots[this.slotIndex].setAttachment(null == g ? null : b.getAttachment(this.slotIndex,
                        g))
                };
                return g
            }();
            b.AttachmentTimeline = g;
            var m = null;
            g = function(a) {
                function g(c) {
                    var d = a.call(this, c) || this;
                    d.frames = b.Utils.newFloatArray(c);
                    d.frameVertices = Array(c);
                    null == m && (m = b.Utils.newFloatArray(64));
                    return d
                }
                f(g, a);
                g.prototype.getPropertyId = function() {
                    return (d.deform << 27) + +this.attachment.id + this.slotIndex
                };
                g.prototype.setFrame = function(a, b, c) {
                    this.frames[a] = b;
                    this.frameVertices[a] = c
                };
                g.prototype.apply = function(a, d, g, f, l, h, k) {
                    a = a.slots[this.slotIndex];
                    if (a.bone.active) {
                        var n = a.getAttachment();
                        if (n instanceof b.VertexAttachment && n.deformAttachment == this.attachment) {
                            d = a.deform;
                            0 == d.length && (h = c.setup);
                            k = this.frameVertices;
                            a = k[0].length;
                            var p = this.frames;
                            if (g < p[0]) switch (h) {
                                case c.setup:
                                    d.length = 0;
                                    break;
                                case c.first:
                                    if (1 == l) d.length = 0;
                                    else if (d = b.Utils.setArraySize(d, a), null == n.bones)
                                        for (h = n.vertices, f = 0; f < a; f++) d[f] += (h[f] - d[f]) * l;
                                    else
                                        for (l = 1 - l, f = 0; f < a; f++) d[f] *= l
                            } else if (d = b.Utils.setArraySize(d, a), g >= p[p.length - 1])
                                if (f = k[p.length - 1], 1 == l)
                                    if (h == c.add)
                                        if (null == n.bones)
                                            for (h = n.vertices,
                                                l = 0; l < a; l++) d[l] += f[l] - h[l];
                                        else
                                            for (l = 0; l < a; l++) d[l] += f[l];
                            else b.Utils.arrayCopy(f, 0, d, 0, a);
                            else switch (h) {
                                case c.setup:
                                    if (null == n.bones)
                                        for (h = n.vertices, k = 0; k < a; k++) p = h[k], d[k] = p + (f[k] - p) * l;
                                    else
                                        for (k = 0; k < a; k++) d[k] = f[k] * l;
                                    break;
                                case c.first:
                                case c.replace:
                                    for (k = 0; k < a; k++) d[k] += (f[k] - d[k]) * l;
                                case c.add:
                                    if (null == n.bones)
                                        for (h = n.vertices, k = 0; k < a; k++) d[k] += (f[k] - h[k]) * l;
                                    else
                                        for (k = 0; k < a; k++) d[k] += f[k] * l
                            } else {
                                var m = e.binarySearch(p, g);
                                f = k[m - 1];
                                k = k[m];
                                var t = p[m];
                                g = this.getCurvePercent(m - 1, 1 - (g - t) / (p[m -
                                    1] - t));
                                if (1 == l)
                                    if (h == c.add)
                                        if (null == n.bones)
                                            for (h = n.vertices, l = 0; l < a; l++) n = f[l], d[l] += n + (k[l] - n) * g - h[l];
                                        else
                                            for (l = 0; l < a; l++) n = f[l], d[l] += n + (k[l] - n) * g;
                                else
                                    for (l = 0; l < a; l++) n = f[l], d[l] = n + (k[l] - n) * g;
                                else switch (h) {
                                    case c.setup:
                                        if (null == n.bones)
                                            for (h = n.vertices, m = 0; m < a; m++) n = f[m], p = h[m], d[m] = p + (n + (k[m] - n) * g - p) * l;
                                        else
                                            for (h = 0; h < a; h++) n = f[h], d[h] = (n + (k[h] - n) * g) * l;
                                        break;
                                    case c.first:
                                    case c.replace:
                                        for (h = 0; h < a; h++) n = f[h], d[h] += (n + (k[h] - n) * g - d[h]) * l;
                                        break;
                                    case c.add:
                                        if (null == n.bones)
                                            for (h = n.vertices, p = 0; p <
                                                a; p++) n = f[p], d[p] += (n + (k[p] - n) * g - h[p]) * l;
                                        else
                                            for (h = 0; h < a; h++) n = f[h], d[h] += (n + (k[h] - n) * g) * l
                                }
                            }
                        }
                    }
                };
                return g
            }(l);
            b.DeformTimeline = g;
            g = function() {
                function a(a) {
                    this.frames = b.Utils.newFloatArray(a);
                    this.events = Array(a)
                }
                a.prototype.getPropertyId = function() {
                    return d.event << 24
                };
                a.prototype.getFrameCount = function() {
                    return this.frames.length
                };
                a.prototype.setFrame = function(a, b) {
                    this.frames[a] = b.time;
                    this.events[a] = b
                };
                a.prototype.apply = function(a, b, c, d, g, f, l) {
                    if (null != d) {
                        var h = this.frames,
                            k = this.frames.length;
                        if (b > c) this.apply(a, b, Number.MAX_VALUE, d, g, f, l), b = -1;
                        else if (b >= h[k - 1]) return;
                        if (!(c < h[0])) {
                            if (b < h[0]) a = 0;
                            else
                                for (a = e.binarySearch(h, b), b = h[a]; 0 < a && h[a - 1] == b;) a--;
                            for (; a < k && c >= h[a]; a++) d.push(this.events[a])
                        }
                    }
                };
                return a
            }();
            b.EventTimeline = g;
            g = function() {
                function g(a) {
                    this.frames = b.Utils.newFloatArray(a);
                    this.drawOrders = Array(a)
                }
                g.prototype.getPropertyId = function() {
                    return d.drawOrder << 24
                };
                g.prototype.getFrameCount = function() {
                    return this.frames.length
                };
                g.prototype.setFrame = function(a, b, c) {
                    this.frames[a] =
                        b;
                    this.drawOrders[a] = c
                };
                g.prototype.apply = function(d, g, f, l, h, k, n) {
                    g = d.drawOrder;
                    l = d.slots;
                    if (n == a.mixOut && k == c.setup) b.Utils.arrayCopy(d.slots, 0, d.drawOrder, 0, d.slots.length);
                    else if (n = this.frames, f < n[0]) k != c.setup && k != c.first || b.Utils.arrayCopy(d.slots, 0, d.drawOrder, 0, d.slots.length);
                    else if (d = f >= n[n.length - 1] ? n.length - 1 : e.binarySearch(n, f) - 1, d = this.drawOrders[d], null == d) b.Utils.arrayCopy(l, 0, g, 0, l.length);
                    else
                        for (f = 0, k = d.length; f < k; f++) g[f] = l[d[f]]
                };
                return g
            }();
            b.DrawOrderTimeline = g;
            g = function(g) {
                function l(a) {
                    var c =
                        g.call(this, a) || this;
                    c.frames = b.Utils.newFloatArray(a * l.ENTRIES);
                    return c
                }
                f(l, g);
                l.prototype.getPropertyId = function() {
                    return (d.ikConstraint << 24) + this.ikConstraintIndex
                };
                l.prototype.setFrame = function(a, b, c, d, e, g, f) {
                    a *= l.ENTRIES;
                    this.frames[a] = b;
                    this.frames[a + l.MIX] = c;
                    this.frames[a + l.SOFTNESS] = d;
                    this.frames[a + l.BEND_DIRECTION] = e;
                    this.frames[a + l.COMPRESS] = g ? 1 : 0;
                    this.frames[a + l.STRETCH] = f ? 1 : 0
                };
                l.prototype.apply = function(b, d, g, f, h, k, n) {
                    d = this.frames;
                    b = b.ikConstraints[this.ikConstraintIndex];
                    if (b.active)
                        if (g <
                            d[0]) switch (k) {
                                case c.setup:
                                    b.mix = b.data.mix;
                                    b.softness = b.data.softness;
                                    b.bendDirection = b.data.bendDirection;
                                    b.compress = b.data.compress;
                                    b.stretch = b.data.stretch;
                                    break;
                                case c.first:
                                    b.mix += (b.data.mix - b.mix) * h, b.softness += (b.data.softness - b.softness) * h, b.bendDirection = b.data.bendDirection, b.compress = b.data.compress, b.stretch = b.data.stretch
                            } else if (g >= d[d.length - l.ENTRIES]) k == c.setup ? (b.mix = b.data.mix + (d[d.length + l.PREV_MIX] - b.data.mix) * h, b.softness = b.data.softness + (d[d.length + l.PREV_SOFTNESS] - b.data.softness) *
                                h, n == a.mixOut ? (b.bendDirection = b.data.bendDirection, b.compress = b.data.compress, b.stretch = b.data.stretch) : (b.bendDirection = d[d.length + l.PREV_BEND_DIRECTION], b.compress = 0 != d[d.length + l.PREV_COMPRESS], b.stretch = 0 != d[d.length + l.PREV_STRETCH])) : (b.mix += (d[d.length + l.PREV_MIX] - b.mix) * h, b.softness += (d[d.length + l.PREV_SOFTNESS] - b.softness) * h, n == a.mixIn && (b.bendDirection = d[d.length + l.PREV_BEND_DIRECTION], b.compress = 0 != d[d.length + l.PREV_COMPRESS], b.stretch = 0 != d[d.length + l.PREV_STRETCH]));
                            else {
                                f = e.binarySearch(d,
                                    g, l.ENTRIES);
                                var p = d[f + l.PREV_MIX],
                                    m = d[f + l.PREV_SOFTNESS],
                                    t = d[f];
                                g = this.getCurvePercent(f / l.ENTRIES - 1, 1 - (g - t) / (d[f + l.PREV_TIME] - t));
                                k == c.setup ? (b.mix = b.data.mix + (p + (d[f + l.MIX] - p) * g - b.data.mix) * h, b.softness = b.data.softness + (m + (d[f + l.SOFTNESS] - m) * g - b.data.softness) * h, n == a.mixOut ? (b.bendDirection = b.data.bendDirection, b.compress = b.data.compress, b.stretch = b.data.stretch) : (b.bendDirection = d[f + l.PREV_BEND_DIRECTION], b.compress = 0 != d[f + l.PREV_COMPRESS], b.stretch = 0 != d[f + l.PREV_STRETCH])) : (b.mix += (p + (d[f + l.MIX] -
                                    p) * g - b.mix) * h, b.softness += (m + (d[f + l.SOFTNESS] - m) * g - b.softness) * h, n == a.mixIn && (b.bendDirection = d[f + l.PREV_BEND_DIRECTION], b.compress = 0 != d[f + l.PREV_COMPRESS], b.stretch = 0 != d[f + l.PREV_STRETCH]))
                            }
                };
                l.ENTRIES = 6;
                l.PREV_TIME = -6;
                l.PREV_MIX = -5;
                l.PREV_SOFTNESS = -4;
                l.PREV_BEND_DIRECTION = -3;
                l.PREV_COMPRESS = -2;
                l.PREV_STRETCH = -1;
                l.MIX = 1;
                l.SOFTNESS = 2;
                l.BEND_DIRECTION = 3;
                l.COMPRESS = 4;
                l.STRETCH = 5;
                return l
            }(l);
            b.IkConstraintTimeline = g;
            g = function(a) {
                function g(c) {
                    var d = a.call(this, c) || this;
                    d.frames = b.Utils.newFloatArray(c *
                        g.ENTRIES);
                    return d
                }
                f(g, a);
                g.prototype.getPropertyId = function() {
                    return (d.transformConstraint << 24) + this.transformConstraintIndex
                };
                g.prototype.setFrame = function(a, b, c, d, e, f) {
                    a *= g.ENTRIES;
                    this.frames[a] = b;
                    this.frames[a + g.ROTATE] = c;
                    this.frames[a + g.TRANSLATE] = d;
                    this.frames[a + g.SCALE] = e;
                    this.frames[a + g.SHEAR] = f
                };
                g.prototype.apply = function(a, b, d, f, l, h, k) {
                    b = this.frames;
                    a = a.transformConstraints[this.transformConstraintIndex];
                    if (a.active)
                        if (d < b[0]) switch (d = a.data, h) {
                            case c.setup:
                                a.rotateMix = d.rotateMix;
                                a.translateMix =
                                    d.translateMix;
                                a.scaleMix = d.scaleMix;
                                a.shearMix = d.shearMix;
                                break;
                            case c.first:
                                a.rotateMix += (d.rotateMix - a.rotateMix) * l, a.translateMix += (d.translateMix - a.translateMix) * l, a.scaleMix += (d.scaleMix - a.scaleMix) * l, a.shearMix += (d.shearMix - a.shearMix) * l
                        } else {
                            if (d >= b[b.length - g.ENTRIES]) {
                                d = b.length;
                                f = b[d + g.PREV_ROTATE];
                                k = b[d + g.PREV_TRANSLATE];
                                var n = b[d + g.PREV_SCALE];
                                var p = b[d + g.PREV_SHEAR]
                            } else {
                                var m = e.binarySearch(b, d, g.ENTRIES);
                                f = b[m + g.PREV_ROTATE];
                                k = b[m + g.PREV_TRANSLATE];
                                n = b[m + g.PREV_SCALE];
                                p = b[m + g.PREV_SHEAR];
                                var t = b[m];
                                d = this.getCurvePercent(m / g.ENTRIES - 1, 1 - (d - t) / (b[m + g.PREV_TIME] - t));
                                f += (b[m + g.ROTATE] - f) * d;
                                k += (b[m + g.TRANSLATE] - k) * d;
                                n += (b[m + g.SCALE] - n) * d;
                                p += (b[m + g.SHEAR] - p) * d
                            }
                            h == c.setup ? (d = a.data, a.rotateMix = d.rotateMix + (f - d.rotateMix) * l, a.translateMix = d.translateMix + (k - d.translateMix) * l, a.scaleMix = d.scaleMix + (n - d.scaleMix) * l, a.shearMix = d.shearMix + (p - d.shearMix) * l) : (a.rotateMix += (f - a.rotateMix) * l, a.translateMix += (k - a.translateMix) * l, a.scaleMix += (n - a.scaleMix) * l, a.shearMix += (p - a.shearMix) * l)
                        }
                };
                g.ENTRIES =
                    5;
                g.PREV_TIME = -5;
                g.PREV_ROTATE = -4;
                g.PREV_TRANSLATE = -3;
                g.PREV_SCALE = -2;
                g.PREV_SHEAR = -1;
                g.ROTATE = 1;
                g.TRANSLATE = 2;
                g.SCALE = 3;
                g.SHEAR = 4;
                return g
            }(l);
            b.TransformConstraintTimeline = g;
            g = function(a) {
                function g(c) {
                    var d = a.call(this, c) || this;
                    d.frames = b.Utils.newFloatArray(c * g.ENTRIES);
                    return d
                }
                f(g, a);
                g.prototype.getPropertyId = function() {
                    return (d.pathConstraintPosition << 24) + this.pathConstraintIndex
                };
                g.prototype.setFrame = function(a, b, c) {
                    a *= g.ENTRIES;
                    this.frames[a] = b;
                    this.frames[a + g.VALUE] = c
                };
                g.prototype.apply =
                    function(a, b, d, f, l, h, k) {
                        b = this.frames;
                        a = a.pathConstraints[this.pathConstraintIndex];
                        if (a.active)
                            if (d < b[0]) switch (h) {
                                case c.setup:
                                    a.position = a.data.position;
                                    break;
                                case c.first:
                                    a.position += (a.data.position - a.position) * l
                            } else {
                                if (d >= b[b.length - g.ENTRIES]) f = b[b.length + g.PREV_VALUE];
                                else {
                                    k = e.binarySearch(b, d, g.ENTRIES);
                                    f = b[k + g.PREV_VALUE];
                                    var n = b[k];
                                    d = this.getCurvePercent(k / g.ENTRIES - 1, 1 - (d - n) / (b[k + g.PREV_TIME] - n));
                                    f += (b[k + g.VALUE] - f) * d
                                }
                                h == c.setup ? a.position = a.data.position + (f - a.data.position) * l : a.position +=
                                    (f - a.position) * l
                            }
                    };
                g.ENTRIES = 2;
                g.PREV_TIME = -2;
                g.PREV_VALUE = -1;
                g.VALUE = 1;
                return g
            }(l);
            b.PathConstraintPositionTimeline = g;
            g = function(a) {
                function b(b) {
                    return a.call(this, b) || this
                }
                f(b, a);
                b.prototype.getPropertyId = function() {
                    return (d.pathConstraintSpacing << 24) + this.pathConstraintIndex
                };
                b.prototype.apply = function(a, d, g, f, l, h, k) {
                    d = this.frames;
                    a = a.pathConstraints[this.pathConstraintIndex];
                    if (a.active)
                        if (g < d[0]) switch (h) {
                            case c.setup:
                                a.spacing = a.data.spacing;
                                break;
                            case c.first:
                                a.spacing += (a.data.spacing - a.spacing) *
                                    l
                        } else {
                            if (g >= d[d.length - b.ENTRIES]) f = d[d.length + b.PREV_VALUE];
                            else {
                                k = e.binarySearch(d, g, b.ENTRIES);
                                f = d[k + b.PREV_VALUE];
                                var n = d[k];
                                g = this.getCurvePercent(k / b.ENTRIES - 1, 1 - (g - n) / (d[k + b.PREV_TIME] - n));
                                f += (d[k + b.VALUE] - f) * g
                            }
                            h == c.setup ? a.spacing = a.data.spacing + (f - a.data.spacing) * l : a.spacing += (f - a.spacing) * l
                        }
                };
                return b
            }(g);
            b.PathConstraintSpacingTimeline = g;
            l = function(a) {
                function g(c) {
                    var d = a.call(this, c) || this;
                    d.frames = b.Utils.newFloatArray(c * g.ENTRIES);
                    return d
                }
                f(g, a);
                g.prototype.getPropertyId = function() {
                    return (d.pathConstraintMix <<
                        24) + this.pathConstraintIndex
                };
                g.prototype.setFrame = function(a, b, c, d) {
                    a *= g.ENTRIES;
                    this.frames[a] = b;
                    this.frames[a + g.ROTATE] = c;
                    this.frames[a + g.TRANSLATE] = d
                };
                g.prototype.apply = function(a, b, d, f, l, h, k) {
                    b = this.frames;
                    a = a.pathConstraints[this.pathConstraintIndex];
                    if (a.active)
                        if (d < b[0]) switch (h) {
                            case c.setup:
                                a.rotateMix = a.data.rotateMix;
                                a.translateMix = a.data.translateMix;
                                break;
                            case c.first:
                                a.rotateMix += (a.data.rotateMix - a.rotateMix) * l, a.translateMix += (a.data.translateMix - a.translateMix) * l
                        } else {
                            if (d >= b[b.length -
                                    g.ENTRIES]) f = b[b.length + g.PREV_ROTATE], k = b[b.length + g.PREV_TRANSLATE];
                            else {
                                var n = e.binarySearch(b, d, g.ENTRIES);
                                f = b[n + g.PREV_ROTATE];
                                k = b[n + g.PREV_TRANSLATE];
                                var p = b[n];
                                d = this.getCurvePercent(n / g.ENTRIES - 1, 1 - (d - p) / (b[n + g.PREV_TIME] - p));
                                f += (b[n + g.ROTATE] - f) * d;
                                k += (b[n + g.TRANSLATE] - k) * d
                            }
                            h == c.setup ? (a.rotateMix = a.data.rotateMix + (f - a.data.rotateMix) * l, a.translateMix = a.data.translateMix + (k - a.data.translateMix) * l) : (a.rotateMix += (f - a.rotateMix) * l, a.translateMix += (k - a.translateMix) * l)
                        }
                };
                g.ENTRIES = 3;
                g.PREV_TIME = -3;
                g.PREV_ROTATE = -2;
                g.PREV_TRANSLATE = -1;
                g.ROTATE = 1;
                g.TRANSLATE = 2;
                return g
            }(l);
            b.PathConstraintMixTimeline = l
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function d(d) {
                    this.tracks = [];
                    this.timeScale = 1;
                    this.events = [];
                    this.listeners = [];
                    this.queue = new a(this);
                    this.propertyIDs = new b.IntSet;
                    this.animationsChanged = !1;
                    this.trackEntryPool = new b.Pool(function() {
                        return new c
                    });
                    this.data = d
                }
                d.prototype.update = function(a) {
                    a *= this.timeScale;
                    for (var b = this.tracks, c = 0, d = b.length; c < d; c++) {
                        var e = b[c];
                        if (null != e) {
                            e.animationLast =
                                e.nextAnimationLast;
                            e.trackLast = e.nextTrackLast;
                            var g = a * e.timeScale;
                            if (0 < e.delay) {
                                e.delay -= g;
                                if (0 < e.delay) continue;
                                g = -e.delay;
                                e.delay = 0
                            }
                            var f = e.next;
                            if (null != f) {
                                var l = e.trackLast - f.delay;
                                if (0 <= l) {
                                    f.delay = 0;
                                    f.trackTime += 0 == e.timeScale ? 0 : (l / e.timeScale + a) * f.timeScale;
                                    e.trackTime += g;
                                    for (this.setCurrent(c, f, !0); null != f.mixingFrom;) f.mixTime += a, f = f.mixingFrom;
                                    continue
                                }
                            } else if (e.trackLast >= e.trackEnd && null == e.mixingFrom) {
                                b[c] = null;
                                this.queue.end(e);
                                this.disposeNext(e);
                                continue
                            }
                            if (null != e.mixingFrom && this.updateMixingFrom(e,
                                    a))
                                for (f = e.mixingFrom, e.mixingFrom = null, null != f && (f.mixingTo = null); null != f;) this.queue.end(f), f = f.mixingFrom;
                            e.trackTime += g
                        }
                    }
                    this.queue.drain()
                };
                d.prototype.updateMixingFrom = function(a, b) {
                    var c = a.mixingFrom;
                    if (null == c) return !0;
                    var d = this.updateMixingFrom(c, b);
                    c.animationLast = c.nextAnimationLast;
                    c.trackLast = c.nextTrackLast;
                    if (0 < a.mixTime && a.mixTime >= a.mixDuration) {
                        if (0 == c.totalAlpha || 0 == a.mixDuration) a.mixingFrom = c.mixingFrom, null != c.mixingFrom && (c.mixingFrom.mixingTo = a), a.interruptAlpha = c.interruptAlpha,
                            this.queue.end(c);
                        return d
                    }
                    c.trackTime += b * c.timeScale;
                    a.mixTime += b;
                    return !1
                };
                d.prototype.apply = function(a) {
                    if (null == a) throw Error("skeleton cannot be null.");
                    this.animationsChanged && this._animationsChanged();
                    for (var c = this.events, e = this.tracks, g = !1, f = 0, l = e.length; f < l; f++) {
                        var h = e[f];
                        if (!(null == h || 0 < h.delay)) {
                            g = !0;
                            var k = 0 == f ? b.MixBlend.first : h.mixBlend,
                                m = h.alpha;
                            null != h.mixingFrom ? m *= this.applyMixingFrom(h, a, k) : h.trackTime >= h.trackEnd && null == h.next && (m = 0);
                            var q = h.animationLast,
                                y = h.getAnimationTime(),
                                z = h.animation.timelines.length,
                                x = h.animation.timelines;
                            if (0 == f && 1 == m || k == b.MixBlend.add)
                                for (var C = 0; C < z; C++) b.Utils.webkit602BugfixHelper(m, k), x[C].apply(a, q, y, c, m, k, b.MixDirection.mixIn);
                            else {
                                var G = h.timelineMode,
                                    F = 0 == h.timelinesRotation.length;
                                F && b.Utils.setArraySize(h.timelinesRotation, z << 1, null);
                                var H = h.timelinesRotation;
                                for (C = 0; C < z; C++) {
                                    var I = x[C],
                                        K = (G[C] & d.NOT_LAST - 1) == d.SUBSEQUENT ? k : b.MixBlend.setup;
                                    I instanceof b.RotateTimeline ? this.applyRotateTimeline(I, a, y, m, K, H, C << 1, F) : (b.Utils.webkit602BugfixHelper(m,
                                        k), I.apply(a, q, y, c, m, K, b.MixDirection.mixIn))
                                }
                            }
                            this.queueEvents(h, y);
                            c.length = 0;
                            h.nextAnimationLast = y;
                            h.nextTrackLast = h.trackTime
                        }
                    }
                    this.queue.drain();
                    return g
                };
                d.prototype.applyMixingFrom = function(a, c, e) {
                    var g = a.mixingFrom;
                    null != g.mixingFrom && this.applyMixingFrom(g, c, e);
                    if (0 == a.mixDuration) {
                        var f = 1;
                        e == b.MixBlend.first && (e = b.MixBlend.setup)
                    } else f = a.mixTime / a.mixDuration, 1 < f && (f = 1), e != b.MixBlend.first && (e = g.mixBlend);
                    var l = f < g.eventThreshold ? this.events : null,
                        h = f < g.attachmentThreshold,
                        k = f < g.drawOrderThreshold,
                        n = g.animationLast,
                        m = g.getAnimationTime(),
                        w = g.animation.timelines.length,
                        q = g.animation.timelines,
                        x = g.alpha * a.interruptAlpha,
                        C = x * (1 - f);
                    if (e == b.MixBlend.add)
                        for (var G = 0; G < w; G++) q[G].apply(c, n, m, l, C, e, b.MixDirection.mixOut);
                    else {
                        var F = g.timelineMode,
                            H = g.timelineHoldMix,
                            I = 0 == g.timelinesRotation.length;
                        I && b.Utils.setArraySize(g.timelinesRotation, w << 1, null);
                        var K = g.timelinesRotation;
                        for (G = g.totalAlpha = 0; G < w; G++) {
                            var P = q[G],
                                S = b.MixDirection.mixOut;
                            switch (F[G] & d.NOT_LAST - 1) {
                                case d.SUBSEQUENT:
                                    var M = e;
                                    if (!h &&
                                        P instanceof b.AttachmentTimeline) {
                                        if ((F[G] & d.NOT_LAST) == d.NOT_LAST) continue;
                                        M = b.MixBlend.setup
                                    }
                                    if (!k && P instanceof b.DrawOrderTimeline) continue;
                                    var O = C;
                                    break;
                                case d.FIRST:
                                    M = b.MixBlend.setup;
                                    O = C;
                                    break;
                                case d.HOLD:
                                    M = b.MixBlend.setup;
                                    O = x;
                                    break;
                                default:
                                    M = b.MixBlend.setup, O = H[G], O = x * Math.max(0, 1 - O.mixTime / O.mixDuration)
                            }
                            g.totalAlpha += O;
                            P instanceof b.RotateTimeline ? this.applyRotateTimeline(P, c, m, O, M, K, G << 1, I) : (b.Utils.webkit602BugfixHelper(O, e), M == b.MixBlend.setup && (P instanceof b.AttachmentTimeline ?
                                (h || (F[G] & d.NOT_LAST) == d.NOT_LAST) && (S = b.MixDirection.mixIn) : P instanceof b.DrawOrderTimeline && k && (S = b.MixDirection.mixIn)), P.apply(c, n, m, l, O, M, S))
                        }
                    }
                    0 < a.mixDuration && this.queueEvents(g, m);
                    this.events.length = 0;
                    g.nextAnimationLast = m;
                    g.nextTrackLast = g.trackTime;
                    return f
                };
                d.prototype.applyRotateTimeline = function(a, c, d, e, f, l, h, k) {
                    k && (l[h] = 0);
                    if (1 == e) a.apply(c, 0, d, null, 1, f, b.MixDirection.mixIn);
                    else {
                        var g = a.frames;
                        c = c.bones[a.boneIndex];
                        if (c.active) {
                            if (d < g[0]) switch (f) {
                                    case b.MixBlend.setup:
                                        c.rotation =
                                            c.data.rotation;
                                    default:
                                        return;
                                    case b.MixBlend.first:
                                        f = c.rotation, g = c.data.rotation
                                } else if (f = f == b.MixBlend.setup ? c.data.rotation : c.rotation, d >= g[g.length - b.RotateTimeline.ENTRIES]) g = c.data.rotation + g[g.length + b.RotateTimeline.PREV_ROTATION];
                                else {
                                    var n = b.Animation.binarySearch(g, d, b.RotateTimeline.ENTRIES),
                                        m = g[n + b.RotateTimeline.PREV_ROTATION],
                                        p = g[n];
                                    a = a.getCurvePercent((n >> 1) - 1, 1 - (d - p) / (g[n + b.RotateTimeline.PREV_TIME] - p));
                                    g = g[n + b.RotateTimeline.ROTATION] - m;
                                    g = m + (g - 360 * (16384 - (16384.499999999996 - g /
                                        360 | 0))) * a + c.data.rotation;
                                    g -= 360 * (16384 - (16384.499999999996 - g / 360 | 0))
                                }
                            g -= f;
                            g -= 360 * (16384 - (16384.499999999996 - g / 360 | 0));
                            0 == g ? m = l[h] : (k ? (k = 0, m = g) : (k = l[h], m = l[h + 1]), a = 0 < g, d = 0 <= k, b.MathUtils.signum(m) != b.MathUtils.signum(g) && 90 >= Math.abs(m) && (180 < Math.abs(k) && (k += 360 * b.MathUtils.signum(k)), d = a), m = g + k - k % 360, d != a && (m += 360 * b.MathUtils.signum(k)), l[h] = m);
                            l[h + 1] = g;
                            f += m * e;
                            c.rotation = f - 360 * (16384 - (16384.499999999996 - f / 360 | 0))
                        }
                    }
                };
                d.prototype.queueEvents = function(a, b) {
                    for (var c = a.animationStart, d = a.animationEnd,
                            e = d - c, g = a.trackLast % e, f = this.events, l = 0, h = f.length; l < h; l++) {
                        var k = f[l];
                        if (k.time < g) break;
                        k.time > d || this.queue.event(a, k)
                    }
                    for ((a.loop ? 0 == e || g > a.trackTime % e : b >= d && a.animationLast < d) && this.queue.complete(a); l < h; l++) f[l].time < c || this.queue.event(a, f[l])
                };
                d.prototype.clearTracks = function() {
                    var a = this.queue.drainDisabled;
                    this.queue.drainDisabled = !0;
                    for (var b = 0, c = this.tracks.length; b < c; b++) this.clearTrack(b);
                    this.tracks.length = 0;
                    this.queue.drainDisabled = a;
                    this.queue.drain()
                };
                d.prototype.clearTrack = function(a) {
                    if (!(a >=
                            this.tracks.length) && (a = this.tracks[a], null != a)) {
                        this.queue.end(a);
                        this.disposeNext(a);
                        for (var b = a;;) {
                            var c = b.mixingFrom;
                            if (null == c) break;
                            this.queue.end(c);
                            b.mixingFrom = null;
                            b.mixingTo = null;
                            b = c
                        }
                        this.tracks[a.trackIndex] = null;
                        this.queue.drain()
                    }
                };
                d.prototype.setCurrent = function(a, b, c) {
                    var d = this.expandToIndex(a);
                    this.tracks[a] = b;
                    null != d && (c && this.queue.interrupt(d), b.mixingFrom = d, d.mixingTo = b, b.mixTime = 0, null != d.mixingFrom && 0 < d.mixDuration && (b.interruptAlpha *= Math.min(1, d.mixTime / d.mixDuration)), d.timelinesRotation.length =
                        0);
                    this.queue.start(b)
                };
                d.prototype.setAnimation = function(a, b, c) {
                    var d = this.data.skeletonData.findAnimation(b);
                    if (null == d) throw Error("Animation not found: " + b);
                    return this.setAnimationWith(a, d, c)
                };
                d.prototype.setAnimationWith = function(a, b, c) {
                    if (null == b) throw Error("animation cannot be null.");
                    var d = !0,
                        e = this.expandToIndex(a);
                    null != e && (-1 == e.nextTrackLast ? (this.tracks[a] = e.mixingFrom, this.queue.interrupt(e), this.queue.end(e), this.disposeNext(e), e = e.mixingFrom, d = !1) : this.disposeNext(e));
                    b = this.trackEntry(a,
                        b, c, e);
                    this.setCurrent(a, b, d);
                    this.queue.drain();
                    return b
                };
                d.prototype.addAnimation = function(a, b, c, d) {
                    var e = this.data.skeletonData.findAnimation(b);
                    if (null == e) throw Error("Animation not found: " + b);
                    return this.addAnimationWith(a, e, c, d)
                };
                d.prototype.addAnimationWith = function(a, b, c, d) {
                    if (null == b) throw Error("animation cannot be null.");
                    var e = this.expandToIndex(a);
                    if (null != e)
                        for (; null != e.next;) e = e.next;
                    c = this.trackEntry(a, b, c, e);
                    null == e ? (this.setCurrent(a, c, !0), this.queue.drain()) : (e.next = c, 0 >= d && (a =
                        e.animationEnd - e.animationStart, 0 != a ? (e.loop ? d += a * (1 + (e.trackTime / a | 0)) : d += Math.max(a, e.trackTime), d -= this.data.getMix(e.animation, b)) : d = e.trackTime));
                    c.delay = d;
                    return c
                };
                d.prototype.setEmptyAnimation = function(a, b) {
                    a = this.setAnimationWith(a, d.emptyAnimation, !1);
                    a.mixDuration = b;
                    a.trackEnd = b;
                    return a
                };
                d.prototype.addEmptyAnimation = function(a, b, c) {
                    0 >= c && (c -= b);
                    a = this.addAnimationWith(a, d.emptyAnimation, !1, c);
                    a.mixDuration = b;
                    a.trackEnd = b;
                    return a
                };
                d.prototype.setEmptyAnimations = function(a) {
                    var b = this.queue.drainDisabled;
                    this.queue.drainDisabled = !0;
                    for (var c = 0, d = this.tracks.length; c < d; c++) {
                        var e = this.tracks[c];
                        null != e && this.setEmptyAnimation(e.trackIndex, a)
                    }
                    this.queue.drainDisabled = b;
                    this.queue.drain()
                };
                d.prototype.expandToIndex = function(a) {
                    if (a < this.tracks.length) return this.tracks[a];
                    b.Utils.ensureArrayCapacity(this.tracks, a + 1, null);
                    this.tracks.length = a + 1;
                    return null
                };
                d.prototype.trackEntry = function(a, b, c, d) {
                    var e = this.trackEntryPool.obtain();
                    e.trackIndex = a;
                    e.animation = b;
                    e.loop = c;
                    e.holdPrevious = !1;
                    e.eventThreshold =
                        0;
                    e.attachmentThreshold = 0;
                    e.drawOrderThreshold = 0;
                    e.animationStart = 0;
                    e.animationEnd = b.duration;
                    e.animationLast = -1;
                    e.nextAnimationLast = -1;
                    e.delay = 0;
                    e.trackTime = 0;
                    e.trackLast = -1;
                    e.nextTrackLast = -1;
                    e.trackEnd = Number.MAX_VALUE;
                    e.timeScale = 1;
                    e.alpha = 1;
                    e.interruptAlpha = 1;
                    e.mixTime = 0;
                    e.mixDuration = null == d ? 0 : this.data.getMix(d.animation, b);
                    return e
                };
                d.prototype.disposeNext = function(a) {
                    for (var b = a.next; null != b;) this.queue.dispose(b), b = b.next;
                    a.next = null
                };
                d.prototype._animationsChanged = function() {
                    this.animationsChanged = !1;
                    this.propertyIDs.clear();
                    for (var a = 0, c = this.tracks.length; a < c; a++) {
                        var d = this.tracks[a];
                        if (null != d) {
                            for (; null != d.mixingFrom;) d = d.mixingFrom;
                            do null != d.mixingFrom && d.mixBlend == b.MixBlend.add || this.computeHold(d), d = d.mixingTo; while (null != d)
                        }
                    }
                    this.propertyIDs.clear();
                    for (a = this.tracks.length - 1; 0 <= a; a--)
                        for (d = this.tracks[a]; null != d;) this.computeNotLast(d), d = d.mixingFrom
                };
                d.prototype.computeHold = function(a) {
                    var c = a.mixingTo,
                        e = a.animation.timelines,
                        g = a.animation.timelines.length,
                        f = b.Utils.setArraySize(a.timelineMode,
                            g);
                    a.timelineHoldMix.length = 0;
                    var l = b.Utils.setArraySize(a.timelineHoldMix, g),
                        h = this.propertyIDs;
                    if (null != c && c.holdPrevious)
                        for (var k = 0; k < g; k++) h.add(e[k].getPropertyId()), f[k] = d.HOLD;
                    else a: for (k = 0; k < g; k++) {
                        var m = e[k],
                            q = m.getPropertyId();
                        if (h.add(q))
                            if (null == c || m instanceof b.AttachmentTimeline || m instanceof b.DrawOrderTimeline || m instanceof b.EventTimeline || !c.animation.hasTimeline(q)) f[k] = d.FIRST;
                            else {
                                for (m = c.mixingTo; null != m; m = m.mixingTo)
                                    if (!m.animation.hasTimeline(q)) {
                                        if (0 < a.mixDuration) {
                                            f[k] =
                                                d.HOLD_MIX;
                                            l[k] = m;
                                            continue a
                                        }
                                        break
                                    }
                                f[k] = d.HOLD
                            }
                        else f[k] = d.SUBSEQUENT
                    }
                };
                d.prototype.computeNotLast = function(a) {
                    var c = a.animation.timelines,
                        e = a.animation.timelines.length;
                    a = a.timelineMode;
                    for (var g = this.propertyIDs, f = 0; f < e; f++) c[f] instanceof b.AttachmentTimeline && (g.add(c[f].slotIndex) || (a[f] |= d.NOT_LAST))
                };
                d.prototype.getCurrent = function(a) {
                    return a >= this.tracks.length ? null : this.tracks[a]
                };
                d.prototype.addListener = function(a) {
                    if (null == a) throw Error("listener cannot be null.");
                    this.listeners.push(a)
                };
                d.prototype.removeListener = function(a) {
                    a = this.listeners.indexOf(a);
                    0 <= a && this.listeners.splice(a, 1)
                };
                d.prototype.clearListeners = function() {
                    this.listeners.length = 0
                };
                d.prototype.clearListenerNotifications = function() {
                    this.queue.clear()
                };
                d.emptyAnimation = new b.Animation("<empty>", [], 0);
                d.SUBSEQUENT = 0;
                d.FIRST = 1;
                d.HOLD = 2;
                d.HOLD_MIX = 3;
                d.NOT_LAST = 4;
                return d
            }();
            b.AnimationState = e;
            var c = function() {
                function a() {
                    this.mixBlend = b.MixBlend.replace;
                    this.timelineMode = [];
                    this.timelineHoldMix = [];
                    this.timelinesRotation = []
                }
                a.prototype.reset = function() {
                    this.listener = this.animation = this.mixingTo = this.mixingFrom = this.next = null;
                    this.timelineMode.length = 0;
                    this.timelineHoldMix.length = 0;
                    this.timelinesRotation.length = 0
                };
                a.prototype.getAnimationTime = function() {
                    if (this.loop) {
                        var a = this.animationEnd - this.animationStart;
                        return 0 == a ? this.animationStart : this.trackTime % a + this.animationStart
                    }
                    return Math.min(this.trackTime + this.animationStart, this.animationEnd)
                };
                a.prototype.setAnimationLast = function(a) {
                    this.nextAnimationLast = this.animationLast =
                        a
                };
                a.prototype.isComplete = function() {
                    return this.trackTime >= this.animationEnd - this.animationStart
                };
                a.prototype.resetRotationDirections = function() {
                    this.timelinesRotation.length = 0
                };
                return a
            }();
            b.TrackEntry = c;
            var a = function() {
                function a(a) {
                    this.objects = [];
                    this.drainDisabled = !1;
                    this.animState = a
                }
                a.prototype.start = function(a) {
                    this.objects.push(d.start);
                    this.objects.push(a);
                    this.animState.animationsChanged = !0
                };
                a.prototype.interrupt = function(a) {
                    this.objects.push(d.interrupt);
                    this.objects.push(a)
                };
                a.prototype.end =
                    function(a) {
                        this.objects.push(d.end);
                        this.objects.push(a);
                        this.animState.animationsChanged = !0
                    };
                a.prototype.dispose = function(a) {
                    this.objects.push(d.dispose);
                    this.objects.push(a)
                };
                a.prototype.complete = function(a) {
                    this.objects.push(d.complete);
                    this.objects.push(a)
                };
                a.prototype.event = function(a, b) {
                    this.objects.push(d.event);
                    this.objects.push(a);
                    this.objects.push(b)
                };
                a.prototype.drain = function() {
                    if (!this.drainDisabled) {
                        this.drainDisabled = !0;
                        for (var a = this.objects, b = this.animState.listeners, c = 0; c < a.length; c +=
                            2) {
                            var e = a[c + 1];
                            switch (a[c]) {
                                case d.start:
                                    null != e.listener && e.listener.start && e.listener.start(e);
                                    for (var f = 0; f < b.length; f++) b[f].start && b[f].start(e);
                                    break;
                                case d.interrupt:
                                    null != e.listener && e.listener.interrupt && e.listener.interrupt(e);
                                    for (f = 0; f < b.length; f++) b[f].interrupt && b[f].interrupt(e);
                                    break;
                                case d.end:
                                    for (null != e.listener && e.listener.end && e.listener.end(e), f = 0; f < b.length; f++) b[f].end && b[f].end(e);
                                case d.dispose:
                                    null != e.listener && e.listener.dispose && e.listener.dispose(e);
                                    for (f = 0; f < b.length; f++) b[f].dispose &&
                                        b[f].dispose(e);
                                    this.animState.trackEntryPool.free(e);
                                    break;
                                case d.complete:
                                    null != e.listener && e.listener.complete && e.listener.complete(e);
                                    for (f = 0; f < b.length; f++) b[f].complete && b[f].complete(e);
                                    break;
                                case d.event:
                                    var l = a[2 + c++];
                                    null != e.listener && e.listener.event && e.listener.event(e, l);
                                    for (f = 0; f < b.length; f++) b[f].event && b[f].event(e, l)
                            }
                        }
                        this.clear();
                        this.drainDisabled = !1
                    }
                };
                a.prototype.clear = function() {
                    this.objects.length = 0
                };
                return a
            }();
            b.EventQueue = a;
            var d;
            (function(a) {
                a[a.start = 0] = "start";
                a[a.interrupt =
                    1] = "interrupt";
                a[a.end = 2] = "end";
                a[a.dispose = 3] = "dispose";
                a[a.complete = 4] = "complete";
                a[a.event = 5] = "event"
            })(d = b.EventType || (b.EventType = {}));
            e = function() {
                function a() {}
                a.prototype.start = function(a) {};
                a.prototype.interrupt = function(a) {};
                a.prototype.end = function(a) {};
                a.prototype.dispose = function(a) {};
                a.prototype.complete = function(a) {};
                a.prototype.event = function(a, b) {};
                return a
            }();
            b.AnimationStateAdapter = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function b(a) {
                    this.animationToMixTime = {};
                    this.defaultMix =
                        0;
                    if (null == a) throw Error("skeletonData cannot be null.");
                    this.skeletonData = a
                }
                b.prototype.setMix = function(a, b, c) {
                    var d = this.skeletonData.findAnimation(a);
                    if (null == d) throw Error("Animation not found: " + a);
                    a = this.skeletonData.findAnimation(b);
                    if (null == a) throw Error("Animation not found: " + b);
                    this.setMixWith(d, a, c)
                };
                b.prototype.setMixWith = function(a, b, c) {
                    if (null == a) throw Error("from cannot be null.");
                    if (null == b) throw Error("to cannot be null.");
                    this.animationToMixTime[a.name + "." + b.name] = c
                };
                b.prototype.getMix =
                    function(a, b) {
                        a = this.animationToMixTime[a.name + "." + b.name];
                        return void 0 === a ? this.defaultMix : a
                    };
                return b
            }();
            b.AnimationStateData = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function c(a, b) {
                    void 0 === b && (b = "");
                    this.assets = {};
                    this.errors = {};
                    this.loaded = this.toLoad = 0;
                    this.textureLoader = a;
                    this.pathPrefix = b
                }
                c.downloadText = function(a, b, c) {
                    var d = new XMLHttpRequest;
                    d.open("GET", a, !0);
                    d.onload = function() {
                        200 == d.status ? b(d.responseText) : c(d.status, d.responseText)
                    };
                    d.onerror = function() {
                        c(d.status, d.responseText)
                    };
                    d.send()
                };
                c.downloadBinary = function(a, b, c) {
                    var d = new XMLHttpRequest;
                    d.open("GET", a, !0);
                    d.responseType = "arraybuffer";
                    d.onload = function() {
                        200 == d.status ? b(new Uint8Array(d.response)) : c(d.status, d.responseText)
                    };
                    d.onerror = function() {
                        c(d.status, d.responseText)
                    };
                    d.send()
                };
                c.prototype.loadBinary = function(a, b, e) {
                    var d = this;
                    void 0 === b && (b = null);
                    void 0 === e && (e = null);
                    a = this.pathPrefix + a;
                    this.toLoad++;
                    c.downloadBinary(a, function(c) {
                        d.assets[a] = c;
                        b && b(a, c);
                        d.toLoad--;
                        d.loaded++
                    }, function(b, c) {
                        d.errors[a] = "Couldn't load binary " +
                            a + ": status " + status + ", " + c;
                        e && e(a, "Couldn't load binary " + a + ": status " + status + ", " + c);
                        d.toLoad--;
                        d.loaded++
                    })
                };
                c.prototype.loadText = function(a, b, e) {
                    var d = this;
                    void 0 === b && (b = null);
                    void 0 === e && (e = null);
                    a = this.pathPrefix + a;
                    this.toLoad++;
                    c.downloadText(a, function(c) {
                        d.assets[a] = c;
                        b && b(a, c);
                        d.toLoad--;
                        d.loaded++
                    }, function(b, c) {
                        d.errors[a] = "Couldn't load text " + a + ": status " + status + ", " + c;
                        e && e(a, "Couldn't load text " + a + ": status " + status + ", " + c);
                        d.toLoad--;
                        d.loaded++
                    })
                };
                c.prototype.loadTexture = function(a,
                    b, c) {
                    var d = this;
                    void 0 === b && (b = null);
                    void 0 === c && (c = null);
                    a = this.pathPrefix + a;
                    this.toLoad++;
                    var e = new Image;
                    e.crossOrigin = "anonymous";
                    e.onload = function(c) {
                        c = d.textureLoader(e);
                        d.assets[a] = c;
                        d.toLoad--;
                        d.loaded++;
                        b && b(a, e)
                    };
                    e.onerror = function(b) {
                        d.errors[a] = "Couldn't load image " + a;
                        d.toLoad--;
                        d.loaded++;
                        c && c(a, "Couldn't load image " + a)
                    };
                    e.src = a
                };
                c.prototype.loadTextureData = function(a, b, c, e) {
                    var d = this;
                    void 0 === c && (c = null);
                    void 0 === e && (e = null);
                    a = this.pathPrefix + a;
                    this.toLoad++;
                    var g = new Image;
                    g.onload =
                        function(b) {
                            b = d.textureLoader(g);
                            d.assets[a] = b;
                            d.toLoad--;
                            d.loaded++;
                            c && c(a, g)
                        };
                    g.onerror = function(b) {
                        d.errors[a] = "Couldn't load image " + a;
                        d.toLoad--;
                        d.loaded++;
                        e && e(a, "Couldn't load image " + a)
                    };
                    g.src = b
                };
                c.prototype.loadTextureAtlas = function(a, d, e) {
                    var g = this;
                    void 0 === d && (d = null);
                    void 0 === e && (e = null);
                    var f = 0 <= a.lastIndexOf("/") ? a.substring(0, a.lastIndexOf("/")) : "";
                    a = this.pathPrefix + a;
                    this.toLoad++;
                    c.downloadText(a, function(c) {
                        var l = 0,
                            h = [];
                        try {
                            new b.TextureAtlas(c, function(a) {
                                h.push(f + "/" + a);
                                a = document.createElement("img");
                                a.width = 16;
                                a.height = 16;
                                return new b.FakeTexture(a)
                            })
                        } catch (A) {
                            var k = A;
                            g.errors[a] = "Couldn't load texture atlas " + a + ": " + k.message;
                            e && e(a, "Couldn't load texture atlas " + a + ": " + k.message);
                            g.toLoad--;
                            g.loaded++;
                            return
                        }
                        k = function(k) {
                            var n = !1;
                            g.loadTexture(k, function(k, m) {
                                l++;
                                if (l == h.length)
                                    if (n) g.errors[a] = "Couldn't load texture atlas page " + k + "} of atlas " + a, e && e(a, "Couldn't load texture atlas page " + k + " of atlas " + a), g.toLoad--, g.loaded++;
                                    else try {
                                        var p = new b.TextureAtlas(c, function(a) {
                                            return g.get(f +
                                                "/" + a)
                                        });
                                        g.assets[a] = p;
                                        d && d(a, p);
                                        g.toLoad--;
                                        g.loaded++
                                    } catch (x) {
                                        k = x, g.errors[a] = "Couldn't load texture atlas " + a + ": " + k.message, e && e(a, "Couldn't load texture atlas " + a + ": " + k.message), g.toLoad--, g.loaded++
                                    }
                            }, function(b, c) {
                                n = !0;
                                l++;
                                l == h.length && (g.errors[a] = "Couldn't load texture atlas page " + b + "} of atlas " + a, e && e(a, "Couldn't load texture atlas page " + b + " of atlas " + a), g.toLoad--, g.loaded++)
                            })
                        };
                        for (var n = 0; n < h.length; n++) k(h[n])
                    }, function(b, c) {
                        g.errors[a] = "Couldn't load texture atlas " + a + ": status " +
                            status + ", " + c;
                        e && e(a, "Couldn't load texture atlas " + a + ": status " + status + ", " + c);
                        g.toLoad--;
                        g.loaded++
                    })
                };
                c.prototype.get = function(a) {
                    a = this.pathPrefix + a;
                    return this.assets[a]
                };
                c.prototype.remove = function(a) {
                    a = this.pathPrefix + a;
                    var b = this.assets[a];
                    b.dispose && b.dispose();
                    this.assets[a] = null
                };
                c.prototype.removeAll = function() {
                    for (var a in this.assets) {
                        var b = this.assets[a];
                        b.dispose && b.dispose()
                    }
                    this.assets = {}
                };
                c.prototype.isLoadingComplete = function() {
                    return 0 == this.toLoad
                };
                c.prototype.getToLoad = function() {
                    return this.toLoad
                };
                c.prototype.getLoaded = function() {
                    return this.loaded
                };
                c.prototype.dispose = function() {
                    this.removeAll()
                };
                c.prototype.hasErrors = function() {
                    return 0 < Object.keys(this.errors).length
                };
                c.prototype.getErrors = function() {
                    return this.errors
                };
                return c
            }();
            b.AssetManager = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function c(a) {
                    this.atlas = a
                }
                c.prototype.newRegionAttachment = function(a, c, e) {
                    a = this.atlas.findRegion(e);
                    if (null == a) return null;
                    a.renderObject = a;
                    c = new b.RegionAttachment(c);
                    c.setRegion(a);
                    return c
                };
                c.prototype.newMeshAttachment =
                    function(a, c, e) {
                        a = this.atlas.findRegion(e);
                        if (null == a) return null;
                        a.renderObject = a;
                        c = new b.MeshAttachment(c);
                        c.region = a;
                        return c
                    };
                c.prototype.newBoundingBoxAttachment = function(a, c) {
                    return new b.BoundingBoxAttachment(c)
                };
                c.prototype.newPathAttachment = function(a, c) {
                    return new b.PathAttachment(c)
                };
                c.prototype.newPointAttachment = function(a, c) {
                    return new b.PointAttachment(c)
                };
                c.prototype.newClippingAttachment = function(a, c) {
                    return new b.ClippingAttachment(c)
                };
                return c
            }();
            b.AtlasAttachmentLoader = e
        })(e ||
            (e = {}));
        (function(b) {
            b = b.BlendMode || (b.BlendMode = {});
            b[b.Normal = 0] = "Normal";
            b[b.Additive = 1] = "Additive";
            b[b.Multiply = 2] = "Multiply";
            b[b.Screen = 3] = "Screen"
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function c(a, b, c) {
                    this.children = [];
                    this.ashearY = this.ashearX = this.ascaleY = this.ascaleX = this.arotation = this.ay = this.ax = this.shearY = this.shearX = this.scaleY = this.scaleX = this.rotation = this.y = this.x = 0;
                    this.appliedValid = !1;
                    this.worldX = this.worldY = this.d = this.c = this.b = this.a = 0;
                    this.active = this.sorted = !1;
                    if (null ==
                        a) throw Error("data cannot be null.");
                    if (null == b) throw Error("skeleton cannot be null.");
                    this.data = a;
                    this.skeleton = b;
                    this.parent = c;
                    this.setToSetupPose()
                }
                c.prototype.isActive = function() {
                    return this.active
                };
                c.prototype.update = function() {
                    this.updateWorldTransformWith(this.x, this.y, this.rotation, this.scaleX, this.scaleY, this.shearX, this.shearY)
                };
                c.prototype.updateWorldTransform = function() {
                    this.updateWorldTransformWith(this.x, this.y, this.rotation, this.scaleX, this.scaleY, this.shearX, this.shearY)
                };
                c.prototype.updateWorldTransformWith =
                    function(a, c, e, g, f, h, k) {
                        this.ax = a;
                        this.ay = c;
                        this.arotation = e;
                        this.ascaleX = g;
                        this.ascaleY = f;
                        this.ashearX = h;
                        this.ashearY = k;
                        this.appliedValid = !0;
                        var d = this.parent;
                        if (null == d) {
                            var l = this.skeleton;
                            k = e + 90 + k;
                            var n = l.scaleX,
                                m = l.scaleY;
                            this.a = b.MathUtils.cosDeg(e + h) * g * n;
                            this.b = b.MathUtils.cosDeg(k) * f * n;
                            this.c = b.MathUtils.sinDeg(e + h) * g * m;
                            this.d = b.MathUtils.sinDeg(k) * f * m;
                            this.worldX = a * n + l.x;
                            this.worldY = c * m + l.y
                        } else {
                            l = d.a;
                            n = d.b;
                            m = d.c;
                            var t = d.d;
                            this.worldX = l * a + n * c + d.worldX;
                            this.worldY = m * a + t * c + d.worldY;
                            switch (this.data.transformMode) {
                                case b.TransformMode.Normal:
                                    k =
                                        e + 90 + k;
                                    a = b.MathUtils.cosDeg(e + h) * g;
                                    c = b.MathUtils.cosDeg(k) * f;
                                    g *= b.MathUtils.sinDeg(e + h);
                                    f *= b.MathUtils.sinDeg(k);
                                    this.a = l * a + n * g;
                                    this.b = l * c + n * f;
                                    this.c = m * a + t * g;
                                    this.d = m * c + t * f;
                                    return;
                                case b.TransformMode.OnlyTranslation:
                                    k = e + 90 + k;
                                    this.a = b.MathUtils.cosDeg(e + h) * g;
                                    this.b = b.MathUtils.cosDeg(k) * f;
                                    this.c = b.MathUtils.sinDeg(e + h) * g;
                                    this.d = b.MathUtils.sinDeg(k) * f;
                                    break;
                                case b.TransformMode.NoRotationOrReflection:
                                    a = l * l + m * m;
                                    1E-4 < a ? (a = Math.abs(l * t - n * m) / a, n = m * a, t = l * a, a = Math.atan2(m, l) * b.MathUtils.radDeg) : (m = l = 0,
                                        a = 90 - Math.atan2(t, n) * b.MathUtils.radDeg);
                                    h = e + h - a;
                                    k = e + k - a + 90;
                                    a = b.MathUtils.cosDeg(h) * g;
                                    c = b.MathUtils.cosDeg(k) * f;
                                    g *= b.MathUtils.sinDeg(h);
                                    f *= b.MathUtils.sinDeg(k);
                                    this.a = l * a - n * g;
                                    this.b = l * c - n * f;
                                    this.c = m * a + t * g;
                                    this.d = m * c + t * f;
                                    break;
                                case b.TransformMode.NoScale:
                                case b.TransformMode.NoScaleOrReflection:
                                    a = b.MathUtils.cosDeg(e), c = b.MathUtils.sinDeg(e), e = (l * a + n * c) / this.skeleton.scaleX, d = (m * a + t * c) / this.skeleton.scaleY, a = Math.sqrt(e * e + d * d), 1E-5 < a && (a = 1 / a), e *= a, d *= a, a = Math.sqrt(e * e + d * d), this.data.transformMode ==
                                        b.TransformMode.NoScale && 0 > l * t - n * m != (0 > this.skeleton.scaleX != 0 > this.skeleton.scaleY) && (a = -a), n = Math.PI / 2 + Math.atan2(d, e), l = Math.cos(n) * a, n = Math.sin(n) * a, a = b.MathUtils.cosDeg(h) * g, c = b.MathUtils.cosDeg(90 + k) * f, g *= b.MathUtils.sinDeg(h), f *= b.MathUtils.sinDeg(90 + k), this.a = e * a + l * g, this.b = e * c + l * f, this.c = d * a + n * g, this.d = d * c + n * f
                            }
                            this.a *= this.skeleton.scaleX;
                            this.b *= this.skeleton.scaleX;
                            this.c *= this.skeleton.scaleY;
                            this.d *= this.skeleton.scaleY
                        }
                    };
                c.prototype.setToSetupPose = function() {
                    var a = this.data;
                    this.x = a.x;
                    this.y = a.y;
                    this.rotation = a.rotation;
                    this.scaleX = a.scaleX;
                    this.scaleY = a.scaleY;
                    this.shearX = a.shearX;
                    this.shearY = a.shearY
                };
                c.prototype.getWorldRotationX = function() {
                    return Math.atan2(this.c, this.a) * b.MathUtils.radDeg
                };
                c.prototype.getWorldRotationY = function() {
                    return Math.atan2(this.d, this.b) * b.MathUtils.radDeg
                };
                c.prototype.getWorldScaleX = function() {
                    return Math.sqrt(this.a * this.a + this.c * this.c)
                };
                c.prototype.getWorldScaleY = function() {
                    return Math.sqrt(this.b * this.b + this.d * this.d)
                };
                c.prototype.updateAppliedTransform =
                    function() {
                        this.appliedValid = !0;
                        var a = this.parent;
                        if (null == a) this.ax = this.worldX, this.ay = this.worldY, this.arotation = Math.atan2(this.c, this.a) * b.MathUtils.radDeg, this.ascaleX = Math.sqrt(this.a * this.a + this.c * this.c), this.ascaleY = Math.sqrt(this.b * this.b + this.d * this.d), this.ashearX = 0, this.ashearY = Math.atan2(this.a * this.b + this.c * this.d, this.a * this.d - this.b * this.c) * b.MathUtils.radDeg;
                        else {
                            var c = a.a,
                                e = a.b,
                                g = a.c,
                                f = a.d,
                                h = 1 / (c * f - e * g),
                                k = this.worldX - a.worldX;
                            a = this.worldY - a.worldY;
                            this.ax = k * f * h - a * e * h;
                            this.ay =
                                a * c * h - k * g * h;
                            f *= h;
                            c *= h;
                            e *= h;
                            h *= g;
                            g = f * this.a - e * this.c;
                            e = f * this.b - e * this.d;
                            f = c * this.c - h * this.a;
                            h = c * this.d - h * this.b;
                            this.ashearX = 0;
                            this.ascaleX = Math.sqrt(g * g + f * f);
                            1E-4 < this.ascaleX ? (c = g * h - e * f, this.ascaleY = c / this.ascaleX, this.ashearY = Math.atan2(g * e + f * h, c) * b.MathUtils.radDeg, this.arotation = Math.atan2(f, g) * b.MathUtils.radDeg) : (this.ascaleX = 0, this.ascaleY = Math.sqrt(e * e + h * h), this.ashearY = 0, this.arotation = 90 - Math.atan2(h, e) * b.MathUtils.radDeg)
                        }
                    };
                c.prototype.worldToLocal = function(a) {
                    var b = this.a,
                        c = this.b,
                        e =
                        this.c,
                        f = this.d,
                        h = 1 / (b * f - c * e),
                        k = a.x - this.worldX,
                        m = a.y - this.worldY;
                    a.x = k * f * h - m * c * h;
                    a.y = m * b * h - k * e * h;
                    return a
                };
                c.prototype.localToWorld = function(a) {
                    var b = a.x,
                        c = a.y;
                    a.x = b * this.a + c * this.b + this.worldX;
                    a.y = b * this.c + c * this.d + this.worldY;
                    return a
                };
                c.prototype.worldToLocalRotation = function(a) {
                    var c = b.MathUtils.sinDeg(a);
                    a = b.MathUtils.cosDeg(a);
                    return Math.atan2(this.a * c - this.c * a, this.d * a - this.b * c) * b.MathUtils.radDeg + this.rotation - this.shearX
                };
                c.prototype.localToWorldRotation = function(a) {
                    a -= this.rotation - this.shearX;
                    var c = b.MathUtils.sinDeg(a);
                    a = b.MathUtils.cosDeg(a);
                    return Math.atan2(a * this.c + c * this.d, a * this.a + c * this.b) * b.MathUtils.radDeg
                };
                c.prototype.rotateWorld = function(a) {
                    var c = this.a,
                        e = this.b,
                        g = this.c,
                        f = this.d,
                        h = b.MathUtils.cosDeg(a);
                    a = b.MathUtils.sinDeg(a);
                    this.a = h * c - a * g;
                    this.b = h * e - a * f;
                    this.c = a * c + h * g;
                    this.d = a * e + h * f;
                    this.appliedValid = !1
                };
                return c
            }();
            b.Bone = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                return function(a, d, e) {
                    this.rotation = this.y = this.x = 0;
                    this.scaleY = this.scaleX = 1;
                    this.shearY = this.shearX = 0;
                    this.transformMode = c.Normal;
                    this.skinRequired = !1;
                    this.color = new b.Color;
                    if (0 > a) throw Error("index must be >= 0.");
                    if (null == d) throw Error("name cannot be null.");
                    this.index = a;
                    this.name = d;
                    this.parent = e
                }
            }();
            b.BoneData = e;
            var c;
            (function(a) {
                a[a.Normal = 0] = "Normal";
                a[a.OnlyTranslation = 1] = "OnlyTranslation";
                a[a.NoRotationOrReflection = 2] = "NoRotationOrReflection";
                a[a.NoScale = 3] = "NoScale";
                a[a.NoScaleOrReflection = 4] = "NoScaleOrReflection"
            })(c = b.TransformMode || (b.TransformMode = {}))
        })(e || (e = {}));
        (function(b) {
            var e =
                function() {
                    return function(b, a, d) {
                        this.name = b;
                        this.order = a;
                        this.skinRequired = d
                    }
                }();
            b.ConstraintData = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                return function(b, a) {
                    if (null == a) throw Error("data cannot be null.");
                    this.time = b;
                    this.data = a
                }
            }();
            b.Event = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                return function(b) {
                    this.name = b
                }
            }();
            b.EventData = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function c(a, b) {
                    this.bendDirection = 0;
                    this.stretch = this.compress = !1;
                    this.mix = 1;
                    this.softness = 0;
                    this.active = !1;
                    if (null ==
                        a) throw Error("data cannot be null.");
                    if (null == b) throw Error("skeleton cannot be null.");
                    this.data = a;
                    this.mix = a.mix;
                    this.softness = a.softness;
                    this.bendDirection = a.bendDirection;
                    this.compress = a.compress;
                    this.stretch = a.stretch;
                    this.bones = [];
                    for (var c = 0; c < a.bones.length; c++) this.bones.push(b.findBone(a.bones[c].name));
                    this.target = b.findBone(a.target.name)
                }
                c.prototype.isActive = function() {
                    return this.active
                };
                c.prototype.apply = function() {
                    this.update()
                };
                c.prototype.update = function() {
                    var a = this.target,
                        b = this.bones;
                    switch (b.length) {
                        case 1:
                            this.apply1(b[0], a.worldX, a.worldY, this.compress, this.stretch, this.data.uniform, this.mix);
                            break;
                        case 2:
                            this.apply2(b[0], b[1], a.worldX, a.worldY, this.bendDirection, this.stretch, this.softness, this.mix)
                    }
                };
                c.prototype.apply1 = function(a, c, e, g, f, h, k) {
                    a.appliedValid || a.updateAppliedTransform();
                    var d = a.parent,
                        l = 1 / (d.a * d.d - d.b * d.c);
                    c -= d.worldX;
                    var n = e - d.worldY;
                    e = (c * d.d - n * d.b) * l - a.ax;
                    var m = (n * d.a - c * d.c) * l - a.ay;
                    d = Math.atan2(m, e) * b.MathUtils.radDeg - a.ashearX - a.arotation;
                    0 > a.ascaleX && (d +=
                        180);
                    180 < d ? d -= 360 : -180 > d && (d += 360);
                    l = a.ascaleX;
                    c = a.ascaleY;
                    if (g || f)
                        if (n = a.data.length * l, e = Math.sqrt(e * e + m * m), g && e < n || f && e > n && 1E-4 < n) g = (e / n - 1) * k + 1, l *= g, h && (c *= g);
                    a.updateWorldTransformWith(a.ax, a.ay, a.arotation + d * k, l, c, a.ashearX, a.ashearY)
                };
                c.prototype.apply2 = function(a, c, e, g, f, h, k, m) {
                    if (0 == m) c.updateWorldTransform();
                    else {
                        a.appliedValid || a.updateAppliedTransform();
                        c.appliedValid || c.updateAppliedTransform();
                        var d = a.ax,
                            l = a.ay,
                            n = a.ascaleX,
                            p = n,
                            t = a.ascaleY,
                            w = c.ascaleX;
                        if (0 > n) {
                            n = -n;
                            var q = 180;
                            var x = -1
                        } else q =
                            0, x = 1;
                        0 > t && (t = -t, x = -x);
                        if (0 > w) {
                            w = -w;
                            var C = 180
                        } else C = 0;
                        var G = c.ax,
                            F = a.a,
                            H = a.b,
                            I = a.c,
                            K = a.d,
                            P = 1E-4 >= Math.abs(n - t);
                        if (P) {
                            var S = c.ay;
                            var M = F * G + H * S + a.worldX;
                            var O = I * G + K * S + a.worldY
                        } else S = 0, M = F * G + a.worldX, O = I * G + a.worldY;
                        var L = a.parent;
                        F = L.a;
                        H = L.b;
                        I = L.c;
                        K = L.d;
                        var U = 1 / (F * K - H * I),
                            V = M - L.worldX;
                        M = O - L.worldY;
                        O = (V * K - M * H) * U - d;
                        M = (M * F - V * I) * U - l;
                        O = Math.sqrt(O * O + M * M);
                        var Z = c.data.length * w;
                        if (1E-4 > O) this.apply1(a, e, g, !1, h, !1, m), c.updateWorldTransformWith(G, S, 0, c.ascaleX, c.ascaleY, c.ashearX, c.ashearY);
                        else {
                            V = e - L.worldX;
                            M = g - L.worldY;
                            K = (V * K - M * H) * U - d;
                            I = (M * F - V * I) * U - l;
                            U = K * K + I * I;
                            0 != k && (k *= n * (w + 1) / 2, F = Math.sqrt(U), H = F - O - Z * n + k, 0 < H && (U = Math.min(1, H / (2 * k)) - 1, U = (H - k * (1 - U * U)) / F, K -= U * K, I -= U * I, U = K * K + I * I));
                            a: if (P) Z *= n, F = (U - O * O - Z * Z) / (2 * O * Z), -1 > F ? F = -1 : 1 < F && (F = 1, h && (p *= (Math.sqrt(U) / (O + Z) - 1) * m + 1)), f *= Math.acos(F), F = O + Z * F, H = Z * Math.sin(f), F = Math.atan2(I * F - K * H, K * F + I * H);
                                else {
                                    F = n * Z;
                                    H = t * Z;
                                    M = F * F;
                                    V = H * H;
                                    h = Math.atan2(I, K);
                                    I = V * O * O + M * U - M * V;
                                    k = -2 * V * O;
                                    P = V - M;
                                    K = k * k - 4 * P * I;
                                    if (0 <= K && (K = Math.sqrt(K), 0 > k && (K = -K), K = -(k + K) / 2, k = K / P, I /= K, I = Math.abs(k) < Math.abs(I) ?
                                            k : I, I * I <= U)) {
                                        M = Math.sqrt(U - I * I) * f;
                                        F = h - Math.atan2(M, I);
                                        f = Math.atan2(M / t, (I - O) / n);
                                        break a
                                    }
                                    n = b.MathUtils.PI;
                                    k = O - F;
                                    P = k * k;
                                    t = Z = 0;
                                    w = O + F;
                                    e = w * w;
                                    g = 0;
                                    I = -F * O / (M - V); - 1 <= I && 1 >= I && (I = Math.acos(I), V = F * Math.cos(I) + O, M = H * Math.sin(I), K = V * V + M * M, K < P && (n = I, P = K, k = V, Z = M), K > e && (t = I, e = K, w = V, g = M));
                                    U <= (P + e) / 2 ? (F = h - Math.atan2(Z * f, k), f *= n) : (F = h - Math.atan2(g * f, w), f *= t)
                                }
                            O = Math.atan2(S, G) * x;
                            H = a.arotation;
                            F = (F - O) * b.MathUtils.radDeg + q - H;
                            180 < F ? F -= 360 : -180 > F && (F += 360);
                            a.updateWorldTransformWith(d, l, H + F * m, p, a.ascaleY, 0, 0);
                            H = c.arotation;
                            f = ((f + O) * b.MathUtils.radDeg - c.ashearX) * x + C - H;
                            180 < f ? f -= 360 : -180 > f && (f += 360);
                            c.updateWorldTransformWith(G, S, H + f * m, c.ascaleX, c.ascaleY, c.ashearX, c.ashearY)
                        }
                    }
                };
                return c
            }();
            b.IkConstraint = e
        })(e || (e = {}));
        (function(b) {
            var e = function(b) {
                function a(a) {
                    a = b.call(this, a, 0, !1) || this;
                    a.bones = [];
                    a.bendDirection = 1;
                    a.compress = !1;
                    a.stretch = !1;
                    a.uniform = !1;
                    a.mix = 1;
                    a.softness = 0;
                    return a
                }
                f(a, b);
                return a
            }(b.ConstraintData);
            b.IkConstraintData = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function c(a, b) {
                    this.translateMix =
                        this.rotateMix = this.spacing = this.position = 0;
                    this.spaces = [];
                    this.positions = [];
                    this.world = [];
                    this.curves = [];
                    this.lengths = [];
                    this.segments = [];
                    this.active = !1;
                    if (null == a) throw Error("data cannot be null.");
                    if (null == b) throw Error("skeleton cannot be null.");
                    this.data = a;
                    this.bones = [];
                    for (var c = 0, d = a.bones.length; c < d; c++) this.bones.push(b.findBone(a.bones[c].name));
                    this.target = b.findSlot(a.target.name);
                    this.position = a.position;
                    this.spacing = a.spacing;
                    this.rotateMix = a.rotateMix;
                    this.translateMix = a.translateMix
                }
                c.prototype.isActive = function() {
                    return this.active
                };
                c.prototype.apply = function() {
                    this.update()
                };
                c.prototype.update = function() {
                    var a = this.target.getAttachment();
                    if (a instanceof b.PathAttachment) {
                        var d = this.rotateMix,
                            e = this.translateMix,
                            g = 0 < d;
                        if (0 < e || g) {
                            var f = this.data,
                                h = f.spacingMode == b.SpacingMode.Percent;
                            var k = f.rotateMode;
                            var m = k == b.RotateMode.Tangent,
                                u = k == b.RotateMode.ChainScale,
                                q = this.bones.length,
                                A = m ? q : q + 1,
                                B = this.bones,
                                E = b.Utils.setArraySize(this.spaces, A),
                                y = null,
                                z = this.spacing;
                            if (u || !h) {
                                u &&
                                    (y = b.Utils.setArraySize(this.lengths, q));
                                for (var x = f.spacingMode == b.SpacingMode.Length, C = 0, G = A - 1; C < G;) {
                                    var F = B[C];
                                    var H = F.data.length;
                                    if (H < c.epsilon) u && (y[C] = 0), E[++C] = 0;
                                    else if (h) {
                                        if (u) {
                                            var I = H * F.a;
                                            var K = H * F.c;
                                            y[C] = Math.sqrt(I * I + K * K)
                                        }
                                        E[++C] = z
                                    } else I = H * F.a, K = H * F.c, F = Math.sqrt(I * I + K * K), u && (y[C] = F), E[++C] = (x ? H + z : z) * F / H
                                }
                            } else
                                for (C = 1; C < A; C++) E[C] = z;
                            a = this.computeWorldPositions(a, A, m, f.positionMode == b.PositionMode.Percent, h);
                            h = a[0];
                            A = a[1];
                            f = f.offsetRotation;
                            0 == f ? z = k == b.RotateMode.Chain : (z = !1, k = this.target.bone,
                                f *= 0 < k.a * k.d - k.b * k.c ? b.MathUtils.degRad : -b.MathUtils.degRad);
                            C = 0;
                            for (k = 3; C < q; C++, k += 3) {
                                F = B[C];
                                F.worldX += (h - F.worldX) * e;
                                F.worldY += (A - F.worldY) * e;
                                I = a[k];
                                K = a[k + 1];
                                x = I - h;
                                G = K - A;
                                u && (h = y[C], 0 != h && (h = (Math.sqrt(x * x + G * G) / h - 1) * d + 1, F.a *= h, F.c *= h));
                                h = I;
                                A = K;
                                if (g) {
                                    K = F.a;
                                    I = F.b;
                                    H = F.c;
                                    var P = F.d;
                                    var S = m ? a[k - 1] : 0 == E[C + 1] ? a[k + 2] : Math.atan2(G, x);
                                    S -= Math.atan2(H, K);
                                    if (z) {
                                        var M = Math.cos(S);
                                        var O = Math.sin(S);
                                        var L = F.data.length;
                                        h += (L * (M * K - O * H) - x) * d;
                                        A += (L * (O * K + M * H) - G) * d
                                    } else S += f;
                                    S > b.MathUtils.PI ? S -= b.MathUtils.PI2 : S < -b.MathUtils.PI &&
                                        (S += b.MathUtils.PI2);
                                    S *= d;
                                    M = Math.cos(S);
                                    O = Math.sin(S);
                                    F.a = M * K - O * H;
                                    F.b = M * I - O * P;
                                    F.c = O * K + M * H;
                                    F.d = O * I + M * P
                                }
                                F.appliedValid = !1
                            }
                        }
                    }
                };
                c.prototype.computeWorldPositions = function(a, d, e, g, f) {
                    var l = this.target,
                        h = this.position,
                        k = this.spaces,
                        n = b.Utils.setArraySize(this.positions, 3 * d + 2),
                        m = a.closed,
                        q = a.worldVerticesLength,
                        B = q / 6,
                        E = c.NONE;
                    if (!a.constantSpeed) {
                        var y = a.lengths;
                        B -= m ? 1 : 2;
                        var z = y[B];
                        g && (h *= z);
                        if (f)
                            for (var x = 1; x < d; x++) k[x] *= z;
                        var C = b.Utils.setArraySize(this.world, 8);
                        for (var G = x = 0, F = 0; x < d; x++, G += 3) {
                            f = k[x];
                            g = h += f;
                            if (m) g %= z, 0 > g && (g += z), F = 0;
                            else {
                                if (0 > g) {
                                    E != c.BEFORE && (E = c.BEFORE, a.computeWorldVertices(l, 2, 4, C, 0, 2));
                                    this.addBeforePosition(g, C, 0, n, G);
                                    continue
                                }
                                if (g > z) {
                                    E != c.AFTER && (E = c.AFTER, a.computeWorldVertices(l, q - 6, 4, C, 0, 2));
                                    this.addAfterPosition(g - z, C, 0, n, G);
                                    continue
                                }
                            }
                            for (;; F++) {
                                var H = y[F];
                                if (!(g > H)) {
                                    if (0 == F) g /= H;
                                    else {
                                        var I = y[F - 1];
                                        g = (g - I) / (H - I)
                                    }
                                    break
                                }
                            }
                            F != E && (E = F, m && F == B ? (a.computeWorldVertices(l, q - 4, 4, C, 0, 2), a.computeWorldVertices(l, 0, 4, C, 4, 2)) : a.computeWorldVertices(l, 6 * F + 2, 8, C, 0, 2));
                            this.addCurvePosition(g,
                                C[0], C[1], C[2], C[3], C[4], C[5], C[6], C[7], n, G, e || 0 < x && 0 == f)
                        }
                        return n
                    }
                    m ? (q += 2, C = b.Utils.setArraySize(this.world, q), a.computeWorldVertices(l, 2, q - 4, C, 0, 2), a.computeWorldVertices(l, 0, 2, C, q - 4, 2), C[q - 2] = C[0], C[q - 1] = C[1]) : (B--, q -= 4, C = b.Utils.setArraySize(this.world, q), a.computeWorldVertices(l, 2, q, C, 0, 2));
                    l = b.Utils.setArraySize(this.curves, B);
                    y = 0;
                    z = C[0];
                    H = C[1];
                    var K = 0,
                        P = 0,
                        S = 0,
                        M = 0,
                        O = 0,
                        L = 0;
                    x = 0;
                    for (G = 2; x < B; x++, G += 6) {
                        K = C[G];
                        P = C[G + 1];
                        S = C[G + 2];
                        M = C[G + 3];
                        O = C[G + 4];
                        L = C[G + 5];
                        var U = .1875 * (z - 2 * K + S);
                        var V = .1875 * (H - 2 * P + M);
                        I = .09375 * (3 * (K - S) - z + O);
                        var Z = .09375 * (3 * (P - M) - H + L);
                        var da = 2 * U + I;
                        var Q = 2 * V + Z;
                        U = .75 * (K - z) + U + .16666667 * I;
                        V = .75 * (P - H) + V + .16666667 * Z;
                        y += Math.sqrt(U * U + V * V);
                        U += da;
                        V += Q;
                        da += I;
                        Q += Z;
                        y += Math.sqrt(U * U + V * V);
                        U += da;
                        V += Q;
                        y += Math.sqrt(U * U + V * V);
                        U += da + I;
                        V += Q + Z;
                        y += Math.sqrt(U * U + V * V);
                        l[x] = y;
                        z = O;
                        H = L
                    }
                    h *= g ? y : y / a.lengths[B - 1];
                    if (f)
                        for (x = 1; x < d; x++) k[x] *= y;
                    a = this.segments;
                    for (Z = F = G = x = B = 0; x < d; x++, G += 3) {
                        f = k[x];
                        g = h += f;
                        if (m) g %= y, 0 > g && (g += y), F = 0;
                        else {
                            if (0 > g) {
                                this.addBeforePosition(g, C, 0, n, G);
                                continue
                            }
                            if (g > y) {
                                this.addAfterPosition(g -
                                    y, C, q - 4, n, G);
                                continue
                            }
                        }
                        for (;; F++)
                            if (da = l[F], !(g > da)) {
                                0 == F ? g /= da : (I = l[F - 1], g = (g - I) / (da - I));
                                break
                            }
                        if (F != E) {
                            E = F;
                            var R = 6 * F;
                            z = C[R];
                            H = C[R + 1];
                            K = C[R + 2];
                            P = C[R + 3];
                            S = C[R + 4];
                            M = C[R + 5];
                            O = C[R + 6];
                            L = C[R + 7];
                            U = .03 * (z - 2 * K + S);
                            V = .03 * (H - 2 * P + M);
                            I = .006 * (3 * (K - S) - z + O);
                            Z = .006 * (3 * (P - M) - H + L);
                            da = 2 * U + I;
                            Q = 2 * V + Z;
                            U = .3 * (K - z) + U + .16666667 * I;
                            V = .3 * (P - H) + V + .16666667 * Z;
                            B = Math.sqrt(U * U + V * V);
                            a[0] = B;
                            for (R = 1; 8 > R; R++) U += da, V += Q, da += I, Q += Z, B += Math.sqrt(U * U + V * V), a[R] = B;
                            U += da;
                            V += Q;
                            B += Math.sqrt(U * U + V * V);
                            a[8] = B;
                            U += da + I;
                            V += Q + Z;
                            B += Math.sqrt(U * U + V * V);
                            a[9] = B;
                            Z = 0
                        }
                        for (g *= B;; Z++)
                            if (da = a[Z], !(g > da)) {
                                0 == Z ? g /= da : (I = a[Z - 1], g = Z + (g - I) / (da - I));
                                break
                            }
                        this.addCurvePosition(.1 * g, z, H, K, P, S, M, O, L, n, G, e || 0 < x && 0 == f)
                    }
                    return n
                };
                c.prototype.addBeforePosition = function(a, b, c, e, f) {
                    var d = b[c],
                        g = b[c + 1];
                    b = Math.atan2(b[c + 3] - g, b[c + 2] - d);
                    e[f] = d + a * Math.cos(b);
                    e[f + 1] = g + a * Math.sin(b);
                    e[f + 2] = b
                };
                c.prototype.addAfterPosition = function(a, b, c, e, f) {
                    var d = b[c + 2],
                        g = b[c + 3];
                    b = Math.atan2(g - b[c + 1], d - b[c]);
                    e[f] = d + a * Math.cos(b);
                    e[f + 1] = g + a * Math.sin(b);
                    e[f + 2] = b
                };
                c.prototype.addCurvePosition =
                    function(a, b, c, e, f, h, k, m, q, v, A, B) {
                        if (0 == a || isNaN(a)) v[A] = b, v[A + 1] = c, v[A + 2] = Math.atan2(f - c, e - b);
                        else {
                            var d = a * a,
                                g = d * a,
                                l = 1 - a,
                                n = l * l,
                                p = n * l,
                                t = l * a,
                                w = 3 * t;
                            l *= w;
                            w *= a;
                            m = b * p + e * l + h * w + m * g;
                            q = c * p + f * l + k * w + q * g;
                            v[A] = m;
                            v[A + 1] = q;
                            B && (v[A + 2] = .001 > a ? Math.atan2(f - c, e - b) : Math.atan2(q - (c * n + f * t * 2 + k * d), m - (b * n + e * t * 2 + h * d)))
                        }
                    };
                c.NONE = -1;
                c.BEFORE = -2;
                c.AFTER = -3;
                c.epsilon = 1E-5;
                return c
            }();
            b.PathConstraint = e
        })(e || (e = {}));
        (function(b) {
            var e = function(b) {
                function a(a) {
                    a = b.call(this, a, 0, !1) || this;
                    a.bones = [];
                    return a
                }
                f(a, b);
                return a
            }(b.ConstraintData);
            b.PathConstraintData = e;
            (function(b) {
                b[b.Fixed = 0] = "Fixed";
                b[b.Percent = 1] = "Percent"
            })(b.PositionMode || (b.PositionMode = {}));
            (function(b) {
                b[b.Length = 0] = "Length";
                b[b.Fixed = 1] = "Fixed";
                b[b.Percent = 2] = "Percent"
            })(b.SpacingMode || (b.SpacingMode = {}));
            (function(b) {
                b[b.Tangent = 0] = "Tangent";
                b[b.Chain = 1] = "Chain";
                b[b.ChainScale = 2] = "ChainScale"
            })(b.RotateMode || (b.RotateMode = {}))
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                    function a(a) {
                        this.toLoad = [];
                        this.assets = {};
                        this.clientId = a
                    }
                    a.prototype.loaded = function() {
                        var a =
                            0,
                            b;
                        for (b in this.assets) a++;
                        return a
                    };
                    return a
                }(),
                c = function() {
                    function a(a) {
                        void 0 === a && (a = "");
                        this.clientAssets = {};
                        this.queuedAssets = {};
                        this.rawAssets = {};
                        this.errors = {};
                        this.pathPrefix = a
                    }
                    a.prototype.queueAsset = function(a, b, c) {
                        var d = this.clientAssets[a];
                        if (null === d || void 0 === d) d = new e(a), this.clientAssets[a] = d;
                        null !== b && (d.textureLoader = b);
                        d.toLoad.push(c);
                        if (this.queuedAssets[c] === c) return !1;
                        this.queuedAssets[c] = c;
                        return !0
                    };
                    a.prototype.loadText = function(a, b) {
                        var c = this;
                        b = this.pathPrefix + b;
                        if (this.queueAsset(a,
                                null, b)) {
                            var d = new XMLHttpRequest;
                            d.onreadystatechange = function() {
                                d.readyState == XMLHttpRequest.DONE && (200 <= d.status && 300 > d.status ? c.rawAssets[b] = d.responseText : c.errors[b] = "Couldn't load text " + b + ": status " + d.status + ", " + d.responseText)
                            };
                            d.open("GET", b, !0);
                            d.send()
                        }
                    };
                    a.prototype.loadJson = function(a, b) {
                        var c = this;
                        b = this.pathPrefix + b;
                        if (this.queueAsset(a, null, b)) {
                            var d = new XMLHttpRequest;
                            d.onreadystatechange = function() {
                                d.readyState == XMLHttpRequest.DONE && (200 <= d.status && 300 > d.status ? c.rawAssets[b] =
                                    JSON.parse(d.responseText) : c.errors[b] = "Couldn't load text " + b + ": status " + d.status + ", " + d.responseText)
                            };
                            d.open("GET", b, !0);
                            d.send()
                        }
                    };
                    a.prototype.loadTexture = function(a, b, c) {
                        var d = this;
                        c = this.pathPrefix + c;
                        if (this.queueAsset(a, b, c)) {
                            var e = new Image;
                            e.src = c;
                            e.crossOrigin = "anonymous";
                            e.onload = function(a) {
                                d.rawAssets[c] = e
                            };
                            e.onerror = function(a) {
                                d.errors[c] = "Couldn't load image " + c
                            }
                        }
                    };
                    a.prototype.get = function(a, b) {
                        b = this.pathPrefix + b;
                        a = this.clientAssets[a];
                        return null === a || void 0 === a ? !0 : a.assets[b]
                    };
                    a.prototype.updateClientAssets = function(a) {
                        for (var b = 0; b < a.toLoad.length; b++) {
                            var c = a.toLoad[b],
                                d = a.assets[c];
                            if (null === d || void 0 === d) d = this.rawAssets[c], null !== d && void 0 !== d && (d instanceof HTMLImageElement ? a.assets[c] = a.textureLoader(d) : a.assets[c] = d)
                        }
                    };
                    a.prototype.isLoadingComplete = function(a) {
                        a = this.clientAssets[a];
                        if (null === a || void 0 === a) return !0;
                        this.updateClientAssets(a);
                        return a.toLoad.length == a.loaded()
                    };
                    a.prototype.dispose = function() {};
                    a.prototype.hasErrors = function() {
                        return 0 < Object.keys(this.errors).length
                    };
                    a.prototype.getErrors = function() {
                        return this.errors
                    };
                    return a
                }();
            b.SharedAssetManager = c
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function c(a) {
                    this._updateCache = [];
                    this.updateCacheReset = [];
                    this.time = 0;
                    this.scaleY = this.scaleX = 1;
                    this.y = this.x = 0;
                    if (null == a) throw Error("data cannot be null.");
                    this.data = a;
                    this.bones = [];
                    for (var c = 0; c < a.bones.length; c++) {
                        var e = a.bones[c];
                        if (null == e.parent) e = new b.Bone(e, this, null);
                        else {
                            var g = this.bones[e.parent.index];
                            e = new b.Bone(e, this, g);
                            g.children.push(e)
                        }
                        this.bones.push(e)
                    }
                    this.slots = [];
                    this.drawOrder = [];
                    for (c = 0; c < a.slots.length; c++) g = a.slots[c], e = this.bones[g.boneData.index], e = new b.Slot(g, e), this.slots.push(e), this.drawOrder.push(e);
                    this.ikConstraints = [];
                    for (c = 0; c < a.ikConstraints.length; c++) this.ikConstraints.push(new b.IkConstraint(a.ikConstraints[c], this));
                    this.transformConstraints = [];
                    for (c = 0; c < a.transformConstraints.length; c++) this.transformConstraints.push(new b.TransformConstraint(a.transformConstraints[c], this));
                    this.pathConstraints = [];
                    for (c = 0; c < a.pathConstraints.length; c++) this.pathConstraints.push(new b.PathConstraint(a.pathConstraints[c],
                        this));
                    this.color = new b.Color(1, 1, 1, 1);
                    this.updateCache()
                }
                c.prototype.updateCache = function() {
                    this._updateCache.length = 0;
                    this.updateCacheReset.length = 0;
                    for (var a = this.bones, b = 0, c = a.length; b < c; b++) {
                        var e = a[b];
                        e.sorted = e.data.skinRequired;
                        e.active = !e.sorted
                    }
                    if (null != this.skin) {
                        var f = this.skin.bones;
                        b = 0;
                        for (c = this.skin.bones.length; b < c; b++) {
                            e = this.bones[f[b].index];
                            do e.sorted = !1, e.active = !0, e = e.parent; while (null != e)
                        }
                    }
                    c = this.ikConstraints;
                    f = this.transformConstraints;
                    var h = this.pathConstraints,
                        k = c.length,
                        m = f.length,
                        q = h.length,
                        v = k + m + q;
                    b = 0;
                    a: for (; b < v; b++) {
                        for (var A = 0; A < k; A++)
                            if (e = c[A], e.data.order == b) {
                                this.sortIkConstraint(e);
                                continue a
                            }
                        for (A = 0; A < m; A++)
                            if (e = f[A], e.data.order == b) {
                                this.sortTransformConstraint(e);
                                continue a
                            }
                        for (A = 0; A < q; A++)
                            if (e = h[A], e.data.order == b) {
                                this.sortPathConstraint(e);
                                continue a
                            }
                    }
                    b = 0;
                    for (c = a.length; b < c; b++) this.sortBone(a[b])
                };
                c.prototype.sortIkConstraint = function(a) {
                    a.active = a.target.isActive() && (!a.data.skinRequired || null != this.skin && b.Utils.contains(this.skin.constraints, a.data, !0));
                    if (a.active) {
                        this.sortBone(a.target);
                        var c = a.bones,
                            e = c[0];
                        this.sortBone(e);
                        if (1 < c.length) {
                            var g = c[c.length - 1]; - 1 < this._updateCache.indexOf(g) || this.updateCacheReset.push(g)
                        }
                        this._updateCache.push(a);
                        this.sortReset(e.children);
                        c[c.length - 1].sorted = !0
                    }
                };
                c.prototype.sortPathConstraint = function(a) {
                    a.active = a.target.bone.isActive() && (!a.data.skinRequired || null != this.skin && b.Utils.contains(this.skin.constraints, a.data, !0));
                    if (a.active) {
                        var c = a.target,
                            e = c.data.index,
                            g = c.bone;
                        null != this.skin && this.sortPathConstraintAttachment(this.skin,
                            e, g);
                        null != this.data.defaultSkin && this.data.defaultSkin != this.skin && this.sortPathConstraintAttachment(this.data.defaultSkin, e, g);
                        for (var f = 0, h = this.data.skins.length; f < h; f++) this.sortPathConstraintAttachment(this.data.skins[f], e, g);
                        f = c.getAttachment();
                        f instanceof b.PathAttachment && this.sortPathConstraintAttachmentWith(f, g);
                        g = a.bones;
                        c = g.length;
                        for (f = 0; f < c; f++) this.sortBone(g[f]);
                        this._updateCache.push(a);
                        for (f = 0; f < c; f++) this.sortReset(g[f].children);
                        for (f = 0; f < c; f++) g[f].sorted = !0
                    }
                };
                c.prototype.sortTransformConstraint =
                    function(a) {
                        a.active = a.target.isActive() && (!a.data.skinRequired || null != this.skin && b.Utils.contains(this.skin.constraints, a.data, !0));
                        if (a.active) {
                            this.sortBone(a.target);
                            var c = a.bones,
                                e = c.length;
                            if (a.data.local)
                                for (var g = 0; g < e; g++) {
                                    var f = c[g];
                                    this.sortBone(f.parent); - 1 < this._updateCache.indexOf(f) || this.updateCacheReset.push(f)
                                } else
                                    for (g = 0; g < e; g++) this.sortBone(c[g]);
                            this._updateCache.push(a);
                            for (a = 0; a < e; a++) this.sortReset(c[a].children);
                            for (a = 0; a < e; a++) c[a].sorted = !0
                        }
                    };
                c.prototype.sortPathConstraintAttachment =
                    function(a, b, c) {
                        if (a = a.attachments[b])
                            for (var d in a) this.sortPathConstraintAttachmentWith(a[d], c)
                    };
                c.prototype.sortPathConstraintAttachmentWith = function(a, c) {
                    if (a instanceof b.PathAttachment)
                        if (a = a.bones, null == a) this.sortBone(c);
                        else {
                            c = this.bones;
                            for (var d = 0; d < a.length;) {
                                var e = a[d++];
                                for (e = d + e; d < e; d++) this.sortBone(c[a[d]])
                            }
                        }
                };
                c.prototype.sortBone = function(a) {
                    if (!a.sorted) {
                        var b = a.parent;
                        null != b && this.sortBone(b);
                        a.sorted = !0;
                        this._updateCache.push(a)
                    }
                };
                c.prototype.sortReset = function(a) {
                    for (var b =
                            0, c = a.length; b < c; b++) {
                        var e = a[b];
                        e.active && (e.sorted && this.sortReset(e.children), e.sorted = !1)
                    }
                };
                c.prototype.updateWorldTransform = function() {
                    for (var a = this.updateCacheReset, b = 0, c = a.length; b < c; b++) {
                        var e = a[b];
                        e.ax = e.x;
                        e.ay = e.y;
                        e.arotation = e.rotation;
                        e.ascaleX = e.scaleX;
                        e.ascaleY = e.scaleY;
                        e.ashearX = e.shearX;
                        e.ashearY = e.shearY;
                        e.appliedValid = !0
                    }
                    a = this._updateCache;
                    b = 0;
                    for (c = a.length; b < c; b++) a[b].update()
                };
                c.prototype.setToSetupPose = function() {
                    this.setBonesToSetupPose();
                    this.setSlotsToSetupPose()
                };
                c.prototype.setBonesToSetupPose =
                    function() {
                        var a = this.bones;
                        for (var b = 0, c = a.length; b < c; b++) a[b].setToSetupPose();
                        var e = this.ikConstraints;
                        b = 0;
                        for (c = e.length; b < c; b++) a = e[b], a.mix = a.data.mix, a.softness = a.data.softness, a.bendDirection = a.data.bendDirection, a.compress = a.data.compress, a.stretch = a.data.stretch;
                        var f = this.transformConstraints;
                        b = 0;
                        for (c = f.length; b < c; b++) a = f[b], e = a.data, a.rotateMix = e.rotateMix, a.translateMix = e.translateMix, a.scaleMix = e.scaleMix, a.shearMix = e.shearMix;
                        f = this.pathConstraints;
                        b = 0;
                        for (c = f.length; b < c; b++) a = f[b],
                            e = a.data, a.position = e.position, a.spacing = e.spacing, a.rotateMix = e.rotateMix, a.translateMix = e.translateMix
                    };
                c.prototype.setSlotsToSetupPose = function() {
                    var a = this.slots;
                    b.Utils.arrayCopy(a, 0, this.drawOrder, 0, a.length);
                    for (var c = 0, e = a.length; c < e; c++) a[c].setToSetupPose()
                };
                c.prototype.getRootBone = function() {
                    return 0 == this.bones.length ? null : this.bones[0]
                };
                c.prototype.findBone = function(a) {
                    if (null == a) throw Error("boneName cannot be null.");
                    for (var b = this.bones, c = 0, e = b.length; c < e; c++) {
                        var f = b[c];
                        if (f.data.name ==
                            a) return f
                    }
                    return null
                };
                c.prototype.findBoneIndex = function(a) {
                    if (null == a) throw Error("boneName cannot be null.");
                    for (var b = this.bones, c = 0, e = b.length; c < e; c++)
                        if (b[c].data.name == a) return c;
                    return -1
                };
                c.prototype.findSlot = function(a) {
                    if (null == a) throw Error("slotName cannot be null.");
                    for (var b = this.slots, c = 0, e = b.length; c < e; c++) {
                        var f = b[c];
                        if (f.data.name == a) return f
                    }
                    return null
                };
                c.prototype.findSlotIndex = function(a) {
                    if (null == a) throw Error("slotName cannot be null.");
                    for (var b = this.slots, c = 0, e = b.length; c <
                        e; c++)
                        if (b[c].data.name == a) return c;
                    return -1
                };
                c.prototype.setSkinByName = function(a) {
                    var b = this.data.findSkin(a);
                    if (null == b) throw Error("Skin not found: " + a);
                    this.setSkin(b)
                };
                c.prototype.setSkin = function(a) {
                    if (a != this.skin) {
                        if (null != a)
                            if (null != this.skin) a.attachAll(this, this.skin);
                            else
                                for (var b = this.slots, c = 0, e = b.length; c < e; c++) {
                                    var f = b[c],
                                        h = f.data.attachmentName;
                                    null != h && (h = a.getAttachment(c, h), null != h && f.setAttachment(h))
                                }
                        this.skin = a;
                        this.updateCache()
                    }
                };
                c.prototype.getAttachmentByName = function(a,
                    b) {
                    return this.getAttachment(this.data.findSlotIndex(a), b)
                };
                c.prototype.getAttachment = function(a, b) {
                    if (null == b) throw Error("attachmentName cannot be null.");
                    if (null != this.skin) {
                        var c = this.skin.getAttachment(a, b);
                        if (null != c) return c
                    }
                    return null != this.data.defaultSkin ? this.data.defaultSkin.getAttachment(a, b) : null
                };
                c.prototype.setAttachment = function(a, b) {
                    if (null == a) throw Error("slotName cannot be null.");
                    for (var c = this.slots, d = 0, e = c.length; d < e; d++) {
                        var f = c[d];
                        if (f.data.name == a) {
                            c = null;
                            if (null != b && (c =
                                    this.getAttachment(d, b), null == c)) throw Error("Attachment not found: " + b + ", for slot: " + a);
                            f.setAttachment(c);
                            return
                        }
                    }
                    throw Error("Slot not found: " + a);
                };
                c.prototype.findIkConstraint = function(a) {
                    if (null == a) throw Error("constraintName cannot be null.");
                    for (var b = this.ikConstraints, c = 0, e = b.length; c < e; c++) {
                        var f = b[c];
                        if (f.data.name == a) return f
                    }
                    return null
                };
                c.prototype.findTransformConstraint = function(a) {
                    if (null == a) throw Error("constraintName cannot be null.");
                    for (var b = this.transformConstraints, c = 0, e =
                            b.length; c < e; c++) {
                        var f = b[c];
                        if (f.data.name == a) return f
                    }
                    return null
                };
                c.prototype.findPathConstraint = function(a) {
                    if (null == a) throw Error("constraintName cannot be null.");
                    for (var b = this.pathConstraints, c = 0, e = b.length; c < e; c++) {
                        var f = b[c];
                        if (f.data.name == a) return f
                    }
                    return null
                };
                c.prototype.getBounds = function(a, c, e) {
                    void 0 === e && (e = Array(2));
                    if (null == a) throw Error("offset cannot be null.");
                    if (null == c) throw Error("size cannot be null.");
                    for (var d = this.drawOrder, f = Number.POSITIVE_INFINITY, l = Number.POSITIVE_INFINITY,
                            h = Number.NEGATIVE_INFINITY, k = Number.NEGATIVE_INFINITY, m = 0, q = d.length; m < q; m++) {
                        var A = d[m];
                        if (A.bone.active) {
                            var B = null,
                                E = A.getAttachment();
                            if (E instanceof b.RegionAttachment) {
                                var y = 8;
                                B = b.Utils.setArraySize(e, y, 0);
                                E.computeWorldVertices(A.bone, B, 0, 2)
                            } else E instanceof b.MeshAttachment && (y = E.worldVerticesLength, B = b.Utils.setArraySize(e, y, 0), E.computeWorldVertices(A, 0, y, B, 0, 2));
                            if (null != B)
                                for (A = 0, y = B.length; A < y; A += 2) {
                                    E = B[A];
                                    var z = B[A + 1];
                                    f = Math.min(f, E);
                                    l = Math.min(l, z);
                                    h = Math.max(h, E);
                                    k = Math.max(k, z)
                                }
                        }
                    }
                    a.set(f,
                        l);
                    c.set(h - f, k - l)
                };
                c.prototype.update = function(a) {
                    this.time += a
                };
                return c
            }();
            b.Skeleton = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function e(a) {
                    this.scale = 1;
                    this.linkedMeshes = [];
                    this.attachmentLoader = a
                }
                e.prototype.readSkeletonData = function(a) {
                    var d = this.scale,
                        g = new b.SkeletonData;
                    g.name = "";
                    a = new c(a);
                    g.hash = a.readString();
                    g.version = a.readString();
                    g.x = a.readFloat();
                    g.y = a.readFloat();
                    g.width = a.readFloat();
                    g.height = a.readFloat();
                    var f = a.readBoolean();
                    f && (g.fps = a.readFloat(), g.imagesPath = a.readString(),
                        g.audioPath = a.readString());
                    var h = a.readInt(!0);
                    for (var l = 0; l < h; l++) a.strings.push(a.readString());
                    h = a.readInt(!0);
                    for (l = 0; l < h; l++) {
                        var k = a.readString();
                        var m = 0 == l ? null : g.bones[a.readInt(!0)];
                        k = new b.BoneData(l, k, m);
                        k.rotation = a.readFloat();
                        k.x = a.readFloat() * d;
                        k.y = a.readFloat() * d;
                        k.scaleX = a.readFloat();
                        k.scaleY = a.readFloat();
                        k.shearX = a.readFloat();
                        k.shearY = a.readFloat();
                        k.length = a.readFloat() * d;
                        k.transformMode = e.TransformModeValues[a.readInt(!0)];
                        k.skinRequired = a.readBoolean();
                        f && b.Color.rgba8888ToColor(k.color,
                            a.readInt32());
                        g.bones.push(k)
                    }
                    h = a.readInt(!0);
                    for (l = 0; l < h; l++) k = a.readString(), m = g.bones[a.readInt(!0)], k = new b.SlotData(l, k, m), b.Color.rgba8888ToColor(k.color, a.readInt32()), m = a.readInt32(), -1 != m && b.Color.rgb888ToColor(k.darkColor = new b.Color, m), k.attachmentName = a.readStringRef(), k.blendMode = e.BlendModeValues[a.readInt(!0)], g.slots.push(k);
                    h = a.readInt(!0);
                    for (l = 0; l < h; l++) {
                        k = new b.IkConstraintData(a.readString());
                        k.order = a.readInt(!0);
                        k.skinRequired = a.readBoolean();
                        m = a.readInt(!0);
                        for (var q = 0; q <
                            m; q++) k.bones.push(g.bones[a.readInt(!0)]);
                        k.target = g.bones[a.readInt(!0)];
                        k.mix = a.readFloat();
                        k.softness = a.readFloat() * d;
                        k.bendDirection = a.readByte();
                        k.compress = a.readBoolean();
                        k.stretch = a.readBoolean();
                        k.uniform = a.readBoolean();
                        g.ikConstraints.push(k)
                    }
                    h = a.readInt(!0);
                    for (l = 0; l < h; l++) {
                        k = new b.TransformConstraintData(a.readString());
                        k.order = a.readInt(!0);
                        k.skinRequired = a.readBoolean();
                        m = a.readInt(!0);
                        for (q = 0; q < m; q++) k.bones.push(g.bones[a.readInt(!0)]);
                        k.target = g.bones[a.readInt(!0)];
                        k.local = a.readBoolean();
                        k.relative = a.readBoolean();
                        k.offsetRotation = a.readFloat();
                        k.offsetX = a.readFloat() * d;
                        k.offsetY = a.readFloat() * d;
                        k.offsetScaleX = a.readFloat();
                        k.offsetScaleY = a.readFloat();
                        k.offsetShearY = a.readFloat();
                        k.rotateMix = a.readFloat();
                        k.translateMix = a.readFloat();
                        k.scaleMix = a.readFloat();
                        k.shearMix = a.readFloat();
                        g.transformConstraints.push(k)
                    }
                    h = a.readInt(!0);
                    for (l = 0; l < h; l++) {
                        k = new b.PathConstraintData(a.readString());
                        k.order = a.readInt(!0);
                        k.skinRequired = a.readBoolean();
                        m = a.readInt(!0);
                        for (q = 0; q < m; q++) k.bones.push(g.bones[a.readInt(!0)]);
                        k.target = g.slots[a.readInt(!0)];
                        k.positionMode = e.PositionModeValues[a.readInt(!0)];
                        k.spacingMode = e.SpacingModeValues[a.readInt(!0)];
                        k.rotateMode = e.RotateModeValues[a.readInt(!0)];
                        k.offsetRotation = a.readFloat();
                        k.position = a.readFloat();
                        k.positionMode == b.PositionMode.Fixed && (k.position *= d);
                        k.spacing = a.readFloat();
                        k.spacingMode != b.SpacingMode.Length && k.spacingMode != b.SpacingMode.Fixed || (k.spacing *= d);
                        k.rotateMix = a.readFloat();
                        k.translateMix = a.readFloat();
                        g.pathConstraints.push(k)
                    }
                    h = this.readSkin(a, g, !0, f);
                    null != h && (g.defaultSkin = h, g.skins.push(h));
                    l = g.skins.length;
                    for (b.Utils.setArraySize(g.skins, h = l + a.readInt(!0)); l < h; l++) g.skins[l] = this.readSkin(a, g, !1, f);
                    h = this.linkedMeshes.length;
                    for (l = 0; l < h; l++) {
                        d = this.linkedMeshes[l];
                        f = null == d.skin ? g.defaultSkin : g.findSkin(d.skin);
                        if (null == f) throw Error("Skin not found: " + d.skin);
                        f = f.getAttachment(d.slotIndex, d.parent);
                        if (null == f) throw Error("Parent mesh not found: " + d.parent);
                        d.mesh.deformAttachment = d.inheritDeform ? f : d.mesh;
                        d.mesh.setParentMesh(f);
                        d.mesh.updateUVs()
                    }
                    this.linkedMeshes.length =
                        0;
                    h = a.readInt(!0);
                    for (l = 0; l < h; l++) k = new b.EventData(a.readStringRef()), k.intValue = a.readInt(!1), k.floatValue = a.readFloat(), k.stringValue = a.readString(), k.audioPath = a.readString(), null != k.audioPath && (k.volume = a.readFloat(), k.balance = a.readFloat()), g.events.push(k);
                    h = a.readInt(!0);
                    for (l = 0; l < h; l++) g.animations.push(this.readAnimation(a, a.readString(), g));
                    return g
                };
                e.prototype.readSkin = function(a, c, d, e) {
                    if (d) {
                        var g = a.readInt(!0);
                        if (0 == g) return null;
                        d = new b.Skin("default")
                    } else {
                        d = new b.Skin(a.readStringRef());
                        d.bones.length = a.readInt(!0);
                        var f = 0;
                        for (g = d.bones.length; f < g; f++) d.bones[f] = c.bones[a.readInt(!0)];
                        f = 0;
                        for (g = a.readInt(!0); f < g; f++) d.constraints.push(c.ikConstraints[a.readInt(!0)]);
                        f = 0;
                        for (g = a.readInt(!0); f < g; f++) d.constraints.push(c.transformConstraints[a.readInt(!0)]);
                        f = 0;
                        for (g = a.readInt(!0); f < g; f++) d.constraints.push(c.pathConstraints[a.readInt(!0)]);
                        g = a.readInt(!0)
                    }
                    for (f = 0; f < g; f++)
                        for (var h = a.readInt(!0), l = 0, k = a.readInt(!0); l < k; l++) {
                            var n = a.readStringRef(),
                                m = this.readAttachment(a, c, d, h, n, e);
                            null != m && d.setAttachment(h, n, m)
                        }
                    return d
                };
                e.prototype.readAttachment = function(c, d, f, h, l, k) {
                    var g = this.scale,
                        n = c.readStringRef();
                    null == n && (n = l);
                    l = c.readByte();
                    switch (e.AttachmentTypeValues[l]) {
                        case b.AttachmentType.Region:
                            d = c.readStringRef();
                            h = c.readFloat();
                            var m = c.readFloat(),
                                p = c.readFloat();
                            k = c.readFloat();
                            var t = c.readFloat(),
                                q = c.readFloat(),
                                w = c.readFloat();
                            l = c.readInt32();
                            null == d && (d = n);
                            c = this.attachmentLoader.newRegionAttachment(f, n, d);
                            if (null == c) break;
                            c.path = d;
                            c.x = m * g;
                            c.y = p * g;
                            c.scaleX = k;
                            c.scaleY =
                                t;
                            c.rotation = h;
                            c.width = q * g;
                            c.height = w * g;
                            b.Color.rgba8888ToColor(c.color, l);
                            c.updateOffset();
                            return c;
                        case b.AttachmentType.BoundingBox:
                            h = c.readInt(!0);
                            m = this.readVertices(c, h);
                            l = k ? c.readInt32() : 0;
                            g = this.attachmentLoader.newBoundingBoxAttachment(f, n);
                            if (null == g) break;
                            g.worldVerticesLength = h << 1;
                            g.vertices = m.vertices;
                            g.bones = m.bones;
                            k && b.Color.rgba8888ToColor(g.color, l);
                            return g;
                        case b.AttachmentType.Mesh:
                            d = c.readStringRef();
                            l = c.readInt32();
                            h = c.readInt(!0);
                            p = this.readFloatArray(c, h << 1, 1);
                            t = this.readShortArray(c);
                            m = this.readVertices(c, h);
                            var u = c.readInt(!0),
                                G = null;
                            w = q = 0;
                            k && (G = this.readShortArray(c), q = c.readFloat(), w = c.readFloat());
                            null == d && (d = n);
                            c = this.attachmentLoader.newMeshAttachment(f, n, d);
                            if (null == c) break;
                            c.path = d;
                            b.Color.rgba8888ToColor(c.color, l);
                            c.bones = m.bones;
                            c.vertices = m.vertices;
                            c.worldVerticesLength = h << 1;
                            c.triangles = t;
                            c.regionUVs = p;
                            c.updateUVs();
                            c.hullLength = u << 1;
                            k && (c.edges = G, c.width = q * g, c.height = w * g);
                            return c;
                        case b.AttachmentType.LinkedMesh:
                            d = c.readStringRef();
                            l = c.readInt32();
                            m = c.readStringRef();
                            p = c.readStringRef();
                            t = c.readBoolean();
                            w = q = 0;
                            k && (q = c.readFloat(), w = c.readFloat());
                            null == d && (d = n);
                            c = this.attachmentLoader.newMeshAttachment(f, n, d);
                            if (null == c) break;
                            c.path = d;
                            b.Color.rgba8888ToColor(c.color, l);
                            k && (c.width = q * g, c.height = w * g);
                            this.linkedMeshes.push(new a(c, m, h, p, t));
                            return c;
                        case b.AttachmentType.Path:
                            q = c.readBoolean();
                            w = c.readBoolean();
                            h = c.readInt(!0);
                            m = this.readVertices(c, h);
                            p = b.Utils.newArray(h / 3, 0);
                            l = 0;
                            for (d = p.length; l < d; l++) p[l] = c.readFloat() * g;
                            l = k ? c.readInt32() : 0;
                            d = this.attachmentLoader.newPathAttachment(f,
                                n);
                            if (null == d) break;
                            d.closed = q;
                            d.constantSpeed = w;
                            d.worldVerticesLength = h << 1;
                            d.vertices = m.vertices;
                            d.bones = m.bones;
                            d.lengths = p;
                            k && b.Color.rgba8888ToColor(d.color, l);
                            return d;
                        case b.AttachmentType.Point:
                            h = c.readFloat();
                            m = c.readFloat();
                            p = c.readFloat();
                            l = k ? c.readInt32() : 0;
                            c = this.attachmentLoader.newPointAttachment(f, n);
                            if (null == c) break;
                            c.x = m * g;
                            c.y = p * g;
                            c.rotation = h;
                            k && b.Color.rgba8888ToColor(c.color, l);
                            return c;
                        case b.AttachmentType.Clipping:
                            if (g = c.readInt(!0), h = c.readInt(!0), m = this.readVertices(c, h),
                                l = k ? c.readInt32() : 0, c = this.attachmentLoader.newClippingAttachment(f, n), null != c) return c.endSlot = d.slots[g], c.worldVerticesLength = h << 1, c.vertices = m.vertices, c.bones = m.bones, k && b.Color.rgba8888ToColor(c.color, l), c
                    }
                    return null
                };
                e.prototype.readVertices = function(a, c) {
                    var e = c << 1,
                        g = new d,
                        f = this.scale;
                    if (!a.readBoolean()) return g.vertices = this.readFloatArray(a, e, f), g;
                    e = [];
                    for (var h = [], l = 0; l < c; l++) {
                        var k = a.readInt(!0);
                        h.push(k);
                        for (var n = 0; n < k; n++) h.push(a.readInt(!0)), e.push(a.readFloat() * f), e.push(a.readFloat() *
                            f), e.push(a.readFloat())
                    }
                    g.vertices = b.Utils.toFloatArray(e);
                    g.bones = h;
                    return g
                };
                e.prototype.readFloatArray = function(a, b, c) {
                    var d = Array(b);
                    if (1 == c)
                        for (var e = 0; e < b; e++) d[e] = a.readFloat();
                    else
                        for (e = 0; e < b; e++) d[e] = a.readFloat() * c;
                    return d
                };
                e.prototype.readShortArray = function(a) {
                    for (var b = a.readInt(!0), c = Array(b), d = 0; d < b; d++) c[d] = a.readShort();
                    return c
                };
                e.prototype.readAnimation = function(a, c, d) {
                    for (var g, f, h, l, k = [], n = this.scale, m = 0, q = new b.Color, w = new b.Color, x = 0, C = a.readInt(!0); x < C; x++) {
                        h = a.readInt(!0);
                        for (var G = 0, F = a.readInt(!0); G < F; G++) switch (f = a.readByte(), l = a.readInt(!0), f) {
                            case e.SLOT_ATTACHMENT:
                                f = new b.AttachmentTimeline(l);
                                f.slotIndex = h;
                                for (var H = 0; H < l; H++) f.setFrame(H, a.readFloat(), a.readStringRef());
                                k.push(f);
                                m = Math.max(m, f.frames[l - 1]);
                                break;
                            case e.SLOT_COLOR:
                                f = new b.ColorTimeline(l);
                                f.slotIndex = h;
                                for (H = 0; H < l; H++) g = a.readFloat(), b.Color.rgba8888ToColor(q, a.readInt32()), f.setFrame(H, g, q.r, q.g, q.b, q.a), H < l - 1 && this.readCurve(a, H, f);
                                k.push(f);
                                m = Math.max(m, f.frames[(l - 1) * b.ColorTimeline.ENTRIES]);
                                break;
                            case e.SLOT_TWO_COLOR:
                                f = new b.TwoColorTimeline(l);
                                f.slotIndex = h;
                                for (H = 0; H < l; H++) g = a.readFloat(), b.Color.rgba8888ToColor(q, a.readInt32()), b.Color.rgb888ToColor(w, a.readInt32()), f.setFrame(H, g, q.r, q.g, q.b, q.a, w.r, w.g, w.b), H < l - 1 && this.readCurve(a, H, f);
                                k.push(f);
                                m = Math.max(m, f.frames[(l - 1) * b.TwoColorTimeline.ENTRIES])
                        }
                    }
                    x = 0;
                    for (C = a.readInt(!0); x < C; x++)
                        for (h = a.readInt(!0), G = 0, F = a.readInt(!0); G < F; G++) switch (f = a.readByte(), l = a.readInt(!0), f) {
                            case e.BONE_ROTATE:
                                f = new b.RotateTimeline(l);
                                f.boneIndex =
                                    h;
                                for (H = 0; H < l; H++) f.setFrame(H, a.readFloat(), a.readFloat()), H < l - 1 && this.readCurve(a, H, f);
                                k.push(f);
                                m = Math.max(m, f.frames[(l - 1) * b.RotateTimeline.ENTRIES]);
                                break;
                            case e.BONE_TRANSLATE:
                            case e.BONE_SCALE:
                            case e.BONE_SHEAR:
                                g = 1;
                                f == e.BONE_SCALE ? f = new b.ScaleTimeline(l) : f == e.BONE_SHEAR ? f = new b.ShearTimeline(l) : (f = new b.TranslateTimeline(l), g = n);
                                f.boneIndex = h;
                                for (H = 0; H < l; H++) f.setFrame(H, a.readFloat(), a.readFloat() * g, a.readFloat() * g), H < l - 1 && this.readCurve(a, H, f);
                                k.push(f);
                                m = Math.max(m, f.frames[(l - 1) * b.TranslateTimeline.ENTRIES])
                        }
                    x =
                        0;
                    for (C = a.readInt(!0); x < C; x++) {
                        h = a.readInt(!0);
                        l = a.readInt(!0);
                        f = new b.IkConstraintTimeline(l);
                        f.ikConstraintIndex = h;
                        for (H = 0; H < l; H++) f.setFrame(H, a.readFloat(), a.readFloat(), a.readFloat() * n, a.readByte(), a.readBoolean(), a.readBoolean()), H < l - 1 && this.readCurve(a, H, f);
                        k.push(f);
                        m = Math.max(m, f.frames[(l - 1) * b.IkConstraintTimeline.ENTRIES])
                    }
                    x = 0;
                    for (C = a.readInt(!0); x < C; x++) {
                        h = a.readInt(!0);
                        l = a.readInt(!0);
                        f = new b.TransformConstraintTimeline(l);
                        f.transformConstraintIndex = h;
                        for (H = 0; H < l; H++) f.setFrame(H, a.readFloat(),
                            a.readFloat(), a.readFloat(), a.readFloat(), a.readFloat()), H < l - 1 && this.readCurve(a, H, f);
                        k.push(f);
                        m = Math.max(m, f.frames[(l - 1) * b.TransformConstraintTimeline.ENTRIES])
                    }
                    x = 0;
                    for (C = a.readInt(!0); x < C; x++)
                        for (h = a.readInt(!0), q = d.pathConstraints[h], G = 0, F = a.readInt(!0); G < F; G++) switch (f = a.readByte(), l = a.readInt(!0), f) {
                            case e.PATH_POSITION:
                            case e.PATH_SPACING:
                                g = 1;
                                f == e.PATH_SPACING ? (f = new b.PathConstraintSpacingTimeline(l), q.spacingMode != b.SpacingMode.Length && q.spacingMode != b.SpacingMode.Fixed || (g = n)) : (f = new b.PathConstraintPositionTimeline(l),
                                    q.positionMode == b.PositionMode.Fixed && (g = n));
                                f.pathConstraintIndex = h;
                                for (H = 0; H < l; H++) f.setFrame(H, a.readFloat(), a.readFloat() * g), H < l - 1 && this.readCurve(a, H, f);
                                k.push(f);
                                m = Math.max(m, f.frames[(l - 1) * b.PathConstraintPositionTimeline.ENTRIES]);
                                break;
                            case e.PATH_MIX:
                                f = new b.PathConstraintMixTimeline(l);
                                f.pathConstraintIndex = h;
                                for (H = 0; H < l; H++) f.setFrame(H, a.readFloat(), a.readFloat(), a.readFloat()), H < l - 1 && this.readCurve(a, H, f);
                                k.push(f);
                                m = Math.max(m, f.frames[(l - 1) * b.PathConstraintMixTimeline.ENTRIES])
                        }
                    x =
                        0;
                    for (C = a.readInt(!0); x < C; x++)
                        for (q = d.skins[a.readInt(!0)], G = 0, F = a.readInt(!0); G < F; G++) {
                            h = a.readInt(!0);
                            w = 0;
                            for (var I = a.readInt(!0); w < I; w++) {
                                g = q.getAttachment(h, a.readStringRef());
                                var K = null != g.bones,
                                    P = g.vertices,
                                    S = K ? P.length / 3 * 2 : P.length;
                                l = a.readInt(!0);
                                f = new b.DeformTimeline(l);
                                f.slotIndex = h;
                                f.attachment = g;
                                for (H = 0; H < l; H++) {
                                    g = a.readFloat();
                                    var M = a.readInt(!0);
                                    if (0 == M) var O = K ? b.Utils.newFloatArray(S) : P;
                                    else {
                                        O = b.Utils.newFloatArray(S);
                                        var L = a.readInt(!0);
                                        M += L;
                                        if (1 == n)
                                            for (; L < M; L++) O[L] = a.readFloat();
                                        else
                                            for (; L < M; L++) O[L] = a.readFloat() * n;
                                        if (!K)
                                            for (L = 0, M = O.length; L < M; L++) O[L] += P[L]
                                    }
                                    f.setFrame(H, g, O);
                                    H < l - 1 && this.readCurve(a, H, f)
                                }
                                k.push(f);
                                m = Math.max(m, f.frames[l - 1])
                            }
                        }
                    l = a.readInt(!0);
                    if (0 < l) {
                        f = new b.DrawOrderTimeline(l);
                        n = d.slots.length;
                        for (x = 0; x < l; x++) {
                            g = a.readFloat();
                            C = a.readInt(!0);
                            F = b.Utils.newArray(n, 0);
                            for (G = n - 1; 0 <= G; G--) F[G] = -1;
                            H = b.Utils.newArray(n - C, 0);
                            for (G = w = q = 0; G < C; G++) {
                                for (h = a.readInt(!0); q != h;) H[w++] = q++;
                                F[q + a.readInt(!0)] = q++
                            }
                            for (; q < n;) H[w++] = q++;
                            for (G = n - 1; 0 <= G; G--) - 1 == F[G] && (F[G] =
                                H[--w]);
                            f.setFrame(x, g, F)
                        }
                        k.push(f);
                        m = Math.max(m, f.frames[l - 1])
                    }
                    G = a.readInt(!0);
                    if (0 < G) {
                        f = new b.EventTimeline(G);
                        for (x = 0; x < G; x++) g = a.readFloat(), h = d.events[a.readInt(!0)], g = new b.Event(g, h), g.intValue = a.readInt(!1), g.floatValue = a.readFloat(), g.stringValue = a.readBoolean() ? a.readString() : h.stringValue, null != g.data.audioPath && (g.volume = a.readFloat(), g.balance = a.readFloat()), f.setFrame(x, g);
                        k.push(f);
                        m = Math.max(m, f.frames[G - 1])
                    }
                    return new b.Animation(c, k, m)
                };
                e.prototype.readCurve = function(a, b, c) {
                    switch (a.readByte()) {
                        case e.CURVE_STEPPED:
                            c.setStepped(b);
                            break;
                        case e.CURVE_BEZIER:
                            this.setCurve(c, b, a.readFloat(), a.readFloat(), a.readFloat(), a.readFloat())
                    }
                };
                e.prototype.setCurve = function(a, b, c, d, e, f) {
                    a.setCurve(b, c, d, e, f)
                };
                e.AttachmentTypeValues = [0, 1, 2, 3, 4, 5, 6];
                e.TransformModeValues = [b.TransformMode.Normal, b.TransformMode.OnlyTranslation, b.TransformMode.NoRotationOrReflection, b.TransformMode.NoScale, b.TransformMode.NoScaleOrReflection];
                e.PositionModeValues = [b.PositionMode.Fixed, b.PositionMode.Percent];
                e.SpacingModeValues = [b.SpacingMode.Length, b.SpacingMode.Fixed,
                    b.SpacingMode.Percent
                ];
                e.RotateModeValues = [b.RotateMode.Tangent, b.RotateMode.Chain, b.RotateMode.ChainScale];
                e.BlendModeValues = [b.BlendMode.Normal, b.BlendMode.Additive, b.BlendMode.Multiply, b.BlendMode.Screen];
                e.BONE_ROTATE = 0;
                e.BONE_TRANSLATE = 1;
                e.BONE_SCALE = 2;
                e.BONE_SHEAR = 3;
                e.SLOT_ATTACHMENT = 0;
                e.SLOT_COLOR = 1;
                e.SLOT_TWO_COLOR = 2;
                e.PATH_POSITION = 0;
                e.PATH_SPACING = 1;
                e.PATH_MIX = 2;
                e.CURVE_LINEAR = 0;
                e.CURVE_STEPPED = 1;
                e.CURVE_BEZIER = 2;
                return e
            }();
            b.SkeletonBinary = e;
            var c = function() {
                    function a(a, b, c, d) {
                        void 0 ===
                            b && (b = []);
                        void 0 === c && (c = 0);
                        void 0 === d && (d = new DataView(a.buffer));
                        this.strings = b;
                        this.index = c;
                        this.buffer = d
                    }
                    a.prototype.readByte = function() {
                        return this.buffer.getInt8(this.index++)
                    };
                    a.prototype.readShort = function() {
                        var a = this.buffer.getInt16(this.index);
                        this.index += 2;
                        return a
                    };
                    a.prototype.readInt32 = function() {
                        var a = this.buffer.getInt32(this.index);
                        this.index += 4;
                        return a
                    };
                    a.prototype.readInt = function(a) {
                        var b = this.readByte(),
                            c = 127 & b;
                        0 != (128 & b) && (b = this.readByte(), c |= (127 & b) << 7, 0 != (128 & b) && (b = this.readByte(),
                            c |= (127 & b) << 14, 0 != (128 & b) && (b = this.readByte(), c |= (127 & b) << 21, 0 != (128 & b) && (b = this.readByte(), c |= (127 & b) << 28))));
                        return a ? c : c >>> 1 ^ -(1 & c)
                    };
                    a.prototype.readStringRef = function() {
                        var a = this.readInt(!0);
                        return 0 == a ? null : this.strings[a - 1]
                    };
                    a.prototype.readString = function() {
                        var a = this.readInt(!0);
                        switch (a) {
                            case 0:
                                return null;
                            case 1:
                                return ""
                        }
                        a--;
                        for (var b = "", c = 0; c < a;) {
                            var d = this.readByte();
                            switch (d >> 4) {
                                case 12:
                                case 13:
                                    b += String.fromCharCode((31 & d) << 6 | 63 & this.readByte());
                                    c += 2;
                                    break;
                                case 14:
                                    b += String.fromCharCode((15 &
                                        d) << 12 | (63 & this.readByte()) << 6 | 63 & this.readByte());
                                    c += 3;
                                    break;
                                default:
                                    b += String.fromCharCode(d), c++
                            }
                        }
                        return b
                    };
                    a.prototype.readFloat = function() {
                        var a = this.buffer.getFloat32(this.index);
                        this.index += 4;
                        return a
                    };
                    a.prototype.readBoolean = function() {
                        return 0 != this.readByte()
                    };
                    return a
                }(),
                a = function() {
                    return function(a, b, c, d, e) {
                        this.mesh = a;
                        this.skin = b;
                        this.slotIndex = c;
                        this.parent = d;
                        this.inheritDeform = e
                    }
                }(),
                d = function() {
                    return function(a, b) {
                        void 0 === a && (a = null);
                        void 0 === b && (b = null);
                        this.bones = a;
                        this.vertices =
                            b
                    }
                }()
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function c() {
                    this.maxY = this.maxX = this.minY = this.minX = 0;
                    this.boundingBoxes = [];
                    this.polygons = [];
                    this.polygonPool = new b.Pool(function() {
                        return b.Utils.newFloatArray(16)
                    })
                }
                c.prototype.update = function(a, c) {
                    if (null == a) throw Error("skeleton cannot be null.");
                    var d = this.boundingBoxes,
                        e = this.polygons,
                        f = this.polygonPool;
                    a = a.slots;
                    var h = a.length;
                    d.length = 0;
                    f.freeAll(e);
                    for (var k = e.length = 0; k < h; k++) {
                        var m = a[k];
                        if (m.bone.active) {
                            var q = m.getAttachment();
                            if (q instanceof b.BoundingBoxAttachment) {
                                d.push(q);
                                var v = f.obtain();
                                v.length != q.worldVerticesLength && (v = b.Utils.newFloatArray(q.worldVerticesLength));
                                e.push(v);
                                q.computeWorldVertices(m, 0, q.worldVerticesLength, v, 0, 2)
                            }
                        }
                    }
                    c ? this.aabbCompute() : (this.minY = this.minX = Number.POSITIVE_INFINITY, this.maxY = this.maxX = Number.NEGATIVE_INFINITY)
                };
                c.prototype.aabbCompute = function() {
                    for (var a = Number.POSITIVE_INFINITY, b = Number.POSITIVE_INFINITY, c = Number.NEGATIVE_INFINITY, e = Number.NEGATIVE_INFINITY, f = this.polygons, h = 0, k = f.length; h < k; h++) {
                        var m =
                            f[h],
                            q = m,
                            v = 0;
                        for (m = m.length; v < m; v += 2) {
                            var A = q[v],
                                B = q[v + 1];
                            a = Math.min(a, A);
                            b = Math.min(b, B);
                            c = Math.max(c, A);
                            e = Math.max(e, B)
                        }
                    }
                    this.minX = a;
                    this.minY = b;
                    this.maxX = c;
                    this.maxY = e
                };
                c.prototype.aabbContainsPoint = function(a, b) {
                    return a >= this.minX && a <= this.maxX && b >= this.minY && b <= this.maxY
                };
                c.prototype.aabbIntersectsSegment = function(a, b, c, e) {
                    var d = this.minX,
                        g = this.minY,
                        f = this.maxX,
                        h = this.maxY;
                    if (a <= d && c <= d || b <= g && e <= g || a >= f && c >= f || b >= h && e >= h) return !1;
                    c = (e - b) / (c - a);
                    e = c * (d - a) + b;
                    if (e > g && e < h) return !0;
                    e = c * (f - a) + b;
                    if (e > g && e < h) return !0;
                    g = (g - b) / c + a;
                    if (g > d && g < f) return !0;
                    g = (h - b) / c + a;
                    return g > d && g < f ? !0 : !1
                };
                c.prototype.aabbIntersectsSkeleton = function(a) {
                    return this.minX < a.maxX && this.maxX > a.minX && this.minY < a.maxY && this.maxY > a.minY
                };
                c.prototype.containsPoint = function(a, b) {
                    for (var c = this.polygons, d = 0, e = c.length; d < e; d++)
                        if (this.containsPointPolygon(c[d], a, b)) return this.boundingBoxes[d];
                    return null
                };
                c.prototype.containsPointPolygon = function(a, b, c) {
                    for (var d = a.length, e = d - 2, f = !1, h = 0; h < d; h += 2) {
                        var l = a[h + 1],
                            k = a[e + 1];
                        if (l <
                            c && k >= c || k < c && l >= c) {
                            var m = a[h];
                            m + (c - l) / (k - l) * (a[e] - m) < b && (f = !f)
                        }
                        e = h
                    }
                    return f
                };
                c.prototype.intersectsSegment = function(a, b, c, e) {
                    for (var d = this.polygons, g = 0, f = d.length; g < f; g++)
                        if (this.intersectsSegmentPolygon(d[g], a, b, c, e)) return this.boundingBoxes[g];
                    return null
                };
                c.prototype.intersectsSegmentPolygon = function(a, b, c, e, f) {
                    for (var d = a.length, g = b - e, h = c - f, l = b * f - c * e, k = a[d - 2], n = a[d - 1], m = 0; m < d; m += 2) {
                        var q = a[m],
                            y = a[m + 1],
                            z = k * y - n * q,
                            x = k - q,
                            C = n - y,
                            G = g * C - h * x;
                        x = (l * x - g * z) / G;
                        if ((x >= k && x <= q || x >= q && x <= k) && (x >= b && x <= e || x >=
                                e && x <= b) && (k = (l * C - h * z) / G, (k >= n && k <= y || k >= y && k <= n) && (k >= c && k <= f || k >= f && k <= c))) return !0;
                        k = q;
                        n = y
                    }
                    return !1
                };
                c.prototype.getPolygon = function(a) {
                    if (null == a) throw Error("boundingBox cannot be null.");
                    a = this.boundingBoxes.indexOf(a);
                    return -1 == a ? null : this.polygons[a]
                };
                c.prototype.getWidth = function() {
                    return this.maxX - this.minX
                };
                c.prototype.getHeight = function() {
                    return this.maxY - this.minY
                };
                return c
            }();
            b.SkeletonBounds = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function c() {
                    this.triangulator = new b.Triangulator;
                    this.clippingPolygon = [];
                    this.clipOutput = [];
                    this.clippedVertices = [];
                    this.clippedTriangles = [];
                    this.scratch = []
                }
                c.prototype.clipStart = function(a, d) {
                    if (null != this.clipAttachment) return 0;
                    this.clipAttachment = d;
                    var e = d.worldVerticesLength,
                        g = b.Utils.setArraySize(this.clippingPolygon, e);
                    d.computeWorldVertices(a, 0, e, g, 0, 2);
                    a = this.clippingPolygon;
                    c.makeClockwise(a);
                    a = this.clippingPolygons = this.triangulator.decompose(a, this.triangulator.triangulate(a));
                    d = 0;
                    for (e = a.length; d < e; d++) g = a[d], c.makeClockwise(g), g.push(g[0]),
                        g.push(g[1]);
                    return a.length
                };
                c.prototype.clipEndWithSlot = function(a) {
                    null != this.clipAttachment && this.clipAttachment.endSlot == a.data && this.clipEnd()
                };
                c.prototype.clipEnd = function() {
                    null != this.clipAttachment && (this.clippingPolygons = this.clipAttachment = null, this.clippedVertices.length = 0, this.clippedTriangles.length = 0, this.clippingPolygon.length = 0)
                };
                c.prototype.isClipping = function() {
                    return null != this.clipAttachment
                };
                c.prototype.clipTriangles = function(a, c, e, g, f, h, k, m, q, v, A, B) {
                    c = this.clipOutput;
                    var d =
                        this.clippedVertices,
                        l = this.clippedTriangles,
                        n = this.clippingPolygons,
                        p = this.clippingPolygons.length,
                        t = m ? 12 : 8,
                        w = 0;
                    v = v || 0;
                    A = A || 0;
                    B = B || 0;
                    d.length = 0;
                    l.length = 0;
                    var u = v;
                    g = v + g;
                    a: for (; u < g; u += 3) {
                        var H = e[u] * q,
                            I = H + A,
                            K = H + B;
                        v = a[I];
                        var P = a[I + 1],
                            S = f[K],
                            M = f[K + 1];
                        H = e[u + 1] * q;
                        I = H + A;
                        K = H + B;
                        var O = a[I],
                            L = a[I + 1],
                            U = f[K],
                            V = f[K + 1];
                        H = e[u + 2] * q;
                        I = H + A;
                        K = H + B;
                        H = a[I];
                        I = a[I + 1];
                        var Z = f[K];
                        K = f[K + 1];
                        for (var da = 0; da < p; da++) {
                            var Q = d.length;
                            if (!this.clip(v, P, O, L, H, I, n[da], c)) {
                                var R = b.Utils.setArraySize(d, Q + 3 * t);
                                R[Q] = v;
                                R[Q + 1] = P;
                                R[Q + 2] = h.r;
                                R[Q + 3] = h.g;
                                R[Q + 4] = h.b;
                                R[Q + 5] = h.a;
                                m ? (R[Q + 6] = S, R[Q + 7] = M, R[Q + 8] = k.r, R[Q + 9] = k.g, R[Q + 10] = k.b, R[Q + 11] = k.a, R[Q + 12] = O, R[Q + 13] = L, R[Q + 14] = h.r, R[Q + 15] = h.g, R[Q + 16] = h.b, R[Q + 17] = h.a, R[Q + 18] = U, R[Q + 19] = V, R[Q + 20] = k.r, R[Q + 21] = k.g, R[Q + 22] = k.b, R[Q + 23] = k.a, R[Q + 24] = H, R[Q + 25] = I, R[Q + 26] = h.r, R[Q + 27] = h.g, R[Q + 28] = h.b, R[Q + 29] = h.a, R[Q + 30] = Z, R[Q + 31] = K, R[Q + 32] = k.r, R[Q + 33] = k.g, R[Q + 34] = k.b, R[Q + 35] = k.a) : (R[Q + 6] = S, R[Q + 7] = M, R[Q + 8] = O, R[Q + 9] = L, R[Q + 10] = h.r, R[Q + 11] = h.g, R[Q + 12] = h.b, R[Q + 13] = h.a, R[Q + 14] = U, R[Q + 15] = V, R[Q + 16] = H, R[Q + 17] = I, R[Q +
                                    18] = h.r, R[Q + 19] = h.g, R[Q + 20] = h.b, R[Q + 21] = h.a, R[Q + 22] = Z, R[Q + 23] = K);
                                Q = l.length;
                                R = b.Utils.setArraySize(l, Q + 3);
                                R[Q] = w;
                                R[Q + 1] = w + 1;
                                R[Q + 2] = w + 2;
                                w += 3;
                                continue a
                            }
                            var fa = c.length;
                            if (0 != fa) {
                                var ba = L - I,
                                    W = H - O,
                                    aa = v - H,
                                    ca = I - P,
                                    ha = 1 / (ba * aa + W * (P - I)),
                                    ia = fa >> 1,
                                    Ba = this.clipOutput;
                                R = b.Utils.setArraySize(d, Q + ia * t);
                                for (var ea = 0; ea < fa; ea += 2) {
                                    var X = Ba[ea],
                                        na = Ba[ea + 1];
                                    R[Q] = X;
                                    R[Q + 1] = na;
                                    R[Q + 2] = h.r;
                                    R[Q + 3] = h.g;
                                    R[Q + 4] = h.b;
                                    R[Q + 5] = h.a;
                                    X -= H;
                                    var ma = na - I;
                                    na = (ba * X + W * ma) * ha;
                                    X = (ca * X + aa * ma) * ha;
                                    ma = 1 - na - X;
                                    R[Q + 6] = S * na + U * X + Z * ma;
                                    R[Q + 7] = M * na + V * X +
                                        K * ma;
                                    m && (R[Q + 8] = k.r, R[Q + 9] = k.g, R[Q + 10] = k.b, R[Q + 11] = k.a);
                                    Q += t
                                }
                                Q = l.length;
                                R = b.Utils.setArraySize(l, Q + 3 * (ia - 2));
                                ia--;
                                for (ea = 1; ea < ia; ea++) R[Q] = w, R[Q + 1] = w + ea, R[Q + 2] = w + ea + 1, Q += 3;
                                w += ia + 1
                            }
                        }
                    }
                };
                c.prototype.clip = function(a, b, c, e, f, h, k, m) {
                    var d = m;
                    var g = !1;
                    if (2 <= k.length % 4) {
                        var l = m;
                        m = this.scratch
                    } else l = this.scratch;
                    l.length = 0;
                    l.push(a);
                    l.push(b);
                    l.push(c);
                    l.push(e);
                    l.push(f);
                    l.push(h);
                    l.push(a);
                    l.push(b);
                    m.length = 0;
                    b = k.length - 4;
                    for (a = 0;; a += 2) {
                        c = k[a];
                        e = k[a + 1];
                        f = k[a + 2];
                        h = k[a + 3];
                        for (var n = c - f, p = e - h, t = l, q = l.length -
                                2, w = m.length, C = 0; C < q; C += 2) {
                            var G = t[C],
                                F = t[C + 1],
                                H = t[C + 2],
                                I = t[C + 3];
                            var K = 0 < n * (I - h) - p * (H - f);
                            if (0 < n * (F - h) - p * (G - f)) {
                                if (K) {
                                    m.push(H);
                                    m.push(I);
                                    continue
                                }
                                var P = I - F;
                                K = H - G;
                                g = P * (f - c) - K * (h - e);
                                1E-6 < Math.abs(g) ? (g = (K * (e - F) - P * (c - G)) / g, m.push(c + (f - c) * g), m.push(e + (h - e) * g)) : (m.push(c), m.push(e))
                            } else K && (P = I - F, K = H - G, g = P * (f - c) - K * (h - e), 1E-6 < Math.abs(g) ? (g = (K * (e - F) - P * (c - G)) / g, m.push(c + (f - c) * g), m.push(e + (h - e) * g)) : (m.push(c), m.push(e)), m.push(H), m.push(I));
                            g = !0
                        }
                        if (w == m.length) return d.length = 0, !0;
                        m.push(m[0]);
                        m.push(m[1]);
                        if (a == b) break;
                        c = m;
                        m = l;
                        m.length = 0;
                        l = c
                    }
                    if (d != m)
                        for (a = d.length = 0, k = m.length - 2; a < k; a++) d[a] = m[a];
                    else d.length -= 2;
                    return g
                };
                c.makeClockwise = function(a) {
                    for (var b = a.length, c = a[b - 2] * a[1] - a[0] * a[b - 1], e, f, h, k, m = 0, q = b - 3; m < q; m += 2) e = a[m], f = a[m + 1], h = a[m + 2], k = a[m + 3], c += e * k - h * f;
                    if (!(0 > c))
                        for (m = 0, c = b - 2, q = b >> 1; m < q; m += 2) b = a[m], e = a[m + 1], f = c - m, a[m] = a[f], a[m + 1] = a[f + 1], a[f] = b, a[f + 1] = e
                };
                return c
            }();
            b.SkeletonClipping = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function b() {
                    this.bones = [];
                    this.slots = [];
                    this.skins = [];
                    this.events = [];
                    this.animations = [];
                    this.ikConstraints = [];
                    this.transformConstraints = [];
                    this.pathConstraints = [];
                    this.fps = 0
                }
                b.prototype.findBone = function(a) {
                    if (null == a) throw Error("boneName cannot be null.");
                    for (var b = this.bones, c = 0, e = b.length; c < e; c++) {
                        var f = b[c];
                        if (f.name == a) return f
                    }
                    return null
                };
                b.prototype.findBoneIndex = function(a) {
                    if (null == a) throw Error("boneName cannot be null.");
                    for (var b = this.bones, c = 0, e = b.length; c < e; c++)
                        if (b[c].name == a) return c;
                    return -1
                };
                b.prototype.findSlot = function(a) {
                    if (null == a) throw Error("slotName cannot be null.");
                    for (var b = this.slots, c = 0, e = b.length; c < e; c++) {
                        var f = b[c];
                        if (f.name == a) return f
                    }
                    return null
                };
                b.prototype.findSlotIndex = function(a) {
                    if (null == a) throw Error("slotName cannot be null.");
                    for (var b = this.slots, c = 0, e = b.length; c < e; c++)
                        if (b[c].name == a) return c;
                    return -1
                };
                b.prototype.findSkin = function(a) {
                    if (null == a) throw Error("skinName cannot be null.");
                    for (var b = this.skins, c = 0, e = b.length; c < e; c++) {
                        var f = b[c];
                        if (f.name == a) return f
                    }
                    return null
                };
                b.prototype.findEvent = function(a) {
                    if (null == a) throw Error("eventDataName cannot be null.");
                    for (var b = this.events, c = 0, e = b.length; c < e; c++) {
                        var f = b[c];
                        if (f.name == a) return f
                    }
                    return null
                };
                b.prototype.findAnimation = function(a) {
                    if (null == a) throw Error("animationName cannot be null.");
                    for (var b = this.animations, c = 0, e = b.length; c < e; c++) {
                        var f = b[c];
                        if (f.name == a) return f
                    }
                    return null
                };
                b.prototype.findIkConstraint = function(a) {
                    if (null == a) throw Error("constraintName cannot be null.");
                    for (var b = this.ikConstraints, c = 0, e = b.length; c < e; c++) {
                        var f = b[c];
                        if (f.name == a) return f
                    }
                    return null
                };
                b.prototype.findTransformConstraint =
                    function(a) {
                        if (null == a) throw Error("constraintName cannot be null.");
                        for (var b = this.transformConstraints, c = 0, e = b.length; c < e; c++) {
                            var f = b[c];
                            if (f.name == a) return f
                        }
                        return null
                    };
                b.prototype.findPathConstraint = function(a) {
                    if (null == a) throw Error("constraintName cannot be null.");
                    for (var b = this.pathConstraints, c = 0, e = b.length; c < e; c++) {
                        var f = b[c];
                        if (f.name == a) return f
                    }
                    return null
                };
                b.prototype.findPathConstraintIndex = function(a) {
                    if (null == a) throw Error("pathConstraintName cannot be null.");
                    for (var b = this.pathConstraints,
                            c = 0, e = b.length; c < e; c++)
                        if (b[c].name == a) return c;
                    return -1
                };
                return b
            }();
            b.SkeletonData = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function a(a) {
                    this.scale = 1;
                    this.linkedMeshes = [];
                    this.attachmentLoader = a
                }
                a.prototype.readSkeletonData = function(c) {
                    var d = this.scale,
                        e = new b.SkeletonData;
                    c = "string" === typeof c ? JSON.parse(c) : c;
                    var f = c.skeleton;
                    null != f && (e.hash = f.hash, e.version = f.spine, e.x = f.x, e.y = f.y, e.width = f.width, e.height = f.height, e.fps = f.fps, e.imagesPath = f.images);
                    if (c.bones)
                        for (f = 0; f < c.bones.length; f++) {
                            var h =
                                c.bones[f];
                            var k = null;
                            var m = this.getValue(h, "parent", null);
                            if (null != m && (k = e.findBone(m), null == k)) throw Error("Parent bone not found: " + m);
                            k = new b.BoneData(e.bones.length, h.name, k);
                            k.length = this.getValue(h, "length", 0) * d;
                            k.x = this.getValue(h, "x", 0) * d;
                            k.y = this.getValue(h, "y", 0) * d;
                            k.rotation = this.getValue(h, "rotation", 0);
                            k.scaleX = this.getValue(h, "scaleX", 1);
                            k.scaleY = this.getValue(h, "scaleY", 1);
                            k.shearX = this.getValue(h, "shearX", 0);
                            k.shearY = this.getValue(h, "shearY", 0);
                            k.transformMode = a.transformModeFromString(this.getValue(h,
                                "transform", "normal"));
                            k.skinRequired = this.getValue(h, "skin", !1);
                            e.bones.push(k)
                        }
                    if (c.slots)
                        for (f = 0; f < c.slots.length; f++) {
                            h = c.slots[f];
                            var q = h.name;
                            m = h.bone;
                            k = e.findBone(m);
                            if (null == k) throw Error("Slot bone not found: " + m);
                            k = new b.SlotData(e.slots.length, q, k);
                            m = this.getValue(h, "color", null);
                            null != m && k.color.setFromString(m);
                            m = this.getValue(h, "dark", null);
                            null != m && (k.darkColor = new b.Color(1, 1, 1, 1), k.darkColor.setFromString(m));
                            k.attachmentName = this.getValue(h, "attachment", null);
                            k.blendMode = a.blendModeFromString(this.getValue(h,
                                "blend", "normal"));
                            e.slots.push(k)
                        }
                    if (c.ik)
                        for (f = 0; f < c.ik.length; f++) {
                            var v = c.ik[f];
                            k = new b.IkConstraintData(v.name);
                            k.order = this.getValue(v, "order", 0);
                            k.skinRequired = this.getValue(v, "skin", !1);
                            for (var A = 0; A < v.bones.length; A++) {
                                m = v.bones[A];
                                h = e.findBone(m);
                                if (null == h) throw Error("IK bone not found: " + m);
                                k.bones.push(h)
                            }
                            h = v.target;
                            k.target = e.findBone(h);
                            if (null == k.target) throw Error("IK target bone not found: " + h);
                            k.mix = this.getValue(v, "mix", 1);
                            k.softness = this.getValue(v, "softness", 0) * d;
                            k.bendDirection =
                                this.getValue(v, "bendPositive", !0) ? 1 : -1;
                            k.compress = this.getValue(v, "compress", !1);
                            k.stretch = this.getValue(v, "stretch", !1);
                            k.uniform = this.getValue(v, "uniform", !1);
                            e.ikConstraints.push(k)
                        }
                    if (c.transform)
                        for (f = 0; f < c.transform.length; f++) {
                            v = c.transform[f];
                            k = new b.TransformConstraintData(v.name);
                            k.order = this.getValue(v, "order", 0);
                            k.skinRequired = this.getValue(v, "skin", !1);
                            for (A = 0; A < v.bones.length; A++) {
                                m = v.bones[A];
                                h = e.findBone(m);
                                if (null == h) throw Error("Transform constraint bone not found: " + m);
                                k.bones.push(h)
                            }
                            h =
                                v.target;
                            k.target = e.findBone(h);
                            if (null == k.target) throw Error("Transform constraint target bone not found: " + h);
                            k.local = this.getValue(v, "local", !1);
                            k.relative = this.getValue(v, "relative", !1);
                            k.offsetRotation = this.getValue(v, "rotation", 0);
                            k.offsetX = this.getValue(v, "x", 0) * d;
                            k.offsetY = this.getValue(v, "y", 0) * d;
                            k.offsetScaleX = this.getValue(v, "scaleX", 0);
                            k.offsetScaleY = this.getValue(v, "scaleY", 0);
                            k.offsetShearY = this.getValue(v, "shearY", 0);
                            k.rotateMix = this.getValue(v, "rotateMix", 1);
                            k.translateMix = this.getValue(v,
                                "translateMix", 1);
                            k.scaleMix = this.getValue(v, "scaleMix", 1);
                            k.shearMix = this.getValue(v, "shearMix", 1);
                            e.transformConstraints.push(k)
                        }
                    if (c.path)
                        for (f = 0; f < c.path.length; f++) {
                            v = c.path[f];
                            k = new b.PathConstraintData(v.name);
                            k.order = this.getValue(v, "order", 0);
                            k.skinRequired = this.getValue(v, "skin", !1);
                            for (A = 0; A < v.bones.length; A++) {
                                m = v.bones[A];
                                h = e.findBone(m);
                                if (null == h) throw Error("Transform constraint bone not found: " + m);
                                k.bones.push(h)
                            }
                            h = v.target;
                            k.target = e.findSlot(h);
                            if (null == k.target) throw Error("Path target slot not found: " +
                                h);
                            k.positionMode = a.positionModeFromString(this.getValue(v, "positionMode", "percent"));
                            k.spacingMode = a.spacingModeFromString(this.getValue(v, "spacingMode", "length"));
                            k.rotateMode = a.rotateModeFromString(this.getValue(v, "rotateMode", "tangent"));
                            k.offsetRotation = this.getValue(v, "rotation", 0);
                            k.position = this.getValue(v, "position", 0);
                            k.positionMode == b.PositionMode.Fixed && (k.position *= d);
                            k.spacing = this.getValue(v, "spacing", 0);
                            k.spacingMode != b.SpacingMode.Length && k.spacingMode != b.SpacingMode.Fixed || (k.spacing *=
                                d);
                            k.rotateMix = this.getValue(v, "rotateMix", 1);
                            k.translateMix = this.getValue(v, "translateMix", 1);
                            e.pathConstraints.push(k)
                        }
                    if (c.skins) {
                        d = c.skins;
                        if (!(d instanceof Array)) {
                            f = [];
                            for (B in d) f.push({
                                name: B,
                                attachments: d[B]
                            });
                            d = f
                        }
                        for (f = 0; f < d.length; f++) {
                            k = d[f];
                            var B = new b.Skin(k.name);
                            if (k.bones)
                                for (m = 0; m < k.bones.length; m++) {
                                    h = e.findBone(k.bones[m]);
                                    if (null == h) throw Error("Skin bone not found: " + k.bones[f]);
                                    B.bones.push(h)
                                }
                            if (k.ik)
                                for (m = 0; m < k.ik.length; m++) {
                                    h = e.findIkConstraint(k.ik[m]);
                                    if (null == h) throw Error("Skin IK constraint not found: " +
                                        k.ik[f]);
                                    B.constraints.push(h)
                                }
                            if (k.transform)
                                for (m = 0; m < k.transform.length; m++) {
                                    h = e.findTransformConstraint(k.transform[m]);
                                    if (null == h) throw Error("Skin transform constraint not found: " + k.transform[f]);
                                    B.constraints.push(h)
                                }
                            if (k.path)
                                for (m = 0; m < k.path.length; m++) {
                                    h = e.findPathConstraint(k.path[m]);
                                    if (null == h) throw Error("Skin path constraint not found: " + k.path[f]);
                                    B.constraints.push(h)
                                }
                            for (q in k.attachments) {
                                m = e.findSlot(q);
                                if (null == m) throw Error("Slot not found: " + q);
                                h = k.attachments[q];
                                for (var E in h) v =
                                    this.readAttachment(h[E], B, m.index, E, e), null != v && B.setAttachment(m.index, E, v)
                            }
                            e.skins.push(B);
                            "default" == B.name && (e.defaultSkin = B)
                        }
                    }
                    f = 0;
                    for (q = this.linkedMeshes.length; f < q; f++) {
                        E = this.linkedMeshes[f];
                        B = null == E.skin ? e.defaultSkin : e.findSkin(E.skin);
                        if (null == B) throw Error("Skin not found: " + E.skin);
                        B = B.getAttachment(E.slotIndex, E.parent);
                        if (null == B) throw Error("Parent mesh not found: " + E.parent);
                        E.mesh.deformAttachment = E.inheritDeform ? B : E.mesh;
                        E.mesh.setParentMesh(B);
                        E.mesh.updateUVs()
                    }
                    this.linkedMeshes.length =
                        0;
                    if (c.events)
                        for (var y in c.events) q = c.events[y], k = new b.EventData(y), k.intValue = this.getValue(q, "int", 0), k.floatValue = this.getValue(q, "float", 0), k.stringValue = this.getValue(q, "string", ""), k.audioPath = this.getValue(q, "audio", null), null != k.audioPath && (k.volume = this.getValue(q, "volume", 1), k.balance = this.getValue(q, "balance", 0)), e.events.push(k);
                    if (c.animations)
                        for (var z in c.animations) this.readAnimation(c.animations[z], z, e);
                    return e
                };
                a.prototype.readAttachment = function(a, e, f, h, k) {
                    var d = this.scale;
                    h = this.getValue(a, "name", h);
                    switch (this.getValue(a, "type", "region")) {
                        case "region":
                            k = this.getValue(a, "path", h);
                            f = this.attachmentLoader.newRegionAttachment(e, h, k);
                            if (null == f) break;
                            f.path = k;
                            f.x = this.getValue(a, "x", 0) * d;
                            f.y = this.getValue(a, "y", 0) * d;
                            f.scaleX = this.getValue(a, "scaleX", 1);
                            f.scaleY = this.getValue(a, "scaleY", 1);
                            f.rotation = this.getValue(a, "rotation", 0);
                            f.width = a.width * d;
                            f.height = a.height * d;
                            e = this.getValue(a, "color", null);
                            null != e && f.color.setFromString(e);
                            f.updateOffset();
                            return f;
                        case "boundingbox":
                            d =
                                this.attachmentLoader.newBoundingBoxAttachment(e, h);
                            if (null == d) break;
                            this.readVertices(a, d, a.vertexCount << 1);
                            e = this.getValue(a, "color", null);
                            null != e && d.color.setFromString(e);
                            return d;
                        case "mesh":
                        case "linkedmesh":
                            k = this.getValue(a, "path", h);
                            h = this.attachmentLoader.newMeshAttachment(e, h, k);
                            if (null == h) break;
                            h.path = k;
                            e = this.getValue(a, "color", null);
                            null != e && h.color.setFromString(e);
                            h.width = this.getValue(a, "width", 0) * d;
                            h.height = this.getValue(a, "height", 0) * d;
                            d = this.getValue(a, "parent", null);
                            if (null !=
                                d) return this.linkedMeshes.push(new c(h, this.getValue(a, "skin", null), f, d, this.getValue(a, "deform", !0))), h;
                            d = a.uvs;
                            this.readVertices(a, h, d.length);
                            h.triangles = a.triangles;
                            h.regionUVs = d;
                            h.updateUVs();
                            h.edges = this.getValue(a, "edges", null);
                            h.hullLength = 2 * this.getValue(a, "hull", 0);
                            return h;
                        case "path":
                            k = this.attachmentLoader.newPathAttachment(e, h);
                            if (null == k) break;
                            k.closed = this.getValue(a, "closed", !1);
                            k.constantSpeed = this.getValue(a, "constantSpeed", !0);
                            f = a.vertexCount;
                            this.readVertices(a, k, f << 1);
                            f = b.Utils.newArray(f /
                                3, 0);
                            for (e = 0; e < a.lengths.length; e++) f[e] = a.lengths[e] * d;
                            k.lengths = f;
                            e = this.getValue(a, "color", null);
                            null != e && k.color.setFromString(e);
                            return k;
                        case "point":
                            k = this.attachmentLoader.newPointAttachment(e, h);
                            if (null == k) break;
                            k.x = this.getValue(a, "x", 0) * d;
                            k.y = this.getValue(a, "y", 0) * d;
                            k.rotation = this.getValue(a, "rotation", 0);
                            e = this.getValue(a, "color", null);
                            null != e && k.color.setFromString(e);
                            return k;
                        case "clipping":
                            if (d = this.attachmentLoader.newClippingAttachment(e, h), null != d) {
                                f = this.getValue(a, "end", null);
                                if (null != f) {
                                    k = k.findSlot(f);
                                    if (null == k) throw Error("Clipping end slot not found: " + f);
                                    d.endSlot = k
                                }
                                f = a.vertexCount;
                                this.readVertices(a, d, f << 1);
                                e = this.getValue(a, "color", null);
                                null != e && d.color.setFromString(e);
                                return d
                            }
                    }
                    return null
                };
                a.prototype.readVertices = function(a, c, e) {
                    var d = this.scale;
                    c.worldVerticesLength = e;
                    a = a.vertices;
                    if (e == a.length) {
                        var f = b.Utils.toFloatArray(a);
                        if (1 != d) {
                            e = 0;
                            for (var g = a.length; e < g; e++) f[e] *= d
                        }
                        c.vertices = f
                    } else {
                        f = [];
                        var h = [];
                        e = 0;
                        for (g = a.length; e < g;) {
                            var l = a[e++];
                            h.push(l);
                            for (l =
                                e + 4 * l; e < l; e += 4) h.push(a[e]), f.push(a[e + 1] * d), f.push(a[e + 2] * d), f.push(a[e + 3])
                        }
                        c.bones = h;
                        c.vertices = b.Utils.toFloatArray(f)
                    }
                };
                a.prototype.readAnimation = function(a, c, e) {
                    var d, f = this.scale,
                        g = [],
                        h = 0;
                    if (a.slots)
                        for (var l in a.slots) {
                            var k = a.slots[l];
                            var m = e.findSlotIndex(l);
                            if (-1 == m) throw Error("Slot not found: " + l);
                            for (var q in k) {
                                var E = k[q];
                                if ("attachment" == q) {
                                    var y = new b.AttachmentTimeline(E.length);
                                    y.slotIndex = m;
                                    for (var z = d = 0; z < E.length; z++) {
                                        var x = E[z];
                                        y.setFrame(d++, this.getValue(x, "time", 0), x.name)
                                    }
                                    g.push(y);
                                    h = Math.max(h, y.frames[y.getFrameCount() - 1])
                                } else if ("color" == q) {
                                    y = new b.ColorTimeline(E.length);
                                    y.slotIndex = m;
                                    for (z = d = 0; z < E.length; z++) {
                                        x = E[z];
                                        var C = new b.Color;
                                        C.setFromString(x.color);
                                        y.setFrame(d, this.getValue(x, "time", 0), C.r, C.g, C.b, C.a);
                                        this.readCurve(x, y, d);
                                        d++
                                    }
                                    g.push(y);
                                    h = Math.max(h, y.frames[(y.getFrameCount() - 1) * b.ColorTimeline.ENTRIES])
                                } else {
                                    if ("twoColor" != q) throw Error("Invalid timeline type for a slot: " + q + " (" + l + ")");
                                    y = new b.TwoColorTimeline(E.length);
                                    y.slotIndex = m;
                                    for (z = d = 0; z < E.length; z++) {
                                        x =
                                            E[z];
                                        C = new b.Color;
                                        var G = new b.Color;
                                        C.setFromString(x.light);
                                        G.setFromString(x.dark);
                                        y.setFrame(d, this.getValue(x, "time", 0), C.r, C.g, C.b, C.a, G.r, G.g, G.b);
                                        this.readCurve(x, y, d);
                                        d++
                                    }
                                    g.push(y);
                                    h = Math.max(h, y.frames[(y.getFrameCount() - 1) * b.TwoColorTimeline.ENTRIES])
                                }
                            }
                        }
                    if (a.bones)
                        for (var F in a.bones) {
                            k = a.bones[F];
                            C = e.findBoneIndex(F);
                            if (-1 == C) throw Error("Bone not found: " + F);
                            for (q in k)
                                if (E = k[q], "rotate" === q) {
                                    y = new b.RotateTimeline(E.length);
                                    y.boneIndex = C;
                                    for (z = d = 0; z < E.length; z++) x = E[z], y.setFrame(d,
                                        this.getValue(x, "time", 0), this.getValue(x, "angle", 0)), this.readCurve(x, y, d), d++;
                                    g.push(y);
                                    h = Math.max(h, y.frames[(y.getFrameCount() - 1) * b.RotateTimeline.ENTRIES])
                                } else {
                                    if ("translate" !== q && "scale" !== q && "shear" !== q) throw Error("Invalid timeline type for a bone: " + q + " (" + F + ")");
                                    m = 1;
                                    G = 0;
                                    "scale" === q ? (y = new b.ScaleTimeline(E.length), G = 1) : "shear" === q ? y = new b.ShearTimeline(E.length) : (y = new b.TranslateTimeline(E.length), m = f);
                                    y.boneIndex = C;
                                    for (z = d = 0; z < E.length; z++) {
                                        x = E[z];
                                        var H = this.getValue(x, "x", G),
                                            I = this.getValue(x,
                                                "y", G);
                                        y.setFrame(d, this.getValue(x, "time", 0), H * m, I * m);
                                        this.readCurve(x, y, d);
                                        d++
                                    }
                                    g.push(y);
                                    h = Math.max(h, y.frames[(y.getFrameCount() - 1) * b.TranslateTimeline.ENTRIES])
                                }
                        }
                    if (a.ik)
                        for (var K in a.ik) {
                            k = a.ik[K];
                            d = e.findIkConstraint(K);
                            y = new b.IkConstraintTimeline(k.length);
                            y.ikConstraintIndex = e.ikConstraints.indexOf(d);
                            for (z = d = 0; z < k.length; z++) x = k[z], y.setFrame(d, this.getValue(x, "time", 0), this.getValue(x, "mix", 1), this.getValue(x, "softness", 0) * f, this.getValue(x, "bendPositive", !0) ? 1 : -1, this.getValue(x, "compress", !1), this.getValue(x, "stretch", !1)), this.readCurve(x, y, d), d++;
                            g.push(y);
                            h = Math.max(h, y.frames[(y.getFrameCount() - 1) * b.IkConstraintTimeline.ENTRIES])
                        }
                    if (a.transform)
                        for (K in a.transform) {
                            k = a.transform[K];
                            d = e.findTransformConstraint(K);
                            y = new b.TransformConstraintTimeline(k.length);
                            y.transformConstraintIndex = e.transformConstraints.indexOf(d);
                            for (z = d = 0; z < k.length; z++) x = k[z], y.setFrame(d, this.getValue(x, "time", 0), this.getValue(x, "rotateMix", 1), this.getValue(x, "translateMix", 1), this.getValue(x, "scaleMix",
                                1), this.getValue(x, "shearMix", 1)), this.readCurve(x, y, d), d++;
                            g.push(y);
                            h = Math.max(h, y.frames[(y.getFrameCount() - 1) * b.TransformConstraintTimeline.ENTRIES])
                        }
                    if (F = a.path || a.paths)
                        for (K in F) {
                            k = F[K];
                            C = e.findPathConstraintIndex(K);
                            if (-1 == C) throw Error("Path constraint not found: " + K);
                            G = e.pathConstraints[C];
                            for (q in k)
                                if (E = k[q], "position" === q || "spacing" === q) {
                                    m = 1;
                                    "spacing" === q ? (y = new b.PathConstraintSpacingTimeline(E.length), G.spacingMode != b.SpacingMode.Length && G.spacingMode != b.SpacingMode.Fixed || (m = f)) :
                                        (y = new b.PathConstraintPositionTimeline(E.length), G.positionMode == b.PositionMode.Fixed && (m = f));
                                    y.pathConstraintIndex = C;
                                    for (z = d = 0; z < E.length; z++) x = E[z], y.setFrame(d, this.getValue(x, "time", 0), this.getValue(x, q, 0) * m), this.readCurve(x, y, d), d++;
                                    g.push(y);
                                    h = Math.max(h, y.frames[(y.getFrameCount() - 1) * b.PathConstraintPositionTimeline.ENTRIES])
                                } else if ("mix" === q) {
                                y = new b.PathConstraintMixTimeline(E.length);
                                y.pathConstraintIndex = C;
                                for (z = d = 0; z < E.length; z++) x = E[z], y.setFrame(d, this.getValue(x, "time", 0), this.getValue(x,
                                    "rotateMix", 1), this.getValue(x, "translateMix", 1)), this.readCurve(x, y, d), d++;
                                g.push(y);
                                h = Math.max(h, y.frames[(y.getFrameCount() - 1) * b.PathConstraintMixTimeline.ENTRIES])
                            }
                        }
                    if (a.deform)
                        for (var P in a.deform) {
                            F = a.deform[P];
                            C = e.findSkin(P);
                            if (null == C) throw Error("Skin not found: " + P);
                            for (l in F) {
                                k = F[l];
                                m = e.findSlotIndex(l);
                                if (-1 == m) throw Error("Slot not found: " + k.name);
                                for (q in k)
                                    if (E = k[q], d = C.getAttachment(m, q), null != d) {
                                        G = null != d.bones;
                                        H = d.vertices;
                                        I = G ? H.length / 3 * 2 : H.length;
                                        y = new b.DeformTimeline(E.length);
                                        y.slotIndex = m;
                                        y.attachment = d;
                                        for (K = d = 0; K < E.length; K++) {
                                            x = E[K];
                                            var S = this.getValue(x, "vertices", null);
                                            if (null == S) var M = G ? b.Utils.newFloatArray(I) : H;
                                            else {
                                                M = b.Utils.newFloatArray(I);
                                                z = this.getValue(x, "offset", 0);
                                                b.Utils.arrayCopy(S, 0, M, z, S.length);
                                                if (1 != f)
                                                    for (S = z + S.length; z < S; z++) M[z] *= f;
                                                if (!G)
                                                    for (z = 0; z < I; z++) M[z] += H[z]
                                            }
                                            y.setFrame(d, this.getValue(x, "time", 0), M);
                                            this.readCurve(x, y, d);
                                            d++
                                        }
                                        g.push(y);
                                        h = Math.max(h, y.frames[y.getFrameCount() - 1])
                                    }
                            }
                        }
                    f = a.drawOrder;
                    null == f && (f = a.draworder);
                    if (null != f) {
                        y = new b.DrawOrderTimeline(f.length);
                        l = e.slots.length;
                        for (K = d = 0; K < f.length; K++) {
                            q = f[K];
                            P = null;
                            E = this.getValue(q, "offsets", null);
                            if (null != E) {
                                P = b.Utils.newArray(l, -1);
                                x = b.Utils.newArray(l - E.length, 0);
                                for (z = F = k = 0; z < E.length; z++) {
                                    C = E[z];
                                    m = e.findSlotIndex(C.slot);
                                    if (-1 == m) throw Error("Slot not found: " + C.slot);
                                    for (; k != m;) x[F++] = k++;
                                    P[k + C.offset] = k++
                                }
                                for (; k < l;) x[F++] = k++;
                                for (z = l - 1; 0 <= z; z--) - 1 == P[z] && (P[z] = x[--F])
                            }
                            y.setFrame(d++, this.getValue(q, "time", 0), P)
                        }
                        g.push(y);
                        h = Math.max(h, y.frames[y.getFrameCount() - 1])
                    }
                    if (a.events) {
                        y = new b.EventTimeline(a.events.length);
                        for (z = d = 0; z < a.events.length; z++) {
                            f = a.events[z];
                            l = e.findEvent(f.name);
                            if (null == l) throw Error("Event not found: " + f.name);
                            q = new b.Event(b.Utils.toSinglePrecision(this.getValue(f, "time", 0)), l);
                            q.intValue = this.getValue(f, "int", l.intValue);
                            q.floatValue = this.getValue(f, "float", l.floatValue);
                            q.stringValue = this.getValue(f, "string", l.stringValue);
                            null != q.data.audioPath && (q.volume = this.getValue(f, "volume", 1), q.balance = this.getValue(f, "balance", 0));
                            y.setFrame(d++, q)
                        }
                        g.push(y);
                        h = Math.max(h, y.frames[y.getFrameCount() -
                            1])
                    }
                    if (isNaN(h)) throw Error("Error while parsing animation, duration is NaN");
                    e.animations.push(new b.Animation(c, g, h))
                };
                a.prototype.readCurve = function(a, b, c) {
                    var d = a.curve;
                    d && ("stepped" == d ? b.setStepped(c) : "[object Array]" === Object.prototype.toString.call(d) ? b.setCurve(c, d[0], d[1], d[2], d[3]) : b.setCurve(c, d, this.getValue(a, "c2", 0), this.getValue(a, "c3", 1), this.getValue(a, "c4", 1)))
                };
                a.prototype.getValue = function(a, b, c) {
                    return void 0 !== a[b] ? a[b] : c
                };
                a.blendModeFromString = function(a) {
                    a = a.toLowerCase();
                    if ("normal" == a) return b.BlendMode.Normal;
                    if ("additive" == a) return b.BlendMode.Additive;
                    if ("multiply" == a) return b.BlendMode.Multiply;
                    if ("screen" == a) return b.BlendMode.Screen;
                    throw Error("Unknown blend mode: " + a);
                };
                a.positionModeFromString = function(a) {
                    a = a.toLowerCase();
                    if ("fixed" == a) return b.PositionMode.Fixed;
                    if ("percent" == a) return b.PositionMode.Percent;
                    throw Error("Unknown position mode: " + a);
                };
                a.spacingModeFromString = function(a) {
                    a = a.toLowerCase();
                    if ("length" == a) return b.SpacingMode.Length;
                    if ("fixed" ==
                        a) return b.SpacingMode.Fixed;
                    if ("percent" == a) return b.SpacingMode.Percent;
                    throw Error("Unknown position mode: " + a);
                };
                a.rotateModeFromString = function(a) {
                    a = a.toLowerCase();
                    if ("tangent" == a) return b.RotateMode.Tangent;
                    if ("chain" == a) return b.RotateMode.Chain;
                    if ("chainscale" == a) return b.RotateMode.ChainScale;
                    throw Error("Unknown rotate mode: " + a);
                };
                a.transformModeFromString = function(a) {
                    a = a.toLowerCase();
                    if ("normal" == a) return b.TransformMode.Normal;
                    if ("onlytranslation" == a) return b.TransformMode.OnlyTranslation;
                    if ("norotationorreflection" == a) return b.TransformMode.NoRotationOrReflection;
                    if ("noscale" == a) return b.TransformMode.NoScale;
                    if ("noscaleorreflection" == a) return b.TransformMode.NoScaleOrReflection;
                    throw Error("Unknown transform mode: " + a);
                };
                return a
            }();
            b.SkeletonJson = e;
            var c = function() {
                return function(a, b, c, e, f) {
                    this.mesh = a;
                    this.skin = b;
                    this.slotIndex = c;
                    this.parent = e;
                    this.inheritDeform = f
                }
            }()
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                return function(a, b, c) {
                    this.slotIndex = a;
                    this.name = b;
                    this.attachment =
                        c
                }
            }();
            b.SkinEntry = e;
            var c = function() {
                function a(a) {
                    this.attachments = [];
                    this.bones = [];
                    this.constraints = [];
                    if (null == a) throw Error("name cannot be null.");
                    this.name = a
                }
                a.prototype.setAttachment = function(a, b, c) {
                    if (null == c) throw Error("attachment cannot be null.");
                    var d = this.attachments;
                    a >= d.length && (d.length = a + 1);
                    d[a] || (d[a] = {});
                    d[a][b] = c
                };
                a.prototype.addSkin = function(a) {
                    for (var b, c = 0; c < a.bones.length; c++) {
                        var d = a.bones[c];
                        b = !1;
                        for (var e = 0; e < this.bones.length; e++)
                            if (this.bones[e] == d) {
                                b = !0;
                                break
                            }
                        b || this.bones.push(d)
                    }
                    for (c =
                        0; c < a.constraints.length; c++) {
                        d = a.constraints[c];
                        b = !1;
                        for (e = 0; e < this.constraints.length; e++)
                            if (this.constraints[e] == d) {
                                b = !0;
                                break
                            }
                        b || this.constraints.push(d)
                    }
                    a = a.getAttachments();
                    for (c = 0; c < a.length; c++) b = a[c], this.setAttachment(b.slotIndex, b.name, b.attachment)
                };
                a.prototype.copySkin = function(a) {
                    for (var c, d = 0; d < a.bones.length; d++) {
                        var e = a.bones[d];
                        c = !1;
                        for (var f = 0; f < this.bones.length; f++)
                            if (this.bones[f] == e) {
                                c = !0;
                                break
                            }
                        c || this.bones.push(e)
                    }
                    for (d = 0; d < a.constraints.length; d++) {
                        e = a.constraints[d];
                        c = !1;
                        for (f = 0; f < this.constraints.length; f++)
                            if (this.constraints[f] == e) {
                                c = !0;
                                break
                            }
                        c || this.constraints.push(e)
                    }
                    a = a.getAttachments();
                    for (d = 0; d < a.length; d++) c = a[d], null != c.attachment && (c.attachment = c.attachment instanceof b.MeshAttachment ? c.attachment.newLinkedMesh() : c.attachment.copy(), this.setAttachment(c.slotIndex, c.name, c.attachment))
                };
                a.prototype.getAttachment = function(a, b) {
                    return (a = this.attachments[a]) ? a[b] : null
                };
                a.prototype.removeAttachment = function(a, b) {
                    (a = this.attachments[a]) && (a[b] = null)
                };
                a.prototype.getAttachments =
                    function() {
                        for (var a = [], b = 0; b < this.attachments.length; b++) {
                            var c = this.attachments[b];
                            if (c)
                                for (var f in c) {
                                    var h = c[f];
                                    h && a.push(new e(b, f, h))
                                }
                        }
                        return a
                    };
                a.prototype.getAttachmentsForSlot = function(a, b) {
                    var c = this.attachments[a];
                    if (c)
                        for (var d in c) {
                            var f = c[d];
                            f && b.push(new e(a, d, f))
                        }
                };
                a.prototype.clear = function() {
                    this.attachments.length = 0;
                    this.bones.length = 0;
                    this.constraints.length = 0
                };
                a.prototype.attachAll = function(a, b) {
                    for (var c = 0, d = 0; d < a.slots.length; d++) {
                        var e = a.slots[d],
                            f = e.getAttachment();
                        if (f &&
                            c < b.attachments.length) {
                            var h = b.attachments[c],
                                k;
                            for (k in h)
                                if (f == h[k]) {
                                    f = this.getAttachment(c, k);
                                    null != f && e.setAttachment(f);
                                    break
                                }
                        }
                        c++
                    }
                };
                return a
            }();
            b.Skin = c
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function c(a, c) {
                    this.deform = [];
                    if (null == a) throw Error("data cannot be null.");
                    if (null == c) throw Error("bone cannot be null.");
                    this.data = a;
                    this.bone = c;
                    this.color = new b.Color;
                    this.darkColor = null == a.darkColor ? null : new b.Color;
                    this.setToSetupPose()
                }
                c.prototype.getSkeleton = function() {
                    return this.bone.skeleton
                };
                c.prototype.getAttachment = function() {
                    return this.attachment
                };
                c.prototype.setAttachment = function(a) {
                    this.attachment != a && (this.attachment = a, this.attachmentTime = this.bone.skeleton.time, this.deform.length = 0)
                };
                c.prototype.setAttachmentTime = function(a) {
                    this.attachmentTime = this.bone.skeleton.time - a
                };
                c.prototype.getAttachmentTime = function() {
                    return this.bone.skeleton.time - this.attachmentTime
                };
                c.prototype.setToSetupPose = function() {
                    this.color.setFromColor(this.data.color);
                    null != this.darkColor && this.darkColor.setFromColor(this.data.darkColor);
                    null == this.data.attachmentName ? this.attachment = null : (this.attachment = null, this.setAttachment(this.bone.skeleton.getAttachment(this.data.index, this.data.attachmentName)))
                };
                return c
            }();
            b.Slot = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                return function(c, a, d) {
                    this.color = new b.Color(1, 1, 1, 1);
                    if (0 > c) throw Error("index must be >= 0.");
                    if (null == a) throw Error("name cannot be null.");
                    if (null == d) throw Error("boneData cannot be null.");
                    this.index = c;
                    this.name = a;
                    this.boneData = d
                }
            }();
            b.SlotData = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function b(a) {
                    this._image = a
                }
                b.prototype.getImage = function() {
                    return this._image
                };
                b.filterFromString = function(a) {
                    switch (a.toLowerCase()) {
                        case "nearest":
                            return c.Nearest;
                        case "linear":
                            return c.Linear;
                        case "mipmap":
                            return c.MipMap;
                        case "mipmapnearestnearest":
                            return c.MipMapNearestNearest;
                        case "mipmaplinearnearest":
                            return c.MipMapLinearNearest;
                        case "mipmapnearestlinear":
                            return c.MipMapNearestLinear;
                        case "mipmaplinearlinear":
                            return c.MipMapLinearLinear;
                        default:
                            throw Error("Unknown texture filter " +
                                a);
                    }
                };
                b.wrapFromString = function(b) {
                    switch (b.toLowerCase()) {
                        case "mirroredtepeat":
                            return a.MirroredRepeat;
                        case "clamptoedge":
                            return a.ClampToEdge;
                        case "repeat":
                            return a.Repeat;
                        default:
                            throw Error("Unknown texture wrap " + b);
                    }
                };
                return b
            }();
            b.Texture = e;
            var c;
            (function(a) {
                a[a.Nearest = 9728] = "Nearest";
                a[a.Linear = 9729] = "Linear";
                a[a.MipMap = 9987] = "MipMap";
                a[a.MipMapNearestNearest = 9984] = "MipMapNearestNearest";
                a[a.MipMapLinearNearest = 9985] = "MipMapLinearNearest";
                a[a.MipMapNearestLinear = 9986] = "MipMapNearestLinear";
                a[a.MipMapLinearLinear = 9987] = "MipMapLinearLinear"
            })(c = b.TextureFilter || (b.TextureFilter = {}));
            var a;
            (function(a) {
                a[a.MirroredRepeat = 33648] = "MirroredRepeat";
                a[a.ClampToEdge = 33071] = "ClampToEdge";
                a[a.Repeat = 10497] = "Repeat"
            })(a = b.TextureWrap || (b.TextureWrap = {}));
            var d = function() {
                return function() {
                    this.height = this.width = this.v2 = this.u2 = this.v = this.u = 0;
                    this.rotate = !1;
                    this.originalHeight = this.originalWidth = this.offsetY = this.offsetX = 0
                }
            }();
            b.TextureRegion = d;
            e = function(a) {
                function b() {
                    return null !== a && a.apply(this,
                        arguments) || this
                }
                f(b, a);
                b.prototype.setFilters = function(a, b) {};
                b.prototype.setWraps = function(a, b) {};
                b.prototype.dispose = function() {};
                return b
            }(e);
            b.FakeTexture = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function e(a, b) {
                    this.pages = [];
                    this.regions = [];
                    this.load(a, b)
                }
                e.prototype.load = function(e, f) {
                    if (null == f) throw Error("textureLoader cannot be null.");
                    e = new c(e);
                    for (var g = Array(4), h = null;;) {
                        var k = e.readLine();
                        if (null == k) break;
                        k = k.trim();
                        if (0 == k.length) h = null;
                        else if (h) {
                            var l = new d;
                            l.name = k;
                            l.page =
                                h;
                            k = e.readValue();
                            "true" == k.toLocaleLowerCase() ? l.degrees = 90 : "false" == k.toLocaleLowerCase() ? l.degrees = 0 : l.degrees = parseFloat(k);
                            l.rotate = 90 == l.degrees;
                            e.readTuple(g);
                            k = parseInt(g[0]);
                            var n = parseInt(g[1]);
                            e.readTuple(g);
                            var m = parseInt(g[0]),
                                q = parseInt(g[1]);
                            l.u = k / h.width;
                            l.v = n / h.height;
                            l.rotate ? (l.u2 = (k + q) / h.width, l.v2 = (n + m) / h.height) : (l.u2 = (k + m) / h.width, l.v2 = (n + q) / h.height);
                            l.x = k;
                            l.y = n;
                            l.width = Math.abs(m);
                            l.height = Math.abs(q);
                            4 == e.readTuple(g) && 4 == e.readTuple(g) && e.readTuple(g);
                            l.originalWidth = parseInt(g[0]);
                            l.originalHeight = parseInt(g[1]);
                            e.readTuple(g);
                            l.offsetX = parseInt(g[0]);
                            l.offsetY = parseInt(g[1]);
                            l.index = parseInt(e.readValue());
                            l.texture = h.texture;
                            this.regions.push(l)
                        } else h = new a, h.name = k, 2 == e.readTuple(g) && (h.width = parseInt(g[0]), h.height = parseInt(g[1]), e.readTuple(g)), e.readTuple(g), h.minFilter = b.Texture.filterFromString(g[0]), h.magFilter = b.Texture.filterFromString(g[1]), l = e.readValue(), h.uWrap = b.TextureWrap.ClampToEdge, h.vWrap = b.TextureWrap.ClampToEdge, "x" == l ? h.uWrap = b.TextureWrap.Repeat : "y" ==
                            l ? h.vWrap = b.TextureWrap.Repeat : "xy" == l && (h.uWrap = h.vWrap = b.TextureWrap.Repeat), h.texture = f(k), h.texture.setFilters(h.minFilter, h.magFilter), h.texture.setWraps(h.uWrap, h.vWrap), h.width = h.texture.getImage().width, h.height = h.texture.getImage().height, this.pages.push(h)
                    }
                };
                e.prototype.findRegion = function(a) {
                    for (var b = 0; b < this.regions.length; b++)
                        if (this.regions[b].name == a) return this.regions[b];
                    return null
                };
                e.prototype.dispose = function() {
                    for (var a = 0; a < this.pages.length; a++) this.pages[a].texture.dispose()
                };
                return e
            }();
            b.TextureAtlas = e;
            var c = function() {
                    function a(a) {
                        this.index = 0;
                        this.lines = a.split(/\r\n|\r|\n/)
                    }
                    a.prototype.readLine = function() {
                        return this.index >= this.lines.length ? null : this.lines[this.index++]
                    };
                    a.prototype.readValue = function() {
                        var a = this.readLine(),
                            b = a.indexOf(":");
                        if (-1 == b) throw Error("Invalid line: " + a);
                        return a.substring(b + 1).trim()
                    };
                    a.prototype.readTuple = function(a) {
                        var b = this.readLine(),
                            c = b.indexOf(":");
                        if (-1 == c) throw Error("Invalid line: " + b);
                        var d = 0;
                        for (c += 1; 3 > d; d++) {
                            var e = b.indexOf(",",
                                c);
                            if (-1 == e) break;
                            a[d] = b.substr(c, e - c).trim();
                            c = e + 1
                        }
                        a[d] = b.substring(c).trim();
                        return d + 1
                    };
                    return a
                }(),
                a = function() {
                    return function() {}
                }();
            b.TextureAtlasPage = a;
            var d = function(a) {
                function b() {
                    return null !== a && a.apply(this, arguments) || this
                }
                f(b, a);
                return b
            }(b.TextureRegion);
            b.TextureAtlasRegion = d
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function c(a, c) {
                    this.shearMix = this.scaleMix = this.translateMix = this.rotateMix = 0;
                    this.temp = new b.Vector2;
                    this.active = !1;
                    if (null == a) throw Error("data cannot be null.");
                    if (null == c) throw Error("skeleton cannot be null.");
                    this.data = a;
                    this.rotateMix = a.rotateMix;
                    this.translateMix = a.translateMix;
                    this.scaleMix = a.scaleMix;
                    this.shearMix = a.shearMix;
                    this.bones = [];
                    for (var d = 0; d < a.bones.length; d++) this.bones.push(c.findBone(a.bones[d].name));
                    this.target = c.findBone(a.target.name)
                }
                c.prototype.isActive = function() {
                    return this.active
                };
                c.prototype.apply = function() {
                    this.update()
                };
                c.prototype.update = function() {
                    this.data.local ? this.data.relative ? this.applyRelativeLocal() : this.applyAbsoluteLocal() :
                        this.data.relative ? this.applyRelativeWorld() : this.applyAbsoluteWorld()
                };
                c.prototype.applyAbsoluteWorld = function() {
                    var a = this.rotateMix,
                        c = this.translateMix,
                        e = this.scaleMix,
                        f = this.shearMix,
                        h = this.target,
                        k = h.a,
                        m = h.b,
                        p = h.c,
                        q = h.d,
                        v = 0 < k * q - m * p ? b.MathUtils.degRad : -b.MathUtils.degRad,
                        A = this.data.offsetRotation * v;
                    v *= this.data.offsetShearY;
                    for (var B = this.bones, E = 0, y = B.length; E < y; E++) {
                        var z = B[E];
                        var x = !1;
                        if (0 != a) {
                            var C = z.a;
                            var G = z.b;
                            var F = z.c;
                            var H = z.d;
                            x = Math.atan2(p, k) - Math.atan2(F, C) + A;
                            x > b.MathUtils.PI ? x -=
                                b.MathUtils.PI2 : x < -b.MathUtils.PI && (x += b.MathUtils.PI2);
                            x *= a;
                            var I = Math.cos(x);
                            x = Math.sin(x);
                            z.a = I * C - x * F;
                            z.b = I * G - x * H;
                            z.c = x * C + I * F;
                            z.d = x * G + I * H;
                            x = !0
                        }
                        0 != c && (x = this.temp, h.localToWorld(x.set(this.data.offsetX, this.data.offsetY)), z.worldX += (x.x - z.worldX) * c, z.worldY += (x.y - z.worldY) * c, x = !0);
                        0 < e && (H = Math.sqrt(z.a * z.a + z.c * z.c), x = Math.sqrt(k * k + p * p), 1E-5 < H && (H = (H + (x - H + this.data.offsetScaleX) * e) / H), z.a *= H, z.c *= H, H = Math.sqrt(z.b * z.b + z.d * z.d), x = Math.sqrt(m * m + q * q), 1E-5 < H && (H = (H + (x - H + this.data.offsetScaleY) * e) / H),
                            z.b *= H, z.d *= H, x = !0);
                        0 < f && (G = z.b, H = z.d, C = Math.atan2(H, G), x = Math.atan2(q, m) - Math.atan2(p, k) - (C - Math.atan2(z.c, z.a)), x > b.MathUtils.PI ? x -= b.MathUtils.PI2 : x < -b.MathUtils.PI && (x += b.MathUtils.PI2), x = C + (x + v) * f, H = Math.sqrt(G * G + H * H), z.b = Math.cos(x) * H, z.d = Math.sin(x) * H, x = !0);
                        x && (z.appliedValid = !1)
                    }
                };
                c.prototype.applyRelativeWorld = function() {
                    var a = this.rotateMix,
                        c = this.translateMix,
                        e = this.scaleMix,
                        f = this.shearMix,
                        h = this.target,
                        k = h.a,
                        m = h.b,
                        p = h.c,
                        q = h.d,
                        v = 0 < k * q - m * p ? b.MathUtils.degRad : -b.MathUtils.degRad,
                        A = this.data.offsetRotation *
                        v;
                    v *= this.data.offsetShearY;
                    for (var B = this.bones, E = 0, y = B.length; E < y; E++) {
                        var z = B[E];
                        var x = !1;
                        if (0 != a) {
                            var C = z.a;
                            var G = z.b;
                            var F = z.c;
                            x = z.d;
                            var H = Math.atan2(p, k) + A;
                            H > b.MathUtils.PI ? H -= b.MathUtils.PI2 : H < -b.MathUtils.PI && (H += b.MathUtils.PI2);
                            H *= a;
                            var I = Math.cos(H);
                            H = Math.sin(H);
                            z.a = I * C - H * F;
                            z.b = I * G - H * x;
                            z.c = H * C + I * F;
                            z.d = H * G + I * x;
                            x = !0
                        }
                        0 != c && (x = this.temp, h.localToWorld(x.set(this.data.offsetX, this.data.offsetY)), z.worldX += x.x * c, z.worldY += x.y * c, x = !0);
                        0 < e && (x = (Math.sqrt(k * k + p * p) - 1 + this.data.offsetScaleX) * e + 1,
                            z.a *= x, z.c *= x, x = (Math.sqrt(m * m + q * q) - 1 + this.data.offsetScaleY) * e + 1, z.b *= x, z.d *= x, x = !0);
                        0 < f && (H = Math.atan2(q, m) - Math.atan2(p, k), H > b.MathUtils.PI ? H -= b.MathUtils.PI2 : H < -b.MathUtils.PI && (H += b.MathUtils.PI2), G = z.b, x = z.d, H = Math.atan2(x, G) + (H - b.MathUtils.PI / 2 + v) * f, x = Math.sqrt(G * G + x * x), z.b = Math.cos(H) * x, z.d = Math.sin(H) * x, x = !0);
                        x && (z.appliedValid = !1)
                    }
                };
                c.prototype.applyAbsoluteLocal = function() {
                    var a = this.rotateMix,
                        b = this.translateMix,
                        c = this.scaleMix,
                        e = this.shearMix,
                        f = this.target;
                    f.appliedValid || f.updateAppliedTransform();
                    for (var h = this.bones, k = 0, m = h.length; k < m; k++) {
                        var q = h[k];
                        q.appliedValid || q.updateAppliedTransform();
                        var v = q.arotation;
                        if (0 != a) {
                            var A = f.arotation - v + this.data.offsetRotation;
                            A -= 360 * (16384 - (16384.499999999996 - A / 360 | 0));
                            v += A * a
                        }
                        var B = q.ax,
                            E = q.ay;
                        0 != b && (B += (f.ax - B + this.data.offsetX) * b, E += (f.ay - E + this.data.offsetY) * b);
                        var y = q.ascaleX,
                            z = q.ascaleY;
                        0 != c && (1E-5 < y && (y = (y + (f.ascaleX - y + this.data.offsetScaleX) * c) / y), 1E-5 < z && (z = (z + (f.ascaleY - z + this.data.offsetScaleY) * c) / z));
                        var x = q.ashearY;
                        0 != e && (A = f.ashearY - x + this.data.offsetShearY,
                            A -= 360 * (16384 - (16384.499999999996 - A / 360 | 0)), q.shearY += A * e);
                        q.updateWorldTransformWith(B, E, v, y, z, q.ashearX, x)
                    }
                };
                c.prototype.applyRelativeLocal = function() {
                    var a = this.rotateMix,
                        b = this.translateMix,
                        c = this.scaleMix,
                        e = this.shearMix,
                        f = this.target;
                    f.appliedValid || f.updateAppliedTransform();
                    for (var h = this.bones, k = 0, m = h.length; k < m; k++) {
                        var q = h[k];
                        q.appliedValid || q.updateAppliedTransform();
                        var v = q.arotation;
                        0 != a && (v += (f.arotation + this.data.offsetRotation) * a);
                        var A = q.ax,
                            B = q.ay;
                        0 != b && (A += (f.ax + this.data.offsetX) *
                            b, B += (f.ay + this.data.offsetY) * b);
                        var E = q.ascaleX,
                            y = q.ascaleY;
                        0 != c && (1E-5 < E && (E *= (f.ascaleX - 1 + this.data.offsetScaleX) * c + 1), 1E-5 < y && (y *= (f.ascaleY - 1 + this.data.offsetScaleY) * c + 1));
                        var z = q.ashearY;
                        0 != e && (z += (f.ashearY + this.data.offsetShearY) * e);
                        q.updateWorldTransformWith(A, B, v, E, y, q.ashearX, z)
                    }
                };
                return c
            }();
            b.TransformConstraint = e
        })(e || (e = {}));
        (function(b) {
            var e = function(b) {
                function a(a) {
                    a = b.call(this, a, 0, !1) || this;
                    a.bones = [];
                    a.rotateMix = 0;
                    a.translateMix = 0;
                    a.scaleMix = 0;
                    a.shearMix = 0;
                    a.offsetRotation = 0;
                    a.offsetX = 0;
                    a.offsetY = 0;
                    a.offsetScaleX = 0;
                    a.offsetScaleY = 0;
                    a.offsetShearY = 0;
                    a.relative = !1;
                    a.local = !1;
                    return a
                }
                f(a, b);
                return a
            }(b.ConstraintData);
            b.TransformConstraintData = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function c() {
                    this.convexPolygons = [];
                    this.convexPolygonsIndices = [];
                    this.indicesArray = [];
                    this.isConcaveArray = [];
                    this.triangles = [];
                    this.polygonPool = new b.Pool(function() {
                        return []
                    });
                    this.polygonIndicesPool = new b.Pool(function() {
                        return []
                    })
                }
                c.prototype.triangulate = function(a) {
                    var b, e = a.length >>
                        1,
                        f = this.indicesArray;
                    for (b = f.length = 0; b < e; b++) f[b] = b;
                    var h = this.isConcaveArray;
                    b = h.length = 0;
                    for (var k = e; b < k; ++b) h[b] = c.isConcave(b, e, a, f);
                    k = this.triangles;
                    for (k.length = 0; 3 < e;) {
                        var m = e - 1;
                        b = 0;
                        for (var p = 1;;) {
                            a: if (!h[b]) {
                                var q = f[m] << 1,
                                    v = f[b] << 1,
                                    A = f[p] << 1,
                                    B = a[q];
                                q = a[q + 1];
                                var E = a[v];
                                v = a[v + 1];
                                var y = a[A];
                                A = a[A + 1];
                                for (var z = (p + 1) % e; z != m; z = (z + 1) % e)
                                    if (h[z]) {
                                        var x = f[z] << 1,
                                            C = a[x];
                                        x = a[x + 1];
                                        if (c.positiveArea(y, A, B, q, C, x) && c.positiveArea(B, q, E, v, C, x) && c.positiveArea(E, v, y, A, C, x)) break a
                                    }
                                break
                            }if (0 == p) {
                                do {
                                    if (!h[b]) break;
                                    b--
                                } while (0 < b);
                                break
                            }
                            m = b;b = p;p = (p + 1) % e
                        }
                        k.push(f[(e + b - 1) % e]);
                        k.push(f[b]);
                        k.push(f[(b + 1) % e]);
                        f.splice(b, 1);
                        h.splice(b, 1);
                        e--;
                        m = (e + b - 1) % e;
                        b = b == e ? 0 : b;
                        h[m] = c.isConcave(m, e, a, f);
                        h[b] = c.isConcave(b, e, a, f)
                    }
                    3 == e && (k.push(f[2]), k.push(f[0]), k.push(f[1]));
                    return k
                };
                c.prototype.decompose = function(a, b) {
                    var d = this.convexPolygons;
                    this.polygonPool.freeAll(d);
                    d.length = 0;
                    var e = this.convexPolygonsIndices;
                    this.polygonIndicesPool.freeAll(e);
                    e.length = 0;
                    var f = this.polygonIndicesPool.obtain();
                    f.length = 0;
                    var h = this.polygonPool.obtain();
                    h.length = 0;
                    for (var k = -1, m = 0, q = 0, v = b.length; q < v; q += 3) {
                        var A = b[q] << 1,
                            B = b[q + 1] << 1,
                            E = b[q + 2] << 1,
                            y = a[A],
                            z = a[A + 1],
                            x = a[B],
                            C = a[B + 1];
                        var G = a[E];
                        var F = a[E + 1];
                        var H = !1;
                        if (k == A) {
                            var I = h.length - 4;
                            var K = c.winding(h[I], h[I + 1], h[I + 2], h[I + 3], G, F);
                            I = c.winding(G, F, h[0], h[1], h[2], h[3]);
                            K == m && I == m && (h.push(G), h.push(F), f.push(E), H = !0)
                        }
                        H || (0 < h.length ? (d.push(h), e.push(f)) : (this.polygonPool.free(h), this.polygonIndicesPool.free(f)), h = this.polygonPool.obtain(), h.length = 0, h.push(y), h.push(z), h.push(x), h.push(C), h.push(G), h.push(F),
                            f = this.polygonIndicesPool.obtain(), f.length = 0, f.push(A), f.push(B), f.push(E), m = c.winding(y, z, x, C, G, F), k = A)
                    }
                    0 < h.length && (d.push(h), e.push(f));
                    q = 0;
                    for (v = d.length; q < v; q++)
                        if (f = e[q], 0 != f.length)
                            for (a = f[0], b = f[f.length - 1], h = d[q], I = h.length - 4, k = h[I], m = h[I + 1], A = h[I + 2], B = h[I + 3], E = h[0], y = h[1], z = h[2], x = h[3], C = c.winding(k, m, A, B, E, y), H = 0; H < v; H++)
                                if (H != q) {
                                    var P = e[H];
                                    if (3 == P.length) {
                                        I = P[0];
                                        K = P[1];
                                        var S = P[2],
                                            M = d[H];
                                        G = M[M.length - 2];
                                        F = M[M.length - 1];
                                        I == a && K == b && (K = c.winding(k, m, A, B, G, F), I = c.winding(G, F, E, y, z, x), K ==
                                            C && I == C && (M.length = 0, P.length = 0, h.push(G), h.push(F), f.push(S), k = A, m = B, A = G, B = F, H = 0))
                                    }
                                }
                    for (q = d.length - 1; 0 <= q; q--) h = d[q], 0 == h.length && (d.splice(q, 1), this.polygonPool.free(h), f = e[q], e.splice(q, 1), this.polygonIndicesPool.free(f));
                    return d
                };
                c.isConcave = function(a, b, c, e) {
                    var d = e[(b + a - 1) % b] << 1,
                        f = e[a] << 1;
                    a = e[(a + 1) % b] << 1;
                    return !this.positiveArea(c[d], c[d + 1], c[f], c[f + 1], c[a], c[a + 1])
                };
                c.positiveArea = function(a, b, c, e, f, h) {
                    return 0 <= a * (h - e) + c * (b - h) + f * (e - b)
                };
                c.winding = function(a, b, c, e, f, h) {
                    c -= a;
                    e -= b;
                    return 0 <= f *
                        e - h * c + c * b - a * e ? 1 : -1
                };
                return c
            }();
            b.Triangulator = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function b() {
                    this.array = []
                }
                b.prototype.add = function(a) {
                    var b = this.contains(a);
                    this.array[0 | a] = 0 | a;
                    return !b
                };
                b.prototype.contains = function(a) {
                    return void 0 != this.array[0 | a]
                };
                b.prototype.remove = function(a) {
                    this.array[0 | a] = void 0
                };
                b.prototype.clear = function() {
                    this.array.length = 0
                };
                return b
            }();
            b.IntSet = e;
            e = function() {
                function b(a, b, c, e) {
                    void 0 === a && (a = 0);
                    void 0 === b && (b = 0);
                    void 0 === c && (c = 0);
                    void 0 === e && (e = 0);
                    this.r =
                        a;
                    this.g = b;
                    this.b = c;
                    this.a = e
                }
                b.prototype.set = function(a, b, c, e) {
                    this.r = a;
                    this.g = b;
                    this.b = c;
                    this.a = e;
                    this.clamp();
                    return this
                };
                b.prototype.setFromColor = function(a) {
                    this.r = a.r;
                    this.g = a.g;
                    this.b = a.b;
                    this.a = a.a;
                    return this
                };
                b.prototype.setFromString = function(a) {
                    a = "#" == a.charAt(0) ? a.substr(1) : a;
                    this.r = parseInt(a.substr(0, 2), 16) / 255;
                    this.g = parseInt(a.substr(2, 2), 16) / 255;
                    this.b = parseInt(a.substr(4, 2), 16) / 255;
                    this.a = (8 != a.length ? 255 : parseInt(a.substr(6, 2), 16)) / 255;
                    return this
                };
                b.prototype.add = function(a, b,
                    c, e) {
                    this.r += a;
                    this.g += b;
                    this.b += c;
                    this.a += e;
                    this.clamp();
                    return this
                };
                b.prototype.clamp = function() {
                    0 > this.r ? this.r = 0 : 1 < this.r && (this.r = 1);
                    0 > this.g ? this.g = 0 : 1 < this.g && (this.g = 1);
                    0 > this.b ? this.b = 0 : 1 < this.b && (this.b = 1);
                    0 > this.a ? this.a = 0 : 1 < this.a && (this.a = 1);
                    return this
                };
                b.rgba8888ToColor = function(a, b) {
                    a.r = ((4278190080 & b) >>> 24) / 255;
                    a.g = ((16711680 & b) >>> 16) / 255;
                    a.b = ((65280 & b) >>> 8) / 255;
                    a.a = (255 & b) / 255
                };
                b.rgb888ToColor = function(a, b) {
                    a.r = ((16711680 & b) >>> 16) / 255;
                    a.g = ((65280 & b) >>> 8) / 255;
                    a.b = (255 & b) / 255
                };
                b.WHITE =
                    new b(1, 1, 1, 1);
                b.RED = new b(1, 0, 0, 1);
                b.GREEN = new b(0, 1, 0, 1);
                b.BLUE = new b(0, 0, 1, 1);
                b.MAGENTA = new b(1, 0, 1, 1);
                return b
            }();
            b.Color = e;
            e = function() {
                function b() {}
                b.clamp = function(a, b, c) {
                    return a < b ? b : a > c ? c : a
                };
                b.cosDeg = function(a) {
                    return Math.cos(a * b.degRad)
                };
                b.sinDeg = function(a) {
                    return Math.sin(a * b.degRad)
                };
                b.signum = function(a) {
                    return 0 < a ? 1 : 0 > a ? -1 : 0
                };
                b.toInt = function(a) {
                    return 0 < a ? Math.floor(a) : Math.ceil(a)
                };
                b.cbrt = function(a) {
                    var b = Math.pow(Math.abs(a), 1 / 3);
                    return 0 > a ? -b : b
                };
                b.randomTriangular = function(a,
                    c) {
                    return b.randomTriangularWith(a, c, .5 * (a + c))
                };
                b.randomTriangularWith = function(a, b, c) {
                    var d = Math.random(),
                        e = b - a;
                    return d <= (c - a) / e ? a + Math.sqrt(d * e * (c - a)) : b - Math.sqrt((1 - d) * e * (b - c))
                };
                b.PI = 3.1415927;
                b.PI2 = 2 * b.PI;
                b.radiansToDegrees = 180 / b.PI;
                b.radDeg = b.radiansToDegrees;
                b.degreesToRadians = b.PI / 180;
                b.degRad = b.degreesToRadians;
                return b
            }();
            b.MathUtils = e;
            e = function() {
                function b() {}
                b.prototype.apply = function(a, b, c) {
                    return a + (b - a) * this.applyInternal(c)
                };
                return b
            }();
            b.Interpolation = e;
            e = function(b) {
                function a(a) {
                    var c =
                        b.call(this) || this;
                    c.power = 2;
                    c.power = a;
                    return c
                }
                f(a, b);
                a.prototype.applyInternal = function(a) {
                    return .5 >= a ? Math.pow(2 * a, this.power) / 2 : Math.pow(2 * (a - 1), this.power) / (0 == this.power % 2 ? -2 : 2) + 1
                };
                return a
            }(e);
            b.Pow = e;
            e = function(b) {
                function a(a) {
                    return b.call(this, a) || this
                }
                f(a, b);
                a.prototype.applyInternal = function(a) {
                    return Math.pow(a - 1, this.power) * (0 == this.power % 2 ? -1 : 1) + 1
                };
                return a
            }(e);
            b.PowOut = e;
            e = function() {
                function b() {}
                b.arrayCopy = function(a, b, c, e, f) {
                    for (var d = b; d < b + f; d++, e++) c[e] = a[d]
                };
                b.setArraySize =
                    function(a, b, c) {
                        void 0 === c && (c = 0);
                        var d = a.length;
                        if (d == b) return a;
                        a.length = b;
                        if (d < b)
                            for (; d < b; d++) a[d] = c;
                        return a
                    };
                b.ensureArrayCapacity = function(a, c, e) {
                    void 0 === e && (e = 0);
                    return a.length >= c ? a : b.setArraySize(a, c, e)
                };
                b.newArray = function(a, b) {
                    for (var c = Array(a), d = 0; d < a; d++) c[d] = b;
                    return c
                };
                b.newFloatArray = function(a) {
                    if (b.SUPPORTS_TYPED_ARRAYS) return new Float32Array(a);
                    a = Array(a);
                    for (var c = 0; c < a.length; c++) a[c] = 0;
                    return a
                };
                b.newShortArray = function(a) {
                    if (b.SUPPORTS_TYPED_ARRAYS) return new Int16Array(a);
                    a = Array(a);
                    for (var c = 0; c < a.length; c++) a[c] = 0;
                    return a
                };
                b.toFloatArray = function(a) {
                    return b.SUPPORTS_TYPED_ARRAYS ? new Float32Array(a) : a
                };
                b.toSinglePrecision = function(a) {
                    return b.SUPPORTS_TYPED_ARRAYS ? Math.fround(a) : a
                };
                b.webkit602BugfixHelper = function(a, b) {};
                b.contains = function(a, b, c) {
                    for (c = 0; c < a.length; c++)
                        if (a[c] == b) return !0;
                    return !1
                };
                b.SUPPORTS_TYPED_ARRAYS = "undefined" !== typeof Float32Array;
                return b
            }();
            b.Utils = e;
            e = function() {
                function b() {}
                b.logBones = function(a) {
                    for (var b = 0; b < a.bones.length; b++) {
                        var c =
                            a.bones[b];
                        console.log(c.data.name + ", " + c.a + ", " + c.b + ", " + c.c + ", " + c.d + ", " + c.worldX + ", " + c.worldY)
                    }
                };
                return b
            }();
            b.DebugUtils = e;
            e = function() {
                function b(a) {
                    this.items = [];
                    this.instantiator = a
                }
                b.prototype.obtain = function() {
                    return 0 < this.items.length ? this.items.pop() : this.instantiator()
                };
                b.prototype.free = function(a) {
                    a.reset && a.reset();
                    this.items.push(a)
                };
                b.prototype.freeAll = function(a) {
                    for (var b = 0; b < a.length; b++) a[b].reset && a[b].reset(), this.items[b] = a[b]
                };
                b.prototype.clear = function() {
                    this.items.length =
                        0
                };
                return b
            }();
            b.Pool = e;
            e = function() {
                function b(a, b) {
                    void 0 === a && (a = 0);
                    void 0 === b && (b = 0);
                    this.x = a;
                    this.y = b
                }
                b.prototype.set = function(a, b) {
                    this.x = a;
                    this.y = b;
                    return this
                };
                b.prototype.length = function() {
                    var a = this.x,
                        b = this.y;
                    return Math.sqrt(a * a + b * b)
                };
                b.prototype.normalize = function() {
                    var a = this.length();
                    0 != a && (this.x /= a, this.y /= a);
                    return this
                };
                return b
            }();
            b.Vector2 = e;
            e = function() {
                function b() {
                    this.maxDelta = .064;
                    this.totalTime = this.delta = this.framesPerSecond = 0;
                    this.lastTime = Date.now() / 1E3;
                    this.frameTime =
                        this.frameCount = 0
                }
                b.prototype.update = function() {
                    var a = Date.now() / 1E3;
                    this.delta = a - this.lastTime;
                    this.frameTime += this.delta;
                    this.totalTime += this.delta;
                    this.delta > this.maxDelta && (this.delta = this.maxDelta);
                    this.lastTime = a;
                    this.frameCount++;
                    1 < this.frameTime && (this.framesPerSecond = this.frameCount / this.frameTime, this.frameCount = this.frameTime = 0)
                };
                return b
            }();
            b.TimeKeeper = e;
            e = function() {
                function b(a) {
                    void 0 === a && (a = 32);
                    this.mean = this.lastValue = this.addedValues = 0;
                    this.dirty = !0;
                    this.values = Array(a)
                }
                b.prototype.hasEnoughData =
                    function() {
                        return this.addedValues >= this.values.length
                    };
                b.prototype.addValue = function(a) {
                    this.addedValues < this.values.length && this.addedValues++;
                    this.values[this.lastValue++] = a;
                    this.lastValue > this.values.length - 1 && (this.lastValue = 0);
                    this.dirty = !0
                };
                b.prototype.getMean = function() {
                    if (this.hasEnoughData()) {
                        if (this.dirty) {
                            for (var a = 0, b = 0; b < this.values.length; b++) a += this.values[b];
                            this.mean = a / this.values.length;
                            this.dirty = !1
                        }
                        return this.mean
                    }
                    return 0
                };
                return b
            }();
            b.WindowedMean = e
        })(e || (e = {}));
        (function() {
            Math.fround ||
                (Math.fround = function(b) {
                    return function(e) {
                        return b[0] = e, b[0]
                    }
                }(new Float32Array(1)))
        })();
        (function(b) {
            var e = function() {
                return function(b) {
                    if (null == b) throw Error("name cannot be null.");
                    this.name = b
                }
            }();
            b.Attachment = e;
            e = function(c) {
                function a(b) {
                    b = c.call(this, b) || this;
                    b.id = (65535 & a.nextID++) << 11;
                    b.worldVerticesLength = 0;
                    return b.deformAttachment = b
                }
                f(a, c);
                a.prototype.computeWorldVertices = function(a, b, c, e, f, h) {
                    var d;
                    c = f + (c >> 1) * h;
                    var g = a.bone.skeleton;
                    var k = a.deform,
                        l = this.vertices,
                        n = this.bones;
                    if (null ==
                        n) {
                        0 < k.length && (l = k);
                        var m = a.bone;
                        k = m.worldX;
                        n = m.worldY;
                        var q = m.a;
                        g = m.b;
                        var t = m.c;
                        m = m.d;
                        for (var w = b; f < c; w += 2, f += h) a = l[w], b = l[w + 1], e[f] = a * q + b * g + k, e[f + 1] = a * t + b * m + n
                    } else {
                        for (m = a = t = 0; m < b; m += 2) q = n[t], t += q + 1, a += q;
                        w = g.bones;
                        if (0 == k.length)
                            for (g = 3 * a; f < c; f += h) {
                                var C = d = 0;
                                q = n[t++];
                                for (q += t; t < q; t++, g += 3) {
                                    m = w[n[t]];
                                    a = l[g];
                                    b = l[g + 1];
                                    var G = l[g + 2];
                                    d += (a * m.a + b * m.b + m.worldX) * G;
                                    C += (a * m.c + b * m.d + m.worldY) * G
                                }
                                e[f] = d;
                                e[f + 1] = C
                            } else {
                                g = 3 * a;
                                for (var F = a << 1; f < c; f += h) {
                                    C = d = 0;
                                    q = n[t++];
                                    for (q += t; t < q; t++, g += 3, F += 2) m = w[n[t]], a = l[g] + k[F],
                                        b = l[g + 1] + k[F + 1], G = l[g + 2], d += (a * m.a + b * m.b + m.worldX) * G, C += (a * m.c + b * m.d + m.worldY) * G;
                                    e[f] = d;
                                    e[f + 1] = C
                                }
                            }
                    }
                };
                a.prototype.copyTo = function(a) {
                    null != this.bones ? (a.bones = Array(this.bones.length), b.Utils.arrayCopy(this.bones, 0, a.bones, 0, this.bones.length)) : a.bones = null;
                    null != this.vertices ? (a.vertices = b.Utils.newFloatArray(this.vertices.length), b.Utils.arrayCopy(this.vertices, 0, a.vertices, 0, this.vertices.length)) : a.vertices = null;
                    a.worldVerticesLength = this.worldVerticesLength;
                    a.deformAttachment = this.deformAttachment
                };
                a.nextID = 0;
                return a
            }(e);
            b.VertexAttachment = e
        })(e || (e = {}));
        (function(b) {
            b = b.AttachmentType || (b.AttachmentType = {});
            b[b.Region = 0] = "Region";
            b[b.BoundingBox = 1] = "BoundingBox";
            b[b.Mesh = 2] = "Mesh";
            b[b.LinkedMesh = 3] = "LinkedMesh";
            b[b.Path = 4] = "Path";
            b[b.Point = 5] = "Point";
            b[b.Clipping = 6] = "Clipping"
        })(e || (e = {}));
        (function(b) {
            var e = function(c) {
                function a(a) {
                    a = c.call(this, a) || this;
                    a.color = new b.Color(1, 1, 1, 1);
                    return a
                }
                f(a, c);
                a.prototype.copy = function() {
                    var b = new a(name);
                    this.copyTo(b);
                    b.color.setFromColor(this.color);
                    return b
                };
                return a
            }(b.VertexAttachment);
            b.BoundingBoxAttachment = e
        })(e || (e = {}));
        (function(b) {
            var e = function(c) {
                function a(a) {
                    a = c.call(this, a) || this;
                    a.color = new b.Color(.2275, .2275, .8078, 1);
                    return a
                }
                f(a, c);
                a.prototype.copy = function() {
                    var b = new a(name);
                    this.copyTo(b);
                    b.endSlot = this.endSlot;
                    b.color.setFromColor(this.color);
                    return b
                };
                return a
            }(b.VertexAttachment);
            b.ClippingAttachment = e
        })(e || (e = {}));
        (function(b) {
            var e = function(c) {
                function a(a) {
                    a = c.call(this, a) || this;
                    a.color = new b.Color(1, 1, 1, 1);
                    a.tempColor =
                        new b.Color(0, 0, 0, 0);
                    return a
                }
                f(a, c);
                a.prototype.updateUVs = function() {
                    var a = this.regionUVs;
                    null != this.uvs && this.uvs.length == a.length || (this.uvs = b.Utils.newFloatArray(a.length));
                    var c = this.uvs,
                        e = this.uvs.length,
                        f = this.region.u,
                        h = this.region.v;
                    if (this.region instanceof b.TextureAtlasRegion) {
                        var k = this.region;
                        var m = k.texture.getImage().width;
                        var q = k.texture.getImage().height;
                        switch (k.degrees) {
                            case 90:
                                f -= (k.originalHeight - k.offsetY - k.height) / m;
                                h -= (k.originalWidth - k.offsetX - k.width) / q;
                                m = k.originalHeight /
                                    m;
                                k = k.originalWidth / q;
                                for (q = 0; q < e; q += 2) c[q] = f + a[q + 1] * m, c[q + 1] = h + (1 - a[q]) * k;
                                return;
                            case 180:
                                f -= (k.originalWidth - k.offsetX - k.width) / m;
                                h -= k.offsetY / q;
                                m = k.originalWidth / m;
                                k = k.originalHeight / q;
                                for (q = 0; q < e; q += 2) c[q] = f + (1 - a[q]) * m, c[q + 1] = h + (1 - a[q + 1]) * k;
                                return;
                            case 270:
                                f -= k.offsetY / m;
                                h -= k.offsetX / q;
                                m = k.originalHeight / m;
                                k = k.originalWidth / q;
                                for (q = 0; q < e; q += 2) c[q] = f + (1 - a[q + 1]) * m, c[q + 1] = h + a[q] * k;
                                return
                        }
                        f -= k.offsetX / m;
                        h -= (k.originalHeight - k.offsetY - k.height) / q;
                        m = k.originalWidth / m;
                        k = k.originalHeight / q
                    } else null ==
                        this.region ? (f = h = 0, m = k = 1) : (m = this.region.u2 - f, k = this.region.v2 - h);
                    for (q = 0; q < e; q += 2) c[q] = f + a[q] * m, c[q + 1] = h + a[q + 1] * k
                };
                a.prototype.getParentMesh = function() {
                    return this.parentMesh
                };
                a.prototype.setParentMesh = function(a) {
                    this.parentMesh = a;
                    null != a && (this.bones = a.bones, this.vertices = a.vertices, this.worldVerticesLength = a.worldVerticesLength, this.regionUVs = a.regionUVs, this.triangles = a.triangles, this.hullLength = a.hullLength, this.worldVerticesLength = a.worldVerticesLength)
                };
                a.prototype.copy = function() {
                    if (null !=
                        this.parentMesh) return this.newLinkedMesh();
                    var c = new a(this.name);
                    c.region = this.region;
                    c.path = this.path;
                    c.color.setFromColor(this.color);
                    this.copyTo(c);
                    c.regionUVs = Array(this.regionUVs.length);
                    b.Utils.arrayCopy(this.regionUVs, 0, c.regionUVs, 0, this.regionUVs.length);
                    c.uvs = Array(this.uvs.length);
                    b.Utils.arrayCopy(this.uvs, 0, c.uvs, 0, this.uvs.length);
                    c.triangles = Array(this.triangles.length);
                    b.Utils.arrayCopy(this.triangles, 0, c.triangles, 0, this.triangles.length);
                    c.hullLength = this.hullLength;
                    null != this.edges &&
                        (c.edges = Array(this.edges.length), b.Utils.arrayCopy(this.edges, 0, c.edges, 0, this.edges.length));
                    c.width = this.width;
                    c.height = this.height;
                    return c
                };
                a.prototype.newLinkedMesh = function() {
                    var b = new a(this.name);
                    b.region = this.region;
                    b.path = this.path;
                    b.color.setFromColor(this.color);
                    b.deformAttachment = this.deformAttachment;
                    b.setParentMesh(null != this.parentMesh ? this.parentMesh : this);
                    b.updateUVs();
                    return b
                };
                return a
            }(b.VertexAttachment);
            b.MeshAttachment = e
        })(e || (e = {}));
        (function(b) {
            var e = function(c) {
                function a(a) {
                    a =
                        c.call(this, a) || this;
                    a.closed = !1;
                    a.constantSpeed = !1;
                    a.color = new b.Color(1, 1, 1, 1);
                    return a
                }
                f(a, c);
                a.prototype.copy = function() {
                    var c = new a(name);
                    this.copyTo(c);
                    c.lengths = Array(this.lengths.length);
                    b.Utils.arrayCopy(this.lengths, 0, c.lengths, 0, this.lengths.length);
                    c.closed = closed;
                    c.constantSpeed = this.constantSpeed;
                    c.color.setFromColor(this.color);
                    return c
                };
                return a
            }(b.VertexAttachment);
            b.PathAttachment = e
        })(e || (e = {}));
        (function(b) {
            var e = function(c) {
                function a(a) {
                    a = c.call(this, a) || this;
                    a.color = new b.Color(.38,
                        .94, 0, 1);
                    return a
                }
                f(a, c);
                a.prototype.computeWorldPosition = function(a, b) {
                    b.x = this.x * a.a + this.y * a.b + a.worldX;
                    b.y = this.x * a.c + this.y * a.d + a.worldY;
                    return b
                };
                a.prototype.computeWorldRotation = function(a) {
                    var c = b.MathUtils.cosDeg(this.rotation),
                        d = b.MathUtils.sinDeg(this.rotation);
                    return Math.atan2(c * a.c + d * a.d, c * a.a + d * a.b) * b.MathUtils.radDeg
                };
                a.prototype.copy = function() {
                    var b = new a(name);
                    b.x = this.x;
                    b.y = this.y;
                    b.rotation = this.rotation;
                    b.color.setFromColor(this.color);
                    return b
                };
                return a
            }(b.VertexAttachment);
            b.PointAttachment = e
        })(e || (e = {}));
        (function(b) {
            var e = function(c) {
                function a(a) {
                    a = c.call(this, a) || this;
                    a.x = 0;
                    a.y = 0;
                    a.scaleX = 1;
                    a.scaleY = 1;
                    a.rotation = 0;
                    a.width = 0;
                    a.height = 0;
                    a.color = new b.Color(1, 1, 1, 1);
                    a.offset = b.Utils.newFloatArray(8);
                    a.uvs = b.Utils.newFloatArray(8);
                    a.tempColor = new b.Color(1, 1, 1, 1);
                    return a
                }
                f(a, c);
                a.prototype.updateOffset = function() {
                    var b = this.width / this.region.originalWidth * this.scaleX,
                        c = this.height / this.region.originalHeight * this.scaleY,
                        e = -this.width / 2 * this.scaleX + this.region.offsetX *
                        b,
                        f = -this.height / 2 * this.scaleY + this.region.offsetY * c,
                        h = e + this.region.width * b;
                    b = f + this.region.height * c;
                    c = this.rotation * Math.PI / 180;
                    var k = Math.cos(c),
                        m = Math.sin(c);
                    c = e * k + this.x;
                    e *= m;
                    var q = f * k + this.y;
                    f *= m;
                    var v = h * k + this.x;
                    h *= m;
                    k = b * k + this.y;
                    b *= m;
                    m = this.offset;
                    m[a.OX1] = c - f;
                    m[a.OY1] = q + e;
                    m[a.OX2] = c - b;
                    m[a.OY2] = k + e;
                    m[a.OX3] = v - b;
                    m[a.OY3] = k + h;
                    m[a.OX4] = v - f;
                    m[a.OY4] = q + h
                };
                a.prototype.setRegion = function(a) {
                    this.region = a;
                    var b = this.uvs;
                    a.rotate ? (b[2] = a.u, b[3] = a.v2, b[4] = a.u, b[5] = a.v, b[6] = a.u2, b[7] = a.v, b[0] = a.u2, b[1] =
                        a.v2) : (b[0] = a.u, b[1] = a.v2, b[2] = a.u, b[3] = a.v, b[4] = a.u2, b[5] = a.v, b[6] = a.u2, b[7] = a.v2)
                };
                a.prototype.computeWorldVertices = function(b, c, e, f) {
                    var d = this.offset,
                        g = b.worldX,
                        h = b.worldY,
                        k = b.a,
                        l = b.b,
                        n = b.c;
                    b = b.d;
                    var m = d[a.OX1];
                    var q = d[a.OY1];
                    c[e] = m * k + q * l + g;
                    c[e + 1] = m * n + q * b + h;
                    e += f;
                    m = d[a.OX2];
                    q = d[a.OY2];
                    c[e] = m * k + q * l + g;
                    c[e + 1] = m * n + q * b + h;
                    e += f;
                    m = d[a.OX3];
                    q = d[a.OY3];
                    c[e] = m * k + q * l + g;
                    c[e + 1] = m * n + q * b + h;
                    e += f;
                    m = d[a.OX4];
                    q = d[a.OY4];
                    c[e] = m * k + q * l + g;
                    c[e + 1] = m * n + q * b + h
                };
                a.prototype.copy = function() {
                    var c = new a(name);
                    c.region = this.region;
                    c.rendererObject = this.rendererObject;
                    c.path = this.path;
                    c.x = this.x;
                    c.y = this.y;
                    c.scaleX = this.scaleX;
                    c.scaleY = this.scaleY;
                    c.rotation = this.rotation;
                    c.width = this.width;
                    c.height = this.height;
                    b.Utils.arrayCopy(this.uvs, 0, c.uvs, 0, 8);
                    b.Utils.arrayCopy(this.offset, 0, c.offset, 0, 8);
                    c.color.setFromColor(this.color);
                    return c
                };
                a.OX1 = 0;
                a.OY1 = 1;
                a.OX2 = 2;
                a.OY2 = 3;
                a.OX3 = 4;
                a.OY3 = 5;
                a.OX4 = 6;
                a.OY4 = 7;
                a.X1 = 0;
                a.Y1 = 1;
                a.C1R = 2;
                a.C1G = 3;
                a.C1B = 4;
                a.C1A = 5;
                a.U1 = 6;
                a.V1 = 7;
                a.X2 = 8;
                a.Y2 = 9;
                a.C2R = 10;
                a.C2G = 11;
                a.C2B = 12;
                a.C2A = 13;
                a.U2 = 14;
                a.V2 = 15;
                a.X3 = 16;
                a.Y3 = 17;
                a.C3R = 18;
                a.C3G = 19;
                a.C3B = 20;
                a.C3A = 21;
                a.U3 = 22;
                a.V3 = 23;
                a.X4 = 24;
                a.Y4 = 25;
                a.C4R = 26;
                a.C4G = 27;
                a.C4B = 28;
                a.C4A = 29;
                a.U4 = 30;
                a.V4 = 31;
                return a
            }(b.Attachment);
            b.RegionAttachment = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function c(a, b) {
                    this.jitterY = this.jitterX = 0;
                    this.jitterX = a;
                    this.jitterY = b
                }
                c.prototype.begin = function(a) {};
                c.prototype.transform = function(a, c, e, f) {
                    a.x += b.MathUtils.randomTriangular(-this.jitterX, this.jitterY);
                    a.y += b.MathUtils.randomTriangular(-this.jitterX, this.jitterY)
                };
                c.prototype.end =
                    function() {};
                return c
            }();
            b.JitterEffect = e
        })(e || (e = {}));
        (function(b) {
            var e = function() {
                function c(a, b) {
                    this.worldY = this.worldX = this.angle = this.radius = this.centerY = this.centerX = 0;
                    this.radius = a;
                    this.interpolation = b
                }
                c.prototype.begin = function(a) {
                    this.worldX = a.x + this.centerX;
                    this.worldY = a.y + this.centerY
                };
                c.prototype.transform = function(a, c, e, f) {
                    f = this.angle * b.MathUtils.degreesToRadians;
                    c = a.x - this.worldX;
                    e = a.y - this.worldY;
                    var d = Math.sqrt(c * c + e * e);
                    d < this.radius && (d = this.interpolation.apply(0, f, (this.radius -
                        d) / this.radius), f = Math.cos(d), d = Math.sin(d), a.x = f * c - d * e + this.worldX, a.y = d * c + f * e + this.worldY)
                };
                c.prototype.end = function() {};
                c.interpolation = new b.PowOut(2);
                return c
            }();
            b.SwirlEffect = e
        })(e || (e = {}));
        q.exports = e
    }, {}],
    368: [function(h, q, m) {
        var f = h("./track-entry-listeners"),
            e = h("./lib/spine"),
            b = 1 / 60,
            k = [],
            c = [],
            a = 0,
            d = 0,
            l = 0,
            g = null,
            n = null,
            w = 0,
            t = 0,
            p = 0,
            u = 0,
            v = null,
            A = null,
            B = 0,
            E = 0,
            y, z, x, C, G, F, H = new e.Color(1, 1, 1, 1),
            I = new e.Color(1, 1, 1, 1),
            K = [0, 1, 2, 2, 3, 0],
            P = cc.Class({
                ctor: function() {
                    this._inited = this._privateMode = !1;
                    this._invalid = !0;
                    this._enableCacheAttachedInfo = !1;
                    this.frames = [];
                    this.totalTime = 0;
                    this._frameIdx = -1;
                    this.isCompleted = !1;
                    this._tempBoneInfos = this._tempColors = this._tempSegments = this._animationName = this._skeletonInfo = null
                },
                init: function(a, b) {
                    this._inited = !0;
                    this._animationName = b;
                    this._skeletonInfo = a
                },
                clear: function() {
                    this._inited = !1;
                    for (var a = 0, b = this.frames.length; a < b; a++) this.frames[a].segments.length = 0;
                    this.invalidAllFrame()
                },
                bind: function(a) {
                    var b = function(a) {
                        a && a.animation.name === this._animationName &&
                            (this.isCompleted = !0)
                    }.bind(this);
                    a.complete = b
                },
                unbind: function(a) {
                    a.complete = null
                },
                begin: function() {
                    if (this._invalid) {
                        var a = this._skeletonInfo,
                            b = a.curAnimationCache;
                        b && b !== this && (this._privateMode ? b.invalidAllFrame() : b.updateToFrame());
                        b = a.listener;
                        var c = a.state,
                            d = a.skeleton.data.findAnimation(this._animationName);
                        c.setAnimationWith(0, d, !1);
                        this.bind(b);
                        a.curAnimationCache = this;
                        this._frameIdx = -1;
                        this.isCompleted = !1;
                        this.totalTime = 0;
                        this._invalid = !1
                    }
                },
                end: function() {
                    this._needToUpdate() || (this._skeletonInfo.curAnimationCache =
                        null, this.frames.length = this._frameIdx + 1, this.isCompleted = !0, this.unbind(this._skeletonInfo.listener))
                },
                _needToUpdate: function(a) {
                    return !this.isCompleted && 30 > this.totalTime && (void 0 == a || this._frameIdx < a)
                },
                updateToFrame: function(a) {
                    if (this._inited && (this.begin(), this._needToUpdate(a))) {
                        var c = this._skeletonInfo,
                            d = c.skeleton,
                            e = c.clipper;
                        c = c.state;
                        do d.update(b), c.update(b), c.apply(d), d.updateWorldTransform(), this._frameIdx++, this._updateFrame(d, e, this._frameIdx), this.totalTime += b; while (this._needToUpdate(a));
                        this.end()
                    }
                },
                isInited: function() {
                    return this._inited
                },
                isInvalid: function() {
                    return this._invalid
                },
                invalidAllFrame: function() {
                    this.isCompleted = !1;
                    this._invalid = !0
                },
                updateAllFrame: function() {
                    this.invalidAllFrame();
                    this.updateToFrame()
                },
                enableCacheAttachedInfo: function() {
                    this._enableCacheAttachedInfo || (this._enableCacheAttachedInfo = !0, this.invalidAllFrame())
                },
                _updateFrame: function(b, e, f) {
                    d = a = l = 0;
                    n = g = null;
                    u = p = t = w = 0;
                    A = v = null;
                    this.frames[f] = this.frames[f] || {
                        segments: [],
                        colors: [],
                        boneInfos: [],
                        vertices: null,
                        uintVert: null,
                        indices: null
                    };
                    f = this.frames[f];
                    var h = this._tempSegments = f.segments,
                        m = this._tempColors = f.colors,
                        q = this._tempBoneInfos = f.boneInfos;
                    this._traverseSkeleton(b, e);
                    0 < u && (m[u - 1].vfOffset = l);
                    m.length = u;
                    q.length = a;
                    b = p - 1;
                    0 <= b && (0 < t ? (b = h[b], b.indexCount = t, b.vfCount = 6 * w, b.vertexCount = w, h.length = p) : h.length = p - 1);
                    if (0 != h.length) {
                        h = f.vertices;
                        b = f.uintVert;
                        if (!h || h.length < l) h = f.vertices = new Float32Array(l), b = f.uintVert = new Uint32Array(h.buffer);
                        for (m = e = 0; e < l;) h[e++] = k[m++], h[e++] = k[m++], h[e++] = k[m++],
                            h[e++] = k[m++], b[e++] = k[m++], b[e++] = k[m++];
                        e = f.indices;
                        (!e || e.length < d) && (e = f.indices = new Uint16Array(d));
                        for (m = 0; m < d; m++) e[m] = c[m];
                        f.vertices = h;
                        f.uintVert = b;
                        f.indices = e
                    }
                },
                fillVertices: function(a, b, e, f, g) {
                    C = e.a * b.a * a.a * 255;
                    y = b.r * a.r * 255;
                    z = b.g * a.g * 255;
                    x = b.b * a.b * 255;
                    H.r = y * e.r;
                    H.g = z * e.g;
                    H.b = x * e.b;
                    H.a = C;
                    null == g.darkColor ? I.set(0, 0, 0, 1) : (I.r = g.darkColor.r * y, I.g = g.darkColor.g * z, I.b = g.darkColor.b * x);
                    I.a = 0;
                    G = (H.a << 24 >>> 0) + (H.b << 16) + (H.g << 8) + H.r;
                    F = (I.a << 24 >>> 0) + (I.b << 16) + (I.g << 8) + I.r;
                    if (v !== G || A !== F) a = this._tempColors,
                        v = G, A = F, 0 < u && (a[u - 1].vfOffset = l), a[u++] = {
                            fr: H.r,
                            fg: H.g,
                            fb: H.b,
                            fa: H.a,
                            dr: I.r,
                            dg: I.g,
                            db: I.b,
                            da: I.a,
                            vfOffset: 0
                        };
                    if (f.isClipping()) {
                        f.clipTriangles(k, B, c, E, k, H, I, !0, 6, d, l, l + 2);
                        a = f.clippedVertices;
                        f = f.clippedTriangles;
                        E = f.length;
                        B = a.length / 12 * 6;
                        b = 0;
                        e = d;
                        for (g = f.length; b < g;) c[e++] = f[b++];
                        f = 0;
                        b = a.length;
                        for (e = l; f < b; f += 12, e += 6) k[e] = a[f], k[e + 1] = a[f + 1], k[e + 2] = a[f + 6], k[e + 3] = a[f + 7], k[e + 4] = G, k[e + 5] = F
                    } else
                        for (a = l, f = l + B; a < f; a += 6) k[a + 4] = G, k[a + 5] = F
                },
                _traverseSkeleton: function(b, f) {
                    var h = this._tempSegments,
                        m = this._tempBoneInfos,
                        q = b.color,
                        u, v, x, y = b.bones;
                    if (this._enableCacheAttachedInfo) {
                        var z = 0;
                        for (u = y.length; z < u; z++, a++) {
                            var A = y[z];
                            (v = m[a]) || (v = m[a] = {});
                            v.a = A.a;
                            v.b = A.b;
                            v.c = A.c;
                            v.d = A.d;
                            v.worldX = A.worldX;
                            v.worldY = A.worldY
                        }
                    }
                    y = 0;
                    for (z = b.drawOrder.length; y < z; y++)
                        if (m = b.drawOrder[y], E = B = 0, u = m.getAttachment())
                            if (A = u instanceof e.RegionAttachment, v = u instanceof e.MeshAttachment, x = u instanceof e.ClippingAttachment) f.clipStart(m, u);
                            else {
                                if (A || v)
                                    if (x = u.region.texture._texture) {
                                        var C = m.data.blendMode;
                                        if (g !== x.nativeUrl || n !== C) {
                                            g = x.nativeUrl;
                                            n = C;
                                            var F = p - 1;
                                            0 <= F && (0 < t ? (F = h[F], F.indexCount = t, F.vertexCount = w, F.vfCount = 6 * w) : p--);
                                            h[p] = {
                                                tex: x,
                                                blendMode: C,
                                                indexCount: 0,
                                                vertexCount: 0,
                                                vfCount: 0
                                            };
                                            p++;
                                            w = t = 0
                                        }
                                        if (A) {
                                            var G = K;
                                            B = 24;
                                            E = 6;
                                            u.computeWorldVertices(m.bone, k, l, 6)
                                        } else v && (G = u.triangles, B = 6 * (u.worldVerticesLength >> 1), E = G.length, u.computeWorldVertices(m, 0, u.worldVerticesLength, k, l, 6));
                                        if (0 != B && 0 != E) {
                                            A = 0;
                                            v = d;
                                            for (x = G.length; A < x;) c[v++] = G[A++];
                                            A = u.uvs;
                                            v = l;
                                            x = l + B;
                                            for (C = 0; v < x; v += 6, C += 2) k[v + 2] = A[C], k[v + 3] = A[C + 1];
                                            u = u.color;
                                            A = m.color;
                                            this.fillVertices(q,
                                                u, A, f, m);
                                            if (0 < E) {
                                                u = d;
                                                for (A = d + E; u < A; u++) c[u] += w;
                                                d += E;
                                                l += B;
                                                t += E;
                                                w += B / 6
                                            }
                                        }
                                    }
                                f.clipEndWithSlot(m)
                            }
                    else f.clipEndWithSlot(m);
                    f.clipEnd()
                }
            });
        h = cc.Class({
            ctor: function() {
                this._privateMode = !1;
                this._animationPool = {};
                this._skeletonCache = {}
            },
            enablePrivateMode: function() {
                this._privateMode = !0
            },
            clear: function() {
                this._animationPool = {};
                this._skeletonCache = {}
            },
            removeSkeleton: function(a) {
                var b = this._skeletonCache[a];
                if (b) {
                    b = b.animationsCache;
                    for (var c in b) {
                        var d = b[c];
                        d && (this._animationPool[a + "#" + c] = d, d.clear())
                    }
                    delete this._skeletonCache[a]
                }
            },
            getSkeletonCache: function(a, b) {
                var c = this._skeletonCache[a];
                if (!c) {
                    b = new e.Skeleton(b);
                    c = new e.SkeletonClipping;
                    var d = new e.AnimationStateData(b.data);
                    d = new e.AnimationState(d);
                    var g = new f;
                    d.addListener(g);
                    this._skeletonCache[a] = c = {
                        skeleton: b,
                        clipper: c,
                        state: d,
                        listener: g,
                        animationsCache: {},
                        curAnimationCache: null
                    }
                }
                return c
            },
            getAnimationCache: function(a, b) {
                return (a = this._skeletonCache[a]) ? a.animationsCache[b] : null
            },
            invalidAnimationCache: function(a) {
                if ((a = this._skeletonCache[a]) && a.skeleton) {
                    a = a.animationsCache;
                    for (var b in a) a[b].invalidAllFrame()
                }
            },
            initAnimationCache: function(a, b) {
                if (!b) return null;
                var c = this._skeletonCache[a],
                    d = c && c.skeleton;
                if (!d || !d.data.findAnimation(b)) return null;
                d = c.animationsCache;
                var e = d[b];
                e || (a = a + "#" + b, (e = this._animationPool[a]) ? delete this._animationPool[a] : (e = new P, e._privateMode = this._privateMode), e.init(c, b), d[b] = e);
                return e
            },
            updateAnimationCache: function(a, b) {
                if (b) {
                    var c = this.initAnimationCache(a, b);
                    if (!c) return null;
                    c.updateAllFrame()
                } else if ((a = this._skeletonCache[a]) &&
                    a.skeleton)
                    for (c in a = a.animationsCache, a) a[c].updateAllFrame()
            }
        });
        h.FrameTime = b;
        h.sharedCache = new h;
        q.exports = h
    }, {
        "./lib/spine": 367,
        "./track-entry-listeners": 372
    }],
    369: [function(h, q, m) {
        var f = (!0, h("./skeleton-cache").sharedCache);
        h = cc.Class({
            name: "sp.SkeletonData",
            extends: cc.Asset,
            ctor: function() {
                this.reset()
            },
            properties: {
                _skeletonJson: null,
                skeletonJsonStr: {
                    get: function() {
                        return this._skeletonJson ? JSON.stringify(this._skeletonJson) : ""
                    }
                },
                skeletonJson: {
                    get: function() {
                        return this._skeletonJson
                    },
                    set: function(e) {
                        this.reset();
                        this._skeletonJson = "string" == typeof e ? JSON.parse(e) : e;
                        !this._uuid && e.skeleton && (this._uuid = e.skeleton.hash)
                    }
                },
                _atlasText: "",
                atlasText: {
                    get: function() {
                        return this._atlasText
                    },
                    set: function(e) {
                        this._atlasText = e;
                        this.reset()
                    }
                },
                textures: {
                    default: [],
                    type: [cc.Texture2D]
                },
                textureNames: {
                    default: [],
                    type: [cc.String]
                },
                scale: 1,
                _nativeAsset: {
                    get: function() {
                        return this._buffer
                    },
                    set: function(e) {
                        this._buffer = e.buffer || e;
                        this.reset()
                    },
                    override: !0
                }
            },
            statics: {
                preventDeferredLoadDependents: !0
            },
            createNode: !1,
            reset: function() {
                this._atlasCache =
                    this._skeletonCache = null;
                !1
            },
            ensureTexturesLoaded: function(e, b) {
                var f = this.textures,
                    c = f.length;
                if (0 == c) e.call(b, !1);
                else
                    for (var a = 0, d = function() {
                            a++;
                            a >= c && (e && e.call(b, !0), e = null)
                        }, h = 0; h < c; h++) {
                        var g = f[h];
                        g.loaded ? d() : g.once("load", d)
                    }
            },
            isTexturesLoaded: function() {
                for (var e = this.textures, b = e.length, f = 0; f < b; f++)
                    if (!e[f].loaded) return !1;
                return !0
            },
            getRuntimeData: function(e) {
                if (this._skeletonCache) return this._skeletonCache;
                if (!(this.textures && 0 < this.textures.length) && this.textureNames && 0 < this.textureNames.length) return e ||
                    cc.errorID(7507, this.name), null;
                e = this._getAtlas(e);
                if (!e) return null;
                var b = new sp.spine.AtlasAttachmentLoader(e);
                if (this.skeletonJson) {
                    var f = new sp.spine.SkeletonJson(b);
                    b = this.skeletonJson
                } else f = new sp.spine.SkeletonBinary(b), b = new Uint8Array(this._nativeAsset);
                f.scale = this.scale;
                this._skeletonCache = f.readSkeletonData(b);
                e.dispose();
                return this._skeletonCache
            },
            getSkinsEnum: !1,
            getAnimsEnum: !1,
            _getTexture: function(e) {
                for (var b = this.textureNames, f = 0; f < b.length; f++)
                    if (b[f] === e) return e = this.textures[f],
                        b = new sp.SkeletonTexture({
                            width: e.width,
                            height: e.height
                        }), b.setRealTexture(e), b;
                cc.errorID(7506, e);
                return null
            },
            _getAtlas: function(e) {
                return this._atlasCache ? this._atlasCache : this.atlasText ? this._atlasCache = new sp.spine.TextureAtlas(this.atlasText, this._getTexture.bind(this)) : (e || cc.errorID(7508, this.name), null)
            },
            destroy: function() {
                f.removeSkeleton(this._uuid);
                this._super()
            }
        });
        sp.SkeletonData = q.exports = h
    }, {
        "./skeleton-cache": 368
    }],
    370: [function(h, q, m) {
        sp.SkeletonTexture = cc.Class({
            name: "sp.SkeletonTexture",
            extends: sp.spine.Texture,
            _texture: null,
            _material: null,
            setRealTexture: function(f) {
                this._texture = f
            },
            getRealTexture: function() {
                return this._texture
            },
            setFilters: function(f, e) {
                this._texture && this._texture.setFilters(f, e)
            },
            setWraps: function(f, e) {
                this._texture && this._texture.setWrapMode(f, e)
            },
            dispose: function() {}
        })
    }, {}],
    371: [function(h, q, m) {
        function f(a, b) {
            a.prototype = Object.create(b.prototype);
            a.prototype.constructor = a;
            a.__proto__ = b
        }

        function e(a, b) {
            switch (b) {
                case d.BlendMode.Additive:
                    b = C ? cc.macro.ONE : cc.macro.SRC_ALPHA;
                    var c = cc.macro.ONE;
                    break;
                case d.BlendMode.Multiply:
                    b = cc.macro.DST_COLOR;
                    c = cc.macro.ONE_MINUS_SRC_ALPHA;
                    break;
                case d.BlendMode.Screen:
                    b = cc.macro.ONE;
                    c = cc.macro.ONE_MINUS_SRC_COLOR;
                    break;
                default:
                    b = C ? cc.macro.ONE : cc.macro.SRC_ALPHA, c = cc.macro.ONE_MINUS_SRC_ALPHA
            }
            var e = !sa.enableBatch,
                f = sa._materials[0];
            if (!f) return null;
            var g = a.getId() + b + c + I + e,
                h = sa._materialCache,
                k = h[g];
            k || (h.baseMaterial ? k = cc.MaterialVariant.create(f) : (k = f, h.baseMaterial = f), k.define("CC_USE_MODEL", e), k.define("USE_TINT", I), k.setProperty("texture",
                a), k.setBlend(!0, w.BLEND_FUNC_ADD, b, c, w.BLEND_FUNC_ADD, b, c), h[g] = k);
            return k
        }

        function b(a) {
            Wa = a.fa * U;
            G = C ? Wa / 255 : 1;
            oa = M * G;
            Ia = O * G;
            xa = L * G;
            Qa = a.fr * oa;
            Da = a.fg * Ia;
            Ya = a.fb * xa;
            V = (Wa << 24 >>> 0) + (Ya << 16) + (Da << 8) + Qa;
            Ca = a.dr * oa;
            Na = a.dg * Ia;
            Oa = a.db * xa;
            Pa = C ? 255 : 0;
            Z = (Pa << 24 >>> 0) + (Oa << 16) + (Na << 8) + Ca
        }

        function k(a) {
            return (a.a << 24 >>> 0) + (a.b << 16) + (a.g << 8) + a.r
        }
        m.__esModule = !0;
        m["default"] = void 0;
        var c = function(a) {
                return a && a.__esModule ? a : {
                    default: a
                }
            }(h("../../cocos2d/core/renderer/assembler")),
            a = h("./Skeleton"),
            d = h("./lib/spine"),
            l = h("../../cocos2d/core/renderer/render-flow");
        h = h("../../cocos2d/core/renderer/webgl/vertex-format");
        var g = h.vfmtPosUvColor,
            n = h.vfmtPosUvTwoColor,
            w = cc.gfx,
            t = 0,
            p = [0, 1, 2, 2, 3, 0],
            u = cc.color(0, 0, 255, 255),
            v = cc.color(255, 0, 0, 255),
            A = cc.color(0, 255, 0, 255),
            B = cc.color(255, 255, 0, 255),
            E = null,
            y = null,
            z = null,
            x = null;
        !0;
        E = new d.Color(1, 1, 1, 1);
        y = new d.Color(1, 1, 1, 1);
        z = new d.Vector2;
        x = new d.Vector2;
        var C, G, F, H, I, K, P, S, M, O, L, U, V, Z, da, Q, R, fa = 0,
            ba = 0,
            W = 0,
            aa = 0,
            ca = 0,
            ha = 0,
            ia = 0,
            Ba, ea, X, na, ma, r, Aa, ja, la, ta, N, T, pa, oa, Ia, xa, Qa,
            Da, Ya, Wa, Ca, Na, Oa, Pa, sa, ka, ua, Ea, Xa, ya;
        h = function(a) {
            function c() {
                return a.apply(this, arguments) || this
            }
            f(c, a);
            var h = c.prototype;
            h.updateRenderData = function(a) {
                a.isAnimationCached() || (a = a._skeleton) && a.updateWorldTransform()
            };
            h.fillVertices = function(a, b, c, d, e) {
                var f = ka._vData,
                    g = ka._iData,
                    h = ka._uintVData;
                E.a = c.a * b.a * a.a * U * 255;
                G = C ? E.a : 255;
                Ba = M * b.r * a.r * G;
                ea = O * b.g * a.g * G;
                X = L * b.b * a.b * G;
                E.r = Ba * c.r;
                E.g = ea * c.g;
                E.b = X * c.b;
                null == e.darkColor ? y.set(0, 0, 0, 1) : (y.r = e.darkColor.r * Ba, y.g = e.darkColor.g * ea, y.b = e.darkColor.b *
                    X);
                y.a = C ? 255 : 0;
                if (d.isClipping())
                    if (h = f.subarray(W + 2), d.clipTriangles(f.subarray(W), fa, g.subarray(ha), ca, h, E, y, I, Q), a = new Float32Array(d.clippedVertices), d = d.clippedTriangles, ca = d.length, fa = a.length / R * Q, h = ka.request(fa / Q, ca), ha = h.indiceOffset, aa = h.vertexOffset, W = h.byteOffset >> 2, f = ka._vData, g = ka._iData, h = ka._uintVData, g.set(d, ha), ya)
                        for (g = 0, d = a.length, b = W; g < d; g += R, b += Q) z.x = a[g], z.y = a[g + 1], E.set(a[g + 2], a[g + 3], a[g + 4], a[g + 5]), x.x = a[g + 6], x.y = a[g + 7], I ? y.set(a[g + 8], a[g + 9], a[g + 10], a[g + 11]) : y.set(0, 0, 0, 0),
                            ya.transform(z, x, E, y), f[b] = z.x, f[b + 1] = z.y, f[b + 2] = x.x, f[b + 3] = x.y, h[b + 4] = k(E), I && (h[b + 5] = k(y));
                    else
                        for (g = 0, d = a.length, b = W; g < d; g += R, b += Q) f[b] = a[g], f[b + 1] = a[g + 1], f[b + 2] = a[g + 6], f[b + 3] = a[g + 7], V = (a[g + 5] << 24 >>> 0) + (a[g + 4] << 16) + (a[g + 3] << 8) + a[g + 2], h[b + 4] = V, I && (Z = (a[g + 11] << 24 >>> 0) + (a[g + 10] << 16) + (a[g + 9] << 8) + a[g + 8], h[b + 5] = Z);
                else if (ya)
                    for (a = W, g = W + fa; a < g; a += Q) z.x = f[a], z.y = f[a + 1], x.x = f[a + 2], x.y = f[a + 3], ya.transform(z, x, E, y), f[a] = z.x, f[a + 1] = z.y, f[a + 2] = x.x, f[a + 3] = x.y, h[a + 4] = k(E), I && (h[a + 5] = k(y));
                else
                    for (V = k(E), Z =
                        k(y), f = W, a = W + fa; f < a; f += Q) h[f + 4] = V, I && (h[f + 5] = Z)
            };
            h.realTimeTraverse = function(a) {
                var b = sa._skeleton,
                    c = b.color,
                    f = sa._debugRenderer,
                    g = sa._clipper,
                    h, k;
                F = sa._startSlotIndex;
                H = sa._endSlotIndex;
                na = !1; - 1 == F && (na = !0);
                K = sa.debugSlots;
                P = sa.debugBones;
                S = sa.debugMesh;
                f && (P || K || S) && (f.clear(), f.lineWidth = 2);
                R = I ? 12 : 8;
                for (var l = ha = ca = aa = W = fa = 0, n = b.drawOrder.length; l < n; l++) {
                    var m = b.drawOrder[l];
                    if (void 0 != m)
                        if (0 <= F && F == m.data.index && (na = !0), na)
                            if (0 <= H && H == m.data.index && (na = !1), ca = fa = 0, k = m.getAttachment()) {
                                var q = k instanceof
                                d.RegionAttachment;
                                var t = k instanceof d.MeshAttachment;
                                if (h = k instanceof d.ClippingAttachment) g.clipStart(m, k);
                                else {
                                    if (q || t)
                                        if (h = e(k.region.texture._texture, m.data.blendMode)) {
                                            if (ma || h.getHash() !== ua.material.getHash()) ma = !1, ua._flush(), ua.node = Ea, ua.material = h;
                                            if (q) {
                                                var w = p;
                                                fa = 4 * Q;
                                                ca = 6;
                                                var x = ka.request(4, 6);
                                                ha = x.indiceOffset;
                                                aa = x.vertexOffset;
                                                W = x.byteOffset >> 2;
                                                x = ka._vData;
                                                var y = ka._iData;
                                                k.computeWorldVertices(m.bone, x, W, Q);
                                                if (f && K) {
                                                    f.strokeColor = u;
                                                    f.moveTo(x[W], x[W + 1]);
                                                    q = W + Q;
                                                    for (t = W + fa; q < t; q += Q) f.lineTo(x[q],
                                                        x[q + 1]);
                                                    f.close();
                                                    f.stroke()
                                                }
                                            } else if (t && (w = k.triangles, fa = (k.worldVerticesLength >> 1) * Q, ca = w.length, x = ka.request(fa / Q, ca), ha = x.indiceOffset, aa = x.vertexOffset, W = x.byteOffset >> 2, x = ka._vData, y = ka._iData, k.computeWorldVertices(m, 0, k.worldVerticesLength, x, W, Q), f && S))
                                                for (f.strokeColor = B, q = 0, t = w.length; q < t; q += 3) {
                                                    h = w[q] * Q + W;
                                                    var z = w[q + 1] * Q + W,
                                                        C = w[q + 2] * Q + W;
                                                    f.moveTo(x[h], x[h + 1]);
                                                    f.lineTo(x[z], x[z + 1]);
                                                    f.lineTo(x[C], x[C + 1]);
                                                    f.close();
                                                    f.stroke()
                                                }
                                            if (0 != fa && 0 != ca) {
                                                y.set(w, ha);
                                                y = k.uvs;
                                                q = W;
                                                t = W + fa;
                                                for (h = 0; q < t; q += Q, h +=
                                                    2) x[q + 2] = y[h], x[q + 3] = y[h + 1];
                                                x = k.color;
                                                y = m.color;
                                                this.fillVertices(c, x, y, g, m);
                                                x = ka._vData;
                                                y = ka._iData;
                                                if (0 < ca) {
                                                    k = ha;
                                                    for (q = ha + ca; k < q; k++) y[k] += aa;
                                                    if (a)
                                                        for (k = a.m, ja = k[0], la = k[4], ta = k[12], N = k[1], T = k[5], pa = k[13], k = W, q = W + fa; k < q; k += Q) r = x[k], Aa = x[k + 1], x[k] = r * ja + Aa * la + ta, x[k + 1] = r * N + Aa * T + pa;
                                                    ka.adjust(fa / Q, ca)
                                                }
                                            }
                                        }
                                    g.clipEndWithSlot(m)
                                }
                            } else g.clipEndWithSlot(m);
                    else g.clipEndWithSlot(m)
                }
                g.clipEnd();
                if (f && P)
                    for (f.strokeColor = v, f.fillColor = u, c = 0, g = b.bones.length; c < g; c++) a = b.bones[c], w = a.data.length * a.a + a.worldX,
                        m = a.data.length * a.c + a.worldY, f.moveTo(a.worldX, a.worldY), f.lineTo(w, m), f.stroke(), f.circle(a.worldX, a.worldY, 1.5 * Math.PI), f.fill(), 0 === c && (f.fillColor = A)
            };
            h.cacheTraverse = function(a) {
                var c = sa._curFrame;
                if (c) {
                    var d = c.segments;
                    if (0 != d.length) {
                        var f, g = c.vertices,
                            h = c.indices,
                            k = 0,
                            l = 0;
                        a && (a = a.m, ja = a[0], N = a[1], la = a[4], T = a[5], ta = a[12], pa = a[13]);
                        var m = 1 === ja && 0 === N && 0 === la && 1 === T;
                        m = (a = t & 16) && m;
                        var n = 0;
                        c = c.colors;
                        var p = c[n++];
                        var q = p.vfOffset;
                        b(p);
                        for (var u = 0, w = d.length; u < w; u++)
                            if (p = d[u], f = e(p.tex, p.blendMode)) {
                                if (ma ||
                                    f.getHash() !== ua.material.getHash()) ma = !1, ua._flush(), ua.node = Ea, ua.material = f;
                                ba = p.vertexCount;
                                ca = p.indexCount;
                                f = ka.request(ba, ca);
                                ha = f.indiceOffset;
                                aa = f.vertexOffset;
                                ia = f.byteOffset >> 2;
                                var v = ka._vData;
                                var x = ka._iData;
                                f = ka._uintVData;
                                for (var y = ha, z = ha + ca; y < z; y++) x[y] = aa + h[l++];
                                p = p.vfCount;
                                v.set(g.subarray(k, k + p), ia);
                                k += p;
                                if (m)
                                    for (x = ia, y = ia + p; x < y; x += 6) v[x] += ta, v[x + 1] += pa;
                                else if (a)
                                    for (x = ia, y = ia + p; x < y; x += 6) r = v[x], Aa = v[x + 1], v[x] = r * ja + Aa * la + ta, v[x + 1] = r * N + Aa * T + pa;
                                ka.adjust(ba, ca);
                                if (Xa)
                                    for (v = k - p, x = ia +
                                        4, y = ia + 4 + p; x < y; x += 6, v += 6) v >= q && (p = c[n++], b(p), q = p.vfOffset), f[x] = V, f[x + 1] = Z
                            }
                    }
                }
            };
            h.fillBuffers = function(a, b) {
                var c = a.node;
                c._renderFlag |= l.FLAG_UPDATE_RENDER_DATA;
                a._skeleton && (c = c._color, M = c.r / 255, O = c.g / 255, L = c.b / 255, U = c.a / 255, da = (I = a.useTint || a.isAnimationCached()) ? n : g, Q = I ? 6 : 5, Ea = a.node, ka = b.getBuffer("spine", da), ua = b, sa = a, ma = !0, C = a.premultipliedAlpha, G = 1, t = 0, Xa = !1, ya = a._effectDelegate && a._effectDelegate._vertexEffect, (4294967295 !== c._val || C) && (Xa = !0), I && (t |= 1), c = void 0, sa.enableBatch && (c = Ea._worldMatrix,
                    ma = !1, t |= 16), a.isAnimationCached() ? this.cacheTraverse(c) : (ya && ya.begin(a._skeleton), this.realTimeTraverse(c), ya && ya.end()), b.worldMatDirty++, a.attachUtil._syncAttachedNode(), sa = ua = ka = Ea = void 0, ya = null)
            };
            h.postFillBuffers = function(a, b) {
                b.worldMatDirty--
            };
            return c
        }(c["default"]);
        m["default"] = h;
        c["default"].register(a, h);
        q.exports = m["default"]
    }, {
        "../../cocos2d/core/renderer/assembler": 233,
        "../../cocos2d/core/renderer/render-flow": 237,
        "../../cocos2d/core/renderer/webgl/vertex-format": 275,
        "./Skeleton": 365,
        "./lib/spine": 367
    }],
    372: [function(h, q, m) {
        var f = function() {
            this.dispose = this.interrupt = this.event = this.complete = this.end = this.start = null
        };
        f.getListeners = function(e) {
            e.listener || (e.listener = new f);
            return e.listener
        };
        q.exports = f
    }, {}],
    373: [function(h, q, m) {
        var f = h("./lib/spine");
        sp.VertexEffectDelegate = cc.Class({
            name: "sp.VertexEffectDelegate",
            ctor: function() {
                this._interpolation = this._vertexEffect = null;
                this._effectType = "none"
            },
            clear: function() {
                this._interpolation = this._vertexEffect = null;
                this._effectType =
                    "none"
            },
            initJitter: function(e, b) {
                this._effectType = "jitter";
                return this._vertexEffect = new f.JitterEffect(e, b)
            },
            initSwirlWithPow: function(e, b) {
                this._interpolation = new f.Pow(b);
                return this._vertexEffect = new f.SwirlEffect(e, this._interpolation)
            },
            initSwirlWithPowOut: function(e, b) {
                this._interpolation = new f.PowOut(b);
                return this._vertexEffect = new f.SwirlEffect(e, this._interpolation)
            },
            getJitterVertexEffect: function() {
                return this._vertexEffect
            },
            getSwirlVertexEffect: function() {
                return this._vertexEffect
            },
            getVertexEffect: function() {
                return this._vertexEffect
            },
            getEffectType: function() {
                return this._effectType
            }
        });
        q.exports = sp.VertexEffectDelegate
    }, {
        "./lib/spine": 367
    }],
    374: [function(h, q, m) {
        (function(f, e) {
            "object" === typeof m && "undefined" !== typeof q ? e(m) : "function" === typeof define && define.amd ? define(["exports"], e) : e(f.box2d = {})
        })(void 0, function(f) {
            function e(a, b) {
                return void 0 !== a ? a : b
            }

            function b(a, b) {
                for (var c = [], d = 0; d < a; ++d) c.push(b(d));
                return c
            }

            function h(a, b) {
                void 0 === b && (b = 0);
                for (var c = [], d = 0; d < a; ++d) c.push(b);
                return c
            }

            function c(a, b, c) {
                return a < b ? b : a >
                    c ? c : a
            }

            function a(a) {
                return a * a
            }

            function d(a) {
                return 1 / Math.sqrt(a)
            }

            function l(a, b, c) {
                ++f.b2_gjkCalls;
                var d = c.proxyA,
                    e = c.proxyB,
                    g = c.transformA,
                    h = c.transformB,
                    k = Xa;
                k.ReadCache(b, d, g, e, h);
                for (var l = k.m_vertices, D = ya, J = zc, m, n = 0; 20 > n;) {
                    m = k.m_count;
                    for (var Y = 0; Y < m; ++Y) D[Y] = l[Y].indexA, J[Y] = l[Y].indexB;
                    switch (k.m_count) {
                        case 2:
                            k.Solve2();
                            break;
                        case 3:
                            k.Solve3()
                    }
                    if (3 === k.m_count) break;
                    Y = k.GetSearchDirection(Bc);
                    if (Y.LengthSquared() < U) break;
                    var p = l[k.m_count];
                    p.indexA = d.GetSupport(N.MulTRV(g.q, r.NegV(Y, r.s_t0),
                        Dc));
                    T.MulXV(g, d.GetVertex(p.indexA), p.wA);
                    p.indexB = e.GetSupport(N.MulTRV(h.q, Y, Ec));
                    T.MulXV(h, e.GetVertex(p.indexB), p.wB);
                    r.SubVV(p.wB, p.wA, p.w);
                    ++n;
                    ++f.b2_gjkIters;
                    var q = !1;
                    for (Y = 0; Y < m; ++Y)
                        if (p.indexA === D[Y] && p.indexB === J[Y]) {
                            q = !0;
                            break
                        }
                    if (q) break;
                    ++k.m_count
                }
                f.b2_gjkMaxIters = aa(f.b2_gjkMaxIters, n);
                k.GetWitnessPoints(a.pointA, a.pointB);
                a.distance = r.DistanceVV(a.pointA, a.pointB);
                a.iterations = n;
                k.WriteCache(b);
                c.useRadii && (b = d.m_radius, e = e.m_radius, a.distance > b + e && 1E-5 < a.distance ? (a.distance -= b + e,
                    c = r.SubVV(a.pointB, a.pointA, Cc), c.Normalize(), a.pointA.SelfMulAdd(b, c), a.pointB.SelfMulSub(e, c)) : (e = r.MidVV(a.pointA, a.pointB, Ac), a.pointA.Copy(e), a.pointB.Copy(e), a.distance = 0))
            }

            function g(a, b) {
                var c = b.lowerBound.y - a.upperBound.y,
                    d = a.lowerBound.y - b.upperBound.y;
                return 0 < b.lowerBound.x - a.upperBound.x || 0 < c || 0 < a.lowerBound.x - b.upperBound.x || 0 < d ? !1 : !0
            }

            function m(a, b, c, d, e) {
                var g = 0,
                    h = b[0];
                b = b[1];
                var k = r.DotVV(c, h.v) - d;
                c = r.DotVV(c, b.v) - d;
                0 >= k && a[g++].Copy(h);
                0 >= c && a[g++].Copy(b);
                0 > k * c && (c = k / (k - c), d = a[g].v,
                    d.x = h.v.x + c * (b.v.x - h.v.x), d.y = h.v.y + c * (b.v.y - h.v.y), a = a[g].id, a.cf.indexA = e, a.cf.indexB = h.id.cf.indexB, a.cf.typeA = f.b2ContactFeatureType.e_vertex, a.cf.typeB = f.b2ContactFeatureType.e_face, ++g);
                return g
            }

            function q(a, b, c, d, e, f) {
                var g = Kc.Reset();
                g.proxyA.SetShape(a, b);
                g.proxyB.SetShape(c, d);
                g.transformA.Copy(e);
                g.transformB.Copy(f);
                g.useRadii = !0;
                a = Lc.Reset();
                a.count = 0;
                b = Mc.Reset();
                l(b, a, g);
                return 1E-4 > b.distance
            }

            function t(a) {
                if (null === a) throw Error();
                return a
            }

            function p(a, b) {
                return a.proxyA.m_id === b.proxyA.m_id ?
                    a.proxyB.m_id - b.proxyB.m_id : a.proxyA.m_id - b.proxyA.m_id
            }

            function u(a, b) {
                var c = Nc.Reset();
                ++f.b2_toiCalls;
                a.state = f.b2TOIOutputState.e_unknown;
                a.t = b.tMax;
                var d = b.proxyA,
                    e = b.proxyB,
                    g = Oc.Copy(b.sweepA),
                    h = Pc.Copy(b.sweepB);
                g.Normalize();
                h.Normalize();
                var k = b.tMax,
                    D = aa(.008, d.m_radius + e.m_radius - .024),
                    m = 0,
                    n = 0,
                    Y = Qc;
                Y.count = 0;
                var r = Rc;
                r.proxyA.Copy(b.proxyA);
                r.proxyB.Copy(b.proxyB);
                for (r.useRadii = !1;;) {
                    b = ab;
                    var p = bb;
                    g.GetTransform(b, m);
                    h.GetTransform(p, m);
                    r.transformA.Copy(b);
                    r.transformB.Copy(p);
                    b = Sc;
                    l(b,
                        Y, r);
                    if (0 >= b.distance) {
                        a.state = f.b2TOIOutputState.e_overlapped;
                        a.t = 0;
                        break
                    }
                    if (b.distance < D + .002) {
                        a.state = f.b2TOIOutputState.e_touching;
                        a.t = m;
                        break
                    }
                    b = Tc;
                    b.Initialize(Y, d, g, e, h, m);
                    p = !1;
                    for (var q = k, t = 0;;) {
                        var u = Uc,
                            v = Vc,
                            w = b.FindMinSeparation(u, v, q);
                        if (w > D + .002) {
                            a.state = f.b2TOIOutputState.e_separated;
                            a.t = k;
                            p = !0;
                            break
                        }
                        if (w > D - .002) {
                            m = q;
                            break
                        }
                        var x = b.Evaluate(u[0], v[0], m);
                        if (x < D - .002) {
                            a.state = f.b2TOIOutputState.e_failed;
                            a.t = m;
                            p = !0;
                            break
                        }
                        if (x <= D + .002) {
                            a.state = f.b2TOIOutputState.e_touching;
                            a.t = m;
                            p = !0;
                            break
                        }
                        for (var y =
                                0, z = m, A = q;;) {
                            var B = 1 & y ? z + (D - x) * (A - z) / (w - x) : .5 * (z + A);
                            ++y;
                            ++f.b2_toiRootIters;
                            var C = b.Evaluate(u[0], v[0], B);
                            if (.002 > ba(C - D)) {
                                q = B;
                                break
                            }
                            C > D ? (z = B, x = C) : (A = B, w = C);
                            if (50 === y) break
                        }
                        f.b2_toiMaxRootIters = aa(f.b2_toiMaxRootIters, y);
                        ++t;
                        if (8 === t) break
                    }++n;
                    ++f.b2_toiIters;
                    if (p) break;
                    if (20 === n) {
                        a.state = f.b2TOIOutputState.e_failed;
                        a.t = m;
                        break
                    }
                }
                f.b2_toiMaxIters = aa(f.b2_toiMaxIters, n);
                a = c.GetMilliseconds();
                f.b2_toiMaxTime = aa(f.b2_toiMaxTime, a);
                f.b2_toiTime += a
            }

            function v(a, b, c, d, e) {
                a.pointCount = 0;
                c = T.MulXV(c, b.m_p,
                    Wc);
                e = T.MulXV(e, d.m_p, Xc);
                e = r.DistanceSquaredVV(c, e);
                c = b.m_radius + d.m_radius;
                e > c * c || (a.type = f.b2ManifoldType.e_circles, a.localPoint.Copy(b.m_p), a.localNormal.SetZero(), a.pointCount = 1, a.points[0].localPoint.Copy(d.m_p), a.points[0].id.key = 0)
            }

            function A(a, b, c, d, e) {
                a.pointCount = 0;
                e = T.MulXV(e, d.m_p, Yc);
                c = T.MulTXV(c, e, Zc);
                var g = 0,
                    h = -1E37;
                e = b.m_radius + d.m_radius;
                var k = b.m_count,
                    l = b.m_vertices;
                b = b.m_normals;
                for (var D = 0; D < k; ++D) {
                    var J = r.DotVV(b[D], r.SubVV(c, l[D], r.s_t0));
                    if (J > e) return;
                    J > h && (h = J, g = D)
                }
                D = g;
                J =
                    l[D];
                k = l[(D + 1) % k];
                if (1E-5 > h) a.pointCount = 1, a.type = f.b2ManifoldType.e_faceA, a.localNormal.Copy(b[g]), r.MidVV(J, k, a.localPoint);
                else if (g = r.DotVV(r.SubVV(c, J, r.s_t0), r.SubVV(k, J, r.s_t1)), h = r.DotVV(r.SubVV(c, k, r.s_t0), r.SubVV(J, k, r.s_t1)), 0 >= g) {
                    if (r.DistanceSquaredVV(c, J) > e * e) return;
                    a.pointCount = 1;
                    a.type = f.b2ManifoldType.e_faceA;
                    r.SubVV(c, J, a.localNormal).SelfNormalize();
                    a.localPoint.Copy(J)
                } else if (0 >= h) {
                    if (r.DistanceSquaredVV(c, k) > e * e) return;
                    a.pointCount = 1;
                    a.type = f.b2ManifoldType.e_faceA;
                    r.SubVV(c,
                        k, a.localNormal).SelfNormalize();
                    a.localPoint.Copy(k)
                } else {
                    g = r.MidVV(J, k, $c);
                    if (r.DotVV(r.SubVV(c, g, r.s_t1), b[D]) > e) return;
                    a.pointCount = 1;
                    a.type = f.b2ManifoldType.e_faceA;
                    a.localNormal.Copy(b[D]).SelfNormalize();
                    a.localPoint.Copy(g)
                }
                a.points[0].localPoint.Copy(d.m_p);
                a.points[0].id.key = 0
            }

            function B(a, b, c, d, e) {
                var f = a.m_vertices,
                    g = d.m_count;
                d = d.m_vertices;
                a = N.MulRV(b.q, a.m_normals[c], ad);
                for (var h = N.MulTRV(e.q, a, bd), k = 0, l = 1E37, D = 0; D < g; ++D) {
                    var J = r.DotVV(d[D], h);
                    J < l && (l = J, k = D)
                }
                b = T.MulXV(b, f[c], cd);
                e =
                    T.MulXV(e, d[k], dd);
                return r.DotVV(r.SubVV(e, b, r.s_t0), a)
            }

            function E(a, b, c, d, e) {
                var f = b.m_count,
                    g = b.m_normals,
                    h = r.SubVV(T.MulXV(e, d.m_centroid, r.s_t0), T.MulXV(c, b.m_centroid, r.s_t1), ed),
                    k = N.MulTRV(c.q, h, fd);
                h = 0;
                for (var l = -1E37, D = 0; D < f; ++D) {
                    var J = r.DotVV(g[D], k);
                    J > l && (l = J, h = D)
                }
                g = B(b, c, h, d, e);
                J = (h + f - 1) % f;
                l = B(b, c, J, d, e);
                var qa = (h + 1) % f;
                D = B(b, c, qa, d, e);
                if (l > g && l > D) k = -1;
                else {
                    if (!(D > g)) return a[0] = h, g;
                    k = 1;
                    J = qa;
                    l = D
                }
                for (;;) {
                    h = -1 === k ? (J + f - 1) % f : (J + 1) % f;
                    g = B(b, c, h, d, e);
                    if (!(g > l)) break;
                    J = h;
                    l = g
                }
                a[0] = J;
                return l
            }

            function y(a,
                b, c, d, e) {
                a.pointCount = 0;
                var g = b.m_radius + d.m_radius,
                    h = gd;
                h[0] = 0;
                var k = E(h, b, c, d, e);
                if (!(k > g)) {
                    var l = hd;
                    l[0] = 0;
                    var D = E(l, d, e, b, c);
                    if (!(D > g)) {
                        if (D > .98 * k + .001) {
                            k = d;
                            var J = b;
                            b = e;
                            e = l[0];
                            a.type = f.b2ManifoldType.e_faceB;
                            h = 1
                        } else k = b, J = d, b = c, c = e, e = h[0], a.type = f.b2ManifoldType.e_faceA, h = 0;
                        l = id;
                        d = e;
                        D = c;
                        var qa = J.m_count,
                            n = J.m_vertices;
                        J = J.m_normals;
                        for (var Y = N.MulTRV(D.q, N.MulRV(b.q, k.m_normals[d], r.s_t0), jd), p = 0, q = 1E37, Ra = 0; Ra < qa; ++Ra) {
                            var t = r.DotVV(Y, J[Ra]);
                            t < q && (q = t, p = Ra)
                        }
                        J = p;
                        qa = (J + 1) % qa;
                        Y = l[0];
                        T.MulXV(D,
                            n[J], Y.v);
                        Y = Y.id.cf;
                        Y.indexA = d;
                        Y.indexB = J;
                        Y.typeA = f.b2ContactFeatureType.e_face;
                        Y.typeB = f.b2ContactFeatureType.e_vertex;
                        J = l[1];
                        T.MulXV(D, n[qa], J.v);
                        D = J.id.cf;
                        D.indexA = d;
                        D.indexB = qa;
                        D.typeA = f.b2ContactFeatureType.e_face;
                        D.typeB = f.b2ContactFeatureType.e_vertex;
                        D = k.m_vertices;
                        d = e;
                        e = (e + 1) % k.m_count;
                        J = D[d];
                        Y = D[e];
                        k = r.SubVV(Y, J, kd);
                        k.Normalize();
                        D = r.CrossVOne(k, ld);
                        n = r.MidVV(J, Y, md);
                        qa = N.MulRV(b.q, k, nd);
                        k = r.CrossVOne(qa, od);
                        J = T.MulXV(b, J, pd);
                        p = T.MulXV(b, Y, qd);
                        b = r.DotVV(k, J);
                        Y = -r.DotVV(qa, J) + g;
                        p = r.DotVV(qa,
                            p) + g;
                        q = rd;
                        J = sd;
                        Ra = r.NegV(qa, td);
                        l = m(q, l, Ra, Y, d);
                        if (!(2 > l || (l = m(J, q, qa, p, e), 2 > l))) {
                            a.localNormal.Copy(D);
                            a.localPoint.Copy(n);
                            for (e = l = 0; 2 > e; ++e) D = J[e], r.DotVV(k, D.v) - b <= g && (d = a.points[l], T.MulTXV(c, D.v, d.localPoint), d.id.Copy(D.id), h && (D = d.id.cf, d.id.cf.indexA = D.indexB, d.id.cf.indexB = D.indexA, d.id.cf.typeA = D.typeB, d.id.cf.typeB = D.typeA), ++l);
                            a.pointCount = l
                        }
                    }
                }
            }

            function z(a, b, c, d, e) {
                a.pointCount = 0;
                c = T.MulTXV(c, T.MulXV(e, d.m_p, r.s_t0), ud);
                var g = b.m_vertex1,
                    h = b.m_vertex2,
                    k = r.SubVV(h, g, vd),
                    l = r.DotVV(k,
                        r.SubVV(h, c, r.s_t0)),
                    D = r.DotVV(k, r.SubVV(c, g, r.s_t0)),
                    J = b.m_radius + d.m_radius;
                e = wd;
                e.cf.indexB = 0;
                e.cf.typeB = f.b2ContactFeatureType.e_vertex;
                if (0 >= D) {
                    if (h = r.SubVV(c, g, fb), !(r.DotVV(h, h) > J * J)) {
                        if (b.m_hasVertex0 && (J = r.SubVV(g, b.m_vertex0, xd), 0 < r.DotVV(J, r.SubVV(g, c, r.s_t0)))) return;
                        e.cf.indexA = 0;
                        e.cf.typeA = f.b2ContactFeatureType.e_vertex;
                        a.pointCount = 1;
                        a.type = f.b2ManifoldType.e_circles;
                        a.localNormal.SetZero();
                        a.localPoint.Copy(g);
                        a.points[0].id.Copy(e);
                        a.points[0].localPoint.Copy(d.m_p)
                    }
                } else if (0 >=
                    l) {
                    if (g = r.SubVV(c, h, fb), !(r.DotVV(g, g) > J * J)) {
                        if (b.m_hasVertex3 && (g = r.SubVV(b.m_vertex3, h, yd), 0 < r.DotVV(g, r.SubVV(c, h, r.s_t0)))) return;
                        e.cf.indexA = 1;
                        e.cf.typeA = f.b2ContactFeatureType.e_vertex;
                        a.pointCount = 1;
                        a.type = f.b2ManifoldType.e_circles;
                        a.localNormal.SetZero();
                        a.localPoint.Copy(h);
                        a.points[0].id.Copy(e);
                        a.points[0].localPoint.Copy(d.m_p)
                    }
                } else {
                    b = r.DotVV(k, k);
                    var qa = zd;
                    qa.x = 1 / b * (l * g.x + D * h.x);
                    qa.y = 1 / b * (l * g.y + D * h.y);
                    b = r.SubVV(c, qa, fb);
                    r.DotVV(b, b) > J * J || (J = Ad.Set(-k.y, k.x), 0 > r.DotVV(J, r.SubVV(c, g,
                        r.s_t0)) && J.Set(-J.x, -J.y), J.Normalize(), e.cf.indexA = 0, e.cf.typeA = f.b2ContactFeatureType.e_face, a.pointCount = 1, a.type = f.b2ManifoldType.e_faceA, a.localNormal.Copy(J), a.localPoint.Copy(g), a.points[0].id.Copy(e), a.points[0].localPoint.Copy(d.m_p))
                }
            }

            function x(a, b, c, d, e) {
                Bd.Collide(a, b, c, d, e)
            }

            function C(a, b) {
                function c() {
                    this.constructor = a
                }
                Cd(a, b);
                a.prototype = null === b ? Object.create(b) : (c.prototype = b.prototype, new c)
            }

            function G(a, b) {
                return a > b ? a : b
            }

            function F(a, b, d) {
                return c(Math.ceil(Math.sqrt(a / (.01 *
                    b)) * d), 1, 8)
            }

            function H(a, b, c) {
                var d = a[b];
                a[b] = a[c];
                a[c] = d
            }

            function I(a, b) {
                return a < b
            }

            function K(a, b, c, d) {
                void 0 === b && (b = 0);
                void 0 === c && (c = a.length - b);
                void 0 === d && (d = I);
                for (var e = [], f = 0;;) {
                    for (; b + 1 < c; c++) {
                        var g = a[b + Math.floor(Math.random() * (c - b))];
                        e[f++] = c;
                        for (var h = b - 1;;) {
                            for (; d(a[++h], g););
                            for (; d(g, a[--c]););
                            if (h >= c) break;
                            H(a, h, c)
                        }
                    }
                    if (0 === f) break;
                    b = c;
                    c = e[--f]
                }
                return a
            }

            function P(a, b, c, d) {
                void 0 === b && (b = 0);
                void 0 === c && (c = a.length - b);
                void 0 === d && (d = I);
                return K(a, b, c, d)
            }

            function S(a, b, c) {
                void 0 === c &&
                    (c = a.length);
                for (var d = 0, e = 0; e < c; ++e) b(a[e]) || (e === d ? ++d : H(a, d++, e));
                return d
            }

            function M(a, b, c, d, e) {
                void 0 === e && (e = I);
                for (c -= b; 0 < c;) {
                    var f = Math.floor(c / 2),
                        g = b + f;
                    e(a[g], d) ? (b = ++g, c -= f + 1) : c = f
                }
                return b
            }

            function O(a, b, c, d, e) {
                void 0 === e && (e = I);
                for (c -= b; 0 < c;) {
                    var f = Math.floor(c / 2),
                        g = b + f;
                    e(d, a[g]) ? c = f : (b = ++g, c -= f + 1)
                }
                return b
            }

            function L(a, b, c, d) {
                for (var e = c; b !== e;) H(a, b++, e++), e === d ? e = c : b === c && (c = e)
            }
            var U = 1E-5 * 1E-5,
                V = 2 / 180 * 3.14159265359,
                Z = 8 / 180 * 3.14159265359,
                da = 2 / 180 * 3.14159265359,
                Q = function() {
                    function a(a,
                        b, c) {
                        void 0 === a && (a = 0);
                        void 0 === b && (b = 0);
                        void 0 === c && (c = 0);
                        this.revision = this.minor = this.major = 0;
                        this.major = a;
                        this.minor = b;
                        this.revision = c
                    }
                    a.prototype.toString = function() {
                        return this.major + "." + this.minor + "." + this.revision
                    };
                    return a
                }(),
                R = new Q(2, 3, 2),
                fa = 3.14159265359 / 180,
                ba = Math.abs,
                W = Math.min,
                aa = Math.max,
                ca = isFinite,
                ha = Math.sqrt,
                ia = Math.pow,
                Ba = Math.cos,
                ea = Math.sin,
                X = Math.acos,
                na = Math.asin,
                ma = Math.atan2,
                r = function() {
                    function a(a, b) {
                        void 0 === a && (a = 0);
                        void 0 === b && (b = 0);
                        this.x = a;
                        this.y = b
                    }
                    a.prototype.Clone =
                        function() {
                            return new a(this.x, this.y)
                        };
                    a.prototype.SetZero = function() {
                        this.y = this.x = 0;
                        return this
                    };
                    a.prototype.Set = function(a, b) {
                        this.x = a;
                        this.y = b;
                        return this
                    };
                    a.prototype.Copy = function(a) {
                        this.x = a.x;
                        this.y = a.y;
                        return this
                    };
                    a.prototype.SelfAdd = function(a) {
                        this.x += a.x;
                        this.y += a.y;
                        return this
                    };
                    a.prototype.SelfAddXY = function(a, b) {
                        this.x += a;
                        this.y += b;
                        return this
                    };
                    a.prototype.SelfSub = function(a) {
                        this.x -= a.x;
                        this.y -= a.y;
                        return this
                    };
                    a.prototype.SelfSubXY = function(a, b) {
                        this.x -= a;
                        this.y -= b;
                        return this
                    };
                    a.prototype.SelfMul = function(a) {
                        this.x *= a;
                        this.y *= a;
                        return this
                    };
                    a.prototype.SelfMulAdd = function(a, b) {
                        this.x += a * b.x;
                        this.y += a * b.y;
                        return this
                    };
                    a.prototype.SelfMulSub = function(a, b) {
                        this.x -= a * b.x;
                        this.y -= a * b.y;
                        return this
                    };
                    a.prototype.Dot = function(a) {
                        return this.x * a.x + this.y * a.y
                    };
                    a.prototype.Cross = function(a) {
                        return this.x * a.y - this.y * a.x
                    };
                    a.prototype.Length = function() {
                        var a = this.x,
                            b = this.y;
                        return Math.sqrt(a * a + b * b)
                    };
                    a.prototype.LengthSquared = function() {
                        var a = this.x,
                            b = this.y;
                        return a * a + b * b
                    };
                    a.prototype.Normalize =
                        function() {
                            var a = this.Length();
                            if (1E-5 <= a) {
                                var b = 1 / a;
                                this.x *= b;
                                this.y *= b
                            }
                            return a
                        };
                    a.prototype.SelfNormalize = function() {
                        var a = this.Length();
                        1E-5 <= a && (a = 1 / a, this.x *= a, this.y *= a);
                        return this
                    };
                    a.prototype.SelfRotate = function(a) {
                        var b = Math.cos(a);
                        a = Math.sin(a);
                        var c = this.x;
                        this.x = b * c - a * this.y;
                        this.y = a * c + b * this.y;
                        return this
                    };
                    a.prototype.IsValid = function() {
                        return isFinite(this.x) && isFinite(this.y)
                    };
                    a.prototype.SelfCrossVS = function(a) {
                        var b = this.x;
                        this.x = a * this.y;
                        this.y = -a * b;
                        return this
                    };
                    a.prototype.SelfCrossSV =
                        function(a) {
                            var b = this.x;
                            this.x = -a * this.y;
                            this.y = a * b;
                            return this
                        };
                    a.prototype.SelfMinV = function(a) {
                        this.x = W(this.x, a.x);
                        this.y = W(this.y, a.y);
                        return this
                    };
                    a.prototype.SelfMaxV = function(a) {
                        this.x = aa(this.x, a.x);
                        this.y = aa(this.y, a.y);
                        return this
                    };
                    a.prototype.SelfAbs = function() {
                        this.x = ba(this.x);
                        this.y = ba(this.y);
                        return this
                    };
                    a.prototype.SelfNeg = function() {
                        this.x = -this.x;
                        this.y = -this.y;
                        return this
                    };
                    a.prototype.SelfSkew = function() {
                        var a = this.x;
                        this.x = -this.y;
                        this.y = a;
                        return this
                    };
                    a.MakeArray = function(c) {
                        return b(c,
                            function(b) {
                                return new a
                            })
                    };
                    a.AbsV = function(a, b) {
                        b.x = ba(a.x);
                        b.y = ba(a.y);
                        return b
                    };
                    a.MinV = function(a, b, c) {
                        c.x = W(a.x, b.x);
                        c.y = W(a.y, b.y);
                        return c
                    };
                    a.MaxV = function(a, b, c) {
                        c.x = aa(a.x, b.x);
                        c.y = aa(a.y, b.y);
                        return c
                    };
                    a.ClampV = function(a, b, d, e) {
                        e.x = c(a.x, b.x, d.x);
                        e.y = c(a.y, b.y, d.y);
                        return e
                    };
                    a.RotateV = function(a, b, c) {
                        var d = a.x;
                        a = a.y;
                        var e = Math.cos(b);
                        b = Math.sin(b);
                        c.x = e * d - b * a;
                        c.y = b * d + e * a;
                        return c
                    };
                    a.DotVV = function(a, b) {
                        return a.x * b.x + a.y * b.y
                    };
                    a.CrossVV = function(a, b) {
                        return a.x * b.y - a.y * b.x
                    };
                    a.CrossVS = function(a,
                        b, c) {
                        var d = a.x;
                        c.x = b * a.y;
                        c.y = -b * d;
                        return c
                    };
                    a.CrossVOne = function(a, b) {
                        var c = a.x;
                        b.x = a.y;
                        b.y = -c;
                        return b
                    };
                    a.CrossSV = function(a, b, c) {
                        var d = b.x;
                        c.x = -a * b.y;
                        c.y = a * d;
                        return c
                    };
                    a.CrossOneV = function(a, b) {
                        var c = a.x;
                        b.x = -a.y;
                        b.y = c;
                        return b
                    };
                    a.AddVV = function(a, b, c) {
                        c.x = a.x + b.x;
                        c.y = a.y + b.y;
                        return c
                    };
                    a.SubVV = function(a, b, c) {
                        c.x = a.x - b.x;
                        c.y = a.y - b.y;
                        return c
                    };
                    a.MulSV = function(a, b, c) {
                        c.x = b.x * a;
                        c.y = b.y * a;
                        return c
                    };
                    a.MulVS = function(a, b, c) {
                        c.x = a.x * b;
                        c.y = a.y * b;
                        return c
                    };
                    a.AddVMulSV = function(a, b, c, d) {
                        d.x = a.x + b * c.x;
                        d.y =
                            a.y + b * c.y;
                        return d
                    };
                    a.SubVMulSV = function(a, b, c, d) {
                        d.x = a.x - b * c.x;
                        d.y = a.y - b * c.y;
                        return d
                    };
                    a.AddVCrossSV = function(a, b, c, d) {
                        var e = c.x;
                        d.x = a.x - b * c.y;
                        d.y = a.y + b * e;
                        return d
                    };
                    a.MidVV = function(a, b, c) {
                        c.x = .5 * (a.x + b.x);
                        c.y = .5 * (a.y + b.y);
                        return c
                    };
                    a.ExtVV = function(a, b, c) {
                        c.x = .5 * (b.x - a.x);
                        c.y = .5 * (b.y - a.y);
                        return c
                    };
                    a.IsEqualToV = function(a, b) {
                        return a.x === b.x && a.y === b.y
                    };
                    a.DistanceVV = function(a, b) {
                        var c = a.x - b.x;
                        a = a.y - b.y;
                        return Math.sqrt(c * c + a * a)
                    };
                    a.DistanceSquaredVV = function(a, b) {
                        var c = a.x - b.x;
                        a = a.y - b.y;
                        return c *
                            c + a * a
                    };
                    a.NegV = function(a, b) {
                        b.x = -a.x;
                        b.y = -a.y;
                        return b
                    };
                    a.ZERO = new a(0, 0);
                    a.UNITX = new a(1, 0);
                    a.UNITY = new a(0, 1);
                    a.s_t0 = new a;
                    a.s_t1 = new a;
                    a.s_t2 = new a;
                    a.s_t3 = new a;
                    return a
                }(),
                Aa = new r(0, 0),
                ja = function() {
                    function a(a, b, c) {
                        void 0 === a && (a = 0);
                        void 0 === b && (b = 0);
                        void 0 === c && (c = 0);
                        this.x = a;
                        this.y = b;
                        this.z = c
                    }
                    a.prototype.Clone = function() {
                        return new a(this.x, this.y, this.z)
                    };
                    a.prototype.SetZero = function() {
                        this.z = this.y = this.x = 0;
                        return this
                    };
                    a.prototype.SetXYZ = function(a, b, c) {
                        this.x = a;
                        this.y = b;
                        this.z = c;
                        return this
                    };
                    a.prototype.Copy = function(a) {
                        this.x = a.x;
                        this.y = a.y;
                        this.z = a.z;
                        return this
                    };
                    a.prototype.SelfNeg = function() {
                        this.x = -this.x;
                        this.y = -this.y;
                        this.z = -this.z;
                        return this
                    };
                    a.prototype.SelfAdd = function(a) {
                        this.x += a.x;
                        this.y += a.y;
                        this.z += a.z;
                        return this
                    };
                    a.prototype.SelfAddXYZ = function(a, b, c) {
                        this.x += a;
                        this.y += b;
                        this.z += c;
                        return this
                    };
                    a.prototype.SelfSub = function(a) {
                        this.x -= a.x;
                        this.y -= a.y;
                        this.z -= a.z;
                        return this
                    };
                    a.prototype.SelfSubXYZ = function(a, b, c) {
                        this.x -= a;
                        this.y -= b;
                        this.z -= c;
                        return this
                    };
                    a.prototype.SelfMul =
                        function(a) {
                            this.x *= a;
                            this.y *= a;
                            this.z *= a;
                            return this
                        };
                    a.DotV3V3 = function(a, b) {
                        return a.x * b.x + a.y * b.y + a.z * b.z
                    };
                    a.CrossV3V3 = function(a, b, c) {
                        var d = a.x,
                            e = a.y;
                        a = a.z;
                        var f = b.x,
                            g = b.y;
                        b = b.z;
                        c.x = e * b - a * g;
                        c.y = a * f - d * b;
                        c.z = d * g - e * f;
                        return c
                    };
                    a.ZERO = new a(0, 0, 0);
                    a.s_t0 = new a;
                    return a
                }(),
                la = function() {
                    function a() {
                        this.ex = new r(1, 0);
                        this.ey = new r(0, 1)
                    }
                    a.prototype.Clone = function() {
                        return (new a).Copy(this)
                    };
                    a.FromVV = function(b, c) {
                        return (new a).SetVV(b, c)
                    };
                    a.FromSSSS = function(b, c, d, e) {
                        return (new a).SetSSSS(b, c, d, e)
                    };
                    a.FromAngle = function(b) {
                        return (new a).SetAngle(b)
                    };
                    a.prototype.SetSSSS = function(a, b, c, d) {
                        this.ex.Set(a, c);
                        this.ey.Set(b, d);
                        return this
                    };
                    a.prototype.SetVV = function(a, b) {
                        this.ex.Copy(a);
                        this.ey.Copy(b);
                        return this
                    };
                    a.prototype.SetAngle = function(a) {
                        var b = Math.cos(a);
                        a = Math.sin(a);
                        this.ex.Set(b, a);
                        this.ey.Set(-a, b);
                        return this
                    };
                    a.prototype.Copy = function(a) {
                        this.ex.Copy(a.ex);
                        this.ey.Copy(a.ey);
                        return this
                    };
                    a.prototype.SetIdentity = function() {
                        this.ex.Set(1, 0);
                        this.ey.Set(0, 1);
                        return this
                    };
                    a.prototype.SetZero =
                        function() {
                            this.ex.SetZero();
                            this.ey.SetZero();
                            return this
                        };
                    a.prototype.GetAngle = function() {
                        return Math.atan2(this.ex.y, this.ex.x)
                    };
                    a.prototype.GetInverse = function(a) {
                        var b = this.ex.x,
                            c = this.ey.x,
                            d = this.ex.y,
                            e = this.ey.y,
                            f = b * e - c * d;
                        0 !== f && (f = 1 / f);
                        a.ex.x = f * e;
                        a.ey.x = -f * c;
                        a.ex.y = -f * d;
                        a.ey.y = f * b;
                        return a
                    };
                    a.prototype.Solve = function(a, b, c) {
                        var d = this.ex.x,
                            e = this.ey.x,
                            f = this.ex.y,
                            g = this.ey.y,
                            h = d * g - e * f;
                        0 !== h && (h = 1 / h);
                        c.x = h * (g * a - e * b);
                        c.y = h * (d * b - f * a);
                        return c
                    };
                    a.prototype.SelfAbs = function() {
                        this.ex.SelfAbs();
                        this.ey.SelfAbs();
                        return this
                    };
                    a.prototype.SelfInv = function() {
                        this.GetInverse(this);
                        return this
                    };
                    a.prototype.SelfAddM = function(a) {
                        this.ex.SelfAdd(a.ex);
                        this.ey.SelfAdd(a.ey);
                        return this
                    };
                    a.prototype.SelfSubM = function(a) {
                        this.ex.SelfSub(a.ex);
                        this.ey.SelfSub(a.ey);
                        return this
                    };
                    a.AbsM = function(a, b) {
                        var c = a.ex;
                        a = a.ey;
                        b.ex.x = ba(c.x);
                        b.ex.y = ba(c.y);
                        b.ey.x = ba(a.x);
                        b.ey.y = ba(a.y);
                        return b
                    };
                    a.MulMV = function(a, b, c) {
                        var d = a.ex;
                        a = a.ey;
                        var e = b.x;
                        b = b.y;
                        c.x = d.x * e + a.x * b;
                        c.y = d.y * e + a.y * b;
                        return c
                    };
                    a.MulTMV = function(a,
                        b, c) {
                        var d = a.ex;
                        a = a.ey;
                        var e = b.x;
                        b = b.y;
                        c.x = d.x * e + d.y * b;
                        c.y = a.x * e + a.y * b;
                        return c
                    };
                    a.AddMM = function(a, b, c) {
                        var d = a.ex;
                        a = a.ey;
                        var e = b.ex;
                        b = b.ey;
                        c.ex.x = d.x + e.x;
                        c.ex.y = d.y + e.y;
                        c.ey.x = a.x + b.x;
                        c.ey.y = a.y + b.y;
                        return c
                    };
                    a.MulMM = function(a, b, c) {
                        var d = a.ex.x,
                            e = a.ex.y,
                            f = a.ey.x;
                        a = a.ey.y;
                        var g = b.ex.x,
                            h = b.ex.y,
                            k = b.ey.x;
                        b = b.ey.y;
                        c.ex.x = d * g + f * h;
                        c.ex.y = e * g + a * h;
                        c.ey.x = d * k + f * b;
                        c.ey.y = e * k + a * b;
                        return c
                    };
                    a.MulTMM = function(a, b, c) {
                        var d = a.ex.x,
                            e = a.ex.y,
                            f = a.ey.x;
                        a = a.ey.y;
                        var g = b.ex.x,
                            h = b.ex.y,
                            k = b.ey.x;
                        b = b.ey.y;
                        c.ex.x = d * g +
                            e * h;
                        c.ex.y = f * g + a * h;
                        c.ey.x = d * k + e * b;
                        c.ey.y = f * k + a * b;
                        return c
                    };
                    a.IDENTITY = new a;
                    return a
                }(),
                ta = function() {
                    function a() {
                        this.ex = new ja(1, 0, 0);
                        this.ey = new ja(0, 1, 0);
                        this.ez = new ja(0, 0, 1)
                    }
                    a.prototype.Clone = function() {
                        return (new a).Copy(this)
                    };
                    a.prototype.SetVVV = function(a, b, c) {
                        this.ex.Copy(a);
                        this.ey.Copy(b);
                        this.ez.Copy(c);
                        return this
                    };
                    a.prototype.Copy = function(a) {
                        this.ex.Copy(a.ex);
                        this.ey.Copy(a.ey);
                        this.ez.Copy(a.ez);
                        return this
                    };
                    a.prototype.SetIdentity = function() {
                        this.ex.SetXYZ(1, 0, 0);
                        this.ey.SetXYZ(0,
                            1, 0);
                        this.ez.SetXYZ(0, 0, 1);
                        return this
                    };
                    a.prototype.SetZero = function() {
                        this.ex.SetZero();
                        this.ey.SetZero();
                        this.ez.SetZero();
                        return this
                    };
                    a.prototype.SelfAddM = function(a) {
                        this.ex.SelfAdd(a.ex);
                        this.ey.SelfAdd(a.ey);
                        this.ez.SelfAdd(a.ez);
                        return this
                    };
                    a.prototype.Solve33 = function(a, b, c, d) {
                        var e = this.ex.x,
                            f = this.ex.y,
                            g = this.ex.z,
                            h = this.ey.x,
                            k = this.ey.y,
                            l = this.ey.z,
                            D = this.ez.x,
                            J = this.ez.y,
                            m = this.ez.z,
                            n = e * (k * m - l * J) + f * (l * D - h * m) + g * (h * J - k * D);
                        0 !== n && (n = 1 / n);
                        d.x = n * (a * (k * m - l * J) + b * (l * D - h * m) + c * (h * J - k * D));
                        d.y =
                            n * (e * (b * m - c * J) + f * (c * D - a * m) + g * (a * J - b * D));
                        d.z = n * (e * (k * c - l * b) + f * (l * a - h * c) + g * (h * b - k * a));
                        return d
                    };
                    a.prototype.Solve22 = function(a, b, c) {
                        var d = this.ex.x,
                            e = this.ey.x,
                            f = this.ex.y,
                            g = this.ey.y,
                            h = d * g - e * f;
                        0 !== h && (h = 1 / h);
                        c.x = h * (g * a - e * b);
                        c.y = h * (d * b - f * a);
                        return c
                    };
                    a.prototype.GetInverse22 = function(a) {
                        var b = this.ex.x,
                            c = this.ey.x,
                            d = this.ex.y,
                            e = this.ey.y,
                            f = b * e - c * d;
                        0 !== f && (f = 1 / f);
                        a.ex.x = f * e;
                        a.ey.x = -f * c;
                        a.ex.z = 0;
                        a.ex.y = -f * d;
                        a.ey.y = f * b;
                        a.ey.z = 0;
                        a.ez.x = 0;
                        a.ez.y = 0;
                        a.ez.z = 0
                    };
                    a.prototype.GetSymInverse33 = function(a) {
                        var b =
                            ja.DotV3V3(this.ex, ja.CrossV3V3(this.ey, this.ez, ja.s_t0));
                        0 !== b && (b = 1 / b);
                        var c = this.ex.x,
                            d = this.ey.x,
                            e = this.ez.x,
                            f = this.ey.y,
                            g = this.ez.y,
                            h = this.ez.z;
                        a.ex.x = b * (f * h - g * g);
                        a.ex.y = b * (e * g - d * h);
                        a.ex.z = b * (d * g - e * f);
                        a.ey.x = a.ex.y;
                        a.ey.y = b * (c * h - e * e);
                        a.ey.z = b * (e * d - c * g);
                        a.ez.x = a.ex.z;
                        a.ez.y = a.ey.z;
                        a.ez.z = b * (c * f - d * d)
                    };
                    a.MulM33V3 = function(a, b, c) {
                        var d = b.x,
                            e = b.y;
                        b = b.z;
                        c.x = a.ex.x * d + a.ey.x * e + a.ez.x * b;
                        c.y = a.ex.y * d + a.ey.y * e + a.ez.y * b;
                        c.z = a.ex.z * d + a.ey.z * e + a.ez.z * b;
                        return c
                    };
                    a.MulM33XYZ = function(a, b, c, d, e) {
                        e.x = a.ex.x *
                            b + a.ey.x * c + a.ez.x * d;
                        e.y = a.ex.y * b + a.ey.y * c + a.ez.y * d;
                        e.z = a.ex.z * b + a.ey.z * c + a.ez.z * d;
                        return e
                    };
                    a.MulM33V2 = function(a, b, c) {
                        var d = b.x;
                        b = b.y;
                        c.x = a.ex.x * d + a.ey.x * b;
                        c.y = a.ex.y * d + a.ey.y * b;
                        return c
                    };
                    a.MulM33XY = function(a, b, c, d) {
                        d.x = a.ex.x * b + a.ey.x * c;
                        d.y = a.ex.y * b + a.ey.y * c;
                        return d
                    };
                    a.IDENTITY = new a;
                    return a
                }(),
                N = function() {
                    function a(a) {
                        void 0 === a && (a = 0);
                        this.s = 0;
                        this.c = 1;
                        a && (this.s = Math.sin(a), this.c = Math.cos(a))
                    }
                    a.prototype.Clone = function() {
                        return (new a).Copy(this)
                    };
                    a.prototype.Copy = function(a) {
                        this.s = a.s;
                        this.c = a.c;
                        return this
                    };
                    a.prototype.SetAngle = function(a) {
                        this.s = Math.sin(a);
                        this.c = Math.cos(a);
                        return this
                    };
                    a.prototype.SetIdentity = function() {
                        this.s = 0;
                        this.c = 1;
                        return this
                    };
                    a.prototype.GetAngle = function() {
                        return Math.atan2(this.s, this.c)
                    };
                    a.prototype.GetXAxis = function(a) {
                        a.x = this.c;
                        a.y = this.s;
                        return a
                    };
                    a.prototype.GetYAxis = function(a) {
                        a.x = -this.s;
                        a.y = this.c;
                        return a
                    };
                    a.MulRR = function(a, b, c) {
                        var d = a.c;
                        a = a.s;
                        var e = b.c;
                        b = b.s;
                        c.s = a * e + d * b;
                        c.c = d * e - a * b;
                        return c
                    };
                    a.MulTRR = function(a, b, c) {
                        var d = a.c;
                        a = a.s;
                        var e = b.c;
                        b = b.s;
                        c.s = d * b - a * e;
                        c.c = d * e + a * b;
                        return c
                    };
                    a.MulRV = function(a, b, c) {
                        var d = a.c;
                        a = a.s;
                        var e = b.x;
                        b = b.y;
                        c.x = d * e - a * b;
                        c.y = a * e + d * b;
                        return c
                    };
                    a.MulTRV = function(a, b, c) {
                        var d = a.c;
                        a = a.s;
                        var e = b.x;
                        b = b.y;
                        c.x = d * e + a * b;
                        c.y = -a * e + d * b;
                        return c
                    };
                    a.IDENTITY = new a;
                    return a
                }(),
                T = function() {
                    function a() {
                        this.p = new r;
                        this.q = new N
                    }
                    a.prototype.Clone = function() {
                        return (new a).Copy(this)
                    };
                    a.prototype.Copy = function(a) {
                        this.p.Copy(a.p);
                        this.q.Copy(a.q);
                        return this
                    };
                    a.prototype.SetIdentity = function() {
                        this.p.SetZero();
                        this.q.SetIdentity();
                        return this
                    };
                    a.prototype.SetPositionRotation = function(a, b) {
                        this.p.Copy(a);
                        this.q.Copy(b);
                        return this
                    };
                    a.prototype.SetPositionAngle = function(a, b) {
                        this.p.Copy(a);
                        this.q.SetAngle(b);
                        return this
                    };
                    a.prototype.SetPosition = function(a) {
                        this.p.Copy(a);
                        return this
                    };
                    a.prototype.SetPositionXY = function(a, b) {
                        this.p.Set(a, b);
                        return this
                    };
                    a.prototype.SetRotation = function(a) {
                        this.q.Copy(a);
                        return this
                    };
                    a.prototype.SetRotationAngle = function(a) {
                        this.q.SetAngle(a);
                        return this
                    };
                    a.prototype.GetPosition = function() {
                        return this.p
                    };
                    a.prototype.GetRotation = function() {
                        return this.q
                    };
                    a.prototype.GetRotationAngle = function() {
                        return this.q.GetAngle()
                    };
                    a.prototype.GetAngle = function() {
                        return this.q.GetAngle()
                    };
                    a.MulXV = function(a, b, c) {
                        var d = a.q.c,
                            e = a.q.s,
                            f = b.x;
                        b = b.y;
                        c.x = d * f - e * b + a.p.x;
                        c.y = e * f + d * b + a.p.y;
                        return c
                    };
                    a.MulTXV = function(a, b, c) {
                        var d = a.q.c,
                            e = a.q.s,
                            f = b.x - a.p.x;
                        a = b.y - a.p.y;
                        c.x = d * f + e * a;
                        c.y = -e * f + d * a;
                        return c
                    };
                    a.MulXX = function(a, b, c) {
                        N.MulRR(a.q, b.q, c.q);
                        r.AddVV(N.MulRV(a.q, b.p, c.p), a.p, c.p);
                        return c
                    };
                    a.MulTXX = function(a, b, c) {
                        N.MulTRR(a.q,
                            b.q, c.q);
                        N.MulTRV(a.q, r.SubVV(b.p, a.p, c.p), c.p);
                        return c
                    };
                    a.IDENTITY = new a;
                    return a
                }(),
                pa = function() {
                    function a() {
                        this.localCenter = new r;
                        this.c0 = new r;
                        this.c = new r;
                        this.alpha0 = this.a = this.a0 = 0
                    }
                    a.prototype.Clone = function() {
                        return (new a).Copy(this)
                    };
                    a.prototype.Copy = function(a) {
                        this.localCenter.Copy(a.localCenter);
                        this.c0.Copy(a.c0);
                        this.c.Copy(a.c);
                        this.a0 = a.a0;
                        this.a = a.a;
                        this.alpha0 = a.alpha0;
                        return this
                    };
                    a.prototype.GetTransform = function(a, b) {
                        var c = 1 - b;
                        a.p.x = c * this.c0.x + b * this.c.x;
                        a.p.y = c * this.c0.y +
                            b * this.c.y;
                        a.q.SetAngle(c * this.a0 + b * this.a);
                        a.p.SelfSub(N.MulRV(a.q, this.localCenter, r.s_t0));
                        return a
                    };
                    a.prototype.Advance = function(a) {
                        var b = (a - this.alpha0) / (1 - this.alpha0),
                            c = 1 - b;
                        this.c0.x = c * this.c0.x + b * this.c.x;
                        this.c0.y = c * this.c0.y + b * this.c.y;
                        this.a0 = c * this.a0 + b * this.a;
                        this.alpha0 = a
                    };
                    a.prototype.Normalize = function() {
                        var a = 6.28318530718 * Math.floor(this.a0 / 6.28318530718);
                        this.a0 -= a;
                        this.a -= a
                    };
                    return a
                }(),
                oa = function() {
                    function a(a, b, c, d) {
                        void 0 === a && (a = .5);
                        void 0 === b && (b = .5);
                        void 0 === c && (c = .5);
                        void 0 ===
                            d && (d = 1);
                        this.r = a;
                        this.g = b;
                        this.b = c;
                        this.a = d
                    }
                    a.prototype.Clone = function() {
                        return (new a).Copy(this)
                    };
                    a.prototype.Copy = function(a) {
                        this.r = a.r;
                        this.g = a.g;
                        this.b = a.b;
                        this.a = a.a;
                        return this
                    };
                    a.prototype.IsEqual = function(a) {
                        return this.r === a.r && this.g === a.g && this.b === a.b && this.a === a.a
                    };
                    a.prototype.IsZero = function() {
                        return 0 === this.r && 0 === this.g && 0 === this.b && 0 === this.a
                    };
                    a.prototype.Set = function(a, b, c, d) {
                        void 0 === d && (d = this.a);
                        this.SetRGBA(a, b, c, d)
                    };
                    a.prototype.SetByteRGB = function(a, b, c) {
                        this.r = a / 255;
                        this.g =
                            b / 255;
                        this.b = c / 255;
                        return this
                    };
                    a.prototype.SetByteRGBA = function(a, b, c, d) {
                        this.r = a / 255;
                        this.g = b / 255;
                        this.b = c / 255;
                        this.a = d / 255;
                        return this
                    };
                    a.prototype.SetRGB = function(a, b, c) {
                        this.r = a;
                        this.g = b;
                        this.b = c;
                        return this
                    };
                    a.prototype.SetRGBA = function(a, b, c, d) {
                        this.r = a;
                        this.g = b;
                        this.b = c;
                        this.a = d;
                        return this
                    };
                    a.prototype.SelfAdd = function(a) {
                        this.r += a.r;
                        this.g += a.g;
                        this.b += a.b;
                        this.a += a.a;
                        return this
                    };
                    a.prototype.Add = function(a, b) {
                        b.r = this.r + a.r;
                        b.g = this.g + a.g;
                        b.b = this.b + a.b;
                        b.a = this.a + a.a;
                        return b
                    };
                    a.prototype.SelfSub =
                        function(a) {
                            this.r -= a.r;
                            this.g -= a.g;
                            this.b -= a.b;
                            this.a -= a.a;
                            return this
                        };
                    a.prototype.Sub = function(a, b) {
                        b.r = this.r - a.r;
                        b.g = this.g - a.g;
                        b.b = this.b - a.b;
                        b.a = this.a - a.a;
                        return b
                    };
                    a.prototype.SelfMul = function(a) {
                        this.r *= a;
                        this.g *= a;
                        this.b *= a;
                        this.a *= a;
                        return this
                    };
                    a.prototype.Mul = function(a, b) {
                        b.r = this.r * a;
                        b.g = this.g * a;
                        b.b = this.b * a;
                        b.a = this.a * a;
                        return b
                    };
                    a.prototype.Mix = function(b, c) {
                        a.MixColors(this, b, c)
                    };
                    a.MixColors = function(a, b, c) {
                        var d = c * (b.r - a.r),
                            e = c * (b.g - a.g),
                            f = c * (b.b - a.b);
                        c *= b.a - a.a;
                        a.r += d;
                        a.g += e;
                        a.b += f;
                        a.a += c;
                        b.r -= d;
                        b.g -= e;
                        b.b -= f;
                        b.a -= c
                    };
                    a.prototype.MakeStyleString = function(b) {
                        void 0 === b && (b = this.a);
                        return a.MakeStyleString(this.r, this.g, this.b, b)
                    };
                    a.MakeStyleString = function(a, b, c, d) {
                        void 0 === d && (d = 1);
                        a *= 255;
                        b *= 255;
                        c *= 255;
                        return 1 > d ? "rgba(" + a + "," + b + "," + c + "," + d + ")" : "rgb(" + a + "," + b + "," + c + ")"
                    };
                    a.ZERO = new a(0, 0, 0, 0);
                    a.RED = new a(1, 0, 0);
                    a.GREEN = new a(0, 1, 0);
                    a.BLUE = new a(0, 0, 1);
                    return a
                }();
            (function(a) {
                a[a.e_none = 0] = "e_none";
                a[a.e_shapeBit = 1] = "e_shapeBit";
                a[a.e_jointBit = 2] = "e_jointBit";
                a[a.e_aabbBit =
                    4] = "e_aabbBit";
                a[a.e_pairBit = 8] = "e_pairBit";
                a[a.e_centerOfMassBit = 16] = "e_centerOfMassBit";
                a[a.e_particleBit = 32] = "e_particleBit";
                a[a.e_controllerBit = 64] = "e_controllerBit";
                a[a.e_all = 63] = "e_all"
            })(f.b2DrawFlags || (f.b2DrawFlags = {}));
            var Ia = function() {
                    function a() {
                        this.m_drawFlags = 0
                    }
                    a.prototype.SetFlags = function(a) {
                        this.m_drawFlags = a
                    };
                    a.prototype.GetFlags = function() {
                        return this.m_drawFlags
                    };
                    a.prototype.AppendFlags = function(a) {
                        this.m_drawFlags |= a
                    };
                    a.prototype.ClearFlags = function(a) {
                        this.m_drawFlags &= ~a
                    };
                    return a
                }(),
                xa = function() {
                    function a() {
                        this.m_start = Date.now()
                    }
                    a.prototype.Reset = function() {
                        this.m_start = Date.now();
                        return this
                    };
                    a.prototype.GetMilliseconds = function() {
                        return Date.now() - this.m_start
                    };
                    return a
                }(),
                Qa = function() {
                    function a() {
                        this.m_max_count = this.m_min_count = this.m_count = 0
                    }
                    a.prototype.GetCount = function() {
                        return this.m_count
                    };
                    a.prototype.GetMinCount = function() {
                        return this.m_min_count
                    };
                    a.prototype.GetMaxCount = function() {
                        return this.m_max_count
                    };
                    a.prototype.ResetCount = function() {
                        var a =
                            this.m_count;
                        this.m_count = 0;
                        return a
                    };
                    a.prototype.ResetMinCount = function() {
                        this.m_min_count = 0
                    };
                    a.prototype.ResetMaxCount = function() {
                        this.m_max_count = 0
                    };
                    a.prototype.Increment = function() {
                        this.m_count++;
                        this.m_max_count < this.m_count && (this.m_max_count = this.m_count)
                    };
                    a.prototype.Decrement = function() {
                        this.m_count--;
                        this.m_min_count > this.m_count && (this.m_min_count = this.m_count)
                    };
                    return a
                }(),
                Da = function() {
                    function a(a) {
                        this.m_stack = [];
                        this.m_count = 0;
                        this.m_stack = b(a, function(a) {
                            return null
                        });
                        this.m_count =
                            0
                    }
                    a.prototype.Reset = function() {
                        this.m_count = 0;
                        return this
                    };
                    a.prototype.Push = function(a) {
                        this.m_stack[this.m_count] = a;
                        this.m_count++
                    };
                    a.prototype.Pop = function() {
                        this.m_count--;
                        var a = this.m_stack[this.m_count];
                        this.m_stack[this.m_count] = null;
                        if (null === a) throw Error();
                        return a
                    };
                    a.prototype.GetCount = function() {
                        return this.m_count
                    };
                    return a
                }(),
                Ya = function() {
                    return function() {}
                }(),
                Wa = function() {
                    return function() {}
                }(),
                Ca = function() {
                    function a() {
                        this.m_vertices = this.m_buffer = r.MakeArray(2);
                        this.m_radius =
                            this.m_count = 0
                    }
                    a.prototype.Copy = function(a) {
                        a.m_vertices === a.m_buffer ? (this.m_vertices = this.m_buffer, this.m_buffer[0].Copy(a.m_buffer[0]), this.m_buffer[1].Copy(a.m_buffer[1])) : this.m_vertices = a.m_vertices;
                        this.m_count = a.m_count;
                        this.m_radius = a.m_radius;
                        return this
                    };
                    a.prototype.Reset = function() {
                        this.m_vertices = this.m_buffer;
                        this.m_radius = this.m_count = 0;
                        return this
                    };
                    a.prototype.SetShape = function(a, b) {
                        a.SetupDistanceProxy(this, b)
                    };
                    a.prototype.SetVerticesRadius = function(a, b, c) {
                        this.m_vertices = a;
                        this.m_count =
                            b;
                        this.m_radius = c
                    };
                    a.prototype.GetSupport = function(a) {
                        for (var b = 0, c = r.DotVV(this.m_vertices[0], a), d = 1; d < this.m_count; ++d) {
                            var e = r.DotVV(this.m_vertices[d], a);
                            e > c && (b = d, c = e)
                        }
                        return b
                    };
                    a.prototype.GetSupportVertex = function(a) {
                        for (var b = 0, c = r.DotVV(this.m_vertices[0], a), d = 1; d < this.m_count; ++d) {
                            var e = r.DotVV(this.m_vertices[d], a);
                            e > c && (b = d, c = e)
                        }
                        return this.m_vertices[b]
                    };
                    a.prototype.GetVertexCount = function() {
                        return this.m_count
                    };
                    a.prototype.GetVertex = function(a) {
                        return this.m_vertices[a]
                    };
                    return a
                }(),
                Na = function() {
                    function a() {
                        this.count = this.metric = 0;
                        this.indexA = [0, 0, 0];
                        this.indexB = [0, 0, 0]
                    }
                    a.prototype.Reset = function() {
                        this.count = this.metric = 0;
                        return this
                    };
                    return a
                }(),
                Oa = function() {
                    function a() {
                        this.proxyA = new Ca;
                        this.proxyB = new Ca;
                        this.transformA = new T;
                        this.transformB = new T;
                        this.useRadii = !1
                    }
                    a.prototype.Reset = function() {
                        this.proxyA.Reset();
                        this.proxyB.Reset();
                        this.transformA.SetIdentity();
                        this.transformB.SetIdentity();
                        this.useRadii = !1;
                        return this
                    };
                    return a
                }(),
                Pa = function() {
                    function a() {
                        this.pointA =
                            new r;
                        this.pointB = new r;
                        this.iterations = this.distance = 0
                    }
                    a.prototype.Reset = function() {
                        this.pointA.SetZero();
                        this.pointB.SetZero();
                        this.iterations = this.distance = 0;
                        return this
                    };
                    return a
                }(),
                sa = function() {
                    return function() {
                        this.proxyA = new Ca;
                        this.proxyB = new Ca;
                        this.transformA = new T;
                        this.transformB = new T;
                        this.translationB = new r
                    }
                }(),
                ka = function() {
                    return function() {
                        this.point = new r;
                        this.normal = new r;
                        this.iterations = this.lambda = 0
                    }
                }();
            f.b2_gjkCalls = 0;
            f.b2_gjkIters = 0;
            f.b2_gjkMaxIters = 0;
            var ua = function() {
                    function a() {
                        this.wA =
                            new r;
                        this.wB = new r;
                        this.w = new r;
                        this.indexB = this.indexA = this.a = 0
                    }
                    a.prototype.Copy = function(a) {
                        this.wA.Copy(a.wA);
                        this.wB.Copy(a.wB);
                        this.w.Copy(a.w);
                        this.a = a.a;
                        this.indexA = a.indexA;
                        this.indexB = a.indexB;
                        return this
                    };
                    return a
                }(),
                Ea = function() {
                    function a() {
                        this.m_v1 = new ua;
                        this.m_v2 = new ua;
                        this.m_v3 = new ua;
                        this.m_vertices = [];
                        this.m_count = 0;
                        this.m_vertices[0] = this.m_v1;
                        this.m_vertices[1] = this.m_v2;
                        this.m_vertices[2] = this.m_v3
                    }
                    a.prototype.ReadCache = function(a, b, c, d, e) {
                        this.m_count = a.count;
                        for (var f = this.m_vertices,
                                g = 0; g < this.m_count; ++g) {
                            var h = f[g];
                            h.indexA = a.indexA[g];
                            h.indexB = a.indexB[g];
                            var k = b.GetVertex(h.indexA);
                            var l = d.GetVertex(h.indexB);
                            T.MulXV(c, k, h.wA);
                            T.MulXV(e, l, h.wB);
                            r.SubVV(h.wB, h.wA, h.w);
                            h.a = 0
                        }
                        1 < this.m_count && (a = a.metric, l = this.GetMetric(), (l < .5 * a || 2 * a < l || 1E-5 > l) && (this.m_count = 0));
                        0 === this.m_count && (h = f[0], h.indexA = 0, h.indexB = 0, k = b.GetVertex(0), l = d.GetVertex(0), T.MulXV(c, k, h.wA), T.MulXV(e, l, h.wB), r.SubVV(h.wB, h.wA, h.w), this.m_count = h.a = 1)
                    };
                    a.prototype.WriteCache = function(a) {
                        a.metric = this.GetMetric();
                        a.count = this.m_count;
                        for (var b = this.m_vertices, c = 0; c < this.m_count; ++c) a.indexA[c] = b[c].indexA, a.indexB[c] = b[c].indexB
                    };
                    a.prototype.GetSearchDirection = function(a) {
                        switch (this.m_count) {
                            case 1:
                                return r.NegV(this.m_v1.w, a);
                            case 2:
                                var b = r.SubVV(this.m_v2.w, this.m_v1.w, a);
                                return 0 < r.CrossVV(b, r.NegV(this.m_v1.w, r.s_t0)) ? r.CrossOneV(b, a) : r.CrossVOne(b, a);
                            default:
                                return a.SetZero()
                        }
                    };
                    a.prototype.GetClosestPoint = function(a) {
                        switch (this.m_count) {
                            case 0:
                                return a.SetZero();
                            case 1:
                                return a.Copy(this.m_v1.w);
                            case 2:
                                return a.Set(this.m_v1.a *
                                    this.m_v1.w.x + this.m_v2.a * this.m_v2.w.x, this.m_v1.a * this.m_v1.w.y + this.m_v2.a * this.m_v2.w.y);
                            default:
                                return a.SetZero()
                        }
                    };
                    a.prototype.GetWitnessPoints = function(a, b) {
                        switch (this.m_count) {
                            case 1:
                                a.Copy(this.m_v1.wA);
                                b.Copy(this.m_v1.wB);
                                break;
                            case 2:
                                a.x = this.m_v1.a * this.m_v1.wA.x + this.m_v2.a * this.m_v2.wA.x;
                                a.y = this.m_v1.a * this.m_v1.wA.y + this.m_v2.a * this.m_v2.wA.y;
                                b.x = this.m_v1.a * this.m_v1.wB.x + this.m_v2.a * this.m_v2.wB.x;
                                b.y = this.m_v1.a * this.m_v1.wB.y + this.m_v2.a * this.m_v2.wB.y;
                                break;
                            case 3:
                                b.x = a.x =
                                    this.m_v1.a * this.m_v1.wA.x + this.m_v2.a * this.m_v2.wA.x + this.m_v3.a * this.m_v3.wA.x, b.y = a.y = this.m_v1.a * this.m_v1.wA.y + this.m_v2.a * this.m_v2.wA.y + this.m_v3.a * this.m_v3.wA.y
                        }
                    };
                    a.prototype.GetMetric = function() {
                        switch (this.m_count) {
                            case 0:
                            case 1:
                                return 0;
                            case 2:
                                return r.DistanceVV(this.m_v1.w, this.m_v2.w);
                            case 3:
                                return r.CrossVV(r.SubVV(this.m_v2.w, this.m_v1.w, r.s_t0), r.SubVV(this.m_v3.w, this.m_v1.w, r.s_t1));
                            default:
                                return 0
                        }
                    };
                    a.prototype.Solve2 = function() {
                        var b = this.m_v1.w,
                            c = this.m_v2.w,
                            d = r.SubVV(c, b,
                                a.s_e12);
                        b = -r.DotVV(b, d);
                        0 >= b ? this.m_count = this.m_v1.a = 1 : (c = r.DotVV(c, d), 0 >= c ? (this.m_count = this.m_v2.a = 1, this.m_v1.Copy(this.m_v2)) : (d = 1 / (c + b), this.m_v1.a = c * d, this.m_v2.a = b * d, this.m_count = 2))
                    };
                    a.prototype.Solve3 = function() {
                        var b = this.m_v1.w,
                            c = this.m_v2.w,
                            d = this.m_v3.w,
                            e = r.SubVV(c, b, a.s_e12),
                            f = r.DotVV(b, e),
                            g = r.DotVV(c, e);
                        f = -f;
                        var h = r.SubVV(d, b, a.s_e13),
                            k = r.DotVV(b, h),
                            l = r.DotVV(d, h);
                        k = -k;
                        var m = r.SubVV(d, c, a.s_e23),
                            n = r.DotVV(c, m);
                        m = r.DotVV(d, m);
                        n = -n;
                        h = r.CrossVV(e, h);
                        e = h * r.CrossVV(c, d);
                        d = h * r.CrossVV(d,
                            b);
                        b = h * r.CrossVV(b, c);
                        0 >= f && 0 >= k ? this.m_count = this.m_v1.a = 1 : 0 < g && 0 < f && 0 >= b ? (l = 1 / (g + f), this.m_v1.a = g * l, this.m_v2.a = f * l, this.m_count = 2) : 0 < l && 0 < k && 0 >= d ? (g = 1 / (l + k), this.m_v1.a = l * g, this.m_v3.a = k * g, this.m_count = 2, this.m_v2.Copy(this.m_v3)) : 0 >= g && 0 >= n ? (this.m_count = this.m_v2.a = 1, this.m_v1.Copy(this.m_v2)) : 0 >= l && 0 >= m ? (this.m_count = this.m_v3.a = 1, this.m_v1.Copy(this.m_v3)) : 0 < m && 0 < n && 0 >= e ? (g = 1 / (m + n), this.m_v2.a = m * g, this.m_v3.a = n * g, this.m_count = 2, this.m_v1.Copy(this.m_v3)) : (g = 1 / (e + d + b), this.m_v1.a = e * g, this.m_v2.a =
                            d * g, this.m_v3.a = b * g, this.m_count = 3)
                    };
                    a.s_e12 = new r;
                    a.s_e13 = new r;
                    a.s_e23 = new r;
                    return a
                }(),
                Xa = new Ea,
                ya = [0, 0, 0],
                zc = [0, 0, 0],
                Ac = new r,
                Bc = new r,
                Cc = new r,
                Dc = new r,
                Ec = new r,
                Fc = new r,
                za = new Ea,
                Cb = new r,
                Db = new r,
                Gc = new r,
                Hc = new r,
                Ic = new r,
                Jc = new r;
            (function(a) {
                a[a.e_vertex = 0] = "e_vertex";
                a[a.e_face = 1] = "e_face"
            })(f.b2ContactFeatureType || (f.b2ContactFeatureType = {}));
            var Eb = function() {
                    function a() {
                        this._key = 0;
                        this._key_invalid = !1;
                        this._typeB = this._typeA = this._indexB = this._indexA = 0
                    }
                    Object.defineProperty(a.prototype,
                        "key", {
                            get: function() {
                                this._key_invalid && (this._key_invalid = !1, this._key = this._indexA | this._indexB << 8 | this._typeA << 16 | this._typeB << 24);
                                return this._key
                            },
                            set: function(a) {
                                this._key = a;
                                this._key_invalid = !1;
                                this._indexA = 255 & this._key;
                                this._indexB = this._key >> 8 & 255;
                                this._typeA = this._key >> 16 & 255;
                                this._typeB = this._key >> 24 & 255
                            },
                            enumerable: !0,
                            configurable: !0
                        });
                    Object.defineProperty(a.prototype, "indexA", {
                        get: function() {
                            return this._indexA
                        },
                        set: function(a) {
                            this._indexA = a;
                            this._key_invalid = !0
                        },
                        enumerable: !0,
                        configurable: !0
                    });
                    Object.defineProperty(a.prototype, "indexB", {
                        get: function() {
                            return this._indexB
                        },
                        set: function(a) {
                            this._indexB = a;
                            this._key_invalid = !0
                        },
                        enumerable: !0,
                        configurable: !0
                    });
                    Object.defineProperty(a.prototype, "typeA", {
                        get: function() {
                            return this._typeA
                        },
                        set: function(a) {
                            this._typeA = a;
                            this._key_invalid = !0
                        },
                        enumerable: !0,
                        configurable: !0
                    });
                    Object.defineProperty(a.prototype, "typeB", {
                        get: function() {
                            return this._typeB
                        },
                        set: function(a) {
                            this._typeB = a;
                            this._key_invalid = !0
                        },
                        enumerable: !0,
                        configurable: !0
                    });
                    return a
                }(),
                Za = function() {
                    function a() {
                        this.cf = new Eb
                    }
                    a.prototype.Copy = function(a) {
                        this.key = a.key;
                        return this
                    };
                    a.prototype.Clone = function() {
                        return (new a).Copy(this)
                    };
                    Object.defineProperty(a.prototype, "key", {
                        get: function() {
                            return this.cf.key
                        },
                        set: function(a) {
                            this.cf.key = a
                        },
                        enumerable: !0,
                        configurable: !0
                    });
                    return a
                }(),
                Fb = function() {
                    function a() {
                        this.localPoint = new r;
                        this.tangentImpulse = this.normalImpulse = 0;
                        this.id = new Za
                    }
                    a.MakeArray = function(c) {
                        return b(c, function(b) {
                            return new a
                        })
                    };
                    a.prototype.Reset = function() {
                        this.localPoint.SetZero();
                        this.tangentImpulse = this.normalImpulse = 0;
                        this.id.key = 0
                    };
                    a.prototype.Copy = function(a) {
                        this.localPoint.Copy(a.localPoint);
                        this.normalImpulse = a.normalImpulse;
                        this.tangentImpulse = a.tangentImpulse;
                        this.id.Copy(a.id);
                        return this
                    };
                    return a
                }();
            (function(a) {
                a[a.e_unknown = -1] = "e_unknown";
                a[a.e_circles = 0] = "e_circles";
                a[a.e_faceA = 1] = "e_faceA";
                a[a.e_faceB = 2] = "e_faceB"
            })(f.b2ManifoldType || (f.b2ManifoldType = {}));
            var eb = function() {
                    function a() {
                        this.points = Fb.MakeArray(2);
                        this.localNormal = new r;
                        this.localPoint = new r;
                        this.type = f.b2ManifoldType.e_unknown;
                        this.pointCount = 0
                    }
                    a.prototype.Reset = function() {
                        for (var a = 0; 2 > a; ++a) this.points[a].Reset();
                        this.localNormal.SetZero();
                        this.localPoint.SetZero();
                        this.type = f.b2ManifoldType.e_unknown;
                        this.pointCount = 0
                    };
                    a.prototype.Copy = function(a) {
                        this.pointCount = a.pointCount;
                        for (var b = 0; 2 > b; ++b) this.points[b].Copy(a.points[b]);
                        this.localNormal.Copy(a.localNormal);
                        this.localPoint.Copy(a.localPoint);
                        this.type = a.type;
                        return this
                    };
                    a.prototype.Clone = function() {
                        return (new a).Copy(this)
                    };
                    return a
                }(),
                Gb = function() {
                    function a() {
                        this.normal = new r;
                        this.points = r.MakeArray(2);
                        this.separations = h(2)
                    }
                    a.prototype.Initialize = function(b, c, d, e, g) {
                        if (0 !== b.pointCount) switch (b.type) {
                            case f.b2ManifoldType.e_circles:
                                this.normal.Set(1, 0);
                                c = T.MulXV(c, b.localPoint, a.Initialize_s_pointA);
                                b = T.MulXV(e, b.points[0].localPoint, a.Initialize_s_pointB);
                                r.DistanceSquaredVV(c, b) > U && r.SubVV(b, c, this.normal).SelfNormalize();
                                var h = r.AddVMulSV(c, d, this.normal, a.Initialize_s_cA);
                                var k = r.SubVMulSV(b, g, this.normal, a.Initialize_s_cB);
                                r.MidVV(h, k, this.points[0]);
                                this.separations[0] = r.DotVV(r.SubVV(k, h, r.s_t0), this.normal);
                                break;
                            case f.b2ManifoldType.e_faceA:
                                N.MulRV(c.q, b.localNormal, this.normal);
                                for (var l = T.MulXV(c, b.localPoint, a.Initialize_s_planePoint), D = 0; D < b.pointCount; ++D) {
                                    var J = T.MulXV(e, b.points[D].localPoint, a.Initialize_s_clipPoint);
                                    h = d - r.DotVV(r.SubVV(J, l, r.s_t0), this.normal);
                                    h = r.AddVMulSV(J, h, this.normal, a.Initialize_s_cA);
                                    k = r.SubVMulSV(J, g, this.normal, a.Initialize_s_cB);
                                    r.MidVV(h, k, this.points[D]);
                                    this.separations[D] =
                                        r.DotVV(r.SubVV(k, h, r.s_t0), this.normal)
                                }
                                break;
                            case f.b2ManifoldType.e_faceB:
                                N.MulRV(e.q, b.localNormal, this.normal);
                                l = T.MulXV(e, b.localPoint, a.Initialize_s_planePoint);
                                for (D = 0; D < b.pointCount; ++D) J = T.MulXV(c, b.points[D].localPoint, a.Initialize_s_clipPoint), h = g - r.DotVV(r.SubVV(J, l, r.s_t0), this.normal), k = r.AddVMulSV(J, h, this.normal, a.Initialize_s_cB), h = r.SubVMulSV(J, d, this.normal, a.Initialize_s_cA), r.MidVV(h, k, this.points[D]), this.separations[D] = r.DotVV(r.SubVV(h, k, r.s_t0), this.normal);
                                this.normal.SelfNeg()
                        }
                    };
                    a.Initialize_s_pointA = new r;
                    a.Initialize_s_pointB = new r;
                    a.Initialize_s_cA = new r;
                    a.Initialize_s_cB = new r;
                    a.Initialize_s_planePoint = new r;
                    a.Initialize_s_clipPoint = new r;
                    return a
                }();
            (function(a) {
                a[a.b2_nullState = 0] = "b2_nullState";
                a[a.b2_addState = 1] = "b2_addState";
                a[a.b2_persistState = 2] = "b2_persistState";
                a[a.b2_removeState = 3] = "b2_removeState"
            })(f.b2PointState || (f.b2PointState = {}));
            var Ja = function() {
                    function a() {
                        this.v = new r;
                        this.id = new Za
                    }
                    a.MakeArray = function(c) {
                        return b(c, function(b) {
                            return new a
                        })
                    };
                    a.prototype.Copy = function(a) {
                        this.v.Copy(a.v);
                        this.id.Copy(a.id);
                        return this
                    };
                    return a
                }(),
                $a = function() {
                    function a() {
                        this.p1 = new r;
                        this.p2 = new r;
                        this.maxFraction = 1
                    }
                    a.prototype.Copy = function(a) {
                        this.p1.Copy(a.p1);
                        this.p2.Copy(a.p2);
                        this.maxFraction = a.maxFraction;
                        return this
                    };
                    return a
                }(),
                gb = function() {
                    function a() {
                        this.normal = new r;
                        this.fraction = 0
                    }
                    a.prototype.Copy = function(a) {
                        this.normal.Copy(a.normal);
                        this.fraction = a.fraction;
                        return this
                    };
                    return a
                }(),
                ra = function() {
                    function a() {
                        this.lowerBound = new r;
                        this.upperBound = new r;
                        this.m_cache_center = new r;
                        this.m_cache_extent = new r
                    }
                    a.prototype.Copy = function(a) {
                        this.lowerBound.Copy(a.lowerBound);
                        this.upperBound.Copy(a.upperBound);
                        return this
                    };
                    a.prototype.IsValid = function() {
                        var a = this.upperBound.y - this.lowerBound.y;
                        return 0 <= this.upperBound.x - this.lowerBound.x && 0 <= a && this.lowerBound.IsValid() && this.upperBound.IsValid()
                    };
                    a.prototype.GetCenter = function() {
                        return r.MidVV(this.lowerBound, this.upperBound, this.m_cache_center)
                    };
                    a.prototype.GetExtents = function() {
                        return r.ExtVV(this.lowerBound,
                            this.upperBound, this.m_cache_extent)
                    };
                    a.prototype.GetPerimeter = function() {
                        return 2 * (this.upperBound.x - this.lowerBound.x + (this.upperBound.y - this.lowerBound.y))
                    };
                    a.prototype.Combine1 = function(a) {
                        this.lowerBound.x = W(this.lowerBound.x, a.lowerBound.x);
                        this.lowerBound.y = W(this.lowerBound.y, a.lowerBound.y);
                        this.upperBound.x = aa(this.upperBound.x, a.upperBound.x);
                        this.upperBound.y = aa(this.upperBound.y, a.upperBound.y);
                        return this
                    };
                    a.prototype.Combine2 = function(a, b) {
                        this.lowerBound.x = W(a.lowerBound.x, b.lowerBound.x);
                        this.lowerBound.y = W(a.lowerBound.y, b.lowerBound.y);
                        this.upperBound.x = aa(a.upperBound.x, b.upperBound.x);
                        this.upperBound.y = aa(a.upperBound.y, b.upperBound.y);
                        return this
                    };
                    a.Combine = function(a, b, c) {
                        c.Combine2(a, b);
                        return c
                    };
                    a.prototype.Contains = function(a) {
                        var b;
                        return b = (b = (b = (b = this.lowerBound.x <= a.lowerBound.x) && this.lowerBound.y <= a.lowerBound.y) && a.upperBound.x <= this.upperBound.x) && a.upperBound.y <= this.upperBound.y
                    };
                    a.prototype.RayCast = function(a, b) {
                        var c = -1E37,
                            d = 1E37;
                        var e = b.p1.x;
                        var f = b.p1.y;
                        var g =
                            b.p2.x - b.p1.x;
                        var h = b.p2.y - b.p1.y;
                        var k = ba(g);
                        var l = ba(h),
                            D = a.normal;
                        if (1E-5 > k) {
                            if (e < this.lowerBound.x || this.upperBound.x < e) return !1
                        } else if (k = 1 / g, g = (this.lowerBound.x - e) * k, e = (this.upperBound.x - e) * k, k = -1, g > e && (k = g, g = e, e = k, k = 1), g > c && (D.x = k, D.y = 0, c = g), d = W(d, e), c > d) return !1;
                        if (1E-5 > l) {
                            if (f < this.lowerBound.y || this.upperBound.y < f) return !1
                        } else if (k = 1 / h, g = (this.lowerBound.y - f) * k, e = (this.upperBound.y - f) * k, k = -1, g > e && (k = g, g = e, e = k, k = 1), g > c && (D.x = 0, D.y = k, c = g), d = W(d, e), c > d) return !1;
                        if (0 > c || b.maxFraction < c) return !1;
                        a.fraction = c;
                        return !0
                    };
                    a.prototype.TestContain = function(a) {
                        return a.x < this.lowerBound.x || this.upperBound.x < a.x || a.y < this.lowerBound.y || this.upperBound.y < a.y ? !1 : !0
                    };
                    a.prototype.TestOverlap = function(a) {
                        var b = a.lowerBound.y - this.upperBound.y,
                            c = this.lowerBound.y - a.upperBound.y;
                        return 0 < a.lowerBound.x - this.upperBound.x || 0 < b || 0 < this.lowerBound.x - a.upperBound.x || 0 < c ? !1 : !0
                    };
                    return a
                }(),
                Kc = new Oa,
                Lc = new Na,
                Mc = new Pa,
                Hb = function() {
                    function a(a) {
                        void 0 === a && (a = 0);
                        this.m_id = 0;
                        this.aabb = new ra;
                        this.child2 = this.child1 =
                            this.parent = null;
                        this.height = 0;
                        this.m_id = a
                    }
                    a.prototype.IsLeaf = function() {
                        return null === this.child1
                    };
                    return a
                }(),
                Ib = function() {
                    function a() {
                        this.m_freeList = this.m_root = null;
                        this.m_insertionCount = this.m_path = 0;
                        this.m_stack = new Da(256)
                    }
                    a.prototype.Query = function(a, b) {
                        if (null !== this.m_root) {
                            var c = this.m_stack.Reset();
                            for (c.Push(this.m_root); 0 < c.GetCount();) {
                                var d = c.Pop();
                                if (d.aabb.TestOverlap(a))
                                    if (d.IsLeaf()) {
                                        if (!b(d)) break
                                    } else c.Push(t(d.child1)), c.Push(t(d.child2))
                            }
                        }
                    };
                    a.prototype.QueryPoint = function(a,
                        b) {
                        if (null !== this.m_root) {
                            var c = this.m_stack.Reset();
                            for (c.Push(this.m_root); 0 < c.GetCount();) {
                                var d = c.Pop();
                                if (d.aabb.TestContain(a))
                                    if (d.IsLeaf()) {
                                        if (!b(d)) break
                                    } else c.Push(t(d.child1)), c.Push(t(d.child2))
                            }
                        }
                    };
                    a.prototype.RayCast = function(b, c) {
                        if (null !== this.m_root) {
                            var d = b.p1,
                                e = b.p2,
                                f = r.SubVV(e, d, a.s_r);
                            f.Normalize();
                            f = r.CrossOneV(f, a.s_v);
                            var h = r.AbsV(f, a.s_abs_v),
                                k = b.maxFraction,
                                l = a.s_segmentAABB,
                                D = d.x + k * (e.x - d.x),
                                J = d.y + k * (e.y - d.y);
                            l.lowerBound.x = W(d.x, D);
                            l.lowerBound.y = W(d.y, J);
                            l.upperBound.x =
                                aa(d.x, D);
                            l.upperBound.y = aa(d.y, J);
                            var m = this.m_stack.Reset();
                            for (m.Push(this.m_root); 0 < m.GetCount();)
                                if (D = m.Pop(), g(D.aabb, l)) {
                                    J = D.aabb.GetCenter();
                                    var n = D.aabb.GetExtents();
                                    if (!(0 < ba(r.DotVV(f, r.SubVV(d, J, r.s_t0))) - r.DotVV(h, n)))
                                        if (D.IsLeaf()) {
                                            J = a.s_subInput;
                                            J.p1.Copy(b.p1);
                                            J.p2.Copy(b.p2);
                                            J.maxFraction = k;
                                            D = c(J, D);
                                            if (0 === D) break;
                                            0 < D && (k = D, D = d.x + k * (e.x - d.x), J = d.y + k * (e.y - d.y), l.lowerBound.x = W(d.x, D), l.lowerBound.y = W(d.y, J), l.upperBound.x = aa(d.x, D), l.upperBound.y = aa(d.y, J))
                                        } else m.Push(t(D.child1)),
                                            m.Push(t(D.child2))
                                }
                        }
                    };
                    a.prototype.AllocateNode = function() {
                        if (this.m_freeList) {
                            var b = this.m_freeList;
                            this.m_freeList = b.parent;
                            b.parent = null;
                            b.child1 = null;
                            b.child2 = null;
                            b.height = 0;
                            delete b.userData;
                            return b
                        }
                        return new Hb(a.s_node_id++)
                    };
                    a.prototype.FreeNode = function(a) {
                        a.parent = this.m_freeList;
                        a.child1 = null;
                        a.child2 = null;
                        a.height = -1;
                        delete a.userData;
                        this.m_freeList = a
                    };
                    a.prototype.CreateProxy = function(a, b) {
                        var c = this.AllocateNode();
                        c.aabb.lowerBound.x = a.lowerBound.x - .1;
                        c.aabb.lowerBound.y = a.lowerBound.y -
                            .1;
                        c.aabb.upperBound.x = a.upperBound.x + .1;
                        c.aabb.upperBound.y = a.upperBound.y + .1;
                        c.userData = b;
                        c.height = 0;
                        this.InsertLeaf(c);
                        return c
                    };
                    a.prototype.DestroyProxy = function(a) {
                        this.RemoveLeaf(a);
                        this.FreeNode(a)
                    };
                    a.prototype.MoveProxy = function(a, b, c) {
                        if (a.aabb.Contains(b)) return !1;
                        this.RemoveLeaf(a);
                        var d = .1 + 2 * (0 < c.x ? c.x : -c.x);
                        c = .1 + 2 * (0 < c.y ? c.y : -c.y);
                        a.aabb.lowerBound.x = b.lowerBound.x - d;
                        a.aabb.lowerBound.y = b.lowerBound.y - c;
                        a.aabb.upperBound.x = b.upperBound.x + d;
                        a.aabb.upperBound.y = b.upperBound.y + c;
                        this.InsertLeaf(a);
                        return !0
                    };
                    a.prototype.InsertLeaf = function(b) {
                        ++this.m_insertionCount;
                        if (null === this.m_root) this.m_root = b, this.m_root.parent = null;
                        else {
                            for (var c = b.aabb, d = this.m_root; !d.IsLeaf();) {
                                var e = t(d.child1);
                                var f = t(d.child2);
                                var g = d.aabb.GetPerimeter(),
                                    h = a.s_combinedAABB;
                                h.Combine2(d.aabb, c);
                                var k = h.GetPerimeter();
                                h = 2 * k;
                                k = 2 * (k - g);
                                var l = a.s_aabb;
                                if (e.IsLeaf()) l.Combine2(c, e.aabb), g = l.GetPerimeter() + k;
                                else {
                                    l.Combine2(c, e.aabb);
                                    var D = e.aabb.GetPerimeter();
                                    var m = l.GetPerimeter();
                                    g = m - D + k
                                }
                                f.IsLeaf() ? (l.Combine2(c,
                                    f.aabb), k = l.GetPerimeter() + k) : (l.Combine2(c, f.aabb), D = f.aabb.GetPerimeter(), m = l.GetPerimeter(), k = m - D + k);
                                if (h < g && h < k) break;
                                d = g < k ? e : f
                            }
                            f = d;
                            e = f.parent;
                            d = this.AllocateNode();
                            d.parent = e;
                            delete d.userData;
                            d.aabb.Combine2(c, f.aabb);
                            d.height = f.height + 1;
                            e ? (e.child1 === f ? e.child1 = d : e.child2 = d, d.child1 = f, d.child2 = b, f.parent = d, b.parent = d) : (d.child1 = f, d.child2 = b, f.parent = d, this.m_root = b.parent = d);
                            for (b = b.parent; null !== b;) b = this.Balance(b), e = t(b.child1), f = t(b.child2), b.height = 1 + aa(e.height, f.height), b.aabb.Combine2(e.aabb,
                                f.aabb), b = b.parent
                        }
                    };
                    a.prototype.RemoveLeaf = function(a) {
                        if (a === this.m_root) this.m_root = null;
                        else {
                            var b = t(a.parent),
                                c = b && b.parent;
                            a = b.child1 === a ? t(b.child2) : t(b.child1);
                            if (c)
                                for (c.child1 === b ? c.child1 = a : c.child2 = a, a.parent = c, this.FreeNode(b), b = c; b;) b = this.Balance(b), c = t(b.child1), a = t(b.child2), b.aabb.Combine2(c.aabb, a.aabb), b.height = 1 + aa(c.height, a.height), b = b.parent;
                            else this.m_root = a, a.parent = null, this.FreeNode(b)
                        }
                    };
                    a.prototype.Balance = function(a) {
                        if (a.IsLeaf() || 2 > a.height) return a;
                        var b = t(a.child1),
                            c = t(a.child2),
                            d = c.height - b.height;
                        if (1 < d) {
                            d = t(c.child1);
                            var e = t(c.child2);
                            c.child1 = a;
                            c.parent = a.parent;
                            a.parent = c;
                            null !== c.parent ? c.parent.child1 === a ? c.parent.child1 = c : c.parent.child2 = c : this.m_root = c;
                            d.height > e.height ? (c.child2 = d, a.child2 = e, e.parent = a, a.aabb.Combine2(b.aabb, e.aabb), c.aabb.Combine2(a.aabb, d.aabb), a.height = 1 + aa(b.height, e.height), c.height = 1 + aa(a.height, d.height)) : (c.child2 = e, a.child2 = d, d.parent = a, a.aabb.Combine2(b.aabb, d.aabb), c.aabb.Combine2(a.aabb, e.aabb), a.height = 1 + aa(b.height, d.height),
                                c.height = 1 + aa(a.height, e.height));
                            return c
                        }
                        return -1 > d ? (d = t(b.child1), e = t(b.child2), b.child1 = a, b.parent = a.parent, a.parent = b, null !== b.parent ? b.parent.child1 === a ? b.parent.child1 = b : b.parent.child2 = b : this.m_root = b, d.height > e.height ? (b.child2 = d, a.child1 = e, e.parent = a, a.aabb.Combine2(c.aabb, e.aabb), b.aabb.Combine2(a.aabb, d.aabb), a.height = 1 + aa(c.height, e.height), b.height = 1 + aa(a.height, d.height)) : (b.child2 = e, a.child1 = d, d.parent = a, a.aabb.Combine2(c.aabb, d.aabb), b.aabb.Combine2(a.aabb, e.aabb), a.height = 1 + aa(c.height,
                            d.height), b.height = 1 + aa(a.height, e.height)), b) : a
                    };
                    a.prototype.GetHeight = function() {
                        return null === this.m_root ? 0 : this.m_root.height
                    };
                    a.GetAreaNode = function(b) {
                        if (null === b || b.IsLeaf()) return 0;
                        var c = b.aabb.GetPerimeter();
                        c += a.GetAreaNode(b.child1);
                        return c += a.GetAreaNode(b.child2)
                    };
                    a.prototype.GetAreaRatio = function() {
                        if (null === this.m_root) return 0;
                        var b = this.m_root.aabb.GetPerimeter();
                        return a.GetAreaNode(this.m_root) / b
                    };
                    a.prototype.ComputeHeightNode = function(a) {
                        if (!a || a.IsLeaf()) return 0;
                        var b = this.ComputeHeightNode(a.child1);
                        a = this.ComputeHeightNode(a.child2);
                        return 1 + aa(b, a)
                    };
                    a.prototype.ComputeHeight = function() {
                        return this.ComputeHeightNode(this.m_root)
                    };
                    a.prototype.ValidateStructure = function(a) {
                        if (null !== a && (a === this.m_root, !a.IsLeaf())) {
                            var b = t(a.child1);
                            a = t(a.child2);
                            this.ValidateStructure(b);
                            this.ValidateStructure(a)
                        }
                    };
                    a.prototype.ValidateMetrics = function(b) {
                        if (null !== b && !b.IsLeaf()) {
                            var c = t(b.child1);
                            b = t(b.child2);
                            a.s_aabb.Combine2(c.aabb, b.aabb);
                            this.ValidateMetrics(c);
                            this.ValidateMetrics(b)
                        }
                    };
                    a.prototype.Validate =
                        function() {};
                    a.GetMaxBalanceNode = function(a, b) {
                        if (null === a || 1 >= a.height) return b;
                        var c = t(a.child1);
                        a = t(a.child2);
                        c = ba(a.height - c.height);
                        return aa(b, c)
                    };
                    a.prototype.GetMaxBalance = function() {
                        return a.GetMaxBalanceNode(this.m_root, 0)
                    };
                    a.prototype.RebuildBottomUp = function() {
                        this.Validate()
                    };
                    a.ShiftOriginNode = function(b, c) {
                        if (null !== b && !(1 >= b.height)) {
                            var d = b.child2;
                            a.ShiftOriginNode(b.child1, c);
                            a.ShiftOriginNode(d, c);
                            b.aabb.lowerBound.SelfSub(c);
                            b.aabb.upperBound.SelfSub(c)
                        }
                    };
                    a.prototype.ShiftOrigin =
                        function(b) {
                            a.ShiftOriginNode(this.m_root, b)
                        };
                    a.s_r = new r;
                    a.s_v = new r;
                    a.s_abs_v = new r;
                    a.s_segmentAABB = new ra;
                    a.s_subInput = new $a;
                    a.s_combinedAABB = new ra;
                    a.s_aabb = new ra;
                    a.s_node_id = 0;
                    return a
                }(),
                Jb = function() {
                    return function(a, b) {
                        this.proxyA = a;
                        this.proxyB = b
                    }
                }(),
                Kb = function() {
                    function a() {
                        this.m_tree = new Ib;
                        this.m_moveCount = this.m_proxyCount = 0;
                        this.m_moveBuffer = [];
                        this.m_pairCount = 0;
                        this.m_pairBuffer = []
                    }
                    a.prototype.CreateProxy = function(a, b) {
                        a = this.m_tree.CreateProxy(a, b);
                        ++this.m_proxyCount;
                        this.BufferMove(a);
                        return a
                    };
                    a.prototype.DestroyProxy = function(a) {
                        this.UnBufferMove(a);
                        --this.m_proxyCount;
                        this.m_tree.DestroyProxy(a)
                    };
                    a.prototype.MoveProxy = function(a, b, c) {
                        this.m_tree.MoveProxy(a, b, c) && this.BufferMove(a)
                    };
                    a.prototype.TouchProxy = function(a) {
                        this.BufferMove(a)
                    };
                    a.prototype.GetProxyCount = function() {
                        return this.m_proxyCount
                    };
                    a.prototype.UpdatePairs = function(a) {
                        var b = this;
                        this.m_pairCount = 0;
                        for (var c = function(a) {
                                var c = d.m_moveBuffer[a];
                                if (null === c) return "continue";
                                d.m_tree.Query(c.aabb, function(a) {
                                    if (a.m_id ===
                                        c.m_id) return !0;
                                    if (a.m_id < c.m_id) {
                                        var d = a;
                                        a = c
                                    } else d = c;
                                    if (b.m_pairCount === b.m_pairBuffer.length) b.m_pairBuffer[b.m_pairCount] = new Jb(d, a);
                                    else {
                                        var e = b.m_pairBuffer[b.m_pairCount];
                                        e.proxyA = d;
                                        e.proxyB = a
                                    }++b.m_pairCount;
                                    return !0
                                })
                            }, d = this, e = 0; e < this.m_moveCount; ++e) c(e);
                        this.m_moveCount = 0;
                        this.m_pairBuffer.length = this.m_pairCount;
                        this.m_pairBuffer.sort(p);
                        for (c = 0; c < this.m_pairCount;) {
                            e = this.m_pairBuffer[c];
                            var f = e.proxyA.userData,
                                g = e.proxyB.userData;
                            f && g && a(f, g);
                            for (++c; c < this.m_pairCount;) {
                                f = this.m_pairBuffer[c];
                                if (f.proxyA.m_id !== e.proxyA.m_id || f.proxyB.m_id !== e.proxyB.m_id) break;
                                ++c
                            }
                        }
                    };
                    a.prototype.Query = function(a, b) {
                        this.m_tree.Query(a, b)
                    };
                    a.prototype.QueryPoint = function(a, b) {
                        this.m_tree.QueryPoint(a, b)
                    };
                    a.prototype.RayCast = function(a, b) {
                        this.m_tree.RayCast(a, b)
                    };
                    a.prototype.GetTreeHeight = function() {
                        return this.m_tree.GetHeight()
                    };
                    a.prototype.GetTreeBalance = function() {
                        return this.m_tree.GetMaxBalance()
                    };
                    a.prototype.GetTreeQuality = function() {
                        return this.m_tree.GetAreaRatio()
                    };
                    a.prototype.ShiftOrigin = function(a) {
                        this.m_tree.ShiftOrigin(a)
                    };
                    a.prototype.BufferMove = function(a) {
                        this.m_moveBuffer[this.m_moveCount] = a;
                        ++this.m_moveCount
                    };
                    a.prototype.UnBufferMove = function(a) {
                        a = this.m_moveBuffer.indexOf(a);
                        this.m_moveBuffer[a] = null
                    };
                    return a
                }();
            f.b2_toiTime = 0;
            f.b2_toiMaxTime = 0;
            f.b2_toiCalls = 0;
            f.b2_toiIters = 0;
            f.b2_toiMaxIters = 0;
            f.b2_toiRootIters = 0;
            f.b2_toiMaxRootIters = 0;
            var ab = new T,
                bb = new T,
                Fa = new r,
                Ga = new r,
                Sa = new r,
                Lb = new r,
                Mb = new r,
                hb = function() {
                    return function() {
                        this.proxyA = new Ca;
                        this.proxyB = new Ca;
                        this.sweepA = new pa;
                        this.sweepB = new pa;
                        this.tMax = 0
                    }
                }();
            (function(a) {
                a[a.e_unknown = 0] = "e_unknown";
                a[a.e_failed = 1] = "e_failed";
                a[a.e_overlapped = 2] = "e_overlapped";
                a[a.e_touching = 3] = "e_touching";
                a[a.e_separated = 4] = "e_separated"
            })(f.b2TOIOutputState || (f.b2TOIOutputState = {}));
            var ib = function() {
                return function() {
                    this.state = f.b2TOIOutputState.e_unknown;
                    this.t = 0
                }
            }();
            (function(a) {
                a[a.e_unknown = -1] = "e_unknown";
                a[a.e_points = 0] = "e_points";
                a[a.e_faceA = 1] = "e_faceA";
                a[a.e_faceB = 2] = "e_faceB"
            })(f.b2SeparationFunctionType || (f.b2SeparationFunctionType = {}));
            var Nb = function() {
                    function a() {
                        this.m_sweepA = new pa;
                        this.m_sweepB = new pa;
                        this.m_type = f.b2SeparationFunctionType.e_unknown;
                        this.m_localPoint = new r;
                        this.m_axis = new r
                    }
                    a.prototype.Initialize = function(a, b, c, d, e, g) {
                        this.m_proxyA = b;
                        this.m_proxyB = d;
                        b = a.count;
                        this.m_sweepA.Copy(c);
                        this.m_sweepB.Copy(e);
                        c = ab;
                        e = bb;
                        this.m_sweepA.GetTransform(c, g);
                        this.m_sweepB.GetTransform(e, g);
                        if (1 === b) return this.m_type = f.b2SeparationFunctionType.e_points, b = this.m_proxyA.GetVertex(a.indexA[0]), a = this.m_proxyB.GetVertex(a.indexB[0]),
                            c = T.MulXV(c, b, Fa), e = T.MulXV(e, a, Ga), r.SubVV(e, c, this.m_axis), a = this.m_axis.Normalize(), this.m_localPoint.SetZero(), a;
                        if (a.indexA[0] === a.indexA[1]) return this.m_type = f.b2SeparationFunctionType.e_faceB, b = this.m_proxyB.GetVertex(a.indexB[0]), d = this.m_proxyB.GetVertex(a.indexB[1]), r.CrossVOne(r.SubVV(d, b, r.s_t0), this.m_axis).SelfNormalize(), g = N.MulRV(e.q, this.m_axis, Sa), r.MidVV(b, d, this.m_localPoint), e = T.MulXV(e, this.m_localPoint, Ga), b = this.m_proxyA.GetVertex(a.indexA[0]), c = T.MulXV(c, b, Fa), a = r.DotVV(r.SubVV(c,
                            e, r.s_t0), g), 0 > a && (this.m_axis.SelfNeg(), a = -a), a;
                        this.m_type = f.b2SeparationFunctionType.e_faceA;
                        b = this.m_proxyA.GetVertex(a.indexA[0]);
                        d = this.m_proxyA.GetVertex(a.indexA[1]);
                        r.CrossVOne(r.SubVV(d, b, r.s_t0), this.m_axis).SelfNormalize();
                        g = N.MulRV(c.q, this.m_axis, Sa);
                        r.MidVV(b, d, this.m_localPoint);
                        c = T.MulXV(c, this.m_localPoint, Fa);
                        a = this.m_proxyB.GetVertex(a.indexB[0]);
                        e = T.MulXV(e, a, Ga);
                        a = r.DotVV(r.SubVV(e, c, r.s_t0), g);
                        0 > a && (this.m_axis.SelfNeg(), a = -a);
                        return a
                    };
                    a.prototype.FindMinSeparation = function(a,
                        b, c) {
                        var d = ab,
                            e = bb;
                        this.m_sweepA.GetTransform(d, c);
                        this.m_sweepB.GetTransform(e, c);
                        switch (this.m_type) {
                            case f.b2SeparationFunctionType.e_points:
                                var g = N.MulTRV(d.q, this.m_axis, Lb),
                                    h = N.MulTRV(e.q, r.NegV(this.m_axis, r.s_t0), Mb);
                                a[0] = this.m_proxyA.GetSupport(g);
                                b[0] = this.m_proxyB.GetSupport(h);
                                a = this.m_proxyA.GetVertex(a[0]);
                                b = this.m_proxyB.GetVertex(b[0]);
                                d = T.MulXV(d, a, Fa);
                                e = T.MulXV(e, b, Ga);
                                return b = r.DotVV(r.SubVV(e, d, r.s_t0), this.m_axis);
                            case f.b2SeparationFunctionType.e_faceA:
                                return c = N.MulRV(d.q,
                                    this.m_axis, Sa), d = T.MulXV(d, this.m_localPoint, Fa), h = N.MulTRV(e.q, r.NegV(c, r.s_t0), Mb), a[0] = -1, b[0] = this.m_proxyB.GetSupport(h), b = this.m_proxyB.GetVertex(b[0]), e = T.MulXV(e, b, Ga), b = r.DotVV(r.SubVV(e, d, r.s_t0), c);
                            case f.b2SeparationFunctionType.e_faceB:
                                return c = N.MulRV(e.q, this.m_axis, Sa), e = T.MulXV(e, this.m_localPoint, Ga), g = N.MulTRV(d.q, r.NegV(c, r.s_t0), Lb), b[0] = -1, a[0] = this.m_proxyA.GetSupport(g), a = this.m_proxyA.GetVertex(a[0]), d = T.MulXV(d, a, Fa), b = r.DotVV(r.SubVV(d, e, r.s_t0), c);
                            default:
                                return a[0] = -1, b[0] = -1, 0
                        }
                    };
                    a.prototype.Evaluate = function(a, b, c) {
                        var d = ab,
                            e = bb;
                        this.m_sweepA.GetTransform(d, c);
                        this.m_sweepB.GetTransform(e, c);
                        switch (this.m_type) {
                            case f.b2SeparationFunctionType.e_points:
                                return a = this.m_proxyA.GetVertex(a), b = this.m_proxyB.GetVertex(b), d = T.MulXV(d, a, Fa), e = T.MulXV(e, b, Ga), d = r.DotVV(r.SubVV(e, d, r.s_t0), this.m_axis);
                            case f.b2SeparationFunctionType.e_faceA:
                                return c = N.MulRV(d.q, this.m_axis, Sa), d = T.MulXV(d, this.m_localPoint, Fa), b = this.m_proxyB.GetVertex(b), e = T.MulXV(e, b, Ga), d = r.DotVV(r.SubVV(e,
                                    d, r.s_t0), c);
                            case f.b2SeparationFunctionType.e_faceB:
                                return c = N.MulRV(e.q, this.m_axis, Sa), e = T.MulXV(e, this.m_localPoint, Ga), a = this.m_proxyA.GetVertex(a), d = T.MulXV(d, a, Fa), d = r.DotVV(r.SubVV(d, e, r.s_t0), c);
                            default:
                                return 0
                        }
                    };
                    return a
                }(),
                Nc = new xa,
                Qc = new Na,
                Rc = new Oa,
                Sc = new Pa,
                Tc = new Nb,
                Uc = [0],
                Vc = [0],
                Oc = new pa,
                Pc = new pa,
                Wc = new r,
                Xc = new r,
                Yc = new r,
                Zc = new r,
                $c = new r,
                ad = new r,
                bd = new r,
                cd = new r,
                dd = new r,
                ed = new r,
                fd = new r,
                jd = new r,
                id = Ja.MakeArray(2),
                rd = Ja.MakeArray(2),
                sd = Ja.MakeArray(2),
                gd = [0],
                hd = [0],
                kd =
                new r,
                ld = new r,
                md = new r,
                od = new r,
                nd = new r,
                td = new r,
                pd = new r,
                qd = new r,
                ud = new r,
                vd = new r,
                fb = new r,
                xd = new r,
                yd = new r,
                zd = new r,
                Ad = new r,
                wd = new Za,
                Ob = function() {
                    return function() {
                        this.separation = this.index = this.type = 0
                    }
                }(),
                Dd = function() {
                    return function() {
                        this.vertices = r.MakeArray(8);
                        this.normals = r.MakeArray(8);
                        this.count = 0
                    }
                }(),
                Ed = function() {
                    return function() {
                        this.i2 = this.i1 = 0;
                        this.v1 = new r;
                        this.v2 = new r;
                        this.normal = new r;
                        this.sideNormal1 = new r;
                        this.sideOffset1 = 0;
                        this.sideNormal2 = new r;
                        this.sideOffset2 =
                            0
                    }
                }(),
                Bd = new(function() {
                    function a() {
                        this.m_polygonB = new Dd;
                        this.m_xf = new T;
                        this.m_centroidB = new r;
                        this.m_v0 = new r;
                        this.m_v1 = new r;
                        this.m_v2 = new r;
                        this.m_v3 = new r;
                        this.m_normal0 = new r;
                        this.m_normal1 = new r;
                        this.m_normal2 = new r;
                        this.m_normal = new r;
                        this.m_type2 = this.m_type1 = 0;
                        this.m_lowerLimit = new r;
                        this.m_upperLimit = new r;
                        this.m_radius = 0;
                        this.m_front = !1
                    }
                    a.prototype.Collide = function(b, c, d, e, g) {
                        T.MulTXX(d, g, this.m_xf);
                        T.MulXV(this.m_xf, e.m_centroid, this.m_centroidB);
                        this.m_v0.Copy(c.m_vertex0);
                        this.m_v1.Copy(c.m_vertex1);
                        this.m_v2.Copy(c.m_vertex2);
                        this.m_v3.Copy(c.m_vertex3);
                        d = c.m_hasVertex0;
                        g = c.m_hasVertex3;
                        var h = r.SubVV(this.m_v2, this.m_v1, a.s_edge1);
                        h.Normalize();
                        this.m_normal1.Set(h.y, -h.x);
                        var k = r.DotVV(this.m_normal1, r.SubVV(this.m_centroidB, this.m_v1, r.s_t0));
                        var l = 0,
                            D = 0,
                            J = !1,
                            n = !1;
                        d && (l = r.SubVV(this.m_v1, this.m_v0, a.s_edge0), l.Normalize(), this.m_normal0.Set(l.y, -l.x), J = 0 <= r.CrossVV(l, h), l = r.DotVV(this.m_normal0, r.SubVV(this.m_centroidB, this.m_v0, r.s_t0)));
                        g && (D = r.SubVV(this.m_v3, this.m_v2, a.s_edge2), D.Normalize(),
                            this.m_normal2.Set(D.y, -D.x), n = 0 < r.CrossVV(h, D), D = r.DotVV(this.m_normal2, r.SubVV(this.m_centroidB, this.m_v2, r.s_t0)));
                        d && g ? J && n ? (this.m_front = 0 <= l || 0 <= k || 0 <= D) ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal0), this.m_upperLimit.Copy(this.m_normal2)) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(), this.m_upperLimit.Copy(this.m_normal1).SelfNeg()) : J ? (this.m_front = 0 <= l || 0 <= k && 0 <= D) ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal0),
                                this.m_upperLimit.Copy(this.m_normal1)) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(), this.m_upperLimit.Copy(this.m_normal1).SelfNeg()) : n ? (this.m_front = 0 <= D || 0 <= l && 0 <= k) ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal1), this.m_upperLimit.Copy(this.m_normal2)) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(), this.m_upperLimit.Copy(this.m_normal0).SelfNeg()) : (this.m_front = 0 <= l && 0 <=
                                k && 0 <= D) ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal1), this.m_upperLimit.Copy(this.m_normal1)) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(), this.m_upperLimit.Copy(this.m_normal0).SelfNeg()) : d ? J ? ((this.m_front = 0 <= l || 0 <= k) ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal0)) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), this.m_lowerLimit.Copy(this.m_normal1)), this.m_upperLimit.Copy(this.m_normal1).SelfNeg()) :
                            (this.m_front = 0 <= l && 0 <= k) ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal1), this.m_upperLimit.Copy(this.m_normal1).SelfNeg()) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), this.m_lowerLimit.Copy(this.m_normal1), this.m_upperLimit.Copy(this.m_normal0).SelfNeg()) : g ? n ? (this.m_front = 0 <= k || 0 <= D) ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(), this.m_upperLimit.Copy(this.m_normal2)) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),
                                this.m_upperLimit.Copy(this.m_normal1)) : ((this.m_front = 0 <= k && 0 <= D) ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal1).SelfNeg()) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), this.m_lowerLimit.Copy(this.m_normal2).SelfNeg()), this.m_upperLimit.Copy(this.m_normal1)) : (this.m_front = 0 <= k) ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(), this.m_upperLimit.Copy(this.m_normal1).SelfNeg()) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), this.m_lowerLimit.Copy(this.m_normal1),
                                this.m_upperLimit.Copy(this.m_normal1));
                        this.m_polygonB.count = e.m_count;
                        for (h = 0; h < e.m_count; ++h) T.MulXV(this.m_xf, e.m_vertices[h], this.m_polygonB.vertices[h]), N.MulRV(this.m_xf.q, e.m_normals[h], this.m_polygonB.normals[h]);
                        this.m_radius = e.m_radius + c.m_radius;
                        b.pointCount = 0;
                        c = this.ComputeEdgeSeparation(a.s_edgeAxis);
                        if (!(0 === c.type || c.separation > this.m_radius || (d = this.ComputePolygonSeparation(a.s_polygonAxis), 0 !== d.type && d.separation > this.m_radius))) {
                            c = 0 === d.type ? c : d.separation > .98 * c.separation + .001 ?
                                d : c;
                            g = a.s_ie;
                            d = a.s_rf;
                            if (1 === c.type) {
                                b.type = f.b2ManifoldType.e_faceA;
                                k = 0;
                                l = r.DotVV(this.m_normal, this.m_polygonB.normals[0]);
                                for (h = 1; h < this.m_polygonB.count; ++h) D = r.DotVV(this.m_normal, this.m_polygonB.normals[h]), D < l && (l = D, k = h);
                                l = k;
                                h = (l + 1) % this.m_polygonB.count;
                                k = g[0];
                                k.v.Copy(this.m_polygonB.vertices[l]);
                                k.id.cf.indexA = 0;
                                k.id.cf.indexB = l;
                                k.id.cf.typeA = f.b2ContactFeatureType.e_face;
                                k.id.cf.typeB = f.b2ContactFeatureType.e_vertex;
                                k = g[1];
                                k.v.Copy(this.m_polygonB.vertices[h]);
                                k.id.cf.indexA = 0;
                                k.id.cf.indexB =
                                    h;
                                k.id.cf.typeA = f.b2ContactFeatureType.e_face;
                                k.id.cf.typeB = f.b2ContactFeatureType.e_vertex;
                                this.m_front ? (d.i1 = 0, d.i2 = 1, d.v1.Copy(this.m_v1), d.v2.Copy(this.m_v2), d.normal.Copy(this.m_normal1)) : (d.i1 = 1, d.i2 = 0, d.v1.Copy(this.m_v2), d.v2.Copy(this.m_v1), d.normal.Copy(this.m_normal1).SelfNeg())
                            } else b.type = f.b2ManifoldType.e_faceB, k = g[0], k.v.Copy(this.m_v1), k.id.cf.indexA = 0, k.id.cf.indexB = c.index, k.id.cf.typeA = f.b2ContactFeatureType.e_vertex, k.id.cf.typeB = f.b2ContactFeatureType.e_face, k = g[1], k.v.Copy(this.m_v2),
                                k.id.cf.indexA = 0, k.id.cf.indexB = c.index, k.id.cf.typeA = f.b2ContactFeatureType.e_vertex, k.id.cf.typeB = f.b2ContactFeatureType.e_face, d.i1 = c.index, d.i2 = (d.i1 + 1) % this.m_polygonB.count, d.v1.Copy(this.m_polygonB.vertices[d.i1]), d.v2.Copy(this.m_polygonB.vertices[d.i2]), d.normal.Copy(this.m_polygonB.normals[d.i1]);
                            d.sideNormal1.Set(d.normal.y, -d.normal.x);
                            d.sideNormal2.Copy(d.sideNormal1).SelfNeg();
                            d.sideOffset1 = r.DotVV(d.sideNormal1, d.v1);
                            d.sideOffset2 = r.DotVV(d.sideNormal2, d.v2);
                            h = a.s_clipPoints1;
                            k = a.s_clipPoints2;
                            g = m(h, g, d.sideNormal1, d.sideOffset1, d.i1);
                            if (!(2 > g || (g = m(k, h, d.sideNormal2, d.sideOffset2, d.i2), 2 > g))) {
                                1 === c.type ? (b.localNormal.Copy(d.normal), b.localPoint.Copy(d.v1)) : (b.localNormal.Copy(e.m_normals[d.i1]), b.localPoint.Copy(e.m_vertices[d.i1]));
                                for (h = e = 0; 2 > h; ++h) r.DotVV(d.normal, r.SubVV(k[h].v, d.v1, r.s_t0)) <= this.m_radius && (g = b.points[e], 1 === c.type ? (T.MulTXV(this.m_xf, k[h].v, g.localPoint), g.id = k[h].id) : (g.localPoint.Copy(k[h].v), g.id.cf.typeA = k[h].id.cf.typeB, g.id.cf.typeB = k[h].id.cf.typeA, g.id.cf.indexA =
                                    k[h].id.cf.indexB, g.id.cf.indexB = k[h].id.cf.indexA), ++e);
                                b.pointCount = e
                            }
                        }
                    };
                    a.prototype.ComputeEdgeSeparation = function(a) {
                        a.type = 1;
                        a.index = this.m_front ? 0 : 1;
                        a.separation = 1E37;
                        for (var b = 0; b < this.m_polygonB.count; ++b) {
                            var c = r.DotVV(this.m_normal, r.SubVV(this.m_polygonB.vertices[b], this.m_v1, r.s_t0));
                            c < a.separation && (a.separation = c)
                        }
                        return a
                    };
                    a.prototype.ComputePolygonSeparation = function(b) {
                        b.type = 0;
                        b.index = -1;
                        b.separation = -1E37;
                        for (var c = a.s_perp.Set(-this.m_normal.y, this.m_normal.x), d = 0; d < this.m_polygonB.count; ++d) {
                            var e =
                                r.NegV(this.m_polygonB.normals[d], a.s_n),
                                f = r.DotVV(e, r.SubVV(this.m_polygonB.vertices[d], this.m_v1, r.s_t0)),
                                g = r.DotVV(e, r.SubVV(this.m_polygonB.vertices[d], this.m_v2, r.s_t0));
                            f = W(f, g);
                            if (f > this.m_radius) {
                                b.type = 2;
                                b.index = d;
                                b.separation = f;
                                break
                            }
                            if (0 <= r.DotVV(e, c)) {
                                if (r.DotVV(r.SubVV(e, this.m_upperLimit, r.s_t0), this.m_normal) < -V) continue
                            } else if (r.DotVV(r.SubVV(e, this.m_lowerLimit, r.s_t0), this.m_normal) < -V) continue;
                            f > b.separation && (b.type = 2, b.index = d, b.separation = f)
                        }
                        return b
                    };
                    a.s_edge1 = new r;
                    a.s_edge0 =
                        new r;
                    a.s_edge2 = new r;
                    a.s_ie = Ja.MakeArray(2);
                    a.s_rf = new Ed;
                    a.s_clipPoints1 = Ja.MakeArray(2);
                    a.s_clipPoints2 = Ja.MakeArray(2);
                    a.s_edgeAxis = new Ob;
                    a.s_polygonAxis = new Ob;
                    a.s_n = new r;
                    a.s_perp = new r;
                    return a
                }()),
                cb = function() {
                    return function() {
                        this.mass = 0;
                        this.center = new r(0, 0);
                        this.I = 0
                    }
                }();
            (function(a) {
                a[a.e_unknown = -1] = "e_unknown";
                a[a.e_circleShape = 0] = "e_circleShape";
                a[a.e_edgeShape = 1] = "e_edgeShape";
                a[a.e_polygonShape = 2] = "e_polygonShape";
                a[a.e_chainShape = 3] = "e_chainShape";
                a[a.e_shapeTypeCount = 4] = "e_shapeTypeCount"
            })(f.b2ShapeType ||
                (f.b2ShapeType = {}));
            var Ka = function() {
                    function a(a, b) {
                        this.m_type = f.b2ShapeType.e_unknown;
                        this.m_radius = 0;
                        this.m_type = a;
                        this.m_radius = b
                    }
                    a.prototype.Copy = function(a) {
                        this.m_radius = a.m_radius;
                        return this
                    };
                    a.prototype.GetType = function() {
                        return this.m_type
                    };
                    return a
                }(),
                Cd = Object.setPrototypeOf || {
                    __proto__: []
                }
            instanceof Array && function(a, b) {
                    a.__proto__ = b
                } || function(a, b) {
                    for (var c in b) b.hasOwnProperty(c) && (a[c] = b[c])
                }, Fd = function(b) {
                    function c(a) {
                        void 0 === a && (a = 0);
                        a = b.call(this, f.b2ShapeType.e_circleShape,
                            a) || this;
                        a.m_p = new r;
                        return a
                    }
                    C(c, b);
                    c.prototype.Set = function(a, b) {
                        void 0 === b && (b = this.m_radius);
                        this.m_p.Copy(a);
                        this.m_radius = b;
                        return this
                    };
                    c.prototype.Clone = function() {
                        return (new c).Copy(this)
                    };
                    c.prototype.Copy = function(a) {
                        b.prototype.Copy.call(this, a);
                        this.m_p.Copy(a.m_p);
                        return this
                    };
                    c.prototype.GetChildCount = function() {
                        return 1
                    };
                    c.prototype.TestPoint = function(b, d) {
                        b = T.MulXV(b, this.m_p, c.TestPoint_s_center);
                        d = r.SubVV(d, b, c.TestPoint_s_d);
                        return r.DotVV(d, d) <= a(this.m_radius)
                    };
                    c.prototype.ComputeDistance =
                        function(a, b, d, e) {
                            a = T.MulXV(a, this.m_p, c.ComputeDistance_s_center);
                            r.SubVV(b, a, d);
                            return d.Normalize() - this.m_radius
                        };
                    c.prototype.RayCast = function(b, d, e, f) {
                        e = T.MulXV(e, this.m_p, c.RayCast_s_position);
                        e = r.SubVV(d.p1, e, c.RayCast_s_s);
                        var g = r.DotVV(e, e) - a(this.m_radius);
                        f = r.SubVV(d.p2, d.p1, c.RayCast_s_r);
                        var h = r.DotVV(e, f),
                            k = r.DotVV(f, f);
                        g = h * h - k * g;
                        if (0 > g || 1E-5 > k) return !1;
                        h = -(h + ha(g));
                        return 0 <= h && h <= d.maxFraction * k ? (h /= k, b.fraction = h, r.AddVMulSV(e, h, f, b.normal).SelfNormalize(), !0) : !1
                    };
                    c.prototype.ComputeAABB =
                        function(a, b, d) {
                            b = T.MulXV(b, this.m_p, c.ComputeAABB_s_p);
                            a.lowerBound.Set(b.x - this.m_radius, b.y - this.m_radius);
                            a.upperBound.Set(b.x + this.m_radius, b.y + this.m_radius)
                        };
                    c.prototype.ComputeMass = function(b, c) {
                        var d = a(this.m_radius);
                        b.mass = 3.14159265359 * c * d;
                        b.center.Copy(this.m_p);
                        b.I = b.mass * (.5 * d + r.DotVV(this.m_p, this.m_p))
                    };
                    c.prototype.SetupDistanceProxy = function(a, b) {
                        a.m_vertices = a.m_buffer;
                        a.m_vertices[0].Copy(this.m_p);
                        a.m_count = 1;
                        a.m_radius = this.m_radius
                    };
                    c.prototype.ComputeSubmergedArea = function(a,
                        b, c, d) {
                        c = T.MulXV(c, this.m_p, new r);
                        var e = -(r.DotVV(a, c) - b);
                        if (e < -this.m_radius + 1E-5) return 0;
                        if (e > this.m_radius) return d.Copy(c), 3.14159265359 * this.m_radius * this.m_radius;
                        b = this.m_radius * this.m_radius;
                        var f = e * e;
                        e = b * (na(e / this.m_radius) + 1.570796326795) + e * ha(b - f);
                        b = -2 / 3 * ia(b - f, 1.5) / e;
                        d.x = c.x + a.x * b;
                        d.y = c.y + a.y * b;
                        return e
                    };
                    c.prototype.Dump = function(a) {
                        a("    const shape: b2CircleShape = new b2CircleShape();\n");
                        a("    shape.m_radius = %.15f;\n", this.m_radius);
                        a("    shape.m_p.Set(%.15f, %.15f);\n", this.m_p.x,
                            this.m_p.y)
                    };
                    c.TestPoint_s_center = new r;
                    c.TestPoint_s_d = new r;
                    c.ComputeDistance_s_center = new r;
                    c.RayCast_s_position = new r;
                    c.RayCast_s_s = new r;
                    c.RayCast_s_r = new r;
                    c.ComputeAABB_s_p = new r;
                    return c
                }(Ka), Gd = function(a) {
                    function b() {
                        var b = a.call(this, f.b2ShapeType.e_polygonShape, .016) || this;
                        b.m_centroid = new r(0, 0);
                        b.m_vertices = [];
                        b.m_normals = [];
                        b.m_count = 0;
                        return b
                    }
                    C(b, a);
                    b.prototype.Clone = function() {
                        return (new b).Copy(this)
                    };
                    b.prototype.Copy = function(b) {
                        a.prototype.Copy.call(this, b);
                        this.m_centroid.Copy(b.m_centroid);
                        this.m_count = b.m_count;
                        this.m_vertices = r.MakeArray(this.m_count);
                        this.m_normals = r.MakeArray(this.m_count);
                        for (var c = 0; c < this.m_count; ++c) this.m_vertices[c].Copy(b.m_vertices[c]), this.m_normals[c].Copy(b.m_normals[c]);
                        return this
                    };
                    b.prototype.GetChildCount = function() {
                        return 1
                    };
                    b.prototype.Set = function(a, c, d) {
                        void 0 === c && (c = a.length);
                        void 0 === d && (d = 0);
                        if (3 > c) return this.SetAsBox(1, 1);
                        c = W(c, 8);
                        for (var e = b.Set_s_ps, f = 0, g = 0; g < c; ++g) {
                            var h = a[d + g];
                            for (var k = !0, l = 0; l < f; ++l)
                                if (1.6E-5 > r.DistanceSquaredVV(h,
                                        e[l])) {
                                    k = !1;
                                    break
                                }
                            k && e[f++].Copy(h)
                        }
                        c = f;
                        if (3 > c) return this.SetAsBox(1, 1);
                        a = 0;
                        h = e[0].x;
                        for (g = 1; g < c; ++g)
                            if (l = e[g].x, l > h || l === h && e[g].y < e[a].y) a = g, h = l;
                        f = b.Set_s_hull;
                        d = 0;
                        for (g = a;;) {
                            f[d] = g;
                            k = 0;
                            for (l = 1; l < c; ++l)
                                if (k === g) k = l;
                                else {
                                    var D = r.SubVV(e[k], e[f[d]], b.Set_s_r);
                                    h = r.SubVV(e[l], e[f[d]], b.Set_s_v);
                                    var J = r.CrossVV(D, h);
                                    0 > J && (k = l);
                                    0 === J && h.LengthSquared() > D.LengthSquared() && (k = l)
                                }++d;
                            g = k;
                            if (k === a) break
                        }
                        this.m_count = d;
                        this.m_vertices = r.MakeArray(this.m_count);
                        this.m_normals = r.MakeArray(this.m_count);
                        for (g =
                            0; g < d; ++g) this.m_vertices[g].Copy(e[f[g]]);
                        for (g = 0; g < d; ++g) c = r.SubVV(this.m_vertices[(g + 1) % d], this.m_vertices[g], r.s_t0), r.CrossVOne(c, this.m_normals[g]).SelfNormalize();
                        b.ComputeCentroid(this.m_vertices, d, this.m_centroid);
                        return this
                    };
                    b.prototype.SetAsArray = function(a, b) {
                        void 0 === b && (b = a.length);
                        return this.Set(a, b)
                    };
                    b.prototype.SetAsBox = function(a, b, c, d) {
                        void 0 === d && (d = 0);
                        this.m_count = 4;
                        this.m_vertices = r.MakeArray(this.m_count);
                        this.m_normals = r.MakeArray(this.m_count);
                        this.m_vertices[0].Set(-a, -b);
                        this.m_vertices[1].Set(a, -b);
                        this.m_vertices[2].Set(a, b);
                        this.m_vertices[3].Set(-a, b);
                        this.m_normals[0].Set(0, -1);
                        this.m_normals[1].Set(1, 0);
                        this.m_normals[2].Set(0, 1);
                        this.m_normals[3].Set(-1, 0);
                        this.m_centroid.SetZero();
                        if (c)
                            for (this.m_centroid.Copy(c), a = new T, a.SetPosition(c), a.SetRotationAngle(d), c = 0; c < this.m_count; ++c) T.MulXV(a, this.m_vertices[c], this.m_vertices[c]), N.MulRV(a.q, this.m_normals[c], this.m_normals[c]);
                        return this
                    };
                    b.prototype.TestPoint = function(a, c) {
                        a = T.MulTXV(a, c, b.TestPoint_s_pLocal);
                        for (c = 0; c < this.m_count; ++c)
                            if (0 < r.DotVV(this.m_normals[c], r.SubVV(a, this.m_vertices[c], r.s_t0))) return !1;
                        return !0
                    };
                    b.prototype.ComputeDistance = function(a, c, d, e) {
                        c = T.MulTXV(a, c, b.ComputeDistance_s_pLocal);
                        var f = -1E37,
                            g = b.ComputeDistance_s_normalForMaxDistance.Copy(c);
                        for (e = 0; e < this.m_count; ++e) {
                            var h = r.DotVV(this.m_normals[e], r.SubVV(c, this.m_vertices[e], r.s_t0));
                            h > f && (f = h, g.Copy(this.m_normals[e]))
                        }
                        if (0 < f) {
                            g = b.ComputeDistance_s_minDistance.Copy(g);
                            f *= f;
                            for (e = 0; e < this.m_count; ++e) {
                                h = r.SubVV(c, this.m_vertices[e],
                                    b.ComputeDistance_s_distance);
                                var k = h.LengthSquared();
                                f > k && (g.Copy(h), f = k)
                            }
                            N.MulRV(a.q, g, d);
                            d.Normalize();
                            return Math.sqrt(f)
                        }
                        N.MulRV(a.q, g, d);
                        return f
                    };
                    b.prototype.RayCast = function(a, c, d, e) {
                        e = T.MulTXV(d, c.p1, b.RayCast_s_p1);
                        var f = T.MulTXV(d, c.p2, b.RayCast_s_p2);
                        f = r.SubVV(f, e, b.RayCast_s_d);
                        var g = 0;
                        c = c.maxFraction;
                        for (var h = -1, k = 0; k < this.m_count; ++k) {
                            var l = r.DotVV(this.m_normals[k], r.SubVV(this.m_vertices[k], e, r.s_t0)),
                                D = r.DotVV(this.m_normals[k], f);
                            if (0 === D) {
                                if (0 > l) return !1
                            } else 0 > D && l < g * D ? (g = l /
                                D, h = k) : 0 < D && l < c * D && (c = l / D);
                            if (c < g) return !1
                        }
                        return 0 <= h ? (a.fraction = g, N.MulRV(d.q, this.m_normals[h], a.normal), !0) : !1
                    };
                    b.prototype.ComputeAABB = function(a, c, d) {
                        d = T.MulXV(c, this.m_vertices[0], a.lowerBound);
                        a = a.upperBound.Copy(d);
                        for (var e = 0; e < this.m_count; ++e) {
                            var f = T.MulXV(c, this.m_vertices[e], b.ComputeAABB_s_v);
                            r.MinV(f, d, d);
                            r.MaxV(f, a, a)
                        }
                        c = this.m_radius;
                        d.SelfSubXY(c, c);
                        a.SelfAddXY(c, c)
                    };
                    b.prototype.ComputeMass = function(a, c) {
                        for (var d = b.ComputeMass_s_center.SetZero(), e = 0, f = 0, g = b.ComputeMass_s_s.SetZero(),
                                h = 0; h < this.m_count; ++h) g.SelfAdd(this.m_vertices[h]);
                        g.SelfMul(1 / this.m_count);
                        var k = 1 / 3;
                        for (h = 0; h < this.m_count; ++h) {
                            var l = r.SubVV(this.m_vertices[h], g, b.ComputeMass_s_e1),
                                D = r.SubVV(this.m_vertices[(h + 1) % this.m_count], g, b.ComputeMass_s_e2),
                                m = r.CrossVV(l, D),
                                n = .5 * m;
                            e += n;
                            d.SelfAdd(r.MulSV(n * k, r.AddVV(l, D, r.s_t0), r.s_t1));
                            n = l.x;
                            l = l.y;
                            var J = D.x;
                            D = D.y;
                            f += .25 * k * m * (n * n + J * n + J * J + (l * l + D * l + D * D))
                        }
                        a.mass = c * e;
                        d.SelfMul(1 / e);
                        r.AddVV(d, g, a.center);
                        a.I = c * f;
                        a.I += a.mass * (r.DotVV(a.center, a.center) - r.DotVV(d, d))
                    };
                    b.prototype.Validate =
                        function() {
                            for (var a = 0; a < this.m_count; ++a)
                                for (var c = a, d = (a + 1) % this.m_count, e = this.m_vertices[c], f = r.SubVV(this.m_vertices[d], e, b.Validate_s_e), g = 0; g < this.m_count; ++g)
                                    if (g !== c && g !== d) {
                                        var h = r.SubVV(this.m_vertices[g], e, b.Validate_s_v);
                                        if (0 > r.CrossVV(f, h)) return !1
                                    }
                            return !0
                        };
                    b.prototype.SetupDistanceProxy = function(a, b) {
                        a.m_vertices = this.m_vertices;
                        a.m_count = this.m_count;
                        a.m_radius = this.m_radius
                    };
                    b.prototype.ComputeSubmergedArea = function(a, c, d, e) {
                        var f = N.MulTRV(d.q, a, b.ComputeSubmergedArea_s_normalL),
                            g = c - r.DotVV(a, d.p),
                            h = b.ComputeSubmergedArea_s_depths,
                            k = 0;
                        a = c = -1;
                        for (var l = !1, D = 0; D < this.m_count; ++D) {
                            h[D] = r.DotVV(f, this.m_vertices[D]) - g;
                            var m = -1E-5 > h[D];
                            0 < D && (m ? l || (c = D - 1, k++) : l && (a = D - 1, k++));
                            l = m
                        }
                        switch (k) {
                            case 0:
                                return l ? (f = b.ComputeSubmergedArea_s_md, this.ComputeMass(f, 1), T.MulXV(d, f.center, e), f.mass) : 0;
                            case 1:
                                -1 === c ? c = this.m_count - 1 : a = this.m_count - 1
                        }
                        g = (c + 1) % this.m_count;
                        f = (a + 1) % this.m_count;
                        k = (0 - h[c]) / (h[g] - h[c]);
                        h = (0 - h[a]) / (h[f] - h[a]);
                        c = b.ComputeSubmergedArea_s_intoVec.Set(this.m_vertices[c].x *
                            (1 - k) + this.m_vertices[g].x * k, this.m_vertices[c].y * (1 - k) + this.m_vertices[g].y * k);
                        a = b.ComputeSubmergedArea_s_outoVec.Set(this.m_vertices[a].x * (1 - h) + this.m_vertices[f].x * h, this.m_vertices[a].y * (1 - h) + this.m_vertices[f].y * h);
                        h = 0;
                        k = b.ComputeSubmergedArea_s_center.SetZero();
                        l = this.m_vertices[g];
                        for (D = g; D !== f;) D = (D + 1) % this.m_count, g = D === f ? a : this.m_vertices[D], m = .5 * ((l.x - c.x) * (g.y - c.y) - (l.y - c.y) * (g.x - c.x)), h += m, k.x += m * (c.x + l.x + g.x) / 3, k.y += m * (c.y + l.y + g.y) / 3, l = g;
                        k.SelfMul(1 / h);
                        T.MulXV(d, k, e);
                        return h
                    };
                    b.prototype.Dump =
                        function(a) {
                            a("    const shape: b2PolygonShape = new b2PolygonShape();\n");
                            a("    const vs: b2Vec2[] = b2Vec2.MakeArray(%d);\n", 8);
                            for (var b = 0; b < this.m_count; ++b) a("    vs[%d].Set(%.15f, %.15f);\n", b, this.m_vertices[b].x, this.m_vertices[b].y);
                            a("    shape.Set(vs, %d);\n", this.m_count)
                        };
                    b.ComputeCentroid = function(a, c, d) {
                        d.SetZero();
                        for (var e = 0, f = b.ComputeCentroid_s_pRef.SetZero(), g = 1 / 3, h = 0; h < c; ++h) {
                            var k = f,
                                l = a[h],
                                D = a[(h + 1) % c],
                                m = r.SubVV(l, k, b.ComputeCentroid_s_e1),
                                n = r.SubVV(D, k, b.ComputeCentroid_s_e2);
                            m = .5 * r.CrossVV(m, n);
                            e += m;
                            d.x += m * g * (k.x + l.x + D.x);
                            d.y += m * g * (k.y + l.y + D.y)
                        }
                        d.SelfMul(1 / e);
                        return d
                    };
                    b.Set_s_ps = r.MakeArray(8);
                    b.Set_s_hull = h(8);
                    b.Set_s_r = new r;
                    b.Set_s_v = new r;
                    b.TestPoint_s_pLocal = new r;
                    b.ComputeDistance_s_pLocal = new r;
                    b.ComputeDistance_s_normalForMaxDistance = new r;
                    b.ComputeDistance_s_minDistance = new r;
                    b.ComputeDistance_s_distance = new r;
                    b.RayCast_s_p1 = new r;
                    b.RayCast_s_p2 = new r;
                    b.RayCast_s_d = new r;
                    b.ComputeAABB_s_v = new r;
                    b.ComputeMass_s_center = new r;
                    b.ComputeMass_s_s = new r;
                    b.ComputeMass_s_e1 =
                        new r;
                    b.ComputeMass_s_e2 = new r;
                    b.Validate_s_e = new r;
                    b.Validate_s_v = new r;
                    b.ComputeSubmergedArea_s_normalL = new r;
                    b.ComputeSubmergedArea_s_depths = h(8);
                    b.ComputeSubmergedArea_s_md = new cb;
                    b.ComputeSubmergedArea_s_intoVec = new r;
                    b.ComputeSubmergedArea_s_outoVec = new r;
                    b.ComputeSubmergedArea_s_center = new r;
                    b.ComputeCentroid_s_pRef = new r;
                    b.ComputeCentroid_s_e1 = new r;
                    b.ComputeCentroid_s_e2 = new r;
                    return b
                }(Ka), Ta = function(a) {
                    function b() {
                        var b = a.call(this, f.b2ShapeType.e_edgeShape, .016) || this;
                        b.m_vertex1 = new r;
                        b.m_vertex2 = new r;
                        b.m_vertex0 = new r;
                        b.m_vertex3 = new r;
                        b.m_hasVertex0 = !1;
                        b.m_hasVertex3 = !1;
                        return b
                    }
                    C(b, a);
                    b.prototype.Set = function(a, b) {
                        this.m_vertex1.Copy(a);
                        this.m_vertex2.Copy(b);
                        this.m_hasVertex3 = this.m_hasVertex0 = !1;
                        return this
                    };
                    b.prototype.Clone = function() {
                        return (new b).Copy(this)
                    };
                    b.prototype.Copy = function(b) {
                        a.prototype.Copy.call(this, b);
                        this.m_vertex1.Copy(b.m_vertex1);
                        this.m_vertex2.Copy(b.m_vertex2);
                        this.m_vertex0.Copy(b.m_vertex0);
                        this.m_vertex3.Copy(b.m_vertex3);
                        this.m_hasVertex0 = b.m_hasVertex0;
                        this.m_hasVertex3 = b.m_hasVertex3;
                        return this
                    };
                    b.prototype.GetChildCount = function() {
                        return 1
                    };
                    b.prototype.TestPoint = function(a, b) {
                        return !1
                    };
                    b.prototype.ComputeDistance = function(a, c, d, e) {
                        var f = T.MulXV(a, this.m_vertex1, b.ComputeDistance_s_v1);
                        a = T.MulXV(a, this.m_vertex2, b.ComputeDistance_s_v2);
                        e = r.SubVV(c, f, b.ComputeDistance_s_d);
                        f = r.SubVV(a, f, b.ComputeDistance_s_s);
                        var g = r.DotVV(e, f);
                        if (0 < g) {
                            var h = r.DotVV(f, f);
                            g > h ? r.SubVV(c, a, e) : e.SelfMulSub(g / h, f)
                        }
                        d.Copy(e);
                        return d.Normalize()
                    };
                    b.prototype.RayCast =
                        function(a, c, d, e) {
                            var f = T.MulTXV(d, c.p1, b.RayCast_s_p1);
                            e = T.MulTXV(d, c.p2, b.RayCast_s_p2);
                            var g = r.SubVV(e, f, b.RayCast_s_d);
                            e = this.m_vertex1;
                            var h = this.m_vertex2,
                                k = r.SubVV(h, e, b.RayCast_s_e),
                                l = a.normal.Set(k.y, -k.x).SelfNormalize();
                            k = r.DotVV(l, r.SubVV(e, f, r.s_t0));
                            l = r.DotVV(l, g);
                            if (0 === l) return !1;
                            l = k / l;
                            if (0 > l || c.maxFraction < l) return !1;
                            c = r.AddVMulSV(f, l, g, b.RayCast_s_q);
                            f = r.SubVV(h, e, b.RayCast_s_r);
                            h = r.DotVV(f, f);
                            if (0 === h) return !1;
                            e = r.DotVV(r.SubVV(c, e, r.s_t0), f) / h;
                            if (0 > e || 1 < e) return !1;
                            a.fraction = l;
                            N.MulRV(d.q, a.normal, a.normal);
                            0 < k && a.normal.SelfNeg();
                            return !0
                        };
                    b.prototype.ComputeAABB = function(a, c, d) {
                        d = T.MulXV(c, this.m_vertex1, b.ComputeAABB_s_v1);
                        c = T.MulXV(c, this.m_vertex2, b.ComputeAABB_s_v2);
                        r.MinV(d, c, a.lowerBound);
                        r.MaxV(d, c, a.upperBound);
                        c = this.m_radius;
                        a.lowerBound.SelfSubXY(c, c);
                        a.upperBound.SelfAddXY(c, c)
                    };
                    b.prototype.ComputeMass = function(a, b) {
                        a.mass = 0;
                        r.MidVV(this.m_vertex1, this.m_vertex2, a.center);
                        a.I = 0
                    };
                    b.prototype.SetupDistanceProxy = function(a, b) {
                        a.m_vertices = a.m_buffer;
                        a.m_vertices[0].Copy(this.m_vertex1);
                        a.m_vertices[1].Copy(this.m_vertex2);
                        a.m_count = 2;
                        a.m_radius = this.m_radius
                    };
                    b.prototype.ComputeSubmergedArea = function(a, b, c, d) {
                        d.SetZero();
                        return 0
                    };
                    b.prototype.Dump = function(a) {
                        a("    const shape: b2EdgeShape = new b2EdgeShape();\n");
                        a("    shape.m_radius = %.15f;\n", this.m_radius);
                        a("    shape.m_vertex0.Set(%.15f, %.15f);\n", this.m_vertex0.x, this.m_vertex0.y);
                        a("    shape.m_vertex1.Set(%.15f, %.15f);\n", this.m_vertex1.x, this.m_vertex1.y);
                        a("    shape.m_vertex2.Set(%.15f, %.15f);\n", this.m_vertex2.x,
                            this.m_vertex2.y);
                        a("    shape.m_vertex3.Set(%.15f, %.15f);\n", this.m_vertex3.x, this.m_vertex3.y);
                        a("    shape.m_hasVertex0 = %s;\n", this.m_hasVertex0);
                        a("    shape.m_hasVertex3 = %s;\n", this.m_hasVertex3)
                    };
                    b.ComputeDistance_s_v1 = new r;
                    b.ComputeDistance_s_v2 = new r;
                    b.ComputeDistance_s_d = new r;
                    b.ComputeDistance_s_s = new r;
                    b.RayCast_s_p1 = new r;
                    b.RayCast_s_p2 = new r;
                    b.RayCast_s_d = new r;
                    b.RayCast_s_e = new r;
                    b.RayCast_s_q = new r;
                    b.RayCast_s_r = new r;
                    b.ComputeAABB_s_v1 = new r;
                    b.ComputeAABB_s_v2 = new r;
                    return b
                }(Ka),
                Hd = function(a) {
                    function b() {
                        var b = a.call(this, f.b2ShapeType.e_chainShape, .016) || this;
                        b.m_vertices = [];
                        b.m_count = 0;
                        b.m_prevVertex = new r;
                        b.m_nextVertex = new r;
                        b.m_hasPrevVertex = !1;
                        b.m_hasNextVertex = !1;
                        return b
                    }
                    C(b, a);
                    b.prototype.CreateLoop = function(a, b, c) {
                        void 0 === b && (b = a.length);
                        void 0 === c && (c = 0);
                        if (3 > b) return this;
                        this.m_count = b + 1;
                        this.m_vertices = r.MakeArray(this.m_count);
                        for (var d = 0; d < b; ++d) this.m_vertices[d].Copy(a[c + d]);
                        this.m_vertices[b].Copy(this.m_vertices[0]);
                        this.m_prevVertex.Copy(this.m_vertices[this.m_count -
                            2]);
                        this.m_nextVertex.Copy(this.m_vertices[1]);
                        this.m_hasNextVertex = this.m_hasPrevVertex = !0;
                        return this
                    };
                    b.prototype.CreateChain = function(a, b, c) {
                        void 0 === b && (b = a.length);
                        void 0 === c && (c = 0);
                        this.m_count = b;
                        this.m_vertices = r.MakeArray(b);
                        for (var d = 0; d < b; ++d) this.m_vertices[d].Copy(a[c + d]);
                        this.m_hasNextVertex = this.m_hasPrevVertex = !1;
                        this.m_prevVertex.SetZero();
                        this.m_nextVertex.SetZero();
                        return this
                    };
                    b.prototype.SetPrevVertex = function(a) {
                        this.m_prevVertex.Copy(a);
                        this.m_hasPrevVertex = !0;
                        return this
                    };
                    b.prototype.SetNextVertex = function(a) {
                        this.m_nextVertex.Copy(a);
                        this.m_hasNextVertex = !0;
                        return this
                    };
                    b.prototype.Clone = function() {
                        return (new b).Copy(this)
                    };
                    b.prototype.Copy = function(b) {
                        a.prototype.Copy.call(this, b);
                        this.CreateChain(b.m_vertices, b.m_count);
                        this.m_prevVertex.Copy(b.m_prevVertex);
                        this.m_nextVertex.Copy(b.m_nextVertex);
                        this.m_hasPrevVertex = b.m_hasPrevVertex;
                        this.m_hasNextVertex = b.m_hasNextVertex;
                        return this
                    };
                    b.prototype.GetChildCount = function() {
                        return this.m_count - 1
                    };
                    b.prototype.GetChildEdge =
                        function(a, b) {
                            a.m_type = f.b2ShapeType.e_edgeShape;
                            a.m_radius = this.m_radius;
                            a.m_vertex1.Copy(this.m_vertices[b]);
                            a.m_vertex2.Copy(this.m_vertices[b + 1]);
                            0 < b ? (a.m_vertex0.Copy(this.m_vertices[b - 1]), a.m_hasVertex0 = !0) : (a.m_vertex0.Copy(this.m_prevVertex), a.m_hasVertex0 = this.m_hasPrevVertex);
                            b < this.m_count - 2 ? (a.m_vertex3.Copy(this.m_vertices[b + 2]), a.m_hasVertex3 = !0) : (a.m_vertex3.Copy(this.m_nextVertex), a.m_hasVertex3 = this.m_hasNextVertex)
                        };
                    b.prototype.TestPoint = function(a, b) {
                        return !1
                    };
                    b.prototype.ComputeDistance =
                        function(a, c, d, e) {
                            var f = b.ComputeDistance_s_edgeShape;
                            this.GetChildEdge(f, e);
                            return f.ComputeDistance(a, c, d, 0)
                        };
                    b.prototype.RayCast = function(a, c, d, e) {
                        var f = b.RayCast_s_edgeShape;
                        f.m_vertex1.Copy(this.m_vertices[e]);
                        f.m_vertex2.Copy(this.m_vertices[(e + 1) % this.m_count]);
                        return f.RayCast(a, c, d, 0)
                    };
                    b.prototype.ComputeAABB = function(a, c, d) {
                        var e = this.m_vertices[(d + 1) % this.m_count];
                        d = T.MulXV(c, this.m_vertices[d], b.ComputeAABB_s_v1);
                        c = T.MulXV(c, e, b.ComputeAABB_s_v2);
                        r.MinV(d, c, a.lowerBound);
                        r.MaxV(d, c, a.upperBound)
                    };
                    b.prototype.ComputeMass = function(a, b) {
                        a.mass = 0;
                        a.center.SetZero();
                        a.I = 0
                    };
                    b.prototype.SetupDistanceProxy = function(a, b) {
                        a.m_vertices = a.m_buffer;
                        a.m_vertices[0].Copy(this.m_vertices[b]);
                        b + 1 < this.m_count ? a.m_vertices[1].Copy(this.m_vertices[b + 1]) : a.m_vertices[1].Copy(this.m_vertices[0]);
                        a.m_count = 2;
                        a.m_radius = this.m_radius
                    };
                    b.prototype.ComputeSubmergedArea = function(a, b, c, d) {
                        d.SetZero();
                        return 0
                    };
                    b.prototype.Dump = function(a) {
                        a("    const shape: b2ChainShape = new b2ChainShape();\n");
                        a("    const vs: b2Vec2[] = b2Vec2.MakeArray(%d);\n",
                            8);
                        for (var b = 0; b < this.m_count; ++b) a("    vs[%d].Set(%.15f, %.15f);\n", b, this.m_vertices[b].x, this.m_vertices[b].y);
                        a("    shape.CreateChain(vs, %d);\n", this.m_count);
                        a("    shape.m_prevVertex.Set(%.15f, %.15f);\n", this.m_prevVertex.x, this.m_prevVertex.y);
                        a("    shape.m_nextVertex.Set(%.15f, %.15f);\n", this.m_nextVertex.x, this.m_nextVertex.y);
                        a("    shape.m_hasPrevVertex = %s;\n", this.m_hasPrevVertex ? "true" : "false");
                        a("    shape.m_hasNextVertex = %s;\n", this.m_hasNextVertex ? "true" : "false")
                    };
                    b.ComputeDistance_s_edgeShape =
                        new Ta;
                    b.RayCast_s_edgeShape = new Ta;
                    b.ComputeAABB_s_v1 = new r;
                    b.ComputeAABB_s_v2 = new r;
                    return b
                }(Ka), db = function() {
                    function a() {
                        this.categoryBits = 1;
                        this.maskBits = 65535;
                        this.groupIndex = 0
                    }
                    a.prototype.Clone = function() {
                        return (new a).Copy(this)
                    };
                    a.prototype.Copy = function(a) {
                        this.categoryBits = a.categoryBits;
                        this.maskBits = a.maskBits;
                        this.groupIndex = a.groupIndex || 0;
                        return this
                    };
                    a.DEFAULT = new a;
                    return a
                }(), Pb = function() {
                    return function() {
                        this.userData = null;
                        this.friction = .2;
                        this.density = this.restitution = 0;
                        this.isSensor = !1;
                        this.filter = new db
                    }
                }(), jb = function() {
                    return function(a) {
                        this.aabb = new ra;
                        this.childIndex = 0;
                        this.fixture = a
                    }
                }(), Qb = function() {
                    function a(a, b) {
                        this.m_density = 0;
                        this.m_next = null;
                        this.m_restitution = this.m_friction = 0;
                        this.m_proxies = [];
                        this.m_proxyCount = 0;
                        this.m_filter = new db;
                        this.m_isSensor = !1;
                        this.m_userData = null;
                        this.m_body = b;
                        this.m_shape = a.shape.Clone()
                    }
                    a.prototype.GetType = function() {
                        return this.m_shape.GetType()
                    };
                    a.prototype.GetShape = function() {
                        return this.m_shape
                    };
                    a.prototype.SetSensor = function(a) {
                        a !==
                            this.m_isSensor && (this.m_body.SetAwake(!0), this.m_isSensor = a)
                    };
                    a.prototype.IsSensor = function() {
                        return this.m_isSensor
                    };
                    a.prototype.SetFilterData = function(a) {
                        this.m_filter.Copy(a);
                        this.Refilter()
                    };
                    a.prototype.GetFilterData = function() {
                        return this.m_filter
                    };
                    a.prototype.Refilter = function() {
                        for (var a = this.m_body.GetContactList(); a;) {
                            var b = a.contact,
                                c = b.GetFixtureA(),
                                d = b.GetFixtureB();
                            c !== this && d !== this || b.FlagForFiltering();
                            a = a.next
                        }
                        a = this.m_body.GetWorld();
                        if (null !== a)
                            for (a = a.m_contactManager.m_broadPhase,
                                b = 0; b < this.m_proxyCount; ++b) a.TouchProxy(this.m_proxies[b].treeNode)
                    };
                    a.prototype.GetBody = function() {
                        return this.m_body
                    };
                    a.prototype.GetNext = function() {
                        return this.m_next
                    };
                    a.prototype.GetUserData = function() {
                        return this.m_userData
                    };
                    a.prototype.SetUserData = function(a) {
                        this.m_userData = a
                    };
                    a.prototype.TestPoint = function(a) {
                        return this.m_shape.TestPoint(this.m_body.GetTransform(), a)
                    };
                    a.prototype.ComputeDistance = function(a, b, c) {
                        return this.m_shape.ComputeDistance(this.m_body.GetTransform(), a, b, c)
                    };
                    a.prototype.RayCast =
                        function(a, b, c) {
                            return this.m_shape.RayCast(a, b, this.m_body.GetTransform(), c)
                        };
                    a.prototype.GetMassData = function(a) {
                        void 0 === a && (a = new cb);
                        this.m_shape.ComputeMass(a, this.m_density);
                        return a
                    };
                    a.prototype.SetDensity = function(a) {
                        this.m_density = a
                    };
                    a.prototype.GetDensity = function() {
                        return this.m_density
                    };
                    a.prototype.GetFriction = function() {
                        return this.m_friction
                    };
                    a.prototype.SetFriction = function(a) {
                        this.m_friction = a
                    };
                    a.prototype.GetRestitution = function() {
                        return this.m_restitution
                    };
                    a.prototype.SetRestitution =
                        function(a) {
                            this.m_restitution = a
                        };
                    a.prototype.GetAABB = function(a) {
                        return this.m_proxies[a].aabb
                    };
                    a.prototype.Dump = function(a, b) {
                        a("    const fd: b2FixtureDef = new b2FixtureDef();\n");
                        a("    fd.friction = %.15f;\n", this.m_friction);
                        a("    fd.restitution = %.15f;\n", this.m_restitution);
                        a("    fd.density = %.15f;\n", this.m_density);
                        a("    fd.isSensor = %s;\n", this.m_isSensor ? "true" : "false");
                        a("    fd.filter.categoryBits = %d;\n", this.m_filter.categoryBits);
                        a("    fd.filter.maskBits = %d;\n", this.m_filter.maskBits);
                        a("    fd.filter.groupIndex = %d;\n", this.m_filter.groupIndex);
                        this.m_shape.Dump(a);
                        a("\n");
                        a("    fd.shape = shape;\n");
                        a("\n");
                        a("    bodies[%d].CreateFixture(fd);\n", b)
                    };
                    a.prototype.Create = function(a) {
                        var c = this;
                        this.m_userData = a.userData;
                        this.m_friction = e(a.friction, .2);
                        this.m_restitution = e(a.restitution, 0);
                        this.m_next = null;
                        this.m_filter.Copy(e(a.filter, db.DEFAULT));
                        this.m_isSensor = e(a.isSensor, !1);
                        this.m_proxies = b(this.m_shape.GetChildCount(), function(a) {
                            return new jb(c)
                        });
                        this.m_proxyCount =
                            0;
                        this.m_density = e(a.density, 0)
                    };
                    a.prototype.Destroy = function() {};
                    a.prototype.CreateProxies = function(a) {
                        var b = this.m_body.m_world.m_contactManager.m_broadPhase;
                        this.m_proxyCount = this.m_shape.GetChildCount();
                        for (var c = 0; c < this.m_proxyCount; ++c) {
                            var d = this.m_proxies[c] = new jb(this);
                            this.m_shape.ComputeAABB(d.aabb, a, c);
                            d.treeNode = b.CreateProxy(d.aabb, d);
                            d.childIndex = c
                        }
                    };
                    a.prototype.DestroyProxies = function() {
                        for (var a = this.m_body.m_world.m_contactManager.m_broadPhase, b = 0; b < this.m_proxyCount; ++b) {
                            var c =
                                this.m_proxies[b];
                            delete c.treeNode.userData;
                            a.DestroyProxy(c.treeNode);
                            delete c.treeNode
                        }
                        this.m_proxyCount = 0
                    };
                    a.prototype.TouchProxies = function() {
                        for (var a = this.m_body.m_world.m_contactManager.m_broadPhase, b = this.m_proxyCount, c = 0; c < b; ++c) a.TouchProxy(this.m_proxies[c].treeNode)
                    };
                    a.prototype.Synchronize = function(b, c) {
                        if (0 !== this.m_proxyCount)
                            for (var d = this.m_body.m_world.m_contactManager.m_broadPhase, e = 0; e < this.m_proxyCount; ++e) {
                                var f = this.m_proxies[e],
                                    g = a.Synchronize_s_aabb1,
                                    h = a.Synchronize_s_aabb2;
                                this.m_shape.ComputeAABB(g, b, e);
                                this.m_shape.ComputeAABB(h, c, e);
                                f.aabb.Combine2(g, h);
                                g = r.SubVV(c.p, b.p, a.Synchronize_s_displacement);
                                d.MoveProxy(f.treeNode, f.aabb, g)
                            }
                    };
                    a.Synchronize_s_aabb1 = new ra;
                    a.Synchronize_s_aabb2 = new ra;
                    a.Synchronize_s_displacement = new r;
                    return a
                }();
            (function(a) {
                a[a.b2_unknown = -1] = "b2_unknown";
                a[a.b2_staticBody = 0] = "b2_staticBody";
                a[a.b2_kinematicBody = 1] = "b2_kinematicBody";
                a[a.b2_dynamicBody = 2] = "b2_dynamicBody"
            })(f.b2BodyType || (f.b2BodyType = {}));
            var Id = function() {
                    return function() {
                        this.type =
                            f.b2BodyType.b2_staticBody;
                        this.position = new r(0, 0);
                        this.angle = 0;
                        this.linearVelocity = new r(0, 0);
                        this.angularDamping = this.linearDamping = this.angularVelocity = 0;
                        this.awake = this.allowSleep = !0;
                        this.bullet = this.fixedRotation = !1;
                        this.active = !0;
                        this.userData = null;
                        this.gravityScale = 1
                    }
                }(),
                Rb = function() {
                    function a(a, b) {
                        this.m_type = f.b2BodyType.b2_staticBody;
                        this.m_toiFlag = this.m_activeFlag = this.m_fixedRotationFlag = this.m_bulletFlag = this.m_autoSleepFlag = this.m_awakeFlag = this.m_islandFlag = !1;
                        this.m_islandIndex =
                            0;
                        this.m_xf = new T;
                        this.m_xf0 = new T;
                        this.m_sweep = new pa;
                        this.m_linearVelocity = new r;
                        this.m_angularVelocity = 0;
                        this.m_force = new r;
                        this.m_torque = 0;
                        this.m_fixtureList = this.m_next = this.m_prev = null;
                        this.m_fixtureCount = 0;
                        this.m_contactList = this.m_jointList = null;
                        this.m_invMass = this.m_mass = 1;
                        this.m_angularDamping = this.m_linearDamping = this.m_invI = this.m_I = 0;
                        this.m_gravityScale = 1;
                        this.m_sleepTime = 0;
                        this.m_controllerList = this.m_userData = null;
                        this.m_controllerCount = 0;
                        this.m_bulletFlag = e(a.bullet, !1);
                        this.m_fixedRotationFlag =
                            e(a.fixedRotation, !1);
                        this.m_autoSleepFlag = e(a.allowSleep, !0);
                        this.m_awakeFlag = e(a.awake, !0);
                        this.m_activeFlag = e(a.active, !0);
                        this.m_world = b;
                        this.m_xf.p.Copy(e(a.position, r.ZERO));
                        this.m_xf.q.SetAngle(e(a.angle, 0));
                        this.m_xf0.Copy(this.m_xf);
                        this.m_sweep.localCenter.SetZero();
                        this.m_sweep.c0.Copy(this.m_xf.p);
                        this.m_sweep.c.Copy(this.m_xf.p);
                        this.m_sweep.a0 = this.m_sweep.a = this.m_xf.q.GetAngle();
                        this.m_sweep.alpha0 = 0;
                        this.m_linearVelocity.Copy(e(a.linearVelocity, r.ZERO));
                        this.m_angularVelocity = e(a.angularVelocity,
                            0);
                        this.m_linearDamping = e(a.linearDamping, 0);
                        this.m_angularDamping = e(a.angularDamping, 0);
                        this.m_gravityScale = e(a.gravityScale, 1);
                        this.m_force.SetZero();
                        this.m_sleepTime = this.m_torque = 0;
                        this.m_type = e(a.type, f.b2BodyType.b2_staticBody);
                        this.m_invMass = a.type === f.b2BodyType.b2_dynamicBody ? this.m_mass = 1 : this.m_mass = 0;
                        this.m_invI = this.m_I = 0;
                        this.m_userData = a.userData;
                        this.m_fixtureList = null;
                        this.m_fixtureCount = 0;
                        this.m_controllerList = null;
                        this.m_controllerCount = 0
                    }
                    a.prototype.CreateFixture = function(a, b) {
                        void 0 ===
                            b && (b = 0);
                        return a instanceof Ka ? this.CreateFixtureShapeDensity(a, b) : this.CreateFixtureDef(a)
                    };
                    a.prototype.CreateFixtureDef = function(a) {
                        if (this.m_world.IsLocked()) throw Error();
                        var b = new Qb(a, this);
                        b.Create(a);
                        this.m_activeFlag && b.CreateProxies(this.m_xf);
                        b.m_next = this.m_fixtureList;
                        this.m_fixtureList = b;
                        ++this.m_fixtureCount;
                        0 < b.m_density && this.ResetMassData();
                        this.m_world.m_newFixture = !0;
                        return b
                    };
                    a.prototype.CreateFixtureShapeDensity = function(b, c) {
                        void 0 === c && (c = 0);
                        var d = a.CreateFixtureShapeDensity_s_def;
                        d.shape = b;
                        d.density = c;
                        return this.CreateFixtureDef(d)
                    };
                    a.prototype.DestroyFixture = function(a) {
                        if (this.m_world.IsLocked()) throw Error();
                        for (var b = this.m_fixtureList, c = null; null !== b;) {
                            if (b === a) {
                                c ? c.m_next = a.m_next : this.m_fixtureList = a.m_next;
                                break
                            }
                            c = b;
                            b = b.m_next
                        }
                        for (b = this.m_contactList; b;) {
                            c = b.contact;
                            b = b.next;
                            var d = c.GetFixtureA(),
                                e = c.GetFixtureB();
                            a !== d && a !== e || this.m_world.m_contactManager.Destroy(c)
                        }
                        this.m_activeFlag && a.DestroyProxies();
                        a.m_next = null;
                        a.Destroy();
                        --this.m_fixtureCount;
                        this.ResetMassData()
                    };
                    a.prototype.SetTransformVec = function(a, b) {
                        this.SetTransformXY(a.x, a.y, b)
                    };
                    a.prototype.SetTransformXY = function(a, b, c) {
                        if (this.m_world.IsLocked()) throw Error();
                        this.m_xf.q.SetAngle(c);
                        this.m_xf.p.Set(a, b);
                        this.m_xf0.Copy(this.m_xf);
                        T.MulXV(this.m_xf, this.m_sweep.localCenter, this.m_sweep.c);
                        this.m_sweep.a = c;
                        this.m_sweep.c0.Copy(this.m_sweep.c);
                        this.m_sweep.a0 = c;
                        for (a = this.m_fixtureList; a; a = a.m_next) a.Synchronize(this.m_xf, this.m_xf);
                        this.m_world.m_contactManager.FindNewContacts()
                    };
                    a.prototype.SetTransform =
                        function(a) {
                            this.SetTransformVec(a.p, a.GetAngle())
                        };
                    a.prototype.GetTransform = function() {
                        return this.m_xf
                    };
                    a.prototype.GetPosition = function() {
                        return this.m_xf.p
                    };
                    a.prototype.SetPosition = function(a) {
                        this.SetTransformVec(a, this.GetAngle())
                    };
                    a.prototype.SetPositionXY = function(a, b) {
                        this.SetTransformXY(a, b, this.GetAngle())
                    };
                    a.prototype.GetAngle = function() {
                        return this.m_sweep.a
                    };
                    a.prototype.SetAngle = function(a) {
                        this.SetTransformVec(this.GetPosition(), a)
                    };
                    a.prototype.GetWorldCenter = function() {
                        return this.m_sweep.c
                    };
                    a.prototype.GetLocalCenter = function() {
                        return this.m_sweep.localCenter
                    };
                    a.prototype.SetLinearVelocity = function(a) {
                        this.m_type !== f.b2BodyType.b2_staticBody && (0 < r.DotVV(a, a) && this.SetAwake(!0), this.m_linearVelocity.Copy(a))
                    };
                    a.prototype.GetLinearVelocity = function() {
                        return this.m_linearVelocity
                    };
                    a.prototype.SetAngularVelocity = function(a) {
                        this.m_type !== f.b2BodyType.b2_staticBody && (0 < a * a && this.SetAwake(!0), this.m_angularVelocity = a)
                    };
                    a.prototype.GetAngularVelocity = function() {
                        return this.m_angularVelocity
                    };
                    a.prototype.GetDefinition = function(a) {
                        a.type = this.GetType();
                        a.allowSleep = this.m_autoSleepFlag;
                        a.angle = this.GetAngle();
                        a.angularDamping = this.m_angularDamping;
                        a.gravityScale = this.m_gravityScale;
                        a.angularVelocity = this.m_angularVelocity;
                        a.fixedRotation = this.m_fixedRotationFlag;
                        a.bullet = this.m_bulletFlag;
                        a.awake = this.m_awakeFlag;
                        a.linearDamping = this.m_linearDamping;
                        a.linearVelocity.Copy(this.GetLinearVelocity());
                        a.position.Copy(this.GetPosition());
                        a.userData = this.GetUserData();
                        return a
                    };
                    a.prototype.ApplyForce =
                        function(a, b, c) {
                            void 0 === c && (c = !0);
                            this.m_type === f.b2BodyType.b2_dynamicBody && (c && !this.m_awakeFlag && this.SetAwake(!0), this.m_awakeFlag && (this.m_force.x += a.x, this.m_force.y += a.y, this.m_torque += (b.x - this.m_sweep.c.x) * a.y - (b.y - this.m_sweep.c.y) * a.x))
                        };
                    a.prototype.ApplyForceToCenter = function(a, b) {
                        void 0 === b && (b = !0);
                        this.m_type === f.b2BodyType.b2_dynamicBody && (b && !this.m_awakeFlag && this.SetAwake(!0), this.m_awakeFlag && (this.m_force.x += a.x, this.m_force.y += a.y))
                    };
                    a.prototype.ApplyTorque = function(a, b) {
                        void 0 ===
                            b && (b = !0);
                        this.m_type === f.b2BodyType.b2_dynamicBody && (b && !this.m_awakeFlag && this.SetAwake(!0), this.m_awakeFlag && (this.m_torque += a))
                    };
                    a.prototype.ApplyLinearImpulse = function(a, b, c) {
                        void 0 === c && (c = !0);
                        this.m_type === f.b2BodyType.b2_dynamicBody && (c && !this.m_awakeFlag && this.SetAwake(!0), this.m_awakeFlag && (this.m_linearVelocity.x += this.m_invMass * a.x, this.m_linearVelocity.y += this.m_invMass * a.y, this.m_angularVelocity += this.m_invI * ((b.x - this.m_sweep.c.x) * a.y - (b.y - this.m_sweep.c.y) * a.x)))
                    };
                    a.prototype.ApplyLinearImpulseToCenter =
                        function(a, b) {
                            void 0 === b && (b = !0);
                            this.m_type === f.b2BodyType.b2_dynamicBody && (b && !this.m_awakeFlag && this.SetAwake(!0), this.m_awakeFlag && (this.m_linearVelocity.x += this.m_invMass * a.x, this.m_linearVelocity.y += this.m_invMass * a.y))
                        };
                    a.prototype.ApplyAngularImpulse = function(a, b) {
                        void 0 === b && (b = !0);
                        this.m_type === f.b2BodyType.b2_dynamicBody && (b && !this.m_awakeFlag && this.SetAwake(!0), this.m_awakeFlag && (this.m_angularVelocity += this.m_invI * a))
                    };
                    a.prototype.GetMass = function() {
                        return this.m_mass
                    };
                    a.prototype.GetInertia =
                        function() {
                            return this.m_I + this.m_mass * r.DotVV(this.m_sweep.localCenter, this.m_sweep.localCenter)
                        };
                    a.prototype.GetMassData = function(a) {
                        a.mass = this.m_mass;
                        a.I = this.m_I + this.m_mass * r.DotVV(this.m_sweep.localCenter, this.m_sweep.localCenter);
                        a.center.Copy(this.m_sweep.localCenter);
                        return a
                    };
                    a.prototype.SetMassData = function(b) {
                        if (this.m_world.IsLocked()) throw Error();
                        if (this.m_type === f.b2BodyType.b2_dynamicBody) {
                            this.m_invI = this.m_I = this.m_invMass = 0;
                            this.m_mass = b.mass;
                            0 >= this.m_mass && (this.m_mass = 1);
                            this.m_invMass =
                                1 / this.m_mass;
                            0 < b.I && !this.m_fixedRotationFlag && (this.m_I = b.I - this.m_mass * r.DotVV(b.center, b.center), this.m_invI = 1 / this.m_I);
                            var c = a.SetMassData_s_oldCenter.Copy(this.m_sweep.c);
                            this.m_sweep.localCenter.Copy(b.center);
                            T.MulXV(this.m_xf, this.m_sweep.localCenter, this.m_sweep.c);
                            this.m_sweep.c0.Copy(this.m_sweep.c);
                            r.AddVCrossSV(this.m_linearVelocity, this.m_angularVelocity, r.SubVV(this.m_sweep.c, c, r.s_t0), this.m_linearVelocity)
                        }
                    };
                    a.prototype.ResetMassData = function() {
                        this.m_invI = this.m_I = this.m_invMass =
                            this.m_mass = 0;
                        this.m_sweep.localCenter.SetZero();
                        if (this.m_type === f.b2BodyType.b2_staticBody || this.m_type === f.b2BodyType.b2_kinematicBody) this.m_sweep.c0.Copy(this.m_xf.p), this.m_sweep.c.Copy(this.m_xf.p), this.m_sweep.a0 = this.m_sweep.a;
                        else {
                            for (var b = a.ResetMassData_s_localCenter.SetZero(), c = this.m_fixtureList; c; c = c.m_next)
                                if (0 !== c.m_density) {
                                    var d = c.GetMassData(a.ResetMassData_s_massData);
                                    this.m_mass += d.mass;
                                    b.x += d.center.x * d.mass;
                                    b.y += d.center.y * d.mass;
                                    this.m_I += d.I
                                }
                            0 < this.m_mass ? (this.m_invMass =
                                1 / this.m_mass, b.x *= this.m_invMass, b.y *= this.m_invMass) : this.m_invMass = this.m_mass = 1;
                            0 < this.m_I && !this.m_fixedRotationFlag ? (this.m_I -= this.m_mass * r.DotVV(b, b), this.m_invI = 1 / this.m_I) : this.m_invI = this.m_I = 0;
                            c = a.ResetMassData_s_oldCenter.Copy(this.m_sweep.c);
                            this.m_sweep.localCenter.Copy(b);
                            T.MulXV(this.m_xf, this.m_sweep.localCenter, this.m_sweep.c);
                            this.m_sweep.c0.Copy(this.m_sweep.c);
                            r.AddVCrossSV(this.m_linearVelocity, this.m_angularVelocity, r.SubVV(this.m_sweep.c, c, r.s_t0), this.m_linearVelocity)
                        }
                    };
                    a.prototype.GetWorldPoint = function(a, b) {
                        return T.MulXV(this.m_xf, a, b)
                    };
                    a.prototype.GetWorldVector = function(a, b) {
                        return N.MulRV(this.m_xf.q, a, b)
                    };
                    a.prototype.GetLocalPoint = function(a, b) {
                        return T.MulTXV(this.m_xf, a, b)
                    };
                    a.prototype.GetLocalVector = function(a, b) {
                        return N.MulTRV(this.m_xf.q, a, b)
                    };
                    a.prototype.GetLinearVelocityFromWorldPoint = function(a, b) {
                        return r.AddVCrossSV(this.m_linearVelocity, this.m_angularVelocity, r.SubVV(a, this.m_sweep.c, r.s_t0), b)
                    };
                    a.prototype.GetLinearVelocityFromLocalPoint = function(a,
                        b) {
                        return this.GetLinearVelocityFromWorldPoint(this.GetWorldPoint(a, b), b)
                    };
                    a.prototype.GetLinearDamping = function() {
                        return this.m_linearDamping
                    };
                    a.prototype.SetLinearDamping = function(a) {
                        this.m_linearDamping = a
                    };
                    a.prototype.GetAngularDamping = function() {
                        return this.m_angularDamping
                    };
                    a.prototype.SetAngularDamping = function(a) {
                        this.m_angularDamping = a
                    };
                    a.prototype.GetGravityScale = function() {
                        return this.m_gravityScale
                    };
                    a.prototype.SetGravityScale = function(a) {
                        this.m_gravityScale = a
                    };
                    a.prototype.SetType = function(a) {
                        if (this.m_world.IsLocked()) throw Error();
                        if (this.m_type !== a) {
                            this.m_type = a;
                            this.ResetMassData();
                            this.m_type === f.b2BodyType.b2_staticBody && (this.m_linearVelocity.SetZero(), this.m_angularVelocity = 0, this.m_sweep.a0 = this.m_sweep.a, this.m_sweep.c0.Copy(this.m_sweep.c), this.SynchronizeFixtures());
                            this.SetAwake(!0);
                            this.m_force.SetZero();
                            this.m_torque = 0;
                            for (a = this.m_contactList; a;) {
                                var b = a;
                                a = a.next;
                                this.m_world.m_contactManager.Destroy(b.contact)
                            }
                            this.m_contactList = null;
                            for (a = this.m_fixtureList; a; a = a.m_next) a.TouchProxies()
                        }
                    };
                    a.prototype.GetType =
                        function() {
                            return this.m_type
                        };
                    a.prototype.SetBullet = function(a) {
                        this.m_bulletFlag = a
                    };
                    a.prototype.IsBullet = function() {
                        return this.m_bulletFlag
                    };
                    a.prototype.SetSleepingAllowed = function(a) {
                        (this.m_autoSleepFlag = a) || this.SetAwake(!0)
                    };
                    a.prototype.IsSleepingAllowed = function() {
                        return this.m_autoSleepFlag
                    };
                    a.prototype.SetAwake = function(a) {
                        a ? (this.m_awakeFlag = !0, this.m_sleepTime = 0) : (this.m_awakeFlag = !1, this.m_sleepTime = 0, this.m_linearVelocity.SetZero(), this.m_angularVelocity = 0, this.m_force.SetZero(), this.m_torque =
                            0)
                    };
                    a.prototype.IsAwake = function() {
                        return this.m_awakeFlag
                    };
                    a.prototype.SetActive = function(a) {
                        if (this.m_world.IsLocked()) throw Error();
                        if (a !== this.IsActive())
                            if (this.m_activeFlag = a)
                                for (a = this.m_fixtureList; a; a = a.m_next) a.CreateProxies(this.m_xf);
                            else {
                                for (a = this.m_fixtureList; a; a = a.m_next) a.DestroyProxies();
                                for (a = this.m_contactList; a;) {
                                    var b = a;
                                    a = a.next;
                                    this.m_world.m_contactManager.Destroy(b.contact)
                                }
                                this.m_contactList = null
                            }
                    };
                    a.prototype.IsActive = function() {
                        return this.m_activeFlag
                    };
                    a.prototype.SetFixedRotation =
                        function(a) {
                            this.m_fixedRotationFlag !== a && (this.m_fixedRotationFlag = a, this.m_angularVelocity = 0, this.ResetMassData())
                        };
                    a.prototype.IsFixedRotation = function() {
                        return this.m_fixedRotationFlag
                    };
                    a.prototype.GetFixtureList = function() {
                        return this.m_fixtureList
                    };
                    a.prototype.GetJointList = function() {
                        return this.m_jointList
                    };
                    a.prototype.GetContactList = function() {
                        return this.m_contactList
                    };
                    a.prototype.GetNext = function() {
                        return this.m_next
                    };
                    a.prototype.GetUserData = function() {
                        return this.m_userData
                    };
                    a.prototype.SetUserData =
                        function(a) {
                            this.m_userData = a
                        };
                    a.prototype.GetWorld = function() {
                        return this.m_world
                    };
                    a.prototype.Dump = function(a) {
                        var b = this.m_islandIndex;
                        a("{\n");
                        a("  const bd: b2BodyDef = new b2BodyDef();\n");
                        var c = "";
                        switch (this.m_type) {
                            case f.b2BodyType.b2_staticBody:
                                c = "b2BodyType.b2_staticBody";
                                break;
                            case f.b2BodyType.b2_kinematicBody:
                                c = "b2BodyType.b2_kinematicBody";
                                break;
                            case f.b2BodyType.b2_dynamicBody:
                                c = "b2BodyType.b2_dynamicBody"
                        }
                        a("  bd.type = %s;\n", c);
                        a("  bd.position.Set(%.15f, %.15f);\n", this.m_xf.p.x,
                            this.m_xf.p.y);
                        a("  bd.angle = %.15f;\n", this.m_sweep.a);
                        a("  bd.linearVelocity.Set(%.15f, %.15f);\n", this.m_linearVelocity.x, this.m_linearVelocity.y);
                        a("  bd.angularVelocity = %.15f;\n", this.m_angularVelocity);
                        a("  bd.linearDamping = %.15f;\n", this.m_linearDamping);
                        a("  bd.angularDamping = %.15f;\n", this.m_angularDamping);
                        a("  bd.allowSleep = %s;\n", this.m_autoSleepFlag ? "true" : "false");
                        a("  bd.awake = %s;\n", this.m_awakeFlag ? "true" : "false");
                        a("  bd.fixedRotation = %s;\n", this.m_fixedRotationFlag ?
                            "true" : "false");
                        a("  bd.bullet = %s;\n", this.m_bulletFlag ? "true" : "false");
                        a("  bd.active = %s;\n", this.m_activeFlag ? "true" : "false");
                        a("  bd.gravityScale = %.15f;\n", this.m_gravityScale);
                        a("\n");
                        a("  bodies[%d] = this.m_world.CreateBody(bd);\n", this.m_islandIndex);
                        a("\n");
                        for (c = this.m_fixtureList; c; c = c.m_next) a("  {\n"), c.Dump(a, b), a("  }\n");
                        a("}\n")
                    };
                    a.prototype.SynchronizeFixtures = function() {
                        var b = a.SynchronizeFixtures_s_xf1;
                        b.q.SetAngle(this.m_sweep.a0);
                        N.MulRV(b.q, this.m_sweep.localCenter, b.p);
                        r.SubVV(this.m_sweep.c0, b.p, b.p);
                        for (var c = this.m_fixtureList; c; c = c.m_next) c.Synchronize(b, this.m_xf)
                    };
                    a.prototype.SynchronizeTransform = function() {
                        this.m_xf.q.SetAngle(this.m_sweep.a);
                        N.MulRV(this.m_xf.q, this.m_sweep.localCenter, this.m_xf.p);
                        r.SubVV(this.m_sweep.c, this.m_xf.p, this.m_xf.p)
                    };
                    a.prototype.ShouldCollide = function(a) {
                        return this.m_type === f.b2BodyType.b2_staticBody && a.m_type === f.b2BodyType.b2_staticBody ? !1 : this.ShouldCollideConnected(a)
                    };
                    a.prototype.ShouldCollideConnected = function(a) {
                        for (var b =
                                this.m_jointList; b; b = b.next)
                            if (b.other === a && !b.joint.m_collideConnected) return !1;
                        return !0
                    };
                    a.prototype.Advance = function(a) {
                        this.m_sweep.Advance(a);
                        this.m_sweep.c.Copy(this.m_sweep.c0);
                        this.m_sweep.a = this.m_sweep.a0;
                        this.m_xf.q.SetAngle(this.m_sweep.a);
                        N.MulRV(this.m_xf.q, this.m_sweep.localCenter, this.m_xf.p);
                        r.SubVV(this.m_sweep.c, this.m_xf.p, this.m_xf.p)
                    };
                    a.prototype.GetControllerList = function() {
                        return this.m_controllerList
                    };
                    a.prototype.GetControllerCount = function() {
                        return this.m_controllerCount
                    };
                    a.CreateFixtureShapeDensity_s_def = new Pb;
                    a.SetMassData_s_oldCenter = new r;
                    a.ResetMassData_s_localCenter = new r;
                    a.ResetMassData_s_oldCenter = new r;
                    a.ResetMassData_s_massData = new cb;
                    a.SynchronizeFixtures_s_xf1 = new T;
                    return a
                }();
            (function(a) {
                a[a.e_unknownJoint = 0] = "e_unknownJoint";
                a[a.e_revoluteJoint = 1] = "e_revoluteJoint";
                a[a.e_prismaticJoint = 2] = "e_prismaticJoint";
                a[a.e_distanceJoint = 3] = "e_distanceJoint";
                a[a.e_pulleyJoint = 4] = "e_pulleyJoint";
                a[a.e_mouseJoint = 5] = "e_mouseJoint";
                a[a.e_gearJoint = 6] = "e_gearJoint";
                a[a.e_wheelJoint = 7] = "e_wheelJoint";
                a[a.e_weldJoint = 8] = "e_weldJoint";
                a[a.e_frictionJoint = 9] = "e_frictionJoint";
                a[a.e_ropeJoint = 10] = "e_ropeJoint";
                a[a.e_motorJoint = 11] = "e_motorJoint";
                a[a.e_areaJoint = 12] = "e_areaJoint"
            })(f.b2JointType || (f.b2JointType = {}));
            (function(a) {
                a[a.e_inactiveLimit = 0] = "e_inactiveLimit";
                a[a.e_atLowerLimit = 1] = "e_atLowerLimit";
                a[a.e_atUpperLimit = 2] = "e_atUpperLimit";
                a[a.e_equalLimits = 3] = "e_equalLimits"
            })(f.b2LimitState || (f.b2LimitState = {}));
            var Jd = function() {
                    function a() {
                        this.linear =
                            new r;
                        this.angularB = this.angularA = 0
                    }
                    a.prototype.SetZero = function() {
                        this.linear.SetZero();
                        this.angularB = this.angularA = 0;
                        return this
                    };
                    a.prototype.Set = function(a, b, c) {
                        this.linear.Copy(a);
                        this.angularA = b;
                        this.angularB = c;
                        return this
                    };
                    return a
                }(),
                kb = function() {
                    return function(a, b) {
                        this.next = this.prev = null;
                        this.joint = a;
                        this.other = b
                    }
                }(),
                va = function() {
                    return function(a) {
                        this.type = f.b2JointType.e_unknownJoint;
                        this.userData = null;
                        this.collideConnected = !1;
                        this.type = a
                    }
                }(),
                wa = function() {
                    function a(a) {
                        this.m_type =
                            f.b2JointType.e_unknownJoint;
                        this.m_next = this.m_prev = null;
                        this.m_index = 0;
                        this.m_collideConnected = this.m_islandFlag = !1;
                        this.m_userData = null;
                        this.m_type = a.type;
                        this.m_edgeA = new kb(this, a.bodyB);
                        this.m_edgeB = new kb(this, a.bodyA);
                        this.m_bodyA = a.bodyA;
                        this.m_bodyB = a.bodyB;
                        this.m_collideConnected = e(a.collideConnected, !1);
                        this.m_userData = a.userData
                    }
                    a.prototype.GetType = function() {
                        return this.m_type
                    };
                    a.prototype.GetBodyA = function() {
                        return this.m_bodyA
                    };
                    a.prototype.GetBodyB = function() {
                        return this.m_bodyB
                    };
                    a.prototype.GetNext = function() {
                        return this.m_next
                    };
                    a.prototype.GetUserData = function() {
                        return this.m_userData
                    };
                    a.prototype.SetUserData = function(a) {
                        this.m_userData = a
                    };
                    a.prototype.IsActive = function() {
                        return this.m_bodyA.IsActive() && this.m_bodyB.IsActive()
                    };
                    a.prototype.GetCollideConnected = function() {
                        return this.m_collideConnected
                    };
                    a.prototype.Dump = function(a) {
                        a("// Dump is not supported for this joint type.\n")
                    };
                    a.prototype.ShiftOrigin = function(a) {};
                    return a
                }(),
                Sb = function(a) {
                    function b() {
                        var b = a.call(this,
                            f.b2JointType.e_distanceJoint) || this;
                        b.localAnchorA = new r;
                        b.localAnchorB = new r;
                        b.length = 1;
                        b.frequencyHz = 0;
                        b.dampingRatio = 0;
                        return b
                    }
                    C(b, a);
                    b.prototype.Initialize = function(a, b, c, d) {
                        this.bodyA = a;
                        this.bodyB = b;
                        this.bodyA.GetLocalPoint(c, this.localAnchorA);
                        this.bodyB.GetLocalPoint(d, this.localAnchorB);
                        this.length = r.DistanceVV(c, d);
                        this.dampingRatio = this.frequencyHz = 0
                    };
                    return b
                }(va),
                Tb = function(a) {
                    function b(b) {
                        var c = a.call(this, b) || this;
                        c.m_frequencyHz = 0;
                        c.m_dampingRatio = 0;
                        c.m_bias = 0;
                        c.m_localAnchorA =
                            new r;
                        c.m_localAnchorB = new r;
                        c.m_gamma = 0;
                        c.m_impulse = 0;
                        c.m_length = 0;
                        c.m_indexA = 0;
                        c.m_indexB = 0;
                        c.m_u = new r;
                        c.m_rA = new r;
                        c.m_rB = new r;
                        c.m_localCenterA = new r;
                        c.m_localCenterB = new r;
                        c.m_invMassA = 0;
                        c.m_invMassB = 0;
                        c.m_invIA = 0;
                        c.m_invIB = 0;
                        c.m_mass = 0;
                        c.m_qA = new N;
                        c.m_qB = new N;
                        c.m_lalcA = new r;
                        c.m_lalcB = new r;
                        c.m_frequencyHz = e(b.frequencyHz, 0);
                        c.m_dampingRatio = e(b.dampingRatio, 0);
                        c.m_localAnchorA.Copy(b.localAnchorA);
                        c.m_localAnchorB.Copy(b.localAnchorB);
                        c.m_length = b.length;
                        return c
                    }
                    C(b, a);
                    b.prototype.GetAnchorA =
                        function(a) {
                            return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, a)
                        };
                    b.prototype.GetAnchorB = function(a) {
                        return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, a)
                    };
                    b.prototype.GetReactionForce = function(a, b) {
                        b.x = a * this.m_impulse * this.m_u.x;
                        b.y = a * this.m_impulse * this.m_u.y;
                        return b
                    };
                    b.prototype.GetReactionTorque = function(a) {
                        return 0
                    };
                    b.prototype.GetLocalAnchorA = function() {
                        return this.m_localAnchorA
                    };
                    b.prototype.GetLocalAnchorB = function() {
                        return this.m_localAnchorB
                    };
                    b.prototype.SetLength = function(a) {
                        this.m_length =
                            a
                    };
                    b.prototype.Length = function() {
                        return this.m_length
                    };
                    b.prototype.SetFrequency = function(a) {
                        this.m_frequencyHz = a
                    };
                    b.prototype.GetFrequency = function() {
                        return this.m_frequencyHz
                    };
                    b.prototype.SetDampingRatio = function(a) {
                        this.m_dampingRatio = a
                    };
                    b.prototype.GetDampingRatio = function() {
                        return this.m_dampingRatio
                    };
                    b.prototype.Dump = function(a) {
                        var b = this.m_bodyA.m_islandIndex,
                            c = this.m_bodyB.m_islandIndex;
                        a("  const jd: b2DistanceJointDef = new b2DistanceJointDef();\n");
                        a("  jd.bodyA = bodies[%d];\n", b);
                        a("  jd.bodyB = bodies[%d];\n",
                            c);
                        a("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false");
                        a("  jd.localAnchorA.Set(%.15f, %.15f);\n", this.m_localAnchorA.x, this.m_localAnchorA.y);
                        a("  jd.localAnchorB.Set(%.15f, %.15f);\n", this.m_localAnchorB.x, this.m_localAnchorB.y);
                        a("  jd.length = %.15f;\n", this.m_length);
                        a("  jd.frequencyHz = %.15f;\n", this.m_frequencyHz);
                        a("  jd.dampingRatio = %.15f;\n", this.m_dampingRatio);
                        a("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index)
                    };
                    b.prototype.InitVelocityConstraints =
                        function(a) {
                            this.m_indexA = this.m_bodyA.m_islandIndex;
                            this.m_indexB = this.m_bodyB.m_islandIndex;
                            this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);
                            this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);
                            this.m_invMassA = this.m_bodyA.m_invMass;
                            this.m_invMassB = this.m_bodyB.m_invMass;
                            this.m_invIA = this.m_bodyA.m_invI;
                            this.m_invIB = this.m_bodyB.m_invI;
                            var c = a.positions[this.m_indexA].c,
                                d = a.velocities[this.m_indexA].v,
                                e = a.velocities[this.m_indexA].w,
                                f = a.positions[this.m_indexB].c,
                                g = a.positions[this.m_indexB].a,
                                h = a.velocities[this.m_indexB].v,
                                k = a.velocities[this.m_indexB].w,
                                l = this.m_qA.SetAngle(a.positions[this.m_indexA].a);
                            g = this.m_qB.SetAngle(g);
                            r.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                            N.MulRV(l, this.m_lalcA, this.m_rA);
                            r.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                            N.MulRV(g, this.m_lalcB, this.m_rB);
                            this.m_u.x = f.x + this.m_rB.x - c.x - this.m_rA.x;
                            this.m_u.y = f.y + this.m_rB.y - c.y - this.m_rA.y;
                            f = this.m_u.Length();
                            .008 < f ? this.m_u.SelfMul(1 / f) : this.m_u.SetZero();
                            c = r.CrossVV(this.m_rA,
                                this.m_u);
                            l = r.CrossVV(this.m_rB, this.m_u);
                            c = this.m_invMassA + this.m_invIA * c * c + this.m_invMassB + this.m_invIB * l * l;
                            this.m_mass = 0 !== c ? 1 / c : 0;
                            if (0 < this.m_frequencyHz) {
                                f -= this.m_length;
                                l = 6.28318530718 * this.m_frequencyHz;
                                g = this.m_mass * l * l;
                                var m = a.step.dt;
                                this.m_gamma = m * (2 * this.m_mass * this.m_dampingRatio * l + m * g);
                                this.m_gamma = 0 !== this.m_gamma ? 1 / this.m_gamma : 0;
                                this.m_bias = f * m * g * this.m_gamma;
                                c += this.m_gamma;
                                this.m_mass = 0 !== c ? 1 / c : 0
                            } else this.m_bias = this.m_gamma = 0;
                            a.step.warmStarting ? (this.m_impulse *= a.step.dtRatio,
                                c = r.MulSV(this.m_impulse, this.m_u, b.InitVelocityConstraints_s_P), d.SelfMulSub(this.m_invMassA, c), e -= this.m_invIA * r.CrossVV(this.m_rA, c), h.SelfMulAdd(this.m_invMassB, c), k += this.m_invIB * r.CrossVV(this.m_rB, c)) : this.m_impulse = 0;
                            a.velocities[this.m_indexA].w = e;
                            a.velocities[this.m_indexB].w = k
                        };
                    b.prototype.SolveVelocityConstraints = function(a) {
                        var c = a.velocities[this.m_indexA].v,
                            d = a.velocities[this.m_indexA].w,
                            e = a.velocities[this.m_indexB].v,
                            f = a.velocities[this.m_indexB].w,
                            g = r.AddVCrossSV(c, d, this.m_rA,
                                b.SolveVelocityConstraints_s_vpA),
                            h = r.AddVCrossSV(e, f, this.m_rB, b.SolveVelocityConstraints_s_vpB);
                        g = r.DotVV(this.m_u, r.SubVV(h, g, r.s_t0));
                        g = -this.m_mass * (g + this.m_bias + this.m_gamma * this.m_impulse);
                        this.m_impulse += g;
                        g = r.MulSV(g, this.m_u, b.SolveVelocityConstraints_s_P);
                        c.SelfMulSub(this.m_invMassA, g);
                        d -= this.m_invIA * r.CrossVV(this.m_rA, g);
                        e.SelfMulAdd(this.m_invMassB, g);
                        f += this.m_invIB * r.CrossVV(this.m_rB, g);
                        a.velocities[this.m_indexA].w = d;
                        a.velocities[this.m_indexB].w = f
                    };
                    b.prototype.SolvePositionConstraints =
                        function(a) {
                            if (0 < this.m_frequencyHz) return !0;
                            var d = a.positions[this.m_indexA].c,
                                e = a.positions[this.m_indexA].a,
                                f = a.positions[this.m_indexB].c,
                                g = a.positions[this.m_indexB].a,
                                h = this.m_qA.SetAngle(e),
                                k = this.m_qB.SetAngle(g);
                            h = N.MulRV(h, this.m_lalcA, this.m_rA);
                            k = N.MulRV(k, this.m_lalcB, this.m_rB);
                            var l = this.m_u;
                            l.x = f.x + k.x - d.x - h.x;
                            l.y = f.y + k.y - d.y - h.y;
                            var m = this.m_u.Normalize() - this.m_length;
                            m = c(m, -.2, .2);
                            l = r.MulSV(-this.m_mass * m, l, b.SolvePositionConstraints_s_P);
                            d.SelfMulSub(this.m_invMassA, l);
                            e -= this.m_invIA *
                                r.CrossVV(h, l);
                            f.SelfMulAdd(this.m_invMassB, l);
                            g += this.m_invIB * r.CrossVV(k, l);
                            a.positions[this.m_indexA].a = e;
                            a.positions[this.m_indexB].a = g;
                            return .008 > ba(m)
                        };
                    b.InitVelocityConstraints_s_P = new r;
                    b.SolveVelocityConstraints_s_vpA = new r;
                    b.SolveVelocityConstraints_s_vpB = new r;
                    b.SolveVelocityConstraints_s_P = new r;
                    b.SolvePositionConstraints_s_P = new r;
                    return b
                }(wa),
                Kd = function(a) {
                    function b() {
                        var b = a.call(this, f.b2JointType.e_areaJoint) || this;
                        b.bodies = [];
                        b.frequencyHz = 0;
                        b.dampingRatio = 0;
                        return b
                    }
                    C(b, a);
                    b.prototype.AddBody =
                        function(a) {
                            this.bodies.push(a);
                            1 === this.bodies.length ? this.bodyA = a : 2 === this.bodies.length && (this.bodyB = a)
                        };
                    return b
                }(va),
                Ub = function(a) {
                    function b(b) {
                        var c = a.call(this, b) || this;
                        c.m_frequencyHz = 0;
                        c.m_dampingRatio = 0;
                        c.m_impulse = 0;
                        c.m_targetArea = 0;
                        c.m_bodies = b.bodies;
                        c.m_frequencyHz = e(b.frequencyHz, 0);
                        c.m_dampingRatio = e(b.dampingRatio, 0);
                        c.m_targetLengths = h(b.bodies.length);
                        c.m_normals = r.MakeArray(b.bodies.length);
                        c.m_joints = [];
                        c.m_deltas = r.MakeArray(b.bodies.length);
                        c.m_delta = new r;
                        b = new Sb;
                        b.frequencyHz =
                            c.m_frequencyHz;
                        b.dampingRatio = c.m_dampingRatio;
                        for (var d = c.m_targetArea = 0; d < c.m_bodies.length; ++d) {
                            var f = c.m_bodies[d],
                                g = c.m_bodies[(d + 1) % c.m_bodies.length],
                                k = f.GetWorldCenter(),
                                l = g.GetWorldCenter();
                            c.m_targetLengths[d] = r.DistanceVV(k, l);
                            c.m_targetArea += r.CrossVV(k, l);
                            b.Initialize(f, g, k, l);
                            c.m_joints[d] = f.GetWorld().CreateJoint(b)
                        }
                        c.m_targetArea *= .5;
                        return c
                    }
                    C(b, a);
                    b.prototype.GetAnchorA = function(a) {
                        return a
                    };
                    b.prototype.GetAnchorB = function(a) {
                        return a
                    };
                    b.prototype.GetReactionForce = function(a, b) {
                        return b
                    };
                    b.prototype.GetReactionTorque = function(a) {
                        return 0
                    };
                    b.prototype.SetFrequency = function(a) {
                        this.m_frequencyHz = a;
                        for (var b = 0; b < this.m_joints.length; ++b) this.m_joints[b].SetFrequency(a)
                    };
                    b.prototype.GetFrequency = function() {
                        return this.m_frequencyHz
                    };
                    b.prototype.SetDampingRatio = function(a) {
                        this.m_dampingRatio = a;
                        for (var b = 0; b < this.m_joints.length; ++b) this.m_joints[b].SetDampingRatio(a)
                    };
                    b.prototype.GetDampingRatio = function() {
                        return this.m_dampingRatio
                    };
                    b.prototype.Dump = function(a) {
                        a("Area joint dumping is not supported.\n")
                    };
                    b.prototype.InitVelocityConstraints = function(a) {
                        for (var b, c = 0; c < this.m_bodies.length; ++c) {
                            var d = a.positions[this.m_bodies[(c + this.m_bodies.length - 1) % this.m_bodies.length].m_islandIndex].c,
                                e = a.positions[this.m_bodies[(c + 1) % this.m_bodies.length].m_islandIndex].c;
                            b = this.m_deltas[c];
                            r.SubVV(e, d, b)
                        }
                        if (a.step.warmStarting)
                            for (this.m_impulse *= a.step.dtRatio, c = 0; c < this.m_bodies.length; ++c) d = this.m_bodies[c], e = a.velocities[d.m_islandIndex].v, b = this.m_deltas[c], e.x += d.m_invMass * b.y * .5 * this.m_impulse, e.y += d.m_invMass *
                                -b.x * .5 * this.m_impulse;
                        else this.m_impulse = 0
                    };
                    b.prototype.SolveVelocityConstraints = function(a) {
                        for (var b, c, d, e = 0, f = 0, g = 0; g < this.m_bodies.length; ++g) d = this.m_bodies[g], c = a.velocities[d.m_islandIndex].v, b = this.m_deltas[g], e += b.LengthSquared() / d.GetMass(), f += r.CrossVV(c, b);
                        e = -2 * f / e;
                        this.m_impulse += e;
                        for (g = 0; g < this.m_bodies.length; ++g) d = this.m_bodies[g], c = a.velocities[d.m_islandIndex].v, b = this.m_deltas[g], c.x += d.m_invMass * b.y * .5 * e, c.y += d.m_invMass * -b.x * .5 * e
                    };
                    b.prototype.SolvePositionConstraints = function(a) {
                        for (var b,
                                c, d = 0, e = 0, f = 0; f < this.m_bodies.length; ++f) {
                            c = this.m_bodies[f];
                            b = this.m_bodies[(f + 1) % this.m_bodies.length];
                            c = a.positions[c.m_islandIndex].c;
                            var g = a.positions[b.m_islandIndex].c;
                            b = r.SubVV(g, c, this.m_delta);
                            var h = b.Length();
                            1E-5 > h && (h = 1);
                            this.m_normals[f].x = b.y / h;
                            this.m_normals[f].y = -b.x / h;
                            d += h;
                            e += r.CrossVV(c, g)
                        }
                        d = .5 * (this.m_targetArea - .5 * e) / d;
                        e = !0;
                        for (f = 0; f < this.m_bodies.length; ++f) c = this.m_bodies[f], c = a.positions[c.m_islandIndex].c, b = r.AddVV(this.m_normals[f], this.m_normals[(f + 1) % this.m_bodies.length],
                            this.m_delta), b.SelfMul(d), g = b.LengthSquared(), g > .2 * .2 && b.SelfMul(.2 / ha(g)), 6.4E-5 < g && (e = !1), c.x += b.x, c.y += b.y;
                        return e
                    };
                    return b
                }(wa),
                Ld = function(a) {
                    function b() {
                        var b = a.call(this, f.b2JointType.e_frictionJoint) || this;
                        b.localAnchorA = new r;
                        b.localAnchorB = new r;
                        b.maxForce = 0;
                        b.maxTorque = 0;
                        return b
                    }
                    C(b, a);
                    b.prototype.Initialize = function(a, b, c) {
                        this.bodyA = a;
                        this.bodyB = b;
                        this.bodyA.GetLocalPoint(c, this.localAnchorA);
                        this.bodyB.GetLocalPoint(c, this.localAnchorB)
                    };
                    return b
                }(va),
                Vb = function(a) {
                    function b(b) {
                        var c =
                            a.call(this, b) || this;
                        c.m_localAnchorA = new r;
                        c.m_localAnchorB = new r;
                        c.m_linearImpulse = new r;
                        c.m_angularImpulse = 0;
                        c.m_maxForce = 0;
                        c.m_maxTorque = 0;
                        c.m_indexA = 0;
                        c.m_indexB = 0;
                        c.m_rA = new r;
                        c.m_rB = new r;
                        c.m_localCenterA = new r;
                        c.m_localCenterB = new r;
                        c.m_invMassA = 0;
                        c.m_invMassB = 0;
                        c.m_invIA = 0;
                        c.m_invIB = 0;
                        c.m_linearMass = new la;
                        c.m_angularMass = 0;
                        c.m_qA = new N;
                        c.m_qB = new N;
                        c.m_lalcA = new r;
                        c.m_lalcB = new r;
                        c.m_K = new la;
                        c.m_localAnchorA.Copy(b.localAnchorA);
                        c.m_localAnchorB.Copy(b.localAnchorB);
                        c.m_linearImpulse.SetZero();
                        c.m_maxForce = e(b.maxForce, 0);
                        c.m_maxTorque = e(b.maxTorque, 0);
                        c.m_linearMass.SetZero();
                        return c
                    }
                    C(b, a);
                    b.prototype.InitVelocityConstraints = function(a) {
                        this.m_indexA = this.m_bodyA.m_islandIndex;
                        this.m_indexB = this.m_bodyB.m_islandIndex;
                        this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);
                        this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);
                        this.m_invMassA = this.m_bodyA.m_invMass;
                        this.m_invMassB = this.m_bodyB.m_invMass;
                        this.m_invIA = this.m_bodyA.m_invI;
                        this.m_invIB = this.m_bodyB.m_invI;
                        var b = a.velocities[this.m_indexA].v,
                            c = a.velocities[this.m_indexA].w,
                            d = a.positions[this.m_indexB].a,
                            e = a.velocities[this.m_indexB].v,
                            f = a.velocities[this.m_indexB].w,
                            g = this.m_qA.SetAngle(a.positions[this.m_indexA].a);
                        d = this.m_qB.SetAngle(d);
                        r.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                        g = N.MulRV(g, this.m_lalcA, this.m_rA);
                        r.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                        var h = N.MulRV(d, this.m_lalcB, this.m_rB);
                        d = this.m_invMassA;
                        var k = this.m_invMassB,
                            l = this.m_invIA,
                            m = this.m_invIB,
                            n = this.m_K;
                        n.ex.x = d + k + l * g.y * g.y +
                            m * h.y * h.y;
                        n.ex.y = -l * g.x * g.y - m * h.x * h.y;
                        n.ey.x = n.ex.y;
                        n.ey.y = d + k + l * g.x * g.x + m * h.x * h.x;
                        n.GetInverse(this.m_linearMass);
                        this.m_angularMass = l + m;
                        0 < this.m_angularMass && (this.m_angularMass = 1 / this.m_angularMass);
                        a.step.warmStarting ? (this.m_linearImpulse.SelfMul(a.step.dtRatio), this.m_angularImpulse *= a.step.dtRatio, g = this.m_linearImpulse, b.SelfMulSub(d, g), c -= l * (r.CrossVV(this.m_rA, g) + this.m_angularImpulse), e.SelfMulAdd(k, g), f += m * (r.CrossVV(this.m_rB, g) + this.m_angularImpulse)) : (this.m_linearImpulse.SetZero(),
                            this.m_angularImpulse = 0);
                        a.velocities[this.m_indexA].w = c;
                        a.velocities[this.m_indexB].w = f
                    };
                    b.prototype.SolveVelocityConstraints = function(a) {
                        var d = a.velocities[this.m_indexA].v,
                            e = a.velocities[this.m_indexA].w,
                            f = a.velocities[this.m_indexB].v,
                            g = a.velocities[this.m_indexB].w,
                            h = this.m_invMassA,
                            k = this.m_invMassB,
                            l = this.m_invIA,
                            m = this.m_invIB,
                            n = a.step.dt,
                            D = -this.m_angularMass * (g - e),
                            J = this.m_angularImpulse,
                            p = n * this.m_maxTorque;
                        this.m_angularImpulse = c(this.m_angularImpulse + D, -p, p);
                        D = this.m_angularImpulse - J;
                        e -= l * D;
                        g += m * D;
                        p = r.SubVV(r.AddVCrossSV(f, g, this.m_rB, r.s_t0), r.AddVCrossSV(d, e, this.m_rA, r.s_t1), b.SolveVelocityConstraints_s_Cdot_v2);
                        D = la.MulMV(this.m_linearMass, p, b.SolveVelocityConstraints_s_impulseV).SelfNeg();
                        J = b.SolveVelocityConstraints_s_oldImpulseV.Copy(this.m_linearImpulse);
                        this.m_linearImpulse.SelfAdd(D);
                        p = n * this.m_maxForce;
                        this.m_linearImpulse.LengthSquared() > p * p && (this.m_linearImpulse.Normalize(), this.m_linearImpulse.SelfMul(p));
                        r.SubVV(this.m_linearImpulse, J, D);
                        d.SelfMulSub(h, D);
                        e -= l *
                            r.CrossVV(this.m_rA, D);
                        f.SelfMulAdd(k, D);
                        g += m * r.CrossVV(this.m_rB, D);
                        a.velocities[this.m_indexA].w = e;
                        a.velocities[this.m_indexB].w = g
                    };
                    b.prototype.SolvePositionConstraints = function(a) {
                        return !0
                    };
                    b.prototype.GetAnchorA = function(a) {
                        return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, a)
                    };
                    b.prototype.GetAnchorB = function(a) {
                        return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, a)
                    };
                    b.prototype.GetReactionForce = function(a, b) {
                        b.x = a * this.m_linearImpulse.x;
                        b.y = a * this.m_linearImpulse.y;
                        return b
                    };
                    b.prototype.GetReactionTorque =
                        function(a) {
                            return a * this.m_angularImpulse
                        };
                    b.prototype.GetLocalAnchorA = function() {
                        return this.m_localAnchorA
                    };
                    b.prototype.GetLocalAnchorB = function() {
                        return this.m_localAnchorB
                    };
                    b.prototype.SetMaxForce = function(a) {
                        this.m_maxForce = a
                    };
                    b.prototype.GetMaxForce = function() {
                        return this.m_maxForce
                    };
                    b.prototype.SetMaxTorque = function(a) {
                        this.m_maxTorque = a
                    };
                    b.prototype.GetMaxTorque = function() {
                        return this.m_maxTorque
                    };
                    b.prototype.Dump = function(a) {
                        var b = this.m_bodyA.m_islandIndex,
                            c = this.m_bodyB.m_islandIndex;
                        a("  const jd: b2FrictionJointDef = new b2FrictionJointDef();\n");
                        a("  jd.bodyA = bodies[%d];\n", b);
                        a("  jd.bodyB = bodies[%d];\n", c);
                        a("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false");
                        a("  jd.localAnchorA.Set(%.15f, %.15f);\n", this.m_localAnchorA.x, this.m_localAnchorA.y);
                        a("  jd.localAnchorB.Set(%.15f, %.15f);\n", this.m_localAnchorB.x, this.m_localAnchorB.y);
                        a("  jd.maxForce = %.15f;\n", this.m_maxForce);
                        a("  jd.maxTorque = %.15f;\n", this.m_maxTorque);
                        a("  joints[%d] = this.m_world.CreateJoint(jd);\n",
                            this.m_index)
                    };
                    b.SolveVelocityConstraints_s_Cdot_v2 = new r;
                    b.SolveVelocityConstraints_s_impulseV = new r;
                    b.SolveVelocityConstraints_s_oldImpulseV = new r;
                    return b
                }(wa),
                Md = function(a) {
                    function b() {
                        var b = a.call(this, f.b2JointType.e_gearJoint) || this;
                        b.ratio = 1;
                        return b
                    }
                    C(b, a);
                    return b
                }(va),
                Wb = function(a) {
                    function b(b) {
                        var c = a.call(this, b) || this;
                        c.m_typeA = f.b2JointType.e_unknownJoint;
                        c.m_typeB = f.b2JointType.e_unknownJoint;
                        c.m_localAnchorA = new r;
                        c.m_localAnchorB = new r;
                        c.m_localAnchorC = new r;
                        c.m_localAnchorD =
                            new r;
                        c.m_localAxisC = new r;
                        c.m_localAxisD = new r;
                        c.m_referenceAngleA = 0;
                        c.m_referenceAngleB = 0;
                        c.m_constant = 0;
                        c.m_ratio = 0;
                        c.m_impulse = 0;
                        c.m_indexA = 0;
                        c.m_indexB = 0;
                        c.m_indexC = 0;
                        c.m_indexD = 0;
                        c.m_lcA = new r;
                        c.m_lcB = new r;
                        c.m_lcC = new r;
                        c.m_lcD = new r;
                        c.m_mA = 0;
                        c.m_mB = 0;
                        c.m_mC = 0;
                        c.m_mD = 0;
                        c.m_iA = 0;
                        c.m_iB = 0;
                        c.m_iC = 0;
                        c.m_iD = 0;
                        c.m_JvAC = new r;
                        c.m_JvBD = new r;
                        c.m_JwA = 0;
                        c.m_JwB = 0;
                        c.m_JwC = 0;
                        c.m_JwD = 0;
                        c.m_mass = 0;
                        c.m_qA = new N;
                        c.m_qB = new N;
                        c.m_qC = new N;
                        c.m_qD = new N;
                        c.m_lalcA = new r;
                        c.m_lalcB = new r;
                        c.m_lalcC = new r;
                        c.m_lalcD =
                            new r;
                        c.m_joint1 = b.joint1;
                        c.m_joint2 = b.joint2;
                        c.m_typeA = c.m_joint1.GetType();
                        c.m_typeB = c.m_joint2.GetType();
                        c.m_bodyC = c.m_joint1.GetBodyA();
                        c.m_bodyA = c.m_joint1.GetBodyB();
                        var d = c.m_bodyA.m_xf;
                        var g = c.m_bodyA.m_sweep.a;
                        var h = c.m_bodyC.m_xf;
                        var k = c.m_bodyC.m_sweep.a;
                        c.m_typeA === f.b2JointType.e_revoluteJoint ? (h = b.joint1, c.m_localAnchorC.Copy(h.m_localAnchorA), c.m_localAnchorA.Copy(h.m_localAnchorB), c.m_referenceAngleA = h.m_referenceAngle, c.m_localAxisC.SetZero(), d = g - k - c.m_referenceAngleA) : (k = b.joint1,
                            c.m_localAnchorC.Copy(k.m_localAnchorA), c.m_localAnchorA.Copy(k.m_localAnchorB), c.m_referenceAngleA = k.m_referenceAngle, c.m_localAxisC.Copy(k.m_localXAxisA), g = c.m_localAnchorC, d = N.MulTRV(h.q, r.AddVV(N.MulRV(d.q, c.m_localAnchorA, r.s_t0), r.SubVV(d.p, h.p, r.s_t1), r.s_t0), r.s_t0), d = r.DotVV(r.SubVV(d, g, r.s_t0), c.m_localAxisC));
                        c.m_bodyD = c.m_joint2.GetBodyA();
                        c.m_bodyB = c.m_joint2.GetBodyB();
                        h = c.m_bodyB.m_xf;
                        k = c.m_bodyB.m_sweep.a;
                        g = c.m_bodyD.m_xf;
                        var l = c.m_bodyD.m_sweep.a;
                        c.m_typeB === f.b2JointType.e_revoluteJoint ?
                            (h = b.joint2, c.m_localAnchorD.Copy(h.m_localAnchorA), c.m_localAnchorB.Copy(h.m_localAnchorB), c.m_referenceAngleB = h.m_referenceAngle, c.m_localAxisD.SetZero(), h = k - l - c.m_referenceAngleB) : (k = b.joint2, c.m_localAnchorD.Copy(k.m_localAnchorA), c.m_localAnchorB.Copy(k.m_localAnchorB), c.m_referenceAngleB = k.m_referenceAngle, c.m_localAxisD.Copy(k.m_localXAxisA), k = c.m_localAnchorD, h = N.MulTRV(g.q, r.AddVV(N.MulRV(h.q, c.m_localAnchorB, r.s_t0), r.SubVV(h.p, g.p, r.s_t1), r.s_t0), r.s_t0), h = r.DotVV(r.SubVV(h, k, r.s_t0), c.m_localAxisD));
                        c.m_ratio = e(b.ratio, 1);
                        c.m_constant = d + c.m_ratio * h;
                        c.m_impulse = 0;
                        return c
                    }
                    C(b, a);
                    b.prototype.InitVelocityConstraints = function(a) {
                        this.m_indexA = this.m_bodyA.m_islandIndex;
                        this.m_indexB = this.m_bodyB.m_islandIndex;
                        this.m_indexC = this.m_bodyC.m_islandIndex;
                        this.m_indexD = this.m_bodyD.m_islandIndex;
                        this.m_lcA.Copy(this.m_bodyA.m_sweep.localCenter);
                        this.m_lcB.Copy(this.m_bodyB.m_sweep.localCenter);
                        this.m_lcC.Copy(this.m_bodyC.m_sweep.localCenter);
                        this.m_lcD.Copy(this.m_bodyD.m_sweep.localCenter);
                        this.m_mA =
                            this.m_bodyA.m_invMass;
                        this.m_mB = this.m_bodyB.m_invMass;
                        this.m_mC = this.m_bodyC.m_invMass;
                        this.m_mD = this.m_bodyD.m_invMass;
                        this.m_iA = this.m_bodyA.m_invI;
                        this.m_iB = this.m_bodyB.m_invI;
                        this.m_iC = this.m_bodyC.m_invI;
                        this.m_iD = this.m_bodyD.m_invI;
                        var c = a.velocities[this.m_indexA].v,
                            d = a.velocities[this.m_indexA].w,
                            e = a.positions[this.m_indexB].a,
                            g = a.velocities[this.m_indexB].v,
                            h = a.velocities[this.m_indexB].w,
                            k = a.positions[this.m_indexC].a,
                            l = a.velocities[this.m_indexC].v,
                            m = a.velocities[this.m_indexC].w;
                        var n =
                            a.positions[this.m_indexD].a;
                        var D = a.velocities[this.m_indexD].v,
                            J = a.velocities[this.m_indexD].w,
                            p = this.m_qA.SetAngle(a.positions[this.m_indexA].a);
                        e = this.m_qB.SetAngle(e);
                        var q = this.m_qC.SetAngle(k);
                        k = this.m_qD.SetAngle(n);
                        this.m_mass = 0;
                        this.m_typeA === f.b2JointType.e_revoluteJoint ? (this.m_JvAC.SetZero(), this.m_JwC = this.m_JwA = 1, this.m_mass += this.m_iA + this.m_iC) : (n = N.MulRV(q, this.m_localAxisC, b.InitVelocityConstraints_s_u), r.SubVV(this.m_localAnchorC, this.m_lcC, this.m_lalcC), q = N.MulRV(q, this.m_lalcC,
                            b.InitVelocityConstraints_s_rC), r.SubVV(this.m_localAnchorA, this.m_lcA, this.m_lalcA), p = N.MulRV(p, this.m_lalcA, b.InitVelocityConstraints_s_rA), this.m_JvAC.Copy(n), this.m_JwC = r.CrossVV(q, n), this.m_JwA = r.CrossVV(p, n), this.m_mass += this.m_mC + this.m_mA + this.m_iC * this.m_JwC * this.m_JwC + this.m_iA * this.m_JwA * this.m_JwA);
                        this.m_typeB === f.b2JointType.e_revoluteJoint ? (this.m_JvBD.SetZero(), this.m_JwD = this.m_JwB = this.m_ratio, this.m_mass += this.m_ratio * this.m_ratio * (this.m_iB + this.m_iD)) : (n = N.MulRV(k, this.m_localAxisD,
                            b.InitVelocityConstraints_s_u), r.SubVV(this.m_localAnchorD, this.m_lcD, this.m_lalcD), p = N.MulRV(k, this.m_lalcD, b.InitVelocityConstraints_s_rD), r.SubVV(this.m_localAnchorB, this.m_lcB, this.m_lalcB), e = N.MulRV(e, this.m_lalcB, b.InitVelocityConstraints_s_rB), r.MulSV(this.m_ratio, n, this.m_JvBD), this.m_JwD = this.m_ratio * r.CrossVV(p, n), this.m_JwB = this.m_ratio * r.CrossVV(e, n), this.m_mass += this.m_ratio * this.m_ratio * (this.m_mD + this.m_mB) + this.m_iD * this.m_JwD * this.m_JwD + this.m_iB * this.m_JwB * this.m_JwB);
                        this.m_mass =
                            0 < this.m_mass ? 1 / this.m_mass : 0;
                        a.step.warmStarting ? (c.SelfMulAdd(this.m_mA * this.m_impulse, this.m_JvAC), d += this.m_iA * this.m_impulse * this.m_JwA, g.SelfMulAdd(this.m_mB * this.m_impulse, this.m_JvBD), h += this.m_iB * this.m_impulse * this.m_JwB, l.SelfMulSub(this.m_mC * this.m_impulse, this.m_JvAC), m -= this.m_iC * this.m_impulse * this.m_JwC, D.SelfMulSub(this.m_mD * this.m_impulse, this.m_JvBD), J -= this.m_iD * this.m_impulse * this.m_JwD) : this.m_impulse = 0;
                        a.velocities[this.m_indexA].w = d;
                        a.velocities[this.m_indexB].w = h;
                        a.velocities[this.m_indexC].w =
                            m;
                        a.velocities[this.m_indexD].w = J
                    };
                    b.prototype.SolveVelocityConstraints = function(a) {
                        var b = a.velocities[this.m_indexA].v,
                            c = a.velocities[this.m_indexA].w,
                            d = a.velocities[this.m_indexB].v,
                            e = a.velocities[this.m_indexB].w,
                            f = a.velocities[this.m_indexC].v,
                            g = a.velocities[this.m_indexC].w,
                            h = a.velocities[this.m_indexD].v,
                            k = a.velocities[this.m_indexD].w,
                            l = r.DotVV(this.m_JvAC, r.SubVV(b, f, r.s_t0)) + r.DotVV(this.m_JvBD, r.SubVV(d, h, r.s_t0));
                        l += this.m_JwA * c - this.m_JwC * g + (this.m_JwB * e - this.m_JwD * k);
                        l *= -this.m_mass;
                        this.m_impulse += l;
                        b.SelfMulAdd(this.m_mA * l, this.m_JvAC);
                        c += this.m_iA * l * this.m_JwA;
                        d.SelfMulAdd(this.m_mB * l, this.m_JvBD);
                        e += this.m_iB * l * this.m_JwB;
                        f.SelfMulSub(this.m_mC * l, this.m_JvAC);
                        g -= this.m_iC * l * this.m_JwC;
                        h.SelfMulSub(this.m_mD * l, this.m_JvBD);
                        k -= this.m_iD * l * this.m_JwD;
                        a.velocities[this.m_indexA].w = c;
                        a.velocities[this.m_indexB].w = e;
                        a.velocities[this.m_indexC].w = g;
                        a.velocities[this.m_indexD].w = k
                    };
                    b.prototype.SolvePositionConstraints = function(a) {
                        var c = a.positions[this.m_indexA].c,
                            d = a.positions[this.m_indexA].a,
                            e = a.positions[this.m_indexB].c,
                            g = a.positions[this.m_indexB].a,
                            h = a.positions[this.m_indexC].c,
                            k = a.positions[this.m_indexC].a,
                            l = a.positions[this.m_indexD].c,
                            m = a.positions[this.m_indexD].a,
                            n = this.m_qA.SetAngle(d),
                            D = this.m_qB.SetAngle(g),
                            J = this.m_qC.SetAngle(k),
                            p = this.m_qD.SetAngle(m),
                            q = this.m_JvAC,
                            Y = this.m_JvBD,
                            t, u = 0;
                        if (this.m_typeA === f.b2JointType.e_revoluteJoint) q.SetZero(), n = t = 1, u += this.m_iA + this.m_iC, J = d - k - this.m_referenceAngleA;
                        else {
                            var v = N.MulRV(J, this.m_localAxisC, b.SolvePositionConstraints_s_u);
                            t = N.MulRV(J, this.m_lalcC, b.SolvePositionConstraints_s_rC);
                            var w = N.MulRV(n, this.m_lalcA, b.SolvePositionConstraints_s_rA);
                            q.Copy(v);
                            n = r.CrossVV(t, v);
                            t = r.CrossVV(w, v);
                            u += this.m_mC + this.m_mA + this.m_iC * n * n + this.m_iA * t * t;
                            v = this.m_lalcC;
                            J = N.MulTRV(J, r.AddVV(w, r.SubVV(c, h, r.s_t0), r.s_t0), r.s_t0);
                            J = r.DotVV(r.SubVV(J, v, r.s_t0), this.m_localAxisC)
                        }
                        if (this.m_typeB === f.b2JointType.e_revoluteJoint) Y.SetZero(), D = v = this.m_ratio, u += this.m_ratio * this.m_ratio * (this.m_iB + this.m_iD), p = g - m - this.m_referenceAngleB;
                        else {
                            v =
                                N.MulRV(p, this.m_localAxisD, b.SolvePositionConstraints_s_u);
                            var x = N.MulRV(p, this.m_lalcD, b.SolvePositionConstraints_s_rD);
                            w = N.MulRV(D, this.m_lalcB, b.SolvePositionConstraints_s_rB);
                            r.MulSV(this.m_ratio, v, Y);
                            D = this.m_ratio * r.CrossVV(x, v);
                            v = this.m_ratio * r.CrossVV(w, v);
                            u += this.m_ratio * this.m_ratio * (this.m_mD + this.m_mB) + this.m_iD * D * D + this.m_iB * v * v;
                            x = this.m_lalcD;
                            p = N.MulTRV(p, r.AddVV(w, r.SubVV(e, l, r.s_t0), r.s_t0), r.s_t0);
                            p = r.DotVV(r.SubVV(p, x, r.s_t0), this.m_localAxisD)
                        }
                        p = J + this.m_ratio * p - this.m_constant;
                        J = 0;
                        0 < u && (J = -p / u);
                        c.SelfMulAdd(this.m_mA * J, q);
                        d += this.m_iA * J * t;
                        e.SelfMulAdd(this.m_mB * J, Y);
                        g += this.m_iB * J * v;
                        h.SelfMulSub(this.m_mC * J, q);
                        k -= this.m_iC * J * n;
                        l.SelfMulSub(this.m_mD * J, Y);
                        m -= this.m_iD * J * D;
                        a.positions[this.m_indexA].a = d;
                        a.positions[this.m_indexB].a = g;
                        a.positions[this.m_indexC].a = k;
                        a.positions[this.m_indexD].a = m;
                        return !0
                    };
                    b.prototype.GetAnchorA = function(a) {
                        return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, a)
                    };
                    b.prototype.GetAnchorB = function(a) {
                        return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,
                            a)
                    };
                    b.prototype.GetReactionForce = function(a, b) {
                        return r.MulSV(a * this.m_impulse, this.m_JvAC, b)
                    };
                    b.prototype.GetReactionTorque = function(a) {
                        return a * this.m_impulse * this.m_JwA
                    };
                    b.prototype.GetJoint1 = function() {
                        return this.m_joint1
                    };
                    b.prototype.GetJoint2 = function() {
                        return this.m_joint2
                    };
                    b.prototype.GetRatio = function() {
                        return this.m_ratio
                    };
                    b.prototype.SetRatio = function(a) {
                        this.m_ratio = a
                    };
                    b.prototype.Dump = function(a) {
                        var b = this.m_bodyA.m_islandIndex,
                            c = this.m_bodyB.m_islandIndex,
                            d = this.m_joint1.m_index,
                            e =
                            this.m_joint2.m_index;
                        a("  const jd: b2GearJointDef = new b2GearJointDef();\n");
                        a("  jd.bodyA = bodies[%d];\n", b);
                        a("  jd.bodyB = bodies[%d];\n", c);
                        a("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false");
                        a("  jd.joint1 = joints[%d];\n", d);
                        a("  jd.joint2 = joints[%d];\n", e);
                        a("  jd.ratio = %.15f;\n", this.m_ratio);
                        a("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index)
                    };
                    b.InitVelocityConstraints_s_u = new r;
                    b.InitVelocityConstraints_s_rA = new r;
                    b.InitVelocityConstraints_s_rB =
                        new r;
                    b.InitVelocityConstraints_s_rC = new r;
                    b.InitVelocityConstraints_s_rD = new r;
                    b.SolvePositionConstraints_s_u = new r;
                    b.SolvePositionConstraints_s_rA = new r;
                    b.SolvePositionConstraints_s_rB = new r;
                    b.SolvePositionConstraints_s_rC = new r;
                    b.SolvePositionConstraints_s_rD = new r;
                    return b
                }(wa),
                Nd = function(a) {
                    function b() {
                        var b = a.call(this, f.b2JointType.e_motorJoint) || this;
                        b.linearOffset = new r(0, 0);
                        b.angularOffset = 0;
                        b.maxForce = 1;
                        b.maxTorque = 1;
                        b.correctionFactor = .3;
                        return b
                    }
                    C(b, a);
                    b.prototype.Initialize = function(a,
                        b) {
                        this.bodyA = a;
                        this.bodyB = b;
                        this.bodyA.GetLocalPoint(this.bodyB.GetPosition(), this.linearOffset);
                        a = this.bodyA.GetAngle();
                        this.angularOffset = this.bodyB.GetAngle() - a
                    };
                    return b
                }(va),
                Xb = function(a) {
                    function b(b) {
                        var c = a.call(this, b) || this;
                        c.m_linearOffset = new r;
                        c.m_angularOffset = 0;
                        c.m_linearImpulse = new r;
                        c.m_angularImpulse = 0;
                        c.m_maxForce = 0;
                        c.m_maxTorque = 0;
                        c.m_correctionFactor = .3;
                        c.m_indexA = 0;
                        c.m_indexB = 0;
                        c.m_rA = new r;
                        c.m_rB = new r;
                        c.m_localCenterA = new r;
                        c.m_localCenterB = new r;
                        c.m_linearError = new r;
                        c.m_angularError =
                            0;
                        c.m_invMassA = 0;
                        c.m_invMassB = 0;
                        c.m_invIA = 0;
                        c.m_invIB = 0;
                        c.m_linearMass = new la;
                        c.m_angularMass = 0;
                        c.m_qA = new N;
                        c.m_qB = new N;
                        c.m_K = new la;
                        c.m_linearOffset.Copy(e(b.linearOffset, r.ZERO));
                        c.m_linearImpulse.SetZero();
                        c.m_maxForce = e(b.maxForce, 0);
                        c.m_maxTorque = e(b.maxTorque, 0);
                        c.m_correctionFactor = e(b.correctionFactor, .3);
                        return c
                    }
                    C(b, a);
                    b.prototype.GetAnchorA = function(a) {
                        var b = this.m_bodyA.GetPosition();
                        a.x = b.x;
                        a.y = b.y;
                        return a
                    };
                    b.prototype.GetAnchorB = function(a) {
                        var b = this.m_bodyB.GetPosition();
                        a.x = b.x;
                        a.y = b.y;
                        return a
                    };
                    b.prototype.GetReactionForce = function(a, b) {
                        return r.MulSV(a, this.m_linearImpulse, b)
                    };
                    b.prototype.GetReactionTorque = function(a) {
                        return a * this.m_angularImpulse
                    };
                    b.prototype.SetLinearOffset = function(a) {
                        r.IsEqualToV(a, this.m_linearOffset) || (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), this.m_linearOffset.Copy(a))
                    };
                    b.prototype.GetLinearOffset = function() {
                        return this.m_linearOffset
                    };
                    b.prototype.SetAngularOffset = function(a) {
                        a !== this.m_angularOffset && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0),
                            this.m_angularOffset = a)
                    };
                    b.prototype.GetAngularOffset = function() {
                        return this.m_angularOffset
                    };
                    b.prototype.SetMaxForce = function(a) {
                        this.m_maxForce = a
                    };
                    b.prototype.GetMaxForce = function() {
                        return this.m_maxForce
                    };
                    b.prototype.SetMaxTorque = function(a) {
                        this.m_maxTorque = a
                    };
                    b.prototype.GetMaxTorque = function() {
                        return this.m_maxTorque
                    };
                    b.prototype.InitVelocityConstraints = function(a) {
                        this.m_indexA = this.m_bodyA.m_islandIndex;
                        this.m_indexB = this.m_bodyB.m_islandIndex;
                        this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);
                        this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);
                        this.m_invMassA = this.m_bodyA.m_invMass;
                        this.m_invMassB = this.m_bodyB.m_invMass;
                        this.m_invIA = this.m_bodyA.m_invI;
                        this.m_invIB = this.m_bodyB.m_invI;
                        var b = a.positions[this.m_indexA].c,
                            c = a.positions[this.m_indexA].a,
                            d = a.velocities[this.m_indexA].v,
                            e = a.velocities[this.m_indexA].w,
                            f = a.positions[this.m_indexB].c,
                            g = a.positions[this.m_indexB].a,
                            h = a.velocities[this.m_indexB].v,
                            k = a.velocities[this.m_indexB].w,
                            l = this.m_qA.SetAngle(c),
                            m = this.m_qB.SetAngle(g);
                        l = N.MulRV(l, r.SubVV(this.m_linearOffset, this.m_localCenterA, r.s_t0), this.m_rA);
                        m = N.MulRV(m, r.NegV(this.m_localCenterB, r.s_t0), this.m_rB);
                        var n = this.m_invMassA,
                            D = this.m_invMassB,
                            J = this.m_invIA,
                            p = this.m_invIB,
                            q = this.m_K;
                        q.ex.x = n + D + J * l.y * l.y + p * m.y * m.y;
                        q.ex.y = -J * l.x * l.y - p * m.x * m.y;
                        q.ey.x = q.ex.y;
                        q.ey.y = n + D + J * l.x * l.x + p * m.x * m.x;
                        q.GetInverse(this.m_linearMass);
                        this.m_angularMass = J + p;
                        0 < this.m_angularMass && (this.m_angularMass = 1 / this.m_angularMass);
                        r.SubVV(r.AddVV(f, m, r.s_t0), r.AddVV(b, l, r.s_t1), this.m_linearError);
                        this.m_angularError = g - c - this.m_angularOffset;
                        a.step.warmStarting ? (this.m_linearImpulse.SelfMul(a.step.dtRatio), this.m_angularImpulse *= a.step.dtRatio, b = this.m_linearImpulse, d.SelfMulSub(n, b), e -= J * (r.CrossVV(l, b) + this.m_angularImpulse), h.SelfMulAdd(D, b), k += p * (r.CrossVV(m, b) + this.m_angularImpulse)) : (this.m_linearImpulse.SetZero(), this.m_angularImpulse = 0);
                        a.velocities[this.m_indexA].w = e;
                        a.velocities[this.m_indexB].w = k
                    };
                    b.prototype.SolveVelocityConstraints = function(a) {
                        var d = a.velocities[this.m_indexA].v,
                            e = a.velocities[this.m_indexA].w,
                            f = a.velocities[this.m_indexB].v,
                            g = a.velocities[this.m_indexB].w,
                            h = this.m_invMassA,
                            k = this.m_invMassB,
                            l = this.m_invIA,
                            m = this.m_invIB,
                            n = a.step.dt,
                            D = a.step.inv_dt,
                            J = -this.m_angularMass * (g - e + D * this.m_correctionFactor * this.m_angularError),
                            p = this.m_angularImpulse,
                            q = n * this.m_maxTorque;
                        this.m_angularImpulse = c(this.m_angularImpulse + J, -q, q);
                        J = this.m_angularImpulse - p;
                        e -= l * J;
                        g += m * J;
                        J = this.m_rA;
                        p = this.m_rB;
                        q = r.AddVV(r.SubVV(r.AddVV(f, r.CrossSV(g, p, r.s_t0), r.s_t0), r.AddVV(d, r.CrossSV(e,
                            J, r.s_t1), r.s_t1), r.s_t2), r.MulSV(D * this.m_correctionFactor, this.m_linearError, r.s_t3), b.SolveVelocityConstraints_s_Cdot_v2);
                        D = la.MulMV(this.m_linearMass, q, b.SolveVelocityConstraints_s_impulse_v2).SelfNeg();
                        var t = b.SolveVelocityConstraints_s_oldImpulse_v2.Copy(this.m_linearImpulse);
                        this.m_linearImpulse.SelfAdd(D);
                        q = n * this.m_maxForce;
                        this.m_linearImpulse.LengthSquared() > q * q && (this.m_linearImpulse.Normalize(), this.m_linearImpulse.SelfMul(q));
                        r.SubVV(this.m_linearImpulse, t, D);
                        d.SelfMulSub(h, D);
                        e -= l *
                            r.CrossVV(J, D);
                        f.SelfMulAdd(k, D);
                        g += m * r.CrossVV(p, D);
                        a.velocities[this.m_indexA].w = e;
                        a.velocities[this.m_indexB].w = g
                    };
                    b.prototype.SolvePositionConstraints = function(a) {
                        return !0
                    };
                    b.prototype.Dump = function(a) {
                        var b = this.m_bodyA.m_islandIndex,
                            c = this.m_bodyB.m_islandIndex;
                        a("  const jd: b2MotorJointDef = new b2MotorJointDef();\n");
                        a("  jd.bodyA = bodies[%d];\n", b);
                        a("  jd.bodyB = bodies[%d];\n", c);
                        a("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false");
                        a("  jd.linearOffset.Set(%.15f, %.15f);\n",
                            this.m_linearOffset.x, this.m_linearOffset.y);
                        a("  jd.angularOffset = %.15f;\n", this.m_angularOffset);
                        a("  jd.maxForce = %.15f;\n", this.m_maxForce);
                        a("  jd.maxTorque = %.15f;\n", this.m_maxTorque);
                        a("  jd.correctionFactor = %.15f;\n", this.m_correctionFactor);
                        a("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index)
                    };
                    b.SolveVelocityConstraints_s_Cdot_v2 = new r;
                    b.SolveVelocityConstraints_s_impulse_v2 = new r;
                    b.SolveVelocityConstraints_s_oldImpulse_v2 = new r;
                    return b
                }(wa),
                Od = function(a) {
                    function b() {
                        var b =
                            a.call(this, f.b2JointType.e_mouseJoint) || this;
                        b.target = new r;
                        b.maxForce = 0;
                        b.frequencyHz = 5;
                        b.dampingRatio = .7;
                        return b
                    }
                    C(b, a);
                    return b
                }(va),
                Yb = function(a) {
                    function b(b) {
                        var c = a.call(this, b) || this;
                        c.m_localAnchorB = new r;
                        c.m_targetA = new r;
                        c.m_frequencyHz = 0;
                        c.m_dampingRatio = 0;
                        c.m_beta = 0;
                        c.m_impulse = new r;
                        c.m_maxForce = 0;
                        c.m_gamma = 0;
                        c.m_indexA = 0;
                        c.m_indexB = 0;
                        c.m_rB = new r;
                        c.m_localCenterB = new r;
                        c.m_invMassB = 0;
                        c.m_invIB = 0;
                        c.m_mass = new la;
                        c.m_C = new r;
                        c.m_qB = new N;
                        c.m_lalcB = new r;
                        c.m_K = new la;
                        c.m_targetA.Copy(e(b.target,
                            r.ZERO));
                        T.MulTXV(c.m_bodyB.GetTransform(), c.m_targetA, c.m_localAnchorB);
                        c.m_maxForce = e(b.maxForce, 0);
                        c.m_impulse.SetZero();
                        c.m_frequencyHz = e(b.frequencyHz, 0);
                        c.m_dampingRatio = e(b.dampingRatio, 0);
                        c.m_beta = 0;
                        c.m_gamma = 0;
                        return c
                    }
                    C(b, a);
                    b.prototype.SetTarget = function(a) {
                        this.m_bodyB.IsAwake() || this.m_bodyB.SetAwake(!0);
                        this.m_targetA.Copy(a)
                    };
                    b.prototype.GetTarget = function() {
                        return this.m_targetA
                    };
                    b.prototype.SetMaxForce = function(a) {
                        this.m_maxForce = a
                    };
                    b.prototype.GetMaxForce = function() {
                        return this.m_maxForce
                    };
                    b.prototype.SetFrequency = function(a) {
                        this.m_frequencyHz = a
                    };
                    b.prototype.GetFrequency = function() {
                        return this.m_frequencyHz
                    };
                    b.prototype.SetDampingRatio = function(a) {
                        this.m_dampingRatio = a
                    };
                    b.prototype.GetDampingRatio = function() {
                        return this.m_dampingRatio
                    };
                    b.prototype.InitVelocityConstraints = function(a) {
                        this.m_indexB = this.m_bodyB.m_islandIndex;
                        this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);
                        this.m_invMassB = this.m_bodyB.m_invMass;
                        this.m_invIB = this.m_bodyB.m_invI;
                        var b = a.positions[this.m_indexB].c,
                            c = a.velocities[this.m_indexB].v,
                            d = a.velocities[this.m_indexB].w,
                            e = this.m_qB.SetAngle(a.positions[this.m_indexB].a),
                            f = this.m_bodyB.GetMass(),
                            g = 6.28318530718 * this.m_frequencyHz,
                            h = f * g * g,
                            k = a.step.dt;
                        this.m_gamma = k * (2 * f * this.m_dampingRatio * g + k * h);
                        0 !== this.m_gamma && (this.m_gamma = 1 / this.m_gamma);
                        this.m_beta = k * h * this.m_gamma;
                        r.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                        N.MulRV(e, this.m_lalcB, this.m_rB);
                        e = this.m_K;
                        e.ex.x = this.m_invMassB + this.m_invIB * this.m_rB.y * this.m_rB.y + this.m_gamma;
                        e.ex.y = -this.m_invIB * this.m_rB.x * this.m_rB.y;
                        e.ey.x = e.ex.y;
                        e.ey.y = this.m_invMassB + this.m_invIB * this.m_rB.x * this.m_rB.x + this.m_gamma;
                        e.GetInverse(this.m_mass);
                        this.m_C.x = b.x + this.m_rB.x - this.m_targetA.x;
                        this.m_C.y = b.y + this.m_rB.y - this.m_targetA.y;
                        this.m_C.SelfMul(this.m_beta);
                        d *= .98;
                        a.step.warmStarting ? (this.m_impulse.SelfMul(a.step.dtRatio), c.x += this.m_invMassB * this.m_impulse.x, c.y += this.m_invMassB * this.m_impulse.y, d += this.m_invIB * r.CrossVV(this.m_rB, this.m_impulse)) : this.m_impulse.SetZero();
                        a.velocities[this.m_indexB].w =
                            d
                    };
                    b.prototype.SolveVelocityConstraints = function(a) {
                        var c = a.velocities[this.m_indexB].v,
                            d = a.velocities[this.m_indexB].w,
                            e = r.AddVCrossSV(c, d, this.m_rB, b.SolveVelocityConstraints_s_Cdot);
                        e = la.MulMV(this.m_mass, r.AddVV(e, r.AddVV(this.m_C, r.MulSV(this.m_gamma, this.m_impulse, r.s_t0), r.s_t0), r.s_t0).SelfNeg(), b.SolveVelocityConstraints_s_impulse);
                        var f = b.SolveVelocityConstraints_s_oldImpulse.Copy(this.m_impulse);
                        this.m_impulse.SelfAdd(e);
                        var g = a.step.dt * this.m_maxForce;
                        this.m_impulse.LengthSquared() > g *
                            g && this.m_impulse.SelfMul(g / this.m_impulse.Length());
                        r.SubVV(this.m_impulse, f, e);
                        c.SelfMulAdd(this.m_invMassB, e);
                        d += this.m_invIB * r.CrossVV(this.m_rB, e);
                        a.velocities[this.m_indexB].w = d
                    };
                    b.prototype.SolvePositionConstraints = function(a) {
                        return !0
                    };
                    b.prototype.GetAnchorA = function(a) {
                        a.x = this.m_targetA.x;
                        a.y = this.m_targetA.y;
                        return a
                    };
                    b.prototype.GetAnchorB = function(a) {
                        return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, a)
                    };
                    b.prototype.GetReactionForce = function(a, b) {
                        return r.MulSV(a, this.m_impulse, b)
                    };
                    b.prototype.GetReactionTorque = function(a) {
                        return 0
                    };
                    b.prototype.Dump = function(a) {
                        a("Mouse joint dumping is not supported.\n")
                    };
                    b.prototype.ShiftOrigin = function(a) {
                        this.m_targetA.SelfSub(a)
                    };
                    b.SolveVelocityConstraints_s_Cdot = new r;
                    b.SolveVelocityConstraints_s_impulse = new r;
                    b.SolveVelocityConstraints_s_oldImpulse = new r;
                    return b
                }(wa),
                Pd = function(a) {
                    function b() {
                        var b = a.call(this, f.b2JointType.e_prismaticJoint) || this;
                        b.localAnchorA = new r;
                        b.localAnchorB = new r;
                        b.localAxisA = new r(1, 0);
                        b.referenceAngle = 0;
                        b.enableLimit = !1;
                        b.lowerTranslation = 0;
                        b.upperTranslation = 0;
                        b.enableMotor = !1;
                        b.maxMotorForce = 0;
                        b.motorSpeed = 0;
                        return b
                    }
                    C(b, a);
                    b.prototype.Initialize = function(a, b, c, d) {
                        this.bodyA = a;
                        this.bodyB = b;
                        this.bodyA.GetLocalPoint(c, this.localAnchorA);
                        this.bodyB.GetLocalPoint(c, this.localAnchorB);
                        this.bodyA.GetLocalVector(d, this.localAxisA);
                        this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle()
                    };
                    return b
                }(va),
                Zb = function(a) {
                    function b(b) {
                        var c = a.call(this, b) || this;
                        c.m_localAnchorA = new r;
                        c.m_localAnchorB =
                            new r;
                        c.m_localXAxisA = new r;
                        c.m_localYAxisA = new r;
                        c.m_referenceAngle = 0;
                        c.m_impulse = new ja(0, 0, 0);
                        c.m_motorImpulse = 0;
                        c.m_lowerTranslation = 0;
                        c.m_upperTranslation = 0;
                        c.m_maxMotorForce = 0;
                        c.m_motorSpeed = 0;
                        c.m_enableLimit = !1;
                        c.m_enableMotor = !1;
                        c.m_limitState = f.b2LimitState.e_inactiveLimit;
                        c.m_indexA = 0;
                        c.m_indexB = 0;
                        c.m_localCenterA = new r;
                        c.m_localCenterB = new r;
                        c.m_invMassA = 0;
                        c.m_invMassB = 0;
                        c.m_invIA = 0;
                        c.m_invIB = 0;
                        c.m_axis = new r(0, 0);
                        c.m_perp = new r(0, 0);
                        c.m_s1 = 0;
                        c.m_s2 = 0;
                        c.m_a1 = 0;
                        c.m_a2 = 0;
                        c.m_K = new ta;
                        c.m_K3 =
                            new ta;
                        c.m_K2 = new la;
                        c.m_motorMass = 0;
                        c.m_qA = new N;
                        c.m_qB = new N;
                        c.m_lalcA = new r;
                        c.m_lalcB = new r;
                        c.m_rA = new r;
                        c.m_rB = new r;
                        c.m_localAnchorA.Copy(e(b.localAnchorA, r.ZERO));
                        c.m_localAnchorB.Copy(e(b.localAnchorB, r.ZERO));
                        c.m_localXAxisA.Copy(e(b.localAxisA, new r(1, 0))).SelfNormalize();
                        r.CrossOneV(c.m_localXAxisA, c.m_localYAxisA);
                        c.m_referenceAngle = e(b.referenceAngle, 0);
                        c.m_lowerTranslation = e(b.lowerTranslation, 0);
                        c.m_upperTranslation = e(b.upperTranslation, 0);
                        c.m_maxMotorForce = e(b.maxMotorForce, 0);
                        c.m_motorSpeed =
                            e(b.motorSpeed, 0);
                        c.m_enableLimit = e(b.enableLimit, !1);
                        c.m_enableMotor = e(b.enableMotor, !1);
                        return c
                    }
                    C(b, a);
                    b.prototype.InitVelocityConstraints = function(a) {
                        this.m_indexA = this.m_bodyA.m_islandIndex;
                        this.m_indexB = this.m_bodyB.m_islandIndex;
                        this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);
                        this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);
                        this.m_invMassA = this.m_bodyA.m_invMass;
                        this.m_invMassB = this.m_bodyB.m_invMass;
                        this.m_invIA = this.m_bodyA.m_invI;
                        this.m_invIB = this.m_bodyB.m_invI;
                        var c =
                            a.positions[this.m_indexA].c,
                            d = a.velocities[this.m_indexA].v,
                            e = a.velocities[this.m_indexA].w,
                            g = a.positions[this.m_indexB].c,
                            h = a.positions[this.m_indexB].a,
                            k = a.velocities[this.m_indexB].v,
                            l = a.velocities[this.m_indexB].w,
                            m = this.m_qA.SetAngle(a.positions[this.m_indexA].a);
                        h = this.m_qB.SetAngle(h);
                        r.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                        var n = N.MulRV(m, this.m_lalcA, this.m_rA);
                        r.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                        var D = N.MulRV(h, this.m_lalcB, this.m_rB),
                            J = r.AddVV(r.SubVV(g,
                                c, r.s_t0), r.SubVV(D, n, r.s_t1), b.InitVelocityConstraints_s_d);
                        c = this.m_invMassA;
                        g = this.m_invMassB;
                        h = this.m_invIA;
                        var p = this.m_invIB;
                        N.MulRV(m, this.m_localXAxisA, this.m_axis);
                        this.m_a1 = r.CrossVV(r.AddVV(J, n, r.s_t0), this.m_axis);
                        this.m_a2 = r.CrossVV(D, this.m_axis);
                        this.m_motorMass = c + g + h * this.m_a1 * this.m_a1 + p * this.m_a2 * this.m_a2;
                        0 < this.m_motorMass && (this.m_motorMass = 1 / this.m_motorMass);
                        N.MulRV(m, this.m_localYAxisA, this.m_perp);
                        this.m_s1 = r.CrossVV(r.AddVV(J, n, r.s_t0), this.m_perp);
                        this.m_s2 = r.CrossVV(D,
                            this.m_perp);
                        this.m_K.ex.x = c + g + h * this.m_s1 * this.m_s1 + p * this.m_s2 * this.m_s2;
                        this.m_K.ex.y = h * this.m_s1 + p * this.m_s2;
                        this.m_K.ex.z = h * this.m_s1 * this.m_a1 + p * this.m_s2 * this.m_a2;
                        this.m_K.ey.x = this.m_K.ex.y;
                        this.m_K.ey.y = h + p;
                        0 === this.m_K.ey.y && (this.m_K.ey.y = 1);
                        this.m_K.ey.z = h * this.m_a1 + p * this.m_a2;
                        this.m_K.ez.x = this.m_K.ex.z;
                        this.m_K.ez.y = this.m_K.ey.z;
                        this.m_K.ez.z = c + g + h * this.m_a1 * this.m_a1 + p * this.m_a2 * this.m_a2;
                        this.m_enableLimit ? (m = r.DotVV(this.m_axis, J), .016 > ba(this.m_upperTranslation - this.m_lowerTranslation) ?
                            this.m_limitState = f.b2LimitState.e_equalLimits : m <= this.m_lowerTranslation ? this.m_limitState !== f.b2LimitState.e_atLowerLimit && (this.m_limitState = f.b2LimitState.e_atLowerLimit, this.m_impulse.z = 0) : m >= this.m_upperTranslation ? this.m_limitState !== f.b2LimitState.e_atUpperLimit && (this.m_limitState = f.b2LimitState.e_atUpperLimit, this.m_impulse.z = 0) : (this.m_limitState = f.b2LimitState.e_inactiveLimit, this.m_impulse.z = 0)) : (this.m_limitState = f.b2LimitState.e_inactiveLimit, this.m_impulse.z = 0);
                        this.m_enableMotor ||
                            (this.m_motorImpulse = 0);
                        a.step.warmStarting ? (this.m_impulse.SelfMul(a.step.dtRatio), this.m_motorImpulse *= a.step.dtRatio, m = r.AddVV(r.MulSV(this.m_impulse.x, this.m_perp, r.s_t0), r.MulSV(this.m_motorImpulse + this.m_impulse.z, this.m_axis, r.s_t1), b.InitVelocityConstraints_s_P), n = this.m_impulse.x * this.m_s1 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a1, D = this.m_impulse.x * this.m_s2 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a2, d.SelfMulSub(c, m), e -= h * n, k.SelfMulAdd(g,
                            m), l += p * D) : (this.m_impulse.SetZero(), this.m_motorImpulse = 0);
                        a.velocities[this.m_indexA].w = e;
                        a.velocities[this.m_indexB].w = l
                    };
                    b.prototype.SolveVelocityConstraints = function(a) {
                        var d = a.velocities[this.m_indexA].v,
                            e = a.velocities[this.m_indexA].w,
                            g = a.velocities[this.m_indexB].v,
                            h = a.velocities[this.m_indexB].w,
                            k = this.m_invMassA,
                            l = this.m_invMassB,
                            m = this.m_invIA,
                            n = this.m_invIB;
                        if (this.m_enableMotor && this.m_limitState !== f.b2LimitState.e_equalLimits) {
                            var D = r.DotVV(this.m_axis, r.SubVV(g, d, r.s_t0)) + this.m_a2 *
                                h - this.m_a1 * e;
                            D = this.m_motorMass * (this.m_motorSpeed - D);
                            var J = this.m_motorImpulse;
                            var p = a.step.dt * this.m_maxMotorForce;
                            this.m_motorImpulse = c(this.m_motorImpulse + D, -p, p);
                            D = this.m_motorImpulse - J;
                            p = r.MulSV(D, this.m_axis, b.SolveVelocityConstraints_s_P);
                            J = D * this.m_a1;
                            D *= this.m_a2;
                            d.SelfMulSub(k, p);
                            e -= m * J;
                            g.SelfMulAdd(l, p);
                            h += n * D
                        }
                        p = r.DotVV(this.m_perp, r.SubVV(g, d, r.s_t0)) + this.m_s2 * h - this.m_s1 * e;
                        var q = h - e;
                        this.m_enableLimit && this.m_limitState !== f.b2LimitState.e_inactiveLimit ? (D = r.DotVV(this.m_axis, r.SubVV(g,
                                d, r.s_t0)) + this.m_a2 * h - this.m_a1 * e, J = b.SolveVelocityConstraints_s_f1.Copy(this.m_impulse), D = this.m_K.Solve33(-p, -q, -D, b.SolveVelocityConstraints_s_df3), this.m_impulse.SelfAdd(D), this.m_limitState === f.b2LimitState.e_atLowerLimit ? this.m_impulse.z = aa(this.m_impulse.z, 0) : this.m_limitState === f.b2LimitState.e_atUpperLimit && (this.m_impulse.z = W(this.m_impulse.z, 0)), p = this.m_K.Solve22(-p - (this.m_impulse.z - J.z) * this.m_K.ez.x, -q - (this.m_impulse.z - J.z) * this.m_K.ez.y, b.SolveVelocityConstraints_s_f2r), p.x += J.x,
                            p.y += J.y, this.m_impulse.x = p.x, this.m_impulse.y = p.y, D.x = this.m_impulse.x - J.x, D.y = this.m_impulse.y - J.y, D.z = this.m_impulse.z - J.z, p = r.AddVV(r.MulSV(D.x, this.m_perp, r.s_t0), r.MulSV(D.z, this.m_axis, r.s_t1), b.SolveVelocityConstraints_s_P), J = D.x * this.m_s1 + D.y + D.z * this.m_a1, D = D.x * this.m_s2 + D.y + D.z * this.m_a2) : (D = this.m_K.Solve22(-p, -q, b.SolveVelocityConstraints_s_df2), this.m_impulse.x += D.x, this.m_impulse.y += D.y, p = r.MulSV(D.x, this.m_perp, b.SolveVelocityConstraints_s_P), J = D.x * this.m_s1 + D.y, D = D.x * this.m_s2 + D.y);
                        d.SelfMulSub(k, p);
                        e -= m * J;
                        g.SelfMulAdd(l, p);
                        a.velocities[this.m_indexA].w = e;
                        a.velocities[this.m_indexB].w = h + n * D
                    };
                    b.prototype.SolvePositionConstraints = function(a) {
                        var d = a.positions[this.m_indexA].c,
                            e = a.positions[this.m_indexA].a,
                            f = a.positions[this.m_indexB].c,
                            g = a.positions[this.m_indexB].a,
                            h = this.m_qA.SetAngle(e),
                            k = this.m_qB.SetAngle(g),
                            l = this.m_invMassA,
                            m = this.m_invMassB,
                            n = this.m_invIA,
                            D = this.m_invIB,
                            J = N.MulRV(h, this.m_lalcA, this.m_rA),
                            p = N.MulRV(k, this.m_lalcB, this.m_rB);
                        var q = r.SubVV(r.AddVV(f, p,
                            r.s_t0), r.AddVV(d, J, r.s_t1), b.SolvePositionConstraints_s_d);
                        var t = N.MulRV(h, this.m_localXAxisA, this.m_axis),
                            Y = r.CrossVV(r.AddVV(q, J, r.s_t0), t);
                        k = r.CrossVV(p, t);
                        h = N.MulRV(h, this.m_localYAxisA, this.m_perp);
                        var u = r.CrossVV(r.AddVV(q, J, r.s_t0), h),
                            v = r.CrossVV(p, h),
                            w = b.SolvePositionConstraints_s_impulse,
                            x = r.DotVV(h, q),
                            y = g - e - this.m_referenceAngle;
                        J = ba(x);
                        p = ba(y);
                        var z = !1;
                        var A = 0;
                        this.m_enableLimit && (q = r.DotVV(t, q), .016 > ba(this.m_upperTranslation - this.m_lowerTranslation) ? (A = c(q, -.2, .2), J = aa(J, ba(q)), z = !0) :
                            q <= this.m_lowerTranslation ? (A = c(q - this.m_lowerTranslation + .008, -.2, 0), J = aa(J, this.m_lowerTranslation - q), z = !0) : q >= this.m_upperTranslation && (A = c(q - this.m_upperTranslation - .008, 0, .2), J = aa(J, q - this.m_upperTranslation), z = !0));
                        if (z) {
                            z = n * u + D * v;
                            var B = n * u * Y + D * v * k;
                            q = n + D;
                            0 === q && (q = 1);
                            var C = n * Y + D * k,
                                E = l + m + n * Y * Y + D * k * k,
                                F = this.m_K3;
                            F.ex.SetXYZ(l + m + n * u * u + D * v * v, z, B);
                            F.ey.SetXYZ(z, q, C);
                            F.ez.SetXYZ(B, C, E);
                            w = F.Solve33(-x, -y, -A, w)
                        } else z = n * u + D * v, q = n + D, 0 === q && (q = 1), A = this.m_K2, A.ex.Set(l + m + n * u * u + D * v * v, z), A.ey.Set(z, q),
                            x = A.Solve(-x, -y, b.SolvePositionConstraints_s_impulse1), w.x = x.x, w.y = x.y, w.z = 0;
                        t = r.AddVV(r.MulSV(w.x, h, r.s_t0), r.MulSV(w.z, t, r.s_t1), b.SolvePositionConstraints_s_P);
                        Y = w.x * u + w.y + w.z * Y;
                        k = w.x * v + w.y + w.z * k;
                        d.SelfMulSub(l, t);
                        e -= n * Y;
                        f.SelfMulAdd(m, t);
                        a.positions[this.m_indexA].a = e;
                        a.positions[this.m_indexB].a = g + D * k;
                        return .008 >= J && p <= V
                    };
                    b.prototype.GetAnchorA = function(a) {
                        return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, a)
                    };
                    b.prototype.GetAnchorB = function(a) {
                        return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,
                            a)
                    };
                    b.prototype.GetReactionForce = function(a, b) {
                        b.x = a * (this.m_impulse.x * this.m_perp.x + (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.x);
                        b.y = a * (this.m_impulse.x * this.m_perp.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.y);
                        return b
                    };
                    b.prototype.GetReactionTorque = function(a) {
                        return a * this.m_impulse.y
                    };
                    b.prototype.GetLocalAnchorA = function() {
                        return this.m_localAnchorA
                    };
                    b.prototype.GetLocalAnchorB = function() {
                        return this.m_localAnchorB
                    };
                    b.prototype.GetLocalAxisA = function() {
                        return this.m_localXAxisA
                    };
                    b.prototype.GetReferenceAngle = function() {
                        return this.m_referenceAngle
                    };
                    b.prototype.GetJointTranslation = function() {
                        var a = this.m_bodyA.GetWorldPoint(this.m_localAnchorA, b.GetJointTranslation_s_pA),
                            c = this.m_bodyB.GetWorldPoint(this.m_localAnchorB, b.GetJointTranslation_s_pB);
                        a = r.SubVV(c, a, b.GetJointTranslation_s_d);
                        c = this.m_bodyA.GetWorldVector(this.m_localXAxisA, b.GetJointTranslation_s_axis);
                        return r.DotVV(a, c)
                    };
                    b.prototype.GetJointSpeed = function() {
                        var a = this.m_bodyA,
                            b = this.m_bodyB;
                        r.SubVV(this.m_localAnchorA,
                            a.m_sweep.localCenter, this.m_lalcA);
                        var c = N.MulRV(a.m_xf.q, this.m_lalcA, this.m_rA);
                        r.SubVV(this.m_localAnchorB, b.m_sweep.localCenter, this.m_lalcB);
                        var d = N.MulRV(b.m_xf.q, this.m_lalcB, this.m_rB),
                            e = r.AddVV(a.m_sweep.c, c, r.s_t0),
                            f = r.AddVV(b.m_sweep.c, d, r.s_t1);
                        e = r.SubVV(f, e, r.s_t2);
                        f = a.GetWorldVector(this.m_localXAxisA, this.m_axis);
                        var g = a.m_linearVelocity,
                            h = b.m_linearVelocity;
                        a = a.m_angularVelocity;
                        b = b.m_angularVelocity;
                        return r.DotVV(e, r.CrossSV(a, f, r.s_t0)) + r.DotVV(f, r.SubVV(r.AddVCrossSV(h, b, d, r.s_t0),
                            r.AddVCrossSV(g, a, c, r.s_t1), r.s_t0))
                    };
                    b.prototype.IsLimitEnabled = function() {
                        return this.m_enableLimit
                    };
                    b.prototype.EnableLimit = function(a) {
                        a !== this.m_enableLimit && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), this.m_enableLimit = a, this.m_impulse.z = 0)
                    };
                    b.prototype.GetLowerLimit = function() {
                        return this.m_lowerTranslation
                    };
                    b.prototype.GetUpperLimit = function() {
                        return this.m_upperTranslation
                    };
                    b.prototype.SetLimits = function(a, b) {
                        if (a !== this.m_lowerTranslation || b !== this.m_upperTranslation) this.m_bodyA.SetAwake(!0),
                            this.m_bodyB.SetAwake(!0), this.m_lowerTranslation = a, this.m_upperTranslation = b, this.m_impulse.z = 0
                    };
                    b.prototype.IsMotorEnabled = function() {
                        return this.m_enableMotor
                    };
                    b.prototype.EnableMotor = function(a) {
                        a !== this.m_enableMotor && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), this.m_enableMotor = a)
                    };
                    b.prototype.SetMotorSpeed = function(a) {
                        a !== this.m_motorSpeed && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), this.m_motorSpeed = a)
                    };
                    b.prototype.GetMotorSpeed = function() {
                        return this.m_motorSpeed
                    };
                    b.prototype.SetMaxMotorForce =
                        function(a) {
                            a !== this.m_maxMotorForce && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), this.m_maxMotorForce = a)
                        };
                    b.prototype.GetMaxMotorForce = function() {
                        return this.m_maxMotorForce
                    };
                    b.prototype.GetMotorForce = function(a) {
                        return a * this.m_motorImpulse
                    };
                    b.prototype.Dump = function(a) {
                        var b = this.m_bodyA.m_islandIndex,
                            c = this.m_bodyB.m_islandIndex;
                        a("  const jd: b2PrismaticJointDef = new b2PrismaticJointDef();\n");
                        a("  jd.bodyA = bodies[%d];\n", b);
                        a("  jd.bodyB = bodies[%d];\n", c);
                        a("  jd.collideConnected = %s;\n",
                            this.m_collideConnected ? "true" : "false");
                        a("  jd.localAnchorA.Set(%.15f, %.15f);\n", this.m_localAnchorA.x, this.m_localAnchorA.y);
                        a("  jd.localAnchorB.Set(%.15f, %.15f);\n", this.m_localAnchorB.x, this.m_localAnchorB.y);
                        a("  jd.localAxisA.Set(%.15f, %.15f);\n", this.m_localXAxisA.x, this.m_localXAxisA.y);
                        a("  jd.referenceAngle = %.15f;\n", this.m_referenceAngle);
                        a("  jd.enableLimit = %s;\n", this.m_enableLimit ? "true" : "false");
                        a("  jd.lowerTranslation = %.15f;\n", this.m_lowerTranslation);
                        a("  jd.upperTranslation = %.15f;\n",
                            this.m_upperTranslation);
                        a("  jd.enableMotor = %s;\n", this.m_enableMotor ? "true" : "false");
                        a("  jd.motorSpeed = %.15f;\n", this.m_motorSpeed);
                        a("  jd.maxMotorForce = %.15f;\n", this.m_maxMotorForce);
                        a("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index)
                    };
                    b.InitVelocityConstraints_s_d = new r;
                    b.InitVelocityConstraints_s_P = new r;
                    b.SolveVelocityConstraints_s_P = new r;
                    b.SolveVelocityConstraints_s_f2r = new r;
                    b.SolveVelocityConstraints_s_f1 = new ja;
                    b.SolveVelocityConstraints_s_df3 = new ja;
                    b.SolveVelocityConstraints_s_df2 =
                        new r;
                    b.SolvePositionConstraints_s_d = new r;
                    b.SolvePositionConstraints_s_impulse = new ja;
                    b.SolvePositionConstraints_s_impulse1 = new r;
                    b.SolvePositionConstraints_s_P = new r;
                    b.GetJointTranslation_s_pA = new r;
                    b.GetJointTranslation_s_pB = new r;
                    b.GetJointTranslation_s_d = new r;
                    b.GetJointTranslation_s_axis = new r;
                    return b
                }(wa),
                Qd = function(a) {
                    function b() {
                        var b = a.call(this, f.b2JointType.e_pulleyJoint) || this;
                        b.groundAnchorA = new r(-1, 1);
                        b.groundAnchorB = new r(1, 1);
                        b.localAnchorA = new r(-1, 0);
                        b.localAnchorB = new r(1,
                            0);
                        b.lengthA = 0;
                        b.lengthB = 0;
                        b.ratio = 1;
                        b.collideConnected = !0;
                        return b
                    }
                    C(b, a);
                    b.prototype.Initialize = function(a, b, c, d, e, f, g) {
                        this.bodyA = a;
                        this.bodyB = b;
                        this.groundAnchorA.Copy(c);
                        this.groundAnchorB.Copy(d);
                        this.bodyA.GetLocalPoint(e, this.localAnchorA);
                        this.bodyB.GetLocalPoint(f, this.localAnchorB);
                        this.lengthA = r.DistanceVV(e, c);
                        this.lengthB = r.DistanceVV(f, d);
                        this.ratio = g
                    };
                    return b
                }(va),
                $b = function(a) {
                    function b(b) {
                        var c = a.call(this, b) || this;
                        c.m_groundAnchorA = new r;
                        c.m_groundAnchorB = new r;
                        c.m_lengthA = 0;
                        c.m_lengthB = 0;
                        c.m_localAnchorA = new r;
                        c.m_localAnchorB = new r;
                        c.m_constant = 0;
                        c.m_ratio = 0;
                        c.m_impulse = 0;
                        c.m_indexA = 0;
                        c.m_indexB = 0;
                        c.m_uA = new r;
                        c.m_uB = new r;
                        c.m_rA = new r;
                        c.m_rB = new r;
                        c.m_localCenterA = new r;
                        c.m_localCenterB = new r;
                        c.m_invMassA = 0;
                        c.m_invMassB = 0;
                        c.m_invIA = 0;
                        c.m_invIB = 0;
                        c.m_mass = 0;
                        c.m_qA = new N;
                        c.m_qB = new N;
                        c.m_lalcA = new r;
                        c.m_lalcB = new r;
                        c.m_groundAnchorA.Copy(e(b.groundAnchorA, new r(-1, 1)));
                        c.m_groundAnchorB.Copy(e(b.groundAnchorB, new r(1, 0)));
                        c.m_localAnchorA.Copy(e(b.localAnchorA, new r(-1,
                            0)));
                        c.m_localAnchorB.Copy(e(b.localAnchorB, new r(1, 0)));
                        c.m_lengthA = e(b.lengthA, 0);
                        c.m_lengthB = e(b.lengthB, 0);
                        c.m_ratio = e(b.ratio, 1);
                        c.m_constant = e(b.lengthA, 0) + c.m_ratio * e(b.lengthB, 0);
                        c.m_impulse = 0;
                        return c
                    }
                    C(b, a);
                    b.prototype.InitVelocityConstraints = function(a) {
                        this.m_indexA = this.m_bodyA.m_islandIndex;
                        this.m_indexB = this.m_bodyB.m_islandIndex;
                        this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);
                        this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);
                        this.m_invMassA = this.m_bodyA.m_invMass;
                        this.m_invMassB = this.m_bodyB.m_invMass;
                        this.m_invIA = this.m_bodyA.m_invI;
                        this.m_invIB = this.m_bodyB.m_invI;
                        var c = a.positions[this.m_indexA].c,
                            d = a.velocities[this.m_indexA].v,
                            e = a.velocities[this.m_indexA].w,
                            f = a.positions[this.m_indexB].c,
                            g = a.positions[this.m_indexB].a,
                            h = a.velocities[this.m_indexB].v,
                            k = a.velocities[this.m_indexB].w,
                            l = this.m_qA.SetAngle(a.positions[this.m_indexA].a);
                        g = this.m_qB.SetAngle(g);
                        r.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                        N.MulRV(l, this.m_lalcA, this.m_rA);
                        r.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                        N.MulRV(g, this.m_lalcB, this.m_rB);
                        this.m_uA.Copy(c).SelfAdd(this.m_rA).SelfSub(this.m_groundAnchorA);
                        this.m_uB.Copy(f).SelfAdd(this.m_rB).SelfSub(this.m_groundAnchorB);
                        c = this.m_uA.Length();
                        f = this.m_uB.Length();
                        .08 < c ? this.m_uA.SelfMul(1 / c) : this.m_uA.SetZero();
                        .08 < f ? this.m_uB.SelfMul(1 / f) : this.m_uB.SetZero();
                        c = r.CrossVV(this.m_rA, this.m_uA);
                        f = r.CrossVV(this.m_rB, this.m_uB);
                        this.m_mass = this.m_invMassA + this.m_invIA * c * c + this.m_ratio * this.m_ratio *
                            (this.m_invMassB + this.m_invIB * f * f);
                        0 < this.m_mass && (this.m_mass = 1 / this.m_mass);
                        a.step.warmStarting ? (this.m_impulse *= a.step.dtRatio, c = r.MulSV(-this.m_impulse, this.m_uA, b.InitVelocityConstraints_s_PA), f = r.MulSV(-this.m_ratio * this.m_impulse, this.m_uB, b.InitVelocityConstraints_s_PB), d.SelfMulAdd(this.m_invMassA, c), e += this.m_invIA * r.CrossVV(this.m_rA, c), h.SelfMulAdd(this.m_invMassB, f), k += this.m_invIB * r.CrossVV(this.m_rB, f)) : this.m_impulse = 0;
                        a.velocities[this.m_indexA].w = e;
                        a.velocities[this.m_indexB].w =
                            k
                    };
                    b.prototype.SolveVelocityConstraints = function(a) {
                        var c = a.velocities[this.m_indexA].v,
                            d = a.velocities[this.m_indexA].w,
                            e = a.velocities[this.m_indexB].v,
                            f = a.velocities[this.m_indexB].w,
                            g = r.AddVCrossSV(c, d, this.m_rA, b.SolveVelocityConstraints_s_vpA),
                            h = r.AddVCrossSV(e, f, this.m_rB, b.SolveVelocityConstraints_s_vpB);
                        g = -r.DotVV(this.m_uA, g) - this.m_ratio * r.DotVV(this.m_uB, h);
                        h = -this.m_mass * g;
                        this.m_impulse += h;
                        g = r.MulSV(-h, this.m_uA, b.SolveVelocityConstraints_s_PA);
                        h = r.MulSV(-this.m_ratio * h, this.m_uB, b.SolveVelocityConstraints_s_PB);
                        c.SelfMulAdd(this.m_invMassA, g);
                        d += this.m_invIA * r.CrossVV(this.m_rA, g);
                        e.SelfMulAdd(this.m_invMassB, h);
                        f += this.m_invIB * r.CrossVV(this.m_rB, h);
                        a.velocities[this.m_indexA].w = d;
                        a.velocities[this.m_indexB].w = f
                    };
                    b.prototype.SolvePositionConstraints = function(a) {
                        var c = a.positions[this.m_indexA].c,
                            d = a.positions[this.m_indexA].a,
                            e = a.positions[this.m_indexB].c,
                            f = a.positions[this.m_indexB].a,
                            g = this.m_qA.SetAngle(d),
                            h = this.m_qB.SetAngle(f);
                        r.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                        g = N.MulRV(g,
                            this.m_lalcA, this.m_rA);
                        r.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                        h = N.MulRV(h, this.m_lalcB, this.m_rB);
                        var k = this.m_uA.Copy(c).SelfAdd(g).SelfSub(this.m_groundAnchorA),
                            l = this.m_uB.Copy(e).SelfAdd(h).SelfSub(this.m_groundAnchorB),
                            m = k.Length(),
                            n = l.Length();
                        .08 < m ? k.SelfMul(1 / m) : k.SetZero();
                        .08 < n ? l.SelfMul(1 / n) : l.SetZero();
                        var D = r.CrossVV(g, k),
                            J = r.CrossVV(h, l);
                        D = this.m_invMassA + this.m_invIA * D * D + this.m_ratio * this.m_ratio * (this.m_invMassB + this.m_invIB * J * J);
                        0 < D && (D = 1 / D);
                        n = this.m_constant -
                            m - this.m_ratio * n;
                        m = ba(n);
                        n *= -D;
                        k = r.MulSV(-n, k, b.SolvePositionConstraints_s_PA);
                        l = r.MulSV(-this.m_ratio * n, l, b.SolvePositionConstraints_s_PB);
                        c.SelfMulAdd(this.m_invMassA, k);
                        d += this.m_invIA * r.CrossVV(g, k);
                        e.SelfMulAdd(this.m_invMassB, l);
                        f += this.m_invIB * r.CrossVV(h, l);
                        a.positions[this.m_indexA].a = d;
                        a.positions[this.m_indexB].a = f;
                        return .008 > m
                    };
                    b.prototype.GetAnchorA = function(a) {
                        return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, a)
                    };
                    b.prototype.GetAnchorB = function(a) {
                        return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,
                            a)
                    };
                    b.prototype.GetReactionForce = function(a, b) {
                        b.x = a * this.m_impulse * this.m_uB.x;
                        b.y = a * this.m_impulse * this.m_uB.y;
                        return b
                    };
                    b.prototype.GetReactionTorque = function(a) {
                        return 0
                    };
                    b.prototype.GetGroundAnchorA = function() {
                        return this.m_groundAnchorA
                    };
                    b.prototype.GetGroundAnchorB = function() {
                        return this.m_groundAnchorB
                    };
                    b.prototype.GetLengthA = function() {
                        return this.m_lengthA
                    };
                    b.prototype.GetLengthB = function() {
                        return this.m_lengthB
                    };
                    b.prototype.GetRatio = function() {
                        return this.m_ratio
                    };
                    b.prototype.GetCurrentLengthA =
                        function() {
                            var a = this.m_bodyA.GetWorldPoint(this.m_localAnchorA, b.GetCurrentLengthA_s_p);
                            return r.DistanceVV(a, this.m_groundAnchorA)
                        };
                    b.prototype.GetCurrentLengthB = function() {
                        var a = this.m_bodyB.GetWorldPoint(this.m_localAnchorB, b.GetCurrentLengthB_s_p);
                        return r.DistanceVV(a, this.m_groundAnchorB)
                    };
                    b.prototype.Dump = function(a) {
                        var b = this.m_bodyA.m_islandIndex,
                            c = this.m_bodyB.m_islandIndex;
                        a("  const jd: b2PulleyJointDef = new b2PulleyJointDef();\n");
                        a("  jd.bodyA = bodies[%d];\n", b);
                        a("  jd.bodyB = bodies[%d];\n",
                            c);
                        a("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false");
                        a("  jd.groundAnchorA.Set(%.15f, %.15f);\n", this.m_groundAnchorA.x, this.m_groundAnchorA.y);
                        a("  jd.groundAnchorB.Set(%.15f, %.15f);\n", this.m_groundAnchorB.x, this.m_groundAnchorB.y);
                        a("  jd.localAnchorA.Set(%.15f, %.15f);\n", this.m_localAnchorA.x, this.m_localAnchorA.y);
                        a("  jd.localAnchorB.Set(%.15f, %.15f);\n", this.m_localAnchorB.x, this.m_localAnchorB.y);
                        a("  jd.lengthA = %.15f;\n", this.m_lengthA);
                        a("  jd.lengthB = %.15f;\n",
                            this.m_lengthB);
                        a("  jd.ratio = %.15f;\n", this.m_ratio);
                        a("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index)
                    };
                    b.prototype.ShiftOrigin = function(a) {
                        this.m_groundAnchorA.SelfSub(a);
                        this.m_groundAnchorB.SelfSub(a)
                    };
                    b.InitVelocityConstraints_s_PA = new r;
                    b.InitVelocityConstraints_s_PB = new r;
                    b.SolveVelocityConstraints_s_vpA = new r;
                    b.SolveVelocityConstraints_s_vpB = new r;
                    b.SolveVelocityConstraints_s_PA = new r;
                    b.SolveVelocityConstraints_s_PB = new r;
                    b.SolvePositionConstraints_s_PA = new r;
                    b.SolvePositionConstraints_s_PB =
                        new r;
                    b.GetCurrentLengthA_s_p = new r;
                    b.GetCurrentLengthB_s_p = new r;
                    return b
                }(wa),
                Rd = function(a) {
                    function b() {
                        var b = a.call(this, f.b2JointType.e_revoluteJoint) || this;
                        b.localAnchorA = new r(0, 0);
                        b.localAnchorB = new r(0, 0);
                        b.referenceAngle = 0;
                        b.enableLimit = !1;
                        b.lowerAngle = 0;
                        b.upperAngle = 0;
                        b.enableMotor = !1;
                        b.motorSpeed = 0;
                        b.maxMotorTorque = 0;
                        return b
                    }
                    C(b, a);
                    b.prototype.Initialize = function(a, b, c) {
                        this.bodyA = a;
                        this.bodyB = b;
                        this.bodyA.GetLocalPoint(c, this.localAnchorA);
                        this.bodyB.GetLocalPoint(c, this.localAnchorB);
                        this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle()
                    };
                    return b
                }(va),
                ac = function(a) {
                    function b(b) {
                        var c = a.call(this, b) || this;
                        c.m_localAnchorA = new r;
                        c.m_localAnchorB = new r;
                        c.m_impulse = new ja;
                        c.m_motorImpulse = 0;
                        c.m_enableMotor = !1;
                        c.m_maxMotorTorque = 0;
                        c.m_motorSpeed = 0;
                        c.m_enableLimit = !1;
                        c.m_referenceAngle = 0;
                        c.m_lowerAngle = 0;
                        c.m_upperAngle = 0;
                        c.m_indexA = 0;
                        c.m_indexB = 0;
                        c.m_rA = new r;
                        c.m_rB = new r;
                        c.m_localCenterA = new r;
                        c.m_localCenterB = new r;
                        c.m_invMassA = 0;
                        c.m_invMassB = 0;
                        c.m_invIA = 0;
                        c.m_invIB = 0;
                        c.m_mass = new ta;
                        c.m_motorMass = 0;
                        c.m_limitState = f.b2LimitState.e_inactiveLimit;
                        c.m_qA = new N;
                        c.m_qB = new N;
                        c.m_lalcA = new r;
                        c.m_lalcB = new r;
                        c.m_K = new la;
                        c.m_localAnchorA.Copy(e(b.localAnchorA, r.ZERO));
                        c.m_localAnchorB.Copy(e(b.localAnchorB, r.ZERO));
                        c.m_referenceAngle = e(b.referenceAngle, 0);
                        c.m_impulse.SetZero();
                        c.m_motorImpulse = 0;
                        c.m_lowerAngle = e(b.lowerAngle, 0);
                        c.m_upperAngle = e(b.upperAngle, 0);
                        c.m_maxMotorTorque = e(b.maxMotorTorque, 0);
                        c.m_motorSpeed = e(b.motorSpeed, 0);
                        c.m_enableLimit = e(b.enableLimit, !1);
                        c.m_enableMotor = e(b.enableMotor, !1);
                        c.m_limitState = f.b2LimitState.e_inactiveLimit;
                        return c
                    }
                    C(b, a);
                    b.prototype.InitVelocityConstraints = function(a) {
                        this.m_indexA = this.m_bodyA.m_islandIndex;
                        this.m_indexB = this.m_bodyB.m_islandIndex;
                        this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);
                        this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);
                        this.m_invMassA = this.m_bodyA.m_invMass;
                        this.m_invMassB = this.m_bodyB.m_invMass;
                        this.m_invIA = this.m_bodyA.m_invI;
                        this.m_invIB = this.m_bodyB.m_invI;
                        var c = a.positions[this.m_indexA].a,
                            d = a.velocities[this.m_indexA].v,
                            e = a.velocities[this.m_indexA].w,
                            g = a.positions[this.m_indexB].a,
                            h = a.velocities[this.m_indexB].v,
                            k = a.velocities[this.m_indexB].w,
                            l = this.m_qA.SetAngle(c),
                            m = this.m_qB.SetAngle(g);
                        r.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                        N.MulRV(l, this.m_lalcA, this.m_rA);
                        r.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                        N.MulRV(m, this.m_lalcB, this.m_rB);
                        l = this.m_invMassA;
                        m = this.m_invMassB;
                        var n = this.m_invIA,
                            D = this.m_invIB,
                            J = 0 === n + D;
                        this.m_mass.ex.x = l + m + this.m_rA.y *
                            this.m_rA.y * n + this.m_rB.y * this.m_rB.y * D;
                        this.m_mass.ey.x = -this.m_rA.y * this.m_rA.x * n - this.m_rB.y * this.m_rB.x * D;
                        this.m_mass.ez.x = -this.m_rA.y * n - this.m_rB.y * D;
                        this.m_mass.ex.y = this.m_mass.ey.x;
                        this.m_mass.ey.y = l + m + this.m_rA.x * this.m_rA.x * n + this.m_rB.x * this.m_rB.x * D;
                        this.m_mass.ez.y = this.m_rA.x * n + this.m_rB.x * D;
                        this.m_mass.ex.z = this.m_mass.ez.x;
                        this.m_mass.ey.z = this.m_mass.ez.y;
                        this.m_mass.ez.z = n + D;
                        this.m_motorMass = n + D;
                        0 < this.m_motorMass && (this.m_motorMass = 1 / this.m_motorMass);
                        this.m_enableMotor && !J || (this.m_motorImpulse =
                            0);
                        this.m_enableLimit && !J ? (c = g - c - this.m_referenceAngle, ba(this.m_upperAngle - this.m_lowerAngle) < 2 * V ? this.m_limitState = f.b2LimitState.e_equalLimits : c <= this.m_lowerAngle ? (this.m_limitState !== f.b2LimitState.e_atLowerLimit && (this.m_impulse.z = 0), this.m_limitState = f.b2LimitState.e_atLowerLimit) : c >= this.m_upperAngle ? (this.m_limitState !== f.b2LimitState.e_atUpperLimit && (this.m_impulse.z = 0), this.m_limitState = f.b2LimitState.e_atUpperLimit) : (this.m_limitState = f.b2LimitState.e_inactiveLimit, this.m_impulse.z = 0)) :
                            this.m_limitState = f.b2LimitState.e_inactiveLimit;
                        a.step.warmStarting ? (this.m_impulse.SelfMul(a.step.dtRatio), this.m_motorImpulse *= a.step.dtRatio, c = b.InitVelocityConstraints_s_P.Set(this.m_impulse.x, this.m_impulse.y), d.SelfMulSub(l, c), e -= n * (r.CrossVV(this.m_rA, c) + this.m_motorImpulse + this.m_impulse.z), h.SelfMulAdd(m, c), k += D * (r.CrossVV(this.m_rB, c) + this.m_motorImpulse + this.m_impulse.z)) : (this.m_impulse.SetZero(), this.m_motorImpulse = 0);
                        a.velocities[this.m_indexA].w = e;
                        a.velocities[this.m_indexB].w = k
                    };
                    b.prototype.SolveVelocityConstraints = function(a) {
                        var d = a.velocities[this.m_indexA].v,
                            e = a.velocities[this.m_indexA].w,
                            g = a.velocities[this.m_indexB].v,
                            h = a.velocities[this.m_indexB].w,
                            k = this.m_invMassA,
                            l = this.m_invMassB,
                            m = this.m_invIA,
                            n = this.m_invIB,
                            D = 0 === m + n;
                        if (this.m_enableMotor && this.m_limitState !== f.b2LimitState.e_equalLimits && !D) {
                            var J = -this.m_motorMass * (h - e - this.m_motorSpeed);
                            var p = this.m_motorImpulse;
                            var q = a.step.dt * this.m_maxMotorTorque;
                            this.m_motorImpulse = c(this.m_motorImpulse + J, -q, q);
                            J = this.m_motorImpulse -
                                p;
                            e -= m * J;
                            h += n * J
                        }
                        this.m_enableLimit && this.m_limitState !== f.b2LimitState.e_inactiveLimit && !D ? (p = r.SubVV(r.AddVCrossSV(g, h, this.m_rB, r.s_t0), r.AddVCrossSV(d, e, this.m_rA, r.s_t1), b.SolveVelocityConstraints_s_Cdot1), D = this.m_mass.Solve33(p.x, p.y, h - e, b.SolveVelocityConstraints_s_impulse_v3).SelfNeg(), this.m_limitState === f.b2LimitState.e_equalLimits ? this.m_impulse.SelfAdd(D) : this.m_limitState === f.b2LimitState.e_atLowerLimit ? (J = this.m_impulse.z + D.z, 0 > J ? (J = -p.x + this.m_impulse.z * this.m_mass.ez.x, p = -p.y + this.m_impulse.z *
                            this.m_mass.ez.y, J = this.m_mass.Solve22(J, p, b.SolveVelocityConstraints_s_reduced_v2), D.x = J.x, D.y = J.y, D.z = -this.m_impulse.z, this.m_impulse.x += J.x, this.m_impulse.y += J.y, this.m_impulse.z = 0) : this.m_impulse.SelfAdd(D)) : this.m_limitState === f.b2LimitState.e_atUpperLimit && (J = this.m_impulse.z + D.z, 0 < J ? (J = -p.x + this.m_impulse.z * this.m_mass.ez.x, p = -p.y + this.m_impulse.z * this.m_mass.ez.y, J = this.m_mass.Solve22(J, p, b.SolveVelocityConstraints_s_reduced_v2), D.x = J.x, D.y = J.y, D.z = -this.m_impulse.z, this.m_impulse.x += J.x,
                            this.m_impulse.y += J.y, this.m_impulse.z = 0) : this.m_impulse.SelfAdd(D)), J = b.SolveVelocityConstraints_s_P.Set(D.x, D.y), d.SelfMulSub(k, J), e -= m * (r.CrossVV(this.m_rA, J) + D.z), g.SelfMulAdd(l, J), h += n * (r.CrossVV(this.m_rB, J) + D.z)) : (D = r.SubVV(r.AddVCrossSV(g, h, this.m_rB, r.s_t0), r.AddVCrossSV(d, e, this.m_rA, r.s_t1), b.SolveVelocityConstraints_s_Cdot_v2), D = this.m_mass.Solve22(-D.x, -D.y, b.SolveVelocityConstraints_s_impulse_v2), this.m_impulse.x += D.x, this.m_impulse.y += D.y, d.SelfMulSub(k, D), e -= m * r.CrossVV(this.m_rA,
                            D), g.SelfMulAdd(l, D), h += n * r.CrossVV(this.m_rB, D));
                        a.velocities[this.m_indexA].w = e;
                        a.velocities[this.m_indexB].w = h
                    };
                    b.prototype.SolvePositionConstraints = function(a) {
                        var d = a.positions[this.m_indexA].c,
                            e = a.positions[this.m_indexA].a,
                            g = a.positions[this.m_indexB].c,
                            h = a.positions[this.m_indexB].a,
                            k = this.m_qA.SetAngle(e),
                            l = this.m_qB.SetAngle(h),
                            m = 0,
                            n = 0 === this.m_invIA + this.m_invIB;
                        if (this.m_enableLimit && this.m_limitState !== f.b2LimitState.e_inactiveLimit && !n) {
                            var D = h - e - this.m_referenceAngle;
                            n = 0;
                            this.m_limitState ===
                                f.b2LimitState.e_equalLimits ? (D = c(D - this.m_lowerAngle, -Z, Z), n = -this.m_motorMass * D, m = ba(D)) : this.m_limitState === f.b2LimitState.e_atLowerLimit ? (D -= this.m_lowerAngle, m = -D, D = c(D + V, -Z, 0), n = -this.m_motorMass * D) : this.m_limitState === f.b2LimitState.e_atUpperLimit && (m = D -= this.m_upperAngle, D = c(D - V, 0, Z), n = -this.m_motorMass * D);
                            e -= this.m_invIA * n;
                            h += this.m_invIB * n
                        }
                        k.SetAngle(e);
                        l.SetAngle(h);
                        r.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                        k = N.MulRV(k, this.m_lalcA, this.m_rA);
                        r.SubVV(this.m_localAnchorB,
                            this.m_localCenterB, this.m_lalcB);
                        n = N.MulRV(l, this.m_lalcB, this.m_rB);
                        var J = r.SubVV(r.AddVV(g, n, r.s_t0), r.AddVV(d, k, r.s_t1), b.SolvePositionConstraints_s_C_v2);
                        l = J.Length();
                        D = this.m_invMassA;
                        var p = this.m_invMassB,
                            q = this.m_invIA,
                            t = this.m_invIB,
                            Y = this.m_K;
                        Y.ex.x = D + p + q * k.y * k.y + t * n.y * n.y;
                        Y.ex.y = -q * k.x * k.y - t * n.x * n.y;
                        Y.ey.x = Y.ex.y;
                        Y.ey.y = D + p + q * k.x * k.x + t * n.x * n.x;
                        J = Y.Solve(J.x, J.y, b.SolvePositionConstraints_s_impulse).SelfNeg();
                        d.SelfMulSub(D, J);
                        e -= q * r.CrossVV(k, J);
                        g.SelfMulAdd(p, J);
                        h += t * r.CrossVV(n, J);
                        a.positions[this.m_indexA].a =
                            e;
                        a.positions[this.m_indexB].a = h;
                        return .008 >= l && m <= V
                    };
                    b.prototype.GetAnchorA = function(a) {
                        return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, a)
                    };
                    b.prototype.GetAnchorB = function(a) {
                        return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, a)
                    };
                    b.prototype.GetReactionForce = function(a, b) {
                        b.x = a * this.m_impulse.x;
                        b.y = a * this.m_impulse.y;
                        return b
                    };
                    b.prototype.GetReactionTorque = function(a) {
                        return a * this.m_impulse.z
                    };
                    b.prototype.GetLocalAnchorA = function() {
                        return this.m_localAnchorA
                    };
                    b.prototype.GetLocalAnchorB =
                        function() {
                            return this.m_localAnchorB
                        };
                    b.prototype.GetReferenceAngle = function() {
                        return this.m_referenceAngle
                    };
                    b.prototype.GetJointAngle = function() {
                        return this.m_bodyB.m_sweep.a - this.m_bodyA.m_sweep.a - this.m_referenceAngle
                    };
                    b.prototype.GetJointSpeed = function() {
                        return this.m_bodyB.m_angularVelocity - this.m_bodyA.m_angularVelocity
                    };
                    b.prototype.IsMotorEnabled = function() {
                        return this.m_enableMotor
                    };
                    b.prototype.EnableMotor = function(a) {
                        a !== this.m_enableMotor && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0),
                            this.m_enableMotor = a)
                    };
                    b.prototype.GetMotorTorque = function(a) {
                        return a * this.m_motorImpulse
                    };
                    b.prototype.GetMotorSpeed = function() {
                        return this.m_motorSpeed
                    };
                    b.prototype.SetMaxMotorTorque = function(a) {
                        a !== this.m_maxMotorTorque && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), this.m_maxMotorTorque = a)
                    };
                    b.prototype.GetMaxMotorTorque = function() {
                        return this.m_maxMotorTorque
                    };
                    b.prototype.IsLimitEnabled = function() {
                        return this.m_enableLimit
                    };
                    b.prototype.EnableLimit = function(a) {
                        a !== this.m_enableLimit && (this.m_bodyA.SetAwake(!0),
                            this.m_bodyB.SetAwake(!0), this.m_enableLimit = a, this.m_impulse.z = 0)
                    };
                    b.prototype.GetLowerLimit = function() {
                        return this.m_lowerAngle
                    };
                    b.prototype.GetUpperLimit = function() {
                        return this.m_upperAngle
                    };
                    b.prototype.SetLimits = function(a, b) {
                        if (a !== this.m_lowerAngle || b !== this.m_upperAngle) this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), this.m_impulse.z = 0, this.m_lowerAngle = a, this.m_upperAngle = b
                    };
                    b.prototype.SetMotorSpeed = function(a) {
                        a !== this.m_motorSpeed && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0),
                            this.m_motorSpeed = a)
                    };
                    b.prototype.Dump = function(a) {
                        var b = this.m_bodyA.m_islandIndex,
                            c = this.m_bodyB.m_islandIndex;
                        a("  const jd: b2RevoluteJointDef = new b2RevoluteJointDef();\n");
                        a("  jd.bodyA = bodies[%d];\n", b);
                        a("  jd.bodyB = bodies[%d];\n", c);
                        a("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false");
                        a("  jd.localAnchorA.Set(%.15f, %.15f);\n", this.m_localAnchorA.x, this.m_localAnchorA.y);
                        a("  jd.localAnchorB.Set(%.15f, %.15f);\n", this.m_localAnchorB.x, this.m_localAnchorB.y);
                        a("  jd.referenceAngle = %.15f;\n",
                            this.m_referenceAngle);
                        a("  jd.enableLimit = %s;\n", this.m_enableLimit ? "true" : "false");
                        a("  jd.lowerAngle = %.15f;\n", this.m_lowerAngle);
                        a("  jd.upperAngle = %.15f;\n", this.m_upperAngle);
                        a("  jd.enableMotor = %s;\n", this.m_enableMotor ? "true" : "false");
                        a("  jd.motorSpeed = %.15f;\n", this.m_motorSpeed);
                        a("  jd.maxMotorTorque = %.15f;\n", this.m_maxMotorTorque);
                        a("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index)
                    };
                    b.InitVelocityConstraints_s_P = new r;
                    b.SolveVelocityConstraints_s_P = new r;
                    b.SolveVelocityConstraints_s_Cdot_v2 =
                        new r;
                    b.SolveVelocityConstraints_s_Cdot1 = new r;
                    b.SolveVelocityConstraints_s_impulse_v3 = new ja;
                    b.SolveVelocityConstraints_s_reduced_v2 = new r;
                    b.SolveVelocityConstraints_s_impulse_v2 = new r;
                    b.SolvePositionConstraints_s_C_v2 = new r;
                    b.SolvePositionConstraints_s_impulse = new r;
                    return b
                }(wa),
                Sd = function(a) {
                    function b() {
                        var b = a.call(this, f.b2JointType.e_ropeJoint) || this;
                        b.localAnchorA = new r(-1, 0);
                        b.localAnchorB = new r(1, 0);
                        b.maxLength = 0;
                        return b
                    }
                    C(b, a);
                    return b
                }(va),
                bc = function(a) {
                    function b(b) {
                        var c = a.call(this,
                            b) || this;
                        c.m_localAnchorA = new r;
                        c.m_localAnchorB = new r;
                        c.m_maxLength = 0;
                        c.m_length = 0;
                        c.m_impulse = 0;
                        c.m_indexA = 0;
                        c.m_indexB = 0;
                        c.m_u = new r;
                        c.m_rA = new r;
                        c.m_rB = new r;
                        c.m_localCenterA = new r;
                        c.m_localCenterB = new r;
                        c.m_invMassA = 0;
                        c.m_invMassB = 0;
                        c.m_invIA = 0;
                        c.m_invIB = 0;
                        c.m_mass = 0;
                        c.m_state = f.b2LimitState.e_inactiveLimit;
                        c.m_qA = new N;
                        c.m_qB = new N;
                        c.m_lalcA = new r;
                        c.m_lalcB = new r;
                        c.m_localAnchorA.Copy(e(b.localAnchorA, new r(-1, 0)));
                        c.m_localAnchorB.Copy(e(b.localAnchorB, new r(1, 0)));
                        c.m_maxLength = e(b.maxLength,
                            0);
                        return c
                    }
                    C(b, a);
                    b.prototype.InitVelocityConstraints = function(a) {
                        this.m_indexA = this.m_bodyA.m_islandIndex;
                        this.m_indexB = this.m_bodyB.m_islandIndex;
                        this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);
                        this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);
                        this.m_invMassA = this.m_bodyA.m_invMass;
                        this.m_invMassB = this.m_bodyB.m_invMass;
                        this.m_invIA = this.m_bodyA.m_invI;
                        this.m_invIB = this.m_bodyB.m_invI;
                        var c = a.positions[this.m_indexA].c,
                            d = a.velocities[this.m_indexA].v,
                            e = a.velocities[this.m_indexA].w,
                            g = a.positions[this.m_indexB].c,
                            h = a.positions[this.m_indexB].a,
                            k = a.velocities[this.m_indexB].v,
                            l = a.velocities[this.m_indexB].w,
                            m = this.m_qA.SetAngle(a.positions[this.m_indexA].a);
                        h = this.m_qB.SetAngle(h);
                        r.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                        N.MulRV(m, this.m_lalcA, this.m_rA);
                        r.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                        N.MulRV(h, this.m_lalcB, this.m_rB);
                        this.m_u.Copy(g).SelfAdd(this.m_rB).SelfSub(c).SelfSub(this.m_rA);
                        this.m_length = this.m_u.Length();
                        this.m_state =
                            0 < this.m_length - this.m_maxLength ? f.b2LimitState.e_atUpperLimit : f.b2LimitState.e_inactiveLimit;
                        .008 < this.m_length ? (this.m_u.SelfMul(1 / this.m_length), c = r.CrossVV(this.m_rA, this.m_u), g = r.CrossVV(this.m_rB, this.m_u), c = this.m_invMassA + this.m_invIA * c * c + this.m_invMassB + this.m_invIB * g * g, this.m_mass = 0 !== c ? 1 / c : 0, a.step.warmStarting ? (this.m_impulse *= a.step.dtRatio, c = r.MulSV(this.m_impulse, this.m_u, b.InitVelocityConstraints_s_P), d.SelfMulSub(this.m_invMassA, c), e -= this.m_invIA * r.CrossVV(this.m_rA, c), k.SelfMulAdd(this.m_invMassB,
                            c), l += this.m_invIB * r.CrossVV(this.m_rB, c)) : this.m_impulse = 0, a.velocities[this.m_indexA].w = e, a.velocities[this.m_indexB].w = l) : (this.m_u.SetZero(), this.m_impulse = this.m_mass = 0)
                    };
                    b.prototype.SolveVelocityConstraints = function(a) {
                        var c = a.velocities[this.m_indexA].v,
                            d = a.velocities[this.m_indexA].w,
                            e = a.velocities[this.m_indexB].v,
                            f = a.velocities[this.m_indexB].w,
                            g = r.AddVCrossSV(c, d, this.m_rA, b.SolveVelocityConstraints_s_vpA),
                            h = r.AddVCrossSV(e, f, this.m_rB, b.SolveVelocityConstraints_s_vpB),
                            k = this.m_length -
                            this.m_maxLength;
                        g = r.DotVV(this.m_u, r.SubVV(h, g, r.s_t0));
                        0 > k && (g += a.step.inv_dt * k);
                        k = -this.m_mass * g;
                        g = this.m_impulse;
                        this.m_impulse = W(0, this.m_impulse + k);
                        k = this.m_impulse - g;
                        k = r.MulSV(k, this.m_u, b.SolveVelocityConstraints_s_P);
                        c.SelfMulSub(this.m_invMassA, k);
                        d -= this.m_invIA * r.CrossVV(this.m_rA, k);
                        e.SelfMulAdd(this.m_invMassB, k);
                        f += this.m_invIB * r.CrossVV(this.m_rB, k);
                        a.velocities[this.m_indexA].w = d;
                        a.velocities[this.m_indexB].w = f
                    };
                    b.prototype.SolvePositionConstraints = function(a) {
                        var d = a.positions[this.m_indexA].c,
                            e = a.positions[this.m_indexA].a,
                            f = a.positions[this.m_indexB].c,
                            g = a.positions[this.m_indexB].a,
                            h = this.m_qA.SetAngle(e),
                            k = this.m_qB.SetAngle(g);
                        r.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                        h = N.MulRV(h, this.m_lalcA, this.m_rA);
                        r.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                        k = N.MulRV(k, this.m_lalcB, this.m_rB);
                        var l = this.m_u.Copy(f).SelfAdd(k).SelfSub(d).SelfSub(h),
                            m = l.Normalize(),
                            n = m - this.m_maxLength;
                        n = c(n, 0, .2);
                        l = r.MulSV(-this.m_mass * n, l, b.SolvePositionConstraints_s_P);
                        d.SelfMulSub(this.m_invMassA, l);
                        e -= this.m_invIA * r.CrossVV(h, l);
                        f.SelfMulAdd(this.m_invMassB, l);
                        g += this.m_invIB * r.CrossVV(k, l);
                        a.positions[this.m_indexA].a = e;
                        a.positions[this.m_indexB].a = g;
                        return .008 > m - this.m_maxLength
                    };
                    b.prototype.GetAnchorA = function(a) {
                        return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, a)
                    };
                    b.prototype.GetAnchorB = function(a) {
                        return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, a)
                    };
                    b.prototype.GetReactionForce = function(a, b) {
                        return r.MulSV(a * this.m_impulse, this.m_u, b)
                    };
                    b.prototype.GetReactionTorque =
                        function(a) {
                            return 0
                        };
                    b.prototype.GetLocalAnchorA = function() {
                        return this.m_localAnchorA
                    };
                    b.prototype.GetLocalAnchorB = function() {
                        return this.m_localAnchorB
                    };
                    b.prototype.SetMaxLength = function(a) {
                        this.m_maxLength = a
                    };
                    b.prototype.GetMaxLength = function() {
                        return this.m_maxLength
                    };
                    b.prototype.GetLimitState = function() {
                        return this.m_state
                    };
                    b.prototype.Dump = function(a) {
                        var b = this.m_bodyA.m_islandIndex,
                            c = this.m_bodyB.m_islandIndex;
                        a("  const jd: b2RopeJointDef = new b2RopeJointDef();\n");
                        a("  jd.bodyA = bodies[%d];\n",
                            b);
                        a("  jd.bodyB = bodies[%d];\n", c);
                        a("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false");
                        a("  jd.localAnchorA.Set(%.15f, %.15f);\n", this.m_localAnchorA.x, this.m_localAnchorA.y);
                        a("  jd.localAnchorB.Set(%.15f, %.15f);\n", this.m_localAnchorB.x, this.m_localAnchorB.y);
                        a("  jd.maxLength = %.15f;\n", this.m_maxLength);
                        a("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index)
                    };
                    b.InitVelocityConstraints_s_P = new r;
                    b.SolveVelocityConstraints_s_vpA = new r;
                    b.SolveVelocityConstraints_s_vpB =
                        new r;
                    b.SolveVelocityConstraints_s_P = new r;
                    b.SolvePositionConstraints_s_P = new r;
                    return b
                }(wa),
                Td = function(a) {
                    function b() {
                        var b = a.call(this, f.b2JointType.e_weldJoint) || this;
                        b.localAnchorA = new r;
                        b.localAnchorB = new r;
                        b.referenceAngle = 0;
                        b.frequencyHz = 0;
                        b.dampingRatio = 0;
                        return b
                    }
                    C(b, a);
                    b.prototype.Initialize = function(a, b, c) {
                        this.bodyA = a;
                        this.bodyB = b;
                        this.bodyA.GetLocalPoint(c, this.localAnchorA);
                        this.bodyB.GetLocalPoint(c, this.localAnchorB);
                        this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle()
                    };
                    return b
                }(va),
                dc = function(a) {
                    function b(b) {
                        var c = a.call(this, b) || this;
                        c.m_frequencyHz = 0;
                        c.m_dampingRatio = 0;
                        c.m_bias = 0;
                        c.m_localAnchorA = new r;
                        c.m_localAnchorB = new r;
                        c.m_referenceAngle = 0;
                        c.m_gamma = 0;
                        c.m_impulse = new ja(0, 0, 0);
                        c.m_indexA = 0;
                        c.m_indexB = 0;
                        c.m_rA = new r;
                        c.m_rB = new r;
                        c.m_localCenterA = new r;
                        c.m_localCenterB = new r;
                        c.m_invMassA = 0;
                        c.m_invMassB = 0;
                        c.m_invIA = 0;
                        c.m_invIB = 0;
                        c.m_mass = new ta;
                        c.m_qA = new N;
                        c.m_qB = new N;
                        c.m_lalcA = new r;
                        c.m_lalcB = new r;
                        c.m_K = new ta;
                        c.m_frequencyHz = e(b.frequencyHz, 0);
                        c.m_dampingRatio =
                            e(b.dampingRatio, 0);
                        c.m_localAnchorA.Copy(e(b.localAnchorA, r.ZERO));
                        c.m_localAnchorB.Copy(e(b.localAnchorB, r.ZERO));
                        c.m_referenceAngle = e(b.referenceAngle, 0);
                        c.m_impulse.SetZero();
                        return c
                    }
                    C(b, a);
                    b.prototype.InitVelocityConstraints = function(a) {
                        this.m_indexA = this.m_bodyA.m_islandIndex;
                        this.m_indexB = this.m_bodyB.m_islandIndex;
                        this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);
                        this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);
                        this.m_invMassA = this.m_bodyA.m_invMass;
                        this.m_invMassB = this.m_bodyB.m_invMass;
                        this.m_invIA = this.m_bodyA.m_invI;
                        this.m_invIB = this.m_bodyB.m_invI;
                        var c = a.positions[this.m_indexA].a,
                            d = a.velocities[this.m_indexA].v,
                            e = a.velocities[this.m_indexA].w,
                            f = a.positions[this.m_indexB].a,
                            g = a.velocities[this.m_indexB].v,
                            h = a.velocities[this.m_indexB].w,
                            k = this.m_qA.SetAngle(c),
                            l = this.m_qB.SetAngle(f);
                        r.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                        N.MulRV(k, this.m_lalcA, this.m_rA);
                        r.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                        N.MulRV(l, this.m_lalcB, this.m_rB);
                        k =
                            this.m_invMassA;
                        l = this.m_invMassB;
                        var m = this.m_invIA,
                            n = this.m_invIB,
                            D = this.m_K;
                        D.ex.x = k + l + this.m_rA.y * this.m_rA.y * m + this.m_rB.y * this.m_rB.y * n;
                        D.ey.x = -this.m_rA.y * this.m_rA.x * m - this.m_rB.y * this.m_rB.x * n;
                        D.ez.x = -this.m_rA.y * m - this.m_rB.y * n;
                        D.ex.y = D.ey.x;
                        D.ey.y = k + l + this.m_rA.x * this.m_rA.x * m + this.m_rB.x * this.m_rB.x * n;
                        D.ez.y = this.m_rA.x * m + this.m_rB.x * n;
                        D.ex.z = D.ez.x;
                        D.ey.z = D.ez.y;
                        D.ez.z = m + n;
                        if (0 < this.m_frequencyHz) {
                            D.GetInverse22(this.m_mass);
                            D = m + n;
                            var p = 0 < D ? 1 / D : 0;
                            c = f - c - this.m_referenceAngle;
                            f = 6.28318530718 *
                                this.m_frequencyHz;
                            var J = p * f * f,
                                q = a.step.dt;
                            this.m_gamma = q * (2 * p * this.m_dampingRatio * f + q * J);
                            this.m_gamma = 0 !== this.m_gamma ? 1 / this.m_gamma : 0;
                            this.m_bias = c * q * J * this.m_gamma;
                            D += this.m_gamma;
                            this.m_mass.ez.z = 0 !== D ? 1 / D : 0
                        } else D.GetSymInverse33(this.m_mass), this.m_bias = this.m_gamma = 0;
                        a.step.warmStarting ? (this.m_impulse.SelfMul(a.step.dtRatio), D = b.InitVelocityConstraints_s_P.Set(this.m_impulse.x, this.m_impulse.y), d.SelfMulSub(k, D), e -= m * (r.CrossVV(this.m_rA, D) + this.m_impulse.z), g.SelfMulAdd(l, D), h += n * (r.CrossVV(this.m_rB,
                            D) + this.m_impulse.z)) : this.m_impulse.SetZero();
                        a.velocities[this.m_indexA].w = e;
                        a.velocities[this.m_indexB].w = h
                    };
                    b.prototype.SolveVelocityConstraints = function(a) {
                        var c = a.velocities[this.m_indexA].v,
                            d = a.velocities[this.m_indexA].w,
                            e = a.velocities[this.m_indexB].v,
                            f = a.velocities[this.m_indexB].w,
                            g = this.m_invMassA,
                            h = this.m_invMassB,
                            k = this.m_invIA,
                            l = this.m_invIB;
                        if (0 < this.m_frequencyHz) {
                            var m = -this.m_mass.ez.z * (f - d + this.m_bias + this.m_gamma * this.m_impulse.z);
                            this.m_impulse.z += m;
                            d -= k * m;
                            f += l * m;
                            m = r.SubVV(r.AddVCrossSV(e,
                                f, this.m_rB, r.s_t0), r.AddVCrossSV(c, d, this.m_rA, r.s_t1), b.SolveVelocityConstraints_s_Cdot1);
                            m = ta.MulM33XY(this.m_mass, m.x, m.y, b.SolveVelocityConstraints_s_impulse1).SelfNeg();
                            this.m_impulse.x += m.x;
                            this.m_impulse.y += m.y;
                            c.SelfMulSub(g, m);
                            d -= k * r.CrossVV(this.m_rA, m);
                            e.SelfMulAdd(h, m);
                            f += l * r.CrossVV(this.m_rB, m)
                        } else {
                            m = r.SubVV(r.AddVCrossSV(e, f, this.m_rB, r.s_t0), r.AddVCrossSV(c, d, this.m_rA, r.s_t1), b.SolveVelocityConstraints_s_Cdot1);
                            var n = ta.MulM33XYZ(this.m_mass, m.x, m.y, f - d, b.SolveVelocityConstraints_s_impulse).SelfNeg();
                            this.m_impulse.SelfAdd(n);
                            m = b.SolveVelocityConstraints_s_P.Set(n.x, n.y);
                            c.SelfMulSub(g, m);
                            d -= k * (r.CrossVV(this.m_rA, m) + n.z);
                            e.SelfMulAdd(h, m);
                            f += l * (r.CrossVV(this.m_rB, m) + n.z)
                        }
                        a.velocities[this.m_indexA].w = d;
                        a.velocities[this.m_indexB].w = f
                    };
                    b.prototype.SolvePositionConstraints = function(a) {
                        var c = a.positions[this.m_indexA].c,
                            d = a.positions[this.m_indexA].a,
                            e = a.positions[this.m_indexB].c,
                            f = a.positions[this.m_indexB].a,
                            g = this.m_qA.SetAngle(d),
                            h = this.m_qB.SetAngle(f),
                            k = this.m_invMassA,
                            l = this.m_invMassB,
                            m = this.m_invIA,
                            n = this.m_invIB;
                        r.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                        var D = N.MulRV(g, this.m_lalcA, this.m_rA);
                        r.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                        var p = N.MulRV(h, this.m_lalcB, this.m_rB),
                            J = this.m_K;
                        J.ex.x = k + l + D.y * D.y * m + p.y * p.y * n;
                        J.ey.x = -D.y * D.x * m - p.y * p.x * n;
                        J.ez.x = -D.y * m - p.y * n;
                        J.ex.y = J.ey.x;
                        J.ey.y = k + l + D.x * D.x * m + p.x * p.x * n;
                        J.ez.y = D.x * m + p.x * n;
                        J.ex.z = J.ez.x;
                        J.ey.z = J.ez.y;
                        J.ez.z = m + n;
                        if (0 < this.m_frequencyHz) {
                            var q = r.SubVV(r.AddVV(e, p, r.s_t0), r.AddVV(c, D, r.s_t1),
                                b.SolvePositionConstraints_s_C1);
                            h = q.Length();
                            g = 0;
                            q = J.Solve22(q.x, q.y, b.SolvePositionConstraints_s_P).SelfNeg();
                            c.SelfMulSub(k, q);
                            d -= m * r.CrossVV(D, q);
                            e.SelfMulAdd(l, q);
                            f += n * r.CrossVV(p, q)
                        } else q = r.SubVV(r.AddVV(e, p, r.s_t0), r.AddVV(c, D, r.s_t1), b.SolvePositionConstraints_s_C1), D = f - d - this.m_referenceAngle, h = q.Length(), g = ba(D), D = J.Solve33(q.x, q.y, D, b.SolvePositionConstraints_s_impulse).SelfNeg(), q = b.SolvePositionConstraints_s_P.Set(D.x, D.y), c.SelfMulSub(k, q), d -= m * (r.CrossVV(this.m_rA, q) + D.z), e.SelfMulAdd(l,
                            q), f += n * (r.CrossVV(this.m_rB, q) + D.z);
                        a.positions[this.m_indexA].a = d;
                        a.positions[this.m_indexB].a = f;
                        return .008 >= h && g <= V
                    };
                    b.prototype.GetAnchorA = function(a) {
                        return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, a)
                    };
                    b.prototype.GetAnchorB = function(a) {
                        return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, a)
                    };
                    b.prototype.GetReactionForce = function(a, b) {
                        b.x = a * this.m_impulse.x;
                        b.y = a * this.m_impulse.y;
                        return b
                    };
                    b.prototype.GetReactionTorque = function(a) {
                        return a * this.m_impulse.z
                    };
                    b.prototype.GetLocalAnchorA =
                        function() {
                            return this.m_localAnchorA
                        };
                    b.prototype.GetLocalAnchorB = function() {
                        return this.m_localAnchorB
                    };
                    b.prototype.GetReferenceAngle = function() {
                        return this.m_referenceAngle
                    };
                    b.prototype.SetFrequency = function(a) {
                        this.m_frequencyHz = a
                    };
                    b.prototype.GetFrequency = function() {
                        return this.m_frequencyHz
                    };
                    b.prototype.SetDampingRatio = function(a) {
                        this.m_dampingRatio = a
                    };
                    b.prototype.GetDampingRatio = function() {
                        return this.m_dampingRatio
                    };
                    b.prototype.Dump = function(a) {
                        var b = this.m_bodyA.m_islandIndex,
                            c = this.m_bodyB.m_islandIndex;
                        a("  const jd: b2WeldJointDef = new b2WeldJointDef();\n");
                        a("  jd.bodyA = bodies[%d];\n", b);
                        a("  jd.bodyB = bodies[%d];\n", c);
                        a("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false");
                        a("  jd.localAnchorA.Set(%.15f, %.15f);\n", this.m_localAnchorA.x, this.m_localAnchorA.y);
                        a("  jd.localAnchorB.Set(%.15f, %.15f);\n", this.m_localAnchorB.x, this.m_localAnchorB.y);
                        a("  jd.referenceAngle = %.15f;\n", this.m_referenceAngle);
                        a("  jd.frequencyHz = %.15f;\n", this.m_frequencyHz);
                        a("  jd.dampingRatio = %.15f;\n",
                            this.m_dampingRatio);
                        a("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index)
                    };
                    b.InitVelocityConstraints_s_P = new r;
                    b.SolveVelocityConstraints_s_Cdot1 = new r;
                    b.SolveVelocityConstraints_s_impulse1 = new r;
                    b.SolveVelocityConstraints_s_impulse = new ja;
                    b.SolveVelocityConstraints_s_P = new r;
                    b.SolvePositionConstraints_s_C1 = new r;
                    b.SolvePositionConstraints_s_P = new r;
                    b.SolvePositionConstraints_s_impulse = new ja;
                    return b
                }(wa),
                Ud = function(a) {
                    function b() {
                        var b = a.call(this, f.b2JointType.e_wheelJoint) || this;
                        b.localAnchorA = new r(0, 0);
                        b.localAnchorB = new r(0, 0);
                        b.localAxisA = new r(1, 0);
                        b.enableMotor = !1;
                        b.maxMotorTorque = 0;
                        b.motorSpeed = 0;
                        b.frequencyHz = 2;
                        b.dampingRatio = .7;
                        return b
                    }
                    C(b, a);
                    b.prototype.Initialize = function(a, b, c, d) {
                        this.bodyA = a;
                        this.bodyB = b;
                        this.bodyA.GetLocalPoint(c, this.localAnchorA);
                        this.bodyB.GetLocalPoint(c, this.localAnchorB);
                        this.bodyA.GetLocalVector(d, this.localAxisA)
                    };
                    return b
                }(va),
                ec = function(a) {
                    function b(b) {
                        var c = a.call(this, b) || this;
                        c.m_frequencyHz = 0;
                        c.m_dampingRatio = 0;
                        c.m_localAnchorA =
                            new r;
                        c.m_localAnchorB = new r;
                        c.m_localXAxisA = new r;
                        c.m_localYAxisA = new r;
                        c.m_impulse = 0;
                        c.m_motorImpulse = 0;
                        c.m_springImpulse = 0;
                        c.m_maxMotorTorque = 0;
                        c.m_motorSpeed = 0;
                        c.m_enableMotor = !1;
                        c.m_indexA = 0;
                        c.m_indexB = 0;
                        c.m_localCenterA = new r;
                        c.m_localCenterB = new r;
                        c.m_invMassA = 0;
                        c.m_invMassB = 0;
                        c.m_invIA = 0;
                        c.m_invIB = 0;
                        c.m_ax = new r;
                        c.m_ay = new r;
                        c.m_sAx = 0;
                        c.m_sBx = 0;
                        c.m_sAy = 0;
                        c.m_sBy = 0;
                        c.m_mass = 0;
                        c.m_motorMass = 0;
                        c.m_springMass = 0;
                        c.m_bias = 0;
                        c.m_gamma = 0;
                        c.m_qA = new N;
                        c.m_qB = new N;
                        c.m_lalcA = new r;
                        c.m_lalcB = new r;
                        c.m_rA =
                            new r;
                        c.m_rB = new r;
                        c.m_frequencyHz = e(b.frequencyHz, 2);
                        c.m_dampingRatio = e(b.dampingRatio, .7);
                        c.m_localAnchorA.Copy(e(b.localAnchorA, r.ZERO));
                        c.m_localAnchorB.Copy(e(b.localAnchorB, r.ZERO));
                        c.m_localXAxisA.Copy(e(b.localAxisA, r.UNITX));
                        r.CrossOneV(c.m_localXAxisA, c.m_localYAxisA);
                        c.m_maxMotorTorque = e(b.maxMotorTorque, 0);
                        c.m_motorSpeed = e(b.motorSpeed, 0);
                        c.m_enableMotor = e(b.enableMotor, !1);
                        c.m_ax.SetZero();
                        c.m_ay.SetZero();
                        return c
                    }
                    C(b, a);
                    b.prototype.GetMotorSpeed = function() {
                        return this.m_motorSpeed
                    };
                    b.prototype.GetMaxMotorTorque = function() {
                        return this.m_maxMotorTorque
                    };
                    b.prototype.SetSpringFrequencyHz = function(a) {
                        this.m_frequencyHz = a
                    };
                    b.prototype.GetSpringFrequencyHz = function() {
                        return this.m_frequencyHz
                    };
                    b.prototype.SetSpringDampingRatio = function(a) {
                        this.m_dampingRatio = a
                    };
                    b.prototype.GetSpringDampingRatio = function() {
                        return this.m_dampingRatio
                    };
                    b.prototype.InitVelocityConstraints = function(a) {
                        this.m_indexA = this.m_bodyA.m_islandIndex;
                        this.m_indexB = this.m_bodyB.m_islandIndex;
                        this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);
                        this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);
                        this.m_invMassA = this.m_bodyA.m_invMass;
                        this.m_invMassB = this.m_bodyB.m_invMass;
                        this.m_invIA = this.m_bodyA.m_invI;
                        this.m_invIB = this.m_bodyB.m_invI;
                        var c = this.m_invMassA,
                            d = this.m_invMassB,
                            e = this.m_invIA,
                            f = this.m_invIB,
                            g = a.positions[this.m_indexA].c,
                            h = a.velocities[this.m_indexA].v,
                            k = a.velocities[this.m_indexA].w,
                            l = a.positions[this.m_indexB].c,
                            m = a.positions[this.m_indexB].a,
                            n = a.velocities[this.m_indexB].v,
                            D = a.velocities[this.m_indexB].w,
                            p = this.m_qA.SetAngle(a.positions[this.m_indexA].a),
                            q = this.m_qB.SetAngle(m);
                        r.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                        m = N.MulRV(p, this.m_lalcA, this.m_rA);
                        r.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                        q = N.MulRV(q, this.m_lalcB, this.m_rB);
                        g = r.SubVV(r.AddVV(l, q, r.s_t0), r.AddVV(g, m, r.s_t1), b.InitVelocityConstraints_s_d);
                        N.MulRV(p, this.m_localYAxisA, this.m_ay);
                        this.m_sAy = r.CrossVV(r.AddVV(g, m, r.s_t0), this.m_ay);
                        this.m_sBy = r.CrossVV(q, this.m_ay);
                        this.m_mass = c + d + e * this.m_sAy * this.m_sAy + f * this.m_sBy * this.m_sBy;
                        0 < this.m_mass &&
                            (this.m_mass = 1 / this.m_mass);
                        this.m_gamma = this.m_bias = this.m_springMass = 0;
                        0 < this.m_frequencyHz ? (N.MulRV(p, this.m_localXAxisA, this.m_ax), this.m_sAx = r.CrossVV(r.AddVV(g, m, r.s_t0), this.m_ax), this.m_sBx = r.CrossVV(q, this.m_ax), c = c + d + e * this.m_sAx * this.m_sAx + f * this.m_sBx * this.m_sBx, 0 < c && (this.m_springMass = 1 / c, d = r.DotVV(g, this.m_ax), p = 6.28318530718 * this.m_frequencyHz, g = this.m_springMass * p * p, l = a.step.dt, this.m_gamma = l * (2 * this.m_springMass * this.m_dampingRatio * p + l * g), 0 < this.m_gamma && (this.m_gamma = 1 / this.m_gamma),
                            this.m_bias = d * l * g * this.m_gamma, this.m_springMass = c + this.m_gamma, 0 < this.m_springMass && (this.m_springMass = 1 / this.m_springMass))) : this.m_springImpulse = 0;
                        this.m_enableMotor ? (this.m_motorMass = e + f, 0 < this.m_motorMass && (this.m_motorMass = 1 / this.m_motorMass)) : this.m_motorImpulse = this.m_motorMass = 0;
                        a.step.warmStarting ? (this.m_impulse *= a.step.dtRatio, this.m_springImpulse *= a.step.dtRatio, this.m_motorImpulse *= a.step.dtRatio, e = r.AddVV(r.MulSV(this.m_impulse, this.m_ay, r.s_t0), r.MulSV(this.m_springImpulse, this.m_ax,
                            r.s_t1), b.InitVelocityConstraints_s_P), f = this.m_impulse * this.m_sAy + this.m_springImpulse * this.m_sAx + this.m_motorImpulse, c = this.m_impulse * this.m_sBy + this.m_springImpulse * this.m_sBx + this.m_motorImpulse, h.SelfMulSub(this.m_invMassA, e), k -= this.m_invIA * f, n.SelfMulAdd(this.m_invMassB, e), D += this.m_invIB * c) : this.m_motorImpulse = this.m_springImpulse = this.m_impulse = 0;
                        a.velocities[this.m_indexA].w = k;
                        a.velocities[this.m_indexB].w = D
                    };
                    b.prototype.SolveVelocityConstraints = function(a) {
                        var d = this.m_invMassA,
                            e = this.m_invMassB,
                            f = this.m_invIA,
                            g = this.m_invIB,
                            h = a.velocities[this.m_indexA].v,
                            k = a.velocities[this.m_indexA].w,
                            l = a.velocities[this.m_indexB].v,
                            m = a.velocities[this.m_indexB].w,
                            n = r.DotVV(this.m_ax, r.SubVV(l, h, r.s_t0)) + this.m_sBx * m - this.m_sAx * k;
                        n = -this.m_springMass * (n + this.m_bias + this.m_gamma * this.m_springImpulse);
                        this.m_springImpulse += n;
                        var D = r.MulSV(n, this.m_ax, b.SolveVelocityConstraints_s_P),
                            p = n * this.m_sAx;
                        n *= this.m_sBx;
                        h.SelfMulSub(d, D);
                        k -= f * p;
                        l.SelfMulAdd(e, D);
                        m += g * n;
                        n = m - k - this.m_motorSpeed;
                        n *= -this.m_motorMass;
                        D = this.m_motorImpulse;
                        p = a.step.dt * this.m_maxMotorTorque;
                        this.m_motorImpulse = c(this.m_motorImpulse + n, -p, p);
                        n = this.m_motorImpulse - D;
                        k -= f * n;
                        m += g * n;
                        n = r.DotVV(this.m_ay, r.SubVV(l, h, r.s_t0)) + this.m_sBy * m - this.m_sAy * k;
                        n *= -this.m_mass;
                        this.m_impulse += n;
                        D = r.MulSV(n, this.m_ay, b.SolveVelocityConstraints_s_P);
                        p = n * this.m_sAy;
                        n *= this.m_sBy;
                        h.SelfMulSub(d, D);
                        k -= f * p;
                        l.SelfMulAdd(e, D);
                        a.velocities[this.m_indexA].w = k;
                        a.velocities[this.m_indexB].w = m + g * n
                    };
                    b.prototype.SolvePositionConstraints = function(a) {
                        var c = a.positions[this.m_indexA].c,
                            d = a.positions[this.m_indexA].a,
                            e = a.positions[this.m_indexB].c,
                            f = a.positions[this.m_indexB].a,
                            g = this.m_qA.SetAngle(d),
                            h = this.m_qB.SetAngle(f);
                        r.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                        var k = N.MulRV(g, this.m_lalcA, this.m_rA);
                        r.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                        h = N.MulRV(h, this.m_lalcB, this.m_rB);
                        var l = r.AddVV(r.SubVV(e, c, r.s_t0), r.SubVV(h, k, r.s_t1), b.SolvePositionConstraints_s_d);
                        g = N.MulRV(g, this.m_localYAxisA, this.m_ay);
                        k = r.CrossVV(r.AddVV(l, k, r.s_t0),
                            g);
                        h = r.CrossVV(h, g);
                        l = r.DotVV(l, this.m_ay);
                        var m = this.m_invMassA + this.m_invMassB + this.m_invIA * this.m_sAy * this.m_sAy + this.m_invIB * this.m_sBy * this.m_sBy;
                        m = 0 !== m ? -l / m : 0;
                        g = r.MulSV(m, g, b.SolvePositionConstraints_s_P);
                        k *= m;
                        h *= m;
                        c.SelfMulSub(this.m_invMassA, g);
                        d -= this.m_invIA * k;
                        e.SelfMulAdd(this.m_invMassB, g);
                        f += this.m_invIB * h;
                        a.positions[this.m_indexA].a = d;
                        a.positions[this.m_indexB].a = f;
                        return .008 >= ba(l)
                    };
                    b.prototype.GetDefinition = function(a) {
                        return a
                    };
                    b.prototype.GetAnchorA = function(a) {
                        return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,
                            a)
                    };
                    b.prototype.GetAnchorB = function(a) {
                        return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, a)
                    };
                    b.prototype.GetReactionForce = function(a, b) {
                        b.x = a * (this.m_impulse * this.m_ay.x + this.m_springImpulse * this.m_ax.x);
                        b.y = a * (this.m_impulse * this.m_ay.y + this.m_springImpulse * this.m_ax.y);
                        return b
                    };
                    b.prototype.GetReactionTorque = function(a) {
                        return a * this.m_motorImpulse
                    };
                    b.prototype.GetLocalAnchorA = function() {
                        return this.m_localAnchorA
                    };
                    b.prototype.GetLocalAnchorB = function() {
                        return this.m_localAnchorB
                    };
                    b.prototype.GetLocalAxisA =
                        function() {
                            return this.m_localXAxisA
                        };
                    b.prototype.GetJointTranslation = function() {
                        return this.GetPrismaticJointTranslation()
                    };
                    b.prototype.GetJointLinearSpeed = function() {
                        return this.GetPrismaticJointSpeed()
                    };
                    b.prototype.GetJointAngle = function() {
                        return this.GetRevoluteJointAngle()
                    };
                    b.prototype.GetJointAngularSpeed = function() {
                        return this.GetRevoluteJointSpeed()
                    };
                    b.prototype.GetPrismaticJointTranslation = function() {
                        var a = this.m_bodyA,
                            b = this.m_bodyB,
                            c = a.GetWorldPoint(this.m_localAnchorA, new r);
                        b = b.GetWorldPoint(this.m_localAnchorB,
                            new r);
                        c = r.SubVV(b, c, new r);
                        a = a.GetWorldVector(this.m_localXAxisA, new r);
                        return r.DotVV(c, a)
                    };
                    b.prototype.GetPrismaticJointSpeed = function() {
                        var a = this.m_bodyA,
                            b = this.m_bodyB;
                        r.SubVV(this.m_localAnchorA, a.m_sweep.localCenter, this.m_lalcA);
                        var c = N.MulRV(a.m_xf.q, this.m_lalcA, this.m_rA);
                        r.SubVV(this.m_localAnchorB, b.m_sweep.localCenter, this.m_lalcB);
                        var d = N.MulRV(b.m_xf.q, this.m_lalcB, this.m_rB),
                            e = r.AddVV(a.m_sweep.c, c, r.s_t0),
                            f = r.AddVV(b.m_sweep.c, d, r.s_t1);
                        e = r.SubVV(f, e, r.s_t2);
                        f = a.GetWorldVector(this.m_localXAxisA,
                            new r);
                        var g = a.m_linearVelocity,
                            h = b.m_linearVelocity;
                        a = a.m_angularVelocity;
                        b = b.m_angularVelocity;
                        return r.DotVV(e, r.CrossSV(a, f, r.s_t0)) + r.DotVV(f, r.SubVV(r.AddVCrossSV(h, b, d, r.s_t0), r.AddVCrossSV(g, a, c, r.s_t1), r.s_t0))
                    };
                    b.prototype.GetRevoluteJointAngle = function() {
                        return this.m_bodyB.m_sweep.a - this.m_bodyA.m_sweep.a
                    };
                    b.prototype.GetRevoluteJointSpeed = function() {
                        return this.m_bodyB.m_angularVelocity - this.m_bodyA.m_angularVelocity
                    };
                    b.prototype.IsMotorEnabled = function() {
                        return this.m_enableMotor
                    };
                    b.prototype.EnableMotor =
                        function(a) {
                            a !== this.m_enableMotor && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), this.m_enableMotor = a)
                        };
                    b.prototype.SetMotorSpeed = function(a) {
                        a !== this.m_motorSpeed && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), this.m_motorSpeed = a)
                    };
                    b.prototype.SetMaxMotorTorque = function(a) {
                        a !== this.m_maxMotorTorque && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), this.m_maxMotorTorque = a)
                    };
                    b.prototype.GetMotorTorque = function(a) {
                        return a * this.m_motorImpulse
                    };
                    b.prototype.Dump = function(a) {
                        var b = this.m_bodyA.m_islandIndex,
                            c = this.m_bodyB.m_islandIndex;
                        a("  const jd: b2WheelJointDef = new b2WheelJointDef();\n");
                        a("  jd.bodyA = bodies[%d];\n", b);
                        a("  jd.bodyB = bodies[%d];\n", c);
                        a("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false");
                        a("  jd.localAnchorA.Set(%.15f, %.15f);\n", this.m_localAnchorA.x, this.m_localAnchorA.y);
                        a("  jd.localAnchorB.Set(%.15f, %.15f);\n", this.m_localAnchorB.x, this.m_localAnchorB.y);
                        a("  jd.localAxisA.Set(%.15f, %.15f);\n", this.m_localXAxisA.x, this.m_localXAxisA.y);
                        a("  jd.enableMotor = %s;\n",
                            this.m_enableMotor ? "true" : "false");
                        a("  jd.motorSpeed = %.15f;\n", this.m_motorSpeed);
                        a("  jd.maxMotorTorque = %.15f;\n", this.m_maxMotorTorque);
                        a("  jd.frequencyHz = %.15f;\n", this.m_frequencyHz);
                        a("  jd.dampingRatio = %.15f;\n", this.m_dampingRatio);
                        a("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index)
                    };
                    b.InitVelocityConstraints_s_d = new r;
                    b.InitVelocityConstraints_s_P = new r;
                    b.SolveVelocityConstraints_s_P = new r;
                    b.SolvePositionConstraints_s_d = new r;
                    b.SolvePositionConstraints_s_P = new r;
                    return b
                }(wa),
                lb = function() {
                    return function(a) {
                        this.next = this.prev = null;
                        this.contact = a
                    }
                }(),
                Ha = function() {
                    function a() {
                        this.m_toiFlag = this.m_bulletHitFlag = this.m_filterFlag = this.m_enabledFlag = this.m_touchingFlag = this.m_islandFlag = !1;
                        this.m_next = this.m_prev = null;
                        this.m_indexB = this.m_indexA = 0;
                        this.m_manifold = new eb;
                        this.m_tangentSpeed = this.m_restitution = this.m_friction = this.m_toi = this.m_toiCount = 0;
                        this.m_oldManifold = new eb;
                        this.m_nodeA = new lb(this);
                        this.m_nodeB = new lb(this)
                    }
                    a.prototype.GetManifold = function() {
                        return this.m_manifold
                    };
                    a.prototype.GetWorldManifold = function(a) {
                        var b = this.m_fixtureA.GetBody(),
                            c = this.m_fixtureB.GetBody(),
                            d = this.m_fixtureA.GetShape(),
                            e = this.m_fixtureB.GetShape();
                        a.Initialize(this.m_manifold, b.GetTransform(), d.m_radius, c.GetTransform(), e.m_radius)
                    };
                    a.prototype.IsTouching = function() {
                        return this.m_touchingFlag
                    };
                    a.prototype.SetEnabled = function(a) {
                        this.m_enabledFlag = a
                    };
                    a.prototype.IsEnabled = function() {
                        return this.m_enabledFlag
                    };
                    a.prototype.GetNext = function() {
                        return this.m_next
                    };
                    a.prototype.GetFixtureA = function() {
                        return this.m_fixtureA
                    };
                    a.prototype.GetChildIndexA = function() {
                        return this.m_indexA
                    };
                    a.prototype.GetFixtureB = function() {
                        return this.m_fixtureB
                    };
                    a.prototype.GetChildIndexB = function() {
                        return this.m_indexB
                    };
                    a.prototype.FlagForFiltering = function() {
                        this.m_filterFlag = !0
                    };
                    a.prototype.SetFriction = function(a) {
                        this.m_friction = a
                    };
                    a.prototype.GetFriction = function() {
                        return this.m_friction
                    };
                    a.prototype.ResetFriction = function() {
                        this.m_friction = ha(this.m_fixtureA.m_friction * this.m_fixtureB.m_friction)
                    };
                    a.prototype.SetRestitution = function(a) {
                        this.m_restitution =
                            a
                    };
                    a.prototype.GetRestitution = function() {
                        return this.m_restitution
                    };
                    a.prototype.ResetRestitution = function() {
                        this.m_restitution = G(this.m_fixtureA.m_restitution, this.m_fixtureB.m_restitution)
                    };
                    a.prototype.SetTangentSpeed = function(a) {
                        this.m_tangentSpeed = a
                    };
                    a.prototype.GetTangentSpeed = function() {
                        return this.m_tangentSpeed
                    };
                    a.prototype.Reset = function(a, b, c, d) {
                        this.m_touchingFlag = this.m_islandFlag = !1;
                        this.m_enabledFlag = !0;
                        this.m_toiFlag = this.m_bulletHitFlag = this.m_filterFlag = !1;
                        this.m_fixtureA = a;
                        this.m_fixtureB =
                            c;
                        this.m_indexA = b;
                        this.m_indexB = d;
                        this.m_manifold.pointCount = 0;
                        this.m_next = this.m_prev = null;
                        delete this.m_nodeA.contact;
                        this.m_nodeA.prev = null;
                        this.m_nodeA.next = null;
                        delete this.m_nodeA.other;
                        delete this.m_nodeB.contact;
                        this.m_nodeB.prev = null;
                        this.m_nodeB.next = null;
                        delete this.m_nodeB.other;
                        this.m_toiCount = 0;
                        this.m_friction = ha(this.m_fixtureA.m_friction * this.m_fixtureB.m_friction);
                        this.m_restitution = G(this.m_fixtureA.m_restitution, this.m_fixtureB.m_restitution)
                    };
                    a.prototype.Update = function(a) {
                        var b =
                            this.m_oldManifold;
                        this.m_oldManifold = this.m_manifold;
                        this.m_manifold = b;
                        this.m_enabledFlag = !0;
                        b = this.m_touchingFlag;
                        var c = this.m_fixtureA.IsSensor(),
                            d = this.m_fixtureB.IsSensor();
                        c = c || d;
                        d = this.m_fixtureA.GetBody();
                        var e = this.m_fixtureB.GetBody();
                        var f = d.GetTransform();
                        var g = e.GetTransform();
                        if (c) d = this.m_fixtureA.GetShape(), e = this.m_fixtureB.GetShape(), f = q(d, this.m_indexA, e, this.m_indexB, f, g), this.m_manifold.pointCount = 0;
                        else {
                            this.Evaluate(this.m_manifold, f, g);
                            f = 0 < this.m_manifold.pointCount;
                            for (g =
                                0; g < this.m_manifold.pointCount; ++g) {
                                var h = this.m_manifold.points[g];
                                h.normalImpulse = 0;
                                h.tangentImpulse = 0;
                                for (var k = h.id, l = 0; l < this.m_oldManifold.pointCount; ++l) {
                                    var m = this.m_oldManifold.points[l];
                                    if (m.id.key === k.key) {
                                        h.normalImpulse = m.normalImpulse;
                                        h.tangentImpulse = m.tangentImpulse;
                                        break
                                    }
                                }
                            }
                            f !== b && (d.SetAwake(!0), e.SetAwake(!0))
                        }
                        this.m_touchingFlag = f;
                        !b && f && a && a.BeginContact(this);
                        b && !f && a && a.EndContact(this);
                        !c && f && a && a.PreSolve(this, this.m_oldManifold)
                    };
                    a.prototype.ComputeTOI = function(b, c) {
                        var d =
                            a.ComputeTOI_s_input;
                        d.proxyA.SetShape(this.m_fixtureA.GetShape(), this.m_indexA);
                        d.proxyB.SetShape(this.m_fixtureB.GetShape(), this.m_indexB);
                        d.sweepA.Copy(b);
                        d.sweepB.Copy(c);
                        d.tMax = .008;
                        b = a.ComputeTOI_s_output;
                        u(b, d);
                        return b.t
                    };
                    a.ComputeTOI_s_input = new hb;
                    a.ComputeTOI_s_output = new ib;
                    return a
                }(),
                mb = function(a) {
                    function b() {
                        return a.call(this) || this
                    }
                    C(b, a);
                    b.Create = function(a) {
                        return new b
                    };
                    b.Destroy = function(a, b) {};
                    b.prototype.Reset = function(b, c, d, e) {
                        a.prototype.Reset.call(this, b, c, d, e)
                    };
                    b.prototype.Evaluate =
                        function(a, b, c) {
                            var d = this.m_fixtureA.GetShape(),
                                e = this.m_fixtureB.GetShape();
                            v(a, d, b, e, c)
                        };
                    return b
                }(Ha),
                nb = function(a) {
                    function b() {
                        return a.call(this) || this
                    }
                    C(b, a);
                    b.Create = function(a) {
                        return new b
                    };
                    b.Destroy = function(a, b) {};
                    b.prototype.Reset = function(b, c, d, e) {
                        a.prototype.Reset.call(this, b, c, d, e)
                    };
                    b.prototype.Evaluate = function(a, b, c) {
                        var d = this.m_fixtureA.GetShape(),
                            e = this.m_fixtureB.GetShape();
                        y(a, d, b, e, c)
                    };
                    return b
                }(Ha),
                ob = function(a) {
                    function b() {
                        return a.call(this) || this
                    }
                    C(b, a);
                    b.Create = function(a) {
                        return new b
                    };
                    b.Destroy = function(a, b) {};
                    b.prototype.Reset = function(b, c, d, e) {
                        a.prototype.Reset.call(this, b, c, d, e)
                    };
                    b.prototype.Evaluate = function(a, b, c) {
                        var d = this.m_fixtureA.GetShape(),
                            e = this.m_fixtureB.GetShape();
                        A(a, d, b, e, c)
                    };
                    return b
                }(Ha),
                pb = function(a) {
                    function b() {
                        return a.call(this) || this
                    }
                    C(b, a);
                    b.Create = function(a) {
                        return new b
                    };
                    b.Destroy = function(a, b) {};
                    b.prototype.Reset = function(b, c, d, e) {
                        a.prototype.Reset.call(this, b, c, d, e)
                    };
                    b.prototype.Evaluate = function(a, b, c) {
                        var d = this.m_fixtureA.GetShape(),
                            e = this.m_fixtureB.GetShape();
                        z(a, d, b, e, c)
                    };
                    return b
                }(Ha),
                qb = function(a) {
                    function b() {
                        return a.call(this) || this
                    }
                    C(b, a);
                    b.Create = function(a) {
                        return new b
                    };
                    b.Destroy = function(a, b) {};
                    b.prototype.Reset = function(b, c, d, e) {
                        a.prototype.Reset.call(this, b, c, d, e)
                    };
                    b.prototype.Evaluate = function(a, b, c) {
                        var d = this.m_fixtureA.GetShape(),
                            e = this.m_fixtureB.GetShape();
                        x(a, d, b, e, c)
                    };
                    return b
                }(Ha),
                rb = function(a) {
                    function b() {
                        return a.call(this) || this
                    }
                    C(b, a);
                    b.Create = function(a) {
                        return new b
                    };
                    b.Destroy = function(a, b) {};
                    b.prototype.Reset = function(b,
                        c, d, e) {
                        a.prototype.Reset.call(this, b, c, d, e)
                    };
                    b.prototype.Evaluate = function(a, c, d) {
                        var e = this.m_fixtureA.GetShape(),
                            f = this.m_fixtureB.GetShape(),
                            g = b.Evaluate_s_edge;
                        e.GetChildEdge(g, this.m_indexA);
                        z(a, g, c, f, d)
                    };
                    b.Evaluate_s_edge = new Ta;
                    return b
                }(Ha),
                sb = function(a) {
                    function b() {
                        return a.call(this) || this
                    }
                    C(b, a);
                    b.Create = function(a) {
                        return new b
                    };
                    b.Destroy = function(a, b) {};
                    b.prototype.Reset = function(b, c, d, e) {
                        a.prototype.Reset.call(this, b, c, d, e)
                    };
                    b.prototype.Evaluate = function(a, c, d) {
                        var e = this.m_fixtureA.GetShape(),
                            f = this.m_fixtureB.GetShape(),
                            g = b.Evaluate_s_edge;
                        e.GetChildEdge(g, this.m_indexA);
                        x(a, g, c, f, d)
                    };
                    b.Evaluate_s_edge = new Ta;
                    return b
                }(Ha),
                fc = function() {
                    return function() {
                        this.destroyFcn = this.createFcn = null;
                        this.primary = !1
                    }
                }(),
                gc = function() {
                    function a(a) {
                        this.m_allocator = null;
                        this.m_allocator = a;
                        this.InitializeRegisters()
                    }
                    a.prototype.AddType = function(a, c, d, e) {
                        function f(b) {
                            return k.pop() || a(b)
                        }

                        function g(a, b) {
                            k.push(a)
                        }
                        var h = this,
                            k = b(256, function(b) {
                                return a(h.m_allocator)
                            });
                        this.m_registers[d][e].createFcn =
                            f;
                        this.m_registers[d][e].destroyFcn = g;
                        this.m_registers[d][e].primary = !0;
                        d !== e && (this.m_registers[e][d].createFcn = f, this.m_registers[e][d].destroyFcn = g, this.m_registers[e][d].primary = !1)
                    };
                    a.prototype.InitializeRegisters = function() {
                        this.m_registers = [];
                        for (var a = 0; a < f.b2ShapeType.e_shapeTypeCount; a++) {
                            this.m_registers[a] = [];
                            for (var b = 0; b < f.b2ShapeType.e_shapeTypeCount; b++) this.m_registers[a][b] = new fc
                        }
                        this.AddType(mb.Create, mb.Destroy, f.b2ShapeType.e_circleShape, f.b2ShapeType.e_circleShape);
                        this.AddType(ob.Create,
                            ob.Destroy, f.b2ShapeType.e_polygonShape, f.b2ShapeType.e_circleShape);
                        this.AddType(nb.Create, nb.Destroy, f.b2ShapeType.e_polygonShape, f.b2ShapeType.e_polygonShape);
                        this.AddType(pb.Create, pb.Destroy, f.b2ShapeType.e_edgeShape, f.b2ShapeType.e_circleShape);
                        this.AddType(qb.Create, qb.Destroy, f.b2ShapeType.e_edgeShape, f.b2ShapeType.e_polygonShape);
                        this.AddType(rb.Create, rb.Destroy, f.b2ShapeType.e_chainShape, f.b2ShapeType.e_circleShape);
                        this.AddType(sb.Create, sb.Destroy, f.b2ShapeType.e_chainShape, f.b2ShapeType.e_polygonShape)
                    };
                    a.prototype.Create = function(a, b, c, d) {
                        var e = a.GetType(),
                            f = c.GetType();
                        e = this.m_registers[e][f];
                        return e.createFcn ? (f = e.createFcn(this.m_allocator), e.primary ? f.Reset(a, b, c, d) : f.Reset(c, d, a, b), f) : null
                    };
                    a.prototype.Destroy = function(a) {
                        var b = a.m_fixtureA,
                            c = a.m_fixtureB;
                        0 < a.m_manifold.pointCount && !b.IsSensor() && !c.IsSensor() && (b.GetBody().SetAwake(!0), c.GetBody().SetAwake(!0));
                        b = b.GetType();
                        c = c.GetType();
                        c = this.m_registers[b][c];
                        c.destroyFcn && c.destroyFcn(a, this.m_allocator)
                    };
                    return a
                }(),
                Vd = function() {
                    function a() {}
                    a.prototype.SayGoodbyeJoint = function(a) {};
                    a.prototype.SayGoodbyeFixture = function(a) {};
                    a.prototype.SayGoodbyeParticleGroup = function(a) {};
                    a.prototype.SayGoodbyeParticle = function(a, b) {};
                    return a
                }(),
                hc = function() {
                    function a() {}
                    a.prototype.ShouldCollide = function(a, b) {
                        var c = a.GetBody(),
                            d = b.GetBody();
                        if (d.GetType() === f.b2BodyType.b2_staticBody && c.GetType() === f.b2BodyType.b2_staticBody || !d.ShouldCollideConnected(c)) return !1;
                        a = a.GetFilterData();
                        b = b.GetFilterData();
                        return a.groupIndex === b.groupIndex && 0 !== a.groupIndex ?
                            0 < a.groupIndex : 0 !== (a.maskBits & b.categoryBits) && 0 !== (a.categoryBits & b.maskBits)
                    };
                    a.prototype.ShouldCollideFixtureParticle = function(a, b, c) {
                        return !0
                    };
                    a.prototype.ShouldCollideParticleParticle = function(a, b, c) {
                        return !0
                    };
                    a.b2_defaultFilter = new a;
                    return a
                }(),
                ic = function() {
                    return function() {
                        this.normalImpulses = h(2);
                        this.tangentImpulses = h(2);
                        this.count = 0
                    }
                }(),
                jc = function() {
                    function a() {}
                    a.prototype.BeginContact = function(a) {};
                    a.prototype.EndContact = function(a) {};
                    a.prototype.BeginContactFixtureParticle = function(a,
                        b) {};
                    a.prototype.EndContactFixtureParticle = function(a, b) {};
                    a.prototype.BeginContactParticleParticle = function(a, b) {};
                    a.prototype.EndContactParticleParticle = function(a, b) {};
                    a.prototype.PreSolve = function(a, b) {};
                    a.prototype.PostSolve = function(a, b) {};
                    a.b2_defaultListener = new a;
                    return a
                }(),
                Ua = function() {
                    function a() {}
                    a.prototype.ReportFixture = function(a) {
                        return !0
                    };
                    a.prototype.ReportParticle = function(a, b) {
                        return !1
                    };
                    a.prototype.ShouldQueryParticleSystem = function(a) {
                        return !0
                    };
                    return a
                }(),
                Wd = function() {
                    function a() {}
                    a.prototype.ReportFixture = function(a, b, c, d) {
                        return d
                    };
                    a.prototype.ReportParticle = function(a, b, c, d, e) {
                        return 0
                    };
                    a.prototype.ShouldQueryParticleSystem = function(a) {
                        return !0
                    };
                    return a
                }(),
                kc = function() {
                    function a() {
                        this.m_broadPhase = new Kb;
                        this.m_contactList = null;
                        this.m_contactCount = 0;
                        this.m_contactFilter = hc.b2_defaultFilter;
                        this.m_contactListener = jc.b2_defaultListener;
                        this.m_allocator = null;
                        this.m_contactFactory = new gc(this.m_allocator)
                    }
                    a.prototype.AddPair = function(a, b) {
                        var c = a.fixture,
                            d = b.fixture;
                        a = a.childIndex;
                        var e = b.childIndex;
                        b = c.GetBody();
                        var f = d.GetBody();
                        if (b !== f) {
                            for (f = f.GetContactList(); f;) {
                                if (f.other === b) {
                                    var g = f.contact.GetFixtureA(),
                                        h = f.contact.GetFixtureB(),
                                        k = f.contact.GetChildIndexA(),
                                        l = f.contact.GetChildIndexB();
                                    if (g === c && h === d && k === a && l === e || g === d && h === c && k === e && l === a) return
                                }
                                f = f.next
                            }
                            if (!this.m_contactFilter || this.m_contactFilter.ShouldCollide(c, d)) a = this.m_contactFactory.Create(c, a, d, e), null !== a && (c = a.GetFixtureA(), d = a.GetFixtureB(), a.GetChildIndexA(), a.GetChildIndexB(), b = c.m_body, f = d.m_body,
                                a.m_prev = null, a.m_next = this.m_contactList, null !== this.m_contactList && (this.m_contactList.m_prev = a), this.m_contactList = a, a.m_nodeA.contact = a, a.m_nodeA.other = f, a.m_nodeA.prev = null, a.m_nodeA.next = b.m_contactList, null !== b.m_contactList && (b.m_contactList.prev = a.m_nodeA), b.m_contactList = a.m_nodeA, a.m_nodeB.contact = a, a.m_nodeB.other = b, a.m_nodeB.prev = null, a.m_nodeB.next = f.m_contactList, null !== f.m_contactList && (f.m_contactList.prev = a.m_nodeB), f.m_contactList = a.m_nodeB, c.IsSensor() || d.IsSensor() || (b.SetAwake(!0),
                                    f.SetAwake(!0)), ++this.m_contactCount)
                        }
                    };
                    a.prototype.FindNewContacts = function() {
                        var a = this;
                        this.m_broadPhase.UpdatePairs(function(b, c) {
                            a.AddPair(b, c)
                        })
                    };
                    a.prototype.Destroy = function(a) {
                        var b = a.GetFixtureA(),
                            c = a.GetFixtureB();
                        b = b.GetBody();
                        c = c.GetBody();
                        this.m_contactListener && a.IsTouching() && this.m_contactListener.EndContact(a);
                        a.m_prev && (a.m_prev.m_next = a.m_next);
                        a.m_next && (a.m_next.m_prev = a.m_prev);
                        a === this.m_contactList && (this.m_contactList = a.m_next);
                        a.m_nodeA.prev && (a.m_nodeA.prev.next = a.m_nodeA.next);
                        a.m_nodeA.next && (a.m_nodeA.next.prev = a.m_nodeA.prev);
                        a.m_nodeA === b.m_contactList && (b.m_contactList = a.m_nodeA.next);
                        a.m_nodeB.prev && (a.m_nodeB.prev.next = a.m_nodeB.next);
                        a.m_nodeB.next && (a.m_nodeB.next.prev = a.m_nodeB.prev);
                        a.m_nodeB === c.m_contactList && (c.m_contactList = a.m_nodeB.next);
                        this.m_contactFactory.Destroy(a);
                        --this.m_contactCount
                    };
                    a.prototype.Collide = function() {
                        for (var a, b = this.m_contactList; b;) {
                            a = b.GetFixtureA();
                            var c = b.GetFixtureB(),
                                d = b.GetChildIndexA(),
                                e = b.GetChildIndexB(),
                                h = a.GetBody(),
                                k = c.GetBody();
                            if (b.m_filterFlag) {
                                if (this.m_contactFilter && !this.m_contactFilter.ShouldCollide(a, c)) {
                                    a = b;
                                    b = a.m_next;
                                    this.Destroy(a);
                                    continue
                                }
                                b.m_filterFlag = !1
                            }
                            h = h.IsAwake() && h.m_type !== f.b2BodyType.b2_staticBody;
                            k = k.IsAwake() && k.m_type !== f.b2BodyType.b2_staticBody;
                            h || k ? g(a.m_proxies[d].treeNode.aabb, c.m_proxies[e].treeNode.aabb) ? (b.Update(this.m_contactListener), b = b.m_next) : (a = b, b = a.m_next, this.Destroy(a)) : b = b.m_next
                        }
                    };
                    return a
                }(),
                tb = function() {
                    function a() {
                        this.solveTOI = this.broadphase = this.solvePosition =
                            this.solveVelocity = this.solveInit = this.solve = this.collide = this.step = 0
                    }
                    a.prototype.Reset = function() {
                        this.solveTOI = this.broadphase = this.solvePosition = this.solveVelocity = this.solveInit = this.solve = this.collide = this.step = 0;
                        return this
                    };
                    return a
                }(),
                La = function() {
                    function a() {
                        this.particleIterations = this.positionIterations = this.velocityIterations = this.dtRatio = this.inv_dt = this.dt = 0;
                        this.warmStarting = !1
                    }
                    a.prototype.Copy = function(a) {
                        this.dt = a.dt;
                        this.inv_dt = a.inv_dt;
                        this.dtRatio = a.dtRatio;
                        this.positionIterations =
                            a.positionIterations;
                        this.velocityIterations = a.velocityIterations;
                        this.particleIterations = a.particleIterations;
                        this.warmStarting = a.warmStarting;
                        return this
                    };
                    return a
                }(),
                ub = function() {
                    function a() {
                        this.c = new r;
                        this.a = 0
                    }
                    a.MakeArray = function(c) {
                        return b(c, function(b) {
                            return new a
                        })
                    };
                    return a
                }(),
                vb = function() {
                    function a() {
                        this.v = new r;
                        this.w = 0
                    }
                    a.MakeArray = function(c) {
                        return b(c, function(b) {
                            return new a
                        })
                    };
                    return a
                }(),
                lc = function() {
                    return function() {
                        this.step = new La
                    }
                }(),
                mc = function() {
                    function a() {
                        this.rA =
                            new r;
                        this.rB = new r;
                        this.velocityBias = this.tangentMass = this.normalMass = this.tangentImpulse = this.normalImpulse = 0
                    }
                    a.MakeArray = function(c) {
                        return b(c, function(b) {
                            return new a
                        })
                    };
                    return a
                }(),
                wb = function() {
                    function a() {
                        this.points = mc.MakeArray(2);
                        this.normal = new r;
                        this.tangent = new r;
                        this.normalMass = new la;
                        this.K = new la;
                        this.contactIndex = this.pointCount = this.tangentSpeed = this.restitution = this.friction = this.invIB = this.invIA = this.invMassB = this.invMassA = this.indexB = this.indexA = 0
                    }
                    a.MakeArray = function(c) {
                        return b(c,
                            function(b) {
                                return new a
                            })
                    };
                    return a
                }(),
                xb = function() {
                    function a() {
                        this.localPoints = r.MakeArray(2);
                        this.localNormal = new r;
                        this.localPoint = new r;
                        this.invMassB = this.invMassA = this.indexB = this.indexA = 0;
                        this.localCenterA = new r;
                        this.localCenterB = new r;
                        this.invIB = this.invIA = 0;
                        this.type = f.b2ManifoldType.e_unknown;
                        this.pointCount = this.radiusB = this.radiusA = 0
                    }
                    a.MakeArray = function(c) {
                        return b(c, function(b) {
                            return new a
                        })
                    };
                    return a
                }(),
                nc = function() {
                    return function() {
                        this.step = new La;
                        this.count = 0;
                        this.allocator =
                            null
                    }
                }(),
                yb = function() {
                    function a() {
                        this.normal = new r;
                        this.point = new r;
                        this.separation = 0
                    }
                    a.prototype.Initialize = function(b, c, d, e) {
                        var g = a.Initialize_s_pointA,
                            h = a.Initialize_s_pointB,
                            k = a.Initialize_s_planePoint,
                            l = a.Initialize_s_clipPoint;
                        switch (b.type) {
                            case f.b2ManifoldType.e_circles:
                                T.MulXV(c, b.localPoint, g);
                                T.MulXV(d, b.localPoints[0], h);
                                r.SubVV(h, g, this.normal).SelfNormalize();
                                r.MidVV(g, h, this.point);
                                this.separation = r.DotVV(r.SubVV(h, g, r.s_t0), this.normal) - b.radiusA - b.radiusB;
                                break;
                            case f.b2ManifoldType.e_faceA:
                                N.MulRV(c.q,
                                    b.localNormal, this.normal);
                                T.MulXV(c, b.localPoint, k);
                                T.MulXV(d, b.localPoints[e], l);
                                this.separation = r.DotVV(r.SubVV(l, k, r.s_t0), this.normal) - b.radiusA - b.radiusB;
                                this.point.Copy(l);
                                break;
                            case f.b2ManifoldType.e_faceB:
                                N.MulRV(d.q, b.localNormal, this.normal), T.MulXV(d, b.localPoint, k), T.MulXV(c, b.localPoints[e], l), this.separation = r.DotVV(r.SubVV(l, k, r.s_t0), this.normal) - b.radiusA - b.radiusB, this.point.Copy(l), this.normal.SelfNeg()
                        }
                    };
                    a.Initialize_s_pointA = new r;
                    a.Initialize_s_pointB = new r;
                    a.Initialize_s_planePoint =
                        new r;
                    a.Initialize_s_clipPoint = new r;
                    return a
                }(),
                oc = function() {
                    function a() {
                        this.m_step = new La;
                        this.m_allocator = null;
                        this.m_positionConstraints = xb.MakeArray(1024);
                        this.m_velocityConstraints = wb.MakeArray(1024);
                        this.m_count = 0
                    }
                    a.prototype.Initialize = function(a) {
                        var b;
                        this.m_step.Copy(a.step);
                        this.m_allocator = a.allocator;
                        this.m_count = a.count;
                        if (this.m_positionConstraints.length < this.m_count)
                            for (b = aa(2 * this.m_positionConstraints.length, this.m_count); this.m_positionConstraints.length < b;) this.m_positionConstraints[this.m_positionConstraints.length] =
                                new xb;
                        if (this.m_velocityConstraints.length < this.m_count)
                            for (b = aa(2 * this.m_velocityConstraints.length, this.m_count); this.m_velocityConstraints.length < b;) this.m_velocityConstraints[this.m_velocityConstraints.length] = new wb;
                        this.m_positions = a.positions;
                        this.m_velocities = a.velocities;
                        this.m_contacts = a.contacts;
                        for (a = 0; a < this.m_count; ++a) {
                            b = this.m_contacts[a];
                            var c = b.m_fixtureA,
                                d = b.m_fixtureB,
                                e = c.GetShape(),
                                f = d.GetShape();
                            e = e.m_radius;
                            var g = f.m_radius,
                                h = c.GetBody(),
                                k = d.GetBody();
                            d = b.GetManifold();
                            c = d.pointCount;
                            f = this.m_velocityConstraints[a];
                            f.friction = b.m_friction;
                            f.restitution = b.m_restitution;
                            f.tangentSpeed = b.m_tangentSpeed;
                            f.indexA = h.m_islandIndex;
                            f.indexB = k.m_islandIndex;
                            f.invMassA = h.m_invMass;
                            f.invMassB = k.m_invMass;
                            f.invIA = h.m_invI;
                            f.invIB = k.m_invI;
                            f.contactIndex = a;
                            f.pointCount = c;
                            f.K.SetZero();
                            f.normalMass.SetZero();
                            b = this.m_positionConstraints[a];
                            b.indexA = h.m_islandIndex;
                            b.indexB = k.m_islandIndex;
                            b.invMassA = h.m_invMass;
                            b.invMassB = k.m_invMass;
                            b.localCenterA.Copy(h.m_sweep.localCenter);
                            b.localCenterB.Copy(k.m_sweep.localCenter);
                            b.invIA = h.m_invI;
                            b.invIB = k.m_invI;
                            b.localNormal.Copy(d.localNormal);
                            b.localPoint.Copy(d.localPoint);
                            b.pointCount = c;
                            b.radiusA = e;
                            b.radiusB = g;
                            b.type = d.type;
                            for (e = 0; e < c; ++e) g = d.points[e], h = f.points[e], this.m_step.warmStarting ? (h.normalImpulse = this.m_step.dtRatio * g.normalImpulse, h.tangentImpulse = this.m_step.dtRatio * g.tangentImpulse) : (h.normalImpulse = 0, h.tangentImpulse = 0), h.rA.SetZero(), h.rB.SetZero(), h.normalMass = 0, h.tangentMass = 0, h.velocityBias = 0, b.localPoints[e].Copy(g.localPoint)
                        }
                        return this
                    };
                    a.prototype.InitializeVelocityConstraints =
                        function() {
                            for (var b = a.InitializeVelocityConstraints_s_xfA, c = a.InitializeVelocityConstraints_s_xfB, d = a.InitializeVelocityConstraints_s_worldManifold, e = 0; e < this.m_count; ++e) {
                                var f = this.m_velocityConstraints[e],
                                    g = this.m_positionConstraints[e],
                                    h = g.radiusA,
                                    k = g.radiusB,
                                    l = this.m_contacts[f.contactIndex].GetManifold(),
                                    m = f.indexA,
                                    n = f.indexB,
                                    p = f.invMassA,
                                    q = f.invMassB,
                                    t = f.invIA,
                                    Y = f.invIB,
                                    u = g.localCenterA,
                                    v = g.localCenterB;
                                g = this.m_positions[m].c;
                                var w = this.m_velocities[m].v,
                                    x = this.m_velocities[m].w,
                                    y = this.m_positions[n].c,
                                    z = this.m_positions[n].a,
                                    A = this.m_velocities[n].v;
                                n = this.m_velocities[n].w;
                                b.q.SetAngle(this.m_positions[m].a);
                                c.q.SetAngle(z);
                                r.SubVV(g, N.MulRV(b.q, u, r.s_t0), b.p);
                                r.SubVV(y, N.MulRV(c.q, v, r.s_t0), c.p);
                                d.Initialize(l, b, h, c, k);
                                f.normal.Copy(d.normal);
                                r.CrossVOne(f.normal, f.tangent);
                                h = f.pointCount;
                                for (k = 0; k < h; ++k) l = f.points[k], r.SubVV(d.points[k], g, l.rA), r.SubVV(d.points[k], y, l.rB), m = r.CrossVV(l.rA, f.normal), u = r.CrossVV(l.rB, f.normal), m = p + q + t * m * m + Y * u * u, l.normalMass = 0 < m ? 1 / m : 0, u = f.tangent, m = r.CrossVV(l.rA,
                                    u), u = r.CrossVV(l.rB, u), m = p + q + t * m * m + Y * u * u, l.tangentMass = 0 < m ? 1 / m : 0, l.velocityBias = 0, m = r.DotVV(f.normal, r.SubVV(r.AddVCrossSV(A, n, l.rB, r.s_t0), r.AddVCrossSV(w, x, l.rA, r.s_t1), r.s_t0)), -1 > m && (l.velocityBias += -f.restitution * m)
                            }
                        };
                    a.prototype.WarmStart = function() {
                        for (var b = a.WarmStart_s_P, c = 0; c < this.m_count; ++c) {
                            for (var d = this.m_velocityConstraints[c], e = d.indexA, f = d.indexB, g = d.invMassA, h = d.invIA, k = d.invMassB, l = d.invIB, m = d.pointCount, n = this.m_velocities[e].v, p = this.m_velocities[e].w, q = this.m_velocities[f].v,
                                    t = this.m_velocities[f].w, Y = d.normal, u = d.tangent, v = 0; v < m; ++v) {
                                var w = d.points[v];
                                r.AddVV(r.MulSV(w.normalImpulse, Y, r.s_t0), r.MulSV(w.tangentImpulse, u, r.s_t1), b);
                                p -= h * r.CrossVV(w.rA, b);
                                n.SelfMulSub(g, b);
                                t += l * r.CrossVV(w.rB, b);
                                q.SelfMulAdd(k, b)
                            }
                            this.m_velocities[e].w = p;
                            this.m_velocities[f].w = t
                        }
                    };
                    a.prototype.SolveVelocityConstraints = function() {
                        for (var b, d, e, f = a.SolveVelocityConstraints_s_dv, g = a.SolveVelocityConstraints_s_P, h = 0; h < this.m_count; ++h) {
                            for (var k = this.m_velocityConstraints[h], l = k.indexA, m = k.indexB,
                                    n = k.invMassA, p = k.invIA, q = k.invMassB, t = k.invIB, Y = k.pointCount, u = this.m_velocities[l].v, v = this.m_velocities[l].w, w = this.m_velocities[m].v, x = this.m_velocities[m].w, y = k.normal, z = k.tangent, A = k.friction, B = 0; B < Y; ++B) e = k.points[B], r.SubVV(r.AddVCrossSV(w, x, e.rB, r.s_t0), r.AddVCrossSV(u, v, e.rA, r.s_t1), f), d = r.DotVV(f, z) - k.tangentSpeed, d = e.tangentMass * -d, b = A * e.normalImpulse, b = c(e.tangentImpulse + d, -b, b), d = b - e.tangentImpulse, e.tangentImpulse = b, r.MulSV(d, z, g), u.SelfMulSub(n, g), v -= p * r.CrossVV(e.rA, g), w.SelfMulAdd(q,
                                g), x += t * r.CrossVV(e.rB, g);
                            for (B = 0; B < Y; ++B) e = k.points[B], r.SubVV(r.AddVCrossSV(w, x, e.rB, r.s_t0), r.AddVCrossSV(u, v, e.rA, r.s_t1), f), z = r.DotVV(f, y), d = -e.normalMass * (z - e.velocityBias), b = aa(e.normalImpulse + d, 0), d = b - e.normalImpulse, e.normalImpulse = b, r.MulSV(d, y, g), u.SelfMulSub(n, g), v -= p * r.CrossVV(e.rA, g), w.SelfMulAdd(q, g), x += t * r.CrossVV(e.rB, g);
                            this.m_velocities[l].w = v;
                            this.m_velocities[m].w = x
                        }
                    };
                    a.prototype.StoreImpulses = function() {
                        for (var a = 0; a < this.m_count; ++a)
                            for (var b = this.m_velocityConstraints[a], c =
                                    this.m_contacts[b.contactIndex].GetManifold(), d = 0; d < b.pointCount; ++d) c.points[d].normalImpulse = b.points[d].normalImpulse, c.points[d].tangentImpulse = b.points[d].tangentImpulse
                    };
                    a.prototype.SolvePositionConstraints = function() {
                        for (var b = a.SolvePositionConstraints_s_xfA, d = a.SolvePositionConstraints_s_xfB, e = a.SolvePositionConstraints_s_psm, f = a.SolvePositionConstraints_s_rA, g = a.SolvePositionConstraints_s_rB, h = a.SolvePositionConstraints_s_P, k = 0, l = 0; l < this.m_count; ++l) {
                            for (var m = this.m_positionConstraints[l],
                                    n = m.indexA, p = m.indexB, q = m.localCenterA, t = m.invMassA, Y = m.invIA, u = m.localCenterB, v = m.invMassB, w = m.invIB, x = m.pointCount, y = this.m_positions[n].c, z = this.m_positions[n].a, A = this.m_positions[p].c, B = this.m_positions[p].a, C = 0; C < x; ++C) {
                                b.q.SetAngle(z);
                                d.q.SetAngle(B);
                                r.SubVV(y, N.MulRV(b.q, q, r.s_t0), b.p);
                                r.SubVV(A, N.MulRV(d.q, u, r.s_t0), d.p);
                                e.Initialize(m, b, d, C);
                                var E = e.normal,
                                    F = e.point,
                                    G = e.separation;
                                r.SubVV(F, y, f);
                                r.SubVV(F, A, g);
                                k = W(k, G);
                                F = c(.2 * (G + .008), -.2, 0);
                                G = r.CrossVV(f, E);
                                var H = r.CrossVV(g, E);
                                G = t + v + Y *
                                    G * G + w * H * H;
                                r.MulSV(0 < G ? -F / G : 0, E, h);
                                y.SelfMulSub(t, h);
                                z -= Y * r.CrossVV(f, h);
                                A.SelfMulAdd(v, h);
                                B += w * r.CrossVV(g, h)
                            }
                            this.m_positions[n].a = z;
                            this.m_positions[p].a = B
                        }
                        return -.024 < k
                    };
                    a.prototype.SolveTOIPositionConstraints = function(b, d) {
                        for (var e = a.SolveTOIPositionConstraints_s_xfA, f = a.SolveTOIPositionConstraints_s_xfB, g = a.SolveTOIPositionConstraints_s_psm, h = a.SolveTOIPositionConstraints_s_rA, k = a.SolveTOIPositionConstraints_s_rB, l = a.SolveTOIPositionConstraints_s_P, m = 0, n = 0; n < this.m_count; ++n) {
                            var D = this.m_positionConstraints[n],
                                p = D.indexA,
                                q = D.indexB,
                                J = D.localCenterA,
                                t = D.localCenterB,
                                Y = D.pointCount,
                                u = 0,
                                v = 0;
                            if (p === b || p === d) u = D.invMassA, v = D.invIA;
                            var w = 0,
                                x = 0;
                            if (q === b || q === d) w = D.invMassB, x = D.invIB;
                            for (var y = this.m_positions[p].c, z = this.m_positions[p].a, A = this.m_positions[q].c, B = this.m_positions[q].a, C = 0; C < Y; ++C) {
                                e.q.SetAngle(z);
                                f.q.SetAngle(B);
                                r.SubVV(y, N.MulRV(e.q, J, r.s_t0), e.p);
                                r.SubVV(A, N.MulRV(f.q, t, r.s_t0), f.p);
                                g.Initialize(D, e, f, C);
                                var E = g.normal,
                                    F = g.point,
                                    G = g.separation;
                                r.SubVV(F, y, h);
                                r.SubVV(F, A, k);
                                m = W(m, G);
                                F = c(.75 *
                                    (G + .008), -.2, 0);
                                G = r.CrossVV(h, E);
                                var H = r.CrossVV(k, E);
                                G = u + w + v * G * G + x * H * H;
                                r.MulSV(0 < G ? -F / G : 0, E, l);
                                y.SelfMulSub(u, l);
                                z -= v * r.CrossVV(h, l);
                                A.SelfMulAdd(w, l);
                                B += x * r.CrossVV(k, l)
                            }
                            this.m_positions[p].a = z;
                            this.m_positions[q].a = B
                        }
                        return -.012 <= m
                    };
                    a.InitializeVelocityConstraints_s_xfA = new T;
                    a.InitializeVelocityConstraints_s_xfB = new T;
                    a.InitializeVelocityConstraints_s_worldManifold = new Gb;
                    a.WarmStart_s_P = new r;
                    a.SolveVelocityConstraints_s_dv = new r;
                    a.SolveVelocityConstraints_s_dv1 = new r;
                    a.SolveVelocityConstraints_s_dv2 =
                        new r;
                    a.SolveVelocityConstraints_s_P = new r;
                    a.SolveVelocityConstraints_s_a = new r;
                    a.SolveVelocityConstraints_s_b = new r;
                    a.SolveVelocityConstraints_s_x = new r;
                    a.SolveVelocityConstraints_s_d = new r;
                    a.SolveVelocityConstraints_s_P1 = new r;
                    a.SolveVelocityConstraints_s_P2 = new r;
                    a.SolveVelocityConstraints_s_P1P2 = new r;
                    a.SolvePositionConstraints_s_xfA = new T;
                    a.SolvePositionConstraints_s_xfB = new T;
                    a.SolvePositionConstraints_s_psm = new yb;
                    a.SolvePositionConstraints_s_rA = new r;
                    a.SolvePositionConstraints_s_rB = new r;
                    a.SolvePositionConstraints_s_P = new r;
                    a.SolveTOIPositionConstraints_s_xfA = new T;
                    a.SolveTOIPositionConstraints_s_xfB = new T;
                    a.SolveTOIPositionConstraints_s_psm = new yb;
                    a.SolveTOIPositionConstraints_s_rA = new r;
                    a.SolveTOIPositionConstraints_s_rB = new r;
                    a.SolveTOIPositionConstraints_s_P = new r;
                    return a
                }(),
                pc = function() {
                    function a() {
                        this.m_allocator = null;
                        this.m_bodies = [];
                        this.m_contacts = [];
                        this.m_joints = [];
                        this.m_positions = ub.MakeArray(1024);
                        this.m_velocities = vb.MakeArray(1024);
                        this.m_jointCapacity = this.m_contactCapacity =
                            this.m_bodyCapacity = this.m_contactCount = this.m_jointCount = this.m_bodyCount = 0
                    }
                    a.prototype.Initialize = function(a, b, c, d, e) {
                        this.m_bodyCapacity = a;
                        this.m_contactCapacity = b;
                        this.m_jointCapacity = c;
                        this.m_jointCount = this.m_contactCount = this.m_bodyCount = 0;
                        this.m_allocator = d;
                        this.m_listener = e;
                        if (this.m_positions.length < a)
                            for (b = aa(2 * this.m_positions.length, a); this.m_positions.length < b;) this.m_positions[this.m_positions.length] = new ub;
                        if (this.m_velocities.length < a)
                            for (b = aa(2 * this.m_velocities.length, a); this.m_velocities.length <
                                b;) this.m_velocities[this.m_velocities.length] = new vb
                    };
                    a.prototype.Clear = function() {
                        this.m_jointCount = this.m_contactCount = this.m_bodyCount = 0
                    };
                    a.prototype.AddBody = function(a) {
                        a.m_islandIndex = this.m_bodyCount;
                        this.m_bodies[this.m_bodyCount++] = a
                    };
                    a.prototype.AddContact = function(a) {
                        this.m_contacts[this.m_contactCount++] = a
                    };
                    a.prototype.AddJoint = function(a) {
                        this.m_joints[this.m_jointCount++] = a
                    };
                    a.prototype.Solve = function(b, c, d, e) {
                        for (var g, h, k, l, m, n = a.s_timer.Reset(), D = c.dt, p = 0; p < this.m_bodyCount; ++p) g =
                            this.m_bodies[p], this.m_positions[p].c.Copy(g.m_sweep.c), m = g.m_sweep.a, l = this.m_velocities[p].v.Copy(g.m_linearVelocity), k = g.m_angularVelocity, g.m_sweep.c0.Copy(g.m_sweep.c), g.m_sweep.a0 = g.m_sweep.a, g.m_type === f.b2BodyType.b2_dynamicBody && (l.x += D * (g.m_gravityScale * d.x + g.m_invMass * g.m_force.x), l.y += D * (g.m_gravityScale * d.y + g.m_invMass * g.m_force.y), k += D * g.m_invI * g.m_torque, l.SelfMul(1 / (1 + D * g.m_linearDamping)), k *= 1 / (1 + D * g.m_angularDamping)), this.m_positions[p].a = m, this.m_velocities[p].w = k;
                        n.Reset();
                        g =
                            a.s_solverData;
                        g.step.Copy(c);
                        g.positions = this.m_positions;
                        g.velocities = this.m_velocities;
                        p = a.s_contactSolverDef;
                        p.step.Copy(c);
                        p.contacts = this.m_contacts;
                        p.count = this.m_contactCount;
                        p.positions = this.m_positions;
                        p.velocities = this.m_velocities;
                        p.allocator = this.m_allocator;
                        d = a.s_contactSolver.Initialize(p);
                        d.InitializeVelocityConstraints();
                        c.warmStarting && d.WarmStart();
                        for (p = 0; p < this.m_jointCount; ++p) this.m_joints[p].InitVelocityConstraints(g);
                        b.solveInit = n.GetMilliseconds();
                        n.Reset();
                        for (p = 0; p < c.velocityIterations; ++p) {
                            for (l =
                                0; l < this.m_jointCount; ++l) this.m_joints[l].SolveVelocityConstraints(g);
                            d.SolveVelocityConstraints()
                        }
                        d.StoreImpulses();
                        b.solveVelocity = n.GetMilliseconds();
                        for (p = 0; p < this.m_bodyCount; ++p) {
                            var q = this.m_positions[p].c;
                            m = this.m_positions[p].a;
                            l = this.m_velocities[p].v;
                            k = this.m_velocities[p].w;
                            h = r.MulSV(D, l, a.s_translation);
                            4 < r.DotVV(h, h) && (h = 2 / h.Length(), l.SelfMul(h));
                            h = D * k;
                            2.4674011002726646 < h * h && (h = 1.570796326795 / ba(h), k *= h);
                            q.x += D * l.x;
                            q.y += D * l.y;
                            m += D * k;
                            this.m_positions[p].a = m;
                            this.m_velocities[p].w =
                                k
                        }
                        n.Reset();
                        k = !1;
                        for (p = 0; p < c.positionIterations; ++p) {
                            m = d.SolvePositionConstraints();
                            q = !0;
                            for (l = 0; l < this.m_jointCount; ++l) h = this.m_joints[l].SolvePositionConstraints(g), q = q && h;
                            if (m && q) {
                                k = !0;
                                break
                            }
                        }
                        for (p = 0; p < this.m_bodyCount; ++p) c = this.m_bodies[p], c.m_sweep.c.Copy(this.m_positions[p].c), c.m_sweep.a = this.m_positions[p].a, c.m_linearVelocity.Copy(this.m_velocities[p].v), c.m_angularVelocity = this.m_velocities[p].w, c.SynchronizeTransform();
                        b.solvePosition = n.GetMilliseconds();
                        this.Report(d.m_velocityConstraints);
                        if (e) {
                            b = 1E37;
                            e = da * da;
                            for (p = 0; p < this.m_bodyCount; ++p) g = this.m_bodies[p], g.GetType() !== f.b2BodyType.b2_staticBody && (!g.m_autoSleepFlag || g.m_angularVelocity * g.m_angularVelocity > e || 1E-4 < r.DotVV(g.m_linearVelocity, g.m_linearVelocity) ? b = g.m_sleepTime = 0 : (g.m_sleepTime += D, b = W(b, g.m_sleepTime)));
                            if (.5 <= b && k)
                                for (p = 0; p < this.m_bodyCount; ++p) g = this.m_bodies[p], g.SetAwake(!1)
                        }
                    };
                    a.prototype.SolveTOI = function(b, c, d) {
                        for (var e, f = 0; f < this.m_bodyCount; ++f) {
                            var g = this.m_bodies[f];
                            this.m_positions[f].c.Copy(g.m_sweep.c);
                            this.m_positions[f].a = g.m_sweep.a;
                            this.m_velocities[f].v.Copy(g.m_linearVelocity);
                            this.m_velocities[f].w = g.m_angularVelocity
                        }
                        f = a.s_contactSolverDef;
                        f.contacts = this.m_contacts;
                        f.count = this.m_contactCount;
                        f.allocator = this.m_allocator;
                        f.step.Copy(b);
                        f.positions = this.m_positions;
                        f.velocities = this.m_velocities;
                        g = a.s_contactSolver.Initialize(f);
                        for (f = 0; f < b.positionIterations && !g.SolveTOIPositionConstraints(c, d); ++f);
                        this.m_bodies[c].m_sweep.c0.Copy(this.m_positions[c].c);
                        this.m_bodies[c].m_sweep.a0 = this.m_positions[c].a;
                        this.m_bodies[d].m_sweep.c0.Copy(this.m_positions[d].c);
                        this.m_bodies[d].m_sweep.a0 = this.m_positions[d].a;
                        g.InitializeVelocityConstraints();
                        for (f = 0; f < b.velocityIterations; ++f) g.SolveVelocityConstraints();
                        b = b.dt;
                        for (f = 0; f < this.m_bodyCount; ++f) {
                            c = this.m_positions[f].c;
                            d = this.m_positions[f].a;
                            var h = this.m_velocities[f].v,
                                k = this.m_velocities[f].w;
                            e = r.MulSV(b, h, a.s_translation);
                            4 < r.DotVV(e, e) && (e = 2 / e.Length(), h.SelfMul(e));
                            e = b * k;
                            2.4674011002726646 < e * e && (e = 1.570796326795 / ba(e), k *= e);
                            c.SelfMulAdd(b, h);
                            d +=
                                b * k;
                            this.m_positions[f].a = d;
                            this.m_velocities[f].w = k;
                            e = this.m_bodies[f];
                            e.m_sweep.c.Copy(c);
                            e.m_sweep.a = d;
                            e.m_linearVelocity.Copy(h);
                            e.m_angularVelocity = k;
                            e.SynchronizeTransform()
                        }
                        this.Report(g.m_velocityConstraints)
                    };
                    a.prototype.Report = function(b) {
                        if (null !== this.m_listener)
                            for (var c = 0; c < this.m_contactCount; ++c) {
                                var d = this.m_contacts[c];
                                if (d) {
                                    var e = b[c],
                                        f = a.s_impulse;
                                    f.count = e.pointCount;
                                    for (var g = 0; g < e.pointCount; ++g) f.normalImpulses[g] = e.points[g].normalImpulse, f.tangentImpulses[g] = e.points[g].tangentImpulse;
                                    this.m_listener.PostSolve(d, f)
                                }
                            }
                    };
                    a.s_timer = new xa;
                    a.s_solverData = new lc;
                    a.s_contactSolverDef = new nc;
                    a.s_contactSolver = new oc;
                    a.s_translation = new r;
                    a.s_impulse = new ic;
                    return a
                }();
            (function(a) {
                a[a.b2_waterParticle = 0] = "b2_waterParticle";
                a[a.b2_zombieParticle = 2] = "b2_zombieParticle";
                a[a.b2_wallParticle = 4] = "b2_wallParticle";
                a[a.b2_springParticle = 8] = "b2_springParticle";
                a[a.b2_elasticParticle = 16] = "b2_elasticParticle";
                a[a.b2_viscousParticle = 32] = "b2_viscousParticle";
                a[a.b2_powderParticle = 64] = "b2_powderParticle";
                a[a.b2_tensileParticle = 128] = "b2_tensileParticle";
                a[a.b2_colorMixingParticle = 256] = "b2_colorMixingParticle";
                a[a.b2_destructionListenerParticle = 512] = "b2_destructionListenerParticle";
                a[a.b2_barrierParticle = 1024] = "b2_barrierParticle";
                a[a.b2_staticPressureParticle = 2048] = "b2_staticPressureParticle";
                a[a.b2_reactiveParticle = 4096] = "b2_reactiveParticle";
                a[a.b2_repulsiveParticle = 8192] = "b2_repulsiveParticle";
                a[a.b2_fixtureContactListenerParticle = 16384] = "b2_fixtureContactListenerParticle";
                a[a.b2_particleContactListenerParticle =
                    32768] = "b2_particleContactListenerParticle";
                a[a.b2_fixtureContactFilterParticle = 65536] = "b2_fixtureContactFilterParticle";
                a[a.b2_particleContactFilterParticle = 131072] = "b2_particleContactFilterParticle"
            })(f.b2ParticleFlag || (f.b2ParticleFlag = {}));
            var zb = function() {
                    return function() {
                        this.flags = 0;
                        this.position = new r;
                        this.velocity = new r;
                        this.color = new oa(0, 0, 0, 0);
                        this.lifetime = 0;
                        this.group = this.userData = null
                    }
                }(),
                qc = function() {
                    function a() {
                        this.m_index = -1
                    }
                    a.prototype.GetIndex = function() {
                        return this.m_index
                    };
                    a.prototype.SetIndex = function(a) {
                        this.m_index = a
                    };
                    return a
                }();
            (function(a) {
                a[a.b2_solidParticleGroup = 1] = "b2_solidParticleGroup";
                a[a.b2_rigidParticleGroup = 2] = "b2_rigidParticleGroup";
                a[a.b2_particleGroupCanBeEmpty = 4] = "b2_particleGroupCanBeEmpty";
                a[a.b2_particleGroupWillBeDestroyed = 8] = "b2_particleGroupWillBeDestroyed";
                a[a.b2_particleGroupNeedsUpdateDepth = 16] = "b2_particleGroupNeedsUpdateDepth";
                a[a.b2_particleGroupInternalMask = 24] = "b2_particleGroupInternalMask"
            })(f.b2ParticleGroupFlag || (f.b2ParticleGroupFlag = {}));
            var rc = function() {
                    return function() {
                        this.groupFlags = this.flags = 0;
                        this.position = new r;
                        this.angle = 0;
                        this.linearVelocity = new r;
                        this.angularVelocity = 0;
                        this.color = new oa;
                        this.strength = 1;
                        this.lifetime = this.particleCount = this.stride = this.shapeCount = 0;
                        this.group = this.userData = null
                    }
                }(),
                sc = function() {
                    function a(a) {
                        this.m_groupFlags = this.m_lastIndex = this.m_firstIndex = 0;
                        this.m_strength = 1;
                        this.m_next = this.m_prev = null;
                        this.m_timestamp = -1;
                        this.m_inertia = this.m_mass = 0;
                        this.m_center = new r;
                        this.m_linearVelocity =
                            new r;
                        this.m_angularVelocity = 0;
                        this.m_transform = new T;
                        this.m_userData = null;
                        this.m_system = a
                    }
                    a.prototype.GetNext = function() {
                        return this.m_next
                    };
                    a.prototype.GetParticleSystem = function() {
                        return this.m_system
                    };
                    a.prototype.GetParticleCount = function() {
                        return this.m_lastIndex - this.m_firstIndex
                    };
                    a.prototype.GetBufferIndex = function() {
                        return this.m_firstIndex
                    };
                    a.prototype.ContainsParticle = function(a) {
                        return this.m_firstIndex <= a && a < this.m_lastIndex
                    };
                    a.prototype.GetAllParticleFlags = function() {
                        if (!this.m_system.m_flagsBuffer.data) throw Error();
                        for (var a = 0, b = this.m_firstIndex; b < this.m_lastIndex; b++) a |= this.m_system.m_flagsBuffer.data[b];
                        return a
                    };
                    a.prototype.GetGroupFlags = function() {
                        return this.m_groupFlags
                    };
                    a.prototype.SetGroupFlags = function(a) {
                        a |= this.m_groupFlags & f.b2ParticleGroupFlag.b2_particleGroupInternalMask;
                        this.m_system.SetGroupFlags(this, a)
                    };
                    a.prototype.GetMass = function() {
                        this.UpdateStatistics();
                        return this.m_mass
                    };
                    a.prototype.GetInertia = function() {
                        this.UpdateStatistics();
                        return this.m_inertia
                    };
                    a.prototype.GetCenter = function() {
                        this.UpdateStatistics();
                        return this.m_center
                    };
                    a.prototype.GetLinearVelocity = function() {
                        this.UpdateStatistics();
                        return this.m_linearVelocity
                    };
                    a.prototype.GetAngularVelocity = function() {
                        this.UpdateStatistics();
                        return this.m_angularVelocity
                    };
                    a.prototype.GetTransform = function() {
                        return this.m_transform
                    };
                    a.prototype.GetPosition = function() {
                        return this.m_transform.p
                    };
                    a.prototype.GetAngle = function() {
                        return this.m_transform.q.GetAngle()
                    };
                    a.prototype.GetLinearVelocityFromWorldPoint = function(b, c) {
                        var d = a.GetLinearVelocityFromWorldPoint_s_t0;
                        this.UpdateStatistics();
                        return r.AddVCrossSV(this.m_linearVelocity, this.m_angularVelocity, r.SubVV(b, this.m_center, d), c)
                    };
                    a.prototype.GetUserData = function() {
                        return this.m_userData
                    };
                    a.prototype.SetUserData = function(a) {
                        this.m_userData = a
                    };
                    a.prototype.ApplyForce = function(a) {
                        this.m_system.ApplyForce(this.m_firstIndex, this.m_lastIndex, a)
                    };
                    a.prototype.ApplyLinearImpulse = function(a) {
                        this.m_system.ApplyLinearImpulse(this.m_firstIndex, this.m_lastIndex, a)
                    };
                    a.prototype.DestroyParticles = function(a) {
                        if (this.m_system.m_world.IsLocked()) throw Error();
                        for (var b = this.m_firstIndex; b < this.m_lastIndex; b++) this.m_system.DestroyParticle(b, a)
                    };
                    a.prototype.UpdateStatistics = function() {
                        if (!this.m_system.m_positionBuffer.data) throw Error();
                        if (!this.m_system.m_velocityBuffer.data) throw Error();
                        var a = new r,
                            b = new r;
                        if (this.m_timestamp !== this.m_system.m_timestamp) {
                            var c = this.m_system.GetParticleMass();
                            this.m_mass = c * (this.m_lastIndex - this.m_firstIndex);
                            this.m_center.SetZero();
                            this.m_linearVelocity.SetZero();
                            for (var d = this.m_firstIndex; d < this.m_lastIndex; d++) this.m_center.SelfMulAdd(c,
                                this.m_system.m_positionBuffer.data[d]), this.m_linearVelocity.SelfMulAdd(c, this.m_system.m_velocityBuffer.data[d]);
                            0 < this.m_mass && (d = 1 / this.m_mass, this.m_center.SelfMul(d), this.m_linearVelocity.SelfMul(d));
                            this.m_angularVelocity = this.m_inertia = 0;
                            for (d = this.m_firstIndex; d < this.m_lastIndex; d++) r.SubVV(this.m_system.m_positionBuffer.data[d], this.m_center, a), r.SubVV(this.m_system.m_velocityBuffer.data[d], this.m_linearVelocity, b), this.m_inertia += c * r.DotVV(a, a), this.m_angularVelocity += c * r.CrossVV(a, b);
                            0 < this.m_inertia && (this.m_angularVelocity *= 1 / this.m_inertia);
                            this.m_timestamp = this.m_system.m_timestamp
                        }
                    };
                    a.GetLinearVelocityFromWorldPoint_s_t0 = new r;
                    return a
                }(),
                Xd = function() {
                    function a(a) {
                        this.m_capacity = this.m_back = this.m_front = 0;
                        this.m_buffer = b(a, function(a) {
                            return null
                        });
                        this.m_capacity = a
                    }
                    a.prototype.Push = function(a) {
                        if (this.m_back >= this.m_capacity) {
                            for (var c = this.m_front; c < this.m_back; c++) this.m_buffer[c - this.m_front] = this.m_buffer[c];
                            this.m_back -= this.m_front;
                            this.m_front = 0;
                            this.m_back >= this.m_capacity &&
                                (0 < this.m_capacity ? (this.m_buffer.concat(b(this.m_capacity, function(a) {
                                    return null
                                })), this.m_capacity *= 2) : (this.m_buffer.concat(b(1, function(a) {
                                    return null
                                })), this.m_capacity = 1))
                        }
                        this.m_buffer[this.m_back] = a;
                        this.m_back++
                    };
                    a.prototype.Pop = function() {
                        this.m_buffer[this.m_front] = null;
                        this.m_front++
                    };
                    a.prototype.Empty = function() {
                        return this.m_front === this.m_back
                    };
                    a.prototype.Front = function() {
                        var a = this.m_buffer[this.m_front];
                        if (!a) throw Error();
                        return a
                    };
                    return a
                }(),
                Ab = function() {
                    function a(c) {
                        this.m_countY =
                            this.m_countX = this.m_generatorCount = this.m_generatorCapacity = 0;
                        this.m_diagram = [];
                        this.m_generatorBuffer = b(c, function(b) {
                            return new a.Generator
                        });
                        this.m_generatorCapacity = c
                    }
                    a.prototype.AddGenerator = function(a, b, c) {
                        var d = this.m_generatorBuffer[this.m_generatorCount++];
                        d.center.Copy(a);
                        d.tag = b;
                        d.necessary = c
                    };
                    a.prototype.Generate = function(b, c) {
                        var d;
                        var e = 1 / b;
                        var f = new r(1E37, 1E37);
                        b = new r(-1E37, -1E37);
                        var g = 0;
                        for (d = 0; d < this.m_generatorCount; d++) {
                            var h = this.m_generatorBuffer[d];
                            h.necessary && (r.MinV(f,
                                h.center, f), r.MaxV(b, h.center, b), ++g)
                        }
                        if (0 === g) this.m_countY = this.m_countX = 0;
                        else {
                            f.x -= c;
                            f.y -= c;
                            b.x += c;
                            b.y += c;
                            this.m_countX = 1 + Math.floor(e * (b.x - f.x));
                            this.m_countY = 1 + Math.floor(e * (b.y - f.y));
                            this.m_diagram = [];
                            g = new Xd(4 * this.m_countX * this.m_countY);
                            for (d = 0; d < this.m_generatorCount; d++) h = this.m_generatorBuffer[d], h.center.SelfSub(f).SelfMul(e), b = Math.floor(h.center.x), c = Math.floor(h.center.y), 0 <= b && 0 <= c && b < this.m_countX && c < this.m_countY && g.Push(new a.Task(b, c, b + c * this.m_countX, h));
                            for (; !g.Empty();) d =
                                g.Front(), b = d.m_x, c = d.m_y, e = d.m_i, h = d.m_generator, g.Pop(), this.m_diagram[e] || (this.m_diagram[e] = h, 0 < b && g.Push(new a.Task(b - 1, c, e - 1, h)), 0 < c && g.Push(new a.Task(b, c - 1, e - this.m_countX, h)), b < this.m_countX - 1 && g.Push(new a.Task(b + 1, c, e + 1, h)), c < this.m_countY - 1 && g.Push(new a.Task(b, c + 1, e + this.m_countX, h)));
                            for (c = 0; c < this.m_countY; c++)
                                for (b = 0; b < this.m_countX - 1; b++) e = b + c * this.m_countX, f = this.m_diagram[e], d = this.m_diagram[e + 1], f !== d && (g.Push(new a.Task(b, c, e, d)), g.Push(new a.Task(b + 1, c, e + 1, f)));
                            for (c = 0; c < this.m_countY -
                                1; c++)
                                for (b = 0; b < this.m_countX; b++) e = b + c * this.m_countX, f = this.m_diagram[e], d = this.m_diagram[e + this.m_countX], f !== d && (g.Push(new a.Task(b, c, e, d)), g.Push(new a.Task(b, c + 1, e + this.m_countX, f)));
                            for (; !g.Empty();)
                                if (d = g.Front(), b = d.m_x, c = d.m_y, e = d.m_i, d = d.m_generator, g.Pop(), f = this.m_diagram[e], f !== d) {
                                    h = f.center.x - b;
                                    f = f.center.y - c;
                                    var k = d.center.x - b,
                                        l = d.center.y - c;
                                    h * h + f * f > k * k + l * l && (this.m_diagram[e] = d, 0 < b && g.Push(new a.Task(b - 1, c, e - 1, d)), 0 < c && g.Push(new a.Task(b, c - 1, e - this.m_countX, d)), b < this.m_countX - 1 &&
                                        g.Push(new a.Task(b + 1, c, e + 1, d)), c < this.m_countY - 1 && g.Push(new a.Task(b, c + 1, e + this.m_countX, d)))
                                }
                        }
                    };
                    a.prototype.GetNodes = function(a) {
                        for (var b = 0; b < this.m_countY - 1; b++)
                            for (var c = 0; c < this.m_countX - 1; c++) {
                                var d = c + b * this.m_countX,
                                    e = this.m_diagram[d],
                                    f = this.m_diagram[d + 1],
                                    g = this.m_diagram[d + this.m_countX];
                                d = this.m_diagram[d + 1 + this.m_countX];
                                f !== g && (e !== f && e !== g && (e.necessary || f.necessary || g.necessary) && a(e.tag, f.tag, g.tag), d !== f && d !== g && (e.necessary || f.necessary || g.necessary) && a(f.tag, d.tag, g.tag))
                            }
                    };
                    return a
                }();
            (function(a) {
                var b = function() {
                    return function() {
                        this.center = new r;
                        this.tag = 0;
                        this.necessary = !1
                    }
                }();
                a.Generator = b;
                b = function() {
                    return function(a, b, c, d) {
                        this.m_x = a;
                        this.m_y = b;
                        this.m_i = c;
                        this.m_generator = d
                    }
                }();
                a.Task = b
            })(Ab || (Ab = {}));
            var Ma = function() {
                    function a(a) {
                        this.data = [];
                        this.capacity = this.count = 0;
                        this.allocator = a
                    }
                    a.prototype.Append = function() {
                        this.count >= this.capacity && this.Grow();
                        return this.count++
                    };
                    a.prototype.Reserve = function(a) {
                        if (!(this.capacity >= a)) {
                            for (var b = this.capacity; b < a; ++b) this.data[b] =
                                this.allocator();
                            this.capacity = a
                        }
                    };
                    a.prototype.Grow = function() {
                        this.Reserve(this.capacity ? 2 * this.capacity : 256)
                    };
                    a.prototype.Free = function() {
                        0 !== this.data.length && (this.data = [], this.count = this.capacity = 0)
                    };
                    a.prototype.Shorten = function(a) {};
                    a.prototype.Data = function() {
                        return this.data
                    };
                    a.prototype.GetCount = function() {
                        return this.count
                    };
                    a.prototype.SetCount = function(a) {
                        this.count = a
                    };
                    a.prototype.GetCapacity = function() {
                        return this.capacity
                    };
                    a.prototype.RemoveIf = function(a) {
                        this.count = S(this.data, a, this.count)
                    };
                    a.prototype.Unique = function(a) {
                        var b = this.data,
                            c = 0,
                            d = this.count;
                        if (c === d) a = d;
                        else {
                            for (var e = c; ++c !== d;) a(b[e], b[c]) || H(b, ++e, c);
                            a = ++e
                        }
                        this.count = a
                    };
                    return a
                }(),
                Bb = function(a) {
                    function b(b) {
                        var c = a.call(this) || this;
                        c.m_system = b;
                        return c
                    }
                    C(b, a);
                    b.prototype.ShouldQueryParticleSystem = function(a) {
                        return !1
                    };
                    b.prototype.ReportFixture = function(a) {
                        if (a.IsSensor()) return !0;
                        for (var b = a.GetShape().GetChildCount(), c = 0; c < b; c++) {
                            var d = a.GetAABB(c);
                            d = this.m_system.GetInsideBoundsEnumerator(d);
                            for (var e; 0 <= (e = d.GetNext());) this.ReportFixtureAndParticle(a,
                                c, e)
                        }
                        return !0
                    };
                    b.prototype.ReportParticle = function(a, b) {
                        return !1
                    };
                    b.prototype.ReportFixtureAndParticle = function(a, b, c) {};
                    return b
                }(Ua),
                tc = function() {
                    function a() {
                        this.weight = this.indexB = this.indexA = 0;
                        this.normal = new r;
                        this.flags = 0
                    }
                    a.prototype.SetIndices = function(a, b) {
                        this.indexA = a;
                        this.indexB = b
                    };
                    a.prototype.SetWeight = function(a) {
                        this.weight = a
                    };
                    a.prototype.SetNormal = function(a) {
                        this.normal.Copy(a)
                    };
                    a.prototype.SetFlags = function(a) {
                        this.flags = a
                    };
                    a.prototype.GetIndexA = function() {
                        return this.indexA
                    };
                    a.prototype.GetIndexB = function() {
                        return this.indexB
                    };
                    a.prototype.GetWeight = function() {
                        return this.weight
                    };
                    a.prototype.GetNormal = function() {
                        return this.normal
                    };
                    a.prototype.GetFlags = function() {
                        return this.flags
                    };
                    a.prototype.IsEqual = function(a) {
                        return this.indexA === a.indexA && this.indexB === a.indexB && this.flags === a.flags && this.weight === a.weight && this.normal.x === a.normal.x && this.normal.y === a.normal.y
                    };
                    a.prototype.IsNotEqual = function(a) {
                        return !this.IsEqual(a)
                    };
                    a.prototype.ApproximatelyEqual = function(a) {
                        return this.indexA ===
                            a.indexA && this.indexB === a.indexB && this.flags === a.flags && .01 > ba(this.weight - a.weight) && 1E-4 > r.DistanceSquaredVV(this.normal, a.normal)
                    };
                    return a
                }(),
                uc = function() {
                    return function() {
                        this.weight = this.index = 0;
                        this.normal = new r;
                        this.mass = 0
                    }
                }(),
                vc = function() {
                    return function() {
                        this.distance = this.strength = this.flags = this.indexB = this.indexA = 0
                    }
                }(),
                wc = function() {
                    return function() {
                        this.strength = this.flags = this.indexC = this.indexB = this.indexA = 0;
                        this.pa = new r(0, 0);
                        this.pb = new r(0, 0);
                        this.pc = new r(0, 0);
                        this.s = this.kc =
                            this.kb = this.ka = 0
                    }
                }(),
                xc = function() {
                    function a() {
                        this.strictContactCheck = !1;
                        this.radius = this.gravityScale = this.density = 1;
                        this.maxCount = 0;
                        this.pressureStrength = .005;
                        this.dampingStrength = 1;
                        this.viscousStrength = this.springStrength = this.elasticStrength = .25;
                        this.surfaceTensionNormalStrength = this.surfaceTensionPressureStrength = .2;
                        this.repulsiveStrength = 1;
                        this.ejectionStrength = this.powderStrength = .5;
                        this.staticPressureRelaxation = this.staticPressureStrength = .2;
                        this.staticPressureIterations = 8;
                        this.colorMixingStrength =
                            .5;
                        this.destroyByAge = !0;
                        this.lifetimeGranularity = 1 / 60
                    }
                    a.prototype.Copy = function(a) {
                        this.strictContactCheck = a.strictContactCheck;
                        this.density = a.density;
                        this.gravityScale = a.gravityScale;
                        this.radius = a.radius;
                        this.maxCount = a.maxCount;
                        this.pressureStrength = a.pressureStrength;
                        this.dampingStrength = a.dampingStrength;
                        this.elasticStrength = a.elasticStrength;
                        this.springStrength = a.springStrength;
                        this.viscousStrength = a.viscousStrength;
                        this.surfaceTensionPressureStrength = a.surfaceTensionPressureStrength;
                        this.surfaceTensionNormalStrength =
                            a.surfaceTensionNormalStrength;
                        this.repulsiveStrength = a.repulsiveStrength;
                        this.powderStrength = a.powderStrength;
                        this.ejectionStrength = a.ejectionStrength;
                        this.staticPressureStrength = a.staticPressureStrength;
                        this.staticPressureRelaxation = a.staticPressureRelaxation;
                        this.staticPressureIterations = a.staticPressureIterations;
                        this.colorMixingStrength = a.colorMixingStrength;
                        this.destroyByAge = a.destroyByAge;
                        this.lifetimeGranularity = a.lifetimeGranularity;
                        return this
                    };
                    a.prototype.Clone = function() {
                        return (new a).Copy(this)
                    };
                    return a
                }();
            f.b2ParticleSystem = function() {
                function a(b, c) {
                    this.m_paused = !1;
                    this.m_allParticleFlags = this.m_timestamp = 0;
                    this.m_needsUpdateAllParticleFlags = !1;
                    this.m_allGroupFlags = 0;
                    this.m_hasForce = this.m_needsUpdateAllGroupFlags = !1;
                    this.m_internalAllocatedCapacity = this.m_count = this.m_squaredDiameter = this.m_inverseDiameter = this.m_particleDiameter = this.m_inverseDensity = this.m_iterationIndex = 0;
                    this.m_handleIndexBuffer = new a.UserOverridableBuffer;
                    this.m_flagsBuffer = new a.UserOverridableBuffer;
                    this.m_positionBuffer =
                        new a.UserOverridableBuffer;
                    this.m_velocityBuffer = new a.UserOverridableBuffer;
                    this.m_forceBuffer = [];
                    this.m_weightBuffer = [];
                    this.m_staticPressureBuffer = [];
                    this.m_accumulationBuffer = [];
                    this.m_accumulation2Buffer = [];
                    this.m_depthBuffer = [];
                    this.m_colorBuffer = new a.UserOverridableBuffer;
                    this.m_groupBuffer = [];
                    this.m_userDataBuffer = new a.UserOverridableBuffer;
                    this.m_stuckThreshold = 0;
                    this.m_lastBodyContactStepBuffer = new a.UserOverridableBuffer;
                    this.m_bodyContactCountBuffer = new a.UserOverridableBuffer;
                    this.m_consecutiveContactStepsBuffer =
                        new a.UserOverridableBuffer;
                    this.m_stuckParticleBuffer = new Ma(function() {
                        return 0
                    });
                    this.m_proxyBuffer = new Ma(function() {
                        return new a.Proxy
                    });
                    this.m_contactBuffer = new Ma(function() {
                        return new tc
                    });
                    this.m_bodyContactBuffer = new Ma(function() {
                        return new uc
                    });
                    this.m_pairBuffer = new Ma(function() {
                        return new vc
                    });
                    this.m_triadBuffer = new Ma(function() {
                        return new wc
                    });
                    this.m_expirationTimeBuffer = new a.UserOverridableBuffer;
                    this.m_indexByExpirationTimeBuffer = new a.UserOverridableBuffer;
                    this.m_timeElapsed = 0;
                    this.m_expirationTimeBufferRequiresSorting = !1;
                    this.m_groupCount = 0;
                    this.m_groupList = null;
                    this.m_def = new xc;
                    this.m_next = this.m_prev = null;
                    this.SetStrictContactCheck(b.strictContactCheck);
                    this.SetDensity(b.density);
                    this.SetGravityScale(b.gravityScale);
                    this.SetRadius(b.radius);
                    this.SetMaxParticleCount(b.maxCount);
                    this.m_def = b.Clone();
                    this.m_world = c;
                    this.SetDestructionByAge(this.m_def.destroyByAge)
                }
                a.computeTag = function(b, c) {
                    return (c + a.yOffset >>> 0 << a.yShift) + (a.xScale * b + a.xOffset >>> 0) >>> 0
                };
                a.computeRelativeTag =
                    function(b, c, d) {
                        return b + (d << a.yShift) + (c << a.xShift) >>> 0
                    };
                a.prototype.Drop = function() {
                    for (; this.m_groupList;) this.DestroyParticleGroup(this.m_groupList);
                    this.FreeUserOverridableBuffer(this.m_handleIndexBuffer);
                    this.FreeUserOverridableBuffer(this.m_flagsBuffer);
                    this.FreeUserOverridableBuffer(this.m_lastBodyContactStepBuffer);
                    this.FreeUserOverridableBuffer(this.m_bodyContactCountBuffer);
                    this.FreeUserOverridableBuffer(this.m_consecutiveContactStepsBuffer);
                    this.FreeUserOverridableBuffer(this.m_positionBuffer);
                    this.FreeUserOverridableBuffer(this.m_velocityBuffer);
                    this.FreeUserOverridableBuffer(this.m_colorBuffer);
                    this.FreeUserOverridableBuffer(this.m_userDataBuffer);
                    this.FreeUserOverridableBuffer(this.m_expirationTimeBuffer);
                    this.FreeUserOverridableBuffer(this.m_indexByExpirationTimeBuffer);
                    this.FreeBuffer(this.m_forceBuffer, this.m_internalAllocatedCapacity);
                    this.FreeBuffer(this.m_weightBuffer, this.m_internalAllocatedCapacity);
                    this.FreeBuffer(this.m_staticPressureBuffer, this.m_internalAllocatedCapacity);
                    this.FreeBuffer(this.m_accumulationBuffer, this.m_internalAllocatedCapacity);
                    this.FreeBuffer(this.m_accumulation2Buffer, this.m_internalAllocatedCapacity);
                    this.FreeBuffer(this.m_depthBuffer, this.m_internalAllocatedCapacity);
                    this.FreeBuffer(this.m_groupBuffer, this.m_internalAllocatedCapacity)
                };
                a.prototype.CreateParticle = function(a) {
                    if (this.m_world.IsLocked()) throw Error();
                    this.m_count >= this.m_internalAllocatedCapacity && this.ReallocateInternalAllocatedBuffers(this.m_count ? 2 * this.m_count : 256);
                    if (this.m_count >=
                        this.m_internalAllocatedCapacity) {
                        if (!this.m_def.destroyByAge) return -1;
                        this.DestroyOldestParticle(0, !1);
                        this.SolveZombie()
                    }
                    var b = this.m_count++;
                    if (!this.m_flagsBuffer.data) throw Error();
                    this.m_flagsBuffer.data[b] = 0;
                    this.m_lastBodyContactStepBuffer.data && (this.m_lastBodyContactStepBuffer.data[b] = 0);
                    this.m_bodyContactCountBuffer.data && (this.m_bodyContactCountBuffer.data[b] = 0);
                    this.m_consecutiveContactStepsBuffer.data && (this.m_consecutiveContactStepsBuffer.data[b] = 0);
                    if (!this.m_positionBuffer.data) throw Error();
                    if (!this.m_velocityBuffer.data) throw Error();
                    this.m_positionBuffer.data[b] = (this.m_positionBuffer.data[b] || new r).Copy(e(a.position, r.ZERO));
                    this.m_velocityBuffer.data[b] = (this.m_velocityBuffer.data[b] || new r).Copy(e(a.velocity, r.ZERO));
                    this.m_weightBuffer[b] = 0;
                    this.m_forceBuffer[b] = (this.m_forceBuffer[b] || new r).SetZero();
                    this.m_staticPressureBuffer && (this.m_staticPressureBuffer[b] = 0);
                    this.m_depthBuffer && (this.m_depthBuffer[b] = 0);
                    var c = (new oa).Copy(e(a.color, oa.ZERO));
                    if (this.m_colorBuffer.data ||
                        !c.IsZero()) this.m_colorBuffer.data = this.RequestBuffer(this.m_colorBuffer.data), this.m_colorBuffer.data[b] = (this.m_colorBuffer.data[b] || new oa).Copy(c);
                    if (this.m_userDataBuffer.data || a.userData) this.m_userDataBuffer.data = this.RequestBuffer(this.m_userDataBuffer.data), this.m_userDataBuffer.data[b] = a.userData;
                    this.m_handleIndexBuffer.data && (this.m_handleIndexBuffer.data[b] = null);
                    c = this.m_proxyBuffer.data[this.m_proxyBuffer.Append()];
                    var d = e(a.lifetime, 0),
                        f = 0 < d;
                    if (this.m_expirationTimeBuffer.data || f) {
                        this.SetParticleLifetime(b,
                            f ? d : this.ExpirationTimeToLifetime(-this.GetQuantizedTimeElapsed()));
                        if (!this.m_indexByExpirationTimeBuffer.data) throw Error();
                        this.m_indexByExpirationTimeBuffer.data[b] = b
                    }
                    c.index = b;
                    c = e(a.group, null);
                    if (this.m_groupBuffer[b] = c) c.m_firstIndex < c.m_lastIndex ? this.RotateBuffer(c.m_firstIndex, c.m_lastIndex, b) : c.m_firstIndex = b, c.m_lastIndex = b + 1;
                    this.SetParticleFlags(b, e(a.flags, 0));
                    return b
                };
                a.prototype.GetParticleHandleFromIndex = function(a) {
                    this.m_handleIndexBuffer.data = this.RequestBuffer(this.m_handleIndexBuffer.data);
                    var b = this.m_handleIndexBuffer.data[a];
                    if (b) return b;
                    b = new qc;
                    b.SetIndex(a);
                    return this.m_handleIndexBuffer.data[a] = b
                };
                a.prototype.DestroyParticle = function(a, b) {
                    void 0 === b && (b = !1);
                    if (!this.m_flagsBuffer.data) throw Error();
                    var c = f.b2ParticleFlag.b2_zombieParticle;
                    b && (c |= f.b2ParticleFlag.b2_destructionListenerParticle);
                    this.SetParticleFlags(a, this.m_flagsBuffer.data[a] | c)
                };
                a.prototype.DestroyOldestParticle = function(a, b) {
                    void 0 === b && (b = !1);
                    var c = this.GetParticleCount();
                    if (!this.m_indexByExpirationTimeBuffer.data) throw Error();
                    if (!this.m_expirationTimeBuffer.data) throw Error();
                    c = this.m_indexByExpirationTimeBuffer.data[c - (a + 1)];
                    a = this.m_indexByExpirationTimeBuffer.data[a];
                    this.DestroyParticle(0 < this.m_expirationTimeBuffer.data[c] ? c : a, b)
                };
                a.prototype.DestroyParticlesInShape = function(b, c, d) {
                    void 0 === d && (d = !1);
                    var e = a.DestroyParticlesInShape_s_aabb;
                    if (this.m_world.IsLocked()) throw Error();
                    d = new a.DestroyParticlesInShapeCallback(this, b, c, d);
                    b.ComputeAABB(e, c, 0);
                    this.m_world.QueryAABB(d, e);
                    return d.Destroyed()
                };
                a.prototype.CreateParticleGroup =
                    function(b) {
                        var c = a.CreateParticleGroup_s_transform;
                        if (this.m_world.IsLocked()) throw Error();
                        c.SetPositionAngle(e(b.position, r.ZERO), e(b.angle, 0));
                        var d = this.m_count;
                        b.shape && this.CreateParticlesWithShapeForGroup(b.shape, b, c);
                        b.shapes && this.CreateParticlesWithShapesForGroup(b.shapes, e(b.shapeCount, b.shapes.length), b, c);
                        if (b.positionData)
                            for (var f = e(b.particleCount, b.positionData.length), g = 0; g < f; g++) this.CreateParticleForGroup(b, c, b.positionData[g]);
                        f = this.m_count;
                        var h = new sc(this);
                        h.m_firstIndex =
                            d;
                        h.m_lastIndex = f;
                        h.m_strength = e(b.strength, 1);
                        h.m_userData = b.userData;
                        h.m_transform.Copy(c);
                        h.m_prev = null;
                        (h.m_next = this.m_groupList) && (this.m_groupList.m_prev = h);
                        this.m_groupList = h;
                        ++this.m_groupCount;
                        for (g = d; g < f; g++) this.m_groupBuffer[g] = h;
                        this.SetGroupFlags(h, e(b.groupFlags, 0));
                        c = new a.ConnectionFilter;
                        this.UpdateContacts(!0);
                        this.UpdatePairsAndTriads(d, f, c);
                        b.group && (this.JoinParticleGroups(b.group, h), h = b.group);
                        return h
                    };
                a.prototype.JoinParticleGroups = function(b, c) {
                    if (this.m_world.IsLocked()) throw Error();
                    this.RotateBuffer(c.m_firstIndex, c.m_lastIndex, this.m_count);
                    this.RotateBuffer(b.m_firstIndex, b.m_lastIndex, c.m_firstIndex);
                    var d = new a.JoinParticleGroupsFilter(c.m_firstIndex);
                    this.UpdateContacts(!0);
                    this.UpdatePairsAndTriads(b.m_firstIndex, c.m_lastIndex, d);
                    for (d = c.m_firstIndex; d < c.m_lastIndex; d++) this.m_groupBuffer[d] = b;
                    this.SetGroupFlags(b, b.m_groupFlags | c.m_groupFlags);
                    b.m_lastIndex = c.m_lastIndex;
                    c.m_firstIndex = c.m_lastIndex;
                    this.DestroyParticleGroup(c)
                };
                a.prototype.SplitParticleGroup = function(c) {
                    this.UpdateContacts(!0);
                    var d = c.GetParticleCount();
                    d = b(d, function(b) {
                        return new a.ParticleListNode
                    });
                    a.InitializeParticleLists(c, d);
                    this.MergeParticleListsInContact(c, d);
                    var e = a.FindLongestParticleList(c, d);
                    this.MergeZombieParticleListNodes(c, d, e);
                    this.CreateParticleGroupsFromParticleList(c, d, e);
                    this.UpdatePairsAndTriadsWithParticleList(c, d)
                };
                a.prototype.GetParticleGroupList = function() {
                    return this.m_groupList
                };
                a.prototype.GetParticleGroupCount = function() {
                    return this.m_groupCount
                };
                a.prototype.GetParticleCount = function() {
                    return this.m_count
                };
                a.prototype.GetMaxParticleCount = function() {
                    return this.m_def.maxCount
                };
                a.prototype.SetMaxParticleCount = function(a) {
                    this.m_def.maxCount = a
                };
                a.prototype.GetAllParticleFlags = function() {
                    return this.m_allParticleFlags
                };
                a.prototype.GetAllGroupFlags = function() {
                    return this.m_allGroupFlags
                };
                a.prototype.SetPaused = function(a) {
                    this.m_paused = a
                };
                a.prototype.GetPaused = function() {
                    return this.m_paused
                };
                a.prototype.SetDensity = function(a) {
                    this.m_def.density = a;
                    this.m_inverseDensity = 1 / this.m_def.density
                };
                a.prototype.GetDensity =
                    function() {
                        return this.m_def.density
                    };
                a.prototype.SetGravityScale = function(a) {
                    this.m_def.gravityScale = a
                };
                a.prototype.GetGravityScale = function() {
                    return this.m_def.gravityScale
                };
                a.prototype.SetDamping = function(a) {
                    this.m_def.dampingStrength = a
                };
                a.prototype.GetDamping = function() {
                    return this.m_def.dampingStrength
                };
                a.prototype.SetStaticPressureIterations = function(a) {
                    this.m_def.staticPressureIterations = a
                };
                a.prototype.GetStaticPressureIterations = function() {
                    return this.m_def.staticPressureIterations
                };
                a.prototype.SetRadius =
                    function(a) {
                        this.m_particleDiameter = 2 * a;
                        this.m_squaredDiameter = this.m_particleDiameter * this.m_particleDiameter;
                        this.m_inverseDiameter = 1 / this.m_particleDiameter
                    };
                a.prototype.GetRadius = function() {
                    return this.m_particleDiameter / 2
                };
                a.prototype.GetPositionBuffer = function() {
                    if (!this.m_positionBuffer.data) throw Error();
                    return this.m_positionBuffer.data
                };
                a.prototype.GetVelocityBuffer = function() {
                    if (!this.m_velocityBuffer.data) throw Error();
                    return this.m_velocityBuffer.data
                };
                a.prototype.GetColorBuffer = function() {
                    this.m_colorBuffer.data =
                        this.RequestBuffer(this.m_colorBuffer.data);
                    return this.m_colorBuffer.data
                };
                a.prototype.GetGroupBuffer = function() {
                    return this.m_groupBuffer
                };
                a.prototype.GetWeightBuffer = function() {
                    return this.m_weightBuffer
                };
                a.prototype.GetUserDataBuffer = function() {
                    this.m_userDataBuffer.data = this.RequestBuffer(this.m_userDataBuffer.data);
                    return this.m_userDataBuffer.data
                };
                a.prototype.GetFlagsBuffer = function() {
                    if (!this.m_flagsBuffer.data) throw Error();
                    return this.m_flagsBuffer.data
                };
                a.prototype.SetParticleFlags = function(a,
                    b) {
                    if (!this.m_flagsBuffer.data) throw Error();
                    this.m_flagsBuffer.data[a] & ~b && (this.m_needsUpdateAllParticleFlags = !0);
                    ~this.m_allParticleFlags & b && (b & f.b2ParticleFlag.b2_tensileParticle && (this.m_accumulation2Buffer = this.RequestBuffer(this.m_accumulation2Buffer)), b & f.b2ParticleFlag.b2_colorMixingParticle && (this.m_colorBuffer.data = this.RequestBuffer(this.m_colorBuffer.data)), this.m_allParticleFlags |= b);
                    this.m_flagsBuffer.data[a] = b
                };
                a.prototype.GetParticleFlags = function(a) {
                    if (!this.m_flagsBuffer.data) throw Error();
                    return this.m_flagsBuffer.data[a]
                };
                a.prototype.SetFlagsBuffer = function(a, b) {
                    this.SetUserOverridableBuffer(this.m_flagsBuffer, a, b)
                };
                a.prototype.SetPositionBuffer = function(a, b) {
                    this.SetUserOverridableBuffer(this.m_positionBuffer, a, b)
                };
                a.prototype.SetVelocityBuffer = function(a, b) {
                    this.SetUserOverridableBuffer(this.m_velocityBuffer, a, b)
                };
                a.prototype.SetColorBuffer = function(a, b) {
                    this.SetUserOverridableBuffer(this.m_colorBuffer, a, b)
                };
                a.prototype.SetUserDataBuffer = function(a, b) {
                    this.SetUserOverridableBuffer(this.m_userDataBuffer,
                        a, b)
                };
                a.prototype.GetContacts = function() {
                    return this.m_contactBuffer.data
                };
                a.prototype.GetContactCount = function() {
                    return this.m_contactBuffer.count
                };
                a.prototype.GetBodyContacts = function() {
                    return this.m_bodyContactBuffer.data
                };
                a.prototype.GetBodyContactCount = function() {
                    return this.m_bodyContactBuffer.count
                };
                a.prototype.GetPairs = function() {
                    return this.m_pairBuffer.data
                };
                a.prototype.GetPairCount = function() {
                    return this.m_pairBuffer.count
                };
                a.prototype.GetTriads = function() {
                    return this.m_triadBuffer.data
                };
                a.prototype.GetTriadCount = function() {
                    return this.m_triadBuffer.count
                };
                a.prototype.SetStuckThreshold = function(a) {
                    this.m_stuckThreshold = a;
                    0 < a && (this.m_lastBodyContactStepBuffer.data = this.RequestBuffer(this.m_lastBodyContactStepBuffer.data), this.m_bodyContactCountBuffer.data = this.RequestBuffer(this.m_bodyContactCountBuffer.data), this.m_consecutiveContactStepsBuffer.data = this.RequestBuffer(this.m_consecutiveContactStepsBuffer.data))
                };
                a.prototype.GetStuckCandidates = function() {
                    return this.m_stuckParticleBuffer.Data()
                };
                a.prototype.GetStuckCandidateCount = function() {
                    return this.m_stuckParticleBuffer.GetCount()
                };
                a.prototype.ComputeCollisionEnergy = function() {
                    if (!this.m_velocityBuffer.data) throw Error();
                    for (var b = a.ComputeCollisionEnergy_s_v, c = this.m_velocityBuffer.data, d = 0, e = 0; e < this.m_contactBuffer.count; e++) {
                        var f = this.m_contactBuffer.data[e],
                            g = f.normal;
                        f = r.SubVV(c[f.indexB], c[f.indexA], b);
                        g = r.DotVV(f, g);
                        0 > g && (d += g * g)
                    }
                    return .5 * this.GetParticleMass() * d
                };
                a.prototype.SetStrictContactCheck = function(a) {
                    this.m_def.strictContactCheck =
                        a
                };
                a.prototype.GetStrictContactCheck = function() {
                    return this.m_def.strictContactCheck
                };
                a.prototype.SetParticleLifetime = function(a, b) {
                    var c = null === this.m_indexByExpirationTimeBuffer.data;
                    this.m_expirationTimeBuffer.data = this.RequestBuffer(this.m_expirationTimeBuffer.data);
                    this.m_indexByExpirationTimeBuffer.data = this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data);
                    if (c) {
                        c = this.GetParticleCount();
                        for (var d = 0; d < c; ++d) this.m_indexByExpirationTimeBuffer.data[d] = d
                    }
                    b /= this.m_def.lifetimeGranularity;
                    b = 0 < b ? this.GetQuantizedTimeElapsed() + b : b;
                    b !== this.m_expirationTimeBuffer.data[a] && (this.m_expirationTimeBuffer.data[a] = b, this.m_expirationTimeBufferRequiresSorting = !0)
                };
                a.prototype.GetParticleLifetime = function(a) {
                    return this.ExpirationTimeToLifetime(this.GetExpirationTimeBuffer()[a])
                };
                a.prototype.SetDestructionByAge = function(a) {
                    a && this.GetExpirationTimeBuffer();
                    this.m_def.destroyByAge = a
                };
                a.prototype.GetDestructionByAge = function() {
                    return this.m_def.destroyByAge
                };
                a.prototype.GetExpirationTimeBuffer =
                    function() {
                        this.m_expirationTimeBuffer.data = this.RequestBuffer(this.m_expirationTimeBuffer.data);
                        return this.m_expirationTimeBuffer.data
                    };
                a.prototype.ExpirationTimeToLifetime = function(a) {
                    return (0 < a ? a - this.GetQuantizedTimeElapsed() : a) * this.m_def.lifetimeGranularity
                };
                a.prototype.GetIndexByExpirationTimeBuffer = function() {
                    this.GetParticleCount() ? this.SetParticleLifetime(0, this.GetParticleLifetime(0)) : this.m_indexByExpirationTimeBuffer.data = this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data);
                    if (!this.m_indexByExpirationTimeBuffer.data) throw Error();
                    return this.m_indexByExpirationTimeBuffer.data
                };
                a.prototype.ParticleApplyLinearImpulse = function(a, b) {
                    this.ApplyLinearImpulse(a, a + 1, b)
                };
                a.prototype.ApplyLinearImpulse = function(a, b, c) {
                    if (!this.m_velocityBuffer.data) throw Error();
                    var d = this.m_velocityBuffer.data,
                        e = (b - a) * this.GetParticleMass();
                    for (c = (new r).Copy(c).SelfMul(1 / e); a < b; a++) d[a].SelfAdd(c)
                };
                a.IsSignificantForce = function(a) {
                    return 0 !== a.x || 0 !== a.y
                };
                a.prototype.ParticleApplyForce = function(b, c) {
                    if (!this.m_flagsBuffer.data) throw Error();
                    a.IsSignificantForce(c) &&
                        this.ForceCanBeApplied(this.m_flagsBuffer.data[b]) && (this.PrepareForceBuffer(), this.m_forceBuffer[b].SelfAdd(c))
                };
                a.prototype.ApplyForce = function(b, c, d) {
                    d = (new r).Copy(d).SelfMul(1 / (c - b));
                    if (a.IsSignificantForce(d))
                        for (this.PrepareForceBuffer(); b < c; b++) this.m_forceBuffer[b].SelfAdd(d)
                };
                a.prototype.GetNext = function() {
                    return this.m_next
                };
                a.prototype.QueryAABB = function(b, c) {
                    if (0 !== this.m_proxyBuffer.count) {
                        var d = this.m_proxyBuffer.count,
                            e = M(this.m_proxyBuffer.data, 0, d, a.computeTag(this.m_inverseDiameter *
                                c.lowerBound.x, this.m_inverseDiameter * c.lowerBound.y), a.Proxy.CompareProxyTag);
                        d = O(this.m_proxyBuffer.data, e, d, a.computeTag(this.m_inverseDiameter * c.upperBound.x, this.m_inverseDiameter * c.upperBound.y), a.Proxy.CompareTagProxy);
                        if (!this.m_positionBuffer.data) throw Error();
                        for (var f = this.m_positionBuffer.data; e < d; ++e) {
                            var g = this.m_proxyBuffer.data[e].index,
                                h = f[g];
                            if (c.lowerBound.x < h.x && h.x < c.upperBound.x && c.lowerBound.y < h.y && h.y < c.upperBound.y && !b.ReportParticle(this, g)) break
                        }
                    }
                };
                a.prototype.QueryShapeAABB =
                    function(b, c, d, e) {
                        void 0 === e && (e = 0);
                        var f = a.QueryShapeAABB_s_aabb;
                        c.ComputeAABB(f, d, e);
                        this.QueryAABB(b, f)
                    };
                a.prototype.QueryPointAABB = function(b, c, d) {
                    void 0 === d && (d = .008);
                    var e = a.QueryPointAABB_s_aabb;
                    e.lowerBound.Set(c.x - d, c.y - d);
                    e.upperBound.Set(c.x + d, c.y + d);
                    this.QueryAABB(b, e)
                };
                a.prototype.RayCast = function(b, c, d) {
                    var e = a.RayCast_s_aabb,
                        f = a.RayCast_s_p,
                        g = a.RayCast_s_v,
                        h = a.RayCast_s_n,
                        k = a.RayCast_s_point;
                    if (0 !== this.m_proxyBuffer.count) {
                        if (!this.m_positionBuffer.data) throw Error();
                        var l = this.m_positionBuffer.data;
                        r.MinV(c, d, e.lowerBound);
                        r.MaxV(c, d, e.upperBound);
                        var m = 1;
                        d = r.SubVV(d, c, g);
                        g = r.DotVV(d, d);
                        e = this.GetInsideBoundsEnumerator(e);
                        for (var n; 0 <= (n = e.GetNext());) {
                            var p = r.SubVV(c, l[n], f),
                                q = r.DotVV(p, d),
                                D = r.DotVV(p, p);
                            D = q * q - g * (D - this.m_squaredDiameter);
                            if (0 <= D) {
                                var t = ha(D);
                                D = (-q - t) / g;
                                if (!(D > m)) {
                                    if (0 > D && (D = (-q + t) / g, 0 > D || D > m)) continue;
                                    p = r.AddVMulSV(p, D, d, h);
                                    p.Normalize();
                                    n = b.ReportParticle(this, n, r.AddVMulSV(c, D, d, k), p, D);
                                    m = W(m, n);
                                    if (0 >= m) break
                                }
                            }
                        }
                    }
                };
                a.prototype.ComputeAABB = function(a) {
                    var b = this.GetParticleCount();
                    a.lowerBound.x = 1E37;
                    a.lowerBound.y = 1E37;
                    a.upperBound.x = -1E37;
                    a.upperBound.y = -1E37;
                    if (!this.m_positionBuffer.data) throw Error();
                    for (var c = this.m_positionBuffer.data, d = 0; d < b; d++) {
                        var e = c[d];
                        r.MinV(a.lowerBound, e, a.lowerBound);
                        r.MaxV(a.upperBound, e, a.upperBound)
                    }
                    a.lowerBound.x -= this.m_particleDiameter;
                    a.lowerBound.y -= this.m_particleDiameter;
                    a.upperBound.x += this.m_particleDiameter;
                    a.upperBound.y += this.m_particleDiameter
                };
                a.prototype.FreeBuffer = function(a, b) {
                    null !== a && (a.length = 0)
                };
                a.prototype.FreeUserOverridableBuffer =
                    function(a) {
                        0 === a.userSuppliedCapacity && this.FreeBuffer(a.data, this.m_internalAllocatedCapacity)
                    };
                a.prototype.ReallocateBuffer3 = function(a, b, c) {
                    if (c <= b) throw Error();
                    a = a ? a.slice() : [];
                    a.length = c;
                    return a
                };
                a.prototype.ReallocateBuffer5 = function(a, b, c, d, e) {
                    if (d <= c) throw Error();
                    if (b && !(d <= b)) throw Error();
                    e && !a || b || (a = this.ReallocateBuffer3(a, c, d));
                    return a
                };
                a.prototype.ReallocateBuffer4 = function(a, b, c, d) {
                    return this.ReallocateBuffer5(a.data, a.userSuppliedCapacity, b, c, d)
                };
                a.prototype.RequestBuffer = function(a) {
                    a ||
                        (0 === this.m_internalAllocatedCapacity && this.ReallocateInternalAllocatedBuffers(256), a = [], a.length = this.m_internalAllocatedCapacity);
                    return a
                };
                a.prototype.ReallocateHandleBuffers = function(a) {
                    this.m_handleIndexBuffer.data = this.ReallocateBuffer4(this.m_handleIndexBuffer, this.m_internalAllocatedCapacity, a, !0)
                };
                a.prototype.ReallocateInternalAllocatedBuffers = function(a) {
                    function b(a, b) {
                        return b && a > b ? b : a
                    }
                    a = b(a, this.m_def.maxCount);
                    a = b(a, this.m_flagsBuffer.userSuppliedCapacity);
                    a = b(a, this.m_positionBuffer.userSuppliedCapacity);
                    a = b(a, this.m_velocityBuffer.userSuppliedCapacity);
                    a = b(a, this.m_colorBuffer.userSuppliedCapacity);
                    a = b(a, this.m_userDataBuffer.userSuppliedCapacity);
                    if (this.m_internalAllocatedCapacity < a) {
                        this.ReallocateHandleBuffers(a);
                        this.m_flagsBuffer.data = this.ReallocateBuffer4(this.m_flagsBuffer, this.m_internalAllocatedCapacity, a, !1);
                        var c = 0 < this.m_stuckThreshold;
                        this.m_lastBodyContactStepBuffer.data = this.ReallocateBuffer4(this.m_lastBodyContactStepBuffer, this.m_internalAllocatedCapacity, a, c);
                        this.m_bodyContactCountBuffer.data =
                            this.ReallocateBuffer4(this.m_bodyContactCountBuffer, this.m_internalAllocatedCapacity, a, c);
                        this.m_consecutiveContactStepsBuffer.data = this.ReallocateBuffer4(this.m_consecutiveContactStepsBuffer, this.m_internalAllocatedCapacity, a, c);
                        this.m_positionBuffer.data = this.ReallocateBuffer4(this.m_positionBuffer, this.m_internalAllocatedCapacity, a, !1);
                        this.m_velocityBuffer.data = this.ReallocateBuffer4(this.m_velocityBuffer, this.m_internalAllocatedCapacity, a, !1);
                        this.m_forceBuffer = this.ReallocateBuffer5(this.m_forceBuffer,
                            0, this.m_internalAllocatedCapacity, a, !1);
                        this.m_weightBuffer = this.ReallocateBuffer5(this.m_weightBuffer, 0, this.m_internalAllocatedCapacity, a, !1);
                        this.m_staticPressureBuffer = this.ReallocateBuffer5(this.m_staticPressureBuffer, 0, this.m_internalAllocatedCapacity, a, !0);
                        this.m_accumulationBuffer = this.ReallocateBuffer5(this.m_accumulationBuffer, 0, this.m_internalAllocatedCapacity, a, !1);
                        this.m_accumulation2Buffer = this.ReallocateBuffer5(this.m_accumulation2Buffer, 0, this.m_internalAllocatedCapacity, a, !0);
                        this.m_depthBuffer =
                            this.ReallocateBuffer5(this.m_depthBuffer, 0, this.m_internalAllocatedCapacity, a, !0);
                        this.m_colorBuffer.data = this.ReallocateBuffer4(this.m_colorBuffer, this.m_internalAllocatedCapacity, a, !0);
                        this.m_groupBuffer = this.ReallocateBuffer5(this.m_groupBuffer, 0, this.m_internalAllocatedCapacity, a, !1);
                        this.m_userDataBuffer.data = this.ReallocateBuffer4(this.m_userDataBuffer, this.m_internalAllocatedCapacity, a, !0);
                        this.m_expirationTimeBuffer.data = this.ReallocateBuffer4(this.m_expirationTimeBuffer, this.m_internalAllocatedCapacity,
                            a, !0);
                        this.m_indexByExpirationTimeBuffer.data = this.ReallocateBuffer4(this.m_indexByExpirationTimeBuffer, this.m_internalAllocatedCapacity, a, !1);
                        this.m_internalAllocatedCapacity = a
                    }
                };
                a.prototype.CreateParticleForGroup = function(a, b, c) {
                    var d = new zb;
                    d.flags = e(a.flags, 0);
                    T.MulXV(b, c, d.position);
                    r.AddVV(e(a.linearVelocity, r.ZERO), r.CrossSV(e(a.angularVelocity, 0), r.SubVV(d.position, e(a.position, r.ZERO), r.s_t0), r.s_t0), d.velocity);
                    d.color.Copy(e(a.color, oa.ZERO));
                    d.lifetime = e(a.lifetime, 0);
                    d.userData = a.userData;
                    this.CreateParticle(d)
                };
                a.prototype.CreateParticlesStrokeShapeForGroup = function(b, c, d) {
                    var g = a.CreateParticlesStrokeShapeForGroup_s_edge,
                        h = a.CreateParticlesStrokeShapeForGroup_s_d,
                        k = a.CreateParticlesStrokeShapeForGroup_s_p,
                        l = e(c.stride, 0);
                    0 === l && (l = this.GetParticleStride());
                    for (var m = 0, n = b.GetChildCount(), p = 0; p < n; p++) {
                        if (b.GetType() === f.b2ShapeType.e_edgeShape) var q = b;
                        else q = g, b.GetChildEdge(q, p);
                        for (var D = r.SubVV(q.m_vertex2, q.m_vertex1, h), t = D.Length(); m < t;) {
                            var J = r.AddVMulSV(q.m_vertex1, m / t, D, k);
                            this.CreateParticleForGroup(c, d, J);
                            m += l
                        }
                        m -= t
                    }
                };
                a.prototype.CreateParticlesFillShapeForGroup = function(b, c, d) {
                    var f = a.CreateParticlesFillShapeForGroup_s_aabb,
                        g = a.CreateParticlesFillShapeForGroup_s_p,
                        h = e(c.stride, 0);
                    0 === h && (h = this.GetParticleStride());
                    var k = T.IDENTITY;
                    b.ComputeAABB(f, k, 0);
                    for (var l = Math.floor(f.lowerBound.y / h) * h; l < f.upperBound.y; l += h)
                        for (var m = Math.floor(f.lowerBound.x / h) * h; m < f.upperBound.x; m += h) {
                            var n = g.Set(m, l);
                            b.TestPoint(k, n) && this.CreateParticleForGroup(c, d, n)
                        }
                };
                a.prototype.CreateParticlesWithShapeForGroup =
                    function(a, b, c) {
                        switch (a.GetType()) {
                            case f.b2ShapeType.e_edgeShape:
                            case f.b2ShapeType.e_chainShape:
                                this.CreateParticlesStrokeShapeForGroup(a, b, c);
                                break;
                            case f.b2ShapeType.e_polygonShape:
                            case f.b2ShapeType.e_circleShape:
                                this.CreateParticlesFillShapeForGroup(a, b, c)
                        }
                    };
                a.prototype.CreateParticlesWithShapesForGroup = function(b, c, d, e) {
                    b = new a.CompositeShape(b, c);
                    this.CreateParticlesFillShapeForGroup(b, d, e)
                };
                a.prototype.CloneParticle = function(a, b) {
                    var c = new zb;
                    if (!this.m_flagsBuffer.data) throw Error();
                    if (!this.m_positionBuffer.data) throw Error();
                    if (!this.m_velocityBuffer.data) throw Error();
                    c.flags = this.m_flagsBuffer.data[a];
                    c.position.Copy(this.m_positionBuffer.data[a]);
                    c.velocity.Copy(this.m_velocityBuffer.data[a]);
                    this.m_colorBuffer.data && c.color.Copy(this.m_colorBuffer.data[a]);
                    this.m_userDataBuffer.data && (c.userData = this.m_userDataBuffer.data[a]);
                    c.group = b;
                    b = this.CreateParticle(c);
                    this.m_handleIndexBuffer.data && ((c = this.m_handleIndexBuffer.data[a]) && c.SetIndex(b), this.m_handleIndexBuffer.data[b] = c, this.m_handleIndexBuffer.data[a] = null);
                    this.m_lastBodyContactStepBuffer.data && (this.m_lastBodyContactStepBuffer.data[b] = this.m_lastBodyContactStepBuffer.data[a]);
                    this.m_bodyContactCountBuffer.data && (this.m_bodyContactCountBuffer.data[b] = this.m_bodyContactCountBuffer.data[a]);
                    this.m_consecutiveContactStepsBuffer.data && (this.m_consecutiveContactStepsBuffer.data[b] = this.m_consecutiveContactStepsBuffer.data[a]);
                    this.m_hasForce && this.m_forceBuffer[b].Copy(this.m_forceBuffer[a]);
                    this.m_staticPressureBuffer && (this.m_staticPressureBuffer[b] = this.m_staticPressureBuffer[a]);
                    this.m_depthBuffer && (this.m_depthBuffer[b] = this.m_depthBuffer[a]);
                    this.m_expirationTimeBuffer.data && (this.m_expirationTimeBuffer.data[b] = this.m_expirationTimeBuffer.data[a]);
                    return b
                };
                a.prototype.DestroyParticlesInGroup = function(a, b) {
                    void 0 === b && (b = !1);
                    for (var c = a.m_firstIndex; c < a.m_lastIndex; c++) this.DestroyParticle(c, b)
                };
                a.prototype.DestroyParticleGroup = function(a) {
                    this.m_world.m_destructionListener && this.m_world.m_destructionListener.SayGoodbyeParticleGroup(a);
                    this.SetGroupFlags(a, 0);
                    for (var b =
                            a.m_firstIndex; b < a.m_lastIndex; b++) this.m_groupBuffer[b] = null;
                    a.m_prev && (a.m_prev.m_next = a.m_next);
                    a.m_next && (a.m_next.m_prev = a.m_prev);
                    a === this.m_groupList && (this.m_groupList = a.m_next);
                    --this.m_groupCount
                };
                a.ParticleCanBeConnected = function(a, b) {
                    return 0 !== (a & (f.b2ParticleFlag.b2_wallParticle | f.b2ParticleFlag.b2_springParticle | f.b2ParticleFlag.b2_elasticParticle)) || null !== b && 0 !== (b.GetGroupFlags() & f.b2ParticleGroupFlag.b2_rigidParticleGroup)
                };
                a.prototype.UpdatePairsAndTriads = function(b, c, d) {
                    var e =
                        a.UpdatePairsAndTriads_s_dab,
                        g = a.UpdatePairsAndTriads_s_dbc,
                        h = a.UpdatePairsAndTriads_s_dca;
                    if (!this.m_flagsBuffer.data) throw Error();
                    if (!this.m_positionBuffer.data) throw Error();
                    if (!this.m_velocityBuffer.data) throw Error();
                    for (var k = this.m_positionBuffer.data, l = 0, m = b; m < c; m++) l |= this.m_flagsBuffer.data[m];
                    if (l & a.k_pairFlags)
                        for (m = 0; m < this.m_contactBuffer.count; m++) {
                            var n = this.m_contactBuffer.data[m],
                                p = n.indexA,
                                q = n.indexB,
                                D = this.m_flagsBuffer.data[p],
                                t = this.m_flagsBuffer.data[q],
                                J = this.m_groupBuffer[p],
                                u = this.m_groupBuffer[q];
                            p >= b && p < c && q >= b && q < c && !((D | t) & f.b2ParticleFlag.b2_zombieParticle) && (D | t) & a.k_pairFlags && (d.IsNecessary(p) || d.IsNecessary(q)) && a.ParticleCanBeConnected(D, J) && a.ParticleCanBeConnected(t, u) && d.ShouldCreatePair(p, q) && (D = this.m_pairBuffer.data[this.m_pairBuffer.Append()], D.indexA = p, D.indexB = q, D.flags = n.flags, D.strength = W(J ? J.m_strength : 1, u ? u.m_strength : 1), D.distance = r.DistanceVV(k[p], k[q]));
                            P(this.m_pairBuffer.data, 0, this.m_pairBuffer.count, a.ComparePairIndices);
                            this.m_pairBuffer.Unique(a.MatchPairIndices)
                        }
                    if (l &
                        a.k_triadFlags) {
                        l = new Ab(c - b);
                        for (m = b; m < c; m++) b = this.m_flagsBuffer.data[m], n = this.m_groupBuffer[m], b & f.b2ParticleFlag.b2_zombieParticle || !a.ParticleCanBeConnected(b, n) || l.AddGenerator(k[m], m, d.IsNecessary(m));
                        c = this.GetParticleStride();
                        l.Generate(c / 2, 2 * c);
                        var v = this;
                        l.GetNodes(function(b, c, f) {
                            if (!v.m_flagsBuffer.data) throw Error();
                            var l = v.m_flagsBuffer.data[b],
                                m = v.m_flagsBuffer.data[c],
                                n = v.m_flagsBuffer.data[f];
                            if ((l | m | n) & a.k_triadFlags && d.ShouldCreateTriad(b, c, f)) {
                                var p = k[b],
                                    q = k[c],
                                    D = k[f],
                                    t = r.SubVV(p,
                                        q, e),
                                    J = r.SubVV(q, D, g),
                                    u = r.SubVV(D, p, h),
                                    w = 4 * v.m_squaredDiameter;
                                if (!(r.DotVV(t, t) > w || r.DotVV(J, J) > w || r.DotVV(u, u) > w)) {
                                    var x = v.m_groupBuffer[b],
                                        y = v.m_groupBuffer[c],
                                        z = v.m_groupBuffer[f];
                                    w = v.m_triadBuffer.data[v.m_triadBuffer.Append()];
                                    w.indexA = b;
                                    w.indexB = c;
                                    w.indexC = f;
                                    w.flags = l | m | n;
                                    w.strength = W(W(x ? x.m_strength : 1, y ? y.m_strength : 1), z ? z.m_strength : 1);
                                    b = (p.x + q.x + D.x) / 3;
                                    c = (p.y + q.y + D.y) / 3;
                                    w.pa.x = p.x - b;
                                    w.pa.y = p.y - c;
                                    w.pb.x = q.x - b;
                                    w.pb.y = q.y - c;
                                    w.pc.x = D.x - b;
                                    w.pc.y = D.y - c;
                                    w.ka = -r.DotVV(u, t);
                                    w.kb = -r.DotVV(t, J);
                                    w.kc = -r.DotVV(J, u);
                                    w.s = r.CrossVV(p, q) + r.CrossVV(q, D) + r.CrossVV(D, p)
                                }
                            }
                        });
                        P(this.m_triadBuffer.data, 0, this.m_triadBuffer.count, a.CompareTriadIndices);
                        this.m_triadBuffer.Unique(a.MatchTriadIndices)
                    }
                };
                a.prototype.UpdatePairsAndTriadsWithReactiveParticles = function() {
                    var b = new a.ReactiveFilter(this.m_flagsBuffer);
                    this.UpdatePairsAndTriads(0, this.m_count, b);
                    if (!this.m_flagsBuffer.data) throw Error();
                    for (b = 0; b < this.m_count; b++) this.m_flagsBuffer.data[b] &= ~f.b2ParticleFlag.b2_reactiveParticle;
                    this.m_allParticleFlags &=
                        ~f.b2ParticleFlag.b2_reactiveParticle
                };
                a.ComparePairIndices = function(a, b) {
                    var c = a.indexA - b.indexA;
                    return 0 !== c ? 0 > c : a.indexB < b.indexB
                };
                a.MatchPairIndices = function(a, b) {
                    return a.indexA === b.indexA && a.indexB === b.indexB
                };
                a.CompareTriadIndices = function(a, b) {
                    var c = a.indexA - b.indexA;
                    if (0 !== c) return 0 > c;
                    c = a.indexB - b.indexB;
                    return 0 !== c ? 0 > c : a.indexC < b.indexC
                };
                a.MatchTriadIndices = function(a, b) {
                    return a.indexA === b.indexA && a.indexB === b.indexB && a.indexC === b.indexC
                };
                a.InitializeParticleLists = function(a, b) {
                    var c =
                        a.GetBufferIndex();
                    a = a.GetParticleCount();
                    for (var d = 0; d < a; d++) {
                        var e = b[d];
                        e.list = e;
                        e.next = null;
                        e.count = 1;
                        e.index = d + c
                    }
                };
                a.prototype.MergeParticleListsInContact = function(b, c) {
                    for (var d = b.GetBufferIndex(), e = 0; e < this.m_contactBuffer.count; e++) {
                        var f = this.m_contactBuffer.data[e],
                            g = f.indexA;
                        f = f.indexB;
                        if (b.ContainsParticle(g) && b.ContainsParticle(f) && (g = c[g - d].list, f = c[f - d].list, g !== f)) {
                            if (g.count < f.count) {
                                var h = g;
                                g = f;
                                f = h
                            }
                            a.MergeParticleLists(g, f)
                        }
                    }
                };
                a.MergeParticleLists = function(a, b) {
                    for (var c = b;;) {
                        c.list =
                            a;
                        var d = c.next;
                        if (!d) {
                            c.next = a.next;
                            break
                        }
                        c = d
                    }
                    a.next = b;
                    a.count += b.count;
                    b.count = 0
                };
                a.FindLongestParticleList = function(a, b) {
                    a = a.GetParticleCount();
                    for (var c = b[0], d = 0; d < a; d++) {
                        var e = b[d];
                        c.count < e.count && (c = e)
                    }
                    return c
                };
                a.prototype.MergeZombieParticleListNodes = function(b, c, d) {
                    if (!this.m_flagsBuffer.data) throw Error();
                    b = b.GetParticleCount();
                    for (var e = 0; e < b; e++) {
                        var g = c[e];
                        g !== d && this.m_flagsBuffer.data[g.index] & f.b2ParticleFlag.b2_zombieParticle && a.MergeParticleListAndNode(d, g)
                    }
                };
                a.MergeParticleListAndNode =
                    function(a, b) {
                        b.list = a;
                        b.next = a.next;
                        a.next = b;
                        a.count++;
                        b.count = 0
                    };
                a.prototype.CreateParticleGroupsFromParticleList = function(a, b, c) {
                    if (!this.m_flagsBuffer.data) throw Error();
                    var d = a.GetParticleCount(),
                        e = new rc;
                    e.groupFlags = a.GetGroupFlags();
                    e.userData = a.GetUserData();
                    for (a = 0; a < d; a++) {
                        var g = b[a];
                        if (g.count && g !== c)
                            for (var h = this.CreateParticleGroup(e); g; g = g.next) {
                                var k = g.index,
                                    l = this.CloneParticle(k, h);
                                this.m_flagsBuffer.data[k] |= f.b2ParticleFlag.b2_zombieParticle;
                                g.index = l
                            }
                    }
                };
                a.prototype.UpdatePairsAndTriadsWithParticleList =
                    function(a, b) {
                        for (var c, d, e = a.GetBufferIndex(), f = 0; f < this.m_pairBuffer.count; f++) {
                            var g = this.m_pairBuffer.data[f];
                            d = g.indexA;
                            c = g.indexB;
                            a.ContainsParticle(d) && (g.indexA = b[d - e].index);
                            a.ContainsParticle(c) && (g.indexB = b[c - e].index)
                        }
                        for (f = 0; f < this.m_triadBuffer.count; f++) {
                            g = this.m_triadBuffer.data[f];
                            d = g.indexA;
                            c = g.indexB;
                            var h = g.indexC;
                            a.ContainsParticle(d) && (g.indexA = b[d - e].index);
                            a.ContainsParticle(c) && (g.indexB = b[c - e].index);
                            a.ContainsParticle(h) && (g.indexC = b[h - e].index)
                        }
                    };
                a.prototype.ComputeDepth =
                    function() {
                        var a, b = [],
                            c = 0;
                        for (a = 0; a < this.m_contactBuffer.count; a++) {
                            var d = this.m_contactBuffer.data[a];
                            var e = d.indexA;
                            var g = d.indexB;
                            var h = this.m_groupBuffer[e],
                                k = this.m_groupBuffer[g];
                            h && h === k && h.m_groupFlags & f.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth && (b[c++] = d)
                        }
                        h = [];
                        k = 0;
                        for (a = this.m_groupList; a; a = a.GetNext())
                            if (a.m_groupFlags & f.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth)
                                for (h[k++] = a, this.SetGroupFlags(a, a.m_groupFlags & ~f.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth),
                                    g = a.m_firstIndex; g < a.m_lastIndex; g++) this.m_accumulationBuffer[g] = 0;
                        for (a = 0; a < c; a++) {
                            d = b[a];
                            e = d.indexA;
                            g = d.indexB;
                            var l = d.weight;
                            this.m_accumulationBuffer[e] += l;
                            this.m_accumulationBuffer[g] += l
                        }
                        for (g = 0; g < k; g++)
                            for (a = h[g], e = a.m_firstIndex; e < a.m_lastIndex; e++) l = this.m_accumulationBuffer[e], this.m_depthBuffer[e] = .8 > l ? 0 : 1E37;
                        l = ha(this.m_count) >> 0;
                        for (var m = 0; m < l; m++) {
                            var n = !1;
                            for (a = 0; a < c; a++) {
                                d = b[a];
                                e = d.indexA;
                                g = d.indexB;
                                var p = 1 - d.weight;
                                d = this.m_depthBuffer[e];
                                var q = this.m_depthBuffer[g],
                                    r = q + p;
                                p = d + p;
                                d > r && (this.m_depthBuffer[e] = r, n = !0);
                                q > p && (this.m_depthBuffer[g] = p, n = !0)
                            }
                            if (!n) break
                        }
                        for (g = 0; g < k; g++)
                            for (a = h[g], b = a.m_firstIndex; b < a.m_lastIndex; b++) 1E37 > this.m_depthBuffer[b] ? this.m_depthBuffer[b] *= this.m_particleDiameter : this.m_depthBuffer[b] = 0
                    };
                a.prototype.GetInsideBoundsEnumerator = function(b) {
                    var c = a.computeTag(this.m_inverseDiameter * b.lowerBound.x - 1, this.m_inverseDiameter * b.lowerBound.y - 1);
                    b = a.computeTag(this.m_inverseDiameter * b.upperBound.x + 1, this.m_inverseDiameter * b.upperBound.y + 1);
                    var d = this.m_proxyBuffer.count,
                        e = M(this.m_proxyBuffer.data, 0, d, c, a.Proxy.CompareProxyTag);
                    d = O(this.m_proxyBuffer.data, 0, d, b, a.Proxy.CompareTagProxy);
                    return new a.InsideBoundsEnumerator(this, c, b, e, d)
                };
                a.prototype.UpdateAllParticleFlags = function() {
                    if (!this.m_flagsBuffer.data) throw Error();
                    for (var a = this.m_allParticleFlags = 0; a < this.m_count; a++) this.m_allParticleFlags |= this.m_flagsBuffer.data[a];
                    this.m_needsUpdateAllParticleFlags = !1
                };
                a.prototype.UpdateAllGroupFlags = function() {
                    this.m_allGroupFlags = 0;
                    for (var a = this.m_groupList; a; a = a.GetNext()) this.m_allGroupFlags |=
                        a.m_groupFlags;
                    this.m_needsUpdateAllGroupFlags = !1
                };
                a.prototype.AddContact = function(b, c, e) {
                    if (!this.m_flagsBuffer.data) throw Error();
                    if (!this.m_positionBuffer.data) throw Error();
                    e = this.m_positionBuffer.data;
                    e = r.SubVV(e[c], e[b], a.AddContact_s_d);
                    var f = r.DotVV(e, e);
                    if (f < this.m_squaredDiameter) {
                        var g = d(f);
                        isFinite(g) || (g = 1.9817753699999998E19);
                        var h = this.m_contactBuffer.data[this.m_contactBuffer.Append()];
                        h.indexA = b;
                        h.indexB = c;
                        h.flags = this.m_flagsBuffer.data[b] | this.m_flagsBuffer.data[c];
                        h.weight = 1 - f *
                            g * this.m_inverseDiameter;
                        r.MulSV(g, e, h.normal)
                    }
                };
                a.prototype.FindContacts_Reference = function(b) {
                    b = this.m_proxyBuffer.count;
                    for (var c = this.m_contactBuffer.count = 0, d = 0; c < b; c++) {
                        for (var e = a.computeRelativeTag(this.m_proxyBuffer.data[c].tag, 1, 0), f = c + 1; f < b && !(e < this.m_proxyBuffer.data[f].tag); f++) this.AddContact(this.m_proxyBuffer.data[c].index, this.m_proxyBuffer.data[f].index, this.m_contactBuffer);
                        for (f = a.computeRelativeTag(this.m_proxyBuffer.data[c].tag, -1, 1); d < b && !(f <= this.m_proxyBuffer.data[d].tag); d++);
                        e = a.computeRelativeTag(this.m_proxyBuffer.data[c].tag, 1, 1);
                        for (f = d; f < b && !(e < this.m_proxyBuffer.data[f].tag); f++) this.AddContact(this.m_proxyBuffer.data[c].index, this.m_proxyBuffer.data[f].index, this.m_contactBuffer)
                    }
                };
                a.prototype.FindContacts = function(a) {
                    this.FindContacts_Reference(a)
                };
                a.prototype.UpdateProxies_Reference = function(b) {
                    if (!this.m_positionBuffer.data) throw Error();
                    b = this.m_positionBuffer.data;
                    for (var c = this.m_inverseDiameter, d = 0; d < this.m_proxyBuffer.count; ++d) {
                        var e = this.m_proxyBuffer.data[d],
                            f = b[e.index];
                        e.tag = a.computeTag(c * f.x, c * f.y)
                    }
                };
                a.prototype.UpdateProxies = function(a) {
                    this.UpdateProxies_Reference(a)
                };
                a.prototype.SortProxies = function(b) {
                    K(this.m_proxyBuffer.data, 0, this.m_proxyBuffer.count, a.Proxy.CompareProxyProxy)
                };
                a.prototype.FilterContacts = function(a) {
                    var b = this.GetParticleContactFilter();
                    if (null !== b) {
                        var c = this;
                        this.m_contactBuffer.RemoveIf(function(a) {
                            return 0 !== (a.flags & f.b2ParticleFlag.b2_particleContactFilterParticle) && !b.ShouldCollideParticleParticle(c, a.indexA, a.indexB)
                        })
                    }
                };
                a.prototype.NotifyContactListenerPreContact = function(a) {
                    if (null !== this.GetParticleContactListener()) throw a.Initialize(this.m_contactBuffer, this.m_flagsBuffer), Error();
                };
                a.prototype.NotifyContactListenerPostContact = function(a) {
                    a = this.GetParticleContactListener();
                    if (null !== a) {
                        for (var b = 0; b < this.m_contactBuffer.count; ++b) a.BeginContactParticleParticle(this, this.m_contactBuffer.data[b]);
                        throw Error();
                    }
                };
                a.b2ParticleContactIsZombie = function(a) {
                    return (a.flags & f.b2ParticleFlag.b2_zombieParticle) === f.b2ParticleFlag.b2_zombieParticle
                };
                a.prototype.UpdateContacts = function(b) {
                    this.UpdateProxies(this.m_proxyBuffer);
                    this.SortProxies(this.m_proxyBuffer);
                    var c = new a.b2ParticlePairSet;
                    this.NotifyContactListenerPreContact(c);
                    this.FindContacts(this.m_contactBuffer);
                    this.FilterContacts(this.m_contactBuffer);
                    this.NotifyContactListenerPostContact(c);
                    b && this.m_contactBuffer.RemoveIf(a.b2ParticleContactIsZombie)
                };
                a.prototype.NotifyBodyContactListenerPreContact = function(a) {
                    if (null !== this.GetFixtureContactListener()) throw a.Initialize(this.m_bodyContactBuffer,
                        this.m_flagsBuffer), Error();
                };
                a.prototype.NotifyBodyContactListenerPostContact = function(a) {
                    a = this.GetFixtureContactListener();
                    if (null !== a) {
                        for (var b = 0; b < this.m_bodyContactBuffer.count; b++) a.BeginContactFixtureParticle(this, this.m_bodyContactBuffer.data[b]);
                        throw Error();
                    }
                };
                a.prototype.UpdateBodyContacts = function() {
                    var b = a.UpdateBodyContacts_s_aabb,
                        c = new a.FixtureParticleSet;
                    this.NotifyBodyContactListenerPreContact(c);
                    if (0 < this.m_stuckThreshold) {
                        if (!this.m_bodyContactCountBuffer.data) throw Error();
                        if (!this.m_lastBodyContactStepBuffer.data) throw Error();
                        if (!this.m_consecutiveContactStepsBuffer.data) throw Error();
                        for (var d = this.GetParticleCount(), e = 0; e < d; e++) this.m_bodyContactCountBuffer.data[e] = 0, this.m_timestamp > this.m_lastBodyContactStepBuffer.data[e] + 1 && (this.m_consecutiveContactStepsBuffer.data[e] = 0)
                    }
                    this.m_bodyContactBuffer.SetCount(0);
                    this.m_stuckParticleBuffer.SetCount(0);
                    this.ComputeAABB(b);
                    d = new a.UpdateBodyContactsCallback(this, this.GetFixtureContactFilter());
                    this.m_world.QueryAABB(d,
                        b);
                    this.m_def.strictContactCheck && this.RemoveSpuriousBodyContacts();
                    this.NotifyBodyContactListenerPostContact(c)
                };
                a.prototype.Solve = function(b) {
                    var c = a.Solve_s_subStep;
                    if (0 !== this.m_count && (this.m_expirationTimeBuffer.data && this.SolveLifetimes(b), this.m_allParticleFlags & f.b2ParticleFlag.b2_zombieParticle && this.SolveZombie(), this.m_needsUpdateAllParticleFlags && this.UpdateAllParticleFlags(), this.m_needsUpdateAllGroupFlags && this.UpdateAllGroupFlags(), !this.m_paused))
                        for (this.m_iterationIndex = 0; this.m_iterationIndex <
                            b.particleIterations; this.m_iterationIndex++) {
                            ++this.m_timestamp;
                            var d = c.Copy(b);
                            d.dt /= b.particleIterations;
                            d.inv_dt *= b.particleIterations;
                            this.UpdateContacts(!1);
                            this.UpdateBodyContacts();
                            this.ComputeWeight();
                            this.m_allGroupFlags & f.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth && this.ComputeDepth();
                            this.m_allParticleFlags & f.b2ParticleFlag.b2_reactiveParticle && this.UpdatePairsAndTriadsWithReactiveParticles();
                            this.m_hasForce && this.SolveForce(d);
                            this.m_allParticleFlags & f.b2ParticleFlag.b2_viscousParticle &&
                                this.SolveViscous();
                            this.m_allParticleFlags & f.b2ParticleFlag.b2_repulsiveParticle && this.SolveRepulsive(d);
                            this.m_allParticleFlags & f.b2ParticleFlag.b2_powderParticle && this.SolvePowder(d);
                            this.m_allParticleFlags & f.b2ParticleFlag.b2_tensileParticle && this.SolveTensile(d);
                            this.m_allGroupFlags & f.b2ParticleGroupFlag.b2_solidParticleGroup && this.SolveSolid(d);
                            this.m_allParticleFlags & f.b2ParticleFlag.b2_colorMixingParticle && this.SolveColorMixing();
                            this.SolveGravity(d);
                            this.m_allParticleFlags & f.b2ParticleFlag.b2_staticPressureParticle &&
                                this.SolveStaticPressure(d);
                            this.SolvePressure(d);
                            this.SolveDamping(d);
                            this.m_allParticleFlags & a.k_extraDampingFlags && this.SolveExtraDamping();
                            this.m_allParticleFlags & f.b2ParticleFlag.b2_elasticParticle && this.SolveElastic(d);
                            this.m_allParticleFlags & f.b2ParticleFlag.b2_springParticle && this.SolveSpring(d);
                            this.LimitVelocity(d);
                            this.m_allGroupFlags & f.b2ParticleGroupFlag.b2_rigidParticleGroup && this.SolveRigidDamping();
                            this.m_allParticleFlags & f.b2ParticleFlag.b2_barrierParticle && this.SolveBarrier(d);
                            this.SolveCollision(d);
                            this.m_allGroupFlags & f.b2ParticleGroupFlag.b2_rigidParticleGroup && this.SolveRigid(d);
                            this.m_allParticleFlags & f.b2ParticleFlag.b2_wallParticle && this.SolveWall();
                            if (!this.m_positionBuffer.data) throw Error();
                            if (!this.m_velocityBuffer.data) throw Error();
                            for (var e = 0; e < this.m_count; e++) this.m_positionBuffer.data[e].SelfMulAdd(d.dt, this.m_velocityBuffer.data[e])
                        }
                };
                a.prototype.SolveCollision = function(b) {
                    var c = a.SolveCollision_s_aabb;
                    if (!this.m_positionBuffer.data) throw Error();
                    if (!this.m_velocityBuffer.data) throw Error();
                    var d = this.m_positionBuffer.data,
                        e = this.m_velocityBuffer.data;
                    c.lowerBound.x = 1E37;
                    c.lowerBound.y = 1E37;
                    c.upperBound.x = -1E37;
                    c.upperBound.y = -1E37;
                    for (var f = 0; f < this.m_count; f++) {
                        var g = e[f],
                            h = d[f],
                            k = h.x + b.dt * g.x;
                        g = h.y + b.dt * g.y;
                        c.lowerBound.x = W(c.lowerBound.x, W(h.x, k));
                        c.lowerBound.y = W(c.lowerBound.y, W(h.y, g));
                        c.upperBound.x = aa(c.upperBound.x, aa(h.x, k));
                        c.upperBound.y = aa(c.upperBound.y, aa(h.y, g))
                    }
                    b = new a.SolveCollisionCallback(this, b);
                    this.m_world.QueryAABB(b, c)
                };
                a.prototype.LimitVelocity = function(a) {
                    if (!this.m_velocityBuffer.data) throw Error();
                    var b = this.m_velocityBuffer.data;
                    a = this.GetCriticalVelocitySquared(a);
                    for (var c = 0; c < this.m_count; c++) {
                        var d = b[c],
                            e = r.DotVV(d, d);
                        e > a && d.SelfMul(ha(a / e))
                    }
                };
                a.prototype.SolveGravity = function(b) {
                    if (!this.m_velocityBuffer.data) throw Error();
                    var c = a.SolveGravity_s_gravity,
                        d = this.m_velocityBuffer.data;
                    b = r.MulSV(b.dt * this.m_def.gravityScale, this.m_world.GetGravity(), c);
                    for (c = 0; c < this.m_count; c++) d[c].SelfAdd(b)
                };
                a.prototype.SolveBarrier = function(b) {
                    var c = a.SolveBarrier_s_aabb,
                        d = a.SolveBarrier_s_va,
                        e = a.SolveBarrier_s_vb,
                        g = a.SolveBarrier_s_pba,
                        h = a.SolveBarrier_s_vba,
                        k = a.SolveBarrier_s_vc,
                        l = a.SolveBarrier_s_pca,
                        m = a.SolveBarrier_s_vca,
                        n = a.SolveBarrier_s_qba,
                        p = a.SolveBarrier_s_qca,
                        q = a.SolveBarrier_s_dv,
                        t = a.SolveBarrier_s_f;
                    if (!this.m_flagsBuffer.data) throw Error();
                    if (!this.m_positionBuffer.data) throw Error();
                    if (!this.m_velocityBuffer.data) throw Error();
                    for (var D = this.m_positionBuffer.data, u = this.m_velocityBuffer.data, v = 0; v < this.m_count; v++) 0 !== (this.m_flagsBuffer.data[v] & a.k_barrierWallFlags) && u[v].SetZero();
                    v = 2.5 * b.dt;
                    for (var w = this.GetParticleMass(), x = 0; x < this.m_pairBuffer.count; x++) {
                        var y = this.m_pairBuffer.data[x];
                        if (y.flags & f.b2ParticleFlag.b2_barrierParticle) {
                            var z = y.indexA,
                                A = y.indexB;
                            y = D[z];
                            var B = D[A],
                                C = c;
                            r.MinV(y, B, C.lowerBound);
                            r.MaxV(y, B, C.upperBound);
                            var E = this.m_groupBuffer[z],
                                F = this.m_groupBuffer[A];
                            z = this.GetLinearVelocity(E, z, y, d);
                            A = this.GetLinearVelocity(F, A, B, e);
                            B = r.SubVV(B, y, g);
                            A = r.SubVV(A, z, h);
                            C = this.GetInsideBoundsEnumerator(C);
                            for (var G; 0 <= (G = C.GetNext());) {
                                var H = D[G],
                                    Y = this.m_groupBuffer[G];
                                if (E !== Y && F !== Y) {
                                    var I = this.GetLinearVelocity(Y, G, H, k),
                                        K = r.SubVV(H, y, l),
                                        O = r.SubVV(I, z, m),
                                        M = r.CrossVV(A, O),
                                        L = r.CrossVV(B, O) - r.CrossVV(K, A),
                                        N = r.CrossVV(B, K),
                                        P = n,
                                        Q = p;
                                    if (0 === M) {
                                        if (0 === L) continue;
                                        N = -N / L;
                                        if (!(0 <= N && N < v)) continue;
                                        r.AddVMulSV(B, N, A, P);
                                        r.AddVMulSV(K, N, O, Q);
                                        L = r.DotVV(P, Q) / r.DotVV(P, P);
                                        if (!(0 <= L && 1 >= L)) continue
                                    } else {
                                        N = L * L - 4 * N * M;
                                        if (0 > N) continue;
                                        var R = ha(N);
                                        N = (-L - R) / (2 * M);
                                        M = (-L + R) / (2 * M);
                                        N > M && (L = N, N = M, M = L);
                                        r.AddVMulSV(B, N, A, P);
                                        r.AddVMulSV(K, N, O, Q);
                                        L = r.DotVV(P, Q) / r.DotVV(P, P);
                                        if (!(0 <= N && N < v && 0 <=
                                                L && 1 >= L)) {
                                            N = M;
                                            if (!(0 <= N && N < v)) continue;
                                            r.AddVMulSV(B, N, A, P);
                                            r.AddVMulSV(K, N, O, Q);
                                            L = r.DotVV(P, Q) / r.DotVV(P, P);
                                            if (!(0 <= L && 1 >= L)) continue
                                        }
                                    }
                                    K = q;
                                    K.x = z.x + L * A.x - I.x;
                                    K.y = z.y + L * A.y - I.y;
                                    I = r.MulSV(w, K, t);
                                    Y && this.IsRigidGroup(Y) ? (K = Y.GetMass(), O = Y.GetInertia(), 0 < K && Y.m_linearVelocity.SelfMulAdd(1 / K, I), 0 < O && (Y.m_angularVelocity += r.CrossVV(r.SubVV(H, Y.GetCenter(), r.s_t0), I) / O)) : u[G].SelfAdd(K);
                                    this.ParticleApplyForce(G, I.SelfMul(-b.inv_dt))
                                }
                            }
                        }
                    }
                };
                a.prototype.SolveStaticPressure = function(a) {
                    if (!this.m_flagsBuffer.data) throw Error();
                    this.m_staticPressureBuffer = this.RequestBuffer(this.m_staticPressureBuffer);
                    var b = this.GetCriticalPressure(a);
                    a = this.m_def.staticPressureStrength * b;
                    b *= .25;
                    for (var d = this.m_def.staticPressureRelaxation, e = 0; e < this.m_def.staticPressureIterations; e++) {
                        for (var g = 0; g < this.m_count; g++) this.m_accumulationBuffer[g] = 0;
                        for (g = 0; g < this.m_contactBuffer.count; g++) {
                            var h = this.m_contactBuffer.data[g];
                            if (h.flags & f.b2ParticleFlag.b2_staticPressureParticle) {
                                var k = h.indexA,
                                    l = h.indexB;
                                h = h.weight;
                                this.m_accumulationBuffer[k] +=
                                    h * this.m_staticPressureBuffer[l];
                                this.m_accumulationBuffer[l] += h * this.m_staticPressureBuffer[k]
                            }
                        }
                        for (g = 0; g < this.m_count; g++) h = this.m_weightBuffer[g], this.m_staticPressureBuffer[g] = this.m_flagsBuffer.data[g] & f.b2ParticleFlag.b2_staticPressureParticle ? c((this.m_accumulationBuffer[g] + a * (h - 1)) / (h + d), 0, b) : 0
                    }
                };
                a.prototype.ComputeWeight = function() {
                    for (var a, b, c = 0; c < this.m_count; c++) this.m_weightBuffer[c] = 0;
                    for (c = 0; c < this.m_bodyContactBuffer.count; c++) a = this.m_bodyContactBuffer.data[c], b = a.index, a = a.weight,
                        this.m_weightBuffer[b] += a;
                    for (c = 0; c < this.m_contactBuffer.count; c++) {
                        a = this.m_contactBuffer.data[c];
                        b = a.indexA;
                        var d = a.indexB;
                        a = a.weight;
                        this.m_weightBuffer[b] += a;
                        this.m_weightBuffer[d] += a
                    }
                };
                a.prototype.SolvePressure = function(b) {
                    var c = a.SolvePressure_s_f;
                    if (!this.m_flagsBuffer.data) throw Error();
                    if (!this.m_positionBuffer.data) throw Error();
                    if (!this.m_velocityBuffer.data) throw Error();
                    var d = this.m_positionBuffer.data,
                        e = this.m_velocityBuffer.data;
                    var g = this.GetCriticalPressure(b);
                    var h = this.m_def.pressureStrength *
                        g;
                    var k = .25 * g;
                    for (var l = 0; l < this.m_count; l++) {
                        g = this.m_weightBuffer[l];
                        var m = h * aa(0, g - 1);
                        this.m_accumulationBuffer[l] = W(m, k)
                    }
                    if (this.m_allParticleFlags & a.k_noPressureFlags)
                        for (l = 0; l < this.m_count; l++) this.m_flagsBuffer.data[l] & a.k_noPressureFlags && (this.m_accumulationBuffer[l] = 0);
                    if (this.m_allParticleFlags & f.b2ParticleFlag.b2_staticPressureParticle)
                        for (l = 0; l < this.m_count; l++) this.m_flagsBuffer.data[l] & f.b2ParticleFlag.b2_staticPressureParticle && (this.m_accumulationBuffer[l] += this.m_staticPressureBuffer[l]);
                    l = b.dt / (this.m_def.density * this.m_particleDiameter);
                    for (var n = this.GetParticleInvMass(), p = 0; p < this.m_bodyContactBuffer.count; p++) {
                        m = this.m_bodyContactBuffer.data[p];
                        k = m.index;
                        b = m.body;
                        g = m.weight;
                        var q = m.mass;
                        var t = m.normal;
                        var D = d[k];
                        m = this.m_accumulationBuffer[k] + h * g;
                        g = r.MulSV(l * g * q * m, t, c);
                        e[k].SelfMulSub(n, g);
                        b.ApplyLinearImpulse(g, D, !0)
                    }
                    for (p = 0; p < this.m_contactBuffer.count; p++) m = this.m_contactBuffer.data[p], k = m.indexA, b = m.indexB, g = m.weight, t = m.normal, m = this.m_accumulationBuffer[k] + this.m_accumulationBuffer[b],
                        g = r.MulSV(l * g * m, t, c), e[k].SelfSub(g), e[b].SelfAdd(g)
                };
                a.prototype.SolveDamping = function(b) {
                    var c = a.SolveDamping_s_v,
                        d = a.SolveDamping_s_f;
                    if (!this.m_positionBuffer.data) throw Error();
                    if (!this.m_velocityBuffer.data) throw Error();
                    for (var e = this.m_positionBuffer.data, f = this.m_velocityBuffer.data, g = this.m_def.dampingStrength, h = 1 / this.GetCriticalVelocity(b), k = this.GetParticleInvMass(), l = 0; l < this.m_bodyContactBuffer.count; l++) {
                        var m = this.m_bodyContactBuffer.data[l];
                        var n = m.index;
                        b = m.body;
                        var p = m.weight;
                        var q = m.mass;
                        var t = m.normal;
                        m = e[n];
                        var D = r.SubVV(b.GetLinearVelocityFromWorldPoint(m, r.s_t0), f[n], c);
                        D = r.DotVV(D, t);
                        0 > D && (p = aa(g * p, W(-h * D, .5)), q = r.MulSV(p * q * D, t, d), f[n].SelfMulAdd(k, q), b.ApplyLinearImpulse(q.SelfNeg(), m, !0))
                    }
                    for (l = 0; l < this.m_contactBuffer.count; l++) m = this.m_contactBuffer.data[l], n = m.indexA, b = m.indexB, p = m.weight, t = m.normal, D = r.SubVV(f[b], f[n], c), D = r.DotVV(D, t), 0 > D && (p = aa(g * p, W(-h * D, .5)), q = r.MulSV(p * D, t, d), f[n].SelfAdd(q), f[b].SelfSub(q))
                };
                a.prototype.SolveRigidDamping = function() {
                    var b,
                        c = a.SolveRigidDamping_s_t0,
                        d = a.SolveRigidDamping_s_t1,
                        e = a.SolveRigidDamping_s_p,
                        f = a.SolveRigidDamping_s_v,
                        g = [0],
                        h = [0],
                        k = [0],
                        l = [0],
                        m = [0],
                        n = [0];
                    if (!this.m_positionBuffer.data) throw Error();
                    for (var p = this.m_positionBuffer.data, q = this.m_def.dampingStrength, t = 0; t < this.m_bodyContactBuffer.count; t++) {
                        var u = this.m_bodyContactBuffer.data[t];
                        var v = u.index;
                        if ((b = this.m_groupBuffer[v]) && this.IsRigidGroup(b)) {
                            var w = u.body;
                            var x = u.normal;
                            var y = u.weight;
                            u = p[v];
                            var z = r.SubVV(w.GetLinearVelocityFromWorldPoint(u, c),
                                b.GetLinearVelocityFromWorldPoint(u, d), f);
                            z = r.DotVV(z, x);
                            0 > z && (this.InitDampingParameterWithRigidGroupOrParticle(g, h, k, !0, b, v, u, x), this.InitDampingParameter(l, m, n, w.GetMass(), w.GetInertia() - w.GetMass() * w.GetLocalCenter().LengthSquared(), w.GetWorldCenter(), u, x), y = q * W(y, 1) * this.ComputeDampingImpulse(g[0], h[0], k[0], l[0], m[0], n[0], z), this.ApplyDamping(g[0], h[0], k[0], !0, b, v, y, x), w.ApplyLinearImpulse(r.MulSV(-y, x, r.s_t0), u, !0))
                        }
                    }
                    for (t = 0; t < this.m_contactBuffer.count; t++) {
                        u = this.m_contactBuffer.data[t];
                        v =
                            u.indexA;
                        w = u.indexB;
                        x = u.normal;
                        y = u.weight;
                        b = this.m_groupBuffer[v];
                        var A = this.m_groupBuffer[w],
                            B = this.IsRigidGroup(b),
                            C = this.IsRigidGroup(A);
                        b !== A && (B || C) && (u = r.MidVV(p[v], p[w], e), z = r.SubVV(this.GetLinearVelocity(A, w, u, c), this.GetLinearVelocity(b, v, u, d), f), z = r.DotVV(z, x), 0 > z && (this.InitDampingParameterWithRigidGroupOrParticle(g, h, k, B, b, v, u, x), this.InitDampingParameterWithRigidGroupOrParticle(l, m, n, C, A, w, u, x), y = q * y * this.ComputeDampingImpulse(g[0], h[0], k[0], l[0], m[0], n[0], z), this.ApplyDamping(g[0], h[0],
                            k[0], B, b, v, y, x), this.ApplyDamping(l[0], m[0], n[0], C, A, w, -y, x)))
                    }
                };
                a.prototype.SolveExtraDamping = function() {
                    var b = a.SolveExtraDamping_s_v,
                        c = a.SolveExtraDamping_s_f;
                    if (!this.m_flagsBuffer.data) throw Error();
                    if (!this.m_positionBuffer.data) throw Error();
                    if (!this.m_velocityBuffer.data) throw Error();
                    for (var d = this.m_velocityBuffer.data, e = this.m_positionBuffer.data, f = this.GetParticleInvMass(), g = 0; g < this.m_bodyContactBuffer.count; g++) {
                        var h = this.m_bodyContactBuffer.data[g],
                            k = h.index;
                        if (this.m_flagsBuffer.data[k] &
                            a.k_extraDampingFlags) {
                            var l = h.body,
                                m = h.mass,
                                n = h.normal;
                            h = e[k];
                            var p = r.SubVV(l.GetLinearVelocityFromWorldPoint(h, r.s_t0), d[k], b);
                            p = r.DotVV(p, n);
                            0 > p && (m = r.MulSV(.5 * m * p, n, c), d[k].SelfMulAdd(f, m), l.ApplyLinearImpulse(m.SelfNeg(), h, !0))
                        }
                    }
                };
                a.prototype.SolveWall = function() {
                    if (!this.m_flagsBuffer.data) throw Error();
                    if (!this.m_velocityBuffer.data) throw Error();
                    for (var a = this.m_velocityBuffer.data, b = 0; b < this.m_count; b++) this.m_flagsBuffer.data[b] & f.b2ParticleFlag.b2_wallParticle && a[b].SetZero()
                };
                a.prototype.SolveRigid =
                    function(b) {
                        var c = a.SolveRigid_s_position,
                            d = a.SolveRigid_s_rotation,
                            e = a.SolveRigid_s_transform,
                            g = a.SolveRigid_s_velocityTransform;
                        if (!this.m_positionBuffer.data) throw Error();
                        if (!this.m_velocityBuffer.data) throw Error();
                        for (var h = this.m_positionBuffer.data, k = this.m_velocityBuffer.data, l = this.m_groupList; l; l = l.GetNext())
                            if (l.m_groupFlags & f.b2ParticleGroupFlag.b2_rigidParticleGroup) {
                                l.UpdateStatistics();
                                var m = d;
                                m.SetAngle(b.dt * l.m_angularVelocity);
                                var n = r.AddVV(l.m_center, r.SubVV(r.MulSV(b.dt, l.m_linearVelocity,
                                        r.s_t0), N.MulRV(m, l.m_center, r.s_t1), r.s_t0), c),
                                    p = e;
                                p.SetPositionRotation(n, m);
                                T.MulXX(p, l.m_transform, l.m_transform);
                                m = g;
                                m.p.x = b.inv_dt * p.p.x;
                                m.p.y = b.inv_dt * p.p.y;
                                m.q.s = b.inv_dt * p.q.s;
                                m.q.c = b.inv_dt * (p.q.c - 1);
                                for (p = l.m_firstIndex; p < l.m_lastIndex; p++) T.MulXV(m, h[p], k[p])
                            }
                    };
                a.prototype.SolveElastic = function(b) {
                    var c = a.SolveElastic_s_pa,
                        e = a.SolveElastic_s_pb,
                        g = a.SolveElastic_s_pc,
                        h = a.SolveElastic_s_r,
                        k = a.SolveElastic_s_t0;
                    if (!this.m_positionBuffer.data) throw Error();
                    if (!this.m_velocityBuffer.data) throw Error();
                    for (var l = this.m_positionBuffer.data, m = this.m_velocityBuffer.data, n = b.inv_dt * this.m_def.elasticStrength, p = 0; p < this.m_triadBuffer.count; p++) {
                        var q = this.m_triadBuffer.data[p];
                        if (q.flags & f.b2ParticleFlag.b2_elasticParticle) {
                            var t = q.indexA,
                                D = q.indexB,
                                u = q.indexC,
                                v = q.pa,
                                w = q.pb,
                                x = q.pc,
                                y = c.Copy(l[t]),
                                z = e.Copy(l[D]),
                                A = g.Copy(l[u]);
                            t = m[t];
                            D = m[D];
                            u = m[u];
                            y.SelfMulAdd(b.dt, t);
                            z.SelfMulAdd(b.dt, D);
                            A.SelfMulAdd(b.dt, u);
                            var B = (y.x + z.x + A.x) / 3,
                                C = (y.y + z.y + A.y) / 3;
                            y.x -= B;
                            y.y -= C;
                            z.x -= B;
                            z.y -= C;
                            A.x -= B;
                            A.y -= C;
                            B = h;
                            B.s = r.CrossVV(v,
                                y) + r.CrossVV(w, z) + r.CrossVV(x, A);
                            B.c = r.DotVV(v, y) + r.DotVV(w, z) + r.DotVV(x, A);
                            C = d(B.s * B.s + B.c * B.c);
                            isFinite(C) || (C = 1.9817753699999998E19);
                            B.s *= C;
                            B.c *= C;
                            q = n * q.strength;
                            N.MulRV(B, v, k);
                            r.SubVV(k, y, k);
                            r.MulSV(q, k, k);
                            t.SelfAdd(k);
                            N.MulRV(B, w, k);
                            r.SubVV(k, z, k);
                            r.MulSV(q, k, k);
                            D.SelfAdd(k);
                            N.MulRV(B, x, k);
                            r.SubVV(k, A, k);
                            r.MulSV(q, k, k);
                            u.SelfAdd(k)
                        }
                    }
                };
                a.prototype.SolveSpring = function(b) {
                    var c = a.SolveSpring_s_pa,
                        d = a.SolveSpring_s_pb,
                        e = a.SolveSpring_s_d,
                        g = a.SolveSpring_s_f;
                    if (!this.m_positionBuffer.data) throw Error();
                    if (!this.m_velocityBuffer.data) throw Error();
                    for (var h = this.m_positionBuffer.data, k = this.m_velocityBuffer.data, l = b.inv_dt * this.m_def.springStrength, m = 0; m < this.m_pairBuffer.count; m++) {
                        var n = this.m_pairBuffer.data[m];
                        if (n.flags & f.b2ParticleFlag.b2_springParticle) {
                            var p = n.indexA,
                                q = n.indexB,
                                t = c.Copy(h[p]),
                                D = d.Copy(h[q]);
                            p = k[p];
                            q = k[q];
                            t.SelfMulAdd(b.dt, p);
                            D.SelfMulAdd(b.dt, q);
                            t = r.SubVV(D, t, e);
                            D = n.distance;
                            var u = t.Length();
                            n = r.MulSV(l * n.strength * (D - u) / u, t, g);
                            p.SelfSub(n);
                            q.SelfAdd(n)
                        }
                    }
                };
                a.prototype.SolveTensile =
                    function(b) {
                        var c, d = a.SolveTensile_s_weightedNormal,
                            e = a.SolveTensile_s_s,
                            g = a.SolveTensile_s_f;
                        if (!this.m_velocityBuffer.data) throw Error();
                        var h = this.m_velocityBuffer.data;
                        for (c = 0; c < this.m_count; c++) this.m_accumulation2Buffer[c] = new r, this.m_accumulation2Buffer[c].SetZero();
                        for (var k = 0; k < this.m_contactBuffer.count; k++) {
                            var l = this.m_contactBuffer.data[k];
                            if (l.flags & f.b2ParticleFlag.b2_tensileParticle) {
                                var m = l.indexA;
                                c = l.indexB;
                                var n = l.weight;
                                l = l.normal;
                                l = r.MulSV((1 - n) * n, l, d);
                                this.m_accumulation2Buffer[m].SelfSub(l);
                                this.m_accumulation2Buffer[c].SelfAdd(l)
                            }
                        }
                        c = this.GetCriticalVelocity(b);
                        b = this.m_def.surfaceTensionPressureStrength * c;
                        d = this.m_def.surfaceTensionNormalStrength * c;
                        var p = .5 * c;
                        for (k = 0; k < this.m_contactBuffer.count; k++)
                            if (l = this.m_contactBuffer.data[k], l.flags & f.b2ParticleFlag.b2_tensileParticle) {
                                m = l.indexA;
                                c = l.indexB;
                                n = l.weight;
                                l = l.normal;
                                var q = this.m_weightBuffer[m] + this.m_weightBuffer[c],
                                    t = r.SubVV(this.m_accumulation2Buffer[c], this.m_accumulation2Buffer[m], e);
                                n *= W(b * (q - 2) + d * r.DotVV(t, l), p);
                                l = r.MulSV(n,
                                    l, g);
                                h[m].SelfSub(l);
                                h[c].SelfAdd(l)
                            }
                    };
                a.prototype.SolveViscous = function() {
                    var b = a.SolveViscous_s_v,
                        c = a.SolveViscous_s_f;
                    if (!this.m_flagsBuffer.data) throw Error();
                    if (!this.m_positionBuffer.data) throw Error();
                    if (!this.m_velocityBuffer.data) throw Error();
                    for (var d = this.m_positionBuffer.data, e = this.m_velocityBuffer.data, g = this.m_def.viscousStrength, h = this.GetParticleInvMass(), k = 0; k < this.m_bodyContactBuffer.count; k++) {
                        var l = this.m_bodyContactBuffer.data[k];
                        var m = l.index;
                        if (this.m_flagsBuffer.data[m] &
                            f.b2ParticleFlag.b2_viscousParticle) {
                            var n = l.body;
                            var p = l.weight;
                            var q = l.mass;
                            l = d[m];
                            var t = r.SubVV(n.GetLinearVelocityFromWorldPoint(l, r.s_t0), e[m], b);
                            p = r.MulSV(g * q * p, t, c);
                            e[m].SelfMulAdd(h, p);
                            n.ApplyLinearImpulse(p.SelfNeg(), l, !0)
                        }
                    }
                    for (k = 0; k < this.m_contactBuffer.count; k++) l = this.m_contactBuffer.data[k], l.flags & f.b2ParticleFlag.b2_viscousParticle && (m = l.indexA, n = l.indexB, p = l.weight, t = r.SubVV(e[n], e[m], b), p = r.MulSV(g * p, t, c), e[m].SelfAdd(p), e[n].SelfSub(p))
                };
                a.prototype.SolveRepulsive = function(b) {
                    var c =
                        a.SolveRepulsive_s_f;
                    if (!this.m_velocityBuffer.data) throw Error();
                    var d = this.m_velocityBuffer.data;
                    b = this.m_def.repulsiveStrength * this.GetCriticalVelocity(b);
                    for (var e = 0; e < this.m_contactBuffer.count; e++) {
                        var g = this.m_contactBuffer.data[e];
                        if (g.flags & f.b2ParticleFlag.b2_repulsiveParticle) {
                            var h = g.indexA,
                                k = g.indexB;
                            this.m_groupBuffer[h] !== this.m_groupBuffer[k] && (g = r.MulSV(b * g.weight, g.normal, c), d[h].SelfSub(g), d[k].SelfAdd(g))
                        }
                    }
                };
                a.prototype.SolvePowder = function(b) {
                    var c = a.SolvePowder_s_f;
                    if (!this.m_flagsBuffer.data) throw Error();
                    if (!this.m_positionBuffer.data) throw Error();
                    if (!this.m_velocityBuffer.data) throw Error();
                    for (var d = this.m_positionBuffer.data, e = this.m_velocityBuffer.data, g = this.m_def.powderStrength * this.GetCriticalVelocity(b), h = this.GetParticleInvMass(), k = 0; k < this.m_bodyContactBuffer.count; k++) {
                        var l = this.m_bodyContactBuffer.data[k];
                        var m = l.index;
                        if (this.m_flagsBuffer.data[m] & f.b2ParticleFlag.b2_powderParticle) {
                            var n = l.weight;
                            if (.25 < n) {
                                b = l.body;
                                var p = l.mass,
                                    q = d[m];
                                l = l.normal;
                                n = r.MulSV(g * p * (n - .25), l, c);
                                e[m].SelfMulSub(h,
                                    n);
                                b.ApplyLinearImpulse(n, q, !0)
                            }
                        }
                    }
                    for (k = 0; k < this.m_contactBuffer.count; k++) l = this.m_contactBuffer.data[k], l.flags & f.b2ParticleFlag.b2_powderParticle && (n = l.weight, .25 < n && (m = l.indexA, b = l.indexB, l = l.normal, n = r.MulSV(g * (n - .25), l, c), e[m].SelfSub(n), e[b].SelfAdd(n)))
                };
                a.prototype.SolveSolid = function(b) {
                    var c = a.SolveSolid_s_f;
                    if (!this.m_velocityBuffer.data) throw Error();
                    var d = this.m_velocityBuffer.data;
                    this.m_depthBuffer = this.RequestBuffer(this.m_depthBuffer);
                    b = b.inv_dt * this.m_def.ejectionStrength;
                    for (var e =
                            0; e < this.m_contactBuffer.count; e++) {
                        var f = this.m_contactBuffer.data[e],
                            g = f.indexA,
                            h = f.indexB;
                        this.m_groupBuffer[g] !== this.m_groupBuffer[h] && (f = r.MulSV(b * (this.m_depthBuffer[g] + this.m_depthBuffer[h]) * f.weight, f.normal, c), d[g].SelfSub(f), d[h].SelfAdd(f))
                    }
                };
                a.prototype.SolveForce = function(a) {
                    if (!this.m_velocityBuffer.data) throw Error();
                    var b = this.m_velocityBuffer.data;
                    a = a.dt * this.GetParticleInvMass();
                    for (var c = 0; c < this.m_count; c++) b[c].SelfMulAdd(a, this.m_forceBuffer[c]);
                    this.m_hasForce = !1
                };
                a.prototype.SolveColorMixing =
                    function() {
                        if (!this.m_flagsBuffer.data) throw Error();
                        if (!this.m_colorBuffer.data) throw Error();
                        var a = .5 * this.m_def.colorMixingStrength;
                        if (a)
                            for (var b = 0; b < this.m_contactBuffer.count; b++) {
                                var c = this.m_contactBuffer.data[b],
                                    d = c.indexA;
                                c = c.indexB;
                                this.m_flagsBuffer.data[d] & this.m_flagsBuffer.data[c] & f.b2ParticleFlag.b2_colorMixingParticle && oa.MixColors(this.m_colorBuffer.data[d], this.m_colorBuffer.data[c], a)
                            }
                    };
                a.prototype.SolveZombie = function() {
                    if (!this.m_flagsBuffer.data) throw Error();
                    if (!this.m_positionBuffer.data) throw Error();
                    if (!this.m_velocityBuffer.data) throw Error();
                    for (var a = 0, b = [], c = 0; c < this.m_count; c++) b[c] = -1;
                    var d = 0;
                    for (c = 0; c < this.m_count; c++) {
                        var e = this.m_flagsBuffer.data[c];
                        if (e & f.b2ParticleFlag.b2_zombieParticle) {
                            var g = this.m_world.m_destructionListener;
                            e & f.b2ParticleFlag.b2_destructionListenerParticle && g && g.SayGoodbyeParticle(this, c);
                            this.m_handleIndexBuffer.data && (g = this.m_handleIndexBuffer.data[c]) && (g.SetIndex(-1), this.m_handleIndexBuffer.data[c] = null);
                            b[c] = -1
                        } else b[c] = a, c !== a && (this.m_handleIndexBuffer.data &&
                            ((g = this.m_handleIndexBuffer.data[c]) && g.SetIndex(a), this.m_handleIndexBuffer.data[a] = g), this.m_flagsBuffer.data[a] = this.m_flagsBuffer.data[c], this.m_lastBodyContactStepBuffer.data && (this.m_lastBodyContactStepBuffer.data[a] = this.m_lastBodyContactStepBuffer.data[c]), this.m_bodyContactCountBuffer.data && (this.m_bodyContactCountBuffer.data[a] = this.m_bodyContactCountBuffer.data[c]), this.m_consecutiveContactStepsBuffer.data && (this.m_consecutiveContactStepsBuffer.data[a] = this.m_consecutiveContactStepsBuffer.data[c]),
                            this.m_positionBuffer.data[a].Copy(this.m_positionBuffer.data[c]), this.m_velocityBuffer.data[a].Copy(this.m_velocityBuffer.data[c]), this.m_groupBuffer[a] = this.m_groupBuffer[c], this.m_hasForce && this.m_forceBuffer[a].Copy(this.m_forceBuffer[c]), this.m_staticPressureBuffer && (this.m_staticPressureBuffer[a] = this.m_staticPressureBuffer[c]), this.m_depthBuffer && (this.m_depthBuffer[a] = this.m_depthBuffer[c]), this.m_colorBuffer.data && this.m_colorBuffer.data[a].Copy(this.m_colorBuffer.data[c]), this.m_userDataBuffer.data &&
                            (this.m_userDataBuffer.data[a] = this.m_userDataBuffer.data[c]), this.m_expirationTimeBuffer.data && (this.m_expirationTimeBuffer.data[a] = this.m_expirationTimeBuffer.data[c])), a++, d |= e
                    }
                    for (c = 0; c < this.m_proxyBuffer.count; c++) e = this.m_proxyBuffer.data[c], e.index = b[e.index];
                    this.m_proxyBuffer.RemoveIf(function(a) {
                        return 0 > a.index
                    });
                    for (c = 0; c < this.m_contactBuffer.count; c++) e = this.m_contactBuffer.data[c], e.indexA = b[e.indexA], e.indexB = b[e.indexB];
                    this.m_contactBuffer.RemoveIf(function(a) {
                        return 0 > a.indexA ||
                            0 > a.indexB
                    });
                    for (c = 0; c < this.m_bodyContactBuffer.count; c++) e = this.m_bodyContactBuffer.data[c], e.index = b[e.index];
                    this.m_bodyContactBuffer.RemoveIf(function(a) {
                        return 0 > a.index
                    });
                    for (c = 0; c < this.m_pairBuffer.count; c++) e = this.m_pairBuffer.data[c], e.indexA = b[e.indexA], e.indexB = b[e.indexB];
                    this.m_pairBuffer.RemoveIf(function(a) {
                        return 0 > a.indexA || 0 > a.indexB
                    });
                    for (c = 0; c < this.m_triadBuffer.count; c++) e = this.m_triadBuffer.data[c], e.indexA = b[e.indexA], e.indexB = b[e.indexB], e.indexC = b[e.indexC];
                    this.m_triadBuffer.RemoveIf(function(a) {
                        return 0 >
                            a.indexA || 0 > a.indexB || 0 > a.indexC
                    });
                    if (this.m_indexByExpirationTimeBuffer.data)
                        for (e = c = 0; e < this.m_count; e++) g = b[this.m_indexByExpirationTimeBuffer.data[e]], -1 !== g && (this.m_indexByExpirationTimeBuffer.data[c++] = g);
                    for (e = this.m_groupList; e; e = e.GetNext()) {
                        g = a;
                        var h = 0,
                            k = !1;
                        for (c = e.m_firstIndex; c < e.m_lastIndex; c++) {
                            var l = b[c];
                            0 <= l ? (g = W(g, l), h = aa(h, l + 1)) : k = !0
                        }
                        g < h ? (e.m_firstIndex = g, e.m_lastIndex = h, k && e.m_groupFlags & f.b2ParticleGroupFlag.b2_solidParticleGroup && this.SetGroupFlags(e, e.m_groupFlags | f.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth)) :
                            (e.m_firstIndex = 0, e.m_lastIndex = 0, e.m_groupFlags & f.b2ParticleGroupFlag.b2_particleGroupCanBeEmpty || this.SetGroupFlags(e, e.m_groupFlags | f.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed))
                    }
                    this.m_count = a;
                    this.m_allParticleFlags = d;
                    this.m_needsUpdateAllParticleFlags = !1;
                    for (e = this.m_groupList; e;) a = e.GetNext(), e.m_groupFlags & f.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed && this.DestroyParticleGroup(e), e = a
                };
                a.prototype.SolveLifetimes = function(a) {
                    if (!this.m_expirationTimeBuffer.data) throw Error();
                    if (!this.m_indexByExpirationTimeBuffer.data) throw Error();
                    this.m_timeElapsed = this.LifetimeToExpirationTime(a.dt);
                    a = this.GetQuantizedTimeElapsed();
                    var b = this.m_expirationTimeBuffer.data,
                        c = this.m_indexByExpirationTimeBuffer.data,
                        d = this.GetParticleCount();
                    this.m_expirationTimeBufferRequiresSorting && (K(c, 0, d, function(a, c) {
                        a = b[a];
                        c = b[c];
                        var d = 0 >= a;
                        return d === 0 >= c ? a > c : d
                    }), this.m_expirationTimeBufferRequiresSorting = !1);
                    for (--d; 0 <= d; --d) {
                        var e = c[d],
                            f = b[e];
                        if (a < f || 0 >= f) break;
                        this.DestroyParticle(e)
                    }
                };
                a.prototype.RotateBuffer =
                    function(a, b, c) {
                        function d(d) {
                            return d < a ? d : d < b ? d + c - b : d < c ? d + a - b : d
                        }
                        var e;
                        if (a !== b && b !== c) {
                            if (!this.m_flagsBuffer.data) throw Error();
                            if (!this.m_positionBuffer.data) throw Error();
                            if (!this.m_velocityBuffer.data) throw Error();
                            L(this.m_flagsBuffer.data, a, b, c);
                            this.m_lastBodyContactStepBuffer.data && L(this.m_lastBodyContactStepBuffer.data, a, b, c);
                            this.m_bodyContactCountBuffer.data && L(this.m_bodyContactCountBuffer.data, a, b, c);
                            this.m_consecutiveContactStepsBuffer.data && L(this.m_consecutiveContactStepsBuffer.data,
                                a, b, c);
                            L(this.m_positionBuffer.data, a, b, c);
                            L(this.m_velocityBuffer.data, a, b, c);
                            L(this.m_groupBuffer, a, b, c);
                            this.m_hasForce && L(this.m_forceBuffer, a, b, c);
                            this.m_staticPressureBuffer && L(this.m_staticPressureBuffer, a, b, c);
                            this.m_depthBuffer && L(this.m_depthBuffer, a, b, c);
                            this.m_colorBuffer.data && L(this.m_colorBuffer.data, a, b, c);
                            this.m_userDataBuffer.data && L(this.m_userDataBuffer.data, a, b, c);
                            if (this.m_handleIndexBuffer.data) {
                                L(this.m_handleIndexBuffer.data, a, b, c);
                                for (var f = a; f < c; ++f)(e = this.m_handleIndexBuffer.data[f]) &&
                                    e.SetIndex(d(e.GetIndex()))
                            }
                            if (this.m_expirationTimeBuffer.data) {
                                L(this.m_expirationTimeBuffer.data, a, b, c);
                                e = this.GetParticleCount();
                                if (!this.m_indexByExpirationTimeBuffer.data) throw Error();
                                var g = this.m_indexByExpirationTimeBuffer.data;
                                for (f = 0; f < e; ++f) g[f] = d(g[f])
                            }
                            for (f = 0; f < this.m_proxyBuffer.count; f++) e = this.m_proxyBuffer.data[f], e.index = d(e.index);
                            for (f = 0; f < this.m_contactBuffer.count; f++) e = this.m_contactBuffer.data[f], e.indexA = d(e.indexA), e.indexB = d(e.indexB);
                            for (f = 0; f < this.m_bodyContactBuffer.count; f++) e =
                                this.m_bodyContactBuffer.data[f], e.index = d(e.index);
                            for (f = 0; f < this.m_pairBuffer.count; f++) e = this.m_pairBuffer.data[f], e.indexA = d(e.indexA), e.indexB = d(e.indexB);
                            for (f = 0; f < this.m_triadBuffer.count; f++) e = this.m_triadBuffer.data[f], e.indexA = d(e.indexA), e.indexB = d(e.indexB), e.indexC = d(e.indexC);
                            for (f = this.m_groupList; f; f = f.GetNext()) f.m_firstIndex = d(f.m_firstIndex), f.m_lastIndex = d(f.m_lastIndex - 1) + 1
                        }
                    };
                a.prototype.GetCriticalVelocity = function(a) {
                    return this.m_particleDiameter * a.inv_dt
                };
                a.prototype.GetCriticalVelocitySquared =
                    function(a) {
                        a = this.GetCriticalVelocity(a);
                        return a * a
                    };
                a.prototype.GetCriticalPressure = function(a) {
                    return this.m_def.density * this.GetCriticalVelocitySquared(a)
                };
                a.prototype.GetParticleStride = function() {
                    return .75 * this.m_particleDiameter
                };
                a.prototype.GetParticleMass = function() {
                    var a = this.GetParticleStride();
                    return this.m_def.density * a * a
                };
                a.prototype.GetParticleInvMass = function() {
                    var a = 1 / .75 * this.m_inverseDiameter;
                    return this.m_inverseDensity * a * a
                };
                a.prototype.GetFixtureContactFilter = function() {
                    return this.m_allParticleFlags &
                        f.b2ParticleFlag.b2_fixtureContactFilterParticle ? this.m_world.m_contactManager.m_contactFilter : null
                };
                a.prototype.GetParticleContactFilter = function() {
                    return this.m_allParticleFlags & f.b2ParticleFlag.b2_particleContactFilterParticle ? this.m_world.m_contactManager.m_contactFilter : null
                };
                a.prototype.GetFixtureContactListener = function() {
                    return this.m_allParticleFlags & f.b2ParticleFlag.b2_fixtureContactListenerParticle ? this.m_world.m_contactManager.m_contactListener : null
                };
                a.prototype.GetParticleContactListener =
                    function() {
                        return this.m_allParticleFlags & f.b2ParticleFlag.b2_particleContactListenerParticle ? this.m_world.m_contactManager.m_contactListener : null
                    };
                a.prototype.SetUserOverridableBuffer = function(a, b, c) {
                    a.data = b;
                    a.userSuppliedCapacity = c
                };
                a.prototype.SetGroupFlags = function(a, b) {
                    var c = a.m_groupFlags;
                    (c ^ b) & f.b2ParticleGroupFlag.b2_solidParticleGroup && (b |= f.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth);
                    c & ~b && (this.m_needsUpdateAllGroupFlags = !0);
                    ~this.m_allGroupFlags & b && (b & f.b2ParticleGroupFlag.b2_solidParticleGroup &&
                        (this.m_depthBuffer = this.RequestBuffer(this.m_depthBuffer)), this.m_allGroupFlags |= b);
                    a.m_groupFlags = b
                };
                a.BodyContactCompare = function(a, b) {
                    return a.index === b.index ? a.weight > b.weight : a.index < b.index
                };
                a.prototype.RemoveSpuriousBodyContacts = function() {
                    K(this.m_bodyContactBuffer.data, 0, this.m_bodyContactBuffer.count, a.BodyContactCompare);
                    var b = a.RemoveSpuriousBodyContacts_s_n,
                        c = a.RemoveSpuriousBodyContacts_s_pos,
                        d = a.RemoveSpuriousBodyContacts_s_normal,
                        e = this,
                        f = -1,
                        g = 0;
                    this.m_bodyContactBuffer.count = S(this.m_bodyContactBuffer.data,
                        function(a) {
                            a.index !== f && (g = 0, f = a.index);
                            if (3 < g++) return !0;
                            var h = b.Copy(a.normal);
                            h.SelfMul(e.m_particleDiameter * (1 - a.weight));
                            if (!e.m_positionBuffer.data) throw Error();
                            h = r.AddVV(e.m_positionBuffer.data[a.index], h, c);
                            if (!a.fixture.TestPoint(h)) {
                                for (var k = a.fixture.GetShape().GetChildCount(), l = 0; l < k; l++)
                                    if (.008 > a.fixture.ComputeDistance(h, d, l)) return !1;
                                return !0
                            }
                            return !1
                        }, this.m_bodyContactBuffer.count)
                };
                a.prototype.DetectStuckParticle = function(a) {
                    if (!(0 >= this.m_stuckThreshold)) {
                        if (!this.m_bodyContactCountBuffer.data) throw Error();
                        if (!this.m_consecutiveContactStepsBuffer.data) throw Error();
                        if (!this.m_lastBodyContactStepBuffer.data) throw Error();
                        ++this.m_bodyContactCountBuffer.data[a];
                        2 === this.m_bodyContactCountBuffer.data[a] && (++this.m_consecutiveContactStepsBuffer.data[a], this.m_consecutiveContactStepsBuffer.data[a] > this.m_stuckThreshold && (this.m_stuckParticleBuffer.data[this.m_stuckParticleBuffer.Append()] = a));
                        this.m_lastBodyContactStepBuffer.data[a] = this.m_timestamp
                    }
                };
                a.prototype.ValidateParticleIndex = function(a) {
                    return 0 <=
                        a && a < this.GetParticleCount() && -1 !== a
                };
                a.prototype.GetQuantizedTimeElapsed = function() {
                    return Math.floor(this.m_timeElapsed / 4294967296)
                };
                a.prototype.LifetimeToExpirationTime = function(a) {
                    return this.m_timeElapsed + Math.floor(a / this.m_def.lifetimeGranularity * 4294967296)
                };
                a.prototype.ForceCanBeApplied = function(a) {
                    return !(a & f.b2ParticleFlag.b2_wallParticle)
                };
                a.prototype.PrepareForceBuffer = function() {
                    if (!this.m_hasForce) {
                        for (var a = 0; a < this.m_count; a++) this.m_forceBuffer[a].SetZero();
                        this.m_hasForce = !0
                    }
                };
                a.prototype.IsRigidGroup = function(a) {
                    return null !== a && 0 !== (a.m_groupFlags & f.b2ParticleGroupFlag.b2_rigidParticleGroup)
                };
                a.prototype.GetLinearVelocity = function(a, b, c, d) {
                    if (a && this.IsRigidGroup(a)) return a.GetLinearVelocityFromWorldPoint(c, d);
                    if (!this.m_velocityBuffer.data) throw Error();
                    return d.Copy(this.m_velocityBuffer.data[b])
                };
                a.prototype.InitDampingParameter = function(a, b, c, d, e, f, g, h) {
                    a[0] = 0 < d ? 1 / d : 0;
                    b[0] = 0 < e ? 1 / e : 0;
                    c[0] = r.CrossVV(r.SubVV(g, f, r.s_t0), h)
                };
                a.prototype.InitDampingParameterWithRigidGroupOrParticle =
                    function(a, b, c, d, e, g, h, k) {
                        if (e && d) this.InitDampingParameter(a, b, c, e.GetMass(), e.GetInertia(), e.GetCenter(), h, k);
                        else {
                            if (!this.m_flagsBuffer.data) throw Error();
                            this.InitDampingParameter(a, b, c, this.m_flagsBuffer.data[g] & f.b2ParticleFlag.b2_wallParticle ? 0 : this.GetParticleMass(), 0, h, h, k)
                        }
                    };
                a.prototype.ComputeDampingImpulse = function(a, b, c, d, e, f, g) {
                    a = a + b * c * c + d + e * f * f;
                    return 0 < a ? g / a : 0
                };
                a.prototype.ApplyDamping = function(a, b, c, d, e, f, g, h) {
                    if (e && d) e.m_linearVelocity.SelfMulAdd(g * a, h), e.m_angularVelocity += g * c *
                        b;
                    else {
                        if (!this.m_velocityBuffer.data) throw Error();
                        this.m_velocityBuffer.data[f].SelfMulAdd(g * a, h)
                    }
                };
                a.xTruncBits = 12;
                a.yTruncBits = 12;
                a.tagBits = 32;
                a.yOffset = 1 << a.yTruncBits - 1;
                a.yShift = a.tagBits - a.yTruncBits;
                a.xShift = a.tagBits - a.yTruncBits - a.xTruncBits;
                a.xScale = 1 << a.xShift;
                a.xOffset = a.xScale * (1 << a.xTruncBits - 1);
                a.yMask = (1 << a.yTruncBits) - 1 << a.yShift;
                a.xMask = ~a.yMask;
                a.DestroyParticlesInShape_s_aabb = new ra;
                a.CreateParticleGroup_s_transform = new T;
                a.ComputeCollisionEnergy_s_v = new r;
                a.QueryShapeAABB_s_aabb =
                    new ra;
                a.QueryPointAABB_s_aabb = new ra;
                a.RayCast_s_aabb = new ra;
                a.RayCast_s_p = new r;
                a.RayCast_s_v = new r;
                a.RayCast_s_n = new r;
                a.RayCast_s_point = new r;
                a.k_pairFlags = f.b2ParticleFlag.b2_springParticle;
                a.k_triadFlags = f.b2ParticleFlag.b2_elasticParticle;
                a.k_noPressureFlags = f.b2ParticleFlag.b2_powderParticle | f.b2ParticleFlag.b2_tensileParticle;
                a.k_extraDampingFlags = f.b2ParticleFlag.b2_staticPressureParticle;
                a.k_barrierWallFlags = f.b2ParticleFlag.b2_barrierParticle | f.b2ParticleFlag.b2_wallParticle;
                a.CreateParticlesStrokeShapeForGroup_s_edge =
                    new Ta;
                a.CreateParticlesStrokeShapeForGroup_s_d = new r;
                a.CreateParticlesStrokeShapeForGroup_s_p = new r;
                a.CreateParticlesFillShapeForGroup_s_aabb = new ra;
                a.CreateParticlesFillShapeForGroup_s_p = new r;
                a.UpdatePairsAndTriads_s_dab = new r;
                a.UpdatePairsAndTriads_s_dbc = new r;
                a.UpdatePairsAndTriads_s_dca = new r;
                a.AddContact_s_d = new r;
                a.UpdateBodyContacts_s_aabb = new ra;
                a.Solve_s_subStep = new La;
                a.SolveCollision_s_aabb = new ra;
                a.SolveGravity_s_gravity = new r;
                a.SolveBarrier_s_aabb = new ra;
                a.SolveBarrier_s_va = new r;
                a.SolveBarrier_s_vb =
                    new r;
                a.SolveBarrier_s_pba = new r;
                a.SolveBarrier_s_vba = new r;
                a.SolveBarrier_s_vc = new r;
                a.SolveBarrier_s_pca = new r;
                a.SolveBarrier_s_vca = new r;
                a.SolveBarrier_s_qba = new r;
                a.SolveBarrier_s_qca = new r;
                a.SolveBarrier_s_dv = new r;
                a.SolveBarrier_s_f = new r;
                a.SolvePressure_s_f = new r;
                a.SolveDamping_s_v = new r;
                a.SolveDamping_s_f = new r;
                a.SolveRigidDamping_s_t0 = new r;
                a.SolveRigidDamping_s_t1 = new r;
                a.SolveRigidDamping_s_p = new r;
                a.SolveRigidDamping_s_v = new r;
                a.SolveExtraDamping_s_v = new r;
                a.SolveExtraDamping_s_f = new r;
                a.SolveRigid_s_position = new r;
                a.SolveRigid_s_rotation = new N;
                a.SolveRigid_s_transform = new T;
                a.SolveRigid_s_velocityTransform = new T;
                a.SolveElastic_s_pa = new r;
                a.SolveElastic_s_pb = new r;
                a.SolveElastic_s_pc = new r;
                a.SolveElastic_s_r = new N;
                a.SolveElastic_s_t0 = new r;
                a.SolveSpring_s_pa = new r;
                a.SolveSpring_s_pb = new r;
                a.SolveSpring_s_d = new r;
                a.SolveSpring_s_f = new r;
                a.SolveTensile_s_weightedNormal = new r;
                a.SolveTensile_s_s = new r;
                a.SolveTensile_s_f = new r;
                a.SolveViscous_s_v = new r;
                a.SolveViscous_s_f = new r;
                a.SolveRepulsive_s_f =
                    new r;
                a.SolvePowder_s_f = new r;
                a.SolveSolid_s_f = new r;
                a.RemoveSpuriousBodyContacts_s_n = new r;
                a.RemoveSpuriousBodyContacts_s_pos = new r;
                a.RemoveSpuriousBodyContacts_s_normal = new r;
                return a
            }();
            (function(a) {
                var b = function() {
                    return function() {
                        this.data = null;
                        this.userSuppliedCapacity = 0
                    }
                }();
                a.UserOverridableBuffer = b;
                b = function() {
                    function a() {
                        this.index = -1;
                        this.tag = 0
                    }
                    a.CompareProxyProxy = function(a, b) {
                        return a.tag < b.tag
                    };
                    a.CompareTagProxy = function(a, b) {
                        return a < b.tag
                    };
                    a.CompareProxyTag = function(a, b) {
                        return a.tag <
                            b
                    };
                    return a
                }();
                a.Proxy = b;
                b = function() {
                    function b(b, c, d, e, f) {
                        this.m_system = b;
                        this.m_xLower = (c & a.xMask) >>> 0;
                        this.m_xUpper = (d & a.xMask) >>> 0;
                        this.m_yLower = (c & a.yMask) >>> 0;
                        this.m_yUpper = (d & a.yMask) >>> 0;
                        this.m_first = e;
                        this.m_last = f
                    }
                    b.prototype.GetNext = function() {
                        for (; this.m_first < this.m_last;) {
                            var b = (this.m_system.m_proxyBuffer.data[this.m_first].tag & a.xMask) >>> 0;
                            if (b >= this.m_xLower && b <= this.m_xUpper) return this.m_system.m_proxyBuffer.data[this.m_first++].index;
                            this.m_first++
                        }
                        return -1
                    };
                    return b
                }();
                a.InsideBoundsEnumerator =
                    b;
                b = function() {
                    return function() {
                        this.next = null;
                        this.index = this.count = 0
                    }
                }();
                a.ParticleListNode = b;
                b = function() {
                    function a() {}
                    a.prototype.Allocate = function(a, b) {
                        return b
                    };
                    a.prototype.Clear = function() {};
                    a.prototype.GetCount = function() {
                        return 0
                    };
                    a.prototype.Invalidate = function(a) {};
                    a.prototype.GetValidBuffer = function() {
                        return []
                    };
                    a.prototype.GetBuffer = function() {
                        return []
                    };
                    a.prototype.SetCount = function(a) {};
                    return a
                }();
                a.FixedSetAllocator = b;
                b = function() {
                    return function(a, b) {
                        this.second = -1;
                        this.first = a;
                        this.second = b
                    }
                }();
                a.FixtureParticle = b;
                b = function(a) {
                    function b() {
                        return null !== a && a.apply(this, arguments) || this
                    }
                    C(b, a);
                    b.prototype.Initialize = function(a, b) {};
                    b.prototype.Find = function(a) {
                        return -1
                    };
                    return b
                }(a.FixedSetAllocator);
                a.FixtureParticleSet = b;
                b = function() {
                    return function(a, b) {
                        this.second = this.first = -1;
                        this.first = a;
                        this.second = b
                    }
                }();
                a.ParticlePair = b;
                b = function(a) {
                    function b() {
                        return null !== a && a.apply(this, arguments) || this
                    }
                    C(b, a);
                    b.prototype.Initialize = function(a, b) {};
                    b.prototype.Find = function(a) {
                        return -1
                    };
                    return b
                }(a.FixedSetAllocator);
                a.b2ParticlePairSet = b;
                b = function() {
                    function a() {}
                    a.prototype.IsNecessary = function(a) {
                        return !0
                    };
                    a.prototype.ShouldCreatePair = function(a, b) {
                        return !0
                    };
                    a.prototype.ShouldCreateTriad = function(a, b, c) {
                        return !0
                    };
                    return a
                }();
                a.ConnectionFilter = b;
                b = function(a) {
                    function b(b, c, d, e) {
                        var f = a.call(this) || this;
                        f.m_callDestructionListener = !1;
                        f.m_destroyed = 0;
                        f.m_system = b;
                        f.m_shape = c;
                        f.m_xf = d;
                        f.m_callDestructionListener = e;
                        f.m_destroyed = 0;
                        return f
                    }
                    C(b, a);
                    b.prototype.ReportFixture = function(a) {
                        return !1
                    };
                    b.prototype.ReportParticle = function(a, b) {
                        if (a !== this.m_system) return !1;
                        if (!this.m_system.m_positionBuffer.data) throw Error();
                        this.m_shape.TestPoint(this.m_xf, this.m_system.m_positionBuffer.data[b]) && (this.m_system.DestroyParticle(b, this.m_callDestructionListener), this.m_destroyed++);
                        return !0
                    };
                    b.prototype.Destroyed = function() {
                        return this.m_destroyed
                    };
                    return b
                }(Ua);
                a.DestroyParticlesInShapeCallback = b;
                b = function(a) {
                    function b(b) {
                        var c = a.call(this) || this;
                        c.m_threshold = 0;
                        c.m_threshold = b;
                        return c
                    }
                    C(b, a);
                    b.prototype.ShouldCreatePair = function(a, b) {
                        return a < this.m_threshold && this.m_threshold <= b || b < this.m_threshold && this.m_threshold <= a
                    };
                    b.prototype.ShouldCreateTriad = function(a, b, c) {
                        return (a < this.m_threshold || b < this.m_threshold || c < this.m_threshold) && (this.m_threshold <= a || this.m_threshold <= b || this.m_threshold <= c)
                    };
                    return b
                }(a.ConnectionFilter);
                a.JoinParticleGroupsFilter = b;
                b = function(a) {
                    function b(b, c) {
                        void 0 === c && (c = b.length);
                        var d = a.call(this, f.b2ShapeType.e_unknown, 0) || this;
                        d.m_shapeCount = 0;
                        d.m_shapes =
                            b;
                        d.m_shapeCount = c;
                        return d
                    }
                    C(b, a);
                    b.prototype.Clone = function() {
                        throw Error();
                    };
                    b.prototype.GetChildCount = function() {
                        return 1
                    };
                    b.prototype.TestPoint = function(a, b) {
                        for (var c = 0; c < this.m_shapeCount; c++)
                            if (this.m_shapes[c].TestPoint(a, b)) return !0;
                        return !1
                    };
                    b.prototype.ComputeDistance = function(a, b, c, d) {
                        return 0
                    };
                    b.prototype.RayCast = function(a, b, c, d) {
                        return !1
                    };
                    b.prototype.ComputeAABB = function(a, b, c) {
                        c = new ra;
                        a.lowerBound.x = 1E37;
                        a.lowerBound.y = 1E37;
                        a.upperBound.x = -1E37;
                        a.upperBound.y = -1E37;
                        for (var d = 0; d <
                            this.m_shapeCount; d++)
                            for (var e = this.m_shapes[d].GetChildCount(), f = 0; f < e; f++) {
                                var g = c;
                                this.m_shapes[d].ComputeAABB(g, b, f);
                                a.Combine1(g)
                            }
                    };
                    b.prototype.ComputeMass = function(a, b) {};
                    b.prototype.SetupDistanceProxy = function(a, b) {};
                    b.prototype.ComputeSubmergedArea = function(a, b, c, d) {
                        return 0
                    };
                    b.prototype.Dump = function(a) {};
                    return b
                }(Ka);
                a.CompositeShape = b;
                b = function(a) {
                    function b(b) {
                        var c = a.call(this) || this;
                        c.m_flagsBuffer = b;
                        return c
                    }
                    C(b, a);
                    b.prototype.IsNecessary = function(a) {
                        if (!this.m_flagsBuffer.data) throw Error();
                        return 0 !== (this.m_flagsBuffer.data[a] & f.b2ParticleFlag.b2_reactiveParticle)
                    };
                    return b
                }(a.ConnectionFilter);
                a.ReactiveFilter = b;
                b = function(b) {
                    function c(a, c) {
                        a = b.call(this, a) || this;
                        a.m_contactFilter = c;
                        return a
                    }
                    C(c, b);
                    c.prototype.ShouldCollideFixtureParticle = function(a, b, c) {
                        return this.m_contactFilter && this.m_system.GetFlagsBuffer()[c] & f.b2ParticleFlag.b2_fixtureContactFilterParticle ? this.m_contactFilter.ShouldCollideFixtureParticle(a, this.m_system, c) : !0
                    };
                    c.prototype.ReportFixtureAndParticle = function(b,
                        c, d) {
                        var e = a.UpdateBodyContactsCallback.ReportFixtureAndParticle_s_n,
                            g = a.UpdateBodyContactsCallback.ReportFixtureAndParticle_s_rp;
                        if (!this.m_system.m_flagsBuffer.data) throw Error();
                        if (!this.m_system.m_positionBuffer.data) throw Error();
                        var h = this.m_system.m_positionBuffer.data[d];
                        c = b.ComputeDistance(h, e, c);
                        if (c < this.m_system.m_particleDiameter && this.ShouldCollideFixtureParticle(b, this.m_system, d)) {
                            var k = b.GetBody(),
                                l = k.GetWorldCenter(),
                                m = k.GetMass(),
                                n = k.GetInertia() - m * k.GetLocalCenter().LengthSquared();
                            m = 0 < m ? 1 / m : 0;
                            n = 0 < n ? 1 / n : 0;
                            var p = this.m_system.m_flagsBuffer.data[d] & f.b2ParticleFlag.b2_wallParticle ? 0 : this.m_system.GetParticleInvMass();
                            g = r.SubVV(h, l, g);
                            g = r.CrossVV(g, e);
                            g = p + m + n * g * g;
                            h = this.m_system.m_bodyContactBuffer.data[this.m_system.m_bodyContactBuffer.Append()];
                            h.index = d;
                            h.body = k;
                            h.fixture = b;
                            h.weight = 1 - c * this.m_system.m_inverseDiameter;
                            h.normal.Copy(e.SelfNeg());
                            h.mass = 0 < g ? 1 / g : 0;
                            this.m_system.DetectStuckParticle(d)
                        }
                    };
                    c.ReportFixtureAndParticle_s_n = new r;
                    c.ReportFixtureAndParticle_s_rp = new r;
                    return c
                }(Bb);
                a.UpdateBodyContactsCallback = b;
                b = function(b) {
                    function c(a, c) {
                        a = b.call(this, a) || this;
                        a.m_step = c;
                        return a
                    }
                    C(c, b);
                    c.prototype.ReportFixtureAndParticle = function(b, c, d) {
                        var e = a.SolveCollisionCallback.ReportFixtureAndParticle_s_p1,
                            g = a.SolveCollisionCallback.ReportFixtureAndParticle_s_output,
                            h = a.SolveCollisionCallback.ReportFixtureAndParticle_s_input,
                            k = a.SolveCollisionCallback.ReportFixtureAndParticle_s_p,
                            l = a.SolveCollisionCallback.ReportFixtureAndParticle_s_v,
                            m = a.SolveCollisionCallback.ReportFixtureAndParticle_s_f,
                            n = b.GetBody();
                        if (!this.m_system.m_positionBuffer.data) throw Error();
                        if (!this.m_system.m_velocityBuffer.data) throw Error();
                        var p = this.m_system.m_positionBuffer.data[d],
                            q = this.m_system.m_velocityBuffer.data[d];
                        0 === this.m_system.m_iterationIndex ? (e = T.MulTXV(n.m_xf0, p, e), b.GetShape().GetType() === f.b2ShapeType.e_circleShape && (e.SelfSub(n.GetLocalCenter()), N.MulRV(n.m_xf0.q, e, e), N.MulTRV(n.m_xf.q, e, e), e.SelfAdd(n.GetLocalCenter())), T.MulXV(n.m_xf, e, h.p1)) : h.p1.Copy(p);
                        r.AddVMulSV(p, this.m_step.dt, q, h.p2);
                        h.maxFraction = 1;
                        b.RayCast(g, h, c) && (b = g.normal, k.x = (1 - g.fraction) * h.p1.x + g.fraction * h.p2.x + .008 * b.x, k.y = (1 - g.fraction) * h.p1.y + g.fraction * h.p2.y + .008 * b.y, l.x = this.m_step.inv_dt * (k.x - p.x), l.y = this.m_step.inv_dt * (k.y - p.y), this.m_system.m_velocityBuffer.data[d].Copy(l), m.x = this.m_step.inv_dt * this.m_system.GetParticleMass() * (q.x - l.x), m.y = this.m_step.inv_dt * this.m_system.GetParticleMass() * (q.y - l.y), this.m_system.ParticleApplyForce(d, m))
                    };
                    c.prototype.ReportParticle = function(a, b) {
                        return !1
                    };
                    c.ReportFixtureAndParticle_s_p1 =
                        new r;
                    c.ReportFixtureAndParticle_s_output = new gb;
                    c.ReportFixtureAndParticle_s_input = new $a;
                    c.ReportFixtureAndParticle_s_p = new r;
                    c.ReportFixtureAndParticle_s_v = new r;
                    c.ReportFixtureAndParticle_s_f = new r;
                    return c
                }(Bb);
                a.SolveCollisionCallback = b
            })(f.b2ParticleSystem || (f.b2ParticleSystem = {}));
            var Yd = function() {
                    function a(a) {
                        this.m_locked = this.m_newFixture = !1;
                        this.m_clearForces = !0;
                        this.m_contactManager = new kc;
                        this.m_particleSystemList = this.m_jointList = this.m_bodyList = null;
                        this.m_jointCount = this.m_bodyCount =
                            0;
                        this.m_gravity = new r;
                        this.m_allowSleep = !0;
                        this.m_debugDraw = this.m_destructionListener = null;
                        this.m_inv_dt0 = 0;
                        this.m_continuousPhysics = this.m_warmStarting = !0;
                        this.m_subStepping = !1;
                        this.m_stepComplete = !0;
                        this.m_profile = new tb;
                        this.m_island = new pc;
                        this.s_stack = [];
                        this.m_controllerList = null;
                        this.m_controllerCount = 0;
                        this.m_gravity.Copy(a)
                    }
                    a.prototype.SetDestructionListener = function(a) {
                        this.m_destructionListener = a
                    };
                    a.prototype.SetContactFilter = function(a) {
                        this.m_contactManager.m_contactFilter = a
                    };
                    a.prototype.SetContactListener =
                        function(a) {
                            this.m_contactManager.m_contactListener = a
                        };
                    a.prototype.SetDebugDraw = function(a) {
                        this.m_debugDraw = a
                    };
                    a.prototype.CreateBody = function(a) {
                        void 0 === a && (a = {});
                        if (this.IsLocked()) throw Error();
                        a = new Rb(a, this);
                        a.m_prev = null;
                        (a.m_next = this.m_bodyList) && (this.m_bodyList.m_prev = a);
                        this.m_bodyList = a;
                        ++this.m_bodyCount;
                        return a
                    };
                    a.prototype.DestroyBody = function(a) {
                        if (this.IsLocked()) throw Error();
                        for (var b = a.m_jointList; b;) {
                            var c = b;
                            b = b.next;
                            this.m_destructionListener && this.m_destructionListener.SayGoodbyeJoint(c.joint);
                            this.DestroyJoint(c.joint);
                            a.m_jointList = b
                        }
                        a.m_jointList = null;
                        for (b = a.m_controllerList; b;) c = b, b = b.nextController, c.controller.RemoveBody(a);
                        for (b = a.m_contactList; b;) c = b, b = b.next, this.m_contactManager.Destroy(c.contact);
                        a.m_contactList = null;
                        for (b = a.m_fixtureList; b;) c = b, b = b.m_next, this.m_destructionListener && this.m_destructionListener.SayGoodbyeFixture(c), c.DestroyProxies(), c.Destroy(), a.m_fixtureList = b, --a.m_fixtureCount;
                        a.m_fixtureList = null;
                        a.m_fixtureCount = 0;
                        a.m_prev && (a.m_prev.m_next = a.m_next);
                        a.m_next && (a.m_next.m_prev = a.m_prev);
                        a === this.m_bodyList && (this.m_bodyList = a.m_next);
                        --this.m_bodyCount
                    };
                    a._Joint_Create = function(a, b) {
                        switch (a.type) {
                            case f.b2JointType.e_distanceJoint:
                                return new Tb(a);
                            case f.b2JointType.e_mouseJoint:
                                return new Yb(a);
                            case f.b2JointType.e_prismaticJoint:
                                return new Zb(a);
                            case f.b2JointType.e_revoluteJoint:
                                return new ac(a);
                            case f.b2JointType.e_pulleyJoint:
                                return new $b(a);
                            case f.b2JointType.e_gearJoint:
                                return new Wb(a);
                            case f.b2JointType.e_wheelJoint:
                                return new ec(a);
                            case f.b2JointType.e_weldJoint:
                                return new dc(a);
                            case f.b2JointType.e_frictionJoint:
                                return new Vb(a);
                            case f.b2JointType.e_ropeJoint:
                                return new bc(a);
                            case f.b2JointType.e_motorJoint:
                                return new Xb(a);
                            case f.b2JointType.e_areaJoint:
                                return new Ub(a)
                        }
                        throw Error();
                    };
                    a._Joint_Destroy = function(a, b) {};
                    a.prototype.CreateJoint = function(b) {
                        if (this.IsLocked()) throw Error();
                        var c = a._Joint_Create(b, null);
                        c.m_prev = null;
                        (c.m_next = this.m_jointList) && (this.m_jointList.m_prev = c);
                        this.m_jointList = c;
                        ++this.m_jointCount;
                        c.m_edgeA.prev = null;
                        (c.m_edgeA.next = c.m_bodyA.m_jointList) && (c.m_bodyA.m_jointList.prev = c.m_edgeA);
                        c.m_bodyA.m_jointList = c.m_edgeA;
                        c.m_edgeB.prev = null;
                        (c.m_edgeB.next = c.m_bodyB.m_jointList) && (c.m_bodyB.m_jointList.prev = c.m_edgeB);
                        c.m_bodyB.m_jointList = c.m_edgeB;
                        var d = b.bodyA,
                            e = b.bodyB;
                        if (!b.collideConnected)
                            for (b = e.GetContactList(); b;) b.other === d && b.contact.FlagForFiltering(), b = b.next;
                        return c
                    };
                    a.prototype.DestroyJoint = function(b) {
                        if (this.IsLocked()) throw Error();
                        var c = b.m_collideConnected;
                        b.m_prev &&
                            (b.m_prev.m_next = b.m_next);
                        b.m_next && (b.m_next.m_prev = b.m_prev);
                        b === this.m_jointList && (this.m_jointList = b.m_next);
                        var d = b.m_bodyA,
                            e = b.m_bodyB;
                        d.SetAwake(!0);
                        e.SetAwake(!0);
                        b.m_edgeA.prev && (b.m_edgeA.prev.next = b.m_edgeA.next);
                        b.m_edgeA.next && (b.m_edgeA.next.prev = b.m_edgeA.prev);
                        b.m_edgeA === d.m_jointList && (d.m_jointList = b.m_edgeA.next);
                        b.m_edgeA.prev = null;
                        b.m_edgeA.next = null;
                        b.m_edgeB.prev && (b.m_edgeB.prev.next = b.m_edgeB.next);
                        b.m_edgeB.next && (b.m_edgeB.next.prev = b.m_edgeB.prev);
                        b.m_edgeB === e.m_jointList &&
                            (e.m_jointList = b.m_edgeB.next);
                        b.m_edgeB.prev = null;
                        b.m_edgeB.next = null;
                        a._Joint_Destroy(b, null);
                        --this.m_jointCount;
                        if (!c)
                            for (b = e.GetContactList(); b;) b.other === d && b.contact.FlagForFiltering(), b = b.next
                    };
                    a.prototype.CreateParticleSystem = function(a) {
                        if (this.IsLocked()) throw Error();
                        a = new f.b2ParticleSystem(a, this);
                        a.m_prev = null;
                        (a.m_next = this.m_particleSystemList) && (this.m_particleSystemList.m_prev = a);
                        return this.m_particleSystemList = a
                    };
                    a.prototype.DestroyParticleSystem = function(a) {
                        if (this.IsLocked()) throw Error();
                        a.m_prev && (a.m_prev.m_next = a.m_next);
                        a.m_next && (a.m_next.m_prev = a.m_prev);
                        a === this.m_particleSystemList && (this.m_particleSystemList = a.m_next)
                    };
                    a.prototype.CalculateReasonableParticleIterations = function(a) {
                        if (null === this.m_particleSystemList) return 1;
                        for (var b = this.m_gravity.Length(), c = 1E37, d = this.GetParticleSystemList(); null !== d; d = d.m_next) c = W(c, d.GetRadius());
                        return F(b, c, a)
                    };
                    a.prototype.Step = function(b, c, d, e) {
                        void 0 === e && (e = this.CalculateReasonableParticleIterations(b));
                        var f = a.Step_s_stepTimer.Reset();
                        this.m_newFixture && (this.m_contactManager.FindNewContacts(), this.m_newFixture = !1);
                        this.m_locked = !0;
                        var g = a.Step_s_step;
                        g.dt = b;
                        g.velocityIterations = c;
                        g.positionIterations = d;
                        g.particleIterations = e;
                        g.inv_dt = 0 < b ? 1 / b : 0;
                        g.dtRatio = this.m_inv_dt0 * b;
                        g.warmStarting = this.m_warmStarting;
                        b = a.Step_s_timer.Reset();
                        this.m_contactManager.Collide();
                        this.m_profile.collide = b.GetMilliseconds();
                        if (this.m_stepComplete && 0 < g.dt) {
                            b = a.Step_s_timer.Reset();
                            for (c = this.m_particleSystemList; c; c = c.m_next) c.Solve(g);
                            this.Solve(g);
                            this.m_profile.solve = b.GetMilliseconds()
                        }
                        this.m_continuousPhysics && 0 < g.dt && (b = a.Step_s_timer.Reset(), this.SolveTOI(g), this.m_profile.solveTOI = b.GetMilliseconds());
                        0 < g.dt && (this.m_inv_dt0 = g.inv_dt);
                        this.m_clearForces && this.ClearForces();
                        this.m_locked = !1;
                        this.m_profile.step = f.GetMilliseconds()
                    };
                    a.prototype.ClearForces = function() {
                        for (var a = this.m_bodyList; a; a = a.m_next) a.m_force.SetZero(), a.m_torque = 0
                    };
                    a.prototype.DrawParticleSystem = function(a) {
                        if (null !== this.m_debugDraw) {
                            var b = a.GetParticleCount();
                            if (b) {
                                var c =
                                    a.GetRadius(),
                                    d = a.GetPositionBuffer();
                                a.m_colorBuffer.data ? (a = a.GetColorBuffer(), this.m_debugDraw.DrawParticles(d, c, a, b)) : this.m_debugDraw.DrawParticles(d, c, null, b)
                            }
                        }
                    };
                    a.prototype.DrawDebugData = function() {
                        if (null !== this.m_debugDraw) {
                            var b = this.m_debugDraw.GetFlags(),
                                c = a.DrawDebugData_s_color.SetRGB(0, 0, 0);
                            if (b & f.b2DrawFlags.e_shapeBit)
                                for (var d = this.m_bodyList; d; d = d.m_next) {
                                    var e = d.m_xf;
                                    this.m_debugDraw.PushTransform(e);
                                    for (var g = d.GetFixtureList(); g; g = g.m_next) d.IsActive() ? d.GetType() === f.b2BodyType.b2_staticBody ?
                                        c.SetRGB(.5, .9, .5) : d.GetType() === f.b2BodyType.b2_kinematicBody ? c.SetRGB(.5, .5, .9) : d.IsAwake() ? c.SetRGB(.9, .7, .7) : c.SetRGB(.6, .6, .6) : c.SetRGB(.5, .5, .3), this.DrawShape(g, c);
                                    this.m_debugDraw.PopTransform(e)
                                }
                            if (b & f.b2DrawFlags.e_particleBit)
                                for (d = this.m_particleSystemList; d; d = d.m_next) this.DrawParticleSystem(d);
                            if (b & f.b2DrawFlags.e_jointBit)
                                for (d = this.m_jointList; d; d = d.m_next) this.DrawJoint(d);
                            if (b & f.b2DrawFlags.e_aabbBit)
                                for (c.SetRGB(.9, .3, .9), e = a.DrawDebugData_s_vs, d = this.m_bodyList; d; d = d.m_next)
                                    if (d.IsActive())
                                        for (g =
                                            d.GetFixtureList(); g; g = g.m_next)
                                            for (var h = 0; h < g.m_proxyCount; ++h) {
                                                var k = g.m_proxies[h].treeNode.aabb;
                                                e[0].Set(k.lowerBound.x, k.lowerBound.y);
                                                e[1].Set(k.upperBound.x, k.lowerBound.y);
                                                e[2].Set(k.upperBound.x, k.upperBound.y);
                                                e[3].Set(k.lowerBound.x, k.upperBound.y);
                                                this.m_debugDraw.DrawPolygon(e, 4, c)
                                            }
                            if (b & f.b2DrawFlags.e_centerOfMassBit)
                                for (d = this.m_bodyList; d; d = d.m_next) e = a.DrawDebugData_s_xf, e.q.Copy(d.m_xf.q), e.p.Copy(d.GetWorldCenter()), this.m_debugDraw.DrawTransform(e);
                            if (b & f.b2DrawFlags.e_controllerBit)
                                for (b =
                                    this.m_controllerList; b; b = b.m_next) b.Draw(this.m_debugDraw)
                        }
                    };
                    a.prototype.QueryAABB = function(a, b, c) {
                        this.m_contactManager.m_broadPhase.Query(b, function(b) {
                            b = b.userData.fixture;
                            return a ? a.ReportFixture(b) : c ? c(b) : !0
                        });
                        if (a instanceof Ua)
                            for (var d = this.m_particleSystemList; d; d = d.m_next) a.ShouldQueryParticleSystem(d) && d.QueryAABB(a, b)
                    };
                    a.prototype.QueryAllAABB = function(a, b) {
                        void 0 === b && (b = []);
                        this.QueryAABB(null, a, function(a) {
                            b.push(a);
                            return !0
                        });
                        return b
                    };
                    a.prototype.QueryPointAABB = function(a, b, c) {
                        this.m_contactManager.m_broadPhase.QueryPoint(b,
                            function(b) {
                                b = b.userData.fixture;
                                return a ? a.ReportFixture(b) : c ? c(b) : !0
                            });
                        if (a instanceof Ua)
                            for (var d = this.m_particleSystemList; d; d = d.m_next) a.ShouldQueryParticleSystem(d) && d.QueryPointAABB(a, b)
                    };
                    a.prototype.QueryAllPointAABB = function(a, b) {
                        void 0 === b && (b = []);
                        this.QueryPointAABB(null, a, function(a) {
                            b.push(a);
                            return !0
                        });
                        return b
                    };
                    a.prototype.QueryFixtureShape = function(b, c, d, e, f) {
                        var g = a.QueryFixtureShape_s_aabb;
                        c.ComputeAABB(g, e, d);
                        this.m_contactManager.m_broadPhase.Query(g, function(a) {
                            a = a.userData;
                            var g = a.fixture;
                            if (q(c, d, g.GetShape(), a.childIndex, e, g.GetBody().GetTransform())) {
                                if (b) return b.ReportFixture(g);
                                if (f) return f(g)
                            }
                            return !0
                        });
                        if (b instanceof Ua)
                            for (var h = this.m_particleSystemList; h; h = h.m_next) b.ShouldQueryParticleSystem(h) && h.QueryAABB(b, g)
                    };
                    a.prototype.QueryAllFixtureShape = function(a, b, c, d) {
                        void 0 === d && (d = []);
                        this.QueryFixtureShape(null, a, b, c, function(a) {
                            d.push(a);
                            return !0
                        });
                        return d
                    };
                    a.prototype.QueryFixturePoint = function(a, b, c) {
                        this.m_contactManager.m_broadPhase.QueryPoint(b, function(d) {
                            d =
                                d.userData.fixture;
                            if (d.TestPoint(b)) {
                                if (a) return a.ReportFixture(d);
                                if (c) return c(d)
                            }
                            return !0
                        });
                        if (a)
                            for (var d = this.m_particleSystemList; d; d = d.m_next) a.ShouldQueryParticleSystem(d) && d.QueryPointAABB(a, b)
                    };
                    a.prototype.QueryAllFixturePoint = function(a, b) {
                        void 0 === b && (b = []);
                        this.QueryFixturePoint(null, a, function(a) {
                            b.push(a);
                            return !0
                        });
                        return b
                    };
                    a.prototype.RayCast = function(b, c, d, e) {
                        var f = a.RayCast_s_input;
                        f.maxFraction = 1;
                        f.p1.Copy(c);
                        f.p2.Copy(d);
                        this.m_contactManager.m_broadPhase.RayCast(f, function(f,
                            g) {
                            var h = g.userData;
                            g = h.fixture;
                            var k = a.RayCast_s_output;
                            if (g.RayCast(k, f, h.childIndex)) {
                                h = k.fraction;
                                var l = a.RayCast_s_point;
                                l.Set((1 - h) * c.x + h * d.x, (1 - h) * c.y + h * d.y);
                                if (b) return b.ReportFixture(g, l, k.normal, h);
                                if (e) return e(g, l, k.normal, h)
                            }
                            return f.maxFraction
                        });
                        if (b)
                            for (f = this.m_particleSystemList; f; f = f.m_next) b.ShouldQueryParticleSystem(f) && f.RayCast(b, c, d)
                    };
                    a.prototype.RayCastOne = function(a, b) {
                        var c = null,
                            d = 1;
                        this.RayCast(null, a, b, function(a, b, e, f) {
                            f < d && (d = f, c = a);
                            return d
                        });
                        return c
                    };
                    a.prototype.RayCastAll =
                        function(a, b, c) {
                            void 0 === c && (c = []);
                            this.RayCast(null, a, b, function(a, b, d, e) {
                                c.push(a);
                                return 1
                            });
                            return c
                        };
                    a.prototype.GetBodyList = function() {
                        return this.m_bodyList
                    };
                    a.prototype.GetJointList = function() {
                        return this.m_jointList
                    };
                    a.prototype.GetParticleSystemList = function() {
                        return this.m_particleSystemList
                    };
                    a.prototype.GetContactList = function() {
                        return this.m_contactManager.m_contactList
                    };
                    a.prototype.SetAllowSleeping = function(a) {
                        if (a !== this.m_allowSleep && (this.m_allowSleep = a, !this.m_allowSleep))
                            for (a =
                                this.m_bodyList; a; a = a.m_next) a.SetAwake(!0)
                    };
                    a.prototype.GetAllowSleeping = function() {
                        return this.m_allowSleep
                    };
                    a.prototype.SetWarmStarting = function(a) {
                        this.m_warmStarting = a
                    };
                    a.prototype.GetWarmStarting = function() {
                        return this.m_warmStarting
                    };
                    a.prototype.SetContinuousPhysics = function(a) {
                        this.m_continuousPhysics = a
                    };
                    a.prototype.GetContinuousPhysics = function() {
                        return this.m_continuousPhysics
                    };
                    a.prototype.SetSubStepping = function(a) {
                        this.m_subStepping = a
                    };
                    a.prototype.GetSubStepping = function() {
                        return this.m_subStepping
                    };
                    a.prototype.GetProxyCount = function() {
                        return this.m_contactManager.m_broadPhase.GetProxyCount()
                    };
                    a.prototype.GetBodyCount = function() {
                        return this.m_bodyCount
                    };
                    a.prototype.GetJointCount = function() {
                        return this.m_jointCount
                    };
                    a.prototype.GetContactCount = function() {
                        return this.m_contactManager.m_contactCount
                    };
                    a.prototype.GetTreeHeight = function() {
                        return this.m_contactManager.m_broadPhase.GetTreeHeight()
                    };
                    a.prototype.GetTreeBalance = function() {
                        return this.m_contactManager.m_broadPhase.GetTreeBalance()
                    };
                    a.prototype.GetTreeQuality =
                        function() {
                            return this.m_contactManager.m_broadPhase.GetTreeQuality()
                        };
                    a.prototype.SetGravity = function(a, b) {
                        void 0 === b && (b = !0);
                        if (!r.IsEqualToV(this.m_gravity, a) && (this.m_gravity.Copy(a), b))
                            for (a = this.m_bodyList; a; a = a.m_next) a.SetAwake(!0)
                    };
                    a.prototype.GetGravity = function() {
                        return this.m_gravity
                    };
                    a.prototype.IsLocked = function() {
                        return this.m_locked
                    };
                    a.prototype.SetAutoClearForces = function(a) {
                        this.m_clearForces = a
                    };
                    a.prototype.GetAutoClearForces = function() {
                        return this.m_clearForces
                    };
                    a.prototype.ShiftOrigin =
                        function(a) {
                            if (this.IsLocked()) throw Error();
                            for (var b = this.m_bodyList; b; b = b.m_next) b.m_xf.p.SelfSub(a), b.m_sweep.c0.SelfSub(a), b.m_sweep.c.SelfSub(a);
                            for (b = this.m_jointList; b; b = b.m_next) b.ShiftOrigin(a);
                            this.m_contactManager.m_broadPhase.ShiftOrigin(a)
                        };
                    a.prototype.GetContactManager = function() {
                        return this.m_contactManager
                    };
                    a.prototype.GetProfile = function() {
                        return this.m_profile
                    };
                    a.prototype.Dump = function(a) {
                        if (!this.m_locked) {
                            a("const g: b2Vec2 = new b2Vec2(%.15f, %.15f);\n", this.m_gravity.x, this.m_gravity.y);
                            a("this.m_world.SetGravity(g);\n");
                            a("const bodies: b2Body[] = [];\n");
                            a("const joints: b2Joint[] = [];\n");
                            for (var b = 0, c = this.m_bodyList; c; c = c.m_next) c.m_islandIndex = b, c.Dump(a), ++b;
                            b = 0;
                            for (c = this.m_jointList; c; c = c.m_next) c.m_index = b, ++b;
                            for (c = this.m_jointList; c; c = c.m_next) c.m_type !== f.b2JointType.e_gearJoint && (a("{\n"), c.Dump(a), a("}\n"));
                            for (c = this.m_jointList; c; c = c.m_next) c.m_type === f.b2JointType.e_gearJoint && (a("{\n"), c.Dump(a), a("}\n"))
                        }
                    };
                    a.prototype.DrawJoint = function(b) {
                        if (null !== this.m_debugDraw) {
                            var c =
                                b.GetBodyA(),
                                d = b.GetBodyB(),
                                e = c.m_xf.p,
                                g = d.m_xf.p;
                            d = b.GetAnchorA(a.DrawJoint_s_p1);
                            c = b.GetAnchorB(a.DrawJoint_s_p2);
                            var h = a.DrawJoint_s_color.SetRGB(.5, .8, .8);
                            switch (b.m_type) {
                                case f.b2JointType.e_distanceJoint:
                                    this.m_debugDraw.DrawSegment(d, c, h);
                                    break;
                                case f.b2JointType.e_pulleyJoint:
                                    e = b.GetGroundAnchorA();
                                    b = b.GetGroundAnchorB();
                                    this.m_debugDraw.DrawSegment(e, d, h);
                                    this.m_debugDraw.DrawSegment(b, c, h);
                                    this.m_debugDraw.DrawSegment(e, b, h);
                                    break;
                                case f.b2JointType.e_mouseJoint:
                                    b = a.DrawJoint_s_c;
                                    b.Set(0,
                                        1, 0);
                                    this.m_debugDraw.DrawPoint(d, 4, b);
                                    this.m_debugDraw.DrawPoint(c, 4, b);
                                    b.Set(.8, .8, .8);
                                    this.m_debugDraw.DrawSegment(d, c, b);
                                    break;
                                default:
                                    this.m_debugDraw.DrawSegment(e, d, h), this.m_debugDraw.DrawSegment(d, c, h), this.m_debugDraw.DrawSegment(g, c, h)
                            }
                        }
                    };
                    a.prototype.DrawShape = function(b, c) {
                        if (null !== this.m_debugDraw) switch (b = b.GetShape(), b.m_type) {
                            case f.b2ShapeType.e_circleShape:
                                this.m_debugDraw.DrawSolidCircle(b.m_p, b.m_radius, r.UNITX, c);
                                break;
                            case f.b2ShapeType.e_edgeShape:
                                var d = b.m_vertex1;
                                var e = b.m_vertex2;
                                this.m_debugDraw.DrawSegment(d, e, c);
                                break;
                            case f.b2ShapeType.e_chainShape:
                                var g = b.m_count,
                                    h = b.m_vertices,
                                    k = a.DrawShape_s_ghostColor.SetRGBA(.75 * c.r, .75 * c.g, .75 * c.b, c.a);
                                d = h[0];
                                this.m_debugDraw.DrawPoint(d, 4, c);
                                b.m_hasPrevVertex && (e = b.m_prevVertex, this.m_debugDraw.DrawSegment(e, d, k), this.m_debugDraw.DrawCircle(e, .1, k));
                                for (var l = 1; l < g; ++l) e = h[l], this.m_debugDraw.DrawSegment(d, e, c), this.m_debugDraw.DrawPoint(e, 4, c), d = e;
                                b.m_hasNextVertex && (c = b.m_nextVertex, this.m_debugDraw.DrawSegment(c, d, k), this.m_debugDraw.DrawCircle(c,
                                    .1, k));
                                break;
                            case f.b2ShapeType.e_polygonShape:
                                d = b.m_count, h = b.m_vertices, this.m_debugDraw.DrawSolidPolygon(h, d, c)
                        }
                    };
                    a.prototype.Solve = function(a) {
                        var b;
                        for (b = this.m_bodyList; b; b = b.m_next) b.m_xf0.Copy(b.m_xf);
                        for (var c = this.m_controllerList; c; c = c.m_next) c.Step(a);
                        this.m_profile.solveInit = 0;
                        this.m_profile.solveVelocity = 0;
                        this.m_profile.solvePosition = 0;
                        c = this.m_island;
                        c.Initialize(this.m_bodyCount, this.m_contactManager.m_contactCount, this.m_jointCount, null, this.m_contactManager.m_contactListener);
                        for (b =
                            this.m_bodyList; b; b = b.m_next) b.m_islandFlag = !1;
                        for (var d = this.m_contactManager.m_contactList; d; d = d.m_next) d.m_islandFlag = !1;
                        for (d = this.m_jointList; d; d = d.m_next) d.m_islandFlag = !1;
                        d = this.s_stack;
                        for (var e = this.m_bodyList; e; e = e.m_next)
                            if (!e.m_islandFlag && e.IsAwake() && e.IsActive() && e.GetType() !== f.b2BodyType.b2_staticBody) {
                                c.Clear();
                                var g = 0;
                                d[g++] = e;
                                for (e.m_islandFlag = !0; 0 < g;) {
                                    b = d[--g];
                                    if (!b) throw Error();
                                    c.AddBody(b);
                                    b.m_awakeFlag = !0;
                                    if (b.GetType() !== f.b2BodyType.b2_staticBody) {
                                        for (var h = b.m_contactList; h; h =
                                            h.next) {
                                            var k = h.contact;
                                            if (!k.m_islandFlag && k.IsEnabled() && k.IsTouching()) {
                                                var l = k.m_fixtureB.m_isSensor;
                                                if (!k.m_fixtureA.m_isSensor && !l) {
                                                    c.AddContact(k);
                                                    k.m_islandFlag = !0;
                                                    k = h.other;
                                                    if (!k) throw Error();
                                                    k.m_islandFlag || (d[g++] = k, k.m_islandFlag = !0)
                                                }
                                            }
                                        }
                                        for (b = b.m_jointList; b; b = b.next) b.joint.m_islandFlag || (k = b.other, k.IsActive() && (c.AddJoint(b.joint), b.joint.m_islandFlag = !0, k.m_islandFlag || (d[g++] = k, k.m_islandFlag = !0)))
                                    }
                                }
                                b = new tb;
                                c.Solve(b, a, this.m_gravity, this.m_allowSleep);
                                this.m_profile.solveInit +=
                                    b.solveInit;
                                this.m_profile.solveVelocity += b.solveVelocity;
                                this.m_profile.solvePosition += b.solvePosition;
                                for (g = 0; g < c.m_bodyCount; ++g) b = c.m_bodies[g], b.GetType() === f.b2BodyType.b2_staticBody && (b.m_islandFlag = !1)
                            }
                        for (g = 0; g < d.length && d[g]; ++g) d[g] = null;
                        a = new xa;
                        for (b = this.m_bodyList; b; b = b.m_next) b.m_islandFlag && b.GetType() !== f.b2BodyType.b2_staticBody && b.SynchronizeFixtures();
                        this.m_contactManager.FindNewContacts();
                        this.m_profile.broadphase = a.GetMilliseconds()
                    };
                    a.prototype.SolveTOI = function(b) {
                        var c =
                            this.m_island;
                        c.Initialize(64, 32, 0, null, this.m_contactManager.m_contactListener);
                        if (this.m_stepComplete) {
                            for (var d = this.m_bodyList; d; d = d.m_next) d.m_islandFlag = !1, d.m_sweep.alpha0 = 0;
                            for (var e = this.m_contactManager.m_contactList; e; e = e.m_next) e.m_toiFlag = !1, e.m_islandFlag = !1, e.m_toiCount = 0, e.m_toi = 1
                        }
                        for (;;) {
                            var g = null;
                            d = 1;
                            for (e = this.m_contactManager.m_contactList; e; e = e.m_next)
                                if (e.IsEnabled() && !(8 < e.m_toiCount)) {
                                    if (e.m_toiFlag) var h = e.m_toi;
                                    else {
                                        h = e.GetFixtureA();
                                        var k = e.GetFixtureB();
                                        if (h.IsSensor() ||
                                            k.IsSensor()) continue;
                                        var l = h.GetBody(),
                                            m = k.GetBody(),
                                            n = l.m_type,
                                            p = m.m_type,
                                            q = l.IsAwake() && n !== f.b2BodyType.b2_staticBody,
                                            r = m.IsAwake() && p !== f.b2BodyType.b2_staticBody;
                                        if (!q && !r) continue;
                                        n = l.IsBullet() || n !== f.b2BodyType.b2_dynamicBody;
                                        p = m.IsBullet() || p !== f.b2BodyType.b2_dynamicBody;
                                        if (!n && !p) continue;
                                        p = l.m_sweep.alpha0;
                                        l.m_sweep.alpha0 < m.m_sweep.alpha0 ? (p = m.m_sweep.alpha0, l.m_sweep.Advance(p)) : m.m_sweep.alpha0 < l.m_sweep.alpha0 && (p = l.m_sweep.alpha0, m.m_sweep.Advance(p));
                                        q = e.GetChildIndexA();
                                        r = e.GetChildIndexB();
                                        n = a.SolveTOI_s_toi_input;
                                        n.proxyA.SetShape(h.GetShape(), q);
                                        n.proxyB.SetShape(k.GetShape(), r);
                                        n.sweepA.Copy(l.m_sweep);
                                        n.sweepB.Copy(m.m_sweep);
                                        n.tMax = 1;
                                        h = a.SolveTOI_s_toi_output;
                                        u(h, n);
                                        k = h.t;
                                        h = h.state === f.b2TOIOutputState.e_touching ? W(p + (1 - p) * k, 1) : 1;
                                        e.m_toi = h;
                                        e.m_toiFlag = !0
                                    }
                                    h < d && (g = e, d = h)
                                }
                            if (null === g || .9999 < d) {
                                this.m_stepComplete = !0;
                                break
                            }
                            e = g.GetFixtureA();
                            h = g.GetFixtureB();
                            e = e.GetBody();
                            h = h.GetBody();
                            k = a.SolveTOI_s_backup1.Copy(e.m_sweep);
                            l = a.SolveTOI_s_backup2.Copy(h.m_sweep);
                            e.Advance(d);
                            h.Advance(d);
                            g.Update(this.m_contactManager.m_contactListener);
                            g.m_toiFlag = !1;
                            ++g.m_toiCount;
                            if (g.IsEnabled() && g.IsTouching()) {
                                e.SetAwake(!0);
                                h.SetAwake(!0);
                                c.Clear();
                                c.AddBody(e);
                                c.AddBody(h);
                                c.AddContact(g);
                                e.m_islandFlag = !0;
                                h.m_islandFlag = !0;
                                g.m_islandFlag = !0;
                                for (k = 0; 2 > k; ++k)
                                    if (g = 0 === k ? e : h, g.m_type === f.b2BodyType.b2_dynamicBody)
                                        for (l = g.m_contactList; l && c.m_bodyCount !== c.m_bodyCapacity && c.m_contactCount !== c.m_contactCapacity; l = l.next) m = l.contact, !m.m_islandFlag && (p = l.other, p.m_type !== f.b2BodyType.b2_dynamicBody ||
                                            g.IsBullet() || p.IsBullet()) && (n = m.m_fixtureB.m_isSensor, m.m_fixtureA.m_isSensor || n || (n = a.SolveTOI_s_backup.Copy(p.m_sweep), p.m_islandFlag || p.Advance(d), m.Update(this.m_contactManager.m_contactListener), m.IsEnabled() ? m.IsTouching() ? (m.m_islandFlag = !0, c.AddContact(m), p.m_islandFlag || (p.m_islandFlag = !0, p.m_type !== f.b2BodyType.b2_staticBody && p.SetAwake(!0), c.AddBody(p))) : (p.m_sweep.Copy(n), p.SynchronizeTransform()) : (p.m_sweep.Copy(n), p.SynchronizeTransform())));
                                g = a.SolveTOI_s_subStep;
                                g.dt = (1 - d) * b.dt;
                                g.inv_dt = 1 / g.dt;
                                g.dtRatio = 1;
                                g.positionIterations = 20;
                                g.velocityIterations = b.velocityIterations;
                                g.particleIterations = b.particleIterations;
                                g.warmStarting = !1;
                                c.SolveTOI(g, e.m_islandIndex, h.m_islandIndex);
                                for (k = 0; k < c.m_bodyCount; ++k)
                                    if (g = c.m_bodies[k], g.m_islandFlag = !1, g.m_type === f.b2BodyType.b2_dynamicBody)
                                        for (g.SynchronizeFixtures(), l = g.m_contactList; l; l = l.next) l.contact.m_toiFlag = !1, l.contact.m_islandFlag = !1;
                                this.m_contactManager.FindNewContacts();
                                if (this.m_subStepping) {
                                    this.m_stepComplete = !1;
                                    break
                                }
                            } else g.SetEnabled(!1),
                                e.m_sweep.Copy(k), h.m_sweep.Copy(l), e.SynchronizeTransform(), h.SynchronizeTransform()
                        }
                    };
                    a.prototype.AddController = function(a) {
                        a.m_next = this.m_controllerList;
                        a.m_prev = null;
                        this.m_controllerList && (this.m_controllerList.m_prev = a);
                        this.m_controllerList = a;
                        ++this.m_controllerCount;
                        return a
                    };
                    a.prototype.RemoveController = function(a) {
                        a.m_prev && (a.m_prev.m_next = a.m_next);
                        a.m_next && (a.m_next.m_prev = a.m_prev);
                        this.m_controllerList === a && (this.m_controllerList = a.m_next);
                        --this.m_controllerCount;
                        a.m_prev = null;
                        a.m_next =
                            null;
                        return a
                    };
                    a.Step_s_step = new La;
                    a.Step_s_stepTimer = new xa;
                    a.Step_s_timer = new xa;
                    a.DrawDebugData_s_color = new oa(0, 0, 0);
                    a.DrawDebugData_s_vs = r.MakeArray(4);
                    a.DrawDebugData_s_xf = new T;
                    a.QueryFixtureShape_s_aabb = new ra;
                    a.RayCast_s_input = new $a;
                    a.RayCast_s_output = new gb;
                    a.RayCast_s_point = new r;
                    a.DrawJoint_s_p1 = new r;
                    a.DrawJoint_s_p2 = new r;
                    a.DrawJoint_s_color = new oa(.5, .8, .8);
                    a.DrawJoint_s_c = new oa;
                    a.DrawShape_s_ghostColor = new oa;
                    a.SolveTOI_s_subStep = new La;
                    a.SolveTOI_s_backup = new pa;
                    a.SolveTOI_s_backup1 =
                        new pa;
                    a.SolveTOI_s_backup2 = new pa;
                    a.SolveTOI_s_toi_input = new hb;
                    a.SolveTOI_s_toi_output = new ib;
                    return a
                }(),
                yc = function() {
                    return function(a, b) {
                        this.nextController = this.prevController = this.nextBody = this.prevBody = null;
                        this.controller = a;
                        this.body = b
                    }
                }(),
                Va = function() {
                    function a() {
                        this.m_bodyList = null;
                        this.m_bodyCount = 0;
                        this.m_next = this.m_prev = null
                    }
                    a.prototype.GetNext = function() {
                        return this.m_next
                    };
                    a.prototype.GetPrev = function() {
                        return this.m_prev
                    };
                    a.prototype.GetBodyList = function() {
                        return this.m_bodyList
                    };
                    a.prototype.AddBody = function(a) {
                        var b = new yc(this, a);
                        b.nextBody = this.m_bodyList;
                        b.prevBody = null;
                        this.m_bodyList && (this.m_bodyList.prevBody = b);
                        this.m_bodyList = b;
                        ++this.m_bodyCount;
                        b.nextController = a.m_controllerList;
                        b.prevController = null;
                        a.m_controllerList && (a.m_controllerList.prevController = b);
                        a.m_controllerList = b;
                        ++a.m_controllerCount
                    };
                    a.prototype.RemoveBody = function(a) {
                        if (0 >= this.m_bodyCount) throw Error();
                        for (var b = this.m_bodyList; b && b.body !== a;) b = b.nextBody;
                        if (null === b) throw Error();
                        b.prevBody &&
                            (b.prevBody.nextBody = b.nextBody);
                        b.nextBody && (b.nextBody.prevBody = b.prevBody);
                        this.m_bodyList === b && (this.m_bodyList = b.nextBody);
                        --this.m_bodyCount;
                        b.nextController && (b.nextController.prevController = b.prevController);
                        b.prevController && (b.prevController.nextController = b.nextController);
                        a.m_controllerList === b && (a.m_controllerList = b.nextController);
                        --a.m_controllerCount
                    };
                    a.prototype.Clear = function() {
                        for (; this.m_bodyList;) this.RemoveBody(this.m_bodyList.body);
                        this.m_bodyCount = 0
                    };
                    return a
                }(),
                Zd = function(a) {
                    function b() {
                        var b =
                            null !== a && a.apply(this, arguments) || this;
                        b.normal = new r(0, 1);
                        b.offset = 0;
                        b.density = 0;
                        b.velocity = new r(0, 0);
                        b.linearDrag = 0;
                        b.angularDrag = 0;
                        b.useDensity = !1;
                        b.useWorldGravity = !0;
                        b.gravity = new r(0, 0);
                        return b
                    }
                    C(b, a);
                    b.prototype.Step = function(a) {
                        if (this.m_bodyList)
                            for (this.useWorldGravity && this.gravity.Copy(this.m_bodyList.body.GetWorld().GetGravity()), a = this.m_bodyList; a; a = a.nextBody) {
                                var b = a.body;
                                if (b.IsAwake()) {
                                    for (var c = new r, d = new r, e = 0, f = 0, g = b.GetFixtureList(); g; g = g.m_next) {
                                        var h = new r,
                                            k = g.GetShape().ComputeSubmergedArea(this.normal,
                                                this.offset, b.GetTransform(), h);
                                        e += k;
                                        c.x += k * h.x;
                                        c.y += k * h.y;
                                        var l = this.useDensity ? g.GetDensity() : 1;
                                        f += k * l;
                                        d.x += k * h.x * l;
                                        d.y += k * h.y * l
                                    }
                                    c.x /= e;
                                    c.y /= e;
                                    d.x /= f;
                                    d.y /= f;
                                    1E-5 > e || (f = this.gravity.Clone().SelfNeg(), f.SelfMul(this.density * e), b.ApplyForce(f, d), d = b.GetLinearVelocityFromWorldPoint(c, new r), d.SelfSub(this.velocity), d.SelfMul(-this.linearDrag * e), b.ApplyForce(d, c), b.ApplyTorque(-b.GetInertia() / b.GetMass() * e * b.GetAngularVelocity() * this.angularDrag))
                                }
                            }
                    };
                    b.prototype.Draw = function(a) {
                        var b = new r,
                            c = new r;
                        b.x = this.normal.x * this.offset + 100 * this.normal.y;
                        b.y = this.normal.y * this.offset - 100 * this.normal.x;
                        c.x = this.normal.x * this.offset - 100 * this.normal.y;
                        c.y = this.normal.y * this.offset + 100 * this.normal.x;
                        var d = new oa(0, 0, .8);
                        a.DrawSegment(b, c, d)
                    };
                    return b
                }(Va),
                $d = function(a) {
                    function b() {
                        var b = null !== a && a.apply(this, arguments) || this;
                        b.A = new r(0, 0);
                        return b
                    }
                    C(b, a);
                    b.prototype.Step = function(a) {
                        a = r.MulSV(a.dt, this.A, b.Step_s_dtA);
                        for (var c = this.m_bodyList; c; c = c.nextBody) {
                            var d = c.body;
                            d.IsAwake() && d.SetLinearVelocity(r.AddVV(d.GetLinearVelocity(),
                                a, r.s_t0))
                        }
                    };
                    b.prototype.Draw = function(a) {};
                    b.Step_s_dtA = new r;
                    return b
                }(Va),
                ae = function(a) {
                    function b() {
                        var b = null !== a && a.apply(this, arguments) || this;
                        b.F = new r(0, 0);
                        return b
                    }
                    C(b, a);
                    b.prototype.Step = function(a) {
                        for (a = this.m_bodyList; a; a = a.nextBody) {
                            var b = a.body;
                            b.IsAwake() && b.ApplyForce(this.F, b.GetWorldCenter())
                        }
                    };
                    b.prototype.Draw = function(a) {};
                    return b
                }(Va),
                be = function(a) {
                    function b() {
                        var b = null !== a && a.apply(this, arguments) || this;
                        b.G = 1;
                        b.invSqr = !0;
                        return b
                    }
                    C(b, a);
                    b.prototype.Step = function(a) {
                        if (this.invSqr)
                            for (var c =
                                    this.m_bodyList; c; c = c.nextBody) {
                                var d = c.body;
                                var e = d.GetWorldCenter();
                                var f = d.GetMass();
                                for (var g = this.m_bodyList; g && g !== c; g = g.nextBody) {
                                    var h = g.body;
                                    var k = h.GetWorldCenter();
                                    var l = h.GetMass();
                                    var m = k.x - e.x;
                                    var n = k.y - e.y;
                                    a = m * m + n * n;
                                    1E-5 > a || (n = b.Step_s_f.Set(m, n), n.SelfMul(this.G / a / ha(a) * f * l), d.IsAwake() && d.ApplyForce(n, e), h.IsAwake() && h.ApplyForce(n.SelfMul(-1), k))
                                }
                            } else
                                for (c = this.m_bodyList; c; c = c.nextBody)
                                    for (d = c.body, e = d.GetWorldCenter(), f = d.GetMass(), g = this.m_bodyList; g && g !== c; g = g.nextBody) h = g.body,
                                        k = h.GetWorldCenter(), l = h.GetMass(), m = k.x - e.x, n = k.y - e.y, a = m * m + n * n, 1E-5 > a || (n = b.Step_s_f.Set(m, n), n.SelfMul(this.G / a * f * l), d.IsAwake() && d.ApplyForce(n, e), h.IsAwake() && h.ApplyForce(n.SelfMul(-1), k))
                    };
                    b.prototype.Draw = function(a) {};
                    b.Step_s_f = new r;
                    return b
                }(Va),
                ce = function(a) {
                    function b() {
                        var b = null !== a && a.apply(this, arguments) || this;
                        b.T = new la;
                        b.maxTimestep = 0;
                        return b
                    }
                    C(b, a);
                    b.prototype.Step = function(a) {
                        a = a.dt;
                        if (!(1E-5 >= a)) {
                            a > this.maxTimestep && 0 < this.maxTimestep && (a = this.maxTimestep);
                            for (var c = this.m_bodyList; c; c =
                                c.nextBody) {
                                var d = c.body;
                                if (d.IsAwake()) {
                                    var e = d.GetWorldVector(la.MulMV(this.T, d.GetLocalVector(d.GetLinearVelocity(), r.s_t0), r.s_t1), b.Step_s_damping);
                                    d.SetLinearVelocity(r.AddVV(d.GetLinearVelocity(), r.MulSV(a, e, r.s_t0), r.s_t1))
                                }
                            }
                        }
                    };
                    b.prototype.Draw = function(a) {};
                    b.prototype.SetAxisAligned = function(a, b) {
                        this.T.ex.x = -a;
                        this.T.ex.y = 0;
                        this.T.ey.x = 0;
                        this.T.ey.y = -b;
                        this.maxTimestep = 0 < a || 0 < b ? 1 / aa(a, b) : 0
                    };
                    b.Step_s_damping = new r;
                    return b
                }(Va),
                de = function() {
                    return function() {
                        this.vertices = [];
                        this.count =
                            0;
                        this.masses = [];
                        this.gravity = new r(0, 0);
                        this.damping = .1;
                        this.k2 = .9;
                        this.k3 = .1
                    }
                }(),
                ee = function() {
                    function a() {
                        this.m_count = 0;
                        this.m_ps = [];
                        this.m_p0s = [];
                        this.m_vs = [];
                        this.m_ims = [];
                        this.m_Ls = [];
                        this.m_as = [];
                        this.m_gravity = new r;
                        this.m_damping = 0;
                        this.m_k2 = 1;
                        this.m_k3 = .1
                    }
                    a.prototype.GetVertexCount = function() {
                        return this.m_count
                    };
                    a.prototype.GetVertices = function() {
                        return this.m_ps
                    };
                    a.prototype.Initialize = function(a) {
                        this.m_count = a.count;
                        this.m_ps = r.MakeArray(this.m_count);
                        this.m_p0s = r.MakeArray(this.m_count);
                        this.m_vs = r.MakeArray(this.m_count);
                        this.m_ims = h(this.m_count);
                        for (var b = 0; b < this.m_count; ++b) {
                            this.m_ps[b].Copy(a.vertices[b]);
                            this.m_p0s[b].Copy(a.vertices[b]);
                            this.m_vs[b].SetZero();
                            var c = a.masses[b];
                            this.m_ims[b] = 0 < c ? 1 / c : 0
                        }
                        var d = this.m_count - 1;
                        c = this.m_count - 2;
                        this.m_Ls = h(d);
                        this.m_as = h(c);
                        for (b = 0; b < d; ++b) {
                            var e = this.m_ps[b];
                            var f = this.m_ps[b + 1];
                            this.m_Ls[b] = r.DistanceVV(e, f)
                        }
                        for (b = 0; b < c; ++b) e = this.m_ps[b], f = this.m_ps[b + 1], d = this.m_ps[b + 2], e = r.SubVV(f, e, r.s_t0), d = r.SubVV(d, f, r.s_t1), f = r.CrossVV(e,
                            d), e = r.DotVV(e, d), this.m_as[b] = ma(f, e);
                        this.m_gravity.Copy(a.gravity);
                        this.m_damping = a.damping;
                        this.m_k2 = a.k2;
                        this.m_k3 = a.k3
                    };
                    a.prototype.Step = function(a, b) {
                        if (0 !== a) {
                            for (var c = Math.exp(-a * this.m_damping), d = 0; d < this.m_count; ++d) this.m_p0s[d].Copy(this.m_ps[d]), 0 < this.m_ims[d] && this.m_vs[d].SelfMulAdd(a, this.m_gravity), this.m_vs[d].SelfMul(c), this.m_ps[d].SelfMulAdd(a, this.m_vs[d]);
                            for (d = 0; d < b; ++d) this.SolveC2(), this.SolveC3(), this.SolveC2();
                            a = 1 / a;
                            for (d = 0; d < this.m_count; ++d) r.MulSV(a, r.SubVV(this.m_ps[d],
                                this.m_p0s[d], r.s_t0), this.m_vs[d])
                        }
                    };
                    a.prototype.SolveC2 = function() {
                        for (var b = this.m_count - 1, c = 0; c < b; ++c) {
                            var d = this.m_ps[c],
                                e = this.m_ps[c + 1],
                                f = r.SubVV(e, d, a.s_d),
                                g = f.Normalize(),
                                h = this.m_ims[c],
                                k = this.m_ims[c + 1];
                            if (0 !== h + k) {
                                var l = k / (h + k);
                                d.SelfMulSub(h / (h + k) * this.m_k2 * (this.m_Ls[c] - g), f);
                                e.SelfMulAdd(this.m_k2 * l * (this.m_Ls[c] - g), f)
                            }
                        }
                    };
                    a.prototype.SetAngle = function(a) {
                        for (var b = this.m_count - 2, c = 0; c < b; ++c) this.m_as[c] = a
                    };
                    a.prototype.SolveC3 = function() {
                        for (var b = this.m_count - 2, c = 0; c < b; ++c) {
                            var d = this.m_ps[c],
                                e = this.m_ps[c + 1],
                                f = this.m_ps[c + 2],
                                g = this.m_ims[c],
                                h = this.m_ims[c + 1],
                                k = this.m_ims[c + 2],
                                l = r.SubVV(e, d, a.s_d1),
                                m = r.SubVV(f, e, a.s_d2),
                                n = l.LengthSquared(),
                                p = m.LengthSquared();
                            if (0 !== n * p) {
                                var q = r.CrossVV(l, m),
                                    t = r.DotVV(l, m);
                                q = ma(q, t);
                                l = r.MulSV(-1 / n, l.SelfSkew(), a.s_Jd1);
                                n = r.MulSV(1 / p, m.SelfSkew(), a.s_Jd2);
                                m = r.NegV(l, a.s_J1);
                                p = r.SubVV(l, n, a.s_J2);
                                l = n;
                                n = g * r.DotVV(m, m) + h * r.DotVV(p, p) + k * r.DotVV(l, l);
                                if (0 !== n) {
                                    n = 1 / n;
                                    for (t = q - this.m_as[c]; 3.14159265359 < t;) q -= 6.28318530718, t = q - this.m_as[c];
                                    for (; - 3.14159265359 >
                                        t;) q += 6.28318530718, t = q - this.m_as[c];
                                    q = -this.m_k3 * n * t;
                                    d.SelfMulAdd(g * q, m);
                                    e.SelfMulAdd(h * q, p);
                                    f.SelfMulAdd(k * q, l)
                                }
                            }
                        }
                    };
                    a.prototype.Draw = function(a) {
                        for (var b = new oa(.4, .5, .7), c = 0; c < this.m_count - 1; ++c) a.DrawSegment(this.m_ps[c], this.m_ps[c + 1], b)
                    };
                    a.s_d = new r;
                    a.s_d1 = new r;
                    a.s_d2 = new r;
                    a.s_Jd1 = new r;
                    a.s_Jd2 = new r;
                    a.s_J1 = new r;
                    a.s_J2 = new r;
                    return a
                }();
            f.b2Assert = function(a) {
                for (var b = [], c = 1; c < arguments.length; c++) b[c - 1] = arguments[c];
                if (!a) throw new(Error.bind.apply(Error, [void 0].concat(b)));
            };
            f.b2Maybe =
                e;
            f.b2_maxFloat = 1E37;
            f.b2_epsilon = 1E-5;
            f.b2_epsilon_sq = U;
            f.b2_pi = 3.14159265359;
            f.b2_maxManifoldPoints = 2;
            f.b2_maxPolygonVertices = 8;
            f.b2_aabbExtension = .1;
            f.b2_aabbMultiplier = 2;
            f.b2_linearSlop = .008;
            f.b2_angularSlop = V;
            f.b2_polygonRadius = .016;
            f.b2_maxSubSteps = 8;
            f.b2_maxTOIContacts = 32;
            f.b2_velocityThreshold = 1;
            f.b2_maxLinearCorrection = .2;
            f.b2_maxAngularCorrection = Z;
            f.b2_maxTranslation = 2;
            f.b2_maxTranslationSquared = 4;
            f.b2_maxRotation = 1.570796326795;
            f.b2_maxRotationSquared = 2.4674011002726646;
            f.b2_baumgarte =
                .2;
            f.b2_toiBaumgarte = .75;
            f.b2_invalidParticleIndex = -1;
            f.b2_maxParticleIndex = 2147483647;
            f.b2_particleStride = .75;
            f.b2_minParticleWeight = 1;
            f.b2_maxParticlePressure = .25;
            f.b2_maxParticleForce = .5;
            f.b2_maxTriadDistance = 2;
            f.b2_maxTriadDistanceSquared = 4;
            f.b2_minParticleSystemBufferCapacity = 256;
            f.b2_barrierCollisionTime = 2.5;
            f.b2_timeToSleep = .5;
            f.b2_linearSleepTolerance = .01;
            f.b2_angularSleepTolerance = da;
            f.b2Alloc = function(a) {
                return null
            };
            f.b2Free = function(a) {};
            f.b2Log = function(a) {
                for (var b = 1; b < arguments.length; b++);
            };
            f.b2Version = Q;
            f.b2_version = R;
            f.b2_branch = "master";
            f.b2_commit = "fbf51801d80fc389d43dc46524520e89043b6faf";
            f.b2ParseInt = function(a) {
                return parseInt(a, 10)
            };
            f.b2ParseUInt = function(a) {
                return Math.abs(parseInt(a, 10))
            };
            f.b2MakeArray = b;
            f.b2MakeNullArray = function(a) {
                for (var b = [], c = 0; c < a; ++c) b.push(null);
                return b
            };
            f.b2MakeNumberArray = h;
            f.b2_pi_over_180 = fa;
            f.b2_180_over_pi = 57.29577951307855;
            f.b2_two_pi = 6.28318530718;
            f.b2Abs = ba;
            f.b2Min = W;
            f.b2Max = aa;
            f.b2Clamp = c;
            f.b2Swap = function(a, b) {
                var c = a[0];
                a[0] = b[0];
                b[0] =
                    c
            };
            f.b2IsValid = ca;
            f.b2Sq = a;
            f.b2InvSqrt = d;
            f.b2Sqrt = ha;
            f.b2Pow = ia;
            f.b2DegToRad = function(a) {
                return a * fa
            };
            f.b2RadToDeg = function(a) {
                return 57.29577951307855 * a
            };
            f.b2Cos = Ba;
            f.b2Sin = ea;
            f.b2Acos = X;
            f.b2Asin = na;
            f.b2Atan2 = ma;
            f.b2NextPowerOfTwo = function(a) {
                a |= a >> 1 & 2147483647;
                a |= a >> 2 & 1073741823;
                a |= a >> 4 & 268435455;
                a |= a >> 8 & 16777215;
                return (a | a >> 16 & 65535) + 1
            };
            f.b2IsPowerOfTwo = function(a) {
                return 0 < a && 0 === (a & a - 1)
            };
            f.b2Random = function() {
                return 2 * Math.random() - 1
            };
            f.b2RandomRange = function(a, b) {
                return (b - a) * Math.random() + a
            };
            f.b2Vec2 = r;
            f.b2Vec2_zero = Aa;
            f.b2Vec3 = ja;
            f.b2Mat22 = la;
            f.b2Mat33 = ta;
            f.b2Rot = N;
            f.b2Transform = T;
            f.b2Sweep = pa;
            f.b2Color = oa;
            f.b2Draw = Ia;
            f.b2Timer = xa;
            f.b2Counter = Qa;
            f.b2GrowableStack = Da;
            f.b2BlockAllocator = Ya;
            f.b2StackAllocator = Wa;
            f.b2ContactFeature = Eb;
            f.b2ContactID = Za;
            f.b2ManifoldPoint = Fb;
            f.b2Manifold = eb;
            f.b2WorldManifold = Gb;
            f.b2GetPointStates = function(a, b, c, d) {
                var e;
                for (e = 0; e < c.pointCount; ++e) {
                    var g = c.points[e].id;
                    g = g.key;
                    a[e] = f.b2PointState.b2_removeState;
                    for (var h = 0, k = d.pointCount; h < k; ++h)
                        if (d.points[h].id.key ===
                            g) {
                            a[e] = f.b2PointState.b2_persistState;
                            break
                        }
                }
                for (; 2 > e; ++e) a[e] = f.b2PointState.b2_nullState;
                for (e = 0; e < d.pointCount; ++e)
                    for (g = d.points[e].id, g = g.key, b[e] = f.b2PointState.b2_addState, h = 0, k = c.pointCount; h < k; ++h)
                        if (c.points[h].id.key === g) {
                            b[e] = f.b2PointState.b2_persistState;
                            break
                        }
                for (; 2 > e; ++e) b[e] = f.b2PointState.b2_nullState
            };
            f.b2ClipVertex = Ja;
            f.b2RayCastInput = $a;
            f.b2RayCastOutput = gb;
            f.b2AABB = ra;
            f.b2TestOverlapAABB = g;
            f.b2ClipSegmentToLine = m;
            f.b2TestOverlapShape = q;
            f.b2DistanceProxy = Ca;
            f.b2SimplexCache =
                Na;
            f.b2DistanceInput = Oa;
            f.b2DistanceOutput = Pa;
            f.b2ShapeCastInput = sa;
            f.b2ShapeCastOutput = ka;
            f.b2_gjk_reset = function() {
                f.b2_gjkCalls = 0;
                f.b2_gjkIters = 0;
                f.b2_gjkMaxIters = 0
            };
            f.b2SimplexVertex = ua;
            f.b2Simplex = Ea;
            f.b2Distance = l;
            f.b2ShapeCast = function(a, b) {
                a.iterations = 0;
                a.lambda = 1;
                a.normal.SetZero();
                a.point.SetZero();
                var c = b.proxyA,
                    d = b.proxyB,
                    e = aa(c.m_radius, .016),
                    f = aa(d.m_radius, .016),
                    g = e + f;
                e = b.transformA;
                f = b.transformB;
                b = b.translationB;
                var h = Fc.Set(0, 0),
                    k = 0;
                za.m_count = 0;
                var l = za.m_vertices,
                    m = c.GetSupport(N.MulTRV(e.q,
                        r.NegV(b, r.s_t1), r.s_t0)),
                    n = T.MulXV(e, c.GetVertex(m), Cb),
                    p = d.GetSupport(N.MulTRV(f.q, b, r.s_t0)),
                    q = T.MulXV(f, d.GetVertex(p), Db),
                    t = r.SubVV(n, q, Gc);
                g = aa(.016, g - .016);
                for (var u = 0; 20 > u && .004 < ba(t.Length() - g);) {
                    a.iterations += 1;
                    m = c.GetSupport(N.MulTRV(e.q, r.NegV(t, r.s_t1), r.s_t0));
                    n = T.MulXV(e, c.GetVertex(m), Cb);
                    p = d.GetSupport(N.MulTRV(f.q, t, r.s_t0));
                    q = T.MulXV(f, d.GetVertex(p), Db);
                    var v = r.SubVV(n, q, Hc);
                    t.Normalize();
                    v = r.DotVV(t, v);
                    var w = r.DotVV(t, b);
                    if (v - g > k * w) {
                        if (0 >= w) return !1;
                        k = (v - g) / w;
                        if (1 < k) return !1;
                        h.Copy(t).SelfNeg();
                        za.m_count = 0
                    }
                    v = l[za.m_count];
                    v.indexA = p;
                    v.wA.Copy(q).SelfMulAdd(k, b);
                    v.indexB = m;
                    v.wB.Copy(n);
                    v.w.Copy(v.wB).SelfSub(v.wA);
                    v.a = 1;
                    za.m_count += 1;
                    switch (za.m_count) {
                        case 2:
                            za.Solve2();
                            break;
                        case 3:
                            za.Solve3()
                    }
                    if (3 === za.m_count) return !1;
                    za.GetClosestPoint(t);
                    ++u
                }
                za.GetWitnessPoints(Ic, Jc);
                0 < t.LengthSquared() && (h.Copy(t).SelfNeg(), h.Normalize());
                a.normal.Copy(h);
                a.lambda = k;
                a.iterations = u;
                return !0
            };
            f.b2Pair = Jb;
            f.b2BroadPhase = Kb;
            f.b2PairLessThan = p;
            f.b2TreeNode = Hb;
            f.b2DynamicTree = Ib;
            f.b2_toi_reset =
                function() {
                    f.b2_toiTime = 0;
                    f.b2_toiMaxTime = 0;
                    f.b2_toiCalls = 0;
                    f.b2_toiIters = 0;
                    f.b2_toiMaxIters = 0;
                    f.b2_toiRootIters = 0;
                    f.b2_toiMaxRootIters = 0
                };
            f.b2TOIInput = hb;
            f.b2TOIOutput = ib;
            f.b2SeparationFunction = Nb;
            f.b2TimeOfImpact = u;
            f.b2CollideCircles = v;
            f.b2CollidePolygonAndCircle = A;
            f.b2CollidePolygons = y;
            f.b2CollideEdgeAndCircle = z;
            f.b2CollideEdgeAndPolygon = x;
            f.b2MassData = cb;
            f.b2Shape = Ka;
            f.b2CircleShape = Fd;
            f.b2PolygonShape = Gd;
            f.b2EdgeShape = Ta;
            f.b2ChainShape = Hd;
            f.b2Filter = db;
            f.b2FixtureDef = Pb;
            f.b2FixtureProxy = jb;
            f.b2Fixture =
                Qb;
            f.b2BodyDef = Id;
            f.b2Body = Rb;
            f.b2World = Yd;
            f.b2DestructionListener = Vd;
            f.b2ContactFilter = hc;
            f.b2ContactImpulse = ic;
            f.b2ContactListener = jc;
            f.b2QueryCallback = Ua;
            f.b2RayCastCallback = Wd;
            f.b2Island = pc;
            f.b2Profile = tb;
            f.b2TimeStep = La;
            f.b2Position = ub;
            f.b2Velocity = vb;
            f.b2SolverData = lc;
            f.b2ContactManager = kc;
            f.b2MixFriction = function(a, b) {
                return ha(a * b)
            };
            f.b2MixRestitution = G;
            f.b2ContactEdge = lb;
            f.b2Contact = Ha;
            f.b2ContactRegister = fc;
            f.b2ContactFactory = gc;
            f.g_blockSolve = !1;
            f.b2VelocityConstraintPoint = mc;
            f.b2ContactVelocityConstraint =
                wb;
            f.b2ContactPositionConstraint = xb;
            f.b2ContactSolverDef = nc;
            f.b2PositionSolverManifold = yb;
            f.b2ContactSolver = oc;
            f.b2CircleContact = mb;
            f.b2PolygonContact = nb;
            f.b2PolygonAndCircleContact = ob;
            f.b2EdgeAndCircleContact = pb;
            f.b2EdgeAndPolygonContact = qb;
            f.b2ChainAndCircleContact = rb;
            f.b2ChainAndPolygonContact = sb;
            f.b2Jacobian = Jd;
            f.b2JointEdge = kb;
            f.b2JointDef = va;
            f.b2Joint = wa;
            f.b2AreaJointDef = Kd;
            f.b2AreaJoint = Ub;
            f.b2DistanceJointDef = Sb;
            f.b2DistanceJoint = Tb;
            f.b2FrictionJointDef = Ld;
            f.b2FrictionJoint = Vb;
            f.b2GearJointDef =
                Md;
            f.b2GearJoint = Wb;
            f.b2MotorJointDef = Nd;
            f.b2MotorJoint = Xb;
            f.b2MouseJointDef = Od;
            f.b2MouseJoint = Yb;
            f.b2PrismaticJointDef = Pd;
            f.b2PrismaticJoint = Zb;
            f.b2_minPulleyLength = 2;
            f.b2PulleyJointDef = Qd;
            f.b2PulleyJoint = $b;
            f.b2RevoluteJointDef = Rd;
            f.b2RevoluteJoint = ac;
            f.b2RopeJointDef = Sd;
            f.b2RopeJoint = bc;
            f.b2WeldJointDef = Td;
            f.b2WeldJoint = dc;
            f.b2WheelJointDef = Ud;
            f.b2WheelJoint = ec;
            f.b2ControllerEdge = yc;
            f.b2Controller = Va;
            f.b2BuoyancyController = Zd;
            f.b2ConstantAccelController = $d;
            f.b2ConstantForceController = ae;
            f.b2GravityController =
                be;
            f.b2TensorDampingController = ce;
            f.b2ParticleDef = zb;
            f.b2CalculateParticleIterations = F;
            f.b2ParticleHandle = qc;
            f.b2ParticleGroupDef = rc;
            f.b2ParticleGroup = sc;
            f.b2GrowableBuffer = Ma;
            f.b2FixtureParticleQueryCallback = Bb;
            f.b2ParticleContact = tc;
            f.b2ParticleBodyContact = uc;
            f.b2ParticlePair = vc;
            f.b2ParticleTriad = wc;
            f.b2ParticleSystemDef = xc;
            f.b2RopeDef = de;
            f.b2Rope = ee;
            Object.defineProperty(f, "__esModule", {
                value: !0
            })
        })
    }, {}],
    375: [function(h, q, m) {
        m = "undefined" === typeof window ? global : window;
        m.cc = m.cc || {};
        cc.internal =
            cc.internal || {};
        h("./predefine");
        h("./polyfill/string");
        h("./polyfill/misc");
        h("./polyfill/array");
        h("./polyfill/object");
        h("./polyfill/array-buffer");
        h("./polyfill/number");
        !0;
        h("./polyfill/typescript");
        h("./cocos2d/core/predefine");
        !0;
        h("./cocos2d");
        h("./extends");
        !1;
        q.exports = m.cc
    }, {
        "./cocos2d": 314,
        "./cocos2d/core/predefine": 229,
        "./extends": 362,
        "./package": void 0,
        "./polyfill/array": 377,
        "./polyfill/array-buffer": 376,
        "./polyfill/misc": 378,
        "./polyfill/number": 379,
        "./polyfill/object": 380,
        "./polyfill/string": 381,
        "./polyfill/typescript": 382,
        "./predefine": 383
    }],
    376: [function(h, q, m) {
        if (!ArrayBuffer.isView) {
            var f = Object.getPrototypeOf(Int8Array);
            ArrayBuffer.isView = "function" === typeof f ? function(e) {
                return e instanceof f
            } : function(e) {
                if ("object" !== typeof e) return !1;
                e = e.constructor;
                return e === Float64Array || e === Float32Array || e === Uint8Array || e === Uint32Array || e === Int8Array
            }
        }
    }, {}],
    377: [function(h, q, m) {
        Array.isArray || (Array.isArray = function(f) {
            return "[object Array]" === Object.prototype.toString.call(f)
        });
        Array.prototype.find ||
            (Array.prototype.find = function(f) {
                for (var e = this.length, b = 0; b < e; b++) {
                    var h = this[b];
                    if (f.call(this, h, b, this)) return h
                }
            });
        Array.prototype.includes || (Array.prototype.includes = function(f) {
            return -1 !== this.indexOf(f)
        })
    }, {}],
    378: [function(h, q, m) {
        Math.sign || (Math.sign = function(b) {
            b = +b;
            return 0 === b || isNaN(b) ? b : 0 < b ? 1 : -1
        });
        Math.log2 || (Math.log2 = function(b) {
            return Math.log(b) * Math.LOG2E
        });
        Number.isInteger || (Number.isInteger = function(b) {
            return "number" === typeof b && isFinite(b) && Math.floor(b) === b
        });
        if (!1, !console.time) {
            var f =
                window.performance || Date,
                e = Object.create(null);
            console.time = function(b) {
                e[b] = f.now()
            };
            console.timeEnd = function(b) {
                var h = e[b];
                h = f.now() - h;
                console.log(b + ": " + h + "ms")
            }
        }
    }, {}],
    379: [function(h, q, m) {
        Number.parseFloat = Number.parseFloat || parseFloat;
        Number.parseInt = Number.parseInt || parseInt
    }, {}],
    380: [function(h, q, m) {
        Object.assign || (Object.assign = function(f, e) {
            return cc.js.mixin(f, e)
        });
        Object.getOwnPropertyDescriptors || (Object.getOwnPropertyDescriptors = function(f) {
            var e = {},
                b = Object.getOwnPropertyNames(f);
            Object.getOwnPropertySymbols &&
                (b = b.concat(Object.getOwnPropertySymbols(f)));
            for (var h = 0; h < b.length; ++h) {
                var c = b[h];
                e[c] = Object.getOwnPropertyDescriptor(f, c)
            }
            return e
        })
    }, {}],
    381: [function(h, q, m) {
        String.prototype.startsWith || (String.prototype.startsWith = function(f, e) {
            e = e || 0;
            return this.lastIndexOf(f, e) === e
        });
        String.prototype.endsWith || (String.prototype.endsWith = function(f, e) {
            ("undefined" === typeof e || e > this.length) && (e = this.length);
            e -= f.length;
            f = this.indexOf(f, e);
            return -1 !== f && f === e
        });
        String.prototype.trimLeft || (String.prototype.trimLeft =
            function() {
                return this.replace(/^\s+/, "")
            })
    }, {}],
    382: [function(h, q, m) {
        var f = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(b, e) {
            b.__proto__ = e
        } || function(b, e) {
            for (var c in e) e.hasOwnProperty(c) && (b[c] = e[c])
        };
        window.__extends = function(b, e) {
            function c() {
                this.constructor = b
            }
            f(b, e);
            b.prototype = null === e ? Object.create(e) : (c.prototype = e.prototype, new c)
        };
        window.__assign = Object.assign || function(b) {
            for (var e, c = 1, a = arguments.length; c < a; c++) {
                e = arguments[c];
                for (var d in e) Object.prototype.hasOwnProperty.call(e,
                    d) && (b[d] = e[d])
            }
            return b
        };
        window.__rest = function(b, e) {
            var c = {},
                a;
            for (a in b) Object.prototype.hasOwnProperty.call(b, a) && 0 > e.indexOf(a) && (c[a] = b[a]);
            if (null != b && "function" === typeof Object.getOwnPropertySymbols) {
                var d = 0;
                for (a = Object.getOwnPropertySymbols(b); d < a.length; d++) 0 > e.indexOf(a[d]) && Object.prototype.propertyIsEnumerable.call(b, a[d]) && (c[a[d]] = b[a[d]])
            }
            return c
        };
        window.__decorate = function(b, e, c, a) {
            var d = arguments.length,
                f = 3 > d ? e : null === a ? a = Object.getOwnPropertyDescriptor(e, c) : a,
                g;
            if ("object" ===
                typeof Reflect && "function" === typeof Reflect.decorate) f = Reflect.decorate(b, e, c, a);
            else
                for (var h = b.length - 1; 0 <= h; h--)(g = b[h]) && (f = (3 > d ? g(f) : 3 < d ? g(e, c, f) : g(e, c)) || f);
            return 3 < d && f && Object.defineProperty(e, c, f), f
        };
        window.__param = function(b, e) {
            return function(c, a) {
                e(c, a, b)
            }
        };
        window.__metadata = function(b, e) {
            if ("object" === typeof Reflect && "function" === typeof Reflect.metadata) return Reflect.metadata(b, e)
        };
        window.__awaiter = function(b, e, c, a) {
            function d(a) {
                return a instanceof c ? a : new c(function(b) {
                    b(a)
                })
            }
            return new(c ||
                (c = Promise))(function(c, f) {
                function g(b) {
                    try {
                        k(a.next(b))
                    } catch (u) {
                        f(u)
                    }
                }

                function h(b) {
                    try {
                        k(a["throw"](b))
                    } catch (u) {
                        f(u)
                    }
                }

                function k(a) {
                    a.done ? c(a.value) : d(a.value).then(g, h)
                }
                k((a = a.apply(b, e || [])).next())
            })
        };
        window.__generator = function(b, e) {
            function c(b) {
                return function(c) {
                    return a([b, c])
                }
            }

            function a(a) {
                if (f) throw new TypeError("Generator is already executing.");
                for (; d;) try {
                    if (f = 1, g && (h = 2 & a[0] ? g["return"] : a[0] ? g["throw"] || ((h = g["return"]) && h.call(g), 0) : g.next) && !(h = h.call(g, a[1])).done) return h;
                    (g = 0, h) && (a = [2 & a[0], h.value]);
                    switch (a[0]) {
                        case 0:
                        case 1:
                            h = a;
                            break;
                        case 4:
                            return d.label++, {
                                value: a[1],
                                done: !1
                            };
                        case 5:
                            d.label++;
                            g = a[1];
                            a = [0];
                            continue;
                        case 7:
                            a = d.ops.pop();
                            d.trys.pop();
                            continue;
                        default:
                            if (!(h = d.trys, h = 0 < h.length && h[h.length - 1]) && (6 === a[0] || 2 === a[0])) {
                                d = 0;
                                continue
                            }
                            if (3 === a[0] && (!h || a[1] > h[0] && a[1] < h[3])) d.label = a[1];
                            else if (6 === a[0] && d.label < h[1]) d.label = h[1], h = a;
                            else if (h && d.label < h[2]) d.label = h[2], d.ops.push(a);
                            else {
                                h[2] && d.ops.pop();
                                d.trys.pop();
                                continue
                            }
                    }
                    a = e.call(b, d)
                } catch (p) {
                    a = [6, p], g = 0
                } finally {
                    f = h = 0
                }
                if (5 & a[0]) throw a[1];
                return {
                    value: a[0] ? a[1] : void 0,
                    done: !0
                }
            }
            var d = {
                    label: 0,
                    sent: function() {
                        if (1 & h[0]) throw h[1];
                        return h[1]
                    },
                    trys: [],
                    ops: []
                },
                f, g, h, k;
            $jscomp.initSymbol();
            $jscomp.initSymbol();
            $jscomp.initSymbolIterator();
            return k = {
                next: c(0),
                throw: c(1),
                return: c(2)
            }, "function" === typeof Symbol && (k[Symbol.iterator] = function() {
                return this
            }), k
        };
        window.__exportStar = function(b, e) {
            for (var c in b) "default" === c || e.hasOwnProperty(c) || __createBinding(e, b, c)
        };
        window.__createBinding = Object.create ?
            function(b, e, c, a) {
                void 0 === a && (a = c);
                Object.defineProperty(b, a, {
                    enumerable: !0,
                    get: function() {
                        return e[c]
                    }
                })
            } : function(b, e, c, a) {
                void 0 === a && (a = c);
                b[a] = e[c]
            };
        window.__values = function(b) {
            $jscomp.initSymbol();
            $jscomp.initSymbol();
            $jscomp.initSymbolIterator();
            var e = "function" === typeof Symbol && Symbol.iterator,
                c = e && b[e],
                a = 0;
            if (c) return c.call(b);
            if (b && "number" === typeof b.length) return {
                next: function() {
                    b && a >= b.length && (b = void 0);
                    return {
                        value: b && b[a++],
                        done: !b
                    }
                }
            };
            throw new TypeError(e ? "Object is not iterable." :
                "Symbol.iterator is not defined.");
        };
        window.__read = function(b, e) {
            $jscomp.initSymbol();
            $jscomp.initSymbol();
            $jscomp.initSymbolIterator();
            var c = "function" === typeof Symbol && b[Symbol.iterator];
            if (!c) return b;
            b = c.call(b);
            var a, d = [];
            try {
                for (;
                    (void 0 === e || 0 < e--) && !(a = b.next()).done;) d.push(a.value)
            } catch (g) {
                var f = {
                    error: g
                }
            } finally {
                try {
                    a && !a.done && (c = b["return"]) && c.call(b)
                } finally {
                    if (f) throw f.error;
                }
            }
            return d
        };
        window.__spread = function() {
            for (var b = [], e = 0; e < arguments.length; e++) b = b.concat(__read(arguments[e]));
            return b
        };
        window.__spreadArrays = function() {
            for (var b = 0, e = 0, c = arguments.length; e < c; e++) b += arguments[e].length;
            b = Array(b);
            var a = 0;
            for (e = 0; e < c; e++)
                for (var d = arguments[e], f = 0, g = d.length; f < g; f++, a++) b[a] = d[f];
            return b
        };
        window.__await = function(b) {
            return this instanceof __await ? (this.v = b, this) : new __await(b)
        };
        window.__asyncGenerator = function(b, e, c) {
            function a(a) {
                k[a] && (m[a] = function(b) {
                    return new Promise(function(c, e) {
                        1 < p.push([a, b, c, e]) || d(a, b)
                    })
                })
            }

            function d(a, b) {
                try {
                    var c = k[a](b);
                    c.value instanceof __await ?
                        Promise.resolve(c.value.v).then(f, g) : h(p[0][2], c)
                } catch (B) {
                    h(p[0][3], B)
                }
            }

            function f(a) {
                d("next", a)
            }

            function g(a) {
                d("throw", a)
            }

            function h(a, b) {
                (a(b), p.shift(), p.length) && d(p[0][0], p[0][1])
            }
            $jscomp.initSymbol();
            if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
            var k = c.apply(b, e || []),
                m, p = [];
            $jscomp.initSymbol();
            return m = {}, a("next"), a("throw"), a("return"), m[Symbol.asyncIterator] = function() {
                return this
            }, m
        };
        window.__asyncDelegator = function(b) {
            function e(d, e) {
                c[d] = b[d] ?
                    function(c) {
                        return (a = !a) ? {
                            value: __await(b[d](c)),
                            done: "return" === d
                        } : e ? e(c) : c
                    } : e
            }
            var c, a;
            $jscomp.initSymbol();
            $jscomp.initSymbolIterator();
            return c = {}, e("next"), e("throw", function(a) {
                throw a;
            }), e("return"), c[Symbol.iterator] = function() {
                return this
            }, c
        };
        window.__asyncValues = function(b) {
            function e(a) {
                d[a] = b[a] && function(d) {
                    return new Promise(function(e, f) {
                        d = b[a](d);
                        c(e, f, d.done, d.value)
                    })
                }
            }

            function c(a, b, c, d) {
                Promise.resolve(d).then(function(b) {
                    a({
                        value: b,
                        done: c
                    })
                }, b)
            }
            $jscomp.initSymbol();
            if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
            $jscomp.initSymbol();
            var a = b[Symbol.asyncIterator],
                d;
            $jscomp.initSymbol();
            $jscomp.initSymbolIterator();
            $jscomp.initSymbol();
            return a ? a.call(b) : (b = "function" === typeof __values ? __values(b) : b[Symbol.iterator](), d = {}, e("next"), e("throw"), e("return"), d[Symbol.asyncIterator] = function() {
                return this
            }, d)
        };
        window.__makeTemplateObject = function(b, e) {
            Object.defineProperty ? Object.defineProperty(b, "raw", {
                value: e
            }) : b.raw = e;
            return b
        };
        var e = Object.create ? function(b, e) {
            Object.defineProperty(b, "default", {
                enumerable: !0,
                value: e
            })
        } : function(b, e) {
            b["default"] = e
        };
        window.__importStar = function(b) {
            if (b && b.__esModule) return b;
            var f = {};
            if (null != b)
                for (var c in b) Object.hasOwnProperty.call(b, c) && __createBinding(f, b, c);
            e(f, b);
            return f
        };
        window.__importDefault = function(b) {
            return b && b.__esModule ? b : {
                default: b
            }
        };
        window.__classPrivateFieldGet = function(b, e) {
            if (!e.has(b)) throw new TypeError("attempted to get private field on non-instance");
            return e.get(b)
        };
        window.__classPrivateFieldSet = function(b, e, c) {
            if (!e.has(b)) throw new TypeError("attempted to set private field on non-instance");
            e.set(b, c);
            return c
        }
    }, {}],
    383: [function(h, q, m) {
        function f(e, c) {
            "undefined" === typeof b[e] && Object.defineProperty(b, e, {
                get: function() {
                    var a;
                    "CC_WECHATGAMESUB" === e ? a = "cc.sys.platform === cc.sys.WECHAT_GAME_SUB" : "CC_WECHATGAME" === e ? a = "cc.sys.platform === cc.sys.WECHAT_GAME" : "CC_QQPLAY" === e && (a = "cc.sys.platform === cc.sys.QQ_PLAY");
                    cc.warnID(1400, e, a);
                    return c
                }
            })
        }

        function e(e) {
            return "object" === typeof b[e]
        }
        var b = "undefined" === typeof window ? global : window;
        (function(e, c) {
            "undefined" === typeof b[e] && (b[e] = c)
        })("CC_BUILD", !1);
        !0;
        b.CC_BUILD = !0;
        b.CC_DEV = !1;
        b.CC_DEBUG = !0;
        b.CC_JSB = !1;
        b.CC_NATIVERENDERER = !1;
        b.CC_SUPPORT_JIT = !0;
        b.CC_PHYSICS_BUILTIN = !1;
        b.CC_PHYSICS_CANNON = !1;
        b.CC_EDITOR = !1;
        b.CC_PREVIEW = !1;
        b.CC_TEST = !1;
        b.CC_RUNTIME = !1;
        b.CC_JSB = !1;
        h = !(!e("wx") || !wx.getSharedCanvas);
        q = !(!e("wx") || !wx.getSystemInfoSync && !wx.getSharedCanvas);
        m = e("bk");
        f("CC_WECHATGAMESUB", h);
        f("CC_WECHATGAME", q);
        f("CC_QQPLAY", m);
        !1;
        b.CocosEngine = cc.ENGINE_VERSION = "2.4.3"
    }, {}]
}, {}, [375]);